{"version":3,"sources":["../../src/perspective.manage/mixins/manifest.edit.mixin.js","../../src/perspective.manage/impl/options.form.wrapper!hbs","../../src/perspective.manage/impl/options.form!css","../../src/perspective.manage/impl/options.form.view.js","../../src/perspective.manage/impl/widget.item!hbs","../../src/perspective.manage/impl/widget.drag.template!hbs","../../src/perspective.manage/impl/widget.list.view.js","../perspective.manage/impl/perspectivelayouts!csui-ext","../../src/perspective.manage/impl/perspectivelayouts.js","../../src/perspective.manage/impl/pman.panel!hbs","../../src/perspective.manage/impl/list.item!hbs","../../src/perspective.manage/impl/list!hbs","../../src/perspective.manage/impl/pman.panel!css","../../src/perspective.manage/impl/pman.panel.view.js","../../src/perspectives/mixins/draganddrop.kn.mixin.js","../../src/perspective.manage/impl/pman!hbs","../../src/perspective.manage/impl/pman!css","../../src/perspective.manage/behaviours/impl/nls/lang.js","../../src/perspective.manage/behaviours/impl/nls/root/lang.js","../../src/perspective.manage/behaviours/impl/widget.masking!hbs","../../src/perspective.manage/behaviours/impl/widget.masking!css","../../src/perspective.manage/behaviours/pman.widget.config.behaviour.js","../../src/perspective.manage/pman.view.js","../../src/perspective.manage/widgets/perspective.placeholder/impl/nls/lang.js","../../src/perspective.manage/widgets/perspective.placeholder/impl/nls/root/lang.js","../../src/perspective.manage/widgets/perspective.placeholder/impl/perspective.placeholder!hbs","../../src/perspective.manage/widgets/perspective.placeholder/impl/perspective.placeholder!css","../../src/perspective.manage/widgets/perspective.placeholder/perspective.placeholder.view.js","../../src/perspective.manage/widgets/perspective.widget/impl/nls/lang.js","../../src/perspective.manage/widgets/perspective.widget/impl/nls/root/lang.js","../../src/perspective.manage/widgets/perspective.widget/impl/perspective.widget!hbs","../../src/perspective.manage/widgets/perspective.widget/impl/perspective.widget!css","../../src/perspective.manage/widgets/perspective.widget/perspective.widget.view.js","../../src/perspective.manage/widgets/perspective.placeholder/perspective.placeholder.manifest.json!json","../../src/perspective.manage/widgets/perspective.widget/perspective.widget.manifest.json!json","../../src/perspective.manage/widgets/perspective.placeholder/impl/nls/perspective.placeholder.manifest.js","../../src/perspective.manage/widgets/perspective.placeholder/impl/nls/root/perspective.placeholder.manifest.js","../../src/perspective.manage/widgets/perspective.placeholder/impl/nls/perspective.placeholder.manifest!i18n","../../src/perspective.manage/widgets/perspective.widget/impl/nls/perspective.widget.manifest.js","../../src/perspective.manage/widgets/perspective.widget/impl/nls/root/perspective.widget.manifest.js","../../src/perspective.manage/widgets/perspective.widget/impl/nls/perspective.widget.manifest!i18n","csui-perspective.js"],"names":["csui","define","_","$","mixin","prototype","extend","objectToPrimitive","fieldKey","manifestOrig","this","manifest","field","schema","properties","fieldOption","options","fields","fieldOptionItems","items","itemKey","keys","modifiedItems","fieldItem","type","title","required","length","values","updateDataToPrimitive","data","modifiedKey","arrvalues","key","push","forEach","item","getPrimitiveToObjectvalues","formValues","fieldKeyOne","sortListArray","module","hbs","Handlebars","t","template","compiler","main","container","depth0","helpers","partials","helper","lookupProperty","parent","propertyName","Object","hasOwnProperty","call","escapeExpression","hooks","helperMissing","nullContext","name","hash","loc","start","line","column","end","registerPartial","Backbone","Marionette","Alpaca","LayoutViewEventsPropagationMixin","ManifestEditMixin","PerfectScrollingBehavior","FormView","lang","PerspectiveUtil","WidgetOptionsFormWrapperView","LayoutView","className","regions","bodyRegion","behaviors","PerfectScrolling","behaviorClass","scrollYMarginOffset","templateHelpers","description","configNotSupported","ui","unSupportedConfig","events","keydown","constructor","apply","arguments","_createForm","formModel","widgetOptionsFormView","WidgetOptionsFormView","context","model","mode","listenToOnce","trigger","bind","listenTo","_hasSchema","hasConfigForm","refresh","callback","onRender","hide","_prepareFormModel","hasValidSchema","_normalizeOptions","attributes","show","onPopoverShow","popover","find","addClass","_focusField","fieldSelector","itemFirst","$el","first","ele","browseIcon","_onKeyDown","event","continueEvent","$target","target","keyCode","shiftKey","parents","getValues","modifiedProperties","modKey","indexOf","_getOptionsData","validate","reqVal","hasRequiredFields","reqFields","each","fieldName","_isPreviewWidget","widgetConfig","filed","JSON","parse","stringify","formOptions","_addWidgetSizePropertyIfSupported","Model","perspectiveView","getSupportedWidgetSizes","supportedKinds","widgetView","perspective","filter","supportedItem","kind","hasClass","kindSchema","widgetSizeTitle","widgetSizeDescription","enum","map","sk","kindOption","optionLabels","label","removeDefaultNone","selectedKind","size","selected","widgetSizeProperty","sizeSchema","sizeOptions","_resolveOptionsType","getSchemaType","isArray","defaultSchemaFieldMapping","schemaProperies","optionFields","hasValidTypes","fieldId","fieldOpts","fieldData","optType","getFieldClass","defaults","isUndefined","default","form","_modifyModel","alpaca","hideInitValidationError","1","stack1","fn","program","inverse","lambda","2","4","noop","base","Lang","WidgetCollection","WidgetItemTemplate","WidgetDragTemplate","config","dragImageOffsetTop","dragImageOffsetLeft","WidgetItemView","ItemView","tagName","widgetCollection","Collection","widgets","disableTitle","idx","models","set","draggable","get","dataAttr","replace","allowMultiple","index","silent","accordionHeader","accordionContent","accordionHeaderIcon","widget","click @ui.accordionHeader","keydown @ui.accordionHeader","dragstart @ui.widget","dragend @ui.widget","toggle","isClosed","toggleClass","parentView","removeClass","onTransitionEnd","_makeWidgetSortable","hasDragDropNative","document","createElement","dragDrop","_hasNativeDragImageSupport","on","_handleDragImageForIE","self","draggableChildren","widgetEls","sortable","connectWith","containment","widgetModel","widgetDragTemplate","widgetDragTemplateView","newWidget","render","width","height","css","opacity","appendTo","closest","tolerance","cursorAt","top","left","placeholder","dragStart","stop","dragEnd","e","originalEvent","currentTarget","$img","clone","text","Math","max","pageY","pageX","position","pointerEvents","body","setTimeout","remove","dataTransfer","setData","toJSON","onDragStart","setDragImage","window","DataTransfer","Clipboard","onDragEnd","header","templateMessage","existsWidgetTypes","pmanView","widegtsUpdated","allWidgets","fetch","done","collection","_groupWidgetsByModule","opts","newEleToBeProcess","undefined","oldEleToBeProcess","oldWidgetModel","nodeIndex","splice","toggleElements","initialize","bindAll","renderItem","itemView","el","append","moduleCollection","has","deprecated","noTitle","canDragAndDrop","inArray","groupBy","serverModule","id","val","toUpperCase","add","_sanitiseWidgetLibrary","onInitWidgets","empty","extraPerspectiveLayouts","enableNewlayoutOption","perspectivelayouts","LcrLayoutTitle","icon","FlowLayoutTitle","RSPLayoutTitle","LSPLayoutTitle","union","require","BlockerView","WidgetListView","perspectiveLayouts","ListItemTemplate","ListTemplate","PManPanelView","click @ui.layoutTab","keydown @ui.layoutTab","tabPannel","listPannel","layoutTab","widgetTab","contentParent","suppressScrollX","layoutTabTitle","widgetTabTitle","onPanelOpen","accordionView","triggerMethod","accordionRegion","Region","blockActions","unblockActions","_getExistsWidgetTypes","imbue","listView","destroy","perpeCollection","center","right","onTabClicked","args","itemClassName","listregion","ListView","attr","focus","onKeyDown","ListItemView","iconClass","click .csui-layout-item:not(.binf-active)","debounce","keydown .csui-layout-item","preventDefault","handleKeydown","stopPropagation","previousEle","prev","nextEle","next","CompositeView","any","behavior","ViewCollection","idAttribute","back","click @ui.back","keydown @ui.back","childEvents","change:layout","set:active","goBackTooltip","childViewContainer","childView","childViewOptions","onClickBack","onKeyInView","setActive","onChangeLayout","newLayout","currentLayout","ModalAlertView","confirmWarning","changePageLayoutConfirmatonText","buttons","showYes","labelYes","proceedButton","showNo","labelNo","changeLayoutCancelButton","i18n","moveToRight","movableEle","focusableEle","widgetCells","insertAfter","swapIndexPositions","isRtl","settings","rtl","animation","moveToLeft","insertBefore","prevEle","destEle","isMovingRight","positions","findPositions","isEleInSameRow","destEleWidth","movableEleWidth","duration","isAnimationInProgress","movableEleAnimate","destEleAnimate","animate","easing","queue","when","always","zIndex","old_index","new_index","temp","offset","root","en-us","en","deleteConfirmMsg","deleteConfirmTitle","replaceConfirmMsg","replaceConfirmTitle","removeWidget","editWidget","cancel","configNeeded","hideWidget","showWidget","personalizeModewidgetFocusLabel","personalizeShortcutwidgetFocusLabel","editModewidgetFocusLabel","widgetSettings","objects","delete","hideWidgetAriaLabel","showWidgetriaLabel","info","3","6","log","WidgetModel","maskingTemplate","DEFAULTS","removeConfirmMsg","removeConfirmTitle","configNeededMessage","confirmOnRemove","allowReplace","notifyUpdatesImmediatly","perspectiveMode","WidgetMaskingView","classNames","_getStateClass","unique","join","isHiddenWidget","hideShowToggle","widgetTitle","isEditMode","isEditPage","isWidgetHidden","widgetName","_getWidgetName","str","sformat","edit","masking","wrapperButton","configureEvents","click @ui.masking","click @ui.delete","personalizationEvents","click @ui.hideShowToggle","evts","click @ui.wrapperButton","drop","dragover","dragenter","dragleave","personalizable","dropCounter","_doRefreshMask","$popoverEl","_previousFocusElm","activeElement","binf_popover","_onClicked","is","_enterConfiguration","handlePopoverClick","view","writeFieldClicked","isFormEvent","optionsFormView","cancelBtn","isMac","isMacintosh","metaKey","ctrlKey","clearFocusables","_onHideShowWidget","_hideCallout","useEnterToConfigure","_exitConfiguration","MODE_EDIT_PERSPECTIVE","widgetEle","prevWidgetEleTop","eq","scrollPosition","scrollTop","_showCallout","split","pop","_clearViewTabIndexes","clearTabIndex","isHidden","that","widgetFocusAriaLabel","ItemsInGroupAriaLabel","children","action","off","_isConfigurable","isEmpty","placeholderWidget","_loadManifest","configurableWidgetClass","selfConfigurable","_adoptToSelfConfigurableWidget","_createOptionsForm","isDestroyed","openCallout","___pman_isdropped","___pman_opencallout","isWidgetReplaced","_updateWidgetOptions","_showOptionsCallout","onDestroy","isEmptyPlaceholder","MODE_PERSONALIZE","isPersonalWidget","_notifyConfigChanges","isValid","_doDeleteWidget","onDrop","cid","forceShow","isIE11","blur","_closePopover","_calculatePopoverPlacement","_showPopover","afterRenderCallback","_onChangeField","adjust","_determineCalloutPlacement","placement","mirror","$popoverContainer","availableSpace","popoverOptions","html","content","viewport","selector","padding","_handleCalloutHide","_registerPopoverEvents","popoverLabelElemId","uniqueId","popoverHeader","_documentClickHandler","_windowResizeHandler","_unregisterPopoverEvents","_validateWidgetConfig","_enableorDisableSaveButton","isFunction","validateConfiguration","saveBtn","hasError","prop","reloadForLiveData","softUpdate","oldOptions","isOptionsSame","isEqual","widgetType","widgetToReplace","isNodeAttached","value","_evalRequiredFormWidth","formWidth","scrollWidth","offsetWidth","_calculateSpaceAroundWidget","documentWidth","leftOffset","rightOffset","rightFlip","leftFlip","i","perfectSpace","highSpace","allSpaces","spacings","current","perspectiveWidget","_addMoreManifestInfo","Deferred","resolve","deferred","then","error","reject","promise","onDeleteClick","alertDialog","confirmQuestion","result","_doSpecificWidgetFocusble","_doReplaceWidget","existingWidget","isEligibleForLiveWidget","onDragOver","onDragEnter","siblings","onDragLeave","_extractWidgetToDrop","dragData","getData","userConfirmed","_updateStyles","_updateConfigChanges","isVisible","setWidgetHidden","hideShowBtnText","Behavior","perspectiveSelector","getPManPlaceholderWidget","_ensureWidgetElement","isObject","$widgetEl","Error","_checkAndApplyMask","_resolveWidgetConfiguration","message","maskingView","getPManWidgetConfig","isUpdating","NonEmptyingRegion","ApplicationScopeModelFactory","NodeModelFactory","UserModelFactory","PersonalizationModel","DragAndDropKNMixin","pmanContainer","PManView","addWidget","save","saveAriaLabel","cancelAriaLabel","reset","resetAriaLabel","personalizeMode","pmanPanel","cancelEdit","addIcon","trashArea","resetBtn","click @ui.cancelEdit","click @ui.addIcon","click @ui.saveBtn","click @ui.resetBtn","applyMasking","applicationScope","getModel","_prepareForEdit","_registerEventHandler","newLayoutType","setPerspective","_triggerEditMode","togglePannel","_savePerspective","_onChangePerspective","_doExitPerspective","_doCleanup","originalPerspective","_clonePrespective","isNew","_getDefaultPerspectiveConfig","original","perspectiveConfig","getPerspective","getContainer","contains","class","perspectiveChanges","update","_onSaveSuccess","_onSaveError","_showMessage","perspectiveSaveSuccess","personalizationSaveSuccess","contextPerspectiveMode","sourceModel","_getSourceModel","updatePerspective","getPerspectiveId","personalizations","personalization","errorMessage","responseJSON","errorHtml","MessageHelper","toHtml","GlobalMessage","showMessage","onClickSave","popoverTarget","onClickReset","resetConfirmMsg","yes","_doReset","originalConfig","resetSuccessful","params","onClickClose","_closeToolsPanel","pointerType","_openToolsPanel","pmanPanelView","close","_initializeWidgets","pmanPanelRegion","droppable","hoverClass","accept","_setFocusOnFirstWidget","_beforeTransition","perspectiveContainer","_documentClick","$targetParent","at","columns","shortcutButton","dndWidgetsHere","dndHTMLWidgetsHere","widgetContainer","grid","allowHTMLTilesOnly","onShow","noConfig","clickToConfig","wConfig","wTitle","widgetMessage","$schema","styleLoad"],"mappings":"AAAAA,KAAAC,OAAA,sDAAA,sBAAA,mBAAA,SAAAC,EAAAC,GACA,YAkEA,QA/DAC,QAAA,SAAAC,GACA,MAAAH,GAAAI,OAAAD,GACAE,oBAAA,SAAAC,GAEA,GAAAC,GAAAN,EAAAG,QAAA,KAAAI,KAAAC,UACAC,EAAAF,KAAAC,SAAAE,OAAAC,WAAAN,GACAO,EAAAL,KAAAC,SAAAK,QAAAC,OAAAT,GACAU,EAAAH,GAAAA,EAAAI,MAAAF,OACAG,EAAAlB,EAAAmB,KAAAT,EAAAO,MAAAL,YAAA,EAGAJ,MAAAC,SAAAW,cAAAb,CAGA,IAAAc,GAAAX,EAAAO,MAAAL,WAAAM,SACAR,GAAAO,MAAAL,WACAF,EAAAO,MAAAK,KAAAD,EAAAC,KACAZ,EAAAa,MAAAF,EAAAE,MACAb,EAAAc,SAAAd,EAAAO,MAAAO,UAAAd,EAAAO,MAAAO,SAAAC,OAAA,EACAf,EAAAQ,QAAAA,EAGAF,UACAH,GAAAI,MAAAF,OACAF,EAAAI,MAAAjB,EAAA0B,OAAAV,GAAA,KAIAW,wBAAA,SAAAC,EAAAC,GACA,GAAAC,MACAC,EAAAvB,KAAAC,SAAAE,OAAAC,WAAAiB,GAAAX,OACA,IAAAU,EAAAC,GAAAJ,QAAAK,EAAAE,KAAA,IACAJ,EAAAC,GAAAI,QAAA,SAAAC,GACAJ,EAAAE,KAAAE,EAAAH,MAEAH,EAAAC,GAAAC,GAGAK,6BAAA,SAAAN,EAAAO,GACA,GAAAlB,GAAAV,KAAAC,SAAAE,OAAAC,WAAAiB,GAAAX,OACA,IAAAA,EAAA,CAEAV,KAAAC,SAAAW,gBACAZ,KAAAC,SAAAK,QAAAC,OAAAc,GAAAZ,MACAT,KAAAC,SAAAW,cAAAN,QAAAC,OAAAc,GAAAZ,MAEAT,KAAAC,SAAAE,OAAAC,WAAAiB,GAAAZ,MACAT,KAAAC,SAAAW,cAAAT,OAAAC,WAAAiB,GAAAZ,MAGA,KAAA,GAAAoB,KAAAD,GAAAP,GAAA,CACA,GAAAS,KACAA,GAAApB,GAAAkB,EAAAP,GAAAQ,GACAD,EAAAP,GAAAQ,GAAAC,EAEA,MAAAF,GAEA,MAAAA,UC3DAtC,KAAAC,OAAA,yDAAA,SAAA,MAAA,sBAAA,SAAAwC,EAAAC,EAAAC,GACA,GAAAC,GAAAD,EAAAE,UAAAC,YAAA,EAAA,YAAAC,OAAA,SAAAC,EAAAC,EAAAC,EAAAC,EAAArB,GACA,GAAAsB,GAAAC,EAAAL,EAAAK,gBAAA,SAAAC,EAAAC,GACA,GAAAC,OAAAnD,UAAAoD,eAAAC,KAAAJ,EAAAC,GACA,MAAAD,GAAAC,GAKA,OAAA,gFACAP,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,WAAA,MAAAD,EAAAI,EAAAJ,EAAA,SAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,QAAAC,UAAAC,OAAAC,SAAAC,OAAA,EAAAC,SAAA,IAAAC,OAAAF,OAAA,EAAAC,SAAA,OAAAhB,IACA,yDACAJ,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,iBAAA,MAAAD,EAAAI,EAAAJ,EAAA,eAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,cAAAC,UAAAC,OAAAC,SAAAC,OAAA,EAAAC,SAAA,IAAAC,OAAAF,OAAA,EAAAC,SAAA,OAAAhB,IACA,qRACAJ,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,wBAAA,MAAAD,EAAAI,EAAAJ,EAAA,sBAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,qBAAAC,UAAAC,OAAAC,SAAAC,OAAA,EAAAC,SAAA,IAAAC,OAAAF,OAAA,EAAAC,SAAA,OAAAhB,IACA,4HAGA,OADAT,GAAA2B,gBAAA,oDAAA1B,GACAA,ICnBA5C,KAAAC,OAAA,mDAAA,cACAD,KAAAC,OAAA,kDAAA,sBAAA,kBAAA,oBAAA,sBCDA,iCACA,yFACA,qDACA,0DACA,+BACA,6CACA,wDACA,0CACA,iDACA,SAAAC,EAAAC,EAAAoE,EAAAC,EAAAC,EAAAC,EACAC,EACAC,EACAC,EAAAC,EAAAjC,EAAAkC,GAEA,GAAAC,GAAAR,EAAAS,WAAA3E,QAEAuC,WAAAA,EAEAqC,YAAA,yBAEAC,WACAC,aAAA,2BAGAC,aACAC,oBACAC,gBAAAX,EACAY,sBAAA,IAIAC,kBAAA,WACA,OACAhE,QAAAf,KAAAM,QAAAL,SAAAc,MACAiE,cAAAhF,KAAAM,QAAAL,SAAA+E,YACAC,qBAAAb,EAAAa,qBAIAC,MACAC,oBAAA,gCACAH,cAAA,+BAGAI,UACAC,UAAA,cAGAC,cAAA,SAAAhF,GACAN,KAAAM,QAAAA,MACAN,KAAAC,SAAAD,KAAAM,QAAAL,SACA6D,EAAAS,WAAA5E,UAAA2F,YAAAC,MAAAvF,KAAAwF,YAGAC,cAAA,SAAAC,GACA1F,KAAA2F,sBAAA,GAAAC,IACAC,UAAA7F,KAAAM,QAAAuF,QACAC,QAAAJ,EACAK,OAAA,WAGA/F,KAAAgG,aAAAhG,KAAA2F,sBAAA,cAAA,WACA3F,KAAAiG,QAAA,gBACAC,KAAAlG,OAEAA,KAAAmG,SAAAnG,KAAA2F,sBAAA,eAAA,SAAAzF,GACAF,KAAAiG,QAAA,eAAA/F,GACAF,KAAAiG,QAAA,qBACAC,KAAAlG,QAGAoG,aAAA,WACA,MAAApG,MAAAC,UAAAD,KAAAC,SAAAoG,eAGAC,UAAA,SAAAC,GACAvG,KAAA2F,sBACA3F,KAAA2F,sBAAAW,QAAAC,GAEAA,KAIAC,WAAA,WAGA,GAFAxG,KAAAkF,GAAAC,kBAAAsB,QACAzG,KAAAoG,aAIA,WADApG,MAAAiG,QAAA,cAGA,IAAAP,GAAA1F,KAAA0G,mBACA1G,MAAA2G,eAAArC,EAAAsC,kBACAlB,EAAAmB,WAAA1G,OAAAC,WAAAsF,EAAAmB,WAAAvG,QAAAC,OACAmF,EAAAmB,WAAAzF,MACApB,KAAA2G,gBACA3G,KAAAyF,YAAAC,GACA1F,KAAA0E,WAAAoC,KAAA9G,KAAA2F,yBAGA3F,KAAAkF,GAAAF,YAAAyB,OACAzG,KAAAkF,GAAAC,kBAAA2B,OACA9G,KAAAiG,QAAA,iBAIAc,gBAAA,SAAAC,GACAhH,KAAAoG,eAAApG,KAAA2G,iBACAK,EAAAC,KAAA,yBAAAC,SAAA,mBACAF,EAAAC,KAAA,eAAAC,SAAA,oBAEAlH,KAAAmH,YAAA,iCAGAA,cAAA,SAAAC,GACA,GAAAC,GAAArH,KAAAsH,IAAAL,KAAAG,EACA,IAAAC,EAAApG,OAAA,CACAoG,EAAAA,EAAAE,OACA,IAAAC,GAAAH,EAAAJ,KACA,wEACAQ,EAAAJ,EAAAJ,KAAA,kBACAO,GAAAvG,SACAwG,EAAAxG,OACAwG,EAAAxB,QAAA,SAEAuB,EAAAD,QAAAtB,QAAA,YAMAyB,aAAA,SAAAC,GACA,GAAAC,IAAA,EACAC,EAAApI,EAAAkI,EAAAG,OACA,QAAAH,EAAAI,SACA,IAAA,IACAJ,EAAAK,UAAAH,EAAAI,QAAA,+BAAAhH,QACAjB,KAAAmH,YAAA,gCACAS,GAAA,GACAD,EAAAK,UAAAH,EAAAI,QAAA,gCAAAhH,SACAjB,KAAAmH,YAAA,+BACAS,GAAA,GAIA,MAAAA,IAGAM,YAAA,WACA,GAAAlI,KAAAoG,aAAA,CAGA,GAAApG,KAAA2G,eAAA,CACA,GAAA/E,GAAA5B,KAAA2F,sBAAAuC,WACA,IAAAlI,KAAAC,SAAAkI,mBACA,IAAA,GAAAC,KAAA5I,GAAAmB,KAAAiB,GACA5B,KAAAC,SAAAkI,mBAAAE,QAAA7I,EAAAmB,KAAAiB,GAAAwG,KAAA,IACAxG,EAAA5B,KAAA2B,2BAAAnC,EAAAmB,KAAAiB,GAAAwG,GAAAxG,GAIA,OAAAA,GAEA,MAAA5B,MAAAsI,oBAIAC,WAAA,WACA,IAAAvI,KAAAoG,aACA,OAAA,CAGA,KAAApG,KAAA2G,eAAA,CACA,GAAA6B,IAAA,CAGA,IAAAnE,EAAAoE,kBAAAzI,KAAAC,UAAA,CACA,GAAAmB,GAAApB,KAAAsI,kBACAI,EAAA1I,KAAAC,SAAAE,OAAAa,QACAxB,GAAAmJ,KAAAD,EAAA,SAAAE,GACAxH,EAAAwH,KACAJ,GAAA,KAIA,MAAAA,GAGA,MAAAxI,MAAA2F,sBAAA4C,YAGAM,mBAAA,WACA,MACA,uDADA7I,KAAAM,QAAAwI,aAAAhI,MAIA4F,oBAAA,WACA,GAAAtF,GAAApB,KAAAsI,kBACAH,IAEA,KAAA,GAAArI,KAAAE,MAAAC,SAAAE,OAAAC,WAAA,CAIA,GAAA,wBAAAN,EACA,KAEA,IAAAiJ,GAAA/I,KAAAC,SAAAE,OAAAC,WAAAN,EACA,WAAAiJ,EAAAjI,MAAA,WAAAiI,EAAAtI,MAAAK,MACA,IAAAtB,EAAAmB,KAAAoI,EAAAtI,MAAAL,YAAAa,QACAkH,EAAA3G,KAAA1B,GACAE,KAAAH,kBAAAC,GACAsB,EAAAtB,IAAAE,KAAAmB,sBAAAC,EAAAtB,IAGAE,KAAAC,SAAAkI,oBAAA/G,EAAAtB,IACAE,KAAAmB,sBAAAC,EAAAtB,GAIAqI,EAAAlH,OAAA,IACAjB,KAAAC,SAAAkI,mBAAAA,EAIA,IAAAhI,GAAA6I,KAAAC,MAAAD,KAAAE,UAAAlJ,KAAAC,SAAAE,SACAgJ,EAAAH,KAAAC,MAAAD,KAAAE,UAAAlJ,KAAAC,SAAAK,aAcA,OAbA6I,KACAA,MAEAA,EAAA5I,SACA4I,EAAA5I,WAEAP,KAAAoJ,kCAAAjJ,EAAAgJ,EAAA/H,GAEA,GAAAyC,GAAAwF,OACAlJ,SAAAA,EACAG,UAAA6I,EACA/H,OAAAA,KAMAkH,kBAAA,WACA,GAAAlH,GAAApB,KAAAM,QAAAwI,aAAAxI,WAMA,OALAN,MAAA6I,qBAGAzH,EAAAA,EAAAd,aAEAc,GAQAgI,oCAAA,SAAAjJ,EAAAG,EAAAc,GACA,GAAApB,KAAAM,QAAAgJ,gBAAAC,wBAAA,CAIA,GAAAC,GAAAxJ,KAAAM,QAAAgJ,gBAAAC,wBAAAvJ,KAAAC,SACAD,KAAAM,QAAAmJ,WAaA,IAZAzJ,KAAAM,QAAAuF,SAAA7F,KAAAM,QAAAuF,QAAA6D,cACA,mBAAA1J,KAAAM,QAAAuF,QAAA6D,YAAA5I,MACA,kBAAAd,KAAAM,QAAAuF,QAAA6D,YAAA5I,KACA0I,EAAAhK,EAAAmK,OAAAH,EAAA,SAAAI,GACA,MAAA,aAAAA,EAAAC,OAGA7J,KAAAM,QAAAgJ,gBAAAhC,IAAAwC,SAAA,oCACA3J,GAAAC,WAAA,YAIAoJ,GAAA,IAAAA,EAAAvI,OAAA,CAIA,GAAA8I,IACAhJ,QAAAqD,EAAA4F,gBACAhF,cAAAZ,EAAA6F,sBACAnJ,OAAA,SACAoJ,OAAA1K,EAAA2K,IAAAX,EAAA,SAAAY,GACA,MAAAA,GAAAP,QAGAQ,GACAvJ,OAAA,SACAwJ,eAAA9K,EAAA2K,IAAAX,EAAA,SAAAY,GACA,MAAAA,GAAAG,QAEAC,qBAAA,GAEAC,EAAAjL,EAAAyH,KAAAuC,EAAA,SAAAkB,GAAA,MAAAA,GAAAC,UACAF,KACArJ,EAAAkD,EAAAsG,oBAAAH,EAAAZ,KAEA,IAAAgB,KACAA,GAAAvG,EAAAsG,oBAAAb,EACA5J,EAAAC,WAAAZ,EAAAI,OAAAiL,EAAA1K,EAAAC,WAEA,IAAA0K,KACAA,GAAAxG,EAAAsG,oBAAAP,EACA/J,EAAAC,OAAAf,EAAAI,OAAAkL,EAAAxK,EAAAC,QAEAJ,EAAAa,SAAAb,EAAAa,aACAb,EAAAa,SAAAQ,KAAA8C,EAAAsG,yBAIAA,qBAAA,eAKAG,sBAAA,SAAA5K,EAAAiB,GACA,GAAAN,GAAAX,EAAAW,IAWA,OAVAA,KACAA,EAAAiD,EAAAiH,cAAA5J,IAEAN,IAEAA,EADAM,GAAA2C,EAAAkH,QAAA7J,GACA,QAEA,UAGAjB,GAAAA,EAAA,KACAA,EAAA,KAAAc,OAAA,EACA,SAEA,QAGA8C,EAAAmH,0BAAApK,IAOA8F,oBAAA,SAAAuE,EAAAC,EAAAhK,GACA,GAAAiK,IAAA,CAsEA,OArEA7L,GAAAmJ,KAAAwC,EAAA,SAAAjL,EAAAoL,GACA,GAAAC,GAAAH,EAAAE,GACAE,EAAApK,EAAAkK,EACAC,KACAH,EAAAE,GAAAC,KAGA,IAAAE,GAAAF,EAAAzK,IAUA,SATA2K,GAAAvL,EAAAY,OAEA2K,EAAAnH,EAAAyG,oBAAA7K,EAAAsL,IAGAzH,EAAA2H,cAAAD,KACAJ,GAAA,GAGAnL,EAAAY,MACA,IAAA,QAWA,GAVAyK,EAAAhL,QACAf,EAAAmM,SAAAJ,GACAhL,UACAmB,aAIA6J,EAAA9K,QACA8K,EAAAhL,OAAAmB,KAAA6J,EAAA9K,OAEA,WAAAP,EAAAO,MAAAK,KAAA,CACAyK,EAAAhL,OAAAmB,KAAAZ,OAAAiD,EAAA2H,cAAAH,EAAAhL,OAAAmB,KAAAZ,QACAuK,GAAA,GAEAE,EAAAhL,OAAAmB,KAAAnB,SAAAgL,EAAAhL,OAAAmB,KAAAnB,WACAiL,GAAA,IAAAA,EAAAvK,SACAG,EAAAkK,GAAAE,OAEAlH,GAAAsC,kBACA1G,EAAAO,MAAAL,WAAAmL,EAAAhL,OAAAmB,KAAAnB,OACAiL,EAAA,MAEAH,GAAA,GAGAG,IACApK,EAAAkK,IAAA,MAEA,MACA,KAAA,SACAE,IACApK,EAAAkK,GAAAE,MAEAD,EAAAhL,SACAgL,EAAAhL,UAEA+D,GAAAsC,kBAAA1G,EAAAE,WACAmL,EAAAhL,OAAAiL,KAEAH,GAAA,EAEA,MACA,SACA7L,EAAAoM,YAAAJ,KAEApK,EAAAkK,GAAApL,EAAA2L,SAAA,SAKAR,KAIAzF,EAAAzB,EAAAvE,QACA4E,YAAA,WAEA,MADAL,GAAAxE,UAAA6E,UAAAxB,KAAAhD,MACA,4BAEAsF,cAAA,SAAAhF,GACA6D,EAAAoB,MAAAvF,KAAAwF,YAEAwB,WAAA,EACAV,UAAA,SAAAC,GACAvG,KAAA8L,MAAA9L,KAAA8L,KAAAxF,QAAAC,IAGAwF,eAAA,WACA5H,EAAAxE,UAAAoM,aAAAxG,MAAAvF,KAAAwF,WAEAxF,KAAAgM,OAAA1L,QAAA2L,yBAAA,IAMA,OAFAzM,GAAAI,OAAAgG,EAAAjG,UAAAqE,GACAC,EAAAvE,MAAA4E,EAAA3E,WACA2E,ICzbAhF,KAAAC,OAAA,gDAAA,SAAA,MAAA,sBAAA,SAAAwC,EAAAC,EAAAC,GACA,GAAAC,GAAAD,EAAAE,UAAA+J,IAAA,SAAA5J,EAAAC,EAAAC,EAAAC,EAAArB,GACA,GAAA+K,GAAAxJ,EAAAL,EAAAK,gBAAA,SAAAC,EAAAC,GACA,GAAAC,OAAAnD,UAAAoD,eAAAC,KAAAJ,EAAAC,GACA,MAAAD,GAAAC,GAKA,OAAA,4BACA,OAAAsJ,EAAAxJ,EAAAH,EAAA,MAAAQ,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,gBAAA,OAAA+I,EAAA,MAAA5J,EAAAI,EAAAJ,EAAA,cAAAA,GAAAI,EAAAwJ,EAAA,aAAAA,GAAA9I,OAAA,KAAAC,UAAA8I,KAAA9J,EAAA+J,QAAA,EAAAjL,EAAA,GAAAkL,UAAAhK,EAAA+J,QAAA,EAAAjL,EAAA,GAAAmC,OAAAC,SAAAC,OAAA,GAAAC,SAAA,IAAAC,OAAAF,OAAA,GAAAC,SAAA,QAAAyI,EAAA,IACA,uCACA7J,EAAAW,iBAAAX,EAAAiK,OAAA,OAAAJ,EAAA,MAAA5J,EAAAI,EAAAJ,EAAA,cAAAA,GAAAI,EAAAwJ,EAAA,YAAAA,EAAA5J,IACA,iDACAD,EAAAW,iBAAAX,EAAAiK,OAAA,OAAAJ,EAAA,MAAA5J,EAAAI,EAAAJ,EAAA,cAAAA,GAAAI,EAAAwJ,EAAA,iBAAAA,EAAA5J,IACA,uIACAD,EAAAW,iBAAAX,EAAAiK,OAAA,OAAAJ,EAAA,MAAA5J,EAAAI,EAAAJ,EAAA,cAAAA,GAAAI,EAAAwJ,EAAA,SAAAA,EAAA5J,IACA,6BACAD,EAAAW,iBAAAX,EAAAiK,OAAA,OAAAJ,EAAA,MAAA5J,EAAAI,EAAAJ,EAAA,cAAAA,GAAAI,EAAAwJ,EAAA,SAAAA,EAAA5J,IACA,2BACAD,EAAAW,iBAAAX,EAAAiK,OAAA,OAAAJ,EAAA,MAAA5J,EAAAI,EAAAJ,EAAA,cAAAA,GAAAI,EAAAwJ,EAAA,SAAAA,EAAA5J,IACA,uDACAD,EAAAW,iBAAAX,EAAAiK,OAAA,OAAAJ,EAAA,MAAA5J,EAAAI,EAAAJ,EAAA,cAAAA,GAAAI,EAAAwJ,EAAA,QAAAA,EAAA5J,IACA,8EACA,OAAA4J,EAAAxJ,EAAAH,EAAA,MAAAQ,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,gBAAA,OAAA+I,EAAA,MAAA5J,EAAAI,EAAAJ,EAAA,cAAAA,GAAAI,EAAAwJ,EAAA,aAAAA,GAAA9I,OAAA,KAAAC,UAAA8I,KAAA9J,EAAA+J,QAAA,EAAAjL,EAAA,GAAAkL,UAAAhK,EAAA+J,QAAA,EAAAjL,EAAA,GAAAmC,OAAAC,SAAAC,OAAA,GAAAC,SAAA,IAAAC,OAAAF,OAAA,GAAAC,SAAA,QAAAyI,EAAA,IACA,uBACA7J,EAAAW,iBAAAX,EAAAiK,OAAA,OAAAJ,EAAA,MAAA5J,EAAAI,EAAAJ,EAAA,cAAAA,GAAAI,EAAAwJ,EAAA,YAAAA,EAAA5J,IACA,iDACAD,EAAAW,iBAAAX,EAAAiK,OAAA,OAAAJ,EAAA,MAAA5J,EAAAI,EAAAJ,EAAA,cAAAA,GAAAI,EAAAwJ,EAAA,iBAAAA,EAAA5J,IACA,8EACAD,EAAAW,iBAAAX,EAAAiK,OAAA,OAAAJ,EAAA,MAAA5J,EAAAI,EAAAJ,EAAA,cAAAA,GAAAI,EAAAwJ,EAAA,gBAAAA,EAAA5J,IACA,2BACAD,EAAAW,iBAAAX,EAAAiK,OAAA,OAAAJ,EAAA,MAAA5J,EAAAI,EAAAJ,EAAA,cAAAA,GAAAI,EAAAwJ,EAAA,SAAAA,EAAA5J,IACA,uDACAD,EAAAW,iBAAAX,EAAAiK,OAAA,OAAAJ,EAAA,MAAA5J,EAAAI,EAAAJ,EAAA,cAAAA,GAAAI,EAAAwJ,EAAA,QAAAA,EAAA5J,IACA,0DACAiK,IAAA,SAAAlK,EAAAC,EAAAC,EAAAC,EAAArB,GACA,MAAA,IACAqL,IAAA,SAAAnK,EAAAC,EAAAC,EAAAC,EAAArB,GACA,MAAA,iBACAgB,YAAA,EAAA,YAAAC,OAAA,SAAAC,EAAAC,EAAAC,EAAAC,EAAArB,GACA,GAAA+K,GAAAxJ,EAAAL,EAAAK,gBAAA,SAAAC,EAAAC,GACA,GAAAC,OAAAnD,UAAAoD,eAAAC,KAAAJ,EAAAC,GACA,MAAAD,GAAAC,GAKA,OAAA,6CACAP,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,SAAAA,EAAAA,IACA,oDACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,SAAAA,EAAAA,IACA,8RACA,OAAA4J,EAAAxJ,EAAAH,EAAA,QAAAQ,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,gBAAA,MAAAb,EAAAI,EAAAJ,EAAA,WAAAA,GAAAc,OAAA,OAAAC,UAAA8I,KAAA9J,EAAA+J,QAAA,EAAAjL,EAAA,GAAAkL,UAAAhK,EAAAoK,KAAAnJ,OAAAC,SAAAC,OAAA,EAAAC,SAAA,GAAAC,OAAAF,OAAA,GAAAC,SAAA,QAAAyI,EAAA,IACA,qCAGA,OADAlK,GAAA2B,gBAAA,2CAAA1B,GACAA,ICzDA5C,KAAAC,OAAA,yDAAA,SAAA,MAAA,sBAAA,SAAAwC,EAAAC,EAAAC,GACA,GAAAC,GAAAD,EAAAE,UAAAC,YAAA,EAAA,YAAAC,OAAA,SAAAC,EAAAC,EAAAC,EAAAC,EAAArB,GACA,GAAAuB,GAAAL,EAAAK,gBAAA,SAAAC,EAAAC,GACA,GAAAC,OAAAnD,UAAAoD,eAAAC,KAAAJ,EAAAC,GACA,MAAAD,GAAAC,GAKA,OAAA,6EACAP,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,UAAAA,EAAAA,IACA,+CACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,QAAAA,EAAAA,IACA,qBAGA,OADAN,GAAA2B,gBAAA,oDAAA1B,GACAA,IAIA5C,KAAAC,OAAA,iDAAA,SCrBA,sBACA,kBACA,oBACA,sBACA,kBACA,0DACA,iDACA,6CACA,uCACA,+CACA,yDACA,SAAAwC,EAAAvC,EAAAC,EAAAoE,EAAAC,EAAA6I,EAAAzI,EACA0B,EAAAgH,EACAC,EACAC,EAAAC,GACA,YAEA,IAAAC,GAAAjL,EAAAiL,QACAxN,GAAAmM,SAAAqB,GACAC,qBAAA,GACAC,sBAAA,IAGA,IAAAC,GAAArJ,EAAAsJ,SAAAxN,QAEA0F,cAAA,SAAAhF,GACAA,IAAAA,MACAwD,EAAAsJ,SAAAzN,UAAA2F,YAAAC,MAAAvF,KAAAwF,YAGA6H,UAAA,MAEA7I,YAAA,oBAEArC,WAAA2K,EAEA/H,kBAAA,WACA,GAAAuI,GAAA,GAAAzJ,GAAA0J,WAAAvN,KAAA8F,MAAAe,WAAA2G,SACAC,EAAAb,EAAAa,aACAC,EAAA,CAWA,OATAJ,GAAAK,OAAAlM,QAAA,SAAAqE,GACAA,EAAA8H,KACAC,cAAA/H,EAAAgI,IAAA,kBACAL,eAAAA,EACAM,WAAAjI,EAAAgI,IAAA,MAAAE,QAAA,MAAA,KACAC,kBAAAnI,EAAAgI,IAAA,iBACAI,QAAAR,MACAS,UAAA,OAGAX,UAAAF,EAAAK,SAIAzI,MACAkJ,kBAAA,yBACAC,mBAAA,0BACAC,sBAAA,kCACAC,SAAA,+BAGAnJ,UACAoJ,4BAAA,SACAC,8BAAA,SACAC,uBAAA,cACAC,qBAAA,aAGAC,SAAA,WACA,GAAAC,GAAA7O,KAAAkF,GAAAkJ,gBAAAtE,SAAA,wBACA9J,MAAAkF,GAAAkJ,gBAAAU,YAAA,yBACA9O,KAAAM,QAAAyO,WAAAzH,IAAAL,KAAA,sBAAA+H,YAAA,0BACA/H,KAAA,0BAAA+H,YAAA,yBACAH,IACA7O,KAAAsH,IAAAJ,SAAA,0BACAlH,KAAAkF,GAAAkJ,gBAAAlH,SAAA,0BAGAyF,EAAAsC,gBAAAjP,KAAAkF,GAAAmJ,iBAAA,WACArO,KAAAiG,QAAA,qBACAjG,OAGAwG,WAAA,WAEA,GADA/G,EAAA,4CACAwB,OAEAjB,KAAAkP,0BACA,CAEA,GAAAC,GAAA,kBAAAC,UAAAC,cAAA,QAAAC,UACAtP,KAAAuP,8BAAAJ,GACAnP,KAAAkF,GAAAqJ,OAAAiB,GAAA,YAAAxP,KAAAyP,sBAAAvJ,KAAAlG,SAKAkP,sBAAA,WACA,GAAAQ,GAAA1P,KACA2P,EAAA3P,KAAAsH,IAAAL,KAAA,gDACA2I,EAAAD,EAAA/M,QACAgN,GAAAxO,KAAA,cAAApB,KAAA8F,MAAAgI,IAAA,YACA8B,EAAAC,UACAC,eAAA,2CACA,yCACAC,cAAA,wBACArN,SAAA,SAAAiF,EAAAzC,GAEA,GAAA8K,GAAA9K,EAAA9D,KAAA,eAYA,OAXAsO,GAAAO,mBAAA,GAAAC,IACAnP,QAAA2O,EAAA5J,MAAAgI,IAAA,WAAAkC,GAAAlC,IAAA,SACAqC,YAAAT,EAAA5J,MAAAgI,IAAA,WAAAkC,KAEAN,EAAAO,mBAAAG,SAEAV,EAAAO,mBAAA3I,IAAA+I,MAAA,SACAX,EAAAO,mBAAA3I,IAAAgJ,OAAA,SACAZ,EAAAO,mBAAA3I,IAAAiJ,KAAAC,UAAA,MACAd,EAAAO,mBAAA3I,IAAAmJ,SACAf,EAAApP,QAAAyO,WAAAzH,IAAAoJ,QAAA,yBACAhB,EAAAO,mBAAA3I,KAEAqJ,YAAA,UACAC,YAAAC,MAAA7D,EAAAC,mBAAA6D,OAAA9D,EAAAE,qBACA1J,QAAA,SAAAmE,EAAAzC,GACAA,EAAAxD,KAAA6O,IAAA,UAAA,SACArL,EAAA6L,YAAAR,IAAA,UAAA,SACAb,EAAAsB,aAEAC,OAAA,WACAvB,EAAAwB,cAKAzB,wBAAA,SAAA0B,GACA,GAAAC,GAAAD,EAAAC,cACA1D,EAAAjO,EAAAkI,MAAA0J,eAAAjQ,KAAA,gBACAkQ,EAAA7R,EAAA,0BAAA8R,QACAhD,EAAAvO,KAAA8F,MAAAgI,IAAA,WAAAJ,EACA4D,GAAArK,KAAA,yBAAAuK,KAAAjD,EAAAT,IAAA,UACAwD,EAAAf,KACAM,MAAAY,KAAAC,IAAA,EAAAN,EAAAO,MAAA3E,EAAAC,oBAAA,KACA6D,OAAAW,KAAAC,IAAA,EAAAN,EAAAQ,MAAA5E,EAAAE,qBAAA,KACA2E,WAAA,WACAC,gBAAA,SACArB,SAAArB,SAAA2C,MAEAC,WAAA,WACAV,EAAAW,WAEAX,EAAA9B,GAAA,YAAAhQ,EAAA0G,KAAA,SAAAyB,GACA,GAAA4G,GAAAvO,KAAA8F,MAAAgI,IAAA,WAAAJ,EACA/F,GAAAyJ,cAAAc,aACAC,QAAA,OAAAnJ,KAAAE,UAAAqF,EAAA6D,WACApS,KAAAgR,aACAhR,OACAsR,EAAA9B,GAAA,UAAAhQ,EAAA0G,KAAA,SAAAyB,GACA3H,KAAAkR,WACAlR,OACAsR,EAAA,GAAAhC,YAGA+C,cAAA,SAAA1K,GACA,GAAA+F,GAAAjO,EAAAkI,EAAA0J,eAAAjQ,KAAA,gBACAmN,EAAAvO,KAAA8F,MAAAgI,IAAA,WAAAJ,GACAwE,EAAAvK,EAAAyJ,cAAAc,aACA/P,EAAA1C,EAAA,yBACA0C,GAAA8E,KAAA,yBAAAuK,KAAAjD,EAAAT,IAAA,UACA9N,KAAAuP,+BACA2C,EAAAC,QAAA,OAAAnJ,KAAAE,UAAAqF,EAAA6D,WAEAF,EAAAI,aAAAnQ,EAAA,GAAA6K,EAAAE,oBACAF,EAAAC,qBAEAjN,KAAAgR,aAGAzB,6BAAA,WAEA,MAAA,iBADAgD,OAAAC,cAAAD,OAAAE,WACA9S,WAGA+S,YAAA,SAAA/K,GACA3H,KAAAkR,WAGAF,YAAA,WACAhR,KAAAsH,IAAAoJ,QAAA,oBAAAxJ,SAAA,wBACAzH,EAAA2P,SAAA2C,MAAA7K,SAAA,yBAGAgK,UAAA,WACAlR,KAAAsH,IAAAoJ,QAAA,oBAAA1B,YAAA,wBACAvP,EAAA2P,SAAA2C,MAAA/C,YAAA,2BAKAkB,EAAApM,EAAAsJ,SAAAxN,QACA0F,cAAA,SAAAhF,GACAwD,EAAAsJ,SAAAzN,UAAA2F,YAAAC,MAAAvF,KAAAwF,YAGA6H,UAAA,MAEA7I,YAAA,wBAEArC,WAAA4K,EAEAhI,kBAAA,WACA,OACA4N,SAAA3S,KAAAM,SAAAN,KAAAM,QAAAS,MACAgR,OAAAnF,EAAAgG,kBAIApM,WAAA,WACAxG,KAAAsH,IAAAlG,KAAA,cAAApB,KAAAM,QAAA6P,aA8JA,OA1JArM,GAAAsJ,SAAAxN,QACAyN,UAAA,MAEAlL,WAAA2K,EAEAxH,cAAA,SAAAhF,GACAA,IAAAA,MACAA,EAAAc,OAAAd,EAAAc,SAEAd,EAAAuS,oBAAAvS,EAAAuS,sBACA/O,EAAAsJ,SAAApK,KAAAhD,KAAAM,GACAN,KAAA6F,QAAA7F,KAAAM,QAAAwS,SAAAjN,OACA,IAAA6J,GAAA1P,IACA0P,GAAAqD,gBAAA,EACA/S,KAAAgT,WAAA,GAAAnG,GACA7M,KAAAgT,WAAAC,QAAAC,KAAA,WACAxD,EAAAyD,WAAAzD,EAAA0D,wBAEA1D,EAAAU,SACAV,EAAAzJ,QAAA,mBAKAjG,KAAAmG,SAAAnG,KAAA6F,QAAA,sBAAArG,EAAA0G,KAAA,SAAAmN,GACArT,KAAA+S,gBAAA,CACA,IAAAO,GAAAD,EAAArD,aAAAqD,EAAArD,YAAAlP,KAAAuS,EAAArD,YAAAlP,SACAyS,GACAC,EAAAH,EAAAI,gBAAAJ,EAAAI,eAAA3S,KACAuS,EAAAI,eAAA3S,SAAAyS,EAEA,IAAAD,EAAA,CACA,GAAAI,GAAAlU,EAAA6I,QAAArI,KAAAM,QAAAuS,kBAAAS,EACAI,IAAA,EACA1T,KAAAM,QAAAuS,kBAAAc,OAAAD,EAAA,GAGA1T,KAAAM,QAAAuS,kBAAArR,KAAA8R,GAEAA,EAAAA,EAAAtF,QAAA,MAAA,IACA,IAAA4F,GAAA5T,KAAAsH,IAAAL,KAAA,yBAAAqM,EACA,yCACAM,GAAA3S,QAAA2S,EAAA9E,YAAA,eAEA,GAAA0E,EAAA,CACA,GAAAE,GAAAlU,EAAA6I,QAAArI,KAAAM,QAAAuS,kBAAAW,EACAE,IAAA,GACA1T,KAAAM,QAAAuS,kBAAAc,OAAAD,EAAA,GAEAF,EAAAA,EAAAxF,QAAA,MAAA,IACA,IAAA4F,GAAA5T,KAAAsH,IAAAL,KAAA,yBAAAuM,EACA,yCACAI,GAAA3S,QAAA2S,EAAA9E,YAAA,iBAEA9O,OAEAA,KAAAmG,SAAAnG,KAAA6F,QAAA,qBAAArG,EAAA0G,KAAA,SAAAmN,GACArT,KAAAM,QAAAuS,qBACA7S,KAAA+S,gBAAA,GACA/S,QAGA6T,aAAA,WACArU,EAAAsU,QAAA9T,KAAA,eAGAwE,YAAA,iBAEA4L,SAAA,WACApQ,KAAAmT,YAAAnT,KAAAmT,WAAAxK,KAAA3I,KAAA+T,aAGAA,aAAA,SAAAjO,GACA,GAAAiJ,GAAA/O,KACAgU,EAAA,GAAA7G,IACArH,QAAAA,EACAiJ,aAAAA,EACAlJ,UAAA7F,KAAA6F,SAEAmO,GAAA5D,SACApQ,KAAAmG,SAAA6N,EAAA,mBAAAxU,EAAA0G,KAAAlG,KAAAiG,QAAAjG,KAAA,cAAAA,OACAP,EAAAO,KAAAiU,IAAAC,OAAAF,EAAAC,KAGAb,wBAAA,WAEA,GAAAe,GAAA,GAAAtQ,GAAA0J,WACAC,EAAAxN,KAAAgT,WAAArJ,OAAA,SAAA4E,GACA,GAAAtO,GAAAsO,EAAAT,IAAA,WACA,KAAA7N,IAAAT,EAAA4U,IAAAnU,EAAA,WAAAT,EAAA4U,IAAAnU,EAAA,gBACAA,EAAAoU,WACA,OAAA,CAEA,IAAAlU,GAAA6I,KAAAC,MAAAD,KAAAE,UAAAjJ,EAAAE,aACAG,EAAA0I,KAAAC,MAAAD,KAAAE,UAAAjJ,EAAAK,aAGA,SAFAsF,EAAAgB,kBACAzG,EAAAC,WAAAE,EAAAC,gBAuCA,OA/BAf,GAAAmJ,KAAA6E,EAAAhO,EAAA0G,KAAA,SAAAqI,GACA,GAAAtO,GAAAT,EAAAmM,SAAA4C,EAAAT,IAAA,aACAG,iBAAA,EACAlN,QAAA6L,EAAA0H,UAEAC,EAAAtU,EAAAgO,aAEAsG,KACAA,GAAA,IAAA9U,EAAA+U,QAAAjG,EAAAT,IAAA,MAAA9N,KAAAM,QAAAuS,oBAGAtE,EAAAX,KACAK,gBAAAhO,EAAAgO,cACAsG,iBAAAA,EACAxT,QAAAd,EAAAc,SAEAf,OAEAR,EAAAmJ,KAAAnJ,EAAAiV,QAAAjH,EAAA,SAAAe,GACA,MAAAA,GAAAmG,aAAAC,KACA,SAAAC,EAAArT,GACA,GAAAR,GAAAvB,EAAA+H,MAAAqN,GAAAF,aAAA5G,IAAA,QAEA/M,GAAAA,EAAAA,EAAAiN,QAAA,YAAA,IACAxO,EAAA+H,MAAAqN,GAAAF,aAAA5G,IAAA,MAAA+G,cACAV,EAAAW,KACAH,KAAApT,EACAR,QAAAA,EACAyM,UAAAoH,MAGAT,GAGAY,yBAAA,aAKAC,gBAAA,WACAhV,KAAAsH,IAAA2N,QACAjV,KAAA+S,iBACA/S,KAAAmT,WAAAnT,KAAAoT,wBACApT,KAAA+S,gBAAA,GAEA/S,KAAAoQ,cCpXA9Q,KAAAC,OAAA,mDAAA,SCAA,sBACA,6CAEA,uDACA,SAAAwC,EAAAvC,EAAAoN,EAAAsI,GACA,GAAAlI,GAAAxN,EAAAI,QACAuV,yBAAA,GACApT,EAAAiL,UAEAoI,IAEArU,QAAA6L,EAAAyI,eACAvU,OAAA,oBACAwU,OAAA,oBAGAvU,QAAA6L,EAAA2I,gBACAzU,OAAA,OACAwU,OAAA,oBAuBA,OApBAtI,GAAAmI,uBACAC,EAAA5T,MAEAT,QAAA6L,EAAA4I,eACA1U,OAAA,kBACAwU,OAAA,gCAGAvU,QAAA6L,EAAA6I,eACA3U,OAAA,iBACAwU,OAAA,+BAMAJ,IACAE,EAAA5V,EAAAkW,MAAAN,EAAAF,IAGAE,ICxCA9V,KAAAC,OAAA,+CAAA,SAAA,MAAA,sBAAA,SAAAwC,EAAAC,EAAAC,GACA,GAAAC,GAAAD,EAAAE,UAAAC,YAAA,EAAA,YAAAC,OAAA,SAAAC,EAAAC,EAAAC,EAAAC,EAAArB,GACA,GAAAuB,GAAAL,EAAAK,gBAAA,SAAAC,EAAAC,GACA,GAAAC,OAAAnD,UAAAoD,eAAAC,KAAAJ,EAAAC,GACA,MAAAD,GAAAC,GAKA,OAAA,0EACAP,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,kBAAAA,EAAAA,IACA,aACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,kBAAAA,EAAAA,IACA,4DACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,kBAAAA,EAAAA,IACA,aACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,kBAAAA,EAAAA,IACA,8TACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,mBAAAA,EAAAA,IACA,iCAGA,OADAN,GAAA2B,gBAAA,0CAAA1B,GACAA,ICtBA5C,KAAAC,OAAA,8CAAA,SAAA,MAAA,sBAAA,SAAAwC,EAAAC,EAAAC,GACA,GAAAC,GAAAD,EAAAE,UAAAC,YAAA,EAAA,YAAAC,OAAA,SAAAC,EAAAC,EAAAC,EAAAC,EAAArB,GACA,GAAAuB,GAAAL,EAAAK,gBAAA,SAAAC,EAAAC,GACA,GAAAC,OAAAnD,UAAAoD,eAAAC,KAAAJ,EAAAC,GACA,MAAAD,GAAAC,GAKA,OAAA,eACAP,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,aAAAA,EAAAA,IACA,YACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,SAAAA,EAAAA,IACA,wBACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,aAAAA,EAAAA,IACA,gCACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,SAAAA,EAAAA,IACA,6CACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,aAAAA,EAAAA,IACA,uBAGA,OADAN,GAAA2B,gBAAA,yCAAA1B,GACAA,ICtBA5C,KAAAC,OAAA,yCAAA,SAAA,MAAA,sBAAA,SAAAwC,EAAAC,EAAAC,GACA,GAAAC,GAAAD,EAAAE,UAAAC,YAAA,EAAA,YAAAC,OAAA,SAAAC,EAAAC,EAAAC,EAAAC,EAAArB,GACA,GAAAsB,GAAAC,EAAAL,EAAAK,gBAAA,SAAAC,EAAAC,GACA,GAAAC,OAAAnD,UAAAoD,eAAAC,KAAAJ,EAAAC,GACA,MAAAD,GAAAC,GAKA,OAAA,oGACAP,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,gBAAA,MAAAD,EAAAI,EAAAJ,EAAA,cAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,aAAAC,UAAAC,OAAAC,SAAAC,OAAA,EAAAC,SAAA,IAAAC,OAAAF,OAAA,EAAAC,SAAA,OAAAhB,IACA,oEACAJ,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,mBAAA,MAAAD,EAAAI,EAAAJ,EAAA,iBAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,gBAAAC,UAAAC,OAAAC,SAAAC,OAAA,EAAAC,SAAA,IAAAC,OAAAF,OAAA,EAAAC,SAAA,OAAAhB,IACA,yGAGA,OADAT,GAAA2B,gBAAA,oCAAA1B,GACAA,ICjBA5C,KAAAC,OAAA,iDAAA,cACAD,KAAAC,OAAA,gDAAA,UAAA,SAAA,kBAAA,oBCDA,sBAAA,sBACA,wCACA,0DACA,gDACA,kDACA,6CACA,8CACA,6CACA,wCACA,wDACA,+CAEA,SAAAoW,EAAA5T,EAAAtC,EAAAoE,EAAArE,EAAAsE,EAAA8R,EAAA1R,EACA2R,EAAAC,EAAAlJ,EAAAzK,EAAA4T,EAAAC,EACAjJ,GACA,YAEA,IAAAkJ,GAAAnS,EAAAsJ,SAAAxN,QACAyN,UAAA,MAEAlL,WAAAA,EAEAiD,UACA8Q,sBAAA,eACAC,wBAAA,aAGAjR,MACAkR,YAAA,mBACAC,aAAA,oBACAC,YAAA,mBACAC,YAAA,mBACApU,WAAA,yBAGAqC,YAAA,kBAEAG,aACAC,oBACAC,gBAAAX,EACAsS,gBAAA,sCACAC,mBAAA,EACA3R,sBAAA,IAIAC,kBAAA,WACA,OACA2R,iBAAA9J,EAAA8J,eACAC,iBAAA/J,EAAA+J,eACA/D,kBAAAhG,EAAAgG,kBAIAgE,cAAA,WACA5W,KAAA6W,cAAAC,cAAA,gBACA9W,KAAAiG,QAAA,qBAGAO,WAAA,WACAxG,KAAAkF,GAAAqR,UAAA9P,OACAzG,KAAAkF,GAAAoR,UAAA7P,OACAzG,KAAA+W,gBAAA,GAAAjT,GAAAkT,QACA/C,KAAAjU,KAAAkF,GAAAqR,YAEAvW,KAAA6W,cAAA,GAAAhB,GAAA7V,KAAAM,SACAN,KAAA+W,gBAAAjQ,KAAA9G,KAAA6W,eACA7W,KAAAiX,eACAjX,KAAAmG,SAAAnG,KAAA6W,cAAA,gBAAA,WACA7W,KAAAkX,iBACAlX,KAAAkF,GAAAoR,UAAAxP,OACA9G,KAAAkF,GAAAqR,UAAAzP,SAEA9G,KAAAmG,SAAAnG,KAAA6W,cAAA,cAAA,WAEA7W,KAAAiG,QAAA,kBAIAX,cAAA,SAAAhF,GACAN,KAAAM,QAAAA,MACAN,KAAAM,QAAAuS,kBAAA7S,KAAAmX,4BACArT,EAAAsJ,SAAAzN,UAAA2F,YAAAC,MAAAvF,KAAAwF,WACAoQ,EAAAwB,MAAApX,MACAA,KAAAmG,SAAAnG,KAAA,cAAA,WACAA,KAAAqX,UAAArX,KAAAqX,SAAAC,aAIAH,wBAAA,WACA,GAAAzN,GAAA1J,KAAAM,QAAAwS,SAAApJ,YAAAoE,IAAA,eACAhN,EAAA4I,EAAA5I,KACAyW,KACA1E,IAiBA,OAdA,QAAA/R,GACAyW,EAAA7N,EAAApJ,QACAiX,EAAA/J,QAAA/L,QACAjC,EAAA0G,KAAA,SAAAqI,GACAA,EAAAzN,MACA+R,EAAArR,KAAA+M,EAAAzN,OAEAd,QACA,qBAAAc,IACAyW,EAAA7N,EAAApJ,QACAiX,EAAAC,QAAA3E,EAAArR,KAAA+V,EAAAC,OAAA1W,MACAyW,EAAAE,OAAA5E,EAAArR,KAAA+V,EAAAE,MAAA3W,MACAyW,EAAAzG,MAAA+B,EAAArR,KAAA+V,EAAAzG,KAAAhQ,OAEA+R,GAGA6E,eAAA,SAAApX,GACA,GAAAqX,GAAArX,EAAAc,KAAAd,GACAc,QACAX,QAAAqV,GAGA6B,GAAA9J,YAAA8J,EAAAvW,KAAAyM,UACA8J,EAAAC,cAAA,mBACAD,EAAA7E,SAAA9S,KAAAM,QAAAwS,SAEA9S,KAAAkF,GAAAkR,UAAAlP,SAAA,eACAlH,KAAA6X,WAAA,GAAA/T,GAAAkT,QACA/C,KAAAjU,KAAAkF,GAAAmR,aAEArW,KAAAqX,SAAA,GAAAS,GAAAH,GACA3X,KAAA6X,WAAA/Q,KAAA9G,KAAAqX,UACArX,KAAAsH,IAAAL,KAAA,eAAA8Q,KAAA,WAAA,EACA,IAAAvQ,GAAAxH,KAAAsH,IAAAL,KAAA,gCACAxH,GAAA+H,EAAA,IAAAuQ,KAAA,WAAA,GACAvQ,EAAAwQ,QAEAhY,KAAAmG,SAAAnG,KAAAqX,SAAA,iBAAA,WACArX,KAAAkF,GAAAkR,UAAApH,YAAA,iBACA7I,SAAAnG,KAAAqX,SAAA,aAAA,WACArX,KAAAqX,SAAAC,aAIAW,YAAA,SAAAtQ,GACA,KAAAA,EAAAI,SAAA,KAAAJ,EAAAI,SACA/H,KAAA0X,aAAA/P,MAKAuQ,EAAApU,EAAAsJ,SAAAxN,QACA0F,cAAA,SAAAhF,GACAwD,EAAAsJ,SAAAzN,UAAA2F,YAAAC,MAAAvF,KAAAwF,YAGA6H,UAAA,MACAlL,WAAA4T,EAEAhR,kBAAA,WACA,OACA8I,cAAA7N,KAAAM,QAAAuN,UACArJ,YAAAxE,KAAAM,QAAAsX,cACAO,YAAAnY,KAAA8F,MAAAgI,IAAA,UAIA1I,UACAgT,4CAAA5Y,EAAA6Y,SAAA,WACArY,KAAAiG,QAAA,kBACA,KAAA,GACAqS,4BAAA9Y,EAAA6Y,SAAA,SAAA1Q,GACA,KAAAA,EAAAI,SAAA,KAAAJ,EAAAI,QACA/H,KAAAiG,QAAA,iBACA,IAAA0B,EAAAI,SAAA,KAAAJ,EAAAI,SACA/H,KAAAsH,IAAAL,KAAA,qBAAA8Q,KAAA,YAAA,GAEA,IAAApQ,EAAAI,SAAAJ,EAAAK,UACAL,EAAA4Q,iBACAvY,KAAAM,QAAAwS,SAAAxL,IAAAL,KAAA,eAAA+Q,SACA,IAAArQ,EAAAI,SACAJ,EAAA4Q,iBACA9Y,EAAAO,KAAAM,QAAAwS,SAAAxL,IAAAL,KAAA,wBAAA+Q,QACAvY,EAAAO,KAAAM,QAAAwS,SAAAxL,IAAAL,KAAA,iCAAA,IAAA8Q,KAAA,WAAA,IACApQ,EAAAK,UACAvI,EAAAO,KAAAM,QAAAwS,SAAAxL,IAAAL,KAAA,iCAAA,IAAA8Q,KAAA,WAAA,IAGA/X,KAAAwY,cAAA7Q,IAEA,KAAA,IAGA6Q,gBAAA,SAAA7Q,GACA,GAAA,KAAAA,EAAAI,SAAA,KAAAJ,EAAAI,QAIA,GAHA/H,KAAAsH,IAAAL,KAAA,qBAAA8Q,KAAA,YAAA,GACApQ,EAAA4Q,iBACA5Q,EAAA8Q,kBACA,KAAA9Q,EAAAI,QAAA,CACA,GAAA2Q,GAAA1Y,KAAAsH,IAAAqR,OAAA1R,KAAA,oBACAyR,GAAAzX,OAAA,GACAyX,EAAAzS,QAAA,aAEA,IAAA,KAAA0B,EAAAI,QAAA,CACA,GAAA6Q,GAAA5Y,KAAAsH,IAAAuR,OAAA5R,KAAA,oBACA2R,GAAA3X,OAAA,GACA2X,EAAA3S,QAAA,WAMAO,WAAA,WACAxG,KAAA8F,MAAAgI,IAAA,UAAA9N,KAAAM,QAAAwS,SAAApJ,YAAAoE,IAAA,eAAAhN,MACAd,KAAAiG,QAAA,iBAMA6R,EAAAhU,EAAAgV,cAAAlZ,QAEA0F,cAAA,SAAAhF,GA2BA,GA1BAA,IAAAA,MACAA,EAAAc,OAAAd,EAAAc,SAKApB,KAAA2E,WAAAnF,EAAAuZ,IAAA/Y,KAAA2E,UAAA,SAAAqU,EAAAzX,GACA,MAAAyX,GAAAnU,gBAAAX,MAEAlE,KAAA2E,UAAAnF,EAAAI,QACAgF,oBACAC,gBAAAX,EACAsS,gBAAA,kBACAC,mBAAA,EAEA3R,sBAAA,KAEA9E,KAAA2E,YAGAb,EAAAgV,cAAA9V,KAAAhD,KAAAM,GAMAN,KAAAM,QAAAc,MAAApB,KAAAM,QAAAc,KAAAX,MAAA,CACA,IAAAT,KAAAmT,WAAA,CACA,GAAA8F,GAAApV,EAAA0J,WAAA3N,QACAkG,QAAAjC,EAAAwF,MAAAzJ,QACAsZ,cAAA,QAGAlZ,MAAAmT,WAAA,GAAA8F,GAEAjZ,KAAAmT,WAAA2B,IAAA9U,KAAAM,QAAAc,KAAAX,SAIAyE,MACAiU,OAAA,eAEA3U,YAAA,iBAEAY,UACAgU,iBAAA,cACAC,mBAAA,eAGAC,eACAC,gBAAA,iBACAC,aAAA,aAGArX,WAAA6T,EAEAjR,kBAAA,WACA,OACA0U,gBAAA7M,EAAA6M,gBAIAC,qBAAA,iBAEAC,YAAAzB,EAEA0B,mBAAA,WACA,MAAA5Z,MAAAM,SAGAuZ,cAAA,SAAAlS,GACAA,EAAA4Q,iBACA5Q,EAAA8Q,kBACAzY,KAAAiG,QAAA,eAGA6T,cAAA,SAAAnS,GACA,KAAAA,EAAAI,SAAA,KAAAJ,EAAAI,SACA/H,KAAA6Z,YAAAlS,GACA3H,KAAAM,QAAAwS,SAAAxL,IAAAL,KAAA,oBAAA+Q,SACA,IAAArQ,EAAAI,UACAJ,EAAAK,WACAL,EAAA4Q,iBACAvY,KAAAsH,IAAAL,KAAA,iCAAA+Q,WAKA+B,YAAA,SAAAJ,GACA3Z,KAAAsH,IAAAL,KAAA,qBAAA+H,YAAA;8DACA2K,EAAArS,IAAAL,KAAA,qBAAAC,SAAA,gBAGA8S,iBAAA,SAAAL,GACA,GAAAjK,GAAA1P,KACAia,EAAAN,EAAA7T,MAAAgI,IAAA,QACAoM,EAAAla,KAAAM,QAAAwS,SAAApJ,YAAAoE,IAAA,eAAAhN,IACA,qBAAAoZ,GAAA,mBAAAA,GACA,oBAAAD,GAAA,mBAAAA,EAOA3a,KAAAqW,SAAA,wCAAA,SAAAwE,GACAA,EAAAC,eAAAxN,EAAAyN,gCAAAzN,EAAA8J,gBAEA4D,WACAC,WAAA,EACAC,WAAA5N,EAAA6N,cACAC,UAAA,EACAC,UAAA/N,EAAAgO,4BAGA1H,KAAA,SAAAsH,GACAA,IACA9K,EAAAqK,UAAAJ,GACAjK,EAAApP,QAAAwS,SAAA7M,QAAA,gBAAA0T,EAAA7T,MAAAgI,IAAA,SACA4B,EAAApP,QAAAwS,SAAAjN,QAAAI,QAAA,4BAlBAyJ,EAAAqK,UAAAJ,GACAjK,EAAApP,QAAAwS,SAAA7M,QAAA,cAAAgU,MA0BA,OAAAhE,KAIA3W,KAAAC,OAAA,iDAAA,sBAAA,kBAAA,QAAA,SAAAC,EAAAC,EAAAob,GChWA,YAkGA,QA/FAnb,QAAA,SAAAC,GACA,MAAAH,GAAAI,OAAAD,GACAmb,cAAA,SAAAC,EAAAC,EAAAC,GAIA,QAAA1U,KACAwU,GAAAA,EAAAG,YAAAtC,GACAoC,GAAAA,EAAA/U,QAAA,SACAyJ,EAAAyL,mBAAAF,EAAAF,EAAA7M,QAAA0K,EAAA1K,SANA,GAAAwB,GAAA1P,KAAAob,EAAAP,GAAAA,EAAAQ,SAAAC,IACA1C,EAAAmC,EAAAlC,MAQAD,GAAA3X,QAAAjB,KAAAub,UAAAR,EAAAnC,GAAAwC,EAAA7U,IAGAiV,aAAA,SAAAT,EAAAC,EAAAC,GAIA,QAAA1U,KACAwU,GAAAA,EAAAU,aAAAC,GACAV,GAAAA,EAAA/U,QAAA,SACAyJ,EAAAyL,mBAAAF,EAAAF,EAAA7M,QAAAwN,EAAAxN,SANA,GAAAwB,GAAA1P,KAAAob,EAAAP,GAAAA,EAAAQ,SAAAC,IACAI,EAAAX,EAAApC,MAOA+C,GAAAza,QAAAjB,KAAAub,UAAAR,EAAAW,EAAAN,EAAA7U,IAGAgV,YAAA,SAAAR,EAAAY,EAAAC,EAAArV,GACA,GAAAsV,GAAA7b,KAAA8b,cAAAf,EAAAY,GACAI,EAAAF,EAAAF,QAAA9K,MAAAgL,EAAAd,WAAAlK,IACAmL,EAAAL,EAAAtL,QACA4L,EAAAlB,EAAA1K,QAAAX,EAAA1P,KAAAkc,EAAA,GACAnB,GAAAxK,IAAA,SAAA,OACAoL,EAAApL,IAAA,SAAA,OACAb,EAAAyM,wBAEAD,EAAA,EACAlc,KAAAoc,mBAAApc,KAAAoc,kBAAAnL,OACAjR,KAAAqc,gBAAArc,KAAAqc,eAAApL,QAEAvB,EAAAyM,uBAAA,EACAnc,KAAAoc,kBAAArB,EAAAuB,SAEAxL,OAAAiL,GACAH,EAAAI,EACAH,EAAAF,QAAA7K,KAAA+K,EAAAd,WAAAjK,KACAD,MAAAkL,EAAA,EAAAF,EAAAF,QAAA9K,IAAAgL,EAAAd,WAAAlK,MAEAqL,WAAAA,EAAAK,SAAA,iBAAAC,SAAA,IAEAxc,KAAAqc,eAAAV,EAAAW,SAEAxL,OAAAiL,EACAH,EAAAC,EAAAd,WAAAjK,KAAA+K,EAAAF,QAAA7K,KACAmL,EAAAD,EAAAC,EAAAD,EACAH,EAAAd,WAAAjK,KAAA+K,EAAAF,QAAA7K,KACAD,MAAAkL,EAAA,EAAAF,EAAAd,WAAAlK,IAAAgL,EAAAF,QAAA9K,MAEAqL,WAAAA,EAAAK,SAAA,iBAAAC,SAAA,IAEA/c,EAAAgd,KACAzc,KAAAoc,kBAAApc,KAAAqc,gBACAK,OAAA,WACAhN,EAAAyM,uBAAA,EACApB,EAAAxK,KACAM,MAAA,EACAC,OAAA,EACA6L,SAAA,YAEAhB,EAAApL,KACAM,MAAA,EACAC,OAAA,EACA6L,SAAA,YAEApW,OAIA4U,qBAAA,SAAAF,EAAA2B,EAAAC,GACA,GAAAC,GAAA7B,EAAA2B,EAGA,OAFA3B,GAAA2B,GAAA3B,EAAA4B,GACA5B,EAAA4B,GAAAC,EACA7B,GAGAa,gBAAA,SAAAf,EAAAY,GACA,OACAZ,aAAAA,EAAAgC,SACApB,UAAAA,EAAAoB,iBC1FAzd,KAAAC,OAAA,yCAAA,SAAA,MAAA,sBAAA,SAAAwC,EAAAC,EAAAC,GACA,GAAAC,GAAAD,EAAAE,UAAA+J,IAAA,SAAA5J,EAAAC,EAAAC,EAAAC,EAAArB,GACA,GAAAuB,GAAAL,EAAAK,gBAAA,SAAAC,EAAAC,GACA,GAAAC,OAAAnD,UAAAoD,eAAAC,KAAAJ,EAAAC,GACA,MAAAD,GAAAC,GAKA,OAAA,4EACAP,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,SAAAA,EAAAA,IACA,wCACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,kBAAAA,EAAAA,IACA,KACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,SAAAA,EAAAA,IACA,oCACAH,YAAA,EAAA,YAAAC,OAAA,SAAAC,EAAAC,EAAAC,EAAAC,EAAArB,GACA,GAAA+K,GAAAxJ,EAAAL,EAAAK,gBAAA,SAAAC,EAAAC,GACA,GAAAC,OAAAnD,UAAAoD,eAAAC,KAAAJ,EAAAC,GACA,MAAAD,GAAAC,GAKA,OAAA,0SACAP,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,aAAAA,EAAAA,IACA,sKACA,OAAA4J,EAAAxJ,EAAAH,EAAA,MAAAQ,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,gBAAA,MAAAb,EAAAI,EAAAJ,EAAA,mBAAAA,GAAAc,OAAA,KAAAC,UAAA8I,KAAA9J,EAAA+J,QAAA,EAAAjL,EAAA,GAAAkL,UAAAhK,EAAAoK,KAAAnJ,OAAAC,SAAAC,OAAA,GAAAC,SAAA,GAAAC,OAAAF,OAAA,GAAAC,SAAA,QAAAyI,EAAA,IACA,uEACA7J,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,QAAAA,EAAAA,IACA,sCACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,iBAAAA,EAAAA,IACA,KACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,QAAAA,EAAAA,IACA,uGACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,UAAAA,EAAAA,IACA,sCACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,mBAAAA,EAAAA,IACA,KACAD,EAAAW,iBAAAX,EAAAiK,OAAA,MAAAhK,EAAAI,EAAAJ,EAAA,UAAAA,EAAAA,IACA,8KAGA,OADAN,GAAA2B,gBAAA,oCAAA1B,GACAA,IC5CA5C,KAAAC,OAAA,2CAAA,cACAD,KAAAC,OAAA,oDCAAyd,QAAA,EAEAC,SAAA,EACAC,MAAA,IAGA5d,KAAAC,OAAA,yDCPA4d,mBAAA,wCACAC,qBAAA,gBACAC,oBAAA,sCACAC,sBAAA,iBACAtT,kBAAA,cACAC,wBAAA,uIACAsT,eAAA,gBACAC,aAAA,kBACAxP,UAAA,UACAiE,SAAA,SACAwL,SAAA,SACAC,eAAA,wBACAC,aAAA,OACAC,aAAA,UACAC,kCAAA,0HACAC,sCAAA,mHACAC,2BAAA,kIACAC,iBAAA,sBACAC,UAAA,mDACAC,SAAA,oBACAC,sBAAA,kBACAC,qBAAA,qBACAC,OAAA,mBCrBA/e,KAAAC,OAAA,8DAAA,SAAA,MAAA,sBAAA,SAAAwC,EAAAC,EAAAC,GACA,GAAAC,GAAAD,EAAAE,UAAA+J,IAAA,SAAA5J,EAAAC,EAAAC,EAAAC,EAAArB,GACA,GAAAsB,GAAAC,EAAAL,EAAAK,gBAAA,SAAAC,EAAAC,GACA,GAAAC,OAAAnD,UAAAoD,eAAAC,KAAAJ,EAAAC,GACA,MAAAD,GAAAC,GAKA,OAAA,kGACAP,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,iBAAA,MAAAD,EAAAI,EAAAJ,EAAA,eAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,cAAAC,UAAAC,OAAAC,SAAAC,OAAA,EAAAC,SAAA,IAAAC,OAAAF,OAAA,EAAAC,SAAA,OAAAhB,IACA,gLACAJ,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,kBAAA,MAAAD,EAAAI,EAAAJ,EAAA,gBAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,eAAAC,UAAAC,OAAAC,SAAAC,OAAA,GAAAC,SAAA,IAAAC,OAAAF,OAAA,GAAAC,SAAA,OAAAhB,IACA,sMACAJ,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,gBAAA,MAAAD,EAAAI,EAAAJ,EAAA,cAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,aAAAC,UAAAC,OAAAC,SAAAC,OAAA,GAAAC,SAAA,IAAAC,OAAAF,OAAA,GAAAC,SAAA,OAAAhB,IACA,4HACAJ,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,kBAAA,MAAAD,EAAAI,EAAAJ,EAAA,gBAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,eAAAC,UAAAC,OAAAC,SAAAC,OAAA,GAAAC,SAAA,IAAAC,OAAAF,OAAA,GAAAC,SAAA,OAAAhB,IACA,iCACA4b,IAAA,SAAAhc,EAAAC,EAAAC,EAAAC,EAAArB,GACA,GAAA+K,GAAAzJ,EAAAC,EAAAL,EAAAK,gBAAA,SAAAC,EAAAC,GACA,GAAAC,OAAAnD,UAAAoD,eAAAC,KAAAJ,EAAAC,GACA,MAAAD,GAAAC,GAKA,OAAA,kLACAP,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,oBAAA,MAAAD,EAAAI,EAAAJ,EAAA,kBAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,iBAAAC,UAAAC,OAAAC,SAAAC,OAAA,GAAAC,SAAA,IAAAC,OAAAF,OAAA,GAAAC,SAAA,OAAAhB,IACA,SACA,OAAAyJ,EAAAxJ,EAAAH,EAAA,MAAAQ,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,gBAAA,MAAAb,EAAAI,EAAAJ,EAAA,kBAAAA,GAAAc,OAAA,KAAAC,UAAA8I,KAAA9J,EAAA+J,QAAA,EAAAjL,EAAA,GAAAkL,UAAAhK,EAAA+J,QAAA,EAAAjL,EAAA,GAAAmC,OAAAC,SAAAC,OAAA,GAAAC,SAAA,GAAAC,OAAAF,OAAA,GAAAC,SAAA,QAAAyI,EAAA,IACA,UACA7J,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,oBAAA,MAAAD,EAAAI,EAAAJ,EAAA,kBAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,iBAAAC,UAAAC,OAAAC,SAAAC,OAAA,GAAAC,SAAA,GAAAC,OAAAF,OAAA,GAAAC,SAAA,OAAAhB,IACA,yCACA+J,IAAA,SAAAnK,EAAAC,EAAAC,EAAAC,EAAArB,GACA,GAAAsB,GAAAC,EAAAL,EAAAK,gBAAA,SAAAC,EAAAC,GACA,GAAAC,OAAAnD,UAAAoD,eAAAC,KAAAJ,EAAAC,GACA,MAAAD,GAAAC,GAKA,OAAA,6BACAP,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,wBAAA,MAAAD,EAAAI,EAAAJ,EAAA,sBAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,qBAAAC,UAAAC,OAAAC,SAAAC,OAAA,GAAAC,SAAA,IAAAC,OAAAF,OAAA,GAAAC,SAAA,OAAAhB,IACA,SACA6b,IAAA,SAAAjc,EAAAC,EAAAC,EAAAC,EAAArB,GACA,GAAAsB,GAAAC,EAAAL,EAAAK,gBAAA,SAAAC,EAAAC,GACA,GAAAC,OAAAnD,UAAAoD,eAAAC,KAAAJ,EAAAC,GACA,MAAAD,GAAAC,GAKA,OAAA,6BACAP,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,yBAAA,MAAAD,EAAAI,EAAAJ,EAAA,uBAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,sBAAAC,UAAAC,OAAAC,SAAAC,OAAA,GAAAC,SAAA,IAAAC,OAAAF,OAAA,GAAAC,SAAA,OAAAhB,IACA,SACAN,YAAA,EAAA,YAAAC,OAAA,SAAAC,EAAAC,EAAAC,EAAAC,EAAArB,GACA,GAAA+K,GAAAzJ,EAAAC,EAAAL,EAAAK,gBAAA,SAAAC,EAAAC,GACA,GAAAC,OAAAnD,UAAAoD,eAAAC,KAAAJ,EAAAC,GACA,MAAAD,GAAAC,GAKA,OAAA,sMACAP,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,gBAAA,MAAAD,EAAAI,EAAAJ,EAAA,cAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,aAAAC,UAAAC,OAAAC,SAAAC,OAAA,EAAAC,SAAA,IAAAC,OAAAF,OAAA,EAAAC,SAAA,OAAAhB,IACA,6DACA,OAAAyJ,EAAAxJ,EAAAH,EAAA,MAAAQ,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,gBAAA,MAAAb,EAAAI,EAAAJ,EAAA,cAAAA,GAAAc,OAAA,KAAAC,UAAA8I,KAAA9J,EAAA+J,QAAA,EAAAjL,EAAA,GAAAkL,UAAAhK,EAAA+J,QAAA,EAAAjL,EAAA,GAAAmC,OAAAC,SAAAC,OAAA,EAAAC,SAAA,GAAAC,OAAAF,OAAA,GAAAC,SAAA,OAAAyI,EAAA,IACA,mBAGA,OADAlK,GAAA2B,gBAAA,yDAAA1B,GACAA,ICvEA5C,KAAAC,OAAA,gEAAA,cC4BAD,KAAAC,OAAA,mEAAA,UAAA,OAAA,sBAAA,kBACA,sBAAA,kBAAA,oBAAA,iBACA,kCACA,iDACA,wDACA,6DACA,0CACA,8DACA,SAAAoW,EAAAkF,EAAArb,EAAAC,EAAAqE,EAAA6I,EAAA9I,EAAA2a,EAAAC,EACA7Y,EAAAxB,EAAAsa,EAAAra,GACA,YAEA,IAAAsa,IACAC,mBAAAxa,EAAA+Y,iBACA0B,qBAAAza,EAAAgZ,mBACA0B,sBAAA1a,EAAAsZ,aACAqB,mBAAA,EACAC,gBAAA,EACAC,2BAAA,EACAC,kBAAA,QAMAC,EAAArb,EAAAsJ,SAAAxN,QACAuC,WAAAuc,EACAla,YAAA,WACA,GAAA4a,IAAAD,EAAA3a,UAAA,wBAGA,OAFA4a,GAAA5d,KAAA,yBAAAxB,KAAAM,QAAA4e,iBACAE,EAAA5d,KAAAxB,KAAAqf,kBACA7f,EAAA8f,OAAAF,GAAAG,KAAA,MAGAF,iBAAA,WAGA,MAAA,2BAFAhb,EAAAmb,eAAAxf,KAAAM,QAAAwI,cACA,SAAA,UAIA/D,kBAAA,WACA,GAAA0a,GAAApb,EAAAmb,eAAAxf,KAAAM,QAAAwI,cACA1E,EAAAwZ,WAAAxZ,EAAAuZ,UACA,QACAJ,eAAAvd,KAAAM,QAAAue,mBACArB,aAAApZ,EAAAoZ,WACAkC,cAAA1f,KAAAC,UAAAD,KAAAC,SAAAc,MACA2c,eAAA1d,KAAAM,QAAAwe,oBACAa,aAAA3f,KAAA4f,aACAC,iBAAAxb,EAAAmb,eAAAxf,KAAAM,QAAAwI,cACA2W,iBAAAA,EACAK,aAAA9f,KAAA+f,iBACA5B,sBAAA3e,EAAAwgB,IAAAC,QAAA7b,EAAA+Z,oBAAAne,KAAA+f,kBACA3B,qBAAA5e,EAAAwgB,IAAAC,QAAA7b,EAAAga,mBAAApe,KAAA+f,oBAIA7a,MACAgb,OAAA,yBACAhC,SAAA,0BACAiC,UAAA,4BACAT,cAAA,kCACAU,gBAAA,kBACAX,iBAAA,+BAGAY,mBACAC,oBAAA,eACAC,mBAAA,iBAGAC,yBACAC,2BAAA,qBAGArb,SAAA,WACA,GAAAsb,IACArb,UAAA,YACAsb,0BAAA,aAEA,QAAA3gB,KAAAM,QAAA4e,iBACA,IAAA,OACAwB,EAAAlhB,EAAAI,OAAA8gB,EAAA1gB,KAAAqgB,iBACArgB,KAAAM,QAAA0e,eACA0B,EAAAlhB,EAAAI,OAAA8gB,GACAE,OAAA,SACAC,WAAA,aACAC,YAAA,cACAC,YAAA,gBAGA,MACA,KAAA,cACAL,EAAAlhB,EAAAI,OAAA8gB,EAAA1gB,KAAAwgB,uBACAxgB,KAAAM,QAAA0gB,iBACAN,EAAAlhB,EAAAI,OAAA8gB,EAAA1gB,KAAAqgB,kBAIA,MAAAK,IAGApb,cAAA,SAAAhF,GACAA,EAAAd,EAAAmM,SAAArL,EAAAqe,GACA7a,EAAAsJ,SAAA7H,MAAAvF,KAAAwF,WACAxF,KAAAihB,YAAA,EACAjhB,KAAAC,SAAAK,EAAAL,SACAD,KAAAsJ,gBAAAhJ,EAAAgJ,gBACAtJ,KAAAyJ,WAAAnJ,EAAAmJ,WACAzJ,KAAA8I,aAAAxI,EAAAwI,aACA9I,KAAAkf,gBAAA5e,EAAA4e,gBACAlf,KAAAmG,SAAAnG,KAAAyJ,WAAA,eAAAzJ,KAAAkhB,gBACAlhB,KAAAmG,SAAAnG,KAAAyJ,WAAA,oBAAA,WACAzJ,KAAAmhB,YAAAnhB,KAAAmhB,WAAA/f,KAAA,kBACApB,KAAAohB,kBAAAhS,SAAAiS,cACArhB,KAAAmhB,WAAAG,aAAA,QAEAthB,KAAAM,QAAA2e,yBAAAjf,KAAAohB,mBACA3hB,EAAAO,KAAAohB,mBAAAnb,QAAA,aAKAsb,aAAA,SAAA5Z,GAEA,OADAlI,EAAAkI,EAAAG,QACA0Z,GAAAxhB,KAAAsH,IAAAL,KAAA,sBACAjH,KAAAyhB,oBAAA9Z,IACA,IAKA+Z,qBAAA,SAAA/Z,GACAA,EAAAvG,KAAAugB,KACAC,mBAAA,GAGA3J,YAAA,SAAAtQ,GACA,GAAAC,IAAA,EACAC,EAAApI,EAAAkI,EAAAG,QACA+Z,EAAA7hB,KAAA8hB,iBAAA9hB,KAAA8hB,gBAAAxa,IAAA8M,IAAAvM,GAAA5G,OACA8gB,EAAAtiB,EAAA,kDACAiK,EAAAjK,EAAA,8DACAuiB,EAAArV,EAAAsV,aASA,SARAD,GAAAra,EAAAua,UAAAva,EAAAwa,UAAAH,IAAAra,EAAAua,SAAAva,EAAAwa,WACAta,EAAA2Z,GAAA,eAAA3Z,EAAA2Z,GAAA,cACA7Z,EAAA8Q,mBAIAzY,KAAAyJ,WAAAnC,IAAAL,KAAA,iBAAAhG,QACA0L,EAAAyV,gBAAA1Y,EAAAzC,KAAA,4BACAU,EAAAI,SACA,IAAA,IACA,IAAA,IAEAH,EADAC,EAAA2Z,GAAAxhB,KAAAkF,GAAAua,gBACAzf,KAAAqiB,oBAEAriB,KAAAuhB,WAAA5Z,EAEA,MACA,KAAA,IACAka,GACA7hB,KAAAsiB,eACAtiB,KAAAM,QAAAiiB,sBACAviB,KAAAkF,GAAAgb,MAAAlgB,KAAAkF,GAAAgb,KAAAja,QAAA,SACA2B,GAAA,IAEA5H,KAAAM,QAAAiiB,qBACA1a,EAAA2Z,GAAAxhB,KAAAsH,IAAAL,KAAA,sBACAjH,KAAAwiB,qBACA5a,GAAA,EAEA,MACA,KAAA,GACA,GAAAia,GAAA7hB,KAAAkf,kBAAA7a,EAAAoe,sBAOA9a,EAAAK,UAAAH,EAAA2Z,GAAA/hB,EAAA,mBAAA8H,WACAwa,EAAA9b,QAAA,SACA2B,GAAA,OATA,CACA,GAAAC,GAAApI,EAAAkI,EAAAG,OACAD,GAAA2Z,GAAAxhB,KAAAsH,IAAAL,KAAA,sBACAjH,KAAAkF,GAAAgZ,OAAAsD,GAAA,UAAAxhB,KAAAkF,GAAAgb,KAAAja,QAAA,SACAjG,KAAAkF,GAAAgZ,OAAAjY,QAAA,SACA2B,GAAA,GAMA,GAAAD,EAAAK,UAAAH,EAAA2Z,GAAA/hB,EAAA,oBAAA,CACA,GAAAyO,GAAAzO,EAAA2P,SAAAiS,eAAA3Q,QACA,kDAAAxC,QACAwU,EAAAjjB,EAAA,kDACAkjB,EAAAD,EAAAE,GAAA1U,EAAA,GAAA6O,SAAAlM,GAEA,IADA6R,EAAAE,GAAA1U,GAAA6O,SAAAlM,MAAA8R,EACA,CACA,GAAAE,GAAA3U,EAAA,EAAA,EAAAyU,EAAAljB,EAAA,gBAAA6Q,QAGA7Q,GAAA,cAAA6c,SACAwG,YAAAD,GACA,IAGA,KACA,UACAhb,EAAA2Z,GAAA,+BAAA3Z,EAAA2Z,GAAA,iCAEA5Z,GAAA,GAGA,MAAAA,IAGA6Z,sBAAA,SAAA9Z,GACA3H,KAAAsH,IAAAJ,SAAA,2BACAlH,KAAAM,QAAAiiB,oBAEAviB,KAAA+iB,aAAApb,GAEA3H,KAAAsH,IAAAL,KAAA,wCACAjH,KAAAsH,IAAAL,KAAA,uCAAAM,QAAAtB,QAAA,UAIAuc,qBAAA,WACAxiB,KAAAsH,IAAA0H,YAAA,2BACAhP,KAAAkF,GAAAkb,cAAAna,QAAA,SACAjG,KAAAsiB,gBAGAvC,iBAAA,WACA,MAAA/f,MAAAC,UAAAD,KAAAC,SAAAc,MAAAf,KAAAC,SAAAc,MACAf,KAAAM,SAAAN,KAAAM,QAAAwI,cACA9I,KAAAM,QAAAwI,aAAAhI,KAAAkiB,MAAA,KAAAC,OAGAC,uBAAA,WAGA,QAAAC,KACA,GAAAC,GAAA/e,EAAAmb,eAAA6D,EAAA/iB,QAAAwI,eACAua,EAAA5Z,WAAAnC,IAAAL,KAAA,iBAAAhG,QACA0L,EAAAyV,gBAAAiB,EAAA5Z,WAAAnC,IACA,IAAA0T,GAAAqI,EAAA/b,IAAAL,KAAA,mBACAqc,EAAAD,EAAAtD,iBACAd,EAAAoE,EAAA/iB,QAAA2e,uBAOA,IANAoE,EAAA/iB,QAAAijB,wBACAD,EAAA,IAAAD,EAAA/iB,QAAAijB,sBACAvI,EAAAA,EACAtK,QAAA,wBAAA8S,SAAA,sCACAvc,KAAA,oBAEA,SAAAoc,EAAA/iB,QAAA4e,iBAAAD,EAEA,CACAmE,GAAApI,EAAAjD,KAAA,cAAAqL,EACA,IAAAK,GAAAzI,EAAAjD,KAAA,eAAA3T,EAAAwZ,WAAAxZ,EAAAuZ,WACApT,EAAA0U,EAAA7a,EAAA0Z,oCACA1Z,EAAAyZ,+BACAyF,GAAA9jB,EAAAwgB,IAAAC,QAAA1V,EAAA+Y,EAAAG,OANAH,GAAA9jB,EAAAwgB,IAAAC,QAAA7b,EAAA2Z,yBAAAuF,EAQAtI,GACAjD,KAAA,WAAA,GACAA,KAAA,aAAAuL,GA1BAtjB,KAAAyJ,WAAAnC,IAAAoc,KACA,IAAAL,GAAArjB,IA4BAA,MAAAmG,SAAAnG,KAAAyJ,WAAA,cAAA0Z,GACAA,KAGAQ,kBAAA,WACA,QAAA3jB,KAAA8I,eAAAtJ,EAAAokB,QAAA5jB,KAAA8I,eACA9I,KAAA8I,aAAAhI,OAAAqe,EAAA0E,mBACA,uBAAA7jB,KAAA8I,aAAAhI,MAGA8e,aAAA,WACA,MAAA5f,MAAAkf,kBAAA7a,EAAAoe,uBAGAjc,WAAA,WACA,IAAAxG,KAAA2jB,kBAGA,WAFA3jB,MAAAkjB,sBAIA,IAAAxT,GAAA1P,IACAA,MAAA8jB,gBAAA5Q,KAAA,SAAAjT,GACA,GAAA8jB,GAAA9jB,EAAAoG,cAAA,iCACA,8BACAqJ,GAAApI,IAAAJ,SAAA6c,GAEA,SAAArU,EAAApP,QAAA4e,kBACAxP,EAAApI,IAAA1E,SAAAqE,KAAA,oBAAAhG,OACAyO,EAAAxK,GAAAgb,KACAnI,KACA,aACAvY,EAAAwgB,IAAAC,QAAA7b,EAAA6Z,QAAAhe,EAAAc,QACAgX,KAAA,QAAAvY,EAAAwgB,IAAAC,QAAA7b,EAAAia,KAAApe,EAAAc,QAEA2O,EAAAxK,GAAAgb,KAAAnI,KACA,aACAvY,EAAAwgB,IAAAC,QAAA7b,EAAA4Z,eAAA/d,EAAAc,QAGA2O,EAAAxK,GAAAgZ,OAAAnG,KACA,aACAvY,EAAAwgB,IAAAC,QAAA7b,EAAA8Z,OAAAje,EAAAc,SAGA2O,EAAAxK,GAAAwa,YAAAlO,KAAAvR,EAAAc,OACA2O,EAAAzP,SAAA+jB,iBACAtU,EAAAuU,iCACAvU,EAAAkQ,cAAAlQ,EAAApP,QAAA0gB,gBACAtR,EAAAwT,uBACAxT,EAAAwU,mBAAA,WACA,IAAAlkB,KAAAmkB,YAAA,CAIA,GAAAC,KAAA1U,EAAA5G,aAAAxI,UACAoP,EAAA5G,aAAAxI,QAAA+jB,mBACA3U,EAAA5G,aAAAxI,QAAAgkB,qBACAC,EAAA7U,EAAA8U,sBAAA,GAAA,EAEA9U,GAAAoS,gBAAAxb,QAAA,WACAoJ,EAAApI,IAAAJ,SAAA,yBACAwI,EAAApI,IAAAJ,SAAA,wBACAkd,IAAAG,GACA7U,EAAA+U,oBAAAxkB,GAAA,UAKAyP,EAAApI,IAAAJ,SAAA,wBACAwI,EAAAwT,2BAKAwB,YAAA,WACA1kB,KAAA8hB,iBAAA9hB,KAAA8hB,gBAAAxK,WAGA2M,iCAAA,WACA,IAAA5f,EAAAsgB,mBAAA3kB,KAAA8I,aAAA9I,KAAAkf,kBACAlf,KAAAkf,kBAAA7a,EAAAugB,mBACAvgB,EAAAwgB,iBAAA7kB,KAAA8I,cAGA,WADA9I,MAAAkjB,sBAGAljB,MAAAsH,IAAAJ,SAAA,qCACAlH,MAAA8I,aAAAxI,QAAA+jB,kBACArkB,KAAAmG,SAAAnG,KAAAyJ,WAAA,wBAAA,SAAAnJ,SACAN,MAAA8I,aAAAxI,QAAA+jB,kBACArkB,KAAA8kB,qBAAAxkB,EAAAA,EAAAykB,SAAA,KAEA/kB,KAAAmG,SAAAnG,KAAAyJ,WAAA,gBAAAzJ,KAAAglB,iBACAhlB,KAAAmG,SAAAnG,KAAAyJ,WAAA,iBAAAzJ,KAAAilB,SAIA/D,iBAAA,SAAA5gB,GACAN,KAAAM,QAAAd,EAAAI,UAAAI,KAAAM,QAAAqe,EAAAre,GACAN,KAAAkF,GAAAgZ,OAAAnG,KAAA,QAAA/X,KAAAM,QAAAue,qBAGAkE,eAAA,SAAApb,GACA3H,KAAAmkB,aAGAnkB,KAAA2jB,oBAKAhc,EAAA4Q,iBACA5Q,EAAA8Q,kBACAzY,KAAAkF,GAAAgZ,OAAAsD,GAAA7Z,EAAAG,UAKA9H,KAAA8jB,gBAAA5Q,KAAA,SAAAjT,GACAD,KAAAykB,oBAAAxkB,IACAiG,KAAAlG,OACAP,EAAA,8DAAAikB,IAAA,SAAA1jB,KAAAklB,KAAA1V,GACA,aAAAxP,KAAAklB,KACAvD,OAAA3hB,MAEAA,KAAA0hB,uBAGA+C,sBAAA,SAAAxkB,EAAAklB,GACA,IAAAnlB,KAAAmkB,YAAA,CAOA,GAHAxX,EAAAyY,UAAAhW,SAAAiS,eACAjS,SAAAiS,cAAAgE,OAEArlB,KAAAmhB,YAAAnhB,KAAAmhB,WAAA/f,KAAA,gBAGA,WADApB,MAAAmhB,WAAAG,aAAA,UAGAthB,MAAAsH,IAAAoJ,QAAA,mBAAAzJ,KAAA,iBAAAhG,SACAjB,KAAAslB,iBACAH,KAKAnlB,KAAAulB,6BAEAvlB,KAAA8hB,gBAEA9hB,KAAAwlB,eAEAxlB,KAAAkkB,wBAIAoB,gBAAA,WACAtlB,KAAAsH,IAAAoJ,QAAA,mBAAAzJ,KAAA,IAAAkY,EAAA3a,UACA,8BAAA8c,aACA,YAGA4C,qBAAA,SAAAuB,GACAzlB,KAAA8hB,gBAAA,GAAAlc,GAAApG,EAAAmM,UACA9F,UAAA7F,KAAAsJ,gBAAAhJ,QAAAuF,QACA5F,WAAAD,KAAAC,UACAD,KAAAM,UACAmlB,GACAzlB,KAAA8hB,gBAAA9b,aAAAhG,KAAA8hB,gBAAA,cAAA2D,GAEAzlB,KAAA8hB,gBAAA1R,SACApQ,KAAA8hB,gBAAA3b,SAAAnG,KAAA8hB,gBAAA,eACA9hB,KAAA0lB,eAAAxf,KAAAlG,QAGAulB,6BAAA,WACA,GAAAI,GAAA3lB,KAAA4lB,4BACA5lB,MAAAmhB,WAAAnhB,KAAAsH,IAAAL,KAAA,sBAAA0e,EAAAE,WACAF,EAAAG,SACAH,EAAAE,UAAA,SAAAF,EAAAE,UAAA,OAAA,SAEA7lB,KAAA6lB,UAAAF,EAAAE,UACA7lB,KAAA+lB,kBAAAtmB,EACA,4MACAO,KAAA+lB,kBAAAxV,IAAA,YAAAoV,EAAAK,eAAA,OAMAR,eAAA,WACA,GAAAS,IACAC,QAAA,EACAC,UAAAnmB,KAAA8hB,gBAAA7N,GACAhO,UAAA,SACAmgB,YACAC,WAAArmB,KAAAM,QAAAgJ,iBAAAtJ,KAAAM,QAAAgJ,gBAAAhC,IAAA1E,SAAA,GACA0jB,UAAA,IAEAT,YAAA7lB,KAAA6lB,UACA1jB,WAAAnC,KAAA+lB,kBACAxK,aAAA,EAEAvb,MAAAmhB,WAAAG,aAAA2E,GACAjmB,KAAAmhB,WAAAuC,IAAA,uBACAlU,GAAA,sBAAAxP,KAAAumB,mBAAArgB,KAAAlG,OACAA,KAAAmhB,WAAAG,aAAA,QAEAthB,KAAA8hB,gBAAA/a,cAAA/G,KAAA+lB,mBACA/lB,KAAA8hB,gBAAAxa,IAAAL,KAAA,wBAAAhB,QAAA,wBACAjG,KAAAwmB,yBACAxmB,KAAA8hB,gBAAA7b,QAAA,mBAGA,IAAAe,GAAAhH,KAAAmhB,WAAAtI,KAAA,iBACA4N,EAAAjnB,EAAAknB,SAAA,kBACAC,EAAA3f,EAAAC,KAAA,uBACA0f,KACAA,EAAA5O,KAAA,KAAA0O,GACAE,EAAAT,KAAAlmB,KAAAC,SAAAc,OACAiG,EAAA+Q,KAAA,kBAAA0O,IAEAhnB,EAAA,8DAAA+P,GAAA,WAAAxP,KAAAklB,KAAA1V,GACA,aAAAxP,KAAAklB,KACAvD,OAAA3hB,MAEAA,KAAA0hB,qBAGAY,eAAA,WACAtiB,KAAAmhB,YAAAnhB,KAAAmhB,WAAAG,aAAA,WACA7hB,EAAA,8DAAAikB,IAAA,WAAA1jB,KAAAklB,KAAAxB,IACA,aAAA1jB,KAAAklB,MAGAsB,yBAAA,WACA/mB,EAAA,8CAAAikB,IAAA,SAAA1jB,KAAAklB,KAAA1V,GACA,SAAAxP,KAAAklB,KACAvD,OAAA3hB,MAEAA,KAAA4mB,uBACAnnB,EAAA,mBAAAikB,IAAA,SAAA1jB,KAAAklB,KAAA1V,GAAA,SAAAxP,KAAAklB,KACAvD,OAAA3hB,MACAA,KAAA4mB,uBACAnnB,EAAA8S,QAAAmR,IAAA,SAAA1jB,KAAAklB,KAAA1V,GAAA,UAAAxP,KAAAklB,KACAvD,OAAA3hB,MACAA,KAAA6mB,uBAGAA,uBAAA,SAAAlf,GACAA,EAAAvG,KAAAugB,KAEAW,gBAGAwE,2BAAA,WACArnB,EAAA,8CAAAikB,IAAA,SAAA1jB,KAAAklB,IACAllB,KAAA4mB,uBACAnnB,EAAA,mBAAAikB,IAAA,SAAA1jB,KAAAklB,IAAAllB,KAAA4mB,uBACAnnB,EAAA8S,QAAAmR,IAAA,UAAA1jB,KAAAklB,IAAAllB,KAAA6mB,uBAMAN,qBAAA,WACAvmB,KAAA+mB,wBACA/mB,KAAA8mB,iCACA9mB,MAAA8I,aAAAxI,QAAAgkB,oBACAtkB,KAAAwkB,sBAAA,GACAxkB,KAAAgnB,8BAGAD,wBAAA,WACA,GAAAzmB,GAAAN,KAAA8hB,gBAAA5Z,YACA6c,EAAA/kB,KAAA8hB,gBAAAvZ,UACA/I,GAAAynB,WAAAjnB,KAAAyJ,WAAAyd,yBACAnC,EAAAA,GAAA/kB,KAAAyJ,WAAAyd,sBAAA5mB,GAEA,IAAAmjB,GAAAsB,EAAA,cAAA,UACA/kB,MAAAsH,IAAAmc,GAAA,+BAGAuD,6BAAA,WACA,GAAAG,GAAA1nB,EAAA,gDACA2nB,EAAA3nB,EAAA,wBAAAwH,KAAA,+BAAAhG,OAAA,CACAkmB,GAAAE,KAAA,WAAAD,IAYA5C,uBAAA,SAAA8C,EAAAC,GACA,GAAAxC,GAAA/kB,KAAA8hB,gBAAAvZ,WACAjI,EAAAN,KAAA8hB,gBAAA5Z,WACAqf,GAAA/nB,EAAAoM,YAAA2b,IAAAD,EAAAC,CACA,IAAAhD,GAAAvkB,KAAA8kB,qBAAAxkB,EAAAykB,EAAAuC,EACAC,EAEA,OADAvnB,MAAAgnB,6BACAzC,GAGAO,uBAAA,SAAAxkB,EAAAykB,EAAAuC,EAAAC,GACAjnB,EAAAA,KACA,IAAAknB,GAAAxnB,KAAA8I,aAAAxI,YACAmnB,EAAAjoB,EAAAkoB,QAAAF,EAAAlnB,EAQA,IAPAN,KAAAsJ,gBAAArD,QAAA,yBACAwD,aAAAzJ,KAAAyJ,WACAsb,UAAAA,EACAzkB,UAAAA,EACAinB,aAAAA,KAGAE,GAKA1C,IAEA/kB,KAAAC,SAAAsG,WAAA+gB,GAAAE,EAAAnD,mBAAA,CAGA,GAAAsD,GAAA3nB,KAAA8I,aAAAhI,IACA,IAAAd,KAAA6I,mBAAA,CAGA8e,EADA3nB,KAAA8I,aAAAxI,QAAAiO,OACAoG,GAEA6S,EAAAnD,oBACA/jB,EAAAd,EAAAI,QAAA0kB,sBAAAkD,EAAAnD,mBAAA/jB,GAEA,IAAAsnB,IACA9mB,OAAA6mB,EACA9d,OAAA7J,KAAA8I,aAAAe,KACAvJ,UAAAA,EACA4kB,MAAA1lB,EAAAknB,SAAA,QAGA,OADA1mB,MAAAsJ,gBAAArD,QAAA,iBAAAjG,KAAAyJ,WAAAme,IACA,IAQAhB,wBAAA,SAAAjf,GACA,GAAA+H,GAAA/H,EAAAvG,KAAAugB,IACA,OAAAliB,GAAAkI,EAAAG,QAAA4I,QAAA,iBAAAzP,QAAAyO,EAAAkS,uBAEAlS,EAAAkS,mBAAA,GAGA9d,EAAA+jB,eAAAlgB,EAAAG,aAKA4H,EAAApI,IAAAka,GAAA7Z,EAAAG,SACA4H,EAAApI,IAAA8M,IAAAzM,EAAAG,QAAA7G,SAAAyO,EAAAxK,GAAAgZ,OAAAsD,GAAA7Z,EAAAG,SACA4H,EAAAjG,WAAAnC,IAAAka,GAAA7Z,EAAAG,SAAA4H,EAAAjG,WAAAnC,IAAA8M,IAAAzM,EAAAG,QAAA7G,SAIAyO,EAAAoX,2BACApX,EAAA4S,qBAVA5S,GAAAjG,WAAAxD,QAAA,sBAaAyf,iBAAA,SAAAxlB,GACAA,EAAAmD,OAAAuC,EAAAgF,oBAEA5K,KAAAsJ,gBAAArD,QAAA,qBAAAjG,KAAAM,QAAAmJ,WAAAvJ,EAAA4nB,OAEA9nB,KAAAmhB,WAAAG,aAAA,YAIAthB,KAAAM,QAAA2e,0BACAjf,KAAAwkB,sBAAA,GAAA,GACAxkB,KAAAyJ,WAAAxD,QAAA,uBAIA8hB,yBAAA,WAIA/nB,KAAA8hB,gBAAAxa,IAAAJ,SAAA,uBACAlH,KAAA8hB,gBAAAxa,IAAAJ,SAAA,uBACAlH,KAAA8hB,gBAAAxa,IAAAmJ,SAAArB,SAAA2C,MACA/R,KAAA8hB,gBAAAxa,IAAAL,KAAA,wBAAAhB,QAAA,uBACA,IAAA+hB,GAAAhoB,KAAA8hB,gBAAAxa,IAAA+I,OAMA,OALArQ,MAAA8hB,gBAAAxa,IAAAL,KAAA,wBAAAhG,OAAA,IACA+mB,GAAAhoB,KAAA8hB,gBAAAxa,IAAAL,KAAA,wBAAA,GAAAghB,YACAjoB,KAAA8hB,gBAAAxa,IAAAL,KAAA,wBAAA,GAAAihB,aAEAloB,KAAA8hB,gBAAAxa,IAAA0H,YAAA,uBACAgZ,GAGAG,8BAAA,WACA,GAEAC,IAFApoB,KAAAsH,IAAA+I,QAEA5Q,EAAA2P,UAAAiB,SACAgY,EAAAroB,KAAAsH,IAAAL,KAAA,2BAAA8V,SAAAjM,KACAwX,EAAAF,EAAApoB,KAAAsH,IAAAL,KAAA,4BAAA8V,SAAAjM,IAwBA,QArBA2G,SACAoO,YAAA,QACAC,UAAA,EACAE,iBAAAsC,GAEAC,aACA1C,YAAA,QACAC,UAAA,EACAE,iBAAAoC,EAAAE,GAEAxX,QACA+U,YAAA,OACAC,UAAA,EACAE,iBAAAqC,GAEAG,YACA3C,YAAA,OACAC,UAAA,EACAE,iBAAAoC,EAAAC,KAMAzC,6BAAA,WACA,GAGA6C,GAAAC,EAAAC,EAHAvN,EAAAP,GAAAA,EAAAQ,SAAAC,IACA0M,EAAAhoB,KAAA+nB,yBAAA,GACAa,EAAA5oB,KAAAmoB,8BAGAU,EAAAzN,GAEAwN,EAAAL,UAAAK,EAAAJ,SAAAI,EAAA9X,KAAA8X,EAAAnR,QADAmR,EAAAnR,MAAAmR,EAAA9X,KAAA8X,EAAAJ,SAAAI,EAAAL,UAGA,KAAAE,EAAA,EAAAA,EAAAI,EAAA5nB,OAAAwnB,IAAA,CACA,GAAAK,GAAAD,EAAAJ,EACA,IAAAT,EAAAc,EAAA9C,eAAA,CACA0C,EAAAI,CACA,SAEAH,GAAAG,EAAA9C,eAAA2C,EAAA3C,kBACA2C,EAAAG,GASA,MANAJ,KAEAA,EAAAC,GAEAD,EAAA1C,gBAAA,GAEA0C,GAGA7f,mBAAA,WACA,MAAA7I,MAAA8I,aAAAhI,OAAAqe,EAAA4J,mBAGAC,uBAAA,WACA,GAAA3iB,IAAA,CACArG,MAAAC,UAAAD,KAAAC,SAAAE,QAAAH,KAAAC,SAAAE,OAAAC,aACAZ,EAAAokB,QAAA5jB,KAAAC,SAAAE,OAAAC,cAEAiG,GAAA,GAEArG,KAAAC,SAAAoG,cAAAA,GAIAyd,gBAAA,WACA,OAAAvQ,KAAAvT,KAAAC,SAEA,MADAD,MAAAgpB,uBACAvpB,EAAAwpB,WAAAC,QAAAlpB,KAAAC,SAEA,IAAAD,KAAA6I,mBAIA,MADA7I,MAAAC,SAAAD,KAAA8I,aAAAxI,QAAAiO,OAAAT,IAAA,YACA9N,KAAA8jB,eAEA,IAAAqF,GAAA1pB,EAAAwpB,WACAjZ,EAAA,GAAAyO,IACA9J,KAAA3U,KAAA8I,aAAAhI,MASA,OAPAkP,GAAAiD,QAAAmW,KAAA5pB,EAAA0G,KAAA,WACAlG,KAAAC,SAAA+P,EAAAlC,IAAA,YACA9N,KAAAgpB,uBACAG,EAAAD,QAAAlpB,KAAAC,WACAD,MAAA,SAAAqpB,GACAF,EAAAG,OAAAD,KAEAF,EAAAI,WAGAC,gBAAA,SAAA7hB,GAGA,GAFA3H,KAAAslB,gBACA3d,EAAA4Q,iBACAvY,KAAAM,QAAAye,gBAEA,CACA,GAAArP,GAAA1P,KACAkO,EAAAlO,KAAAsH,IAAAW,QAAA,kDAAAiG,OACA5O,MAAAqW,SAAA,wCAAA,SAAA8T,GACAA,EAAAC,gBAAAha,EAAApP,QAAAse,iBACAlP,EAAApP,QAAAue,oBAEAvE,WACAC,WAAA,EACAC,WAAApW,EAAA6N,OACAyI,UAAA,EACAC,UAAAvW,EAAAqZ,UAGAf,OAAA,SAAAiN,GACAA,GACAja,EAAAsV,kBACAtV,EAAAka,0BAAA1b,IAEAwB,EAAAxK,GAAAgZ,OAAAjY,QAAA,iBApBAjG,MAAAglB,mBA4BA4E,4BAAA,SAAA1b,GACAzO,EAAA,kDAAAmjB,GAAA1U,GAAAsV,SACA,0BAAAvc,KAAA,mBACAhB,QAAA,UAGA+e,kBAAA,WACAhlB,KAAAsJ,gBAAArD,QAAA,gBAAAjG,KAAAyJ,YAEAzJ,KAAAsJ,gBAAAhJ,QAAAuF,QAAAI,QAAA,uBACAwd,SAAA,SACAzT,cAAAhQ,KAAAyJ,WAAA3D,MAAAgI,IAAA,YAGA9N,KAAAgnB,8BAGA6C,mBAAA,SAAAjC,EAAAkC,GACA,GAAA7pB,GAAA2nB,EAAA9Z,IAAA,gBACAqC,GACArP,OAAA8mB,EAAAjT,GACA9K,OAAA5J,EAAA4J,KAEAxF,GAAA0lB,wBAAA9pB,KAEAkQ,GACArP,OAAAqe,EAAA4J,kBACAlf,OAAA5J,EAAA4J,KACAvJ,WACAA,aACAiO,SAAAqZ,KAIAzX,EAAA7P,QAAAd,EAAAI,QAAAykB,qBAAA,GAAAlU,EAAA7P,SACAN,KAAAsJ,gBAAArD,QAAA,iBAAAjG,KAAAyJ,WAAA0G,GAEAnQ,KAAAsJ,gBAAAhJ,QAAAuF,QAAAI,QAAA,uBACAwd,SAAAqG,EAAA,UAAA,MACA9Z,cAAAG,EACAsD,iBAAAqW,KAIAE,aAAA,SAAAriB,GACAA,EAAA4Q,kBAGA0R,cAAA,SAAAtiB,GACAA,EAAA4Q,iBACAvY,KAAAihB,cACAjhB,KAAAsH,IAAA4iB,SAAA,iCAAAhjB,SAAA,qBAGAijB,cAAA,WAEA,MADAnqB,KAAAihB,aAEAjhB,KAAAsH,IAAA4iB,SAAA,iCAAAlb,YAAA,qBAIAob,uBAAA,SAAAziB,GACA,GAAA0iB,GAAA1iB,EAAAyJ,cAAAc,aAAAoY,QAAA,OACA,IAAAD,EAGA,IAEA,MADA,IAAA5L,GAAAzV,KAAAC,MAAAohB,IAEA,MAAAlZ,GAEA,OAAA,IAIA8T,SAAA,SAAAtd,GACAA,EAAA4Q,iBACAvY,KAAAmqB,aACA,IAAAvC,GAAA5nB,KAAAoqB,qBAAAziB,EACA,IAAAigB,EAGA,GAAA5nB,KAAA8I,aAAAhI,OAAAqe,EAAA0E,kBACA7jB,KAAA6pB,iBAAAjC,OACA,CACA,GAAAlY,GAAA1P,IACAV,MAAAqW,SAAA,wCAAA,SAAA8T,GACAA,EAAAC,gBAAAtlB,EAAAiZ,kBAAAjZ,EAAAkZ,qBACAhD,WACAC,WAAA,EACAC,WAAApW,EAAA4J,QACA0M,UAAA,EACAC,UAAAvW,EAAAqZ,UAGAvK,KAAA,SAAAqX,GACAA,GACA7a,EAAAma,iBAAAjC,EAAAlY,EAAA5G,oBAOA0hB,gBAAA,WACA,GAAAhmB,GAAAhF,EAAAmqB,OAAA3pB,KAAA,YACAA,MAAAsH,IAAAyQ,KAAA,QAAAvT,IAGAimB,uBAAA,SAAAC,GACA1qB,KAAAsH,IAAA0H,YAAAhP,KAAAqf,kBACAhb,EAAAsmB,gBAAA3qB,KAAA8I,aAAA4hB,GACA1qB,KAAA8kB,qBAAA9kB,KAAA8I,aAAAxI,SAAA,GAAA,GACAN,KAAAsH,IAAAJ,SAAAlH,KAAAqf,mBAGAgD,oBAAA,WACA,GAAAuI,EAuBA,OAtBAvmB,GAAAmb,eAAAxf,KAAAM,QAAAwI,eACA9I,KAAAsJ,gBAAArD,QAAA,qBAAAjG,KAAAyJ,YACAzJ,KAAAyqB,sBAAA,GACAzqB,KAAAsJ,gBAAArD,QAAA,cAAAjG,KAAAyJ,YACAmhB,EAAAxmB,EAAAuZ,WACA3d,KAAAkF,GAAAua,eAAA1H,KAAA,aACAvY,EAAAwgB,IAAAC,QAAA7b,EAAA+Z,oBAAAne,KAAA+f,mBACAhI,KAAA,QACA6S,GAAApZ,KAAAoZ,KAEA5qB,KAAAsJ,gBAAArD,QAAA,qBAAAjG,KAAAyJ,YACAzJ,KAAAyqB,sBAAA,GACAzqB,KAAAsJ,gBAAArD,QAAA,cAAAjG,KAAAyJ,YACAmhB,EAAAxmB,EAAAwZ,WACA5d,KAAAkF,GAAAua,eAAA1H,KAAA,aACAvY,EAAAwgB,IAAAC,QAAA7b,EAAAga,mBAAApe,KAAA+f,mBACAhI,KAAA,QACA6S,GAAApZ,KAAAoZ,IAEA5qB,KAAAsH,IAAAL,KAAA,mBAAA8Q,KAAA,aACAvY,EAAAwgB,IAAAC,QAAA7b,EAAAyZ,gCAAA7d,KAAA+f,iBACA6K,KACA,KAIApmB,YAAA,oCACAukB,oBAAA,qDACAlF,oBAAA;8EACAjZ,qBAAA,gBA0GA,OAvGA9G,GAAA+mB,SAAAjrB,QACA+L,YACAmf,sBAAA,8CAGAxlB,cAAA,SAAAhF,EAAAqhB,GACArhB,IAAAA,MACAA,EAAAgJ,gBAAAhJ,EAAAgJ,iBAAAqY,EACA3hB,KAAAsJ,gBAAAhJ,EAAAgJ,gBACAxF,EAAA+mB,SAAAlrB,UAAA2F,YAAAC,MAAAvF,KAAAwF,WACAxF,KAAA2hB,KAAAA,EACAniB,EAAAI,OAAAI,KAAAsJ,iBACAyhB,2BAAA,WACA,OACAjqB,OAAAqe,EAAA0E,kBACAvjB,kBAMA0qB,uBAAA,WAKA,GAJAxrB,EAAAyrB,SAAAjrB,KAAAkrB,aAEAlrB,KAAAkrB,UAAAlrB,KAAAM,QAAA2T,GAAAxU,EAAAO,KAAAM,QAAA2T,IAAAjU,KAAA2hB,KAAAra,MAEAtH,KAAAkrB,WAAA,IAAAlrB,KAAAkrB,UAAAjqB,OACA,KAAA,IAAA6C,GAAAqnB,MAAA,WAAAnrB,KAAAkrB,UAAA7E,SAAA,qBAEA,QAAA,GAGA+E,qBAAA,WAEA,GADAprB,KAAAgrB,yBACAhrB,KAAAkrB,UAAA1H,SAAA,IAAArE,EAAA3a,WAAAvD,OAAA,GAAA,CAMA,GAAA6H,GAAA9I,KAAAqrB,6BACA,KAAAviB,EACA,KAAA,IAAAhF,GAAAqnB,OACA9nB,OAAA,6BACAioB,UAAA,sCAGAtrB,MAAAurB,aAAAvrB,KAAAkrB,UAAA9W,IAAApU,KAAAurB,YAAAjkB,KAAArG,QACAzB,EAAAkoB,QAAA5e,EAAA9I,KAAAM,QAAAwI,gBAIA9I,KAAAurB,aAAAvrB,KAAAurB,YAAAjU,UACAtX,KAAAurB,YAAA,GAAApM,GACA3f,EAAAI,OAAAI,KAAAM,SACAmJ,aAAAzJ,KAAA2hB,KACA7Y,eAAAA,KAEA9I,KAAAurB,YAAAnb,SACApQ,KAAAkrB,UAAAhX,OAAAlU,KAAAurB,YAAAtX,IACAjU,KAAAkrB,UAAAhkB,SAAA,6BAEAlH,KAAAkrB,UAAA9pB,KAAA,eACAyF,cACA5G,WAAA6I,KAGAA,EAAAhI,OAAAqe,EAAA0E,mBAEA7jB,KAAAkrB,UAAAlc,YAAA,0BAIAqc,8BAAA,WACA,MAAArrB,MAAA2hB,KAAA7b,OAAA9F,KAAA2hB,KAAA7b,MAAAgI,IAAA,UAEA9N,KAAA2hB,KAAA7b,MAAAgI,IAAA,UAEA9N,KAAA2hB,KAAA6J,qBAAAhsB,EAAAynB,WAAAjnB,KAAA2hB,KAAA6J,qBAEAxrB,KAAA2hB,KAAA6J,sBAEAxrB,KAAAM,QAAAwI,aAEAtJ,EAAAmqB,OAAA3pB,KAAAM,QAAA,oBAFA,IAMAkG,WAAA,WACAxG,KAAAM,QAAA2e,yBAAAjf,KAAA2hB,KAAA8J,aAGAzrB,KAAAorB,qBACAprB,KAAAurB,aAAAvrB,KAAAurB,YAAAvE,+BAGAtC,YAAA,WACA1kB,KAAAurB,aAAAvrB,KAAAurB,YAAAjU,UACAtX,KAAAurB,gBAAAhY,QASAjU,KAAAC,OAAA,qCAAA,sBAAA,kBAAA,oBAAA,sBCnkCA,kBACA,qDACA,+CACA,0CACA,0DACA,qCACA,qCACA,gDACA,gDACA,6CACA,wCACA,OACA,wCACA,kEACA,mCACA,SAAAC,EAAAC,EAAAoE,EAAAC,EAAA6I,EAAA+e,EAAAzV,EAAA5R,EACAsnB,EACAC,EAAAC,EAAAC,EAAAC,EAAA3nB,EAAAjC,EAAA0Y,GAEA,GAAAmR,GAEAC,EAAAnoB,EAAAsJ,SAAAxN,QACA4E,YAAA,WACA,GAAA4a,IAAA,OAAA,iBAEA,OADAA,GAAA5d,KAAA,aAAAxB,KAAAM,QAAAyF,MACAvG,EAAA8f,OAAAF,GAAAG,KAAA,MAGApd,WAAAA,EAEA4C,kBAAA,WACA,OACAmnB,YAAA9nB,EAAA8nB,UACAC,OAAA/nB,EAAA+nB,KACAC,gBAAAhoB,EAAAgoB,cACA3O,SAAArZ,EAAAqZ,OACA4O,kBAAAjoB,EAAAioB,gBACAC,QAAAloB,EAAAkoB,MACAC,iBAAAnoB,EAAAmoB,eACAC,kBAAAxsB,KAAA+F,OAAA1B,EAAAugB,mBACA5kB,KAAAM,QAAAoJ,YAAA0K,IAAA,mBACApU,KAAAM,QAAAoJ,YAAA0K,IAAA,SAIAlP,MACAunB,YAAA,oCACAC,aAAA,4BACAC,UAAA,gCACAxF,UAAA,0BACAyF,YAAA,gCACAC,WAAA,4BAGAznB,UACA0nB,uBAAA,eACAC,oBAAA,eACAC,oBAAA,cACAC,qBAAA,eACA5nB,UAAA,aAGAC,cAAA,SAAAhF,GACAA,IAAAA,MACAd,EAAAmM,SAAArL,GACA4sB,eAAAltB,KAAAktB,aAAAhnB,KAAAlG,MACAsC,YAAA8M,SAAA2C,KACAhM,OAAA1B,EAAAoe,wBAEAniB,EAAAgC,UAAA7C,EAAAa,EAAAgC,WACAtC,KAAA6F,QAAAvF,EAAAuF,QACA7F,KAAAmtB,iBAAAntB,KAAA6F,QAAAunB,SAAAzB,GACA3rB,KAAA+F,KAAAzF,EAAAyF,KACA/F,KAAAqtB,gBAAA/sB,EAAAoJ,aACA5F,EAAAsJ,SAAAzN,UAAA2F,YAAAtC,KAAAhD,KAAAM,GACAN,KAAAstB,yBAGAA,wBAAA,WACAttB,KAAAmG,SAAAnG,KAAA,gBAAA,SAAAutB,GACAvtB,KAAA0J,YAAA8jB,gBACA1sB,OAAAysB,EACAjtB,WAAA4e,kBAAAlf,KAAA+F,QACAoI,UAAA,IACAnO,KAAAytB,mBACAztB,KAAA0tB,iBAEA1tB,KAAAmG,SAAAnG,KAAA,cAAA,SAAAutB,GACAvtB,KAAA0J,YAAA8jB,gBACA1sB,OAAAysB,EACAjtB,UAAAN,KAAA0J,YAAA7C,WAAA6C,YAAApJ,UACA6N,UAAA,IACAnO,KAAA6F,QAAAiR,cAAA,cAAA9W,KAAA0J,eAEA1J,KAAAmG,SAAAnG,KAAA6F,QAAA,mBAAA7F,KAAA2tB,kBAEA3tB,KAAAmG,SAAAnG,KAAA6F,QAAA,qBAAA7F,KAAA4tB,sBACA5tB,KAAAmG,SAAAnG,KAAA6F,QAAA,qBAAA7F,KAAA6tB,oBACA7tB,KAAAmG,SAAAnG,KAAA6F,QAAA,+BAAA7F,KAAA8tB,aAGAT,kBAAA,SAAAU,GACA,IAAAA,EACA,KAAA,IAAA5C,OAAA,sBAEAnrB,MAAA0J,YAAA1J,KAAAguB,kBAAAD,GACA/tB,KAAA0J,YAAAukB,SAAAjuB,KAAA+F,OAAA1B,EAAAoe,uBAEAziB,KAAA0J,YAAA8jB,eAAAxtB,KAAAkuB,iCAMAF,oBAAA,SAAAG,GACA,GAAAC,GAAAD,EAAAE,iBACArhB,EAAAhE,KAAAC,MAAAD,KAAAE,UAAAklB,GAEA,OADAD,GAAAX,eAAAxgB,GACAmhB,GAGArnB,OAAA,WACA,GAAAxE,GAAAtC,KAAAsuB,cAKA,OAJA,IAAA5C,IACAzX,KAAA3R,IAEAwE,KAAA9G,MACAA,MAGAsuB,eAAA,WAIA,MAHAtC,IAAAvsB,EAAA8uB,SAAAvuB,KAAAM,QAAAgC,UAAA0pB,KACAA,EAAAvsB,EAAA,SAAA+uB,QAAA,iBAAA/d,SAAAzQ,KAAAM,QAAAgC,WAAA,IAEA0pB,GAMAkC,+BAAA,WAEA,OACAptB,OAAA,oBACAR,WACAkX,UACA1W,OAAA,8BASA6sB,mBAAA,SAAAc,GACA,GAAAA,GAAAA,EAAApF,MAEA,WADArpB,MAAAkF,GAAAiiB,QAAAE,KAAA,YAAA,EAGArnB,MAAA0J,YAAAglB,OAAAD,GAEAzuB,KAAA0J,YAAAyiB,OAAA/C,KAAA5pB,EAAA0G,KAAAlG,KAAA2uB,eAAA3uB,MACAR,EAAA0G,KAAAlG,KAAA4uB,aAAA5uB,QAGA2uB,iBAAA,WACA,GAAAjf,GAAA1P,IACA0P,GAAA3J,OAAA1B,EAAAoe,sBACAziB,KAAA6uB,aAAA,UAAAzqB,EAAA0qB,wBAEA9uB,KAAA6uB,aAAA,UAAAzqB,EAAA2qB,2BAGA,IAAAC,GAAAtf,EAAA7J,QAAA6D,YAAAoE,IAAA,oBACAzJ,EAAAoe,sBACAwM,EAAAvf,EAAAwf,kBAEAC,EAAAzf,EAAAhG,YAAA2kB,gBAIA,IAHAc,EAAAxa,GAAAjF,EAAAhG,YAAA0lB,mBAGA1f,EAAA3J,OAAA1B,EAAAoe,sBAAA,CAEA,GAAAsL,GAAAkB,EAAAnhB,IAAA,cACAmhB,GAAArhB,IAAA,cAAApO,EAAAmM,SAAAwjB,EAAApB,QACA,CAEA,GAAAA,GAAAkB,EAAAnhB,IAAA,cACAmhB,GAAArhB,IAAA,cACApO,EAAAmM,UAAA0jB,mBAAA3f,EAAAhG,YAAA0I,UAAA2b,IAGA,GAAAiB,IAAAtf,EAAA3J,KACA2J,EAAA7J,QAAA6D,YAAAkE,IAAAuhB,OACA,IAAAzf,EAAA3J,OAAA1B,EAAAoe,sBAAA,CAGA,GAAA6M,GAAA,GAAAxD,OAAApiB,cAAAylB,GACAG,GAAA9B,eAAA9d,EAAA7J,QAAA6D,YAAA0I,UACA+c,EAAAG,EAAAjB,iBACA3e,EAAA7J,QAAA6D,YAAAkE,IAAAuhB,OAEA,IAAAzf,EAAA3J,OAAA1B,EAAAugB,iBAAA,CAGA,GAAA0K,GAAA,GAAAxD,OACApiB,cAAAulB,EAAAnhB,IAAA,gBACAwhB,GAAA9B,eAAA2B,GACAA,EAAAG,EAAAjB,iBACA3e,EAAA7J,QAAA6D,YAAAkE,IAAAuhB,GAEAzf,EAAAme,sBAGAe,eAAA,SAAAvF,GACArpB,KAAAkF,GAAAiiB,QAAAE,KAAA,YAAA,EAEA,IAAAkI,EACA,IAAAlG,GAAAA,EAAAmG,cAAAnG,EAAAmG,aAAAnG,MACAkG,EAAAlG,EAAAmG,aAAAnG,UACA,CACA,GAAAoG,GAAA9iB,EAAA+iB,cAAAC,QACAhjB,GAAA+iB,cAAApD,QACAiD,EAAA9vB,EAAAgwB,GAAAje,OAEAxR,KAAA6uB,aAAA,QAAAU,IAGAV,eAAA,SAAA/tB,EAAAwqB,GACAhsB,KAAAqW,SACA,6CACA,SAAAia,GACAA,EAAAC,YAAA/uB,EAAAwqB,MAIAwE,cAAA,WACA9vB,KAAAkF,GAAAiiB,QAAAE,KAAA,YAAA,EAEA,IAAA0I,GAAA/vB,KAAAM,QAAAgC,UAAA2E,KAAA,gBACA8oB,GAAA9uB,QACA8uB,EAAAzO,aAAA,QAEAtP,WAAAxS,EAAA0G,KAAA,WACAlG,KAAA6F,QAAAiR,cAAA,wBAAA9W,KAAA0J,cACA1J,MAAA,OAEAA,KAAA6F,QAAAiR,cAAA,wBAAA9W,KAAA0J,cAIAsmB,eAAA,WACA,GAAAtgB,GAAA1P,IACAV,MAAAqW,SAAA,wCAAA,SAAA8T,GACAA,EAAAC,gBAAAtlB,EAAA6rB,gBACA7rB,EAAAkoB,OAEAhS,WACAC,WAAA,EACAC,WAAApW,EAAAkoB,MACA5R,UAAA,EACAC,UAAAvW,EAAAqZ,UAGAvK,KAAA,SAAAgd,GACAA,GACAxgB,EAAAygB,gBAMAA,WAAA,WACA,GAAAlB,GAAAjvB,KAAAkvB,iBACAnB,qBAAA/kB,KAAAC,MAAAD,KAAAE,UAAA+lB,EAAAnhB,IAAA,iBACAigB,oBAAAztB,QAAAytB,oBAAAztB,YACAytB,oBAAAztB,QAAA4e,gBAAAlf,KAAA+F,IACA,IAAAqqB,GAAA,GAAAvsB,GAAAwF,MAAA0kB,oBACA/tB,MAAA6F,QAAAiR,cAAA,yBAAAsZ,GACApwB,KAAAgG,aAAAhG,KAAA6F,QAAA,gCAAA,WACA7F,KAAA6uB,aAAA,UAAAzqB,EAAAisB,oBAIAnB,kBAAA,SAAAoB,GACA,GAAArB,EAMA,OALA,SAAAjvB,KAAAmtB,iBAAArf,IAAA,MACAmhB,EAAAjvB,KAAA6F,QAAAunB,SAAAxB,GACA5rB,KAAAmtB,iBAAArf,IAAA,QACAmhB,EAAAjvB,KAAA6F,QAAAunB,SAAAvB,IAEAoD,GAGAsB,eAAA,WACAvwB,KAAA6tB,sBAGAH,eAAA,SAAA/lB,GACA3H,KAAAkF,GAAAunB,UAAA3iB,SAAA,gBAQA9J,KAAAsH,IAAAL,KAAA,oBAAA8Q,KAAA,YAAA,GACA/X,KAAAsH,IAAAL,KAAA,eAAA8Q,KAAA,YAAA,GACA/X,KAAAwwB,qBARA,UAAA7oB,EAAAyJ,cAAAqf,cACAzwB,KAAAsH,IAAAL,KAAA,oBAAA8Q,KAAA,WAAA,GACA/X,KAAAsH,IAAAL,KAAA,oBAAA+Q,SAEAhY,KAAA0wB,oBAQAA,kBAAA,WACA1wB,KAAA2wB,cAAA1qB,QAAA,eACAjG,KAAAkF,GAAAynB,QAAAzlB,SAAA,eACAlH,KAAAkF,GAAAynB,QAAA5U,KAAA,QAAA3T,EAAAwsB,OACA5wB,KAAAkF,GAAAunB,UAAAvlB,SAAA,eACAlH,KAAA2wB,cAAA7Z,cAAA,eAGA0Z,mBAAA,WACAxwB,KAAAkF,GAAAunB,UAAAzd,YAAA,eACAhP,KAAAkF,GAAAynB,QAAA5U,KAAA,QAAA3T,EAAA8nB,WACAlsB,KAAAkF,GAAAynB,QAAA3d,YAAA,gBAGAke,eAAA,aAIA2D,qBAAA,WACA7wB,KAAA+F,OAAA1B,EAAAugB,mBAIA5kB,KAAA8wB,gBAAA,GAAAhtB,GAAAkT,QACA/C,KAAAjU,KAAAkF,GAAAunB,YAEAzsB,KAAA2wB,cAAA,GAAA1a,IACAnD,WAAA9S,OAEAA,KAAA8wB,gBAAAhqB,KAAA9G,KAAA2wB,eACAnxB,EAAAynB,WAAAjnB,KAAAkF,GAAA0nB,UAAAmE,YAAA/wB,KAAAkF,GAAA0nB,UAAAmE,WACApgB,YAAA,UACAqgB,aAAA,mBACAC,SAAA,WACA,OAAA,OAKAxD,mBAAA,WACA,GAAAW,GAAApuB,KAAA0J,YAAA2kB,gBACAD,GAAA9tB,QAAA8tB,EAAA9tB,YACA8tB,EAAA9tB,QAAA4e,gBAAAlf,KAAA+F,IACA,IAAA2D,GAAA,GAAA7F,GAAAwF,MAAA+kB,EACApuB,MAAA6F,QAAAiR,cAAA,yBAAApN,GACA1J,KAAAgG,aAAAhG,KAAA6F,QAAA,gCAAA7F,KAAAkxB,yBAGAC,oBAAA,WACA,GAAAC,GAAApxB,KAAAM,QAAAgC,UAAA2E,KAAA,kBACAjH,MAAAM,QAAAgC,UAAA4E,SAAA,kCACAyF,EAAAsC,gBAAAmiB,EAAA,WACApxB,KAAAM,QAAAgC,UAAA0M,YAAA,mCACAhP,OAGAwG,WAAA,WAEAxG,KAAAmxB,oBACAnxB,KAAAM,QAAAgC,UAAA4E,SAAA,uBACAlH,KAAAM,QAAA4sB,eACAltB,KAAA6wB,qBACA7wB,KAAAytB,mBACAhuB,EAAA2P,UAAAI,GAAA,SAAAxP,KAAAklB,KAAAvD,OAAA3hB,MAAAA,KAAAqxB,iBAEA,oBAAArxB,KAAA0J,YAAAoE,IAAA,SACA,mBAAA9N,KAAA0J,YAAAoE,IAAA,SACA,SAAA9N,KAAA0J,YAAAoE,IAAA,SACA,oBAAA9N,KAAA0J,YAAAoE,IAAA,eAAAhN,MACA,mBAAAd,KAAA0J,YAAAoE,IAAA,eAAAhN,MACA,SAAAd,KAAA0J,YAAAoE,IAAA,eAAAhN,OAEArB,EAAA2P,UAAAI,GAAA,WAAAmS,OAAA3hB,MAAAA,KAAA8Z,cAIAA,cAAA,SAAAnS,GACA,GAAAyT,GAAAP,GAAAA,EAAAQ,SAAAC,IACA5L,EAAA/H,EAAAvG,MAAAuG,EAAAvG,KAAAugB,KACA/Z,GAAA,EACAoa,EAAArV,EAAAsV,aACA,MAAAxiB,EAAA2P,SAAAiS,eAAApZ,QAAA,WAAAhH,OAAA,GAAA,CAGA,GAAA+gB,GAAAra,EAAAua,UAAAva,EAAAwa,UAAAH,IAAAra,EAAAua,SACAva,EAAAwa,QAAA,CACA,GAAAta,GAAApI,EAAAkI,EAAAG,QACAwpB,EAAAzpB,EAAA6I,QAAA,wBACAuK,EAAAvL,EAAApP,SAAAoP,EAAApP,QAAAuF,SACA6J,EAAApP,QAAAuF,QAAAyH,kBACAoC,EAAApP,QAAAuF,QAAAyH,iBAAAikB,GAAA,GAAAC,QAAA7jB,MACA,QAAAhG,EAAAI,SACA,IAAA,IACAqT,EAAA1L,EAAA8L,WAAA8V,EAAAzpB,EAAAoT,GAAAvL,EAAAoL,YAAAwW,EAAAzpB,EAAAoT,GACArT,GAAA,CACA,MACA,KAAA,IACAwT,EAAA1L,EAAAoL,YAAAwW,EAAAzpB,EAAAoT,GAAAvL,EAAA8L,WAAA8V,EAAAzpB,EAAAoT,GACArT,GAAA,GAIA,MAAAA,KAIAypB,iBAAA,SAAA1pB,GACA,GAAA+H,GAAA/H,EAAAvG,KAAAugB,IACAjS,GAAAxK,GAAAynB,QAAAnL,GAAA7Z,EAAAG,SAAA4H,EAAAxK,GAAAynB,QAAAvY,IAAAzM,EAAAG,QAAA7G,QAIAyO,EAAAxK,GAAAunB,UAAAjL,GAAA7Z,EAAAG,SAAA4H,EAAAxK,GAAAunB,UAAArY,IAAAzM,EAAAG,QAAA7G,QAIAyO,EAAA8gB,oBAGA5C,uBAAA,WACA5tB,KAAA8tB,cAGAA,aAAA,WACA,GAAAiC,GAAA/vB,KAAAM,QAAAgC,UAAA2E,KAAA,gBACAjH,MAAAmxB,oBACApB,EAAA9uB,QACA8uB,EAAAzO,aAAA,WAEAthB,KAAAM,QAAAgC,UAAA0M,YAAA,uBACAvP,EAAA2P,UAAAsU,IAAA,SAAA1jB,KAAAklB,IAAAllB,KAAAqxB,gBACA5xB,EAAA2P,UAAAsU,IAAA,UAAA1jB,KAAA8Z,aACA9Z,KAAAiG,QAAA,YAMA4nB,qBAAA,WACA7tB,KAAA6F,QAAAiR,cAAA,wBAAA9W,KAAA0J,cAIAwnB,yBAAA,WACA,GAAAlW,GAAAhb,KAAAM,QAAAgC,UAAA2E,KACA,oEAAAM,QACAkqB,EAAAzW,EAAA/T,KAAA,0BACA,OAAAwqB,EAAA1Z,KAAA,YACA0Z,EAAA,GAAAzZ,QAEAgD,EAAA/T,KAAA,mBAAA,GAAA+Q,SAIAC,YAAA,SAAAtQ,GACA,OAAAA,EAAAI,SACA,IAAA,GACA,IAAAJ,EAAAK,UAAAvI,EAAAkI,EAAAG,QAAA0Z,GAAAxhB,KAAAkF,GAAAwnB,YAEA,MADA1sB,MAAAkxB,0BACA,KAOA,OADAnF,GAAArsB,MAAAusB,EAAAtsB,WACAssB,IAGA3sB,KAAAC,OAAA,yECleAyd,QAAA,EAEAC,SAAA,EACAC,MAAA,IAGA5d,KAAAC,OAAA,8ECPAmyB,iBAAA,6BACAC,qBAAA,kCCAAryB,KAAAC,OAAA,4FAAA,SAAA,MAAA,sBAAA,SAAAwC,EAAAC,EAAAC,GACA,GAAAC,GAAAD,EAAAE,UAAAC,YAAA,EAAA,YAAAC,OAAA,SAAAC,EAAAC,EAAAC,EAAAC,EAAArB,GACA,GAAAsB,GAAAC,EAAAL,EAAAK,gBAAA,SAAAC,EAAAC,GACA,GAAAC,OAAAnD,UAAAoD,eAAAC,KAAAJ,EAAAC,GACA,MAAAD,GAAAC,GAKA,OAAA,8CACAP,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,oBAAA,MAAAD,EAAAI,EAAAJ,EAAA,kBAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,iBAAAC,UAAAC,OAAAC,SAAAC,OAAA,EAAAC,SAAA,IAAAC,OAAAF,OAAA,EAAAC,SAAA,OAAAhB,IACA,+DACAJ,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,oBAAA,MAAAD,EAAAI,EAAAJ,EAAA,kBAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,iBAAAC,UAAAC,OAAAC,SAAAC,OAAA,EAAAC,SAAA,GAAAC,OAAAF,OAAA,EAAAC,SAAA,OAAAhB,IACA,qBAGA,OADAT,GAAA2B,gBAAA,uFAAA1B,GACAA,ICjBA5C,KAAAC,OAAA,8FAAA,cCGAD,KAAAC,OAAA,wFAAA,sBAAA,oBAAA,sBACA,6EACA,2FACA,4FACA,SAAAC,EAAAqE,EAAAC,EAAAM,EAAAjC,GAwBA,MAvBA2B,GAAAsJ,SAAAxN,QACA4E,YAAA,+BACArC,WAAAA,EACA4C,kBAAA,WACA,OACA2sB,iBAAA1xB,KAAAM,QAAAsxB,iBAAA5xB,KAAAM,QAAAsxB,gBAAAtxB,QAAAuxB,KAAAC,mBACA1tB,EAAAutB,mBAAAvtB,EAAAstB,iBAIApsB,cAAA,SAAAhF,GACAwD,EAAAsJ,SAAA7H,MAAAvF,KAAAwF,YAGAusB,SAAA,WACA/xB,KAAAsH,IAAA1E,SAAAsE,SAAA,oCAGAwd,YAAA,WACA1kB,KAAAsH,IAAA1E,SAAAoM,YAAA,wCAMA1P,KAAAC,OAAA,oEChCAyd,QAAA,EAEAC,SAAA,EACAC,MAAA,IAGA5d,KAAAC,OAAA,yECPAyyB,WAAA,0BACAC,gBAAA,yBCAA3yB,KAAAC,OAAA,kFAAA,SAAA,MAAA,sBAAA,SAAAwC,EAAAC,EAAAC,GACA,GAAAC,GAAAD,EAAAE,UAAAC,YAAA,EAAA,YAAAC,OAAA,SAAAC,EAAAC,EAAAC,EAAAC,EAAArB,GACA,GAAAsB,GAAAC,EAAAL,EAAAK,gBAAA,SAAAC,EAAAC,GACA,GAAAC,OAAAnD,UAAAoD,eAAAC,KAAAJ,EAAAC,GACA,MAAAD,GAAAC,GAKA,OAAA,kGACAP,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,iBAAA,MAAAD,EAAAI,EAAAJ,EAAA,eAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,cAAAC,UAAAC,OAAAC,SAAAC,OAAA,EAAAC,SAAA,IAAAC,OAAAF,OAAA,EAAAC,SAAA,OAAAhB,IACA,KACAJ,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,iBAAA,MAAAD,EAAAI,EAAAJ,EAAA,eAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,cAAAC,UAAAC,OAAAC,SAAAC,OAAA,EAAAC,SAAA,IAAAC,OAAAF,OAAA,EAAAC,SAAA,OAAAhB,IACA,yDACAJ,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,mBAAA,MAAAD,EAAAI,EAAAJ,EAAA,iBAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,gBAAAC,UAAAC,OAAAC,SAAAC,OAAA,EAAAC,SAAA,IAAAC,OAAAF,OAAA,EAAAC,SAAA,OAAAhB,IACA,gGACAJ,EAAAW,kBAAAP,EAAA,OAAAA,EAAAC,EAAAH,EAAA,mBAAA,MAAAD,EAAAI,EAAAJ,EAAA,iBAAAA,IAAAG,EAAAJ,EAAAY,MAAAC,cAAA,kBAAAT,GAAAA,EAAAM,KAAA,MAAAT,EAAAA,EAAAD,EAAAc,iBAAAC,OAAA,gBAAAC,UAAAC,OAAAC,SAAAC,OAAA,EAAAC,SAAA,GAAAC,OAAAF,OAAA,EAAAC,SAAA,OAAAhB,IACA,iCAGA,OADAT,GAAA2B,gBAAA,6EAAA1B,GACAA,ICrBA5C,KAAAC,OAAA,oFAAA,cCEAD,KAAAC,OAAA,8EAAA,sBAAA,oBAAA,sBACA,wEACA,iFACA,kFACA,SAAAC,EAAAqE,EAAAC,EAAAM,EAAAjC,GAwBA,MAvBA2B,GAAAsJ,SAAAxN,QACA4E,YAAA,mBACArC,WAAAA,EACA4C,kBAAA,WACA,GAAAmtB,GAAAlyB,KAAAuO,QAAAvO,KAAAuO,OAAAT,IAAA,YACAqkB,EAAAnyB,KAAAuO,QAAAvO,KAAAuO,OAAAT,IAAA,SACAkkB,GAAAE,IAAAA,EAAA/xB,SAAA+xB,EAAA/xB,OAAAC,YACAZ,EAAAokB,QAAAsO,EAAA/xB,OAAAC,WACA,QACAsf,cAAAyS,GAAA/tB,EAAAkQ,QACA8d,gBAAAJ,EAAA5tB,EAAA4tB,SAAA5tB,EAAA6tB,gBAIA3sB,cAAA,SAAAhF,GACAA,IAAAA,MACAA,EAAAd,EAAAmM,SAAArL,GACAc,YAEA0C,EAAAsJ,SAAA7H,MAAAvF,KAAAwF,WACAxF,KAAAuO,OAAAjO,EAAAc,KAAAmN,YC3BAjP,KAAAC,OAAA,sGACA8yB,UAAA,sDACAtxB,QAAA,YACAiE,cAAA,kBACA6E,OAAA,OACA1J,UACAW,OAAA,SACAV,mBCPAd,KAAAC,OAAA,4FACA8yB,UAAA,sDACAtxB,QAAA,YACAiE,cAAA,kBACA6E,OAAA,OACA1J,UACAW,OAAA,SACAV,mBAKAd,KAAAC,OAAA,qGCXAyd,QAAA,EAEAC,SAAA,EACAC,MAAA,IAGA5d,KAAAC,OAAA,0GCPAmyB,iBAAA,+BCAApyB,KAAAC,OAAA,2FCCAyd,QAAA,EAEAC,SAAA,EACAC,MAAA,IAGA5d,KAAAC,OAAA,gGCPAyyB,WAAA,0BACAC,gBAAA,yBCDA3yB,KAAAC,OAAA,4BCAA,oCACA,kEACA,uFACA,6EAGA,qGACA,2FAEA,yGACA,oGAGAD,KAAAqW,SAAA,UAAA,OAAA,SAAAA,EAAApF,GACAA,EAAA+hB,UAAA3c,EAAA,iCAAA","file":"csui-perspective.js","sourcesContent":["csui.define('csui/perspective.manage/mixins/manifest.edit.mixin',[\"csui/lib/underscore\", \"csui/lib/jquery\"], function (_, $) {\r\n  \"use strict\";\r\n\r\n  var ManifestEditMixin = {\r\n    mixin: function (prototype) {\r\n      return _.extend(prototype, {\r\n        objectToPrimitive: function (fieldKey) {\r\n\r\n          var manifestOrig = $.extend(true, {}, this.manifest),\r\n              field = this.manifest.schema.properties[fieldKey],\r\n              fieldOption = this.manifest.options.fields[fieldKey],\r\n              fieldOptionItems = fieldOption && fieldOption.items.fields,\r\n              itemKey = _.keys(field.items.properties)[0];\r\n\r\n          //maintain manifest before modifying to use while conversion to object\r\n          this.manifest.modifiedItems = manifestOrig;\r\n\r\n          //updating filed data\r\n          var fieldItem = field.items.properties[itemKey];\r\n          delete field.items.properties;\r\n          field.items.type = fieldItem.type;\r\n          field.title = fieldItem.title;\r\n          field.required = (field.items.required && field.items.required.length > 0);\r\n          field.itemKey = itemKey;\r\n\r\n          //updating field schema\r\n          if (fieldOptionItems) {\r\n            delete fieldOption.items.fields;\r\n            fieldOption.items = _.values(fieldOptionItems)[0];\r\n          }\r\n        },\r\n\r\n        updateDataToPrimitive: function (data, modifiedKey) {\r\n          var arrvalues = [],\r\n              key = this.manifest.schema.properties[modifiedKey].itemKey;\r\n          data[modifiedKey].length == 0 && arrvalues.push(\"\");\r\n          data[modifiedKey].forEach(function (item) {\r\n            arrvalues.push(item[key]);\r\n          });\r\n          data[modifiedKey] = arrvalues;\r\n        },\r\n\r\n        getPrimitiveToObjectvalues: function (modifiedKey, formValues) {\r\n          var itemKey = this.manifest.schema.properties[modifiedKey].itemKey;\r\n          if (itemKey) {\r\n            // update manifest to original inline with values\r\n            if (this.manifest.modifiedItems) {\r\n              this.manifest.options.fields[modifiedKey].items =\r\n                  this.manifest.modifiedItems.options.fields[modifiedKey].items;\r\n\r\n              this.manifest.schema.properties[modifiedKey].items =\r\n                  this.manifest.modifiedItems.schema.properties[modifiedKey].items;\r\n            }\r\n\r\n            for (var fieldKeyOne in formValues[modifiedKey]) {\r\n              var sortListArray = {};\r\n              sortListArray[itemKey] = formValues[modifiedKey][fieldKeyOne];\r\n              formValues[modifiedKey][fieldKeyOne] = sortListArray;\r\n            }\r\n            return formValues;\r\n          }\r\n          return formValues;\r\n\r\n        }\r\n      });\r\n    },\r\n  };\r\n  return ManifestEditMixin;\r\n});\n","\n/* START_TEMPLATE */\ncsui.define('hbs!csui/perspective.manage/impl/options.form.wrapper',['module','hbs','nuc/lib/handlebars'], function( module, hbs, Handlebars ){ \nvar t = Handlebars.template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"csui-pman-form-header\\\">\\r\\n    <div class=\\\"csui-pman-form-title\\\">\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"title\") || (depth0 != null ? lookupProperty(depth0,\"title\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"title\",\"hash\":{},\"loc\":{\"start\":{\"line\":2,\"column\":38},\"end\":{\"line\":2,\"column\":49}}}) : helper)))\n    + \"</div>\\r\\n    <div class=\\\"csui-pman-form-description\\\">\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"description\") || (depth0 != null ? lookupProperty(depth0,\"description\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"description\",\"hash\":{},\"loc\":{\"start\":{\"line\":3,\"column\":44},\"end\":{\"line\":3,\"column\":61}}}) : helper)))\n    + \"</div>\\r\\n    <div class=\\\"csui-pman-config-unsupported\\\">\\r\\n        <div class=\\\"csui-state\\\">\\r\\n            <span class=\\\"csui-state-icon csui-icon csui-icon-notification-error-white\\\"></span>\\r\\n        </div>\\r\\n        <div class=\\\"csui-error-message\\\">\\r\\n            <span>\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"configNotSupported\") || (depth0 != null ? lookupProperty(depth0,\"configNotSupported\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"configNotSupported\",\"hash\":{},\"loc\":{\"start\":{\"line\":9,\"column\":18},\"end\":{\"line\":9,\"column\":42}}}) : helper)))\n    + \"</span>\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\\r\\n<div class=\\\"csui-pman-form-content cs-formview-wrapper\\\"></div>\\r\\n\";\n}});\nHandlebars.registerPartial('csui_perspective.manage_impl_options.form.wrapper', t);\nreturn t;\n});\n/* END_TEMPLATE */\n;\n","\ncsui.define('css!csui/perspective.manage/impl/options.form',[],function(){});\n","csui.define('csui/perspective.manage/impl/options.form.view',['csui/lib/underscore', 'csui/lib/jquery', 'csui/lib/backbone', 'csui/lib/marionette',\r\n  'csui/lib/alpaca/js/alpaca.lite',\r\n  'csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin',\r\n  'csui/perspective.manage/mixins/manifest.edit.mixin',\r\n  'csui/controls/tile/behaviors/perfect.scrolling.behavior',\r\n  'csui/controls/form/form.view',\r\n  'i18n!csui/perspective.manage/impl/nls/lang',\r\n  'hbs!csui/perspective.manage/impl/options.form.wrapper',\r\n  'csui/utils/perspective/perspective.util',\r\n  'css!csui/perspective.manage/impl/options.form',\r\n], function (_, $, Backbone, Marionette, Alpaca, LayoutViewEventsPropagationMixin,\r\n    ManifestEditMixin,\r\n    PerfectScrollingBehavior,\r\n    FormView, lang, template, PerspectiveUtil) {\r\n\r\n  var WidgetOptionsFormWrapperView = Marionette.LayoutView.extend({\r\n\r\n    template: template,\r\n\r\n    className: 'csui-pman-form-wrapper',\r\n\r\n    regions: {\r\n      bodyRegion: '.csui-pman-form-content'\r\n    },\r\n\r\n    behaviors: {\r\n      PerfectScrolling: {\r\n        behaviorClass: PerfectScrollingBehavior,\r\n        scrollYMarginOffset: 1\r\n      }\r\n    },\r\n\r\n    templateHelpers: function () {\r\n      return {\r\n        title: this.options.manifest.title,\r\n        description: this.options.manifest.description,\r\n        configNotSupported: lang.configNotSupported\r\n      }\r\n    },\r\n\r\n    ui: {\r\n      unSupportedConfig: '.csui-pman-config-unsupported',\r\n      description: '.csui-pman-form-description'\r\n    },\r\n\r\n    events: {\r\n      'keydown': '_onKeyDown'\r\n    },\r\n\r\n    constructor: function WidgetOptionsFormHeaderView(options) {\r\n      this.options = options || {};\r\n      this.manifest = this.options.manifest;\r\n      Marionette.LayoutView.prototype.constructor.apply(this, arguments);\r\n    },\r\n\r\n    _createForm: function (formModel) {\r\n      this.widgetOptionsFormView = new WidgetOptionsFormView({\r\n        context: this.options.context,\r\n        model: formModel,\r\n        mode: 'create'\r\n      });\r\n\r\n      this.listenToOnce(this.widgetOptionsFormView, 'render:form', function () {\r\n        this.trigger('render:form');\r\n      }.bind(this))\r\n\r\n      this.listenTo(this.widgetOptionsFormView, 'change:field', function (field) {\r\n        this.trigger('change:field', field);\r\n        this.trigger('ensure:scrollbar');\r\n      }.bind(this))\r\n    },\r\n\r\n    _hasSchema: function () {\r\n      return this.manifest && this.manifest.hasConfigForm;\r\n    },\r\n\r\n    refresh: function (callback) {\r\n      if (!!this.widgetOptionsFormView) {\r\n        this.widgetOptionsFormView.refresh(callback);\r\n      } else {\r\n        callback();\r\n      }\r\n    },\r\n\r\n    onRender: function () {\r\n      this.ui.unSupportedConfig.hide();\r\n      var hasSchema = this._hasSchema();\r\n      if (!hasSchema) {\r\n        // No schema defined for widget\r\n        this.trigger('render:form');\r\n        return;\r\n      }\r\n      var formModel = this._prepareFormModel();\r\n      this.hasValidSchema = WidgetOptionsFormWrapperView._normalizeOptions(\r\n          formModel.attributes.schema.properties, formModel.attributes.options.fields,\r\n          formModel.attributes.data);\r\n      if (this.hasValidSchema) {\r\n        this._createForm(formModel);\r\n        this.bodyRegion.show(this.widgetOptionsFormView);\r\n      } else {\r\n        // Widget configuration schema has unsupported alpaca fields\r\n        this.ui.description.hide();\r\n        this.ui.unSupportedConfig.show();\r\n        this.trigger('render:form');\r\n      }\r\n    },\r\n    //To change the border color to red for non supported widgets.\r\n    onPopoverShow: function (popover) {\r\n      if (this._hasSchema() && !this.hasValidSchema) {\r\n        popover.find('.binf-popover-content').addClass(\"invalid-options\");\r\n        popover.find('.binf-arrow').addClass(\"invalid-options\");\r\n      }\r\n      this._focusField('.alpaca-container-item-first');\r\n    },\r\n\r\n    _focusField: function (fieldSelector) {\r\n      var itemFirst = this.$el.find(fieldSelector);\r\n      if (itemFirst.length) {\r\n        itemFirst = itemFirst.first();\r\n        var ele = itemFirst.find(\r\n            'input:visible, textarea:visible, button.binf-dropdown-toggle:visible'),\r\n            browseIcon = itemFirst.find('.cs-browse-icon');\r\n        if (ele.length) {\r\n          if (browseIcon.length) {\r\n            browseIcon.trigger('focus');\r\n          } else {\r\n            ele.first().trigger('focus');\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    _onKeyDown: function (event) {\r\n      var continueEvent = true,\r\n          $target = $(event.target);\r\n      switch (event.keyCode) {\r\n      case 9:\r\n        if (!event.shiftKey && $target.parents('.alpaca-container-item-last').length) {\r\n          this._focusField('.alpaca-container-item-first');\r\n          continueEvent = false;\r\n        } else if (event.shiftKey && $target.parents('.alpaca-container-item-first').length) {\r\n          this._focusField('.alpaca-container-item-last');\r\n          continueEvent = false;\r\n        }\r\n        break;\r\n      }\r\n      return continueEvent;\r\n    },\r\n\r\n    getValues: function () {\r\n      if (!this._hasSchema()) {\r\n        return undefined;\r\n      }\r\n      if (this.hasValidSchema) {\r\n        var formValues = this.widgetOptionsFormView.getValues();\r\n        if (this.manifest.modifiedProperties) {\r\n          for (var modKey in _.keys(formValues)) {\r\n            if (this.manifest.modifiedProperties.indexOf(_.keys(formValues)[modKey]) >= 0) {\r\n              formValues = this.getPrimitiveToObjectvalues(_.keys(formValues)[modKey], formValues);\r\n            }\r\n          }\r\n        }\r\n        return formValues;\r\n      } else {\r\n        return this._getOptionsData();\r\n      }\r\n    },\r\n\r\n    validate: function () {\r\n      if (!this._hasSchema()) {\r\n        return true;\r\n      }\r\n      // Widget configuration schema has unsupported alpaca fields\r\n      if (!this.hasValidSchema) {\r\n        var reqVal = true;\r\n        //Has required fields\r\n        //TODO to handle required fields of recursive schema\r\n        if (PerspectiveUtil.hasRequiredFields(this.manifest)) {\r\n          var data = this._getOptionsData();\r\n          var reqFields = this.manifest.schema.required;\r\n          _.each(reqFields, function (fieldName) {\r\n            if (!data[fieldName]) {\r\n              reqVal = false;\r\n            }\r\n          });\r\n        }\r\n        return reqVal;\r\n      }\r\n      // Widget configuration schema has supported alpaca fields\r\n      return this.widgetOptionsFormView.validate();\r\n    },\r\n\r\n    _isPreviewWidget: function () {\r\n      return this.options.widgetConfig.type ===\r\n             'csui/perspective.manage/widgets/perspective.widget';\r\n    },\r\n\r\n    _prepareFormModel: function () {\r\n      var data = this._getOptionsData();\r\n      var modifiedProperties = [];\r\n      //iterate manifest and update fields to primitive type if it has only one item\r\n      for (var fieldKey in this.manifest.schema.properties) {\r\n        //TODO: Need to expect the falg from respective manifest file to render multivalue block as set.\r\n        //something like field.alwaysSet : true\r\n        //until then hardcoded with the key name.\r\n        if (fieldKey !== 'businessobjecttypes') {\r\n          break;\r\n        }\r\n        var filed = this.manifest.schema.properties[fieldKey];\r\n        if (filed.type === 'array' && filed.items.type === 'object' &&\r\n            _.keys(filed.items.properties).length === 1) {\r\n          modifiedProperties.push(fieldKey);\r\n          this.objectToPrimitive(fieldKey);\r\n          data[fieldKey] && this.updateDataToPrimitive(data, fieldKey);\r\n        } else {\r\n          // update only data to inline with modified manifest\r\n          this.manifest.modifiedProperties && data[fieldKey] &&\r\n          this.updateDataToPrimitive(data, fieldKey);\r\n        }\r\n      }\r\n\r\n      if (modifiedProperties.length > 0) {\r\n        this.manifest.modifiedProperties = modifiedProperties;\r\n      }\r\n\r\n      // Clone schema and options from manifest as they would change by form.view\r\n      var schema = JSON.parse(JSON.stringify(this.manifest.schema)),\r\n          formOptions = JSON.parse(JSON.stringify(this.manifest.options || {}));\r\n      if (!formOptions) {\r\n        formOptions = {};\r\n      }\r\n      if (!formOptions.fields) {\r\n        formOptions.fields = {};\r\n      }\r\n      this._addWidgetSizePropertyIfSupported(schema, formOptions, data);\r\n\r\n      var model = new Backbone.Model({\r\n        schema: schema,\r\n        options: formOptions,\r\n        data: data\r\n      });\r\n      return model;\r\n    },\r\n\r\n    //Common method to get widget config data\r\n    _getOptionsData: function () {\r\n      var data = this.options.widgetConfig.options || {};\r\n      if (this._isPreviewWidget()) {\r\n        // For widgets added using DnD, widget will be added as preview for original widget\r\n        // Resolve original widget options from preview widget's options\r\n        data = data.options || {};\r\n      }\r\n      return data;\r\n    },\r\n\r\n    /**\r\n     * Add a new properties to form to change \"Size\" if widgets.\r\n     * Size that can be configured depends on perspective's supported sizes as well as supported sizes of widget\r\n     *\r\n     */\r\n    _addWidgetSizePropertyIfSupported: function (schema, options, data) {\r\n      if (!this.options.perspectiveView.getSupportedWidgetSizes) {\r\n        // Perspective view doesn't support configuring widget sizes\r\n        return;\r\n      }\r\n      var supportedKinds = this.options.perspectiveView.getSupportedWidgetSizes(this.manifest,\r\n        this.options.widgetView);\r\n      if (this.options.context && this.options.context.perspective) {\r\n        if (!((this.options.context.perspective.type == 'sidepanel-right') ||\r\n          (this.options.context.perspective.type == 'sidepanel-left'))) {\r\n          supportedKinds = _.filter(supportedKinds, function (supportedItem) {\r\n            return supportedItem.kind !== 'heroTile';\r\n          });\r\n        } else {\r\n          if (this.options.perspectiveView.$el.hasClass('cs-bcs-perspective-banner')) {\r\n            delete schema.properties['titlefield'];\r\n          }\r\n        }\r\n      }\r\n      if (!supportedKinds || supportedKinds.length === 0) {\r\n        // No supported sizes found for widget\r\n        return;\r\n      }\r\n      var kindSchema = {\r\n        title: lang.widgetSizeTitle,\r\n        description: lang.widgetSizeDescription,\r\n        type: 'string',\r\n        enum: _.map(supportedKinds, function (sk) {\r\n          return sk.kind;\r\n        })\r\n      };\r\n      var kindOption = {\r\n        type: 'select',\r\n        optionLabels: _.map(supportedKinds, function (sk) {\r\n          return sk.label;\r\n        }),\r\n        removeDefaultNone: true\r\n      };\r\n      var selectedKind = _.find(supportedKinds, function (size) {return size.selected;});\r\n      if (!!selectedKind) {\r\n        data[WidgetOptionsFormWrapperView.widgetSizeProperty] = selectedKind.kind;\r\n      }\r\n      var sizeSchema = {};\r\n      sizeSchema[WidgetOptionsFormWrapperView.widgetSizeProperty] = kindSchema;\r\n      schema.properties = _.extend(sizeSchema, schema.properties);\r\n\r\n      var sizeOptions = {};\r\n      sizeOptions[WidgetOptionsFormWrapperView.widgetSizeProperty] = kindOption;\r\n      options.fields = _.extend(sizeOptions, options.fields);\r\n\r\n      schema.required = schema.required || [];\r\n      schema.required.push(WidgetOptionsFormWrapperView.widgetSizeProperty);\r\n    },\r\n\r\n  }, {\r\n    widgetSizeProperty: '__widgetSize',\r\n\r\n    /**\r\n     * NOTE: Duplicate of Alpaca.createFieldInstance since this code is not exposed as function\r\n     */\r\n    _resolveOptionsType: function (schema, data) {\r\n      var type = schema.type;\r\n      if (!type) {\r\n        type = Alpaca.getSchemaType(data);\r\n      }\r\n      if (!type) {\r\n        if (data && Alpaca.isArray(data)) {\r\n          type = \"array\";\r\n        } else {\r\n          type = \"object\"; // fallback\r\n        }\r\n      }\r\n      if (schema && schema[\"enum\"]) {\r\n        if (schema[\"enum\"].length > 3) {\r\n          return \"select\";\r\n        } else {\r\n          return \"radio\";\r\n        }\r\n      } else {\r\n        return Alpaca.defaultSchemaFieldMapping[type];\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Recursively fill options for all respective schemas\r\n     */\r\n    _normalizeOptions: function (schemaProperies, optionFields, data) {\r\n      var hasValidTypes = true;\r\n      _.each(schemaProperies, function (field, fieldId) {\r\n        var fieldOpts = optionFields[fieldId];\r\n        var fieldData = data[fieldId];\r\n        if (!fieldOpts) {\r\n          optionFields[fieldId] = fieldOpts = {}\r\n        }\r\n\r\n        var optType = fieldOpts.type;\r\n        if (!optType && !!field.type) {\r\n          // Options not defined.. So resolve option type from Alp JSON schema type\r\n          optType = WidgetOptionsFormWrapperView._resolveOptionsType(field, fieldData);\r\n        }\r\n\r\n        if (!Alpaca.getFieldClass(optType)) {\r\n          hasValidTypes = false;\r\n        }\r\n\r\n        switch (field.type) {\r\n        case 'array':\r\n          if (!fieldOpts.fields) {\r\n            _.defaults(fieldOpts, {\r\n              fields: {\r\n                item: {}\r\n              }\r\n            });\r\n          }\r\n          if (!!fieldOpts.items) {\r\n            fieldOpts.fields.item = fieldOpts.items;\r\n          }\r\n          if (field.items.type === 'object') {\r\n            if (!!fieldOpts.fields.item.type && !Alpaca.getFieldClass(fieldOpts.fields.item.type)) {\r\n              hasValidTypes = false;\r\n            }\r\n            fieldOpts.fields.item.fields || (fieldOpts.fields.item.fields = {});\r\n            if (!fieldData || fieldData.length === 0) {\r\n              data[fieldId] = fieldData = [{}];\r\n            }\r\n            var hasValidArrayType = WidgetOptionsFormWrapperView._normalizeOptions(\r\n                field.items.properties, fieldOpts.fields.item.fields,\r\n                fieldData[0]);\r\n            if (!hasValidArrayType) {\r\n              hasValidTypes = false;\r\n            }\r\n          }\r\n          if (!fieldData) {\r\n            data[fieldId] = [null];\r\n          }\r\n          break;\r\n        case 'object':\r\n          if (!fieldData) {\r\n            data[fieldId] = fieldData = {};\r\n          }\r\n          if (!fieldOpts.fields) {\r\n            fieldOpts.fields = {};\r\n          }\r\n          var hasValidObjectType = WidgetOptionsFormWrapperView._normalizeOptions(field.properties,\r\n              fieldOpts.fields, fieldData);\r\n          if (!hasValidObjectType) {\r\n            hasValidTypes = false;\r\n          }\r\n          break;\r\n        default:\r\n          if (_.isUndefined(fieldData)) {\r\n            // Consider default value specified in schema if set\r\n            data[fieldId] = field.default || null;\r\n          }\r\n          break;\r\n        }\r\n      });\r\n      return hasValidTypes;\r\n    }\r\n  });\r\n\r\n  var WidgetOptionsFormView = FormView.extend({\r\n    className: function () {\r\n      var className = FormView.prototype.className.call(this);\r\n      return className + ' perspective-widget-form';\r\n    },\r\n    constructor: function WidgetOptionsFormView(options) {\r\n      FormView.apply(this, arguments);\r\n    },\r\n    popover : false,\r\n    refresh: function (callback) {\r\n      this.form && this.form.refresh(callback);\r\n    },\r\n\r\n    _modifyModel: function () {\r\n      FormView.prototype._modifyModel.apply(this, arguments);\r\n      // Dont hide initial validation since there is an issue in alpaca with  alpaca.refresh()\r\n      this.alpaca.options.hideInitValidationError = false;\r\n    }\r\n  });\r\n\r\n  _.extend(WidgetOptionsFormView.prototype, LayoutViewEventsPropagationMixin);\r\n  ManifestEditMixin.mixin(WidgetOptionsFormWrapperView.prototype);\r\n  return WidgetOptionsFormWrapperView;\r\n\r\n});\r\n\n","\n/* START_TEMPLATE */\ncsui.define('hbs!csui/perspective.manage/impl/widget.item',['module','hbs','nuc/lib/handlebars'], function( module, hbs, Handlebars ){ \nvar t = Handlebars.template({\"1\":function(container,depth0,helpers,partials,data) {\n    var stack1, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"\\r\\n        <div class=\\\"\"\n    + ((stack1 = lookupProperty(helpers,\"if\").call(depth0 != null ? depth0 : (container.nullContext || {}),((stack1 = (depth0 != null ? lookupProperty(depth0,\"attributes\") : depth0)) != null ? lookupProperty(stack1,\"draggable\") : stack1),{\"name\":\"if\",\"hash\":{},\"fn\":container.program(2, data, 0),\"inverse\":container.program(4, data, 0),\"loc\":{\"start\":{\"line\":11,\"column\":20},\"end\":{\"line\":11,\"column\":76}}})) != null ? stack1 : \"\")\n    + \"\\\"\\r\\n             data-widget-type=\\\"\"\n    + container.escapeExpression(container.lambda(((stack1 = (depth0 != null ? lookupProperty(depth0,\"attributes\") : depth0)) != null ? lookupProperty(stack1,\"dataAttr\") : stack1), depth0))\n    + \"\\\"\\r\\n             data-widget-allow-multiple=\\\"\"\n    + container.escapeExpression(container.lambda(((stack1 = (depth0 != null ? lookupProperty(depth0,\"attributes\") : depth0)) != null ? lookupProperty(stack1,\"allowMultiple\") : stack1), depth0))\n    + \"\\\">\\r\\n          <div class=\\\"csui-widget-item icon-draggable-handle csui-draggable-widget-item\\\"\\r\\n               data-widget-index=\\\"\"\n    + container.escapeExpression(container.lambda(((stack1 = (depth0 != null ? lookupProperty(depth0,\"attributes\") : depth0)) != null ? lookupProperty(stack1,\"index\") : stack1), depth0))\n    + \"\\\" draggable=\\\"true\\\" title=\\\"\"\n    + container.escapeExpression(container.lambda(((stack1 = (depth0 != null ? lookupProperty(depth0,\"attributes\") : depth0)) != null ? lookupProperty(stack1,\"title\") : stack1), depth0))\n    + \"\\\">\\r\\n            <span>\"\n    + container.escapeExpression(container.lambda(((stack1 = (depth0 != null ? lookupProperty(depth0,\"attributes\") : depth0)) != null ? lookupProperty(stack1,\"title\") : stack1), depth0))\n    + \"</span>\\r\\n            <div class=\\\"csui-layout-icon \"\n    + container.escapeExpression(container.lambda(((stack1 = (depth0 != null ? lookupProperty(depth0,\"attributes\") : depth0)) != null ? lookupProperty(stack1,\"icon\") : stack1), depth0))\n    + \"\\\"></div>\\r\\n          </div>\\r\\n        </div>\\r\\n\\r\\n        <div class=\\\"\"\n    + ((stack1 = lookupProperty(helpers,\"if\").call(depth0 != null ? depth0 : (container.nullContext || {}),((stack1 = (depth0 != null ? lookupProperty(depth0,\"attributes\") : depth0)) != null ? lookupProperty(stack1,\"draggable\") : stack1),{\"name\":\"if\",\"hash\":{},\"fn\":container.program(4, data, 0),\"inverse\":container.program(2, data, 0),\"loc\":{\"start\":{\"line\":21,\"column\":20},\"end\":{\"line\":21,\"column\":76}}})) != null ? stack1 : \"\")\n    + \"\\\" data-widget-type=\\\"\"\n    + container.escapeExpression(container.lambda(((stack1 = (depth0 != null ? lookupProperty(depth0,\"attributes\") : depth0)) != null ? lookupProperty(stack1,\"dataAttr\") : stack1), depth0))\n    + \"\\\"\\r\\n             data-widget-allow-multiple=\\\"\"\n    + container.escapeExpression(container.lambda(((stack1 = (depth0 != null ? lookupProperty(depth0,\"attributes\") : depth0)) != null ? lookupProperty(stack1,\"allowMultiple\") : stack1), depth0))\n    + \"\\\">\\r\\n          <div class=\\\"csui-widget-item icon-draggable-handle\\\" title=\\\"\"\n    + container.escapeExpression(container.lambda(((stack1 = (depth0 != null ? lookupProperty(depth0,\"attributes\") : depth0)) != null ? lookupProperty(stack1,\"disableTitle\") : stack1), depth0))\n    + \"\\\">\\r\\n            <span>\"\n    + container.escapeExpression(container.lambda(((stack1 = (depth0 != null ? lookupProperty(depth0,\"attributes\") : depth0)) != null ? lookupProperty(stack1,\"title\") : stack1), depth0))\n    + \"</span>\\r\\n            <div class=\\\"csui-layout-icon \"\n    + container.escapeExpression(container.lambda(((stack1 = (depth0 != null ? lookupProperty(depth0,\"attributes\") : depth0)) != null ? lookupProperty(stack1,\"icon\") : stack1), depth0))\n    + \"\\\"></div>\\r\\n          </div>\\r\\n        </div>\\r\\n\\r\\n\";\n},\"2\":function(container,depth0,helpers,partials,data) {\n    return \"\";\n},\"4\":function(container,depth0,helpers,partials,data) {\n    return \" binf-hidden \";\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"csui-accordion-header\\\" title=\\\"\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"title\") : depth0), depth0))\n    + \"\\\">\\r\\n  <div class=\\\"csui-accordion-header-title\\\">\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"title\") : depth0), depth0))\n    + \"</div>\\r\\n  <div class=\\\"csui-button-icon cs-icon icon-expandArrowDown\\\"></div>\\r\\n  <div class=\\\"csui-button-icon cs-icon icon-expandArrowUp\\\"></div>\\r\\n</div>\\r\\n<div class=\\\"csui-accordion-content\\\">\\r\\n  <div class=\\\"cs-content csui-list-pannel\\\">\\r\\n    <div class=\\\"cs-list-group\\\">\\r\\n\"\n    + ((stack1 = lookupProperty(helpers,\"each\").call(depth0 != null ? depth0 : (container.nullContext || {}),(depth0 != null ? lookupProperty(depth0,\"widgets\") : depth0),{\"name\":\"each\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"loc\":{\"start\":{\"line\":9,\"column\":6},\"end\":{\"line\":29,\"column\":15}}})) != null ? stack1 : \"\")\n    + \"    </div>\\r\\n  </div>\\r\\n</div>\";\n}});\nHandlebars.registerPartial('csui_perspective.manage_impl_widget.item', t);\nreturn t;\n});\n/* END_TEMPLATE */\n;\n","\n/* START_TEMPLATE */\ncsui.define('hbs!csui/perspective.manage/impl/widget.drag.template',['module','hbs','nuc/lib/handlebars'], function( module, hbs, Handlebars ){ \nvar t = Handlebars.template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"csui-widget-template\\\">\\r\\n  <div class=\\\"csui-template-header\\\">\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"header\") : depth0), depth0))\n    + \"</div>\\r\\n  <div class=\\\"csui-template-body\\\">\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"body\") : depth0), depth0))\n    + \"</div>\\r\\n</div>\";\n}});\nHandlebars.registerPartial('csui_perspective.manage_impl_widget.drag.template', t);\nreturn t;\n});\n/* END_TEMPLATE */\n;\n","csui.define('csui/perspective.manage/impl/widget.list.view',['module',\r\n  'csui/lib/underscore',\r\n  'csui/lib/jquery',\r\n  'csui/lib/backbone',\r\n  'csui/lib/marionette',\r\n  'csui/utils/base',\r\n  'csui/controls/tile/behaviors/perfect.scrolling.behavior',\r\n  'csui/perspective.manage/impl/options.form.view',\r\n  'i18n!csui/perspective.manage/impl/nls/lang',\r\n  'csui/models/widget/widget.collection',\r\n  'hbs!csui/perspective.manage/impl/widget.item',\r\n  'hbs!csui/perspective.manage/impl/widget.drag.template'\r\n], function (module, _, $, Backbone, Marionette, base, PerfectScrollingBehavior,\r\n    WidgetOptionsFormView, Lang,\r\n    WidgetCollection,\r\n    WidgetItemTemplate, WidgetDragTemplate) {\r\n  'use strict';\r\n\r\n  var config = module.config();\r\n  _.defaults(config, {\r\n    dragImageOffsetTop: 50,\r\n    dragImageOffsetLeft: 50\r\n  });\r\n\r\n  var WidgetItemView = Marionette.ItemView.extend({\r\n\r\n    constructor: function WidgetItemView(options) {\r\n      options || (options = {});\r\n      Marionette.ItemView.prototype.constructor.apply(this, arguments);\r\n    },\r\n\r\n    tagName: 'div',\r\n\r\n    className: 'csui-module-group',\r\n\r\n    template: WidgetItemTemplate,\r\n\r\n    templateHelpers: function () {\r\n      var widgetCollection = new Backbone.Collection(this.model.attributes.widgets),\r\n          disableTitle     = Lang.disableTitle,\r\n          idx              = 0;\r\n\r\n      widgetCollection.models.forEach(function (model) {\r\n        model.set({\r\n          'draggable': !!model.get('canDragAndDrop'),\r\n          'disableTitle': disableTitle,\r\n          'dataAttr': model.get('id').replace(/\\//g, \"-\"),\r\n          'allowMultiple': !!model.get('allowMultiple'),\r\n          'index': idx++\r\n        }, {'silent': true});\r\n      });\r\n      return {\r\n        widgets: widgetCollection.models\r\n      }\r\n    },\r\n\r\n    ui: {\r\n      accordionHeader: '.csui-accordion-header',\r\n      accordionContent: '.csui-accordion-content',\r\n      accordionHeaderIcon: '.csui-accordion-header .cs-icon',\r\n      widget: '.csui-draggable-widget-item'\r\n    },\r\n\r\n    events: {\r\n      'click @ui.accordionHeader': \"toggle\",\r\n      'keydown @ui.accordionHeader': 'toggle',\r\n      'dragstart @ui.widget': 'onDragStart',\r\n      'dragend @ui.widget': 'onDragEnd'\r\n    },\r\n\r\n    toggle: function () {\r\n      var isClosed = this.ui.accordionHeader.hasClass('csui-accordion-expand');\r\n      this.ui.accordionHeader.toggleClass(\"csui-accordion-expand\");\r\n      this.options.parentView.$el.find(\".csui-module-group\").removeClass('csui-accordion-visible')\r\n          .find('.csui-accordion-header').removeClass('csui-accordion-expand');\r\n      if (!isClosed) {\r\n        this.$el.addClass(\"csui-accordion-visible\");\r\n        this.ui.accordionHeader.addClass(\"csui-accordion-expand\");\r\n      }\r\n\r\n      base.onTransitionEnd(this.ui.accordionContent, function () {\r\n        this.trigger('widgets:expanded');\r\n      }, this);\r\n    },\r\n\r\n    onRender: function () {\r\n      var dndContainer = $('.perspective-editing .csui-dnd-container');\r\n      if (dndContainer.length) {\r\n        // Current perspective using sortable plugin for DnD. Get ready for it.\r\n        this._makeWidgetSortable();\r\n      } else {\r\n        // Current perspective relaying on HTML5 DnD. Get ready with IE workarounds\r\n        var hasDragDropNative = (typeof document.createElement(\"span\").dragDrop === \"function\");\r\n        if (!this._hasNativeDragImageSupport() && hasDragDropNative) {\r\n          this.ui.widget.on(\"mousedown\", this._handleDragImageForIE.bind(this));\r\n        }\r\n      }\r\n    },\r\n\r\n    _makeWidgetSortable: function () {\r\n      var self              = this,\r\n          draggableChildren = this.$el.find('.csui-widget-item.csui-draggable-widget-item'),\r\n          widgetEls         = draggableChildren.parent();\r\n      widgetEls.data('pman.widget', this.model.get('widgets'));\r\n      widgetEls.sortable({\r\n        connectWith: [\".perspective-editing .csui-dnd-container\",\r\n          \".perspective-editing .pman-trash-area\"],\r\n        containment: \".perspective-editing \",\r\n        helper: function (event, ui) {\r\n          // Drag Image\r\n          var widgetModel = ui.data('widget-index');\r\n          self.widgetDragTemplate = new widgetDragTemplateView({\r\n            title: self.model.get(\"widgets\")[widgetModel].get('title'),\r\n            newWidget: self.model.get(\"widgets\")[widgetModel]\r\n          });\r\n          self.widgetDragTemplate.render();\r\n          //Set width and height to prevent jquery ui overriding Drag item width and height\r\n          self.widgetDragTemplate.$el.width('220px');\r\n          self.widgetDragTemplate.$el.height('220px');\r\n          self.widgetDragTemplate.$el.css({opacity: 0.75});\r\n          self.widgetDragTemplate.$el.appendTo(\r\n              self.options.parentView.$el.closest('.pman-pannel-wrapper'));\r\n          return self.widgetDragTemplate.$el;\r\n        },\r\n        tolerance: 'pointer',\r\n        cursorAt: {top: config.dragImageOffsetTop, left: config.dragImageOffsetLeft},\r\n        start: function (event, ui) {\r\n          ui.item.css('display', 'block');\r\n          ui.placeholder.css('display', 'block');\r\n          self.dragStart();\r\n        },\r\n        stop: function () {\r\n          self.dragEnd();\r\n        }\r\n      });\r\n    },\r\n\r\n    _handleDragImageForIE: function (e) {\r\n      var originalEvent = e.originalEvent,\r\n          idx           = $(event.currentTarget).data('widget-index'),\r\n          $img          = $('.csui-template-wrapper').clone(),\r\n          widget        = this.model.get(\"widgets\")[idx];\r\n      $img.find(\".csui-template-header\").text(widget.get(\"title\"));\r\n      $img.css({\r\n        \"top\": Math.max(0, originalEvent.pageY - config.dragImageOffsetTop) + \"px\",\r\n        \"left\": Math.max(0, originalEvent.pageX - config.dragImageOffsetLeft) + \"px\",\r\n        \"position\": \"absolute\",\r\n        \"pointerEvents\": \"none\"\r\n      }).appendTo(document.body);\r\n\r\n      setTimeout(function () {\r\n        $img.remove();\r\n      });\r\n      $img.on('dragstart', _.bind(function (event) {\r\n        var widget       = this.model.get(\"widgets\")[idx],\r\n            dataTransfer = event.originalEvent.dataTransfer;\r\n        dataTransfer.setData(\"text\", JSON.stringify(widget.toJSON()));\r\n        this.dragStart();\r\n      }, this));\r\n      $img.on('dragend', _.bind(function (event) {\r\n        this.dragEnd();\r\n      }, this));\r\n      $img[0].dragDrop();\r\n    },\r\n\r\n    onDragStart: function (event) {\r\n      var idx          = $(event.currentTarget).data('widget-index'),\r\n          widget       = this.model.get(\"widgets\")[idx],\r\n          dataTransfer = event.originalEvent.dataTransfer;\r\n      var template = $('.csui-template-wrapper');\r\n      template.find(\".csui-template-header\").text(widget.get(\"title\"));\r\n      if (this._hasNativeDragImageSupport()) {\r\n        dataTransfer.setData(\"text\", JSON.stringify(widget.toJSON()));\r\n        // IE11 doesn't support 'setDragImage'. See `_handleDragImageForIE` function for Drag Image handling in IE.\r\n        dataTransfer.setDragImage(template[0], config.dragImageOffsetLeft,\r\n            config.dragImageOffsetTop);\r\n      }\r\n      this.dragStart();\r\n    },\r\n\r\n    _hasNativeDragImageSupport: function () {\r\n      var dataTransfer = window.DataTransfer || window.Clipboard;\r\n      return (\"setDragImage\" in dataTransfer.prototype);\r\n    },\r\n\r\n    onDragEnd: function (event) {\r\n      this.dragEnd();\r\n    },\r\n\r\n    dragStart: function () {\r\n      this.$el.closest(\".csui-pman-panel\").addClass(\"csui-pman-drag-start\");\r\n      $(document.body).addClass('csui-pman-dnd-active');\r\n    },\r\n\r\n    dragEnd: function () {\r\n      this.$el.closest(\".csui-pman-panel\").removeClass(\"csui-pman-drag-start\");\r\n      $(document.body).removeClass('csui-pman-dnd-active');\r\n    }\r\n\r\n  });\r\n\r\n  var widgetDragTemplateView = Marionette.ItemView.extend({\r\n    constructor: function WidgetItemView(options) {\r\n      Marionette.ItemView.prototype.constructor.apply(this, arguments);\r\n    },\r\n\r\n    tagName: 'div',\r\n\r\n    className: 'csui-template-wrapper',\r\n\r\n    template: WidgetDragTemplate,\r\n\r\n    templateHelpers: function () {\r\n      return {\r\n        header: this.options && this.options.title,\r\n        body: Lang.templateMessage\r\n\r\n      }\r\n    },\r\n    onRender: function () {\r\n      this.$el.data('pman.widget', this.options.newWidget);\r\n    }\r\n  });\r\n\r\n  var WidgetListView = Marionette.ItemView.extend({\r\n    tagName: 'div',\r\n\r\n    template: WidgetItemTemplate,\r\n\r\n    constructor: function WidgetListView(options) {\r\n      options || (options = {});\r\n      options.data || (options.data = {});\r\n\r\n      options.existsWidgetTypes || (options.existsWidgetTypes = []);\r\n      Marionette.ItemView.call(this, options);\r\n      this.context = this.options.pmanView.context;\r\n      var self = this;\r\n      self.widegtsUpdated = false;\r\n      this.allWidgets = new WidgetCollection();\r\n      this.allWidgets.fetch().done(function () {\r\n        self.collection = self._groupWidgetsByModule();\r\n        // self._sanitiseWidgetLibrary();\r\n        self.render();\r\n        self.trigger(\"items:fetched\");\r\n      });\r\n\r\n      // TODO: need to render using collection view instead of rendering all items within item view.\r\n      // By that  events can handle through model instead-of DOM elements.\r\n      this.listenTo(this.context, 'update:widget:panel', _.bind(function (opts) {\r\n        this.widegtsUpdated = true;\r\n        var newEleToBeProcess = opts.widgetModel && opts.widgetModel.type ? opts.widgetModel.type :\r\n                                undefined,\r\n            oldEleToBeProcess = opts.oldWidgetModel && opts.oldWidgetModel.type ?\r\n                                opts.oldWidgetModel.type : undefined;\r\n\r\n        if (!!newEleToBeProcess) {\r\n          var nodeIndex = _.indexOf(this.options.existsWidgetTypes, newEleToBeProcess);\r\n          if (nodeIndex >= 0) {\r\n            this.options.existsWidgetTypes.splice(nodeIndex, 1);\r\n          }\r\n          else {\r\n            this.options.existsWidgetTypes.push(newEleToBeProcess);\r\n          }\r\n          newEleToBeProcess = newEleToBeProcess.replace(/\\//g, \"-\");\r\n          var toggleElements = this.$el.find('div[data-widget-type=\"' + newEleToBeProcess +\r\n                                             '\"][data-widget-allow-multiple=\"false\"]');\r\n          toggleElements.length ? toggleElements.toggleClass('binf-hidden') : '';\r\n        }\r\n        if (!!oldEleToBeProcess) {\r\n          var nodeIndex = _.indexOf(this.options.existsWidgetTypes, oldEleToBeProcess);\r\n          if (nodeIndex >= 0) {\r\n            this.options.existsWidgetTypes.splice(nodeIndex, 1);\r\n          }\r\n          oldEleToBeProcess = oldEleToBeProcess.replace(/\\//g, \"-\");\r\n          var toggleElements = this.$el.find('div[data-widget-type=\"' + oldEleToBeProcess +\r\n                                             '\"][data-widget-allow-multiple=\"false\"]');\r\n          toggleElements.length ? toggleElements.toggleClass('binf-hidden') : '';\r\n        }\r\n      }, this));\r\n\r\n      this.listenTo(this.context, 'reset:widget:panel', _.bind(function (opts) {\r\n        this.options.existsWidgetTypes = [];\r\n        this.widegtsUpdated = true;\r\n      }, this));\r\n    },\r\n\r\n    initialize: function () {\r\n      _.bindAll(this, \"renderItem\");\r\n    },\r\n\r\n    className: 'cs-module-list',\r\n\r\n    render: function () {\r\n      this.collection && this.collection.each(this.renderItem);\r\n    },\r\n\r\n    renderItem: function (model) {\r\n      var parentView = this;\r\n      var itemView = new WidgetItemView({\r\n        model: model,\r\n        parentView: parentView,\r\n        context: this.context\r\n      });\r\n      itemView.render();\r\n      this.listenTo(itemView, 'widgets:expanded', _.bind(this.trigger, this, 'dom:refresh', this));\r\n      $(this.el).append(itemView.el);\r\n    },\r\n\r\n    _groupWidgetsByModule: function () {\r\n      // creates a data model where widgets are grouped according to their module\r\n      var moduleCollection = new Backbone.Collection();\r\n      var widgets = this.allWidgets.filter(function (widget) {\r\n        var manifest = widget.get('manifest');\r\n        if (!manifest || !_.has(manifest, 'title') || !_.has(manifest, 'description') ||\r\n            manifest.deprecated) {\r\n          return false;\r\n        }\r\n        var schema        = JSON.parse(JSON.stringify(manifest.schema || {})),\r\n            options       = JSON.parse(JSON.stringify(manifest.options || {})),\r\n            isValidSchema = WidgetOptionsFormView._normalizeOptions(\r\n                schema.properties, options.fields || {}, {});\r\n        if (!isValidSchema) {\r\n          // Found unknown properties.. hence widget unsupported.\r\n          return false;\r\n        }\r\n        return true;\r\n      });\r\n\r\n      _.each(widgets, _.bind(function (widget) {\r\n        var manifest       = _.defaults(widget.get('manifest'), {\r\n              'allowMultiple': true,\r\n              'title': Lang.noTitle\r\n            }),\r\n            canDragAndDrop = manifest.allowMultiple;\r\n\r\n        if (!canDragAndDrop) {\r\n          canDragAndDrop = $.inArray(widget.get('id'), this.options.existsWidgetTypes) === -1;\r\n        }\r\n\r\n        widget.set({\r\n          'allowMultiple': manifest.allowMultiple,\r\n          'canDragAndDrop': canDragAndDrop,\r\n          'title': manifest.title\r\n        });\r\n      }, this));\r\n\r\n      _.each(_.groupBy(widgets, function (widget) {\r\n        return widget.serverModule.id;\r\n      }), function (val, key) {\r\n        var title = _.first(val).serverModule.get('title');\r\n        // remove superfluous OpenText prefix.\r\n        title = title ? title.replace(/OpenText /, '') :\r\n                _.first(val).serverModule.get('id').toUpperCase();\r\n        moduleCollection.add({\r\n          id: key,\r\n          title: title,\r\n          widgets: val\r\n        })\r\n      });\r\n      return moduleCollection;\r\n    },\r\n\r\n    _sanitiseWidgetLibrary: function () {\r\n      // checks to see if any widget groups or widgets have been whitelisted or blacklisted\r\n      // alpha-sorts the groups and the widgets within them.\r\n    },\r\n\r\n    onInitWidgets: function () {\r\n      this.$el.empty(); // FIXME Make this ItemView as CollectionView\r\n       if(this.widegtsUpdated){\r\n        this.collection = this._groupWidgetsByModule();\r\n        this.widegtsUpdated = false;\r\n      }\r\n      this.render();\r\n    },\r\n\r\n  });\r\n\r\n  return WidgetListView;\r\n\r\n});\r\n\n","\n","csui.define('csui/perspective.manage/impl/perspectivelayouts',['module',\r\n    'csui/lib/underscore',\r\n    'i18n!csui/perspective.manage/impl/nls/lang',\r\n    // Load extra layout items to be added\r\n    'csui-ext!perspective.manage/impl/perspectivelayouts'\r\n], function(module,_, Lang, extraPerspectiveLayouts) {\r\n    var config = _.extend({       \r\n        enableNewlayoutOption: false,\r\n      }, module.config());\r\n\r\n    var perspectivelayouts = [\r\n        {\r\n            title: Lang.LcrLayoutTitle,\r\n            type: \"left-center-right\",\r\n            icon: \"csui-layout-lcr\"\r\n        },\r\n        {\r\n            title: Lang.FlowLayoutTitle,\r\n            type: \"flow\",\r\n            icon: \"csui-layout-flow\"\r\n        }\r\n    ];\r\n    if (config.enableNewlayoutOption) {\r\n        perspectivelayouts.push(\r\n            {\r\n                title: Lang.RSPLayoutTitle,\r\n                type: \"sidepanel-right\",\r\n                icon: \"csui-layout-sidepanel-right\"\r\n            },\r\n            {\r\n                title: Lang.LSPLayoutTitle,\r\n                type: \"sidepanel-left\",\r\n                icon: \"csui-layout-sidepanel-left\"\r\n            }\r\n        );\r\n    }\r\n\r\n\r\n    if(extraPerspectiveLayouts) {\r\n        perspectivelayouts = _.union(perspectivelayouts, extraPerspectiveLayouts);\r\n    }\r\n\r\n    return perspectivelayouts;\r\n});\n","\n/* START_TEMPLATE */\ncsui.define('hbs!csui/perspective.manage/impl/pman.panel',['module','hbs','nuc/lib/handlebars'], function( module, hbs, Handlebars ){ \nvar t = Handlebars.template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"csui-tab-pannel\\\">\\r\\n  <div class=\\\"csui-layout-tab\\\" title=\\\"\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"layoutTabTitle\") : depth0), depth0))\n    + \"\\\">\\r\\n    \"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"layoutTabTitle\") : depth0), depth0))\n    + \"\\r\\n  </div>\\r\\n  <div class=\\\"csui-AddWidget-tab\\\" title=\\\"\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"widgetTabTitle\") : depth0), depth0))\n    + \"\\\">\\r\\n    \"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"widgetTabTitle\") : depth0), depth0))\n    + \"\\r\\n  </div>\\r\\n  <div class=\\\"csui-widget-tab\\\"></div>\\r\\n</div>\\r\\n<div class=\\\"csui-list-pannel\\\"></div>\\r\\n<div class=\\\"csui-template-overlay\\\"></div>\\r\\n<div class=\\\"csui-template-wrapper\\\">\\r\\n  <div class=\\\"csui-widget-template\\\">\\r\\n    <div class=\\\"csui-template-header\\\"></div>\\r\\n    <div class=\\\"csui-template-body\\\">\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"templateMessage\") : depth0), depth0))\n    + \"</div>\\r\\n  </div>\\r\\n</div>\";\n}});\nHandlebars.registerPartial('csui_perspective.manage_impl_pman.panel', t);\nreturn t;\n});\n/* END_TEMPLATE */\n;\n","\n/* START_TEMPLATE */\ncsui.define('hbs!csui/perspective.manage/impl/list.item',['module','hbs','nuc/lib/handlebars'], function( module, hbs, Handlebars ){ \nvar t = Handlebars.template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"className\") : depth0), depth0))\n    + \"\\\" title=\\\"\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"title\") : depth0), depth0))\n    + \"\\\"\\r\\n     draggable=\\\"\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"draggable\") : depth0), depth0))\n    + \"\\\" tabindex= \\\"-1\\\">\\r\\n  <span>\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"title\") : depth0), depth0))\n    + \"</span>\\r\\n  <div class=\\\"csui-layout-icon \"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"iconClass\") : depth0), depth0))\n    + \"\\\"></div>\\r\\n</div>\";\n}});\nHandlebars.registerPartial('csui_perspective.manage_impl_list.item', t);\nreturn t;\n});\n/* END_TEMPLATE */\n;\n","\n/* START_TEMPLATE */\ncsui.define('hbs!csui/perspective.manage/impl/list',['module','hbs','nuc/lib/handlebars'], function( module, hbs, Handlebars ){ \nvar t = Handlebars.template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"cs-header binf-panel-heading cs-header-with-go-back\\\" role=\\\"link\\\"\\r\\n     aria-label=\\\"\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"goBackAria\") || (depth0 != null ? lookupProperty(depth0,\"goBackAria\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"goBackAria\",\"hash\":{},\"loc\":{\"start\":{\"line\":2,\"column\":17},\"end\":{\"line\":2,\"column\":31}}}) : helper)))\n    + \"\\\">\\r\\n  <span class=\\\"icon circular arrow_back cs-go-back\\\" title=\\\"\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"goBackTooltip\") || (depth0 != null ? lookupProperty(depth0,\"goBackTooltip\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"goBackTooltip\",\"hash\":{},\"loc\":{\"start\":{\"line\":3,\"column\":59},\"end\":{\"line\":3,\"column\":76}}}) : helper)))\n    + \"\\\"></span>\\r\\n</div>\\r\\n<div class=\\\"cs-content\\\">\\r\\n  <div class=\\\"cs-list-group\\\"></div>\\r\\n</div>\\r\\n\";\n}});\nHandlebars.registerPartial('csui_perspective.manage_impl_list', t);\nreturn t;\n});\n/* END_TEMPLATE */\n;\n","\ncsui.define('css!csui/perspective.manage/impl/pman.panel',[],function(){});\n","csui.define('csui/perspective.manage/impl/pman.panel.view',['require', 'module', 'csui/lib/jquery', 'csui/lib/backbone',\r\n  'csui/lib/underscore', 'csui/lib/marionette',\r\n  \"csui/controls/progressblocker/blocker\",\r\n  'csui/controls/tile/behaviors/perfect.scrolling.behavior',\r\n  'csui/perspective.manage/impl/widget.list.view',\r\n  'csui/perspective.manage/impl/perspectivelayouts',\r\n  'i18n!csui/perspective.manage/impl/nls/lang',\r\n  'hbs!csui/perspective.manage/impl/pman.panel',\r\n  'hbs!csui/perspective.manage/impl/list.item',\r\n  'hbs!csui/perspective.manage/impl/list',\r\n  'hbs!csui/perspective.manage/impl/widget.drag.template',\r\n  'css!csui/perspective.manage/impl/pman.panel'\r\n\r\n], function (require, module, $, Backbone, _, Marionette, BlockerView, PerfectScrollingBehavior,\r\n    WidgetListView, perspectiveLayouts, Lang, template, ListItemTemplate, ListTemplate,\r\n    WidgetDragTemplate) {\r\n  'use strict';\r\n\r\n  var PManPanelView = Marionette.ItemView.extend({\r\n    tagName: 'div',\r\n\r\n    template: template,\r\n\r\n    events: {\r\n      'click @ui.layoutTab': \"onTabClicked\",\r\n      'keydown @ui.layoutTab': \"onKeyDown\"\r\n    },\r\n\r\n    ui: {\r\n      tabPannel: \".csui-tab-pannel\",\r\n      listPannel: \".csui-list-pannel\",\r\n      layoutTab: \".csui-layout-tab\",\r\n      widgetTab: \".csui-widget-tab\",\r\n      template: \".csui-widget-template\"\r\n    },\r\n\r\n    className: 'csui-pman-panel',\r\n\r\n    behaviors: {\r\n      PerfectScrolling: {\r\n        behaviorClass: PerfectScrollingBehavior,\r\n        contentParent: '.csui-tab-pannel, .csui-list-pannel',\r\n        suppressScrollX: true,\r\n        scrollYMarginOffset: 8\r\n      }\r\n    },\r\n\r\n    templateHelpers: function () {\r\n      return {\r\n        layoutTabTitle: Lang.layoutTabTitle,\r\n        widgetTabTitle: Lang.widgetTabTitle,\r\n        templateMessage: Lang.templateMessage\r\n      }\r\n    },\r\n\r\n    onPanelOpen: function () {\r\n      this.accordionView.triggerMethod(\"init:widgets\");\r\n      this.trigger('ensure:scrollbar');\r\n    },\r\n\r\n    onRender: function () {\r\n      this.ui.widgetTab.hide();\r\n      this.ui.layoutTab.hide();\r\n      this.accordionRegion = new Marionette.Region({\r\n        el: this.ui.widgetTab\r\n      });\r\n      this.accordionView = new WidgetListView(this.options);\r\n      this.accordionRegion.show(this.accordionView);\r\n      this.blockActions();\r\n      this.listenTo(this.accordionView, \"items:fetched\", function () {\r\n        this.unblockActions();\r\n        this.ui.layoutTab.show();\r\n        this.ui.widgetTab.show();\r\n      });\r\n      this.listenTo(this.accordionView, \"dom:refresh\", function () {\r\n        // Dom refresh to ensure perfect scrollbar\r\n        this.trigger('dom:refresh');\r\n      });\r\n    },\r\n\r\n    constructor: function PManPanelView(options) {\r\n      this.options = options || {};\r\n      this.options.existsWidgetTypes = this._getExistsWidgetTypes() || [];\r\n      Marionette.ItemView.prototype.constructor.apply(this, arguments);\r\n      BlockerView.imbue(this);\r\n      this.listenTo(this, 'reset:items', function () {\r\n        this.listView && this.listView.destroy();\r\n      });\r\n    },\r\n\r\n    _getExistsWidgetTypes: function () {\r\n      var perspective       = this.options.pmanView.perspective.get('perspective'),\r\n          type              = perspective.type,\r\n          perpeCollection   = {},\r\n          existsWidgetTypes = [];\r\n\r\n      //Handling 'flow' and 'LCR' perspectives as these two only support edit page.\r\n      if (type == 'flow') {\r\n        perpeCollection = perspective.options;\r\n        perpeCollection.widgets.forEach(\r\n            _.bind(function (widget) {\r\n              if (!!widget.type) {\r\n                existsWidgetTypes.push(widget.type);\r\n              }\r\n            }, this));\r\n      } else if (type == 'left-center-right') {\r\n        perpeCollection = perspective.options;\r\n        perpeCollection.center && existsWidgetTypes.push(perpeCollection.center.type);\r\n        perpeCollection.right && existsWidgetTypes.push(perpeCollection.right.type);\r\n        perpeCollection.left && existsWidgetTypes.push(perpeCollection.left.type);\r\n      }\r\n      return existsWidgetTypes;\r\n    },\r\n\r\n    onTabClicked: function (options) {\r\n      var args = options.data ? options : {\r\n        data: {\r\n          items: perspectiveLayouts\r\n        }\r\n      };\r\n      args.draggable = !!args.data.draggable;\r\n      args.itemClassName = \"csui-layout-item\";\r\n      args.pmanView = this.options.pmanView;\r\n\r\n      this.ui.tabPannel.addClass(\"binf-hidden\");\r\n      this.listregion = new Marionette.Region({\r\n        el: this.ui.listPannel\r\n      });\r\n      this.listView = new ListView(args);\r\n      this.listregion.show(this.listView);\r\n      this.$el.find('.cs-go-back').attr('tabindex', 0);\r\n      var ele = this.$el.find('.csui-layout-item.binf-active');\r\n      $(ele[0]).attr('tabindex', 0);\r\n      ele.focus();\r\n      // Register events on listview to handle back\r\n      this.listenTo(this.listView, \"before:destroy\", function () {\r\n        this.ui.tabPannel.removeClass(\"binf-hidden\");\r\n      }).listenTo(this.listView, \"click:back\", function () {\r\n        this.listView.destroy();\r\n      });\r\n    },\r\n\r\n    onKeyDown: function (event) {\r\n      if (event.keyCode === 13 || event.keyCode === 32) {\r\n        this.onTabClicked(event);\r\n      }\r\n    }\r\n  });\r\n\r\n  var ListItemView = Marionette.ItemView.extend({\r\n    constructor: function ListItemView(options) {\r\n      Marionette.ItemView.prototype.constructor.apply(this, arguments);\r\n    },\r\n\r\n    tagName: 'div',\r\n    template: ListItemTemplate,\r\n\r\n    templateHelpers: function () {\r\n      return {\r\n        draggable: !!this.options.draggable,\r\n        className: this.options.itemClassName,\r\n        iconClass: this.model.get('icon')\r\n      }\r\n    },\r\n\r\n    events: {\r\n      'click .csui-layout-item:not(.binf-active)': _.debounce(function () {\r\n        this.trigger('change:layout');\r\n      }, 200, true),\r\n      'keydown .csui-layout-item': _.debounce(function (event) {\r\n        if (event.keyCode === 13 || event.keyCode === 32) {\r\n          this.trigger('change:layout');\r\n        } else if (event.keyCode === 9 || event.keyCode === 16) {\r\n          this.$el.find('.csui-layout-item').attr('tabindex', -1);\r\n          //this.$el.find('.csui-layout-item').removeClass('binf-active');\r\n          if (event.keyCode === 9 && event.shiftKey) {\r\n            event.preventDefault();\r\n            this.options.pmanView.$el.find('.cs-go-back').focus();\r\n          } else if (event.keyCode === 9) {\r\n            event.preventDefault();\r\n            $(this.options.pmanView.$el.find('.binf-btn.icon-save')).focus();\r\n            $(this.options.pmanView.$el.find('.csui-layout-item.binf-active')[0]).attr('tabindex', 0);\r\n          } else if (!event.shiftKey) {\r\n            $(this.options.pmanView.$el.find('.csui-layout-item.binf-active')[0]).attr('tabindex', 0);\r\n          }\r\n        } else {\r\n          this.handleKeydown(event);\r\n        }\r\n      }, 200, true),\r\n    },\r\n\r\n    handleKeydown: function (event) {\r\n        if (event.keyCode === 38 || event.keyCode === 40) {\r\n          this.$el.find('.csui-layout-item').attr('tabindex', -1);\r\n          event.preventDefault();\r\n          event.stopPropagation();\r\n          if (event.keyCode === 38) { // up arrow key\r\n            var previousEle = this.$el.prev().find('.csui-layout-item');\r\n            if (previousEle.length > 0) {\r\n              previousEle.trigger('focus');\r\n            }\r\n          } else if (event.keyCode === 40) { // down arrow key\r\n            var nextEle = this.$el.next().find('.csui-layout-item');\r\n            if (nextEle.length > 0) {\r\n              nextEle.trigger('focus');\r\n            }\r\n          }\r\n        }\r\n    },\r\n\r\n    onRender: function () {\r\n      if (this.model.get('type') === this.options.pmanView.perspective.get('perspective').type) {\r\n        this.trigger('set:active');\r\n      }\r\n    }\r\n\r\n  });\r\n\r\n  var ListView = Marionette.CompositeView.extend({\r\n\r\n    constructor: function ListView(options) {\r\n      options || (options = {});\r\n      options.data || (options.data = {});\r\n\r\n      // Provide the perfect scrollbar to every list view by default\r\n      // (Behaviors cannot be inherited; add the PerfectScrolling\r\n      //  to the local clone of the descendant's behaviors.)\r\n      if (!(this.behaviors && _.any(this.behaviors, function (behavior, key) {\r\n        return behavior.behaviorClass === PerfectScrollingBehavior;\r\n      }))) {\r\n        this.behaviors = _.extend({\r\n          PerfectScrolling: {\r\n            behaviorClass: PerfectScrollingBehavior,\r\n            contentParent: '.csui-pman-list',\r\n            suppressScrollX: true,\r\n            // like bottom padding of container, otherwise scrollbar is shown always\r\n            scrollYMarginOffset: 15\r\n          }\r\n        }, this.behaviors);\r\n      }\r\n\r\n      Marionette.CompositeView.call(this, options);\r\n\r\n      // TODO: Deprecate this, or fix it, so that a collection can be created\r\n      // without breaking the client\r\n      // Passing a collection without knowing its model schema and identifier\r\n      // is not possible in Backbone, where the collections should be indexed\r\n      if (this.options.data && this.options.data.items) {\r\n        if (!this.collection) {\r\n          var ViewCollection = Backbone.Collection.extend({\r\n            model: Backbone.Model.extend({\r\n              idAttribute: null\r\n            })\r\n          });\r\n          this.collection = new ViewCollection();\r\n        }\r\n        this.collection.add(this.options.data.items);\r\n      }\r\n    },\r\n\r\n    ui: {\r\n      back: '.cs-go-back'\r\n    },\r\n    className: 'csui-pman-list',\r\n\r\n    events: {\r\n      'click @ui.back': 'onClickBack',\r\n      'keydown @ui.back': 'onKeyInView'\r\n    },\r\n\r\n    childEvents: {\r\n      'change:layout': 'onChangeLayout',\r\n      'set:active': 'setActive'\r\n    },\r\n\r\n    template: ListTemplate,\r\n\r\n    templateHelpers: function () {\r\n      return {\r\n        goBackTooltip: Lang.goBackTooltip\r\n      };\r\n    },\r\n\r\n    childViewContainer: '.cs-list-group',\r\n\r\n    childView: ListItemView,\r\n\r\n    childViewOptions: function () {\r\n      return this.options;\r\n    },\r\n\r\n    onClickBack: function (event) {\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      this.trigger('click:back');\r\n    },\r\n\r\n    onKeyInView: function (event) {\r\n      if (event.keyCode === 13 || event.keyCode === 32) {\r\n        this.onClickBack(event);\r\n        this.options.pmanView.$el.find('.csui-layout-tab').focus();\r\n      } else if (event.keyCode === 9) {\r\n        if (!event.shiftKey) {\r\n          event.preventDefault();\r\n          this.$el.find('.csui-layout-item.binf-active').focus();\r\n        }\r\n      }\r\n    },\r\n\r\n    setActive: function (childView) {\r\n      this.$el.find('.csui-layout-item').removeClass('binf-active');\r\n      childView.$el.find('.csui-layout-item').addClass('binf-active');\r\n    },\r\n\r\n    onChangeLayout: function (childView) {\r\n      var self = this,\r\n        newLayout = childView.model.get('type'),\r\n        currentLayout = this.options.pmanView.perspective.get('perspective').type;\r\n      if ((currentLayout === 'sidepanel-right' || currentLayout === 'sidepanel-left')\r\n        && (newLayout === 'sidepanel-right' || newLayout === 'sidepanel-left')) {\r\n        //swapping the layouts without any warning message and also retaining the widgets\r\n        // while switching between sidepanel-left and sidepanel-right\r\n        self.setActive(childView);\r\n        self.options.pmanView.trigger(\"swap:layout\", newLayout);\r\n      }\r\n      else {\r\n        require(['csui/dialogs/modal.alert/modal.alert'], function (ModalAlertView) {\r\n          ModalAlertView.confirmWarning(Lang.changePageLayoutConfirmatonText, Lang.layoutTabTitle,\r\n            {\r\n              buttons: {\r\n                showYes: true,\r\n                labelYes: Lang.proceedButton,\r\n                showNo: true,\r\n                labelNo: Lang.changeLayoutCancelButton\r\n              }\r\n            })\r\n            .done(function (labelYes) {\r\n              if (labelYes) {\r\n                self.setActive(childView);\r\n                self.options.pmanView.trigger(\"change:layout\", childView.model.get('type'));\r\n                self.options.pmanView.context.trigger(\"reset:widget:panel\");\r\n              }\r\n            });\r\n        });\r\n      }\r\n    }\r\n\r\n  });\r\n\r\n  return PManPanelView;\r\n});\r\n\r\n\n","csui.define('csui/perspectives/mixins/draganddrop.kn.mixin',[\"csui/lib/underscore\", \"csui/lib/jquery\",'i18n'], function (_, $, i18n) {\r\n  \"use strict\";\r\n\r\n  var DragAndDropKNMixin = {\r\n    mixin: function (prototype) {\r\n      return _.extend(prototype, {\r\n        moveToRight: function (movableEle, focusableEle, widgetCells) {\r\n          var self = this, isRtl = i18n && i18n.settings.rtl,\r\n              nextEle = movableEle.next();\r\n\r\n          function callback() {\r\n            movableEle && movableEle.insertAfter(nextEle);\r\n            focusableEle && focusableEle.trigger(\"focus\");\r\n            self.swapIndexPositions(widgetCells, movableEle.index(), nextEle.index());\r\n          }\r\n\r\n          nextEle.length && this.animation(movableEle, nextEle, !isRtl, callback);\r\n        },\r\n\r\n        moveToLeft: function (movableEle, focusableEle, widgetCells) {\r\n          var self = this, isRtl = i18n && i18n.settings.rtl,\r\n              prevEle = movableEle.prev();\r\n\r\n          function callback() {\r\n            movableEle && movableEle.insertBefore(prevEle);\r\n            focusableEle && focusableEle.trigger(\"focus\");\r\n            self.swapIndexPositions(widgetCells, movableEle.index(), prevEle.index());\r\n          }\r\n          prevEle.length && this.animation(movableEle, prevEle, isRtl, callback);\r\n        },\r\n\r\n        animation: function (movableEle, destEle, isMovingRight, callback) {\r\n          var positions = this.findPositions(movableEle, destEle),\r\n              isEleInSameRow = (positions.destEle.top === positions.movableEle.top),\r\n              destEleWidth = destEle.width(),\r\n              movableEleWidth = movableEle.width(),self = this,duration = 400;\r\n          movableEle.css('zIndex', 99999);\r\n          destEle.css('zIndex', 99998);\r\n          if(self.isAnimationInProgress){\r\n            /* stop current running animation*/\r\n            duration = 0;\r\n            this.movableEleAnimate && this.movableEleAnimate.stop();\r\n            this.destEleAnimate && this.destEleAnimate.stop();\r\n          }\r\n          self.isAnimationInProgress = true;\r\n          this.movableEleAnimate =  movableEle.animate(\r\n            {\r\n              left: isEleInSameRow &&\r\n                    isMovingRight ? destEleWidth :\r\n                    positions.destEle.left - positions.movableEle.left,\r\n              top: isEleInSameRow ? 0 : positions.destEle.top - positions.movableEle.top,\r\n            },\r\n            {duration: duration, easing: \"easeInOutCubic\", queue: false}\r\n          );\r\n          this.destEleAnimate =  destEle.animate(\r\n            {\r\n              left: isEleInSameRow ?\r\n                    isMovingRight ? positions.movableEle.left - positions.destEle.left :\r\n                    movableEleWidth < destEleWidth ? movableEleWidth : destEleWidth :\r\n                    positions.movableEle.left - positions.destEle.left,\r\n              top: isEleInSameRow ? 0 : positions.movableEle.top - positions.destEle.top,\r\n            },\r\n            {duration: duration, easing: \"easeInOutCubic\", queue: false}\r\n          );\r\n         $.when(\r\n          this.movableEleAnimate , this.destEleAnimate\r\n          ).always(function () {\r\n            self.isAnimationInProgress = false;\r\n            movableEle.css({\r\n              top: 0,\r\n              left: 0,\r\n              zIndex: 'initial'\r\n            });\r\n            destEle.css({\r\n              top: 0,\r\n              left: 0,\r\n              zIndex: 'initial'\r\n            });\r\n            callback();\r\n          });\r\n        },\r\n\r\n        swapIndexPositions: function (widgetCells, old_index, new_index) {\r\n          var temp = widgetCells[old_index];\r\n          widgetCells[old_index] = widgetCells[new_index];\r\n          widgetCells[new_index] = temp;\r\n          return widgetCells;\r\n        },\r\n\r\n        findPositions: function (movableEle, destEle) {\r\n          return {\r\n            movableEle: movableEle.offset(),\r\n            destEle: destEle.offset()\r\n          };\r\n        }\r\n      });\r\n    },\r\n  };\r\n\r\n  return DragAndDropKNMixin;\r\n});\r\n\n","\n/* START_TEMPLATE */\ncsui.define('hbs!csui/perspective.manage/impl/pman',['module','hbs','nuc/lib/handlebars'], function( module, hbs, Handlebars ){ \nvar t = Handlebars.template({\"1\":function(container,depth0,helpers,partials,data) {\n    var lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"          <li>\\r\\n            <button class=\\\"binf-btn icon-reset\\\" title=\\\"\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"reset\") : depth0), depth0))\n    + \"\\\"\\r\\n                    aria-label=\\\"\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"resetAriaLabel\") : depth0), depth0))\n    + \"\\\">\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"reset\") : depth0), depth0))\n    + \"</button>\\r\\n          </li>\\r\\n\";\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"pman-backdrop\\\"></div>\\r\\n<div class=\\\"pman-header\\\">\\r\\n  <div class=\\\"pman-header-backdrop\\\"></div>\\r\\n  <div class=\\\"pman-tools-container\\\">\\r\\n    <div class=\\\"pman-left-tools\\\">\\r\\n      <ul>\\r\\n        <li class=\\\"pman-toolitem\\\">\\r\\n          <button class=\\\"icon icon-toolbarAdd\\\" title=\\\"\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"addWidget\") : depth0), depth0))\n    + \"\\\"></button>\\r\\n        </li>\\r\\n      </ul>\\r\\n      <div class=\\\"pman-pannel-wrapper\\\"></div>\\r\\n    </div>\\r\\n    <div class=\\\"pman-right-tools\\\">\\r\\n      <ul>\\r\\n\"\n    + ((stack1 = lookupProperty(helpers,\"if\").call(depth0 != null ? depth0 : (container.nullContext || {}),(depth0 != null ? lookupProperty(depth0,\"personalizeMode\") : depth0),{\"name\":\"if\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"loc\":{\"start\":{\"line\":15,\"column\":8},\"end\":{\"line\":20,\"column\":15}}})) != null ? stack1 : \"\")\n    + \"        <li>\\r\\n          <button class=\\\"binf-btn icon-save\\\" title=\\\"\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"save\") : depth0), depth0))\n    + \"\\\"\\r\\n                  aria-label=\\\"\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"saveAriaLabel\") : depth0), depth0))\n    + \"\\\">\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"save\") : depth0), depth0))\n    + \"</button>\\r\\n        </li>\\r\\n        <li>\\r\\n          <button class=\\\"binf-btn cancel-edit\\\" title=\\\"\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"cancel\") : depth0), depth0))\n    + \"\\\"\\r\\n                  aria-label=\\\"\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"cancelAriaLabel\") : depth0), depth0))\n    + \"\\\">\"\n    + container.escapeExpression(container.lambda((depth0 != null ? lookupProperty(depth0,\"cancel\") : depth0), depth0))\n    + \"</button>\\r\\n        </li>\\r\\n      </ul>\\r\\n    </div>\\r\\n  </div>\\r\\n  <div class=\\\"pman-trash-area\\\">\\r\\n    <div class=\\\"pman-trash-banner\\\"></div>\\r\\n  </div>\\r\\n</div>\";\n}});\nHandlebars.registerPartial('csui_perspective.manage_impl_pman', t);\nreturn t;\n});\n/* END_TEMPLATE */\n;\n","\ncsui.define('css!csui/perspective.manage/impl/pman',[],function(){});\n","csui.define('csui/perspective.manage/behaviours/impl/nls/lang',{\r\n  // Always load the root bundle for the default locale (en-us)\r\n  \"root\": true,\r\n  // Do not load English locale bundle provided by the root bundle\r\n  \"en-us\": false,\r\n  \"en\": false\r\n});\r\n\n","csui.define('csui/perspective.manage/behaviours/impl/nls/root/lang',{\r\n  deleteConfirmMsg: 'Widget will be removed from the page.',\r\n  deleteConfirmTitle: 'Remove Widget',\r\n  replaceConfirmMsg: 'Do you want to replace this widget?',\r\n  replaceConfirmTitle: 'Replace Widget',\r\n  widgetSizeTitle: 'Widget size',\r\n  widgetSizeDescription: 'Determines how much space the widget occupies. Note that widgets are re-sized automatically to display optimally on smaller screens.',\r\n  removeWidget: 'Remove widget',\r\n  editWidget: 'Widget settings',\r\n  replace: 'Replace',\r\n  remove: 'Remove',\r\n  cancel: 'Cancel',\r\n  configNeeded: 'Configuration needed.',\r\n  hideWidget: 'Hide',\r\n  showWidget: 'Display',\r\n  personalizeModewidgetFocusLabel: '{0} widget. Press Enter to access {1} action. Press Ctrl+ Right or Left Arrow to move the widget to the right or left .',\r\n  personalizeShortcutwidgetFocusLabel: '{0}. Press Enter to access {1} action. Press Ctrl+ Right or Left Arrow to move the widget to the right or left .',\r\n  editModewidgetFocusLabel: '{0} widget. Press Enter to access associated actions. Press Ctrl+ Right or Left  Arrow to move the widget to the right or left.',\r\n  widgetSettings: '{0} widget settings',\r\n  objects: '{0} widget shows {0} objects of the current user',\r\n  delete: 'remove {0} Widget',\r\n  hideWidgetAriaLabel: 'Hide {0} Widget',\r\n  showWidgetriaLabel: 'Display {0} Widget',\r\n  info: 'Info about {0}'\r\n});\r\n\n","\n/* START_TEMPLATE */\ncsui.define('hbs!csui/perspective.manage/behaviours/impl/widget.masking',['module','hbs','nuc/lib/handlebars'], function( module, hbs, Handlebars ){ \nvar t = Handlebars.template({\"1\":function(container,depth0,helpers,partials,data) {\n    var helper, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"    <div class=\\\"csui-pman-widget-error\\\">\\r\\n      <div class=\\\"csui-pman-widget-error-heading\\\"> \"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"widgetTitle\") || (depth0 != null ? lookupProperty(depth0,\"widgetTitle\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"widgetTitle\",\"hash\":{},\"loc\":{\"start\":{\"line\":7,\"column\":51},\"end\":{\"line\":7,\"column\":66}}}) : helper)))\n    + \"</div>\\r\\n      <div class=\\\"csui-pman-widget-error-body\\\">\\r\\n        <div class=\\\"csui-pman-widget-error-icon\\\"></div>\\r\\n        <div class=\\\"csui-pman-widget-error-message\\\"> \"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"configNeeded\") || (depth0 != null ? lookupProperty(depth0,\"configNeeded\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"configNeeded\",\"hash\":{},\"loc\":{\"start\":{\"line\":10,\"column\":53},\"end\":{\"line\":10,\"column\":69}}}) : helper)))\n    + \"</div>\\r\\n      </div>\\r\\n    </div>\\r\\n    <div class=\\\"csui-pman-perspective-actions\\\">\\r\\n      <button class=\\\"csui-pman-perspective-btn csui-pman-widget-edit icon-edit\\\"\\r\\n              title=\\\"\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"editWidget\") || (depth0 != null ? lookupProperty(depth0,\"editWidget\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"editWidget\",\"hash\":{},\"loc\":{\"start\":{\"line\":15,\"column\":21},\"end\":{\"line\":15,\"column\":35}}}) : helper)))\n    + \"\\\"></button>\\r\\n      <button class=\\\"csui-pman-perspective-btn csui-pman-widget-close clear-icon\\\"\\r\\n              title=\\\"\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"removeWidget\") || (depth0 != null ? lookupProperty(depth0,\"removeWidget\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"removeWidget\",\"hash\":{},\"loc\":{\"start\":{\"line\":17,\"column\":21},\"end\":{\"line\":17,\"column\":37}}}) : helper)))\n    + \"\\\"></button>\\r\\n    </div>\\r\\n\";\n},\"3\":function(container,depth0,helpers,partials,data) {\n    var stack1, helper, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"    <div class=\\\"csui-pman-widget-personalize-mask text-center\\\">\\r\\n      <button class=\\\"binf-btn csui-pman-personalize-btn csui-pman-hide-show-toggle\\\"\\r\\n              title=\\\"\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"hideShowToggle\") || (depth0 != null ? lookupProperty(depth0,\"hideShowToggle\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"hideShowToggle\",\"hash\":{},\"loc\":{\"start\":{\"line\":22,\"column\":21},\"end\":{\"line\":22,\"column\":39}}}) : helper)))\n    + \"\\\"\\r\\n\"\n    + ((stack1 = lookupProperty(helpers,\"if\").call(depth0 != null ? depth0 : (container.nullContext || {}),(depth0 != null ? lookupProperty(depth0,\"isWidgetHidden\") : depth0),{\"name\":\"if\",\"hash\":{},\"fn\":container.program(4, data, 0),\"inverse\":container.program(6, data, 0),\"loc\":{\"start\":{\"line\":23,\"column\":8},\"end\":{\"line\":27,\"column\":15}}})) != null ? stack1 : \"\")\n    + \"      >\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"hideShowToggle\") || (depth0 != null ? lookupProperty(depth0,\"hideShowToggle\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"hideShowToggle\",\"hash\":{},\"loc\":{\"start\":{\"line\":28,\"column\":7},\"end\":{\"line\":28,\"column\":25}}}) : helper)))\n    + \"\\r\\n      </button>\\r\\n    </div>\\r\\n\";\n},\"4\":function(container,depth0,helpers,partials,data) {\n    var helper, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"              aria-label=\\\"\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"showWidgetriaLabel\") || (depth0 != null ? lookupProperty(depth0,\"showWidgetriaLabel\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"showWidgetriaLabel\",\"hash\":{},\"loc\":{\"start\":{\"line\":24,\"column\":26},\"end\":{\"line\":24,\"column\":48}}}) : helper)))\n    + \"\\\"\\r\\n\";\n},\"6\":function(container,depth0,helpers,partials,data) {\n    var helper, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"              aria-label=\\\"\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"hideWidgetAriaLabel\") || (depth0 != null ? lookupProperty(depth0,\"hideWidgetAriaLabel\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"hideWidgetAriaLabel\",\"hash\":{},\"loc\":{\"start\":{\"line\":26,\"column\":26},\"end\":{\"line\":26,\"column\":49}}}) : helper)))\n    + \"\\\"\\r\\n\";\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, helper, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"csui-pman-popover-right csui-pman-popover-holder\\\"></div>\\r\\n<div class=\\\"csui-pman-popover-left csui-pman-popover-holder\\\"></div>\\r\\n<button class=\\\"binf-btn wrapper-button\\\" aria-label=\\\"\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"widgetName\") || (depth0 != null ? lookupProperty(depth0,\"widgetName\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"widgetName\",\"hash\":{},\"loc\":{\"start\":{\"line\":3,\"column\":52},\"end\":{\"line\":3,\"column\":66}}}) : helper)))\n    + \"\\\"></button>\\r\\n<div class=\\\"csui-pman-widget-masking\\\">\\r\\n\"\n    + ((stack1 = lookupProperty(helpers,\"if\").call(depth0 != null ? depth0 : (container.nullContext || {}),(depth0 != null ? lookupProperty(depth0,\"isEditMode\") : depth0),{\"name\":\"if\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.program(3, data, 0),\"loc\":{\"start\":{\"line\":5,\"column\":2},\"end\":{\"line\":31,\"column\":9}}})) != null ? stack1 : \"\")\n    + \"</div>\\r\\n\\r\\n\";\n}});\nHandlebars.registerPartial('csui_perspective.manage_behaviours_impl_widget.masking', t);\nreturn t;\n});\n/* END_TEMPLATE */\n;\n","\ncsui.define('css!csui/perspective.manage/behaviours/impl/widget.masking',[],function(){});\n","/**\r\n * Responsibilities:\r\n *  - Masking the unit level widget of perpsective. In case of grid.view, it will be cell\r\n *  - Listen and handle DnD of widgets and act accordingly - replace widgets\r\n *  - Fire \"replace:widget\" on dropping of any widget\r\n *  - Deleting a widget from perspective\r\n *  - Configuration of widget using callouts\r\n *\r\n * Usage:\r\n *  - Should be applied to widgets of perspective to be able to configure them\r\n *\r\n * Required Inputs:\r\n *  - perspectiveView\r\n *  - widgetView\r\n *\r\n * Events:\r\n *  - replace:widget\r\n *    - Fires on perspectiveView\r\n *    - When dropping any widget from tools on perpsective widget\r\n *  - delete:widget\r\n *    - Fires on perspectiveView\r\n *    - When deleting a perspective widget\r\n *  - update:widget:size\r\n *    - Firex Fires on perspectiveView\r\n *    - When change in size of widget\r\n *  - update:widget:config\r\n *    - Firex Fires on perspectiveView\r\n *    - When widget configuration options updated\r\n */\r\ncsui.define('csui/perspective.manage/behaviours/pman.widget.config.behaviour',['require', 'i18n', 'csui/lib/underscore', 'csui/lib/jquery',\r\n  'csui/lib/marionette', 'csui/utils/base', 'csui/lib/backbone', 'csui/utils/log',\r\n  'csui/models/widget/widget.model',\r\n  'csui/perspective.manage/impl/options.form.view',\r\n  'i18n!csui/perspective.manage/behaviours/impl/nls/lang',\r\n  'hbs!csui/perspective.manage/behaviours/impl/widget.masking',\r\n  'csui/utils/perspective/perspective.util',\r\n  'css!csui/perspective.manage/behaviours/impl/widget.masking',\r\n], function (require, i18n, _, $, Marionette, base, Backbone, log, WidgetModel,\r\n    WidgetOptionsFormView, lang, maskingTemplate, PerspectiveUtil) {\r\n  'use strict';\r\n\r\n  var DEFAULTS = {\r\n    removeConfirmMsg: lang.deleteConfirmMsg,\r\n    removeConfirmTitle: lang.deleteConfirmTitle,\r\n    configNeededMessage: lang.configNeeded,\r\n    confirmOnRemove: true,\r\n    allowReplace: true,\r\n    notifyUpdatesImmediatly: false,\r\n    perspectiveMode: 'edit'\r\n  };\r\n\r\n  /**\r\n   * View to mask the perspective widget and handles the widget configuration\r\n   */\r\n  var WidgetMaskingView = Marionette.ItemView.extend({\r\n    template: maskingTemplate,\r\n    className: function () {\r\n      var classNames = [WidgetMaskingView.className, 'csui-widget-focusable'];\r\n      classNames.push('csui-pman-widget-mode-' + this.options.perspectiveMode);\r\n      classNames.push(this._getStateClass());\r\n      return _.unique(classNames).join(' ');\r\n    },\r\n\r\n    _getStateClass: function () {\r\n      var isHidden = PerspectiveUtil.isHiddenWidget(this.options.widgetConfig),\r\n          widgetState = isHidden ? 'hidden' : 'shown';\r\n      return 'csui-pman-widget-state-' + widgetState;\r\n    },\r\n\r\n    templateHelpers: function () {\r\n      var hideShowToggle = PerspectiveUtil.isHiddenWidget(this.options.widgetConfig) ?\r\n                           lang.showWidget : lang.hideWidget;\r\n      return {\r\n        removeWidget: this.options.removeConfirmTitle,\r\n        editWidget: lang.editWidget,\r\n        widgetTitle: this.manifest && this.manifest.title,\r\n        configNeeded: this.options.configNeededMessage,\r\n        isEditMode: this.isEditPage(),\r\n        isWidgetHidden: PerspectiveUtil.isHiddenWidget(this.options.widgetConfig),\r\n        hideShowToggle: hideShowToggle,\r\n        widgetName: this._getWidgetName(),\r\n        hideWidgetAriaLabel: _.str.sformat(lang.hideWidgetAriaLabel, this._getWidgetName()),\r\n        showWidgetriaLabel: _.str.sformat(lang.showWidgetriaLabel, this._getWidgetName())\r\n      }\r\n    },\r\n\r\n    ui: {\r\n      edit: '.csui-pman-widget-edit',\r\n      delete: '.csui-pman-widget-close',\r\n      masking: '.csui-pman-widget-masking',\r\n      widgetTitle: '.csui-pman-widget-error-heading',\r\n      wrapperButton: '.wrapper-button',\r\n      hideShowToggle: '.csui-pman-hide-show-toggle'\r\n    },\r\n\r\n    configureEvents: {\r\n      'click @ui.masking': '_showCallout',\r\n      'click @ui.delete': 'onDeleteClick'\r\n    },\r\n\r\n    personalizationEvents: {\r\n      'click @ui.hideShowToggle': '_onHideShowWidget'\r\n    },\r\n\r\n    events: function () {\r\n      var evts = {\r\n        'keydown': 'onKeyDown',\r\n        'click @ui.wrapperButton': '_onClicked'\r\n      };\r\n      switch (this.options.perspectiveMode) {\r\n      case 'edit':\r\n        evts = _.extend(evts, this.configureEvents);\r\n        if (!!this.options.allowReplace) {\r\n          evts = _.extend(evts, {\r\n            'drop': 'onDrop',\r\n            'dragover': 'onDragOver',\r\n            'dragenter': 'onDragEnter',\r\n            'dragleave': 'onDragLeave'\r\n          });\r\n        }\r\n        break;\r\n      case 'personalize':\r\n        evts = _.extend(evts, this.personalizationEvents);\r\n        if (this.options.personalizable) {\r\n          evts = _.extend(evts, this.configureEvents);\r\n        }\r\n        break;\r\n      }\r\n      return evts;\r\n    },\r\n\r\n    constructor: function WidgetMaskingView(options) {\r\n      options = _.defaults(options, DEFAULTS);\r\n      Marionette.ItemView.apply(this, arguments);\r\n      this.dropCounter = 0;\r\n      this.manifest = options.manifest;\r\n      this.perspectiveView = options.perspectiveView;\r\n      this.widgetView = options.widgetView;\r\n      this.widgetConfig = options.widgetConfig;\r\n      this.perspectiveMode = options.perspectiveMode;\r\n      this.listenTo(this.widgetView, 'refresh:mask', this._doRefreshMask);\r\n      this.listenTo(this.widgetView, 'reposition:flyout', function () {\r\n        if (!!this.$popoverEl && this.$popoverEl.data('binf.popover')) {\r\n          this._previousFocusElm = document.activeElement;\r\n          this.$popoverEl.binf_popover('show');\r\n          // restore focus on previous focusing element\r\n          this.options.notifyUpdatesImmediatly && this._previousFocusElm &&\r\n          $(this._previousFocusElm).trigger('focus');\r\n        }\r\n      });\r\n    },\r\n\r\n    _onClicked: function (event) {\r\n      var $target = $(event.target);\r\n      if ($target.is(this.$el.find('.wrapper-button'))) {\r\n        this._enterConfiguration(event);\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n\r\n    handlePopoverClick:  function (event) {\r\n       var self = event.data.view;\r\n       self.writeFieldClicked = true;\r\n    },\r\n\r\n    onKeyDown: function (event) {\r\n      var continueEvent = true,\r\n          $target = $(event.target),\r\n          isFormEvent = this.optionsFormView && this.optionsFormView.$el.has($target).length,\r\n          cancelBtn = $('.perspective-editing .pman-header .cancel-edit'),\r\n          perspective = $('.perspective-editing .cs-perspective-panel .cs-perspective'),\r\n          isMac = base.isMacintosh(),\r\n          superKey = isMac && event.metaKey && !event.ctrlKey || !isMac && !event.metaKey && event.ctrlKey;\r\n      if (superKey && ($target.is('input:text') || $target.is('textarea'))) {\r\n        event.stopPropagation();\r\n      }\r\n      //TODO: need to find a check to avoid clearFocuable everytime\r\n      //this logic only happens in edit mode specific to KN, so perfomance wise low impact\r\n      !this.widgetView.$el.find('.binf-popover').length &&\r\n      base.clearFocusables(perspective.find('.tile, .csui-nodestable'));\r\n      switch (event.keyCode) {\r\n      case 13: // ENTER\r\n      case 32: // SPACE\r\n        if ($target.is(this.ui.hideShowToggle)) {\r\n          continueEvent = this._onHideShowWidget();\r\n        } else {\r\n          continueEvent = this._onClicked(event);\r\n        }\r\n        break;\r\n      case 27: // ESCAPE\r\n        if (isFormEvent) {\r\n          this._hideCallout();\r\n          if (!this.options.useEnterToConfigure) {\r\n            this.ui.edit && this.ui.edit.trigger('focus');\r\n            continueEvent = false;\r\n          }\r\n        } else if (!this.options.useEnterToConfigure &&\r\n                   !$target.is(this.$el.find('.wrapper-button'))) {\r\n          this._exitConfiguration();\r\n          continueEvent = false;\r\n        }\r\n        break;\r\n      case 9: // TAB\r\n        if (!isFormEvent && this.perspectiveMode === PerspectiveUtil.MODE_EDIT_PERSPECTIVE) {\r\n          var $target = $(event.target);\r\n          if (!$target.is(this.$el.find('.wrapper-button'))) {\r\n            this.ui.delete.is(\":focus\") ? this.ui.edit.trigger('focus') :\r\n            this.ui.delete.trigger('focus');\r\n            continueEvent = false;\r\n          }\r\n        } else if (event.shiftKey && $target.is($('.wrapper-button').first())) {\r\n          cancelBtn.trigger('focus');\r\n          continueEvent = false;\r\n        }\r\n        if (event.shiftKey && $target.is($('.wrapper-button'))) {\r\n          var index = $(document.activeElement).closest(\r\n              '.csui-draggable-item.csui-pman-editable-widget').index(),\r\n              widgetEle = $('.csui-dnd-container>.csui-pman-editable-widget'),\r\n              prevWidgetEleTop = widgetEle.eq(index - 1).offset().top,\r\n              isWidgetInSameRow = widgetEle.eq(index).offset().top === prevWidgetEleTop;\r\n          if (!isWidgetInSameRow) {\r\n            var scrollPosition = index < 0 ? 0 : prevWidgetEleTop - $('.pman-header').height();\r\n            // $('html, body') is because of web browser inconsistency.  The browsers Firefox & IE utilize\r\n            // the html portion , Safari and Chrome respond to the body\r\n            $(\"html, body\").animate({\r\n              scrollTop: scrollPosition\r\n            }, 0);\r\n          }\r\n        }\r\n        break;\r\n      default:\r\n        if ($target.is('.csui-pman-perspective-btn') || $target.is('.csui-pman-personalize-btn')) {\r\n          // Cancel all events on buttons - SHOW/HIDE/DELETE/EDIT\r\n          continueEvent = false;\r\n        }\r\n      }\r\n      return continueEvent;\r\n    },\r\n\r\n    _enterConfiguration: function (event) {\r\n      this.$el.addClass('csui-pman-widget-active');\r\n      if (this.options.useEnterToConfigure) {\r\n        // For empty placeholder, pressing ENTER when the focus on it, the flyout should open directly\r\n        this._showCallout(event);\r\n      } else {\r\n        this.$el.find('button:not(.wrapper-button):visible') &&\r\n        this.$el.find('button:not(.wrapper-button):visible').first().trigger('focus');\r\n      }\r\n    },\r\n\r\n    _exitConfiguration: function () {\r\n      this.$el.removeClass('csui-pman-widget-active');\r\n      this.ui.wrapperButton.trigger('focus');\r\n      this._hideCallout();\r\n    },\r\n\r\n    _getWidgetName: function () {\r\n      return this.manifest && this.manifest.title ? this.manifest.title :\r\n             this.options && this.options.widgetConfig &&\r\n             this.options.widgetConfig.type.split(\"/\").pop();\r\n    },\r\n\r\n    _clearViewTabIndexes: function () {\r\n      this.widgetView.$el.off();\r\n      var that = this;\r\n      function clearTabIndex() {\r\n        var isHidden = PerspectiveUtil.isHiddenWidget(that.options.widgetConfig);\r\n        !that.widgetView.$el.find('.binf-popover').length &&\r\n        base.clearFocusables(that.widgetView.$el);\r\n        var focusableEle = that.$el.find('.wrapper-button'),\r\n            widgetFocusAriaLabel = that._getWidgetName(),\r\n            notifyUpdatesImmediatly = that.options.notifyUpdatesImmediatly;\r\n        if (that.options.ItemsInGroupAriaLabel) {\r\n          widgetFocusAriaLabel = \" \" + that.options.ItemsInGroupAriaLabel;\r\n          focusableEle = focusableEle\r\n              .closest(\".csui-draggable-item\").children('.csui-pman-widget-mode-personalize')\r\n              .find(\".wrapper-button\");\r\n        }\r\n        if (that.options.perspectiveMode === \"edit\" && !notifyUpdatesImmediatly) {\r\n          widgetFocusAriaLabel = _.str.sformat(lang.editModewidgetFocusLabel, widgetFocusAriaLabel);\r\n        } else {\r\n          isHidden && focusableEle.attr('data-hidden', isHidden);\r\n          var action = focusableEle.attr('data-hidden') ? lang.showWidget : lang.hideWidget,\r\n              label = notifyUpdatesImmediatly ? lang.personalizeShortcutwidgetFocusLabel :\r\n                      lang.personalizeModewidgetFocusLabel;\r\n          widgetFocusAriaLabel = _.str.sformat(label, widgetFocusAriaLabel, action);\r\n        }\r\n        focusableEle\r\n            .attr(\"tabindex\", 0)\r\n            .attr(\"aria-label\", widgetFocusAriaLabel);\r\n      }\r\n\r\n      this.listenTo(this.widgetView, \"dom:refresh\", clearTabIndex);\r\n      clearTabIndex();\r\n    },\r\n\r\n    _isConfigurable: function () {\r\n      return !!this.widgetConfig && !_.isEmpty(this.widgetConfig) &&\r\n             this.widgetConfig.type !== WidgetMaskingView.placeholderWidget &&\r\n             this.widgetConfig.type !== 'csui/widgets/error';\r\n    },\r\n\r\n    isEditPage: function () {\r\n      return this.perspectiveMode === PerspectiveUtil.MODE_EDIT_PERSPECTIVE;\r\n    },\r\n\r\n    onRender: function () {\r\n      if (!this._isConfigurable()) {\r\n        this._clearViewTabIndexes();\r\n        // Widget configuration not found. Hence cannot show callout\r\n        return;\r\n      }\r\n      var self = this;\r\n      this._loadManifest().done(function (manifest) {\r\n        var configurableWidgetClass = manifest.hasConfigForm ? 'csui-widget-perspective-config' :\r\n                                      'csui-widget-perspective-info';\r\n        self.$el.addClass(configurableWidgetClass);\r\n\r\n        if (self.options.perspectiveMode === \"edit\") {\r\n          if (self.$el.parent().find(\".cs-no-expanding\").length) {\r\n            self.ui.edit\r\n                .attr(\r\n                    \"aria-label\",\r\n                    _.str.sformat(lang.objects, manifest.title)\r\n                ).attr('title', _.str.sformat(lang.info, manifest.title));\r\n          } else {\r\n            self.ui.edit.attr(\r\n                \"aria-label\",\r\n                _.str.sformat(lang.widgetSettings, manifest.title)\r\n            );\r\n          }\r\n          self.ui.delete.attr(\r\n              \"aria-label\",\r\n              _.str.sformat(lang.delete, manifest.title)\r\n          );\r\n        }\r\n        self.ui.widgetTitle.text(manifest.title);\r\n        if (self.manifest.selfConfigurable) {\r\n          self._adoptToSelfConfigurableWidget();\r\n        } else if (self.isEditPage() || self.options.personalizable) {\r\n          self._clearViewTabIndexes();\r\n          self._createOptionsForm(function () {\r\n            if (this.isDestroyed) {\r\n              // Masking destroyed even before form render. No action required.\r\n              return;\r\n            }\r\n            var openCallout = !!self.widgetConfig.options &&\r\n                              (self.widgetConfig.options.___pman_isdropped ||\r\n                               self.widgetConfig.options.___pman_opencallout);\r\n            var isWidgetReplaced = self._updateWidgetOptions(false, true);\r\n            // Refresh form to remove validation error messages created by default validation (above statement)\r\n            self.optionsFormView.refresh(function () {\r\n              self.$el.addClass('cs-pman-callout-ready');\r\n              self.$el.addClass('cs-pman-config-ready');\r\n              if (openCallout && !isWidgetReplaced) {\r\n                self._showOptionsCallout(manifest, true);\r\n              }\r\n            });\r\n          });\r\n        } else {\r\n          self.$el.addClass('cs-pman-config-ready');\r\n          self._clearViewTabIndexes();\r\n        }\r\n      });\r\n    },\r\n\r\n    onDestroy: function () {\r\n      this.optionsFormView && this.optionsFormView.destroy();\r\n    },\r\n\r\n    _adoptToSelfConfigurableWidget: function () {\r\n      if (!PerspectiveUtil.isEmptyPlaceholder(this.widgetConfig, this.perspectiveMode)\r\n          && this.perspectiveMode === PerspectiveUtil.MODE_PERSONALIZE &&\r\n          !PerspectiveUtil.isPersonalWidget(this.widgetConfig)) {\r\n        // Though this widget self configurable, only personal widget can be configured in \"Personalize Page\".\r\n        this._clearViewTabIndexes();\r\n        return;\r\n      }\r\n      this.$el.addClass('csui-has-editing-capability');\r\n      delete this.widgetConfig.options.___pman_isdropped;\r\n      this.listenTo(this.widgetView, 'update:widget:options', function (options) {\r\n        delete this.widgetConfig.options.___pman_isdropped;\r\n        this._notifyConfigChanges(options, options.isValid, false);\r\n      });\r\n      this.listenTo(this.widgetView, 'remove:widget', this._doDeleteWidget);\r\n      this.listenTo(this.widgetView, 'replace:widget', this.onDrop);\r\n    },\r\n\r\n    // Instead of re-rendering the whole mask, which would close flyout, just update DOM manually with titles, text changes etc.,\r\n    _doRefreshMask: function (options) {\r\n      this.options = _.extend({}, this.options, DEFAULTS, options);\r\n      this.ui.delete.attr(\"title\", this.options.removeConfirmTitle);\r\n    },\r\n\r\n    _showCallout: function (event) {\r\n      if (this.isDestroyed) {\r\n        return;\r\n      }\r\n      if (!this._isConfigurable()) {\r\n        // Widget configuration not found. Hence cannot show callout\r\n        return;\r\n      }\r\n      // To prevent default click action and open fly out\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      if (!!this.ui.delete.is(event.target)) {\r\n        // avoid showing popover on click of remove widget icon\r\n        return;\r\n      }\r\n      // open widget configuration callout\r\n      this._loadManifest().done(function (manifest) {\r\n        this._showOptionsCallout(manifest);\r\n      }.bind(this));\r\n      $('.perspective-editing .cs-perspective-panel .cs-field-write').off('click.' + this.cid).on(\r\n        'mousedown.' + this.cid, {\r\n          view: this\r\n        },\r\n        this.handlePopoverClick);\r\n    },\r\n\r\n    _showOptionsCallout: function (manifest, forceShow) {\r\n      if (this.isDestroyed) {\r\n        return;\r\n      }\r\n      //To resolve LPAD-73913 defect.\r\n      if (base.isIE11() && !!document.activeElement) {\r\n        document.activeElement.blur();\r\n      }\r\n      if (!!this.$popoverEl && this.$popoverEl.data('binf.popover')) {\r\n        // Currently showing popover. Close it.\r\n        this.$popoverEl.binf_popover('destroy');\r\n        return;\r\n      }\r\n      if (this.$el.closest(\".cs-perspective\").find(\".binf-popover\").length) {\r\n        this._closePopover();\r\n        if (!forceShow) {\r\n          // Callee asked to show flyout, hence, continue showing it. Dont return.\r\n          return;\r\n        }\r\n      }\r\n      this._calculatePopoverPlacement();\r\n\r\n      if (!!this.optionsFormView) {\r\n        // Toggle. Open popover with existing form.view\r\n        this._showPopover();\r\n      } else {\r\n        this._createOptionsForm();\r\n      }\r\n    },\r\n\r\n    _closePopover: function () {\r\n      this.$el.closest(\".cs-perspective\").find('.' + WidgetMaskingView.className +\r\n                                               ' .csui-pman-popover-holder').binf_popover(\r\n          'destroy');\r\n    },\r\n\r\n    _createOptionsForm: function (afterRenderCallback) {\r\n      this.optionsFormView = new WidgetOptionsFormView(_.defaults({\r\n        context: this.perspectiveView.options.context,\r\n        manifest: this.manifest\r\n      }, this.options));\r\n      if (!!afterRenderCallback) {\r\n        this.optionsFormView.listenToOnce(this.optionsFormView, 'render:form', afterRenderCallback);\r\n      }\r\n      this.optionsFormView.render();\r\n      this.optionsFormView.listenTo(this.optionsFormView, 'change:field',\r\n          this._onChangeField.bind(this));\r\n    },\r\n\r\n    _calculatePopoverPlacement: function () {\r\n      var adjust = this._determineCalloutPlacement();\r\n      this.$popoverEl = this.$el.find('.csui-pman-popover-' + adjust.placement);\r\n      if (adjust.mirror) {\r\n        adjust.placement = adjust.placement == 'right' ? 'left' : 'right';\r\n      }\r\n      this.placement = adjust.placement;\r\n      this.$popoverContainer = $(\r\n          '<div class=\"binf-popover pman-widget-popover pman-ms-popover\" role=\"tooltip\" tabindex=0><div class=\"binf-arrow\"></div><h3 class=\"binf-popover-title\"></h3><div class=\"binf-popover-content\"></div></div>');\r\n      this.$popoverContainer.css(\"max-width\", adjust.availableSpace + \"px\");\r\n    },\r\n\r\n    /**\r\n     * Determite callout position and show widget configuration callout\r\n     */\r\n    _showPopover: function () {\r\n      var popoverOptions = {\r\n        html: true,\r\n        content: this.optionsFormView.el,\r\n        trigger: 'manual',\r\n        viewport: { // Limit popover placement to perspective panel only\r\n          selector: this.options.perspectiveView && this.options.perspectiveView.$el.parent()[0], //this.options.perspectiveSelector,\r\n          padding: 18\r\n        },\r\n        placement: this.placement,\r\n        template: this.$popoverContainer,\r\n        animation: false\r\n      };\r\n      this.$popoverEl.binf_popover(popoverOptions);\r\n      this.$popoverEl.off('hidden.binf.popover')\r\n          .on('hidden.binf.popover', this._handleCalloutHide.bind(this));\r\n      this.$popoverEl.binf_popover('show');\r\n      //To change the border color to red for non supported widgets.\r\n      this.optionsFormView.onPopoverShow(this.$popoverContainer);\r\n      this.optionsFormView.$el.find('.cs-formview-wrapper').trigger('refresh:setcontainer');\r\n      this._registerPopoverEvents();\r\n      this.optionsFormView.trigger('ensure:scrollbar');\r\n      // TODO Use title of on formview as labelledBy instead of hidden popover title.\r\n      // Currently empty H tag failed html validation, hence fill it will title.\r\n      var popover = this.$popoverEl.next(\".binf-popover\"),\r\n          popoverLabelElemId = _.uniqueId('popoverLabelId'),\r\n          popoverHeader = popover.find('>.binf-popover-title');\r\n      if (popoverHeader) {\r\n        popoverHeader.attr('id', popoverLabelElemId);\r\n        popoverHeader.html(this.manifest.title);\r\n        popover.attr('aria-labelledby', popoverLabelElemId);\r\n      }\r\n      $('.perspective-editing .cs-perspective-panel .cs-field-write').on('keydown.' + this.cid).on(\r\n        'mousedown.' + this.cid, {\r\n          view: this\r\n        },\r\n        this.handlePopoverClick);\r\n    },\r\n\r\n    _hideCallout: function () {\r\n      this.$popoverEl && this.$popoverEl.binf_popover('destroy');\r\n      $('.perspective-editing .cs-perspective-panel .cs-field-write').off('keydown.' + this.cid).off(\r\n        'mousedown.' + this.cid);\r\n    },\r\n\r\n    _registerPopoverEvents: function () {\r\n      $('.perspective-editing .cs-perspective-panel').off('click.' + this.cid).on(\r\n          'click.' + this.cid, {\r\n            view: this\r\n          },\r\n          this._documentClickHandler);\r\n      $('.pman-container').off('click.' + this.cid).on('click.' + this.cid, {\r\n        view: this\r\n      }, this._documentClickHandler);\r\n      $(window).off('click.' + this.cid).on('resize.' + this.cid, {\r\n        view: this\r\n      }, this._windowResizeHandler);\r\n    },\r\n\r\n    _windowResizeHandler: function (event) {\r\n      var self = event.data.view;\r\n      // closing opened popover on window resize\r\n      self._hideCallout();\r\n    },\r\n\r\n    _unregisterPopoverEvents: function () {\r\n      $('.perspective-editing .cs-perspective-panel').off('click.' + this.cid,\r\n          this._documentClickHandler);\r\n      $('.pman-container').off('click.' + this.cid, this._documentClickHandler);\r\n      $(window).off('resize.' + this.cid, this._windowResizeHandler);\r\n    },\r\n\r\n    /**\r\n     * Handle callout data update to widget on hidding of popover\r\n     */\r\n    _handleCalloutHide: function () {\r\n      this._validateWidgetConfig();\r\n      this._unregisterPopoverEvents();\r\n      delete this.widgetConfig.options.___pman_opencallout;\r\n      this._updateWidgetOptions(true);\r\n      this._enableorDisableSaveButton();\r\n    },\r\n\r\n    _validateWidgetConfig: function () {\r\n      var options = this.optionsFormView.getValues(),\r\n          isValid = this.optionsFormView.validate();\r\n      if (_.isFunction(this.widgetView.validateConfiguration)) {\r\n        isValid = isValid && this.widgetView.validateConfiguration(options);\r\n      }\r\n      var action = !isValid ? 'addClass' : 'removeClass';\r\n      this.$el[action]('binf-perspective-has-error');\r\n    },\r\n\r\n    _enableorDisableSaveButton: function () {\r\n      var saveBtn = $('.perspective-editing .pman-header .icon-save'),\r\n          hasError = $('.perspective-editing').find(\".binf-perspective-has-error\").length > 0;\r\n      saveBtn.prop('disabled', hasError);\r\n    },\r\n\r\n    /**\r\n     * Triggered on changing of any widget's options on form.\r\n     * Recreates the widgets with latest options (only if valid) to make sure widget is showing live data.\r\n     *\r\n     * Parameters:\r\n     *  - reloadForLiveData: widget required to be re-created to get the changes reflected\r\n     *  - softUpdate: Trigger change even without reloading the widget\r\n     *\r\n     */\r\n    _updateWidgetOptions: function (reloadForLiveData, softUpdate) {\r\n      var isValid = this.optionsFormView.validate(),\r\n          options = this.optionsFormView.getValues();\r\n      softUpdate = _.isUndefined(softUpdate) ? !reloadForLiveData : softUpdate\r\n      var isWidgetReplaced = this._notifyConfigChanges(options, isValid, reloadForLiveData,\r\n          softUpdate);\r\n      this._enableorDisableSaveButton();\r\n      return isWidgetReplaced;\r\n    },\r\n\r\n    _notifyConfigChanges: function (options, isValid, reloadForLiveData, softUpdate) {\r\n      options = options || {};\r\n      var oldOptions = this.widgetConfig.options || {};\r\n      var isOptionsSame = _.isEqual(oldOptions, options);\r\n      this.perspectiveView.trigger(\"update:widget:options\", {\r\n        widgetView: this.widgetView,\r\n        isValid: isValid,\r\n        options: options,\r\n        softUpdate: softUpdate\r\n      });\r\n\r\n      if (isOptionsSame) {\r\n        // Avoid widget recreation when options not changed.\r\n        return;\r\n      }\r\n\r\n      if (!!isValid) {\r\n        // Check if widget should be recreated on options change (for live data). \r\n        if (!this.manifest.callback && (reloadForLiveData || oldOptions.___pman_isdropped)) {\r\n          // Recreate with widget (for live data) for the first time after drop to provde widget the options with default values (from manifest)\r\n          // OR Recreate widget with updated options.\r\n          var widgetType = this.widgetConfig.type;\r\n          if (this._isPreviewWidget()) {\r\n            // Has valid options to initialize origianl widgets now\r\n            var originalWidget = this.widgetConfig.options.widget;\r\n            widgetType = originalWidget.id;\r\n          }\r\n          if (!!oldOptions.___pman_isdropped) {\r\n            options = _.extend({___pman_opencallout: oldOptions.___pman_isdropped}, options);\r\n          }\r\n          var widgetToReplace = {\r\n            type: widgetType,\r\n            kind: this.widgetConfig.kind,\r\n            options: options,\r\n            cid: _.uniqueId('pman')\r\n          };\r\n          this.perspectiveView.trigger('replace:widget', this.widgetView, widgetToReplace);\r\n          return true;\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Listen document click to close callouts\r\n     */\r\n    _documentClickHandler: function (event) {\r\n      var self = event.data.view;\r\n      if (!!$(event.target).closest('.binf-popover').length || self.writeFieldClicked) {\r\n        // Click on popover\r\n        self.writeFieldClicked = false;\r\n        return;\r\n      }\r\n      if (!Marionette.isNodeAttached(event.target)) {\r\n        // after click on element in popover, the element not exist in dom\r\n        self.widgetView.trigger('reposition:flyout');\r\n        return;\r\n      }\r\n      if (self.$el.is(event.target) ||\r\n          (!!self.$el.has(event.target).length && !self.ui.delete.is(event.target)) ||\r\n          self.widgetView.$el.is(event.target) || self.widgetView.$el.has(event.target).length) {\r\n        // Click on current widget\r\n        return;\r\n      }\r\n      self._unregisterPopoverEvents();\r\n      self._hideCallout();\r\n    },\r\n\r\n    _onChangeField: function (field) {\r\n      if (field.name === WidgetOptionsFormView.widgetSizeProperty) {\r\n        // Notify perspective panel about size change to do respective DOM / style updates\r\n        this.perspectiveView.trigger(\"update:widget:size\", this.options.widgetView, field.value);\r\n        // Close popover for now.\r\n        this.$popoverEl.binf_popover('destroy');\r\n        // TODO Re-position popover as widget size may change\r\n        // this._calculatePopoverPlacement();\r\n        // this._showPopover();\r\n      } else if (this.options.notifyUpdatesImmediatly) {\r\n        this._updateWidgetOptions(false, false);\r\n        this.widgetView.trigger('reposition:flyout');\r\n      }\r\n    },\r\n\r\n    _evalRequiredFormWidth: function () {\r\n      // var formContainer = $(\"<div class='pman-widget-popover'/>\");\r\n      // formContainer.appendTo(document.body);\r\n\r\n      this.optionsFormView.$el.addClass('pman-prerender-form');\r\n      this.optionsFormView.$el.addClass('pman-widget-popover');\r\n      this.optionsFormView.$el.appendTo(document.body);\r\n      this.optionsFormView.$el.find('.cs-formview-wrapper').trigger('refresh:setcontainer');\r\n      var formWidth = this.optionsFormView.$el.width();\r\n      if (this.optionsFormView.$el.find('.csui-scrollablecols').length > 0) {\r\n        formWidth += this.optionsFormView.$el.find('.csui-scrollablecols')[0].scrollWidth -\r\n                     this.optionsFormView.$el.find('.csui-scrollablecols')[0].offsetWidth;\r\n      }\r\n      this.optionsFormView.$el.removeClass('pman-widget-popover');\r\n      return formWidth;\r\n    },\r\n\r\n    _calculateSpaceAroundWidget: function () {\r\n      var elWidth = this.$el.width(),\r\n          elWidth = (elWidth / 2),\r\n          documentWidth = $(document).width(),\r\n          leftOffset = this.$el.find('.csui-pman-popover-left').offset().left,\r\n          rightOffset = documentWidth - this.$el.find('.csui-pman-popover-right').offset().left;\r\n\r\n      var aroundSpaces = {\r\n        right: {\r\n          placement: 'right',\r\n          mirror: false,\r\n          availableSpace: rightOffset\r\n        },\r\n        rightFlip: {\r\n          placement: 'right',\r\n          mirror: true,\r\n          availableSpace: (documentWidth - rightOffset)\r\n        },\r\n        left: {\r\n          placement: 'left',\r\n          mirror: false,\r\n          availableSpace: leftOffset\r\n        },\r\n        leftFlip: {\r\n          placement: 'left',\r\n          mirror: true,\r\n          availableSpace: (documentWidth - leftOffset)\r\n        }\r\n      };\r\n      return aroundSpaces;\r\n    },\r\n\r\n    _determineCalloutPlacement: function () {\r\n      var isRtl = i18n && i18n.settings.rtl,\r\n          formWidth = this._evalRequiredFormWidth() + 20, // For additional spacing around Form\r\n          allSpaces = this._calculateSpaceAroundWidget(),\r\n          i, perfectSpace, highSpace;\r\n\r\n      var spacings = !isRtl ?\r\n          [allSpaces.right, allSpaces.left, allSpaces.leftFlip, allSpaces.rightFlip] :\r\n          [allSpaces.rightFlip, allSpaces.leftFlip, allSpaces.left, allSpaces.right];\r\n\r\n      for (i = 0; i < spacings.length; i++) {\r\n        var current = spacings[i];\r\n        if (formWidth < current.availableSpace) {\r\n          perfectSpace = current;\r\n          break;\r\n        }\r\n        if (!highSpace || current.availableSpace > highSpace.availableSpace) {\r\n          highSpace = current;\r\n        }\r\n      }\r\n      if (!perfectSpace) {\r\n        // Widget is not perfect fit in any edge. So take high availability\r\n        perfectSpace = highSpace;\r\n      }\r\n      perfectSpace.availableSpace -= 20; // For additional spacing around popover.\r\n\r\n      return perfectSpace;\r\n    },\r\n\r\n    _isPreviewWidget: function () {\r\n      return this.widgetConfig.type === WidgetMaskingView.perspectiveWidget;\r\n    },\r\n\r\n    _addMoreManifestInfo: function () {\r\n      var hasConfigForm = true;\r\n      if (!this.manifest || !this.manifest.schema || !this.manifest.schema.properties ||\r\n          _.isEmpty(this.manifest.schema.properties)) {\r\n        // No configuration is available for this widget\r\n        hasConfigForm = false;\r\n      }\r\n      this.manifest.hasConfigForm = hasConfigForm;\r\n      return;\r\n    },\r\n\r\n    _loadManifest: function () {\r\n      if (this.manifest !== undefined) {\r\n        this._addMoreManifestInfo();\r\n        return $.Deferred().resolve(this.manifest);\r\n      }\r\n      if (this._isPreviewWidget()) {\r\n        // For widgets added using DnD, get manifest from perspective widget's options \r\n        // since Perspective widget will be added as preview for original widget\r\n        this.manifest = this.widgetConfig.options.widget.get('manifest');\r\n        return this._loadManifest();\r\n      }\r\n      var deferred    = $.Deferred(),\r\n          widgetModel = new WidgetModel({\r\n            id: this.widgetConfig.type\r\n          });\r\n      widgetModel.fetch().then(_.bind(function () {\r\n        this.manifest = widgetModel.get('manifest');\r\n        this._addMoreManifestInfo();\r\n        deferred.resolve(this.manifest);\r\n      }, this), function (error) {\r\n        deferred.reject(error);\r\n      });\r\n      return deferred.promise();\r\n    },\r\n\r\n    onDeleteClick: function (event) {\r\n      this._closePopover();\r\n      event.preventDefault();\r\n      if (!this.options.confirmOnRemove) {\r\n        this._doDeleteWidget();\r\n      } else {\r\n        var self = this;\r\n        var index = this.$el.parents('.csui-draggable-item.csui-pman-editable-widget').index();\r\n        require(['csui/dialogs/modal.alert/modal.alert'], function (alertDialog) {\r\n          alertDialog.confirmQuestion(self.options.removeConfirmMsg,\r\n              self.options.removeConfirmTitle,\r\n              {\r\n                buttons: {\r\n                  showYes: true,\r\n                  labelYes: lang.remove,\r\n                  showNo: true,\r\n                  labelNo: lang.cancel\r\n                }\r\n              })\r\n              .always(function (result) {\r\n                if (result) {\r\n                  self._doDeleteWidget();\r\n                  self._doSpecificWidgetFocusble(index);\r\n                } else {\r\n                  self.ui.delete.trigger('focus');\r\n                }\r\n              });\r\n        });\r\n      }\r\n    },\r\n\r\n    // accepts the index of widget and make that widget focusable\r\n    _doSpecificWidgetFocusble: function (index) {\r\n      var widgetEle = $('.csui-dnd-container>.csui-pman-editable-widget').eq(index).children(\r\n          '.csui-widget-focusable').find('.wrapper-button');\r\n      widgetEle.trigger('focus');\r\n    },\r\n\r\n    _doDeleteWidget: function () {\r\n      this.perspectiveView.trigger(\"delete:widget\", this.widgetView);\r\n\r\n      this.perspectiveView.options.context.trigger('update:widget:panel', {\r\n        'action': 'delete',\r\n        'widgetModel': this.widgetView.model.get('widget')\r\n      });\r\n\r\n      this._enableorDisableSaveButton();\r\n    },\r\n\r\n    _doReplaceWidget: function (widgetToReplace, existingWidget) {\r\n      var manifest = (widgetToReplace.get('manifest') || {}),\r\n          newWidget = { // Widget is able to intialize with default (empty) options.\r\n            type: widgetToReplace.id,\r\n            kind: manifest.kind\r\n          };\r\n      if (!PerspectiveUtil.isEligibleForLiveWidget(manifest)) {\r\n        // Widget has few required options / has callback. Hence create generic \"perspective widget preview\" widget\r\n        newWidget = {\r\n          type: WidgetMaskingView.perspectiveWidget,\r\n          kind: manifest.kind,\r\n          options: {\r\n            options: {}, // To be used and filled by callout form\r\n            widget: widgetToReplace\r\n          }\r\n        };\r\n      }\r\n      newWidget.options = _.extend({___pman_isdropped: true}, newWidget.options);\r\n      this.perspectiveView.trigger('replace:widget', this.widgetView, newWidget);\r\n\r\n      this.perspectiveView.options.context.trigger('update:widget:panel', {\r\n        'action': !!existingWidget ? 'replace' : 'add',\r\n        'widgetModel': newWidget,\r\n        'oldWidgetModel': existingWidget\r\n      });\r\n    },\r\n\r\n    onDragOver: function (event) {\r\n      event.preventDefault();\r\n    },\r\n\r\n    onDragEnter: function (event) {\r\n      event.preventDefault();\r\n      this.dropCounter++;\r\n      this.$el.siblings(\".csui-perspective-placeholder\").addClass('csui-widget-drop');\r\n    },\r\n\r\n    onDragLeave: function () {\r\n      this.dropCounter--;\r\n      if (this.dropCounter === 0) {\r\n        this.$el.siblings(\".csui-perspective-placeholder\").removeClass('csui-widget-drop');\r\n      }\r\n    },\r\n\r\n    _extractWidgetToDrop: function (event) {\r\n      var dragData = event.originalEvent.dataTransfer.getData(\"text\");\r\n      if (!dragData) {\r\n        return undefined;\r\n      }\r\n      try { // TODO get rid of try catch and handle like non-droppable object\r\n        var widgetToReplace = new WidgetModel(JSON.parse(dragData));\r\n        return widgetToReplace;\r\n      } catch (e) {\r\n        // Unsupported drop\r\n        return false;\r\n      }\r\n    },\r\n\r\n    onDrop: function (event) {\r\n      event.preventDefault();\r\n      this.onDragLeave();\r\n      var widgetToReplace = this._extractWidgetToDrop(event);\r\n      if (!widgetToReplace) {\r\n        return;\r\n      }\r\n      if (this.widgetConfig.type === WidgetMaskingView.placeholderWidget) {\r\n        this._doReplaceWidget(widgetToReplace);\r\n      } else {\r\n        var self = this;\r\n        require(['csui/dialogs/modal.alert/modal.alert'], function (alertDialog) {\r\n          alertDialog.confirmQuestion(lang.replaceConfirmMsg, lang.replaceConfirmTitle, {\r\n            buttons: {\r\n              showYes: true,\r\n              labelYes: lang.replace,\r\n              showNo: true,\r\n              labelNo: lang.cancel\r\n            }\r\n          })\r\n              .done(function (userConfirmed) {\r\n                if (userConfirmed) {\r\n                  self._doReplaceWidget(widgetToReplace, self.widgetConfig);\r\n                }\r\n              });\r\n        });\r\n      }\r\n    },\r\n\r\n    _updateStyles: function () {\r\n      var className = _.result(this, 'className');\r\n      this.$el.attr('class', className);\r\n    },\r\n\r\n    _updateConfigChanges: function (isVisible) {\r\n      this.$el.removeClass(this._getStateClass());\r\n      PerspectiveUtil.setWidgetHidden(this.widgetConfig, isVisible);\r\n      this._notifyConfigChanges(this.widgetConfig.options, true, false);\r\n      this.$el.addClass(this._getStateClass());\r\n    },\r\n\r\n    _onHideShowWidget: function () {\r\n      var hideShowBtnText;\r\n      if (PerspectiveUtil.isHiddenWidget(this.options.widgetConfig)) {\r\n        this.perspectiveView.trigger('before:show:widget', this.widgetView);\r\n        this._updateConfigChanges(false);\r\n        this.perspectiveView.trigger('show:widget', this.widgetView);\r\n        hideShowBtnText = lang.hideWidget;\r\n        this.ui.hideShowToggle.attr('aria-label',\r\n        _.str.sformat(lang.hideWidgetAriaLabel, this._getWidgetName()))\r\n        .attr('title',\r\n            hideShowBtnText).text(hideShowBtnText);\r\n      } else {\r\n        this.perspectiveView.trigger('before:hide:widget', this.widgetView);\r\n        this._updateConfigChanges(true);\r\n        this.perspectiveView.trigger('hide:widget', this.widgetView);\r\n        hideShowBtnText = lang.showWidget;\r\n        this.ui.hideShowToggle.attr('aria-label',\r\n        _.str.sformat(lang.showWidgetriaLabel, this._getWidgetName()))\r\n        .attr('title',\r\n            hideShowBtnText).text(hideShowBtnText);\r\n      }\r\n      this.$el.find('.wrapper-button').attr('aria-label',\r\n          _.str.sformat(lang.personalizeModewidgetFocusLabel, this._getWidgetName(),\r\n              hideShowBtnText));\r\n      return false;\r\n    }\r\n\r\n  }, {\r\n    className: 'csui-configure-perspective-widget',\r\n    perspectiveWidget: 'csui/perspective.manage/widgets/perspective.widget',\r\n    placeholderWidget: 'csui/perspective.manage/widgets/perspective.placeholder',\r\n    widgetSizeProperty: '__widgetSize'\r\n  });\r\n\r\n  var PerspectiveWidgetConfigurationBehaviour = Marionette.Behavior.extend({\r\n    defaults: {      \r\n      perspectiveSelector: '.perspective-editing .cs-perspective > div'\r\n    },\r\n\r\n    constructor: function PerspectiveWidgetConfigurationBehaviour(options, view) {\r\n      options || (options = {});\r\n      options.perspectiveView = options.perspectiveView || view;\r\n      this.perspectiveView = options.perspectiveView;\r\n      Marionette.Behavior.prototype.constructor.apply(this, arguments);\r\n      this.view = view;\r\n      _.extend(this.perspectiveView, {\r\n        getPManPlaceholderWidget: function () {\r\n          return {\r\n            type: WidgetMaskingView.placeholderWidget,\r\n            options: {}\r\n          };\r\n        }\r\n      })\r\n    },\r\n\r\n    _ensureWidgetElement: function () {\r\n      if (!_.isObject(this.$widgetEl)) {\r\n        // Consider element to add mask can be provided through options\r\n        this.$widgetEl = this.options.el ? $(this.options.el) : this.view.$el;\r\n      }\r\n      if (!this.$widgetEl || this.$widgetEl.length === 0) {\r\n        throw new Marionette.Error('An \"el\" ' + this.$widgetEl.selector + ' must exist in DOM');\r\n      }\r\n      return true;\r\n    },\r\n\r\n    _checkAndApplyMask: function () {\r\n      this._ensureWidgetElement();\r\n      if (this.$widgetEl.children('.' + WidgetMaskingView.className).length > 0) {\r\n        // Mask exist\r\n        return;\r\n      }\r\n\r\n      // Get data configured to widget\r\n      var widgetConfig = this._resolveWidgetConfiguration();\r\n      if (!widgetConfig) {\r\n        throw new Marionette.Error({\r\n          name: 'NoWidgetConfigurationError',\r\n          message: 'A \"widgetConfig\" must be specified'\r\n        });\r\n      }\r\n      if (this.maskingView && this.$widgetEl.has(this.maskingView.$el).length &&\r\n          _.isEqual(widgetConfig, this.options.widgetConfig)) {\r\n        // No change in configuration. No rerender of mask required.\r\n        return;\r\n      }\r\n      this.maskingView && this.maskingView.destroy();\r\n      this.maskingView = new WidgetMaskingView(\r\n          _.extend(this.options, {\r\n            widgetView: this.view,\r\n            widgetConfig: widgetConfig\r\n          }));\r\n      this.maskingView.render();\r\n      this.$widgetEl.append(this.maskingView.el);\r\n      this.$widgetEl.addClass('csui-pman-editable-widget')\r\n      // To be used perspective.view to show placeholder watermark\r\n      this.$widgetEl.data('pman.widget', {\r\n        attributes: {\r\n          manifest: widgetConfig\r\n        }\r\n      });\r\n      if (widgetConfig.type === WidgetMaskingView.placeholderWidget) {\r\n        // Prevent perspective placeholder to participate in sorting.\r\n        this.$widgetEl.removeClass('csui-draggable-item');\r\n      }\r\n    },\r\n\r\n    _resolveWidgetConfiguration: function () {\r\n      if (!!this.view.model && !!this.view.model.get('widget')) {\r\n        // Try model of widget view - Flow, LCR, Grid.. who even using grid control \r\n        return this.view.model.get('widget');\r\n      }\r\n      if (!!this.view.getPManWidgetConfig && _.isFunction(this.view.getPManWidgetConfig)) {\r\n        // Widget configuration can be provided though a function \r\n        return this.view.getPManWidgetConfig();\r\n      }\r\n      if (!!this.options.widgetConfig) {\r\n        // Can be provided through behaviour's options\r\n        return _.result(this.options, 'widgetConfig');\r\n      }\r\n    },\r\n\r\n    onRender: function () {\r\n      if (this.options.notifyUpdatesImmediatly && this.view.isUpdating) {\r\n        return;\r\n      }\r\n      this._checkAndApplyMask();\r\n      this.maskingView && this.maskingView._enableorDisableSaveButton();\r\n    },\r\n\r\n    onDestroy: function () {\r\n      this.maskingView && this.maskingView.destroy();\r\n      this.maskingView = undefined;\r\n    }\r\n\r\n  });\r\n\r\n  return PerspectiveWidgetConfigurationBehaviour;\r\n\r\n})\r\n;\n","csui.define('csui/perspective.manage/pman.view',['csui/lib/underscore', 'csui/lib/jquery', 'csui/lib/backbone', 'csui/lib/marionette',\r\n  'csui/utils/base',\r\n  'csui/utils/non-emptying.region/non-emptying.region',\r\n  'csui/perspective.manage/impl/pman.panel.view',\r\n  'csui/utils/perspective/perspective.util',\r\n  'csui/utils/contexts/factories/application.scope.factory',\r\n  'csui/utils/contexts/factories/node',\r\n  'csui/utils/contexts/factories/user',\r\n  'csui/models/perspective/personalization.model',\r\n  'csui/perspectives/mixins/draganddrop.kn.mixin',\r\n  'i18n!csui/perspective.manage/impl/nls/lang',\r\n  'hbs!csui/perspective.manage/impl/pman',\r\n  'i18n',\r\n  'css!csui/perspective.manage/impl/pman',\r\n  'csui/perspective.manage/behaviours/pman.widget.config.behaviour',\r\n  'csui/lib/jquery.ui/js/jquery-ui'\r\n], function (_, $, Backbone, Marionette, base, NonEmptyingRegion, PManPanelView, PerspectiveUtil,\r\n    ApplicationScopeModelFactory,\r\n    NodeModelFactory, UserModelFactory, PersonalizationModel, DragAndDropKNMixin, lang, template, i18n) {\r\n\r\n  var pmanContainer;\r\n\r\n  var PManView = Marionette.ItemView.extend({\r\n    className: function () {\r\n      var classNames = ['pman', 'pman-container'];\r\n      classNames.push('pman-mode-' + this.options.mode);\r\n      return _.unique(classNames).join(' ');\r\n    },\r\n\r\n    template: template,\r\n\r\n    templateHelpers: function () {\r\n      return {\r\n        addWidget: lang.addWidget,\r\n        save: lang.save,\r\n        saveAriaLabel: lang.saveAriaLabel,\r\n        cancel: lang.cancel,\r\n        cancelAriaLabel: lang.cancelAriaLabel,\r\n        reset: lang.reset,\r\n        resetAriaLabel: lang.resetAriaLabel,\r\n        personalizeMode: this.mode === PerspectiveUtil.MODE_PERSONALIZE &&\r\n                         (this.options.perspective.has('perspective_id') ||\r\n                          this.options.perspective.has('id'))\r\n      };\r\n    },\r\n\r\n    ui: {\r\n      \"pmanPanel\": \".pman-header .pman-pannel-wrapper\",\r\n      'cancelEdit': '.pman-header .cancel-edit',\r\n      'addIcon': '.pman-header .icon-toolbarAdd',\r\n      'saveBtn': '.pman-header .icon-save',\r\n      'trashArea': '.pman-header .pman-trash-area',\r\n      'resetBtn': '.pman-header .icon-reset'\r\n    },\r\n\r\n    events: {\r\n      'click @ui.cancelEdit': \"onClickClose\",\r\n      'click @ui.addIcon': \"togglePannel\",\r\n      'click @ui.saveBtn': \"onClickSave\",\r\n      'click @ui.resetBtn': \"onClickReset\",\r\n      'keydown': 'onKeyDown'\r\n    },\r\n\r\n    constructor: function PManView(options) {\r\n      options || (options = {});\r\n      _.defaults(options, {\r\n        applyMasking: this.applyMasking.bind(this),\r\n        container: document.body,\r\n        mode: PerspectiveUtil.MODE_EDIT_PERSPECTIVE\r\n      });\r\n      options.container = $(options.container);\r\n      this.context = options.context;\r\n      this.applicationScope = this.context.getModel(ApplicationScopeModelFactory);\r\n      this.mode = options.mode;\r\n      this._prepareForEdit(options.perspective);\r\n      Marionette.ItemView.prototype.constructor.call(this, options);\r\n      this._registerEventHandler();\r\n    },\r\n\r\n    _registerEventHandler: function () {\r\n      this.listenTo(this, 'change:layout', function (newLayoutType) {\r\n        this.perspective.setPerspective({\r\n          type: newLayoutType,\r\n          options: {perspectiveMode: this.mode}\r\n        }, {silent: true});\r\n        this._triggerEditMode();\r\n        this.togglePannel();\r\n      });\r\n      this.listenTo(this, 'swap:layout', function (newLayoutType) {\r\n        this.perspective.setPerspective({\r\n          type: newLayoutType,\r\n          options: this.perspective.attributes.perspective.options\r\n        }, {silent: true});\r\n        this.context.triggerMethod('swap:layout', this.perspective);\r\n      });\r\n      this.listenTo(this.context, 'save:perspective', this._savePerspective);\r\n      // listen to change perspective and exit from edit mode\r\n      this.listenTo(this.context, 'change:perspective', this._onChangePerspective);\r\n      this.listenTo(this.context, 'retain:perspective', this._doExitPerspective);\r\n      this.listenTo(this.context, 'finish:exit:edit:perspective', this._doCleanup);\r\n    },\r\n\r\n    _prepareForEdit: function (originalPerspective) {\r\n      if (!originalPerspective) {\r\n        throw new Error(\"Missing perspective\");\r\n      }\r\n      this.perspective = this._clonePrespective(originalPerspective);\r\n      if (this.perspective.isNew() && this.mode === PerspectiveUtil.MODE_EDIT_PERSPECTIVE) {\r\n        // No perspectives are configues to current node\r\n        this.perspective.setPerspective(this._getDefaultPerspectiveConfig());\r\n      }\r\n      // var perspectiveOptions = this.perspective.getPerspective().options || {};\r\n      // perspectiveOptions.perspectiveMode = this.mode;\r\n    },\r\n\r\n    _clonePrespective: function (original) {\r\n      var perspectiveConfig = original.getPerspective();\r\n      var config = JSON.parse(JSON.stringify(perspectiveConfig));\r\n      original.setPerspective(config);\r\n      return original;\r\n    },\r\n\r\n    show: function () {\r\n      var container = this.getContainer(),\r\n          region = new NonEmptyingRegion({\r\n            el: container\r\n          });\r\n      region.show(this);\r\n      return this;\r\n    },\r\n\r\n    getContainer: function () {\r\n      if (!pmanContainer || !$.contains(this.options.container, pmanContainer)) {\r\n        pmanContainer = $('<div>', {'class': 'binf-widgets'}).appendTo(this.options.container)[0]\r\n      }\r\n      return pmanContainer;\r\n    },\r\n\r\n    /**\r\n     * Default perspective when no perspectives configured for a container\r\n     */\r\n    _getDefaultPerspectiveConfig: function () {\r\n      // TODO check if LCR is relevant to all containers.\r\n      return {\r\n        \"type\": \"left-center-right\",\r\n        \"options\": {\r\n          \"center\": {\r\n            \"type\": \"csui/widgets/nodestable\"\r\n          }\r\n        }\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Updates / creates perspective\r\n     */\r\n    _savePerspective: function (perspectiveChanges) {\r\n      if (!!perspectiveChanges && !!perspectiveChanges.error) {\r\n        this.ui.saveBtn.prop('disabled', false);\r\n        return;\r\n      }\r\n      this.perspective.update(perspectiveChanges);\r\n      // Save perspective to server\r\n      this.perspective.save().then(_.bind(this._onSaveSuccess, this),\r\n          _.bind(this._onSaveError, this));\r\n    },\r\n\r\n    _onSaveSuccess: function () {\r\n      var self = this;\r\n      if (self.mode === PerspectiveUtil.MODE_EDIT_PERSPECTIVE) {\r\n        this._showMessage(\"success\", lang.perspectiveSaveSuccess);\r\n      } else {\r\n        this._showMessage(\"success\", lang.personalizationSaveSuccess);\r\n      }\r\n      // Update context's perspective and exit from inline editing\r\n      var contextPerspectiveMode = self.context.perspective.get('perspectiveMode') ||\r\n                                   PerspectiveUtil.MODE_EDIT_PERSPECTIVE,\r\n          sourceModel = self._getSourceModel();\r\n\r\n      var updatePerspective = self.perspective.getPerspective();\r\n      updatePerspective.id = self.perspective.getPerspectiveId();\r\n\r\n      // Keep the perspective / personalization at sourceModel (received from server) up to date.\r\n      if (self.mode === PerspectiveUtil.MODE_EDIT_PERSPECTIVE) {\r\n        // Update only personalization of sourceModel's perspective\r\n        var originalPerspective = sourceModel.get('perspective');\r\n        sourceModel.set('perspective', _.defaults(updatePerspective, originalPerspective));\r\n      } else {\r\n        // Update only personalization of sourceModel's perspective\r\n        var originalPerspective = sourceModel.get('perspective');\r\n        sourceModel.set('perspective',\r\n            _.defaults({personalizations: self.perspective.toJSON()}, originalPerspective));\r\n      }\r\n\r\n      if (contextPerspectiveMode === self.mode) {\r\n        self.context.perspective.set(updatePerspective);\r\n      } else if (self.mode === PerspectiveUtil.MODE_EDIT_PERSPECTIVE) {\r\n        // Original perspective changed. And the current user has personalization of current page.\r\n        // Merge latest perspective updates to personalization\r\n        var personalization = new PersonalizationModel({}, {perspective: updatePerspective});\r\n        personalization.setPerspective(self.context.perspective.toJSON());\r\n        updatePerspective = personalization.getPerspective();\r\n        self.context.perspective.set(updatePerspective);\r\n\r\n      } else if (self.mode === PerspectiveUtil.MODE_PERSONALIZE) {\r\n        // Update the personalizations to context. Since content is currently showing admin's perspective.\r\n        // Probablt this is the first time user personalizing the page.\r\n        var personalization = new PersonalizationModel({},\r\n            {perspective: sourceModel.get('perspective')});\r\n        personalization.setPerspective(updatePerspective);\r\n        updatePerspective = personalization.getPerspective();\r\n        self.context.perspective.set(updatePerspective);\r\n      }\r\n      self._doExitPerspective();\r\n    },\r\n\r\n    _onSaveError: function (error) {\r\n      this.ui.saveBtn.prop('disabled', false);\r\n      // API error while saving..\r\n      var errorMessage;\r\n      if (error && error.responseJSON && error.responseJSON.error) {\r\n        errorMessage = error.responseJSON.error;\r\n      } else {\r\n        var errorHtml = base.MessageHelper.toHtml();\r\n        base.MessageHelper.reset();\r\n        errorMessage = $(errorHtml).text();\r\n      }\r\n      this._showMessage(\"error\", errorMessage);\r\n    },\r\n\r\n    _showMessage: function (type, message) {\r\n      require([\r\n        'csui/controls/globalmessage/globalmessage'\r\n      ], function (GlobalMessage) {\r\n        GlobalMessage.showMessage(type, message);\r\n      });\r\n    },\r\n\r\n    onClickSave: function () {\r\n      this.ui.saveBtn.prop('disabled', true);\r\n      //Close collout if any open\r\n      var popoverTarget = this.options.container.find(\".binf-popover\");\r\n      if (popoverTarget.length) {\r\n        popoverTarget.binf_popover('hide');\r\n        // Added timeout to wait for closing popover, thus widget options will update properly\r\n        setTimeout(_.bind(function () {\r\n          this.context.triggerMethod('serialize:perspective', this.perspective);\r\n        }, this), 1500);\r\n      } else {\r\n        this.context.triggerMethod('serialize:perspective', this.perspective);\r\n      }\r\n    },\r\n\r\n    onClickReset: function () {\r\n      var self = this;\r\n      require(['csui/dialogs/modal.alert/modal.alert'], function (alertDialog) {\r\n        alertDialog.confirmQuestion(lang.resetConfirmMsg,\r\n            lang.reset,\r\n            {\r\n              buttons: {\r\n                showYes: true,\r\n                labelYes: lang.reset,\r\n                showNo: true,\r\n                labelNo: lang.cancel\r\n              }\r\n            })\r\n            .done(function (yes) {\r\n              if (yes) {\r\n                self._doReset();\r\n              }\r\n            });\r\n      });\r\n    },\r\n\r\n    _doReset: function () {\r\n      var sourceModel = this._getSourceModel();\r\n      originalPerspective = JSON.parse(JSON.stringify(sourceModel.get('perspective')));\r\n      originalPerspective.options = originalPerspective.options || {};\r\n      originalPerspective.options.perspectiveMode = this.mode;\r\n      var originalConfig = new Backbone.Model(originalPerspective);\r\n      this.context.triggerMethod('enter:edit:perspective', originalConfig);\r\n      this.listenToOnce(this.context, 'finish:enter:edit:perspective', function () {\r\n        this._showMessage(\"success\", lang.resetSuccessful);\r\n      });\r\n    },\r\n\r\n    _getSourceModel: function (params) {\r\n      var sourceModel;\r\n      if (this.applicationScope.get('id') === 'node') {\r\n        sourceModel = this.context.getModel(NodeModelFactory);\r\n      } else if (!this.applicationScope.get('id')) {\r\n        sourceModel = this.context.getModel(UserModelFactory);\r\n      }\r\n      return sourceModel;\r\n    },\r\n\r\n    onClickClose: function () {\r\n      this._doExitPerspective();\r\n    },\r\n\r\n    togglePannel: function (event) {\r\n      if (!this.ui.pmanPanel.hasClass('binf-active')) {\r\n        // Reset before showing panel\r\n        if (!(event.originalEvent.pointerType === 'mouse')) {\r\n          this.$el.find('.csui-layout-tab').attr('tabindex', 0);\r\n          this.$el.find('.csui-layout-tab').focus();\r\n        }\r\n        this._openToolsPanel();\r\n      } else {\r\n        this.$el.find('.csui-layout-tab').attr('tabindex', -1);\r\n        this.$el.find('.cs-go-back').attr('tabindex', -1);\r\n        this._closeToolsPanel();\r\n      }\r\n    },\r\n\r\n    _openToolsPanel: function () {\r\n      this.pmanPanelView.trigger('reset:items');\r\n      this.ui.addIcon.addClass('binf-active');\r\n      this.ui.addIcon.attr(\"title\", lang.close);\r\n      this.ui.pmanPanel.addClass('binf-active');\r\n      this.pmanPanelView.triggerMethod(\"panel:open\");\r\n    },\r\n\r\n    _closeToolsPanel: function () {\r\n      this.ui.pmanPanel.removeClass('binf-active');\r\n      this.ui.addIcon.attr(\"title\", lang.addWidget);\r\n      this.ui.addIcon.removeClass('binf-active');\r\n    },\r\n\r\n    applyMasking: function () {\r\n\r\n    },\r\n\r\n    _initializeWidgets: function () {\r\n      if (this.mode === PerspectiveUtil.MODE_PERSONALIZE) {\r\n        // Personalize doesn't need to load all available widgets for DnD\r\n        return;\r\n      }\r\n      this.pmanPanelRegion = new Marionette.Region({\r\n        el: this.ui.pmanPanel\r\n      });\r\n      this.pmanPanelView = new PManPanelView({\r\n        pmanView: this\r\n      });\r\n      this.pmanPanelRegion.show(this.pmanPanelView);\r\n      _.isFunction(this.ui.trashArea.droppable) && this.ui.trashArea.droppable({\r\n        tolerance: 'pointer',\r\n        hoverClass: \"pman-trash-hover\",\r\n        accept: function () {\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n\r\n    _triggerEditMode: function () {\r\n      var perspectiveConfig = this.perspective.getPerspective();\r\n      perspectiveConfig.options = perspectiveConfig.options || {};\r\n      perspectiveConfig.options.perspectiveMode = this.mode;\r\n      var perspective = new Backbone.Model(perspectiveConfig);\r\n      this.context.triggerMethod('enter:edit:perspective', perspective);\r\n      this.listenToOnce(this.context, 'finish:enter:edit:perspective', this._setFocusOnFirstWidget);\r\n    },\r\n\r\n    _beforeTransition: function () {\r\n      var perspectiveContainer = this.options.container.find('.cs-perspective');\r\n      this.options.container.addClass('perspective-editing-transition');\r\n      base.onTransitionEnd(perspectiveContainer, function () {\r\n        this.options.container.removeClass('perspective-editing-transition');\r\n      }, this);\r\n    },\r\n\r\n    onRender: function () {\r\n      var self = this;\r\n      this._beforeTransition();\r\n      this.options.container.addClass('perspective-editing');\r\n      this.options.applyMasking();\r\n      this._initializeWidgets();\r\n      this._triggerEditMode();\r\n      $(document).on('click.' + this.cid, {view: this}, this._documentClick);\r\n      // applying draganddropmixin for flow perpective, for reordering widgets\r\n      var applyKNMixin = this.perspective.get('type') === 'sidepanel-right' ||\r\n        this.perspective.get('type') === 'sidepanel-left' ||\r\n        this.perspective.get('type') === \"flow\" ||\r\n        this.perspective.get('perspective').type === 'sidepanel-right' ||\r\n        this.perspective.get('perspective').type === 'sidepanel-left' ||\r\n        this.perspective.get('perspective').type === \"flow\";\r\n      if (applyKNMixin) {\r\n        $(document).on('keydown', {view: this}, this.onKeyInView);\r\n      }\r\n    },\r\n\r\n    onKeyInView: function (event) {\r\n      var isRtl = i18n && i18n.settings.rtl,\r\n        self = event.data && event.data.view,\r\n        continueEvent = true,\r\n        isMac = base.isMacintosh();\r\n      if ($(document.activeElement).parents('#banner').length > 0) {\r\n        return;\r\n      }\r\n      if (isMac && event.metaKey && !event.ctrlKey || !isMac && !event.metaKey &&\r\n          event.ctrlKey) {\r\n        var $target = $(event.target),\r\n            $targetParent = $target.closest('.csui-draggable-item'),\r\n            widgetCells = self.options && self.options.context &&\r\n                          self.options.context.widgetCollection &&\r\n                          self.options.context.widgetCollection.at(0).columns.models;\r\n        switch (event.keyCode) {\r\n        case 39:\r\n          isRtl ? self.moveToLeft($targetParent, $target, widgetCells) : self.moveToRight($targetParent, $target, widgetCells);\r\n          continueEvent = false;\r\n          break;\r\n        case 37:\r\n          isRtl ? self.moveToRight($targetParent, $target, widgetCells) : self.moveToLeft($targetParent, $target, widgetCells);\r\n          continueEvent = false;\r\n          break;\r\n        }\r\n      }\r\n      return continueEvent;\r\n    },\r\n\r\n\r\n    _documentClick: function (event) {\r\n      var self = event.data.view;\r\n      if (self.ui.addIcon.is(event.target) || !!self.ui.addIcon.has(event.target).length) {\r\n        // Add Icon\r\n        return;\r\n      }\r\n      if (self.ui.pmanPanel.is(event.target) || !!self.ui.pmanPanel.has(event.target).length) {\r\n        // Pman panel\r\n        return;\r\n      }\r\n      self._closeToolsPanel();\r\n    },\r\n\r\n    _onChangePerspective: function () {\r\n      this._doCleanup();\r\n    },\r\n\r\n    _doCleanup: function () {\r\n      var popoverTarget = this.options.container.find(\".binf-popover\");\r\n      this._beforeTransition();\r\n      if (popoverTarget.length) {\r\n        popoverTarget.binf_popover('destroy');\r\n      }\r\n      this.options.container.removeClass('perspective-editing');\r\n      $(document).off('click.' + this.cid, this._documentClick);\r\n      $(document).off('keydown', this.onKeyInView);\r\n      this.trigger('destroy');\r\n    },\r\n\r\n    /**\r\n     * Edit from perspective inline editing mode.\r\n     */\r\n    _doExitPerspective: function () {\r\n      this.context.triggerMethod('exit:edit:perspective', this.perspective);\r\n    },\r\n\r\n    // Move focus to first widget of Perspective Panel\r\n    _setFocusOnFirstWidget: function () {\r\n      var focusableEle = this.options.container.find(\r\n          '.cs-perspective-panel .cs-perspective .csui-pman-editable-widget').first(),\r\n          shortcutButton = focusableEle.find('.shortcut-group-wrapper');\r\n      if (shortcutButton.attr('tabindex') === '0') {\r\n        shortcutButton[0].focus();\r\n      } else {\r\n        focusableEle.find('.wrapper-button')[0].focus();\r\n      }\r\n    },\r\n\r\n    onKeyDown: function (event) {\r\n      switch (event.keyCode) {\r\n      case 9: //TAB\r\n        if (!event.shiftKey && $(event.target).is(this.ui.cancelEdit)) {\r\n          this._setFocusOnFirstWidget();\r\n          return false;\r\n        }\r\n      }\r\n    }\r\n\r\n  });\r\n  DragAndDropKNMixin.mixin(PManView.prototype);\r\n  return PManView;\r\n});\r\n\n","csui.define('csui/perspective.manage/widgets/perspective.placeholder/impl/nls/lang',{\r\n  // Always load the root bundle for the default locale (en-us)\r\n  \"root\": true,\r\n  // Do not load English locale bundle provided by the root bundle\r\n  \"en-us\": false,\r\n  \"en\": false\r\n});\r\n  \n","csui.define('csui/perspective.manage/widgets/perspective.placeholder/impl/nls/root/lang',{\r\n  dndWidgetsHere: 'Drag and Drop widgets here',\r\n  dndHTMLWidgetsHere: 'Drag and Drop HTML tiles only',\r\n});\r\n  \n","\n/* START_TEMPLATE */\ncsui.define('hbs!csui/perspective.manage/widgets/perspective.placeholder/impl/perspective.placeholder',['module','hbs','nuc/lib/handlebars'], function( module, hbs, Handlebars ){ \nvar t = Handlebars.template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"csui-placeholder-title\\\" title=\\\"\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"dndWidgetsHere\") || (depth0 != null ? lookupProperty(depth0,\"dndWidgetsHere\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"dndWidgetsHere\",\"hash\":{},\"loc\":{\"start\":{\"line\":1,\"column\":43},\"end\":{\"line\":1,\"column\":61}}}) : helper)))\n    + \"\\\">\\r\\n  <div class=\\\"csui-placeholder-icon\\\"></div>\\r\\n  <div>\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"dndWidgetsHere\") || (depth0 != null ? lookupProperty(depth0,\"dndWidgetsHere\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"dndWidgetsHere\",\"hash\":{},\"loc\":{\"start\":{\"line\":3,\"column\":7},\"end\":{\"line\":3,\"column\":25}}}) : helper)))\n    + \"</div>\\r\\n</div>\";\n}});\nHandlebars.registerPartial('csui_perspective.manage_widgets_perspective.placeholder_impl_perspective.placeholder', t);\nreturn t;\n});\n/* END_TEMPLATE */\n;\n","\ncsui.define('css!csui/perspective.manage/widgets/perspective.placeholder/impl/perspective.placeholder',[],function(){});\n","/**\r\n * Placeholder view to represent an empty widget in perpsective.\r\n * This will be replaces by perspective.widget (preview) on dropping of widgets on this\r\n */\r\ncsui.define('csui/perspective.manage/widgets/perspective.placeholder/perspective.placeholder.view',['csui/lib/underscore', 'csui/lib/backbone', 'csui/lib/marionette',\r\n  'i18n!csui/perspective.manage/widgets/perspective.placeholder/impl/nls/lang',\r\n  'hbs!csui/perspective.manage/widgets/perspective.placeholder/impl/perspective.placeholder',\r\n  'css!csui/perspective.manage/widgets/perspective.placeholder/impl/perspective.placeholder'\r\n], function (_, Backbone, Marionette, lang, template) {\r\n  var PerspectivePlaceholderView = Marionette.ItemView.extend({\r\n    className: 'csui-perspective-placeholder',\r\n    template: template,\r\n    templateHelpers: function () {\r\n      return {\r\n        dndWidgetsHere: this.options.widgetContainer && this.options.widgetContainer.options.grid.allowHTMLTilesOnly ?\r\n                          lang.dndHTMLWidgetsHere : lang.dndWidgetsHere\r\n      }\r\n    },\r\n\r\n    constructor: function (options) {\r\n      Marionette.ItemView.apply(this, arguments);\r\n    },\r\n\r\n    onShow: function() {\r\n      this.$el.parent().addClass('csui-pman-placeholder-container');\r\n    },\r\n\r\n    onDestroy: function() {\r\n      this.$el.parent().removeClass('csui-pman-placeholder-container');\r\n    }\r\n\r\n  });\r\n  return PerspectivePlaceholderView;\r\n});\n","csui.define('csui/perspective.manage/widgets/perspective.widget/impl/nls/lang',{\r\n  // Always load the root bundle for the default locale (en-us)\r\n  \"root\": true,\r\n  // Do not load English locale bundle provided by the root bundle\r\n  \"en-us\": false,\r\n  \"en\": false\r\n});\r\n  \n","csui.define('csui/perspective.manage/widgets/perspective.widget/impl/nls/root/lang',{\r\n  noConfig: 'No configuration needed',\r\n  clickToConfig: 'Configuration needed'\r\n});\r\n  \n","\n/* START_TEMPLATE */\ncsui.define('hbs!csui/perspective.manage/widgets/perspective.widget/impl/perspective.widget',['module','hbs','nuc/lib/handlebars'], function( module, hbs, Handlebars ){ \nvar t = Handlebars.template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"tile-header\\\">\\r\\n  <div class=\\\"tile-title\\\">\\r\\n    <h2 class=\\\"csui-heading\\\" title=\\\"\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"widgetTitle\") || (depth0 != null ? lookupProperty(depth0,\"widgetTitle\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"widgetTitle\",\"hash\":{},\"loc\":{\"start\":{\"line\":3,\"column\":36},\"end\":{\"line\":3,\"column\":51}}}) : helper)))\n    + \"\\\">\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"widgetTitle\") || (depth0 != null ? lookupProperty(depth0,\"widgetTitle\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"widgetTitle\",\"hash\":{},\"loc\":{\"start\":{\"line\":3,\"column\":53},\"end\":{\"line\":3,\"column\":68}}}) : helper)))\n    + \"</h2>\\r\\n  </div>\\r\\n</div>\\r\\n<div>\\r\\n  <div title=\\\"\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"widgetMessage\") || (depth0 != null ? lookupProperty(depth0,\"widgetMessage\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"widgetMessage\",\"hash\":{},\"loc\":{\"start\":{\"line\":7,\"column\":14},\"end\":{\"line\":7,\"column\":31}}}) : helper)))\n    + \"\\\" class=\\\"csui-pman-widget-msg\\\">\\r\\n    <div class=\\\"csui-pman-widget-icon\\\"></div>\\r\\n    <div>\"\n    + container.escapeExpression(((helper = (helper = lookupProperty(helpers,\"widgetMessage\") || (depth0 != null ? lookupProperty(depth0,\"widgetMessage\") : depth0)) != null ? helper : container.hooks.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"widgetMessage\",\"hash\":{},\"loc\":{\"start\":{\"line\":9,\"column\":9},\"end\":{\"line\":9,\"column\":26}}}) : helper)))\n    + \"</div>\\r\\n  </div>\\r\\n</div>\";\n}});\nHandlebars.registerPartial('csui_perspective.manage_widgets_perspective.widget_impl_perspective.widget', t);\nreturn t;\n});\n/* END_TEMPLATE */\n;\n","\ncsui.define('css!csui/perspective.manage/widgets/perspective.widget/impl/perspective.widget',[],function(){});\n","/**\r\n * Preview view of any widget\r\n */\r\ncsui.define('csui/perspective.manage/widgets/perspective.widget/perspective.widget.view',['csui/lib/underscore', 'csui/lib/backbone', 'csui/lib/marionette',\r\n  'i18n!csui/perspective.manage/widgets/perspective.widget/impl/nls/lang',\r\n  'hbs!csui/perspective.manage/widgets/perspective.widget/impl/perspective.widget',\r\n  'css!csui/perspective.manage/widgets/perspective.widget/impl/perspective.widget'\r\n], function (_, Backbone, Marionette, lang, template) {\r\n  var PerspectiveWidgetView = Marionette.ItemView.extend({\r\n    className: 'csui-pman-widget',\r\n    template: template,\r\n    templateHelpers: function () {\r\n      var wConfig  = this.widget && this.widget.get(\"manifest\"),\r\n          wTitle   = this.widget && this.widget.get('title'),\r\n          noConfig = !wConfig || !wConfig.schema || !wConfig.schema.properties ||\r\n                     _.isEmpty(wConfig.schema.properties);\r\n      return {\r\n        widgetTitle: wTitle || lang.noTitle,\r\n        widgetMessage: noConfig ? lang.noConfig : lang.clickToConfig\r\n      }\r\n    },\r\n\r\n    constructor: function (options) {\r\n      options || (options = {});\r\n      options = _.defaults(options, {\r\n        data: {},\r\n      });\r\n      Marionette.ItemView.apply(this, arguments);\r\n      this.widget = options.data.widget;\r\n    }\r\n  });\r\n  return PerspectiveWidgetView;\r\n});\n","\ncsui.define('json!csui/perspective.manage/widgets/perspective.placeholder/perspective.placeholder.manifest.json',{\r\n  \"$schema\": \"http://opentext.com/cs/json-schema/draft-04/schema#\",\r\n  \"title\": \"{{title}}\",\r\n  \"description\": \"{{description}}\",\r\n  \"kind\": \"tile\",\r\n  \"schema\": {\r\n    \"type\": \"object\",\r\n    \"properties\": {}\r\n  }\r\n}\r\n  \r\n);\n\n","\ncsui.define('json!csui/perspective.manage/widgets/perspective.widget/perspective.widget.manifest.json',{\r\n  \"$schema\": \"http://opentext.com/cs/json-schema/draft-04/schema#\",\r\n  \"title\": \"{{title}}\",\r\n  \"description\": \"{{description}}\",\r\n  \"kind\": \"tile\",\r\n  \"schema\": {\r\n    \"type\": \"object\",\r\n    \"properties\": {}\r\n  }\r\n}\r\n);\n\n","csui.define('csui/perspective.manage/widgets/perspective.placeholder/impl/nls/perspective.placeholder.manifest',{\r\n  // Always load the root bundle for the default locale (en-us)\r\n  \"root\": true,\r\n  // Do not load English locale bundle provided by the root bundle\r\n  \"en-us\": false,\r\n  \"en\": false\r\n});\r\n\n","csui.define('csui/perspective.manage/widgets/perspective.placeholder/impl/nls/root/perspective.placeholder.manifest',{\r\n  dndWidgetsHere: 'Drag and Drop widgets here'\r\n});\r\n\n","\n","csui.define('csui/perspective.manage/widgets/perspective.widget/impl/nls/perspective.widget.manifest',{\r\n  // Always load the root bundle for the default locale (en-us)\r\n  \"root\": true,\r\n  // Do not load English locale bundle provided by the root bundle\r\n  \"en-us\": false,\r\n  \"en\": false\r\n});\r\n\n","csui.define('csui/perspective.manage/widgets/perspective.widget/impl/nls/root/perspective.widget.manifest',{\r\n  noConfig: 'No configuration needed',\r\n  clickToConfig: 'Configuration needed'\r\n});\r\n\n","\n","csui.define('bundles/csui-perspective',[\r\n    'csui/perspective.manage/pman.view',\r\n    'csui/perspective.manage/behaviours/pman.widget.config.behaviour',\r\n    'csui/perspective.manage/widgets/perspective.placeholder/perspective.placeholder.view',\r\n    'csui/perspective.manage/widgets/perspective.widget/perspective.widget.view',\r\n    \r\n    // widgets manifests\r\n    'json!csui/perspective.manage/widgets/perspective.placeholder/perspective.placeholder.manifest.json',\r\n    'json!csui/perspective.manage/widgets/perspective.widget/perspective.widget.manifest.json',\r\n\r\n    'i18n!csui/perspective.manage/widgets/perspective.placeholder/impl/nls/perspective.placeholder.manifest',\r\n    'i18n!csui/perspective.manage/widgets/perspective.widget/impl/nls/perspective.widget.manifest',\r\n], {});\r\n  \r\ncsui.require(['require', 'css'], function (require, css) {\r\n    css.styleLoad(require, 'csui/bundles/csui-perspective', true);\r\n});\r\n  \n"]}