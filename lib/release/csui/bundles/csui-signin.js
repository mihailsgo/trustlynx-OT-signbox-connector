csui.define("hbs!csui/controls/signin/impl/signin",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,s){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="login-container">\r\n  <div class="login-controls">\r\n    <div class="branding"><span role="presentation" class="ot-logo">&nbsp;</span></div>\r\n    <div class="login-error" id="loginError"></div>\r\n    <div class="login-form-wrapper">\r\n      <form>\r\n        <div class="binf-form-group binf-has-feedback">\r\n          <div class="col-md-20">\r\n            <input id="inputUsername" type="text" class="binf-form-control binf-input-lg textbox hasclear"\r\n                   placeholder="'+e.escapeExpression((o=null!=(o=r(i,"placeholderusername")||(null!=t?r(t,"placeholderusername"):t))?o:e.hooks.helperMissing,"function"==typeof o?o.call(null!=t?t:e.nullContext||{},{"name":"placeholderusername","hash":{},"loc":{"start":{"line":10,"column":32},"end":{"line":10,"column":55}}}):o))+'" aria-label="'+e.escapeExpression((o=null!=(o=r(i,"userNameAria")||(null!=t?r(t,"userNameAria"):t))?o:e.hooks.helperMissing,"function"==typeof o?o.call(null!=t?t:e.nullContext||{},{"name":"userNameAria","hash":{},"loc":{"start":{"line":10,"column":69},"end":{"line":10,"column":85}}}):o))+'">\r\n              <span id="usernameclearer" class="clearer clear-icon binf-form-control-feedback"></span>\r\n\r\n          </div>\r\n        </div>\r\n        <div class="binf-form-group binf-has-feedback">\r\n          <div class="col-md-20">\r\n            <input id="inputPassword" type="password"\r\n                   class="binf-form-control binf-input-lg textbox hasclear"\r\n                   placeholder="'+e.escapeExpression((o=null!=(o=r(i,"placeholderpassword")||(null!=t?r(t,"placeholderpassword"):t))?o:e.hooks.helperMissing,"function"==typeof o?o.call(null!=t?t:e.nullContext||{},{"name":"placeholderpassword","hash":{},"loc":{"start":{"line":19,"column":32},"end":{"line":19,"column":55}}}):o))+'" aria-label="'+e.escapeExpression((o=null!=(o=r(i,"passwordAria")||(null!=t?r(t,"passwordAria"):t))?o:e.hooks.helperMissing,"function"==typeof o?o.call(null!=t?t:e.nullContext||{},{"name":"passwordAria","hash":{},"loc":{"start":{"line":19,"column":69},"end":{"line":19,"column":85}}}):o))+'">\r\n              <span id="passwordclearer" class="clearer clear-icon binf-form-control-feedback"></span>\r\n          </div>\r\n        </div>\r\n        <button id="buttonSubmit" type="button" class="login-btn">'+e.escapeExpression((o=null!=(o=r(i,"buttontext")||(null!=t?r(t,"buttontext"):t))?o:e.hooks.helperMissing,"function"==typeof o?o.call(null!=t?t:e.nullContext||{},{"name":"buttontext","hash":{},"loc":{"start":{"line":23,"column":66},"end":{"line":23,"column":80}}}):o))+"</button>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</div>\r\n"}});return i.registerPartial("csui_controls_signin_impl_signin",n),n}),csui.define("csui/controls/signin/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/signin/impl/nls/root/localized.strings",{"signinButtonText":"Sign in","signinForgotPassword":"Forgot password?","signinPlaceholderUsername":"User name","usernameAria":"Enter user name","signinPlaceholderPassword":"Password","passwordAria":"Enter password","signinInvalidUsernameOrPassword":"You have entered an invalid user name or password. Please try again."}),csui.define("css!csui/controls/signin/impl/css/signin",[],function(){}),csui.define("csui/controls/signin/signin.view",["module","csui/lib/underscore","csui/lib/jquery","csui/utils/authenticators/basic.authenticator","csui/utils/authenticators/credentials.authenticator","csui/utils/contexts/page/page.context","csui/utils/connector","csui/utils/contexts/factories/connector","csui/lib/marionette","hbs!csui/controls/signin/impl/signin","i18n!csui/controls/signin/impl/nls/localized.strings","css!csui/controls/signin/impl/css/signin"],function(e,t,i,n,s,o,r,a,u,c,l){"use strict";var g=t.extend({"useBasicAuthentication":!1},e.config());return u.ItemView.extend({"constructor":function(){u.ItemView.apply(this,arguments)},"className":"cs-signin","template":c,"triggers":{"click button":"click:button","mousedown @ui.usernameclearer":"click:usernameclearer","mousedown @ui.passwordclearer":"click:passwordclearer","focus @ui.username":"focus:username","focus @ui.password":"focus:password","change @ui.password":"change:password","change @ui.username":"change:username"},"ui":{"username":"#inputUsername","password":"#inputPassword","button":"#buttonSubmit","passwordclearer":"#passwordclearer","usernameclearer":"#usernameclearer","loginerror":"#loginError"},"onRender":function(){this.ui.usernameclearer.toggle(!1),this.ui.passwordclearer.toggle(!1),this.ui.username.prop("autofocus",!0)},"onClickPasswordclearer":function(e){this.ui.password.val("").trigger("focus"),this._unsetErrorStyle(),this.ui.passwordclearer.hide()},"onClickUsernameclearer":function(e){this.ui.username.val("").trigger("focus"),this._unsetErrorStyle(),this.ui.usernameclearer.hide()},"onFocusUsername":function(){this.validate()},"onFocusPassword":function(){this.validate()},"onChangeUsername":function(){this.validate()},"onChangePassword":function(){this.validate()},"templateHelpers":function(){return{"buttontext":l.signinButtonText,"copyright":l.signinCopyright,"forgotpassword":l.signinForgotPassword,"placeholderusername":l.signinPlaceholderUsername,"usernameAria":l.usernameAria,"placeholderpassword":l.signinPlaceholderPassword,"passwordAria":l.passwordAria}},"events":{"keyup .binf-form-control":"validate","keydown button":"onKeyPress"},"onKeyPress":function(e){this.ui.button.prop("disabled")||13!==e.which||this.ui.button.toggleClass("login-btn-enabled")},"validate":function(e){this._unsetErrorStyle();var t=!!this.ui.username.val().length,n=t&&!0,s=i(document.activeElement).is(this.ui.username),o=i(document.activeElement).is(this.ui.password);this.ui.usernameclearer.toggle(t&&s),this.ui.passwordclearer.toggle(o),this.ui.button.prop("disabled",!n),this.ui.button.toggleClass("login-btn-enabled",n),n&&e&&13===e.which&&(e.preventDefault(),this.ui.button.trigger("click"))},"onClickButton":function(){this.ui.button.toggleClass("login-btn-enabled",!1);var e={"username":this.ui.username.val(),"password":this.ui.password.val()},i=g.useBasicAuthentication;if(!this.authenticator){var r=t.defaults({"credentials":e},this.options.connection),u=i?n:s,c=new u({"connection":r}).on("loggedIn",t.bind(function(){this.ui.button.toggleClass("login-btn-enabled",!0),this.trigger("success",{"username":e.username,"session":r.session})},this));this.authenticator=c}var l=t.bind(function(){var e=new o,t=e.getObject(a),i=this.authenticator.connection.session;t.authenticator.updateAuthenticatedSession(i)},this),d=t.bind(function(t,i){this.ui.button.toggleClass("login-btn-enabled",!0),this._setErrorStyle(),this.trigger("failure",{"username":e.username,"error":t})},this);i?this.authenticator.check({"credentials":e},l,d):this.authenticator.login({"data":e},l,d)},"_setErrorStyle":function(){this.ui.username.trigger("focus").trigger("select"),this.ui.password.val(""),this.ui.usernameclearer.toggle(!0),this.ui.passwordclearer.toggle(!0),this.ui.loginerror.html(l.signinInvalidUsernameOrPassword),this.$(".binf-form-group").addClass("binf-has-error"),this.$(".clearer").removeClass("clear-icon").addClass("error-icon")},"_unsetErrorStyle":function(){this.ui.loginerror.html(""),this.$(".binf-form-group").removeClass("binf-has-error"),this.$(".clearer").removeClass("error-icon").addClass("clear-icon")}})}),csui.define("hbs!csui/pages/signin/impl/signin.page",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,s){return'<div class="wrapper">\r\n  <div id="signin"></div>\r\n</div>\r\n<div class="footer">\r\n  <span class="login-copyright"></span>\r\n</div>\r\n'}});return i.registerPartial("csui_pages_signin_impl_signin.page",n),n}),csui.define("csui/pages/signin/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/pages/signin/impl/nls/root/lang",{"copyrightMessage":"Copyright \xa9 2018 Open Text SA or Open Text ULC (in Canada). All rights reserved."}),csui.define("csui/utils/non-attaching.region/non-attaching.region",["csui/lib/marionette"],function(e){"use strict";return e.Region.extend({"constructor":function(t){e.Region.prototype.constructor.apply(this,arguments)},"attachHtml":function(e){}})}),csui.define("css!csui/pages/signin/impl/signin.page",[],function(){}),csui.define("csui/pages/signin/signin.page.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/contexts/page/page.context","csui/utils/contexts/factories/connector","csui/controls/signin/signin.view","hbs!csui/pages/signin/impl/signin.page","i18n!csui/pages/signin/impl/nls/lang","csui/utils/log","csui/utils/base","csui/utils/non-attaching.region/non-attaching.region","css!csui/pages/signin/impl/signin.page"],function(e,t,i,n,s,o,r,a,u,c,l,g){var d=t.extend({"applicationPageUrl":"index.html"},e.config());return n.LayoutView.extend({"template":a,"regions":{"formRegion":"#signin"},"ui":{"copyright":".login-copyright"},"constructor":function(e){e||(e={}),e.el=document.body,n.LayoutView.prototype.constructor.call(this,e),this.$el.addClass("binf-widgets"),l.isAppleMobile()&&this.$el.addClass("csui-on-ipad"),l.isIOSBrowser()&&this.$el.addClass("csui-on-macintosh")},"onRender":function(){var e=new s,i=e.getObject(o),n=new r({"connection":i.connection});this.listenTo(n,"failure",function(e){c.warn("Login for user {0} failed: {1} ",e.username,e.error.statusText)&&console.warn(c.last)}),this.listenTo(n,"success",function(e){c.info("Login succeeded for user: ",e.username)&&console.log(c.last);var t=location.search.substring(1),i=/\bnextUrl(?:=([^&]+))?\b/i.exec(t),n=i&&decodeURIComponent(i[1])||this.options.applicationPageUrl||d.applicationPageUrl;t=t.replace(/\bnextUrl(?:=[^&]*)?/i,"").replace(/&$/,""),t&&(n+=(n.indexOf("?")>0?"&":"?")+t),location.href=n+location.hash}),this.formRegion.show(n),this.ui.copyright.html(u.copyrightMessage),setTimeout(t.bind(function(){new g({"el":this.el}).show(this,{"render":!1})},this))}})}),csui.define("csui/utils/authenticators/interactive.credentials.authenticator",["require","module","csui/lib/underscore","csui/utils/authenticators/request.authenticator"],function(e,t,i,n){"use strict";return n.extend({"interactive":function(){return!0},"constructor":function(e){n.prototype.constructor.call(this,e)},"authenticate":function(e,t,s){"function"==typeof e&&(t,t=e,e=void 0),n.prototype.authenticate.call(this,e,t,i.bind(this.openSignInDialog,this,t))},"openSignInDialog":function(e){if(!this.reauthenticating){var t=this;t.reauthenticating=!0,csui.require(["csui/utils/impl/signin.dialog/signin.dialog","csui/controls/progressblocker/blocker"],function(i,n){var s=new i({"connection":t.connection});n.suppressAll(),s.show().done(function(i){t.connection.session=i.session,t.reauthenticating=!1,n.resumeAll(),e(t.connection)})})}}})}),csui.define("csui/utils/user.session/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/utils/user.session/impl/nls/root/lang",{"errorTerminateSession":"Terminating the session failed.","errorContinueSession":"Continuing the session failed.","errorHttpPrefix":"HTTP"}),csui.define("csui/utils/user.session/user.session",["module","require","csui/lib/underscore","csui/lib/jquery","csui/utils/log","csui/utils/url","csui/utils/base","i18n!csui/utils/user.session/impl/nls/lang"],function(e,t,i,n,s,o,r,a){"use strict";s=s(e.id);return function(){function t(){return k}function u(){return U}function c(){return O}function l(){return I}function g(){return(new Date).toUTCString()}function d(){return u()+t()}function h(e){if(e)if(e.expires&&e.serverDate){if(new Date(e.expires).getTime()<=new Date(e.serverDate).getTime()){var t=new Date;e.serverDate=t.toUTCString(),e.expires=new Date(t.getTime()+d()).toUTCString(),s.warn("user.session: _ensureExpiresTime: Provided 'serverDate' is newer or equal than 'expires' value, exceptionally replacing values (expires: "+e.expires+").")&&console.warn(s.last)}}else{var i=new Date;e.serverDate=i.toUTCString(),e.expires=new Date(i.getTime()+d()).toUTCString(),s.warn("user.session: _ensureExpiresTime: Adding 'serverDate' and 'expires' information to session (expires: "+e.expires+").")&&console.warn(s.last)}else s.error("user.session: _ensureExpiresTime: The provided argument 'session' is undefined!")&&console.error(s.last)}function p(e){var t=e.connection.session,i=0;if(h(t),t&&void 0!==t.expires&&"string"==typeof t.expires&&t.expires.length>0){var n=new Date(t.expires);isNaN(n.getTime())&&(n=new Date((new Date).getTime()+d()),s.info("user.session: _calcExpirationStartTime: Got unparseable date value for expires '"+t.expires+"', using fallback value '"+n.toUTCString()+"'.")&&console.log(s.last),t.expires=n.toUTCString());var o=n.getTime();o-=N,o<0&&(o=0);var r=new Date(t.serverDate);isNaN(r.getTime())&&(r=new Date,s.warn("user.session: _calcExpirationStartTime: Got unparseable date value for serverDate '"+t.serverDate+"', using fallback value '"+r.toUTCString()+"'.")&&console.warn(s.last),t.serverDate=r.toUTCString());var a=r.getTime();s.info("user.session: _calcExpirationStartTime: srvDate: "+t.serverDate+", expires: "+t.expires+" (Date: "+g()+").")&&console.log(s.last),i=a>=o?0:o-a,i/=1e3}else s.error("user.session: _calcExpirationStartTime: The provided authenticator.connection.session has no expiration information.")&&console.error(s.last);return s.info("user.session: _calcExpirationStartTime: secs until expiration: "+i)&&console.log(s.last),i}function f(){return!(!0!==this.isSessionExpirationEnabled()||!H)&&1==this.getCookieExpirationMode()}function m(e,t){if(e&&e.isAuthenticated())if(t&&t.settings&&t.settings.url){var i=new o(t.settings.url).getAbsolute().toLowerCase(),n=i.match(/^.*\/(api\/[^?]+)/);if(n){var r=n[1];s.debug("user.session: updateSessionTicket: Resetting expiration timer based on call '"+r+"'.")&&console.log(s.last),this.clearExpirationTimer(),this._createExpirationTimer(e)}}else s.debug("user.session: updateSessionTicket: Resetting expiration timer based on unspecified call.")&&console.log(s.last),this.clearExpirationTimer(),this._createExpirationTimer(e);else s.warn("user.session: updateSessionTicket: Authenticator has to be 'authenticated' before updating session ticket!")&&console.warn(s.last)}function v(e){e&&e.isAuthenticated()?(s.debug("user.session: startExpirationTimer: Creating new expiration timer with provided authenticator...")&&console.log(s.last),this.clearExpirationTimer(),this._createExpirationTimer(e)):console.warn("user.session: startExpirationTimer: Unable to start expiration timer, you have to provide an (still) authenticated 'authenticator'! Verify your parameter(s) for startExpirationTimer() function.")}function T(){s.debug("user.session: clearExpirationTimer: called...")&&console.log(s.last),D&&(clearInterval(D),D=void 0)}function S(e){var t=p(e),i=this,n=this.getSessionReactionTime()/1e3,o=function(){var t=!1;return function(n){t||(t=!0,s.info("user.session: expirationTimer: current time for expiration warning count down: "+i.currentDateUTC())&&console.log(s.last),i.displayExpirationWarning(e,{"startWithWarningContent":!0,"startTime":n}))}}();D=setInterval(function(){--t<n&&(s.info("user.session: current expiration value: "+t)&&console.log(s.last),t>=0?o(t):(i.clearExpirationTimer(),s.info("user.session: expirationTimer: Switching to LoggedOut dialog content due to expired session...")&&console.log(s.last),i.sendAuthenticatorEvent(e),i.performSessionExpired(e,!1)))},1e3)}function b(e){e?(s.debug("user.session: Sending event 'clear:timer' to dialog...")&&console.log(s.last),e.triggerMethod("clear:timer","someValue")):s.debug("user.session: Skipping sending event 'clear:timer' to dialog, because dialog is already destroyed.")&&console.log(s.last)}function E(e,t){var i=this;csui.require(["csui/utils/expiration.warning/expiration.warning.dialog"],function(n){var o={"userSession":i,"authenticator":e,"startWithWarningContent":t.startWithWarningContent,"startTime":t.startTime,"clearExpirationTimer":function(){i.clearExpirationTimer()}};L=n.createExpirationWarningDialog(o),n.showExpirationWarningDialog(L).always(function(e){s.debug("user.session: _showExpirationWarningDialog: Expiration dialog was finished, setting internal dialog to undefined.")&&console.log(s.last),L=void 0})})}function y(e,t){if(void 0===L&&!0===this.isSessionExpirationEnabled())if(t&&!0===t.startWithWarningContent){if(this._shouldDisplayExpirationWarning())return this._showExpirationWarningDialog(e,t)}else if(H)return t=t||{},t.startWithWarningContent=!1,this._showExpirationWarningDialog(e,t)}function _(e){s.debug("user.session: redirectToTargetPage: Called ...")&&console.log(s.last);var t=new o(e.connection.url).getCgiScript(),i=o.appendQuery(t,"func=csui.redirecttotarget");location.href=i}function w(e,t){var i=this;!0===this.isSessionExpirationEnabled()?M?s.debug("user.session: performSessionExpired: A logout is already executed.")&&console.log(s.last):(M=!0,s.debug("user.session: performSessionExpired: Initiating automatic logout ...")&&console.log(s.last),this.clearExpirationTimer(),!0===t?(s.info("user.session: performSessionExpired: Session expired, performing requested redirect (Date: "+this.currentDateUTC()+").")&&console.log(s.last),this.redirectToTargetPage(e)):(s.info("user.session: performSessionExpired: Session expired, performing signOut (Date: "+this.currentDateUTC()+").")&&console.log(s.last),this.signOut(e,{"onErrorRedirect":!0,"isSessionExpired":!0}).done(function(){M=!1,s.debug("user.session: performSessionExpired: Automatic logout requests successfully sent.")&&console.log(s.last)}).fail(function(){M=!1,s.info("user.session: performSessionExpired: Sending automatic logout requests returned error.")&&console.log(s.last)}).always(function(){s.info("user.session: performSessionExpired: Sending automatic logout requests finished, spawning redirect timer.")&&console.log(s.last);var t=setTimeout(function(){M=!1,t&&(clearTimeout(t),t=void 0),s.info("user.session: performSessionExpired: Redirecting to target page...'")&&console.log(s.last),i.redirectToTargetPage(e)},N)}))):(s.debug("user.session: performSessionExpired: Skipping automatic logout due to disabled expiration handling.")&&console.log(s.last),this.clearExpirationTimer())}function x(e){var t=this,i=new o(e.connection.url).getCgiScript(),n=o.combine(i,"api/v1/auth");e.makeAjaxCall({"url":n,"headers":{"OTCSTicket":e.connection.session.ticket},"success":function(t,i,o){s.debug("Receiving request response from {0}.",n)&&console.log(s.last),t=e.parseResponse(t,o),e.updateAuthenticatedSession(t,o)}}).done(function(){t.startExpirationTimer(e),s.info("expiration.warning.dialog: Processed continue session (Date: "+t.currentDateUTC()+").")&&console.log(s.last)}).fail(function(i){t.sendAuthenticatorEvent(e,"failedTicketRefresh");var n=a.errorContinueSession,o=new r.RequestErrorMessage(i),u=a.errorHttpPrefix+" "+o.statusCode+(o.message?": ":"")+o.message;s.error("expiration.warning.dialog: Processing continue session failed with an error (Date: "+t.currentDateUTC()+"). Error: "+u+".")&&console.error(s.last),csui.require(["csui/dialogs/modal.alert/modal.alert"],function(i){i.showError(n+"\n"+u).always(function(){t.redirectToTargetPage(e)})})})}function A(e,t){e&&e.trigger(t||"loggedOut",{"sender":e})}function R(e,t){var i=n.Deferred(),u=this;if(t||(t={}),e&&e.isAuthenticated()){var c=new o(e.connection.url).getCgiScript();csui.require(["csui/utils/routing","csui/utils/open.authenticated.page"],function(n,l){if(n.routesWithSlashes())if(!0===u.isSessionExpirationEnabled())if(e&&e.makeAjaxCall&&"function"==typeof e.makeAjaxCall){var g=o.combine(c,"api/v1/auth/logouttoken");e.makeAjaxCall({"url":g,"headers":{"OTCSTicket":e.connection.session.ticket},"success":function(t,i,n){s.debug("Receiving request response from {0}.",g)&&console.log(s.last),t=e.parseResponse(t,n),e.updateAuthenticatedSession(t,n)}}).then(function(n){var r="func=csui.dologout&secureRequestToken="+encodeURIComponent(n.token);!0===t.isSessionExpired&&(r+="&authcontext=sessionexpired");var a=o.appendQuery(c,r);l(e.connection,a,{"openInNewTab":!1}).always(function(){e.unauthenticate(t.unauthenticateReason||{"reason":"logged-out"}),s.debug("user.session: signOut: The logout request was sent to server (Date: "+u.currentDateUTC()+").")&&console.log(s.last),i.resolve()})},function(n){var o=a.errorTerminateSession,c=new r.RequestErrorMessage(n),l=a.errorHttpPrefix+" "+c.statusCode+(c.message?": ":"")+c.message;!0===t.onErrorRedirect?(e.unauthenticate(t.unauthenticateReason||{"reason":"logged-out"}),s.info("user.session: signOut: Terminate session was not successful, redirecting ... (Date: "+u.currentDateUTC()+"). Error: "+l+".")&&console.error(s.last),u.redirectToTargetPage(e)):(s.error("user.session: signOut: Terminate session failed with an error (Date: "+u.currentDateUTC()+"). Error: "+l+".")&&console.error(s.last),csui.require(["csui/dialogs/modal.alert/modal.alert"],function(i){i.showError(o+"\n"+l).always(function(){e.unauthenticate(t.unauthenticateReason||{"reason":"logged-out"}),u.redirectToTargetPage(e)})})),i.reject(n)})}else e.unauthenticate(t.unauthenticateReason||{"reason":"logged-out"}),s.debug("user.session: signOut: makeAjaxCall is not available, so performing redirect to target page (Date: "+u.currentDateUTC()+").")&&console.log(s.last),u.redirectToTargetPage(e),i.resolve();else s.debug("user.session: signOut: Session expiration handling is disabled, skipping logout (Date: "+u.currentDateUTC()+").")&&console.log(s.last),i.resolve();else{e.unauthenticate(t.unauthenticateReason||{"reason":"logged-out"});var d=C.signInPageUrl,h=location.search;h+=h?"&":"?",h+="nextUrl="+encodeURIComponent(location.pathname);var p=d+h+location.hash;s.debug("user.session: signOut: Performed unauthenticate with redirect to development signIn page.")&&console.log(s.last),location.href=p,i.resolve()}})}else s.info("user.session: signOut: Authenticator is not 'authenticated' anymore, just returning success.")&&console.log(s.last),i.resolve();return i.promise()}s.info("user.session: module.config is: "+JSON.stringify(e.config()))&&console.log(s.last);var C=i.extend({"signInPageUrl":"signin.html","kindnessPeriod":3e4,"cookieExpirationMode":1,"enableExpirationHandling":!1},e.config()),O=null!=C.enableExpirationHandling&&C.enableExpirationHandling,I=null==C.cookieExpirationMode?1:C.cookieExpirationMode,U=null==C.sessionInactivity?18e5:C.sessionInactivity,k=null==C.sessionReactionTime?18e4:C.sessionReactionTime,N=null==C.kindnessPeriod?3e4:C.kindnessPeriod,H=I>0,P={"enableExpirationHandling":O,"cookieExpirationMode":I,"sessionInactivity":U,"sessionReactionTime":k,"kindnessPeriod":N};s.warn("user.session: used config: "+JSON.stringify(P))&&console.warn(s.last);var D,L,M=!1;return{"getSessionReactionTime":t,"getSessionInactivity":u,"isSessionExpirationEnabled":c,"getCookieExpirationMode":l,"currentDateUTC":g,"signOut":R,"continueSession":x,"redirectToTargetPage":_,"updateSessionTicket":m,"startExpirationTimer":v,"displayExpirationWarning":y,"performSessionExpired":w,"clearExpirationTimer":T,"stopExpirationWarningViewTimer":b,"sendAuthenticatorEvent":A,"_createExpirationTimer":S,"_shouldDisplayExpirationWarning":f,"_showExpirationWarningDialog":E}}()}),csui.define("hbs!csui/utils/authenticators/impl/redirecting.form.authenticator",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,s){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"        "+(null!=(o=(r(i,"icon-v2")||t&&r(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"on":null!=t?r(t,"on"):t,"states":"true","iconName":null!=t?r(t,"iconName"):t},"loc":{"start":{"line":4,"column":8},"end":{"line":4,"column":59}}}))?o:"")+"        \r\n"},"3":function(e,t,i,n,s){var o,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <div class="icon circular '+e.escapeExpression((o=null!=(o=r(i,"iconRight")||(null!=t?r(t,"iconRight"):t))?o:e.hooks.helperMissing,"function"==typeof o?o.call(null!=t?t:e.nullContext||{},{"name":"iconRight","hash":{},"loc":{"start":{"line":6,"column":34},"end":{"line":6,"column":47}}}):o))+'"></div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,s){var o,r,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<button class="csui-signin-close csui-with-iframe" title="'+e.escapeExpression((r=null!=(r=a(i,"dialogCloseButtonTooltip")||(null!=t?a(t,"dialogCloseButtonTooltip"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"dialogCloseButtonTooltip","hash":{},"loc":{"start":{"line":1,"column":58},"end":{"line":1,"column":86}}}):r))+'"\r\n    aria-label="'+e.escapeExpression((r=null!=(r=a(i,"dialogCloseAria")||(null!=t?a(t,"dialogCloseAria"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"dialogCloseAria","hash":{},"loc":{"start":{"line":2,"column":16},"end":{"line":2,"column":35}}}):r))+'">    \r\n'+(null!=(o=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"iconName"):t,{"name":"if","hash":{},"fn":e.program(1,s,0),"inverse":e.program(3,s,0),"loc":{"start":{"line":3,"column":4},"end":{"line":7,"column":11}}}))?o:"")+"</button>\r\n"}});return i.registerPartial("csui_utils_authenticators_impl_redirecting.form.authenticator",n),n}),csui.define("csui/utils/authenticators/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/utils/authenticators/impl/nls/root/lang",{"dialogCloseButtonTooltip":"Close","dialogCloseButtonAria":"Close sign in dialog"}),csui.define("css!csui/utils/authenticators/impl/redirecting.form.authenticator",[],function(){}),csui.define("csui/utils/authenticators/redirecting.form.authenticator",["require","module","csui/lib/underscore","csui/lib/backbone","csui/lib/jquery","csui/utils/log","csui/utils/authenticators/request.authenticator","csui/utils/user.session/user.session","hbs!csui/utils/authenticators/impl/redirecting.form.authenticator","i18n!csui/utils/authenticators/impl/nls/lang","css!csui/utils/authenticators/impl/redirecting.form.authenticator"],function(e,t,i,n,s,o,r,a,u,c){"use strict";o=o(t.id);var l=t.config(),g=l.authenticationIFrameTimeout||3e3,d=l.showCloseButtonOnError;return r.extend({"interactive":function(){return!1},"constructor":function(e){r.prototype.constructor.call(this,e)},"authenticate":function(e,t,n){"function"==typeof e&&(n=t,t=e,e=void 0),r.prototype.authenticate.call(this,e,t,i.bind(this.initiateLoginSequence,this,t,n))},"updateAuthenticatedSession":function(e,t){r.prototype.updateAuthenticatedSession.call(this,e,t),this.connection.session&&this.connection.session.ticket?a?a.updateSessionTicket(this,t||e):o.info("redirecting.form.authenticator: updateAuthenticatedSession: UserSession is undefined, unable to updateSessionTicket in UserSession.")&&console.log(o.last):o.error("redirecting.form.authenticator: updateAuthenticatedSession: Cannot get 'ticket' from just updated session, invalid request!")&&console.error(o.last)},"unauthenticate":function(e){return this.isAuthenticated()&&e&&e.reason&&("logged-out"===e.reason||"expired"===e.reason)&&a&&!0===a.isSessionExpirationEnabled()&&(o.debug("redirecting.form.authenticator: unauthenticate: clearing expiration timer based on logged-out or expired.")&&console.log(o.last),a.clearExpirationTimer()),r.prototype.unauthenticate.apply(this,arguments)},"initiateLoginSequence":function(e,t){function i(){!1!==E||b.isAuthenticated()||(o.warn("redirecting.form.authenticator: Sending 'failedTicketRefresh' event...")&&console.log(o.last),b.trigger("failedTicketRefresh",{"sender":b}))}function r(){h(),E=!0,T&&T.destroy(),E=!1}function l(){csui.require(["csui/controls/progressblocker/blocker"],function(e){e.suppressAll()})}function h(){csui.require(["csui/controls/progressblocker/blocker"],function(e){e.resumeAll()})}function p(t){if(t.origin!==S)return void(o.warn("redirecting.form.authenticator: event.origin and urlOrigin differ, aborting!")&&console.warn(o.last));if("csuiTicketLoaded"===t.data)o.info("redirecting.form.authenticator: Sending getOrigin back to child.")&&console.log(o.last),t.source.postMessage("getOrigin","*");else if(t.data.ticket){o.debug("redirecting.form.authenticator: Redirecting Form Authenticator received new ticket.")&&console.log(o.last),window.removeEventListener("message",p,!1),v&&clearTimeout(v),v=void 0,r();var i=b.connection.session||(b.connection.session={});i.ticket=t.data.ticket,i.expires=t.data.expires,i.serverDate=t.data.serverDate,e&&e(b.connection),a&&a.updateSessionTicket(b),o.info("redirecting.form.authenticator: Sending 'loggedIn' event...")&&console.log(o.last),b.trigger("loggedIn",{"sender":b,"connection":b.connection})}}function f(){v=setTimeout(m,g)}function m(){T&&(T.$el.removeClass("binf-hidden"),l())}var v,T,S,b=this,E=!1;!function(e){return!!e}(b.getUserId())?function(){csui.require(["csui/controls/dialog/dialog.view","csui/widgets/error.global/error.global.view"],function(e,t){function s(){i(),a.off("destroy",s),a.off("childview:destroy",s),a.destroy()}var o=new n.Model({"message":"The userId is undefined, the preceding authentication failed. Please initialize CSUI in a correct way.","hideNavigationButtons":!0,"showCloseButton":d,"errorCode":401,"showLogout":!1}),r=new t({"model":o}),a=new e({"standardHeader":!1,"view":r,"fullSize":!0});a.on("destroy",s).on("childview:destroy",s).show(),l()})}():(window.addEventListener("message",p,!1),function(){var e=s.Deferred();return csui.require(["csui/lib/marionette","csui/controls/dialog/dialog.view","csui/utils/url"],function(t,n,o){var r=o.appendQuery(new o(b.connection.url).getCgiScript(),"func=csui.ticket");r=o.appendQuery(r,"userid="+b.getUserId()),S=new o(b.connection.url).getOrigin();var a=new t.View({"el":s("<iframe>",{"width":"100%","height":"100%","src":r})}),l=t.ItemView.extend({"ui":{"closeButton":"button.csui-signin-close"},"templateHelpers":function(){return{"dialogCloseButtonTooltip":c.dialogCloseButtonTooltip,"dialogCloseAria":c.dialogCloseButtonAria,"iconName":"csui_action_close_white32","on":"false"}},"template":u,"events":{"click @ui.closeButton":"onButtonClick"},"onButtonClick":function(e){T.onClickClose(e)}});T=new n({"className":"csui-signin-close","standardHeader":!1,"view":a,"fullSize":!0,"footerView":new l}),a.render(),T.on("destroy",function(){i()}).show({"render":!1}),T.$el.css({"z-index":"1061"}),T.$el.addClass("binf-hidden"),e.resolve()},e.reject),e.promise()}().done(f))}})}),csui.define("csui/utils/authenticators/core.authenticators",["module","csui/lib/underscore","csui/utils/authenticators/ticket.authenticator","csui/utils/authenticators/interactive.credentials.authenticator","csui/utils/authenticators/redirecting.form.authenticator"],function(e,t,i,n,s){"use strict";var o=window.csui.requirejs.s.contexts._.config.config["csui/utils/interactiveauthenticator"]||{},r=o.enabled,a=e.config();return o=t.extend({"enableInteractiveAuthenticator":void 0===a.enableRedirectingFormAuthenticator&&!1!==r,"enableRedirectingFormAuthenticator":!1},a),[{"sequence":500,"authenticator":o.enableInteractiveAuthenticator?n:o.enableRedirectingFormAuthenticator?s:i}]}),csui.define("csui/utils/high.contrast/detector",[],function(){"use strict";function e(){var e=document.createElement("div"),i=e.style;i.backgroundColor="rgb(127, 127, 127)",i.borderWidth="1px",i.borderStyle="solid",i.borderTopColor="#ff0000",i.borderRightColor="#00ffff",i.position="absolute",i.left="-9999px",
i.width=e.style.height="2px";var n=document.body;n.appendChild(e),i=window.getComputedStyle(e);var s=i.backgroundColor;t="rgb(127, 127, 127)"===s?0:"rgb(255, 255, 255)"===s?2:1,n.removeChild(e);var o=t?"add":"remove",r="csui-highcontrast-light-on-dark";2===t&&(r="csui-highcontrast-dark-on-light"),document.documentElement.classList[o]("csui-highcontrast"),document.documentElement.classList[o](r)}var t;return{"load":function(i,n,s,o){function r(){if("complete"===document.readyState)return void 0===t&&e(),s(t),!0}o.isBuild?s(null):r()||document.addEventListener("readystatechange",r)}}}),csui.define("csui/models/view.state.model",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/url","csui/utils/namedsessionstorage"],function(e,t,i,n,s,o){"use strict";var r;csui.require(["i18n!csui/pages/start/nls/lang"],function(e){r=e}.bind(this));var a=Object.freeze({"LAST_ROUTER":"lastRouter","CURRENT_ROUTER":"currentRouter","CURRENT_ROUTER_FRAGMENT":"currentRouterFragment","CURRENT_ROUTER_NAVIGATE_OPTIONS":"currentRouterNavigateOptions","CURRENT_ROUTER_SCOPE_ID":"currentRouterScopeId","BACK_TO_TITLE":"back_to_title","METADATA_CONTAINER":"metadata_container","STATE":"state","DEFAULT_STATE":"default_state","SESSION_STATE":"session_state","NAVIGATION_HISTORY_ARRAY":"navigationHistoryArray","URL_PARAMS":"urlParams","ALLOW_WIDGET_URL_PARAMS":"allowWidgetUrlParams","START_ID":"start_id","BREADCRUMB":"breadcrumb","QUERY_STRING_PARAMS":"query_string_params"}),u=0;return i.Model.extend({"constructor":function(n,s){i.Model.prototype.constructor.apply(this,arguments),0===u?this.storage=new o(e.id):(this.storage=new o(e.id+"_"+u),this.storage.destroy()),u++,this.set("enabled",!!n&&n.enabled),this._navigationHistory=[],t.values(a).forEach(function(e){var i=n?n[e]:this.storage.get(e);!i||-1===e.indexOf("Array")&&-1===e.indexOf("urlParams")||(i=t.isString(i)?JSON.parse(i):i),this.listenTo(this,"change:"+e,this._syncWithStorage.bind(this,e)),this.set(e,i)}.bind(this)),this._navigationHistory=this.get(a.NAVIGATION_HISTORY_ARRAY)||[]},"CONSTANTS":a,"_setViewStateAttribute":function(e,i,n,s){if(s||(s={}),this._getViewStateAttribute(e,i)!==n){var o=this.get(e)||{};return o=t.clone(o),void 0===n||""===n?delete o[i]:o[i]=n,s=t.omit(s,"encode"),this.set(e,o,s),this._syncWithStorageIfSilentUpdate(e,s),!0}},"_getViewStateAttribute":function(e,t,i){var n=this.get(e);if(n)return n[t]},"setViewState":function(e,t,i){if("state"!==e)return this._setViewStateAttribute(a.STATE,e,t,i);this.set(a.STATE,t,i),this._syncWithStorageIfSilentUpdate(a.STATE,i)},"getViewState":function(e,t){return this._getViewStateAttribute(a.STATE,e,t)},"setDefaultViewState":function(e,t,i){return this._setViewStateAttribute(a.DEFAULT_STATE,e,t,i)},"getDefaultViewState":function(e,t){return this._getViewStateAttribute(a.DEFAULT_STATE,e,t)},"setSessionViewState":function(e,i,n){if(n||(n={}),this.getSessionViewState(e)!==i){var s=this.get(a.SESSION_STATE)||{};return s=t.clone(s),s[e]=i,this.set(a.SESSION_STATE,s,n),this._syncWithStorageIfSilentUpdate(a.SESSION_STATE,n),!0}},"getSessionViewState":function(e){var t=this.get(a.SESSION_STATE);if(t)return t[e]},"_syncWithStorageIfSilentUpdate":function(e,t){t&&t.silent&&this._syncWithStorage(e)},"_syncWithStorage":function(e){var i=this.get(e);t.isArray(i)&&(i=JSON.stringify(i)),this.storage.set(e,i)},"getCurrentRouterName":function(){return this.get(this.CONSTANTS.CURRENT_ROUTER)},"onNavigationStarted":function(e,t){this.trigger("before:navigate"),this.set("navigated",!0);var i=this.isSameRoutingInfo(e,this.getLastHistoryEntry());t||(i=!1),this.set(this.CONSTANTS.LAST_ROUTER,this.get(this.CONSTANTS.CURRENT_ROUTER)),i?(this._currentHistoryEntry=void 0,this._restoreStatesFromHistoryEntry(this._navigationHistory.pop()),this.unset(a.NAVIGATION_HISTORY_ARRAY,{"silent":!0}),this.set(a.NAVIGATION_HISTORY_ARRAY,this._navigationHistory)):this._savePotentialHistoryEntry()},"_savePotentialHistoryEntry":function(){var e=this.storage,t=e.get(a.CURRENT_ROUTER);if(t){var i=this.get("saved_viewstate");i||(i=this.storage.get(a.STATE));var n=this.get("PerspectiveRouting").getRouter(t);this._currentHistoryEntry={"router":t,"back_to_title":this.storage.get(a.BACK_TO_TITLE),"urlParam":n&&n.urlParams,"fragment":this.storage.get(a.CURRENT_ROUTER_FRAGMENT),"scopeId":this.storage.get(a.CURRENT_ROUTER_SCOPE_ID),"navigateOptions":this.storage.get(a.CURRENT_ROUTER_NAVIGATE_OPTIONS),"state":i,"sessionState":this.storage.get(a.SESSION_STATE),"defaultState":this.storage.get(a.DEFAULT_STATE)}}},"getPotentialHistoryEntry":function(){return this._currentHistoryEntry},"onContextFetch":function(){this.trigger("navigate",this._currentHistoryEntry),this.unset("isFromHistory",{"silent":!0}),this._currentHistoryEntry&&this._addRouterInfoToHistory(this._currentHistoryEntry)},"_restoreStatesFromHistoryEntry":function(e){if(e){var t={"isFromHistory":!0,"state":e.state,"default_state":e.defaultState,"session_state":e.sessionState};this.set(t,{"silent":!0}),["state","default_state","session_state"].forEach(function(e){this._syncWithStorage(e)}.bind(this))}},"_addRouterInfoToHistory":function(e){this._navigationHistory.length>0&&JSON.stringify(e)===JSON.stringify(this._navigationHistory[this._navigationHistory.length-1])||(this._navigationHistory.push(e),this._navigationHistory.length>50&&this._navigationHistory.shift(),this.unset(a.NAVIGATION_HISTORY_ARRAY,{"silent":!0}),this.set(a.NAVIGATION_HISTORY_ARRAY,this._navigationHistory))},"_copyAttributes":function(e){Object.keys(e.attributes).forEach(function(t){this.unset(t),this.set(t,e.get(t))}.bind(this))},"saveHistory":function(){this.savedViewStateModel=this.clone(),this.savedViewStateModel._copyAttributes(this),this._resetAttributes()},"_resetAttributes":function(){this._navigationHistory=[],this.unset(a.NAVIGATION_HISTORY_ARRAY,{"silent":!0}),this.set(a.NAVIGATION_HISTORY_ARRAY,this._navigationHistory),this.set(a.LAST_ROUTER,void 0),this.set(a.CURRENT_ROUTER,void 0),this.set(a.CURRENT_ROUTER_FRAGMENT,void 0),this.set(a.CURRENT_ROUTER_NAVIGATE_OPTIONS,void 0),this.set(a.CURRENT_ROUTER_SCOPE_ID,void 0),this.set(a.BACK_TO_TITLE,void 0),this.set(a.METADATA_CONTAINER,void 0),this.set(a.STATE,void 0),this.set(a.DEFAULT_STATE,void 0),this.set(a.SESSION_STATE,void 0),this.set(a.URL_PARAMS,void 0),this.set(a.ALLOW_WIDGET_URL_PARAMS,void 0),this.set(a.SESSION_STATE,void 0),this.set(a.START_ID,void 0),this.set(a.BREADCRUMB,void 0)},"restoreHistory":function(){if(this.savedViewStateModel){this._copyAttributes(this.savedViewStateModel),this.savedViewStateModel.clean(),this.savedViewStateModel=void 0;var e=this.storage.get(a.NAVIGATION_HISTORY_ARRAY);e&&(e=JSON.parse(e),this._navigationHistory=e)}},"hasRouted":function(){return this._navigationHistory.length>0},"isSameRoutingInfo":function(e,t){return e&&t&&e.router===t.router&&e.fragment===t.fragment},"clean":function(){this.clear(),this.storage.destroy()},"getBackToTitle":function(){var e=r.back;if(this._currentHistoryEntry)e=this._currentHistoryEntry.back_to_title||e;else{var t=this.getLastRouterIndex();if(-1!==t){var i=this._navigationHistory[t];i&&(e=i.back_to_title||e)}}return e},"clearHistory":function(){this._navigationHistory=[],this.unset(a.NAVIGATION_HISTORY_ARRAY,{"silent":!0}),this.set(a.NAVIGATION_HISTORY_ARRAY,this._navigationHistory)},"clearCurrentHistoryEntry":function(){this._currentHistoryEntry=void 0},"getLastRouterIndex":function(){var e=-1,t=this._navigationHistory;if(t&&t.length>0)for(var i=t.length-1;i>=0;i--)if(t[i].router!==this.get(a.CURRENT_ROUTER)){e=i;break}return e},"getIndexOfOfLastApplicationScope":function(){var e=-1,t=this._navigationHistory;if(t&&t.length>0)for(var i=t.length-1;i>=0;i--)if(t[i].scopeId!==this.get(a.CURRENT_ROUTER_SCOPE_ID)){e=i;break}return e},"getLastHistoryEntry":function(){return this._navigationHistory&&this._navigationHistory.length>0&&this._navigationHistory[this._navigationHistory.length-1]},"getHistory":function(){return this._navigationHistory},"restoreRouterOfLastApplicationScope":function(){this._restoreHistoryEntryByIndex(this.getIndexOfOfLastApplicationScope())},"restoreLastRouter":function(){this._restoreHistoryEntryByIndex(this.getLastRouterIndex())},"restoreLastFragment":function(){this._restoreHistoryEntryByIndex(this._navigationHistory.length-1)},"restoreHistoryEntryByIndex":function(e){return this._restoreHistoryEntryByIndex(e)},"_restoreHistoryEntryByIndex":function(e){if(-1!==e&&e<this._navigationHistory.length){this._navigationHistory.length=e+1;var t=this.getLastHistoryEntry();this._restoreStatesFromHistoryEntry(t),this.get("PerspectiveRouting").restoreRouter(t)}else window.history.back()},"addUrlParameters":function(e,t,i,n){if(n||this.get(this.CONSTANTS.ALLOW_WIDGET_URL_PARAMS)){var s=this.get("PerspectiveRouting"),o=this.get("activeRouterInstance"),r=o&&o.name;return r=r||this.get(a.CURRENT_ROUTER),s&&s.addUrlParameters(r,e,i)}},"clear":function(){this.storage.destroy(),this._navigationHistory=[],this._currentHistoryEntry=void 0,i.Model.prototype.clear.call(this,{"silent":!0})},"hasNotNavigatedAndNotJustStarted":function(){}},{"CONSTANTS":a,"clean":function(){new o(e.id).destroy()}})}),csui.define("csui/utils/contexts/impl/csui.context.plugin",["csui/utils/contexts/context.plugin","csui/models/view.state.model"],function(e,t){"use strict";function i(){this.context.viewStateModel.onContextFetch()}function n(){this.context.viewStateModel.clear()}return e.extend({"constructor":function(s){e.call(this,s);var o=this.context;o.viewStateModel=new t,o.listenTo(o,"request",i.bind(this)).listenTo(o,"destroy",n.bind(this))}})}),csui.define("bundles/csui-signin",["csui/pages/signin/signin.page.view","csui/utils/authenticators/core.authenticators","csui/utils/high.contrast/detector","csui/utils/contexts/impl/csui.context.plugin"],{}),csui.require(["require","css"],function(e,t){t.styleLoad(e,"csui/bundles/csui-signin",!0)});
//# sourceMappingURL=csui-signin.js.map