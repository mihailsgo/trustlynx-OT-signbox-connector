csui.define("csui/lib/ally",[],function(){var e,t=function(){function e(t,i,n){function o(r,l){if(!i[r]){if(!t[r]){var a="function"==typeof require&&require;if(!l&&a)return a(r,!0);if(s)return s(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[r]={"exports":{}};t[r][0].call(u.exports,function(e){return o(t[r][1][e]||e)},u,u.exports,e,t,i,n)}return i[r].exports}for(var s="function"==typeof require&&require,r=0;r<n.length;r++)o(n[r]);return o}return e}()({"1":[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return e&&"object"===(void 0===e?"undefined":le(e))&&"default"in e?e.default:e}function s(){for(var e=[document.activeElement];e[0]&&e[0].shadowRoot;)e.unshift(e[0].shadowRoot.activeElement);return e}function r(){var e=ge({"context":document.activeElement});return[document.activeElement].concat(e)}function l(e){ye.some(function(t){return!!e[t]&&(xe=t,!0)})}function a(e,t){return xe||l(e),e[xe](t)}function c(){var e={"activeElement":document.activeElement,"windowScrollTop":window.scrollTop,"windowScrollLeft":window.scrollLeft,"bodyScrollTop":document.body.scrollTop,"bodyScrollLeft":document.body.scrollLeft},t=document.createElement("iframe");t.setAttribute("style","position:absolute; position:fixed; top:0; left:-2px; width:1px; height:1px; overflow:hidden;"),t.setAttribute("aria-live","off"),t.setAttribute("aria-busy","true"),t.setAttribute("aria-hidden","true"),document.body.appendChild(t);var i=t.contentWindow,n=i.document;n.open(),n.close();var o=n.createElement("div");return n.body.appendChild(o),e.iframe=t,e.wrapper=o,e.window=i,e.document=n,e}function u(e,t){e.wrapper.innerHTML="";var i="string"==typeof t.element?e.document.createElement(t.element):t.element(e.wrapper,e.document),n=t.mutate&&t.mutate(i,e.wrapper,e.document);return n||!1===n||(n=i),!i.parentNode&&e.wrapper.appendChild(i),n&&n.focus&&n.focus(),t.validate?t.validate(i,n,e.document):e.document.activeElement===n}function d(e){e.activeElement===document.body?(document.activeElement&&document.activeElement.blur&&document.activeElement.blur(),we.is.IE10&&document.body.focus()):e.activeElement&&e.activeElement.focus&&e.activeElement.focus(),document.body.removeChild(e.iframe),window.scrollTop=e.windowScrollTop,window.scrollLeft=e.windowScrollLeft,document.body.scrollTop=e.bodyScrollTop,document.body.scrollLeft=e.bodyScrollLeft}function h(e,t){if(document.hasFocus())try{window.localStorage&&window.localStorage.setItem(e,JSON.stringify(t))}catch(e){}else try{window.localStorage&&window.localStorage.removeItem(e)}catch(e){}}function p(){var e=document.createElement("div");return e.innerHTML='<svg><foreignObject width="30" height="30">\n      <input type="text"/>\n  </foreignObject></svg>',e.firstChild.firstChild}function f(e){return'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+e+"</svg>"}function m(e){if(!e.focus)try{HTMLElement.prototype.focus.call(e)}catch(t){ft(e)}}function g(e,t,i){return m(t),i.activeElement===t}function v(){var e=Fe(Et);return Object.keys(At).forEach(function(t){e[t]=At[t]()}),e}function b(e){var t=e.webkitUserModify||"";return Boolean(t&&-1!==t.indexOf("write"))}function y(e){return[e.getPropertyValue("overflow"),e.getPropertyValue("overflow-x"),e.getPropertyValue("overflow-y")].some(function(e){return"auto"===e||"scroll"===e})}function x(e){return e.display.indexOf("flex")>-1}function w(e,t,i,n){return("div"===t||"span"===t)&&(!(i&&"div"!==i&&"span"!==i&&!y(n))&&(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth))}function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=e.except,n=void 0===i?{"flexbox":!1,"scrollable":!1,"shadow":!1}:i;Dt||(Dt=Mt());var o=pe({"label":"is/focus-relevant","resolveDocument":!0,"context":t});if(!n.shadow&&o.shadowRoot)return!0;var s=o.nodeName.toLowerCase();if("input"===s&&"hidden"===o.type)return!1;if("input"===s||"select"===s||"button"===s||"textarea"===s)return!0;if("legend"===s&&Dt.focusRedirectLegend)return!0;if("label"===s)return!0;if("area"===s)return!0;if("a"===s&&o.hasAttribute("href"))return!0;if("object"===s&&o.hasAttribute("usemap"))return!1;if("object"===s){var r=o.getAttribute("type");if(!Dt.focusObjectSvg&&"image/svg+xml"===r)return!1;if(!Dt.focusObjectSwf&&"application/x-shockwave-flash"===r)return!1}if("iframe"===s||"object"===s)return!0;if("embed"===s||"keygen"===s)return!0;if(o.hasAttribute("contenteditable"))return!0;if("audio"===s&&(Dt.focusAudioWithoutControls||o.hasAttribute("controls")))return!0;if("video"===s&&(Dt.focusVideoWithoutControls||o.hasAttribute("controls")))return!0;if(Dt.focusSummary&&"summary"===s)return!0;var l=Vt(o);if("img"===s&&o.hasAttribute("usemap"))return l&&Dt.focusImgUsemapTabindex||Dt.focusRedirectImgUsemap;if(Dt.focusTable&&("table"===s||"td"===s))return!0;if(Dt.focusFieldset&&"fieldset"===s)return!0;var c="svg"===s,u=o.ownerSVGElement,d=o.getAttribute("focusable"),h=Lt(o);if("use"===s&&null!==h&&!Dt.focusSvgUseTabindex)return!1;if("foreignobject"===s)return null!==h&&Dt.focusSvgForeignobjectTabindex;if(a(o,"svg a")&&o.hasAttribute("xlink:href"))return!0;if((c||u)&&o.focus&&!Dt.focusSvgNegativeTabindexAttribute&&h<0)return!1;if(c)return l||Dt.focusSvg||Dt.focusSvgInIframe||Boolean(Dt.focusSvgFocusableAttribute&&d&&"true"===d);if(u){if(Dt.focusSvgTabindexAttribute&&l)return!0;if(Dt.focusSvgFocusableAttribute)return"true"===d}if(l)return!0;var p=window.getComputedStyle(o,null);if(b(p))return!0;if(Dt.focusImgIsmap&&"img"===s&&o.hasAttribute("ismap")){if(be({"context":o}).some(function(e){return"a"===e.nodeName.toLowerCase()&&e.hasAttribute("href")}))return!0}if(!n.scrollable&&Dt.focusScrollContainer)if(Dt.focusScrollContainerWithoutOverflow){if(w(o,s))return!0}else if(y(p))return!0;if(!n.flexbox&&Dt.focusFlexboxContainer&&x(p))return!0;var f=o.parentElement;if(!n.scrollable&&f){var m=f.nodeName.toLowerCase(),g=window.getComputedStyle(f,null);if(Dt.focusScrollBody&&w(f,s,m,g))return!0;if(Dt.focusChildrenOfFocusableFlexbox&&x(g))return!0}return!1}function k(e,t){if(e.findIndex)return e.findIndex(t);var i=e.length;if(0===i)return-1;for(var n=0;n<i;n++)if(t(e[n],n,e))return n;return-1}function _(e){if(qt||(qt=Ht("object, iframe")),void 0!==e._frameElement)return e._frameElement;e._frameElement=null;var t=e.parent.document.querySelectorAll(qt);return[].some.call(t,function(t){return Bt(t)===e.document&&(e._frameElement=t,!0)}),e._frameElement}function I(e){var t=jt(e);if(!t.parent||t.parent===t)return null;try{return t.frameElement||_(t)}catch(e){return null}}function T(e,t){return window.getComputedStyle(e,null).getPropertyValue(t)}function S(e){return e.some(function(e){return"none"===T(e,"display")})}function A(e){var t=k(e,function(e){var t=T(e,"visibility");return"hidden"===t||"collapse"===t});if(-1===t)return!1;var i=k(e,function(e){return"visible"===T(e,"visibility")});return-1===i||t<i}function E(e){var t=1;return"summary"===e[0].nodeName.toLowerCase()&&(t=2),e.slice(t).some(function(e){return"details"===e.nodeName.toLowerCase()&&!1===e.open})}function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=e.except,n=void 0===i?{"notRendered":!1,"cssDisplay":!1,"cssVisibility":!1,"detailsElement":!1,"browsingContext":!1}:i,o=pe({"label":"is/visible","resolveDocument":!0,"context":t}),s=o.nodeName.toLowerCase();if(!n.notRendered&&Wt.test(s))return!0;var r=be({"context":o}),l="audio"===s&&!o.hasAttribute("controls");if(!n.cssDisplay&&S(l?r.slice(1):r))return!1;if(!n.cssVisibility&&A(r))return!1;if(!n.detailsElement&&E(r))return!1;if(!n.browsingContext){var a=I(o),c=O.except(n);if(a&&!c(a))return!1}return!0}function M(e,t){return t.querySelector('map[name="'+ce(e)+'"]')||null}function N(e){var t=e.getAttribute("usemap");if(!t)return null;var i=ue(e);return M(t.slice(1),i)}function P(e){var t=e.parentElement;return t.name&&"map"===t.nodeName.toLowerCase()?ue(e).querySelector('img[usemap="#'+ce(t.name)+'"]')||null:null}function F(e){return"fieldset"===e.nodeName.toLowerCase()&&e.disabled}function V(e){return"form"===e.nodeName.toLowerCase()&&e.disabled}function L(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=e.except,n=void 0===i?{"onlyFocusableBrowsingContext":!1,"visible":!1}:i,o=pe({"label":"is/only-tabbable","resolveDocument":!0,"context":t});if(!n.visible&&!zt(o))return!1;if(!n.onlyFocusableBrowsingContext&&(we.is.GECKO||we.is.TRIDENT||we.is.EDGE)){var s=I(o);if(s&&Lt(s)<0)return!1}var r=o.nodeName.toLowerCase(),l=Lt(o);return"label"===r&&we.is.GECKO?null!==l&&l>=0:!!(we.is.GECKO&&o.ownerSVGElement&&!o.focus&&"a"===r&&o.hasAttribute("xlink:href")&&we.is.GECKO)}function D(e){var t=e.nodeName.toLowerCase();if("embed"===t||"keygen"===t)return!0;var i=Lt(e);if(e.shadowRoot&&null===i)return!0;if("label"===t)return!ti.focusLabelTabindex||null===i;if("legend"===t)return null===i;if(ti.focusSvgFocusableAttribute&&(e.ownerSVGElement||"svg"===t)){var n=e.getAttribute("focusable");return n&&"false"===n}return"img"===t&&e.hasAttribute("usemap")?null===i||!ti.focusImgUsemapTabindex:"area"===t&&!Kt(e)}function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=e.except,n=void 0===i?{"disabled":!1,"visible":!1,"onlyTabbable":!1}:i;ti||(ti=Mt());var o=ei.rules.except({"onlyFocusableBrowsingContext":!0,"visible":n.visible}),s=pe({"label":"is/focusable","resolveDocument":!0,"context":t});if(!Rt.rules({"context":s,"except":n})||D(s))return!1;if(!n.disabled&&Jt(s))return!1;if(!n.onlyTabbable&&o(s))return!1;if(!n.visible){var r={"context":s,"except":{}};if(ti.focusInHiddenIframe&&(r.except.browsingContext=!0),ti.focusObjectSvgHidden){"object"===s.nodeName.toLowerCase()&&(r.except.cssVisibility=!0)}if(!zt.rules(r))return!1}var l=I(s);if(l){if(!("object"!==l.nodeName.toLowerCase()||ti.focusInZeroDimensionObject||l.offsetWidth&&l.offsetHeight))return!1}return!("svg"===s.nodeName.toLowerCase()&&ti.focusSvgInIframe&&!l&&null===s.getAttribute("tabindex"))}function B(e){var t=function(t){return t.shadowRoot?NodeFilter.FILTER_ACCEPT:e(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP};return t.acceptNode=t,t}function j(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=e.includeContext,n=e.includeOnlyTabbable,o=e.strategy;t||(t=document.documentElement);for(var s=ii.rules.except({"onlyTabbable":n}),r=ue(t),l=r.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,"all"===o?ni:B(s),!1),a=[];l.nextNode();)l.currentNode.shadowRoot?(s(l.currentNode)&&a.push(l.currentNode),a=a.concat(j({"context":l.currentNode.shadowRoot,"includeOnlyTabbable":n,"strategy":o}))):a.push(l.currentNode);return i&&("all"===o?Rt(t)&&a.unshift(t):s(t)&&a.unshift(t)),a}function $(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=e.includeContext,n=e.includeOnlyTabbable,o=ri(),s=t.querySelectorAll(o),r=ii.rules.except({"onlyTabbable":n}),l=[].filter.call(s,r);return i&&r(t)&&l.unshift(t),l}function H(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=e.except,n=void 0===i?{"flexbox":!1,"scrollable":!1,"shadow":!1,"visible":!1,"onlyTabbable":!1}:i;ai||(ai=Mt());var o=pe({"label":"is/tabbable","resolveDocument":!0,"context":t});if(we.is.BLINK&&we.is.ANDROID&&we.majorVersion>42)return!1;var s=I(o);if(s){if(we.is.WEBKIT&&we.is.IOS)return!1;if(Lt(s)<0)return!1;if(!n.visible&&(we.is.BLINK||we.is.WEBKIT)&&!zt(s))return!1;if("object"===s.nodeName.toLowerCase()){var r="Chrome"===we.name&&we.majorVersion>=54||"Opera"===we.name&&we.majorVersion>=41;if(we.is.WEBKIT||we.is.BLINK&&!r)return!1}}var l=o.nodeName.toLowerCase(),c=Lt(o),u=null===c?null:c>=0;if(we.is.EDGE&&we.majorVersion>=14&&s&&o.ownerSVGElement&&c<0)return!0;var d=!1!==u,h=null!==c&&c>=0;if(o.hasAttribute("contenteditable"))return d;if(ci.test(l)&&!0!==u)return!1;if(we.is.WEBKIT&&we.is.IOS){var p="input"===l&&"text"===o.type||"password"===o.type||"select"===l||"textarea"===l||o.hasAttribute("contenteditable");if(!p){p=b(window.getComputedStyle(o,null))}if(!p)return!1}if("use"===l&&null!==c&&(we.is.BLINK||we.is.WEBKIT&&9===we.majorVersion))return!0;if(a(o,"svg a")&&o.hasAttribute("xlink:href")){if(d)return!0;if(o.focus&&!ai.focusSvgNegativeTabindexAttribute)return!0}if("svg"===l&&ai.focusSvgInIframe&&d)return!0;if(we.is.TRIDENT||we.is.EDGE){if("svg"===l)return!!ai.focusSvg||(o.hasAttribute("focusable")||h);if(o.ownerSVGElement)return!(!ai.focusSvgTabindexAttribute||!h)||o.hasAttribute("focusable")}if(void 0===o.tabIndex)return Boolean(n.onlyTabbable);if("audio"===l){if(!o.hasAttribute("controls"))return!1;if(we.is.BLINK)return!0}if("video"===l)if(o.hasAttribute("controls")){if(we.is.BLINK||we.is.GECKO)return!0}else if(we.is.TRIDENT||we.is.EDGE)return!1;if("object"===l&&(we.is.BLINK||we.is.WEBKIT))return!1;if("iframe"===l)return!1;if(!n.scrollable&&we.is.GECKO){if(y(window.getComputedStyle(o,null)))return d}if(we.is.TRIDENT||we.is.EDGE){if("area"===l){var f=P(o);if(f&&Lt(f)<0)return!1}var m=window.getComputedStyle(o,null);if(b(m))return o.tabIndex>=0;if(!n.flexbox&&x(m))return null!==c?h:ui(o)&&di(o);if(w(o,l))return!1;var g=o.parentElement;if(g){var v=g.nodeName.toLowerCase(),C=window.getComputedStyle(g,null);if(w(g,l,v,C))return!1;if(x(C))return h}}return o.tabIndex>=0}function q(e,t){return e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1}function W(e,t){return k(e,function(e){return t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING})}function z(e,t,i){var n=[];return t.forEach(function(t){var o=!0,s=e.indexOf(t);-1===s&&(s=W(e,t),o=!1),-1===s&&(s=e.length);var r=he(i?i(t):t);r.length&&n.push({"offset":s,"replace":o,"elements":r})}),n}function U(e,t){var i=0;t.sort(function(e,t){return e.offset-t.offset}),t.forEach(function(t){var n=t.replace?1:0,o=[t.offset+i,n].concat(t.elements);e.splice.apply(e,o),i+=t.elements.length-n})}function K(e){var t=e.nodeName.toLowerCase();return"input"===t||"textarea"===t||"select"===t||"button"===t}function G(e,t){var i=e.getAttribute("for");return i?t.getElementById(i):e.querySelector("input, select, textarea")}function Q(e){var t=e.parentNode;return li({"context":t,"strategy":"strict"}).filter(K)[0]||null}function Z(e,t){var i=pi({"context":t.body,"strategy":"strict"});if(!i.length)return null;var n=mi({"list":i,"elements":[e]}),o=n.indexOf(e);return o===n.length-1?null:n[o+1]}function X(e,t){return gi.focusRedirectLegend?"fieldset"!==e.parentNode.nodeName.toLowerCase()?null:"tabbable"===gi.focusRedirectLegend?Z(e,t):Q(e,t):null}function Y(e){if(!gi.focusRedirectImgUsemap)return null;var t=N(e);return t&&t.querySelector("area")||null}function J(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.parent,i=e.element,n=e.includeSelf;if(t)return function(e){return Boolean(n&&e===t||t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)};if(i)return function(e){return Boolean(n&&i===e||e.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_CONTAINED_BY)};throw new TypeError("util/compare-position#getParentComparator required either options.parent or options.element")}function ee(e){var t=e.context,i=e.filter,n=function(e){var t=J({"parent":e});return i.some(t)},o=[],s=function(e){return i.some(function(t){return e===t})?NodeFilter.FILTER_REJECT:n(e)?NodeFilter.FILTER_ACCEPT:(o.push(e),NodeFilter.FILTER_REJECT)};s.acceptNode=s;for(var r=ue(t),l=r.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,s,!1);l.nextNode(););return o}function te(e){return e.hasAttribute("autofocus")}function ie(e){return e.tabIndex<=0}function ne(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=pe({"label":"query/shadow-hosts","resolveDocument":!0,"defaultToDocument":!0,"context":t}),n=ue(t),o=n.createTreeWalker(i,NodeFilter.SHOW_ELEMENT,_i,!1),s=[];for(i.shadowRoot&&(s.push(i),s=s.concat(ne({"context":i.shadowRoot})));o.nextNode();)s.push(o.currentNode),s=s.concat(ne({"context":o.currentNode.shadowRoot}));return s}function oe(e,t){var i=e.indexOf(t);if(i>0){return e.splice(i,1).concat(e)}return e}function se(e,t){return Oi.tabsequenceAreaAtImgPosition&&(e=Ti(e,t)),e=Ei(e)}var re=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ae=o(e("platform")),ce=o(e("css.escape")),ue=function(e){return e?e.nodeType===Node.DOCUMENT_NODE?e:e.ownerDocument||document:document},de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=ue(t),n=void 0;try{n=i.activeElement}catch(e){}return n&&n.nodeType||(n=i.body||i.documentElement),n},he=function(e){if(!e)return[];if(Array.isArray(e))return e;if(void 0!==e.nodeType)return[e];if("string"==typeof e&&(e=document.querySelectorAll(e)),void 0!==e.length)return[].slice.call(e,0);throw new TypeError("unexpected input "+String(e))},pe=function(e){var t=e.context,i=e.label,n=void 0===i?"context-to-element":i,o=e.resolveDocument,s=e.defaultToDocument,r=he(t)[0];if(o&&r&&r.nodeType===Node.DOCUMENT_NODE&&(r=r.documentElement),!r&&s)return document.documentElement;if(!r)throw new TypeError(n+" requires valid options.context");if(r.nodeType!==Node.ELEMENT_NODE&&r.nodeType!==Node.DOCUMENT_FRAGMENT_NODE)throw new TypeError(n+" requires options.context to be an Element");return r},fe=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=pe({"label":"get/shadow-host","context":t}),n=null;i;)n=i,i=i.parentNode;return n.nodeType===n.DOCUMENT_FRAGMENT_NODE&&n.host?n.host:null},me=function(e){var t=pe({"label":"is/shadowed","resolveDocument":!0,"context":e});return Boolean(fe({"context":t}))},ge=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=[],n=pe({"label":"get/shadow-host-parents","context":t});n&&(n=fe({"context":n}));)i.push(n);return i},ve=function(){return null===document.activeElement&&document.body.focus(),me(document.activeElement)?r():s()},be=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=[],n=pe({"label":"get/parents","context":t});n;)i.push(n),(n=n.parentNode)&&n.nodeType!==Node.ELEMENT_NODE&&(n=null);return i},ye=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector"],xe=null,we=JSON.parse(JSON.stringify(ae)),Ce=we.os.family||"",ke="Android"===Ce,_e="Windows"===Ce.slice(0,7),Ie="OS X"===Ce,Te="iOS"===Ce,Se="Blink"===we.layout,Ae="Gecko"===we.layout,Ee="Trident"===we.layout,Oe="EdgeHTML"===we.layout,Me="WebKit"===we.layout,Ne=parseFloat(we.version),Pe=Math.floor(Ne);we.majorVersion=Pe,we.is={"ANDROID":ke,"WINDOWS":_e,"OSX":Ie,"IOS":Te,"BLINK":Se,"GECKO":Ae,"TRIDENT":Ee,"EDGE":Oe,"WEBKIT":Me,"IE9":Ee&&9===Pe,"IE10":Ee&&10===Pe,"IE11":Ee&&11===Pe};var Fe=function(e){var t=c(),i={};return Object.keys(e).map(function(n){i[n]=u(t,e[n])}),d(t),i},Ve="undefined"!=typeof window&&window.navigator.userAgent||"",Le=function(e){var t=void 0;try{t=window.localStorage&&window.localStorage.getItem(e),t=t?JSON.parse(t):{}}catch(e){t={}}return t}("ally-supports-cache");Le.userAgent===Ve&&"1.4.1"===Le.version||(Le={}),Le.userAgent=Ve,Le.version="1.4.1";var De={"get":function(){return Le},"set":function(e){Object.keys(e).forEach(function(t){Le[t]=e[t]}),Le.time=(new Date).toISOString(),h("ally-supports-cache",Le)}},Re=function(){var e=void 0;try{document.querySelector("html >>> :first-child"),e=">>>"}catch(t){try{document.querySelector("html /deep/ :first-child"),e="/deep/"}catch(t){e=""}}return e},Be="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",je={"element":"div","mutate":function(e){return e.innerHTML='<map name="image-map-tabindex-test"><area shape="rect" coords="63,19,144,45"></map><img usemap="#image-map-tabindex-test" tabindex="-1" alt="" src="'+Be+'">',e.querySelector("area")}},$e={"element":"div","mutate":function(e){return e.innerHTML='<map name="image-map-tabindex-test"><area href="#void" tabindex="-1" shape="rect" coords="63,19,144,45"></map><img usemap="#image-map-tabindex-test" alt="" src="'+Be+'">',!1},"validate":function(e,t,i){if(we.is.GECKO)return!0;var n=e.querySelector("area");return n.focus(),i.activeElement===n}},He={"element":"div","mutate":function(e){return e.innerHTML='<map name="image-map-area-href-test"><area shape="rect" coords="63,19,144,45"></map><img usemap="#image-map-area-href-test" alt="" src="'+Be+'">',e.querySelector("area")},"validate":function(e,t,i){return!!we.is.GECKO||i.activeElement===t}},qe={"name":"can-focus-audio-without-controls","element":"audio","mutate":function(e){try{e.setAttribute("src",Be)}catch(e){}}},We={"element":"div","mutate":function(e){return e.innerHTML='<map name="broken-image-map-test"><area href="#void" shape="rect" coords="63,19,144,45"></map><img usemap="#broken-image-map-test" alt="" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ">',e.querySelector("area")}},ze={"element":"div","mutate":function(e){return e.setAttribute("tabindex","-1"),e.setAttribute("style","display: -webkit-flex; display: -ms-flexbox; display: flex;"),e.innerHTML='<span style="display: block;">hello</span>',e.querySelector("span")}},Ue={"element":"fieldset","mutate":function(e){e.setAttribute("tabindex",0),e.setAttribute("disabled","disabled")}},Ke={"element":"fieldset","mutate":function(e){e.innerHTML="<legend>legend</legend><p>content</p>"}},Ge={"element":"span","mutate":function(e){e.setAttribute("style","display: -webkit-flex; display: -ms-flexbox; display: flex;"),e.innerHTML='<span style="display: block;">hello</span>'}},Qe={"element":"form","mutate":function(e){e.setAttribute("tabindex",0),e.setAttribute("disabled","disabled")}},Ze={"element":"a","mutate":function(e){return e.href="#void",e.innerHTML='<img ismap src="'+Be+'" alt="">',e.querySelector("img")}},Xe={"element":"div","mutate":function(e){return e.innerHTML='<map name="image-map-tabindex-test"><area href="#void" shape="rect" coords="63,19,144,45"></map><img usemap="#image-map-tabindex-test" tabindex="-1" alt="" src="'+Be+'">',e.querySelector("img")}},Ye={"element":function(e,t){var i=t.createElement("iframe");e.appendChild(i);var n=i.contentWindow.document;return n.open(),n.close(),i},"mutate":function(e){e.style.visibility="hidden";var t=e.contentWindow.document,i=t.createElement("input");return t.body.appendChild(i),i},"validate":function(e){var t=e.contentWindow.document,i=t.querySelector("input");return t.activeElement===i}},Je=!we.is.WEBKIT,et=function(){return Je},tt={"element":"div","mutate":function(e){e.setAttribute("tabindex","invalid-value")}},it={"element":"label","mutate":function(e){e.setAttribute("tabindex","-1")},"validate":function(e,t,i){e.offsetHeight;return e.focus(),i.activeElement===e}},nt="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBpZD0ic3ZnIj48dGV4dCB4PSIxMCIgeT0iMjAiIGlkPSJzdmctbGluay10ZXh0Ij50ZXh0PC90ZXh0Pjwvc3ZnPg==",ot={"element":"object","mutate":function(e){e.setAttribute("type","image/svg+xml"),e.setAttribute("data",nt),e.setAttribute("width","200"),e.setAttribute("height","50"),e.style.visibility="hidden"}},st={"name":"can-focus-object-svg","element":"object","mutate":function(e){e.setAttribute("type","image/svg+xml"),e.setAttribute("data",nt),e.setAttribute("width","200"),e.setAttribute("height","50")},"validate":function(e,t,i){return!!we.is.GECKO||i.activeElement===e}},rt=!we.is.IE9,lt=function(){return rt},at={"element":"div","mutate":function(e){return e.innerHTML='<map name="focus-redirect-img-usemap"><area href="#void" shape="rect" coords="63,19,144,45"></map><img usemap="#focus-redirect-img-usemap" alt="" src="'+Be+'">',e.querySelector("img")},"validate":function(e,t,i){var n=e.querySelector("area");return i.activeElement===n}},ct={"element":"fieldset","mutate":function(e){return e.innerHTML='<legend>legend</legend><input tabindex="-1"><input tabindex="0">',!1},"validate":function(e,t,i){var n=e.querySelector('input[tabindex="-1"]'),o=e.querySelector('input[tabindex="0"]');return e.focus(),e.querySelector("legend").focus(),i.activeElement===n&&"focusable"||i.activeElement===o&&"tabbable"||""}},ut={"element":"div","mutate":function(e){return e.setAttribute("style","width: 100px; height: 50px; overflow: auto;"),e.innerHTML='<div style="width: 500px; height: 40px;">scrollable content</div>',e.querySelector("div")}},dt={"element":"div","mutate":function(e){e.setAttribute("style","width: 100px; height: 50px;"),e.innerHTML='<div style="width: 500px; height: 40px;">scrollable content</div>'}},ht={"element":"div","mutate":function(e){e.setAttribute("style","width: 100px; height: 50px; overflow: auto;"),e.innerHTML='<div style="width: 500px; height: 40px;">scrollable content</div>'}},pt={"element":"details","mutate":function(e){return e.innerHTML="<summary>foo</summary><p>content</p>",e.firstElementChild}},ft=function(e){if(!e.ownerSVGElement&&"svg"!==e.nodeName.toLowerCase())return!1;var t=p();e.appendChild(t);var i=t.querySelector("input");return i.focus(),i.disabled=!0,e.removeChild(t),!0},mt={"element":"div","mutate":function(e){return e.innerHTML=f('<text focusable="true">a</text>'),e.querySelector("text")},"validate":g},gt={"element":"div","mutate":function(e){return e.innerHTML=f('<text tabindex="0">a</text>'),e.querySelector("text")},"validate":g},vt={"element":"div","mutate":function(e){return e.innerHTML=f('<text tabindex="-1">a</text>'),e.querySelector("text")},"validate":g},bt={"element":"div","mutate":function(e){return e.innerHTML=f(['<g id="ally-test-target"><a xlink:href="#void"><text>link</text></a></g>','<use xlink:href="#ally-test-target" x="0" y="0" tabindex="-1" />'].join("")),e.querySelector("use")},"validate":g},yt={"element":"div","mutate":function(e){return e.innerHTML=f('<foreignObject tabindex="-1"><input type="text" /></foreignObject>'),e.querySelector("foreignObject")||e.getElementsByTagName("foreignObject")[0]},"validate":g},xt=Boolean(we.is.GECKO&&"undefined"!=typeof SVGElement&&SVGElement.prototype.focus),wt=function(){return xt},Ct={"element":"div","mutate":function(e){return e.innerHTML=f(""),e.firstChild},"validate":g},kt={"element":"div","mutate":function(e){e.setAttribute("tabindex","3x")}},_t={"element":"table","mutate":function(e,t,i){var n=i.createDocumentFragment();n.innerHTML="<tr><td>cell</td></tr>",e.appendChild(n)}},It={"element":"video","mutate":function(e){try{e.setAttribute("src",Be)}catch(e){}}},Tt=we.is.GECKO||we.is.TRIDENT||we.is.EDGE,St=function(){return Tt},At={"cssShadowPiercingDeepCombinator":Re,"focusInZeroDimensionObject":et,"focusObjectSwf":lt,"focusSvgInIframe":wt,"tabsequenceAreaAtImgPosition":St},Et={"focusAreaImgTabindex":je,"focusAreaTabindex":$e,"focusAreaWithoutHref":He,"focusAudioWithoutControls":qe,"focusBrokenImageMap":We,"focusChildrenOfFocusableFlexbox":ze,"focusFieldsetDisabled":Ue,"focusFieldset":Ke,"focusFlexboxContainer":Ge,"focusFormDisabled":Qe,"focusImgIsmap":Ze,"focusImgUsemapTabindex":Xe,"focusInHiddenIframe":Ye,"focusInvalidTabindex":tt,"focusLabelTabindex":it,"focusObjectSvg":st,"focusObjectSvgHidden":ot,"focusRedirectImgUsemap":at,"focusRedirectLegend":ct,"focusScrollBody":ut,"focusScrollContainerWithoutOverflow":dt,"focusScrollContainer":ht,"focusSummary":pt,"focusSvgFocusableAttribute":mt,"focusSvgTabindexAttribute":gt,"focusSvgNegativeTabindexAttribute":vt,"focusSvgUseTabindex":bt,"focusSvgForeignobjectTabindex":yt,"focusSvg":Ct,"focusTabindexTrailingCharacters":kt,"focusTable":_t,"focusVideoWithoutControls":It},Ot=null,Mt=function(){return Ot||(Ot=De.get(),Ot.time||(De.set(v()),Ot=De.get()),Ot)},Nt=void 0,Pt=/^\s*(-|\+)?[0-9]+\s*$/,Ft=/^\s*(-|\+)?[0-9]+.*$/,Vt=function(e){Nt||(Nt=Mt());var t=Nt.focusTabindexTrailingCharacters?Ft:Pt,i=pe({"label":"is/valid-tabindex","resolveDocument":!0,"context":e}),n=i.hasAttribute("tabindex"),o=i.hasAttribute("tabIndex");if(!n&&!o)return!1;if((i.ownerSVGElement||"svg"===i.nodeName.toLowerCase())&&!Nt.focusSvgTabindexAttribute)return!1;if(Nt.focusInvalidTabindex)return!0;var s=i.getAttribute(n?"tabindex":"tabIndex");return"-32768"!==s&&Boolean(s&&t.test(s))},Lt=function(e){if(!Vt(e))return null;var t=e.hasAttribute("tabindex"),i=t?"tabindex":"tabIndex",n=parseInt(e.getAttribute(i),10);return isNaN(n)?-1:n},Dt=void 0;C.except=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(t){return C({"context":t,"except":e})};return t.rules=C,t};var Rt=C.except({}),Bt=function(e){try{return e.contentDocument||e.contentWindow&&e.contentWindow.document||e.getSVGDocument&&e.getSVGDocument()||null}catch(e){return null}},jt=function(e){return ue(e).defaultView||window},$t=void 0,Ht=function(e){if("string"!=typeof $t){var t=Re();t&&($t=", html "+t+" ")}return $t?e+$t+e.replace(/\s*,\s*/g,",").split(",").join($t):e},qt=void 0,Wt=/^(area)$/;O.except=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(t){return O({"context":t,"except":e})};return t.rules=O,t};var zt=O.except({}),Ut=void 0,Kt=function(e){Ut||(Ut=Mt());var t=pe({"label":"is/valid-area","context":e});if("area"!==t.nodeName.toLowerCase())return!1;var i=t.hasAttribute("tabindex");if(!Ut.focusAreaTabindex&&i)return!1;var n=P(t);return!(!n||!zt(n))&&(!(!Ut.focusBrokenImageMap&&(!n.complete||!n.naturalHeight||n.offsetWidth<=0||n.offsetHeight<=0))&&(Ut.focusAreaWithoutHref||t.href?!be({"context":n}).slice(1).some(function(e){var t=e.nodeName.toLowerCase();return"button"===t||"a"===t}):Ut.focusAreaTabindex&&i||Ut.focusAreaImgTabindex&&n.hasAttribute("tabindex")))},Gt=void 0,Qt=void 0,Zt={"input":!0,"select":!0,"textarea":!0,"button":!0,"fieldset":!0,"form":!0},Xt=function(e){Gt||(Gt=Mt(),Gt.focusFieldsetDisabled&&delete Zt.fieldset,Gt.focusFormDisabled&&delete Zt.form,Qt=new RegExp("^("+Object.keys(Zt).join("|")+")$"));var t=pe({"label":"is/native-disabled-supported","context":e}),i=t.nodeName.toLowerCase();return Boolean(Qt.test(i))},Yt=void 0,Jt=function(e){Yt||(Yt=Mt());var t=pe({"label":"is/disabled","context":e});if(t.hasAttribute("data-ally-disabled"))return!0;if(!Xt(t))return!1;if(t.disabled)return!0;var i=be({"context":t});return!!i.some(F)||!(Yt.focusFormDisabled||!i.some(V))};L.except=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(t){return L({"context":t,"except":e})};return t.rules=L,t};var ei=L.except({}),ti=void 0;R.except=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(t){return R({"context":t,"except":e})};return t.rules=R,t};var ii=R.except({}),ni=B(Rt),oi=void 0,si=void 0,ri=function(){return oi||(oi=Mt()),"string"==typeof si?si:(si=(oi.focusTable?"table, td,":"")+(oi.focusFieldset?"fieldset,":"")+"svg a,a[href],area[href],input, select, textarea, button,iframe, object, embed,keygen,"+(oi.focusAudioWithoutControls?"audio,":"audio[controls],")+(oi.focusVideoWithoutControls?"video,":"video[controls],")+(oi.focusSummary?"summary,":"")+"[tabindex],[contenteditable]",si=Ht(si))},li=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=e.includeContext,n=e.includeOnlyTabbable,o=e.strategy,s=void 0===o?"quick":o,r=pe({"label":"query/focusable","resolveDocument":!0,"defaultToDocument":!0,"context":t}),l={"context":r,"includeContext":i,"includeOnlyTabbable":n,"strategy":s};if("quick"===s)return $(l);if("strict"===s||"all"===s)return j(l);throw new TypeError('query/focusable requires option.strategy to be one of ["quick", "strict", "all"]')},ai=void 0,ci=/^(fieldset|table|td|body)$/;H.except=function(){
var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(t){return H({"context":t,"except":e})};return t.rules=H,t};var ui=Rt.rules.except({"flexbox":!0}),di=H.except({"flexbox":!0}),hi=H.except({}),pi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=e.includeContext,n=e.includeOnlyTabbable,o=e.strategy,s=hi.rules.except({"onlyTabbable":n});return li({"context":t,"includeContext":i,"includeOnlyTabbable":n,"strategy":o}).filter(s)},fi=function(e){return e.sort(q)},mi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.list,i=e.elements,n=e.resolveElement,o=t.slice(0),s=he(i).slice(0);return fi(s),U(o,z(o,s,n)),o},gi=void 0,vi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=e.skipFocusable;gi||(gi=Mt());var n=pe({"label":"get/focus-redirect-target","context":t});if(!i&&ii(n))return null;var o=n.nodeName.toLowerCase(),s=ue(n);return"label"===o?G(n,s):"legend"===o?X(n,s):"img"===o?Y(n):null},bi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=e.except,n=pe({"label":"get/focus-target","context":t}),o=null,s=function(e){return ii.rules({"context":e,"except":i})?(o=e,!0):(o=vi({"context":e,"skipFocusable":!0}),Boolean(o))};return s(n)?o:(be({"context":n}).slice(1).some(s),o)},yi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=e.filter;if(t=pe({"label":"get/insignificant-branches","defaultToDocument":!0,"context":t}),i=he(i),!i.length)throw new TypeError("get/insignificant-branches requires valid options.filter");return ee({"context":t,"filter":i})},xi={"activeElement":de,"activeElements":ve,"focusRedirectTarget":vi,"focusTarget":bi,"insignificantBranches":yi,"parents":be,"shadowHostParents":ge,"shadowHost":fe},wi=function(e){var t=pe({"label":"is/active-element","resolveDocument":!0,"context":e});if(ue(t).activeElement===t)return!0;var i=fe({"context":t});return!(!i||i.shadowRoot.activeElement!==t)},Ci={"activeElement":wi,"disabled":Jt,"focusRelevant":Rt,"focusable":ii,"onlyTabbable":ei,"shadowed":me,"tabbable":hi,"validArea":Kt,"validTabindex":Vt,"visible":zt},ki=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=e.sequence,n=e.strategy,o=e.ignoreAutofocus,s=e.defaultToContext,r=e.includeOnlyTabbable,l=-1;i||(t=he(t||document.body)[0],i=pi({"context":t,"includeOnlyTabbable":r,"strategy":n})),i.length&&!o&&(l=k(i,te)),i.length&&-1===l&&(l=k(i,ie));var a=ii.rules.except({"onlyTabbable":r});return-1===l&&s&&t&&a(t)?t:i[l]||null},_i=function(e){return e.shadowRoot?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP};_i.acceptNode=_i;var Ii=function(){function e(t){n(this,e),this._document=ue(t),this.maps={}}return re(e,[{"key":"getAreasFor","value":function(e){return this.maps[e]||this.addMapByName(e),this.maps[e]}},{"key":"addMapByName","value":function(e){var t=M(e,this._document);t&&(this.maps[t.name]=pi({"context":t}))}},{"key":"extractAreasFromList","value":function(e){return e.filter(function(e){if("area"!==e.nodeName.toLowerCase())return!0;var t=e.parentNode;return this.maps[t.name]||(this.maps[t.name]=[]),this.maps[t.name].push(e),!1},this)}}]),e}(),Ti=function(e,t){var i=t.querySelectorAll("img[usemap]"),n=new Ii(t),o=n.extractAreasFromList(e);return i.length?mi({"list":o,"elements":i,"resolveElement":function(e){var t=e.getAttribute("usemap").slice(1);return n.getAreasFor(t)}}):o},Si=function(){function e(t,i){n(this,e),this.context=t,this.sortElements=i,this.hostCounter=1,this.inHost={},this.inDocument=[],this.hosts={},this.elements={}}return re(e,[{"key":"_registerHost","value":function(e){if(!e._sortingId){e._sortingId="shadow-"+this.hostCounter++,this.hosts[e._sortingId]=e;var t=fe({"context":e});t?(this._registerHost(t),this._registerHostParent(e,t)):this.inDocument.push(e)}}},{"key":"_registerHostParent","value":function(e,t){this.inHost[t._sortingId]||(this.inHost[t._sortingId]=[]),this.inHost[t._sortingId].push(e)}},{"key":"_registerElement","value":function(e,t){this.elements[t._sortingId]||(this.elements[t._sortingId]=[]),this.elements[t._sortingId].push(e)}},{"key":"extractElements","value":function(e){return e.filter(function(e){var t=fe({"context":e});return!t||(this._registerHost(t),this._registerElement(e,t),!1)},this)}},{"key":"sort","value":function(e){var t=this._injectHosts(e);return t=this._replaceHosts(t),this._cleanup(),t}},{"key":"_injectHosts","value":function(e){return Object.keys(this.hosts).forEach(function(e){var t=this.elements[e],i=this.inHost[e],n=this.hosts[e].shadowRoot;this.elements[e]=this._merge(t,i,n)},this),this._merge(e,this.inDocument,this.context)}},{"key":"_merge","value":function(e,t,i){var n=mi({"list":e,"elements":t});return this.sortElements(n,i)}},{"key":"_replaceHosts","value":function(e){return mi({"list":e,"elements":this.inDocument,"resolveElement":this._resolveHostElement.bind(this)})}},{"key":"_resolveHostElement","value":function(e){var t=mi({"list":this.elements[e._sortingId],"elements":this.inHost[e._sortingId],"resolveElement":this._resolveHostElement.bind(this)}),i=Lt(e);return null!==i&&i>-1?[e].concat(t):t}},{"key":"_cleanup","value":function(){Object.keys(this.hosts).forEach(function(e){delete this.hosts[e]._sortingId},this)}}]),e}(),Ai=function(e,t,i){var n=new Si(t,i),o=n.extractElements(e);return o.length===e.length?i(e):n.sort(o)},Ei=function(e){var t={},i=[],n=e.filter(function(e){var n=e.tabIndex;return void 0===n&&(n=Lt(e)),n<=0||null===n||void 0===n||(t[n]||(t[n]=[],i.push(n)),t[n].push(e),!1)});return i.sort().map(function(e){return t[e]}).reduceRight(function(e,t){return t.concat(e)},n)},Oi=void 0,Mi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.context,i=e.includeContext,n=e.includeOnlyTabbable,o=e.strategy;Oi||(Oi=Mt());var s=he(t)[0]||document.documentElement,r=pi({"context":s,"includeContext":i,"includeOnlyTabbable":n,"strategy":o});return r=document.body.createShadowRoot&&we.is.BLINK?Ai(r,s,se):se(r,s),i&&(r=oe(r,s)),r},Ni={"firstTabbable":ki,"focusable":li,"shadowHosts":ne,"tabbable":pi,"tabsequence":Mi},Pi="undefined"!=typeof window&&window.ally,Fi={"get":xi,"is":Ci,"query":Ni,"noConflict":function(){return"undefined"!=typeof window&&window.ally===this&&(window.ally=Pi),this}};t.exports=Fi},{"css.escape":2,"platform":3}],"2":[function(t,i,n){(function(t){!function(t,o){"object"==typeof n?i.exports=o(t):"function"==typeof e&&e.amd?e([],o.bind(t,t)):o(t)}(void 0!==t?t:this,function(e){if(e.CSS&&e.CSS.escape)return e.CSS.escape;var t=function(e){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var t,i=String(e),n=i.length,o=-1,s="",r=i.charCodeAt(0);++o<n;)t=i.charCodeAt(o),s+=0!=t?t>=1&&t<=31||127==t||0==o&&t>=48&&t<=57||1==o&&t>=48&&t<=57&&45==r?"\\"+t.toString(16)+" ":(0!=o||1!=n||45!=t)&&(t>=128||45==t||95==t||t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122)?i.charAt(o):"\\"+i.charAt(o):"\ufffd";return s};return e.CSS||(e.CSS={}),e.CSS.escape=t,t})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],"3":[function(t,i,n){(function(t){(function(){"use strict";function o(e){return e=String(e),e.charAt(0).toUpperCase()+e.slice(1)}function s(e,t,i){var n={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&i&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(n=n[/[\d.]+$/.exec(e)])&&(e="Windows "+n),e=String(e),t&&i&&(e=e.replace(RegExp(t,"i"),i)),e=l(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}function r(e,t){var i=-1,n=e?e.length:0;if("number"==typeof n&&n>-1&&n<=w)for(;++i<n;)t(e[i],i,e);else a(e,t)}function l(e){return e=p(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:o(e)}function a(e,t){for(var i in e)I.call(e,i)&&t(e[i],i,e)}function c(e){return null==e?o(e):T.call(e).slice(8,-1)}function u(e,t){var i=null!=e?typeof e[t]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(i)||"object"==i&&!e[t])}function d(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function h(e,t){var i=null;return r(e,function(n,o){i=t(i,n,o,e)}),i}function p(e){return String(e).replace(/^ +| +$/g,"")}function f(e){function t(t){return h(t,function(t,i){var n=i.pattern||d(i);return!t&&(t=RegExp("\\b"+n+" *\\d+[.\\w_]*","i").exec(e)||RegExp("\\b"+n+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(e))&&((t=String(i.label&&!RegExp(n,"i").test(i.label)?i.label:t).split("/"))[1]&&!/[\d.]+/.test(t[0])&&(t[0]+=" "+t[1]),i=i.label||i,t=l(t[0].replace(RegExp(n,"i"),i).replace(RegExp("; *(?:"+i+"[_-])?","i")," ").replace(RegExp("("+i+")[-_.]?(\\w)","i"),"$1 $2"))),t})}function i(){return this.description||""}var n=g,o=e&&"object"==typeof e&&"String"!=c(e);o&&(n=e,e=null);var r=n.navigator||{},m=r.userAgent||"";e||(e=m);var b,y,x=o||k==v,w=o?!!r.likeChrome:/\bChrome\b/.test(e)&&!/internal|\n/i.test(T.toString()),_=o?"Object":"ScriptBridgingProxyObject",I=o?"Object":"Environment",S=o&&n.java?"JavaPackage":c(n.java),A=o?"Object":"RuntimeObject",E=/\bJava/.test(S)&&n.java,O=E&&c(n.environment)==I,M=E?"a":"\u03b1",N=E?"b":"\u03b2",P=n.document||{},F=n.operamini||n.opera,V=C.test(V=o&&F?F["[[Class]]"]:c(F))?V:F=null,L=e,D=[],R=null,B=e==m,j=B&&F&&"function"==typeof F.version&&F.version(),$=function(t){return h(t,function(t,i){return t||RegExp("\\b"+(i.pattern||d(i))+"\\b","i").exec(e)&&(i.label||i)})}([{"label":"EdgeHTML","pattern":"Edge"},"Trident",{"label":"WebKit","pattern":"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),H=function(t){return h(t,function(t,i){return t||RegExp("\\b"+(i.pattern||d(i))+"\\b","i").exec(e)&&(i.label||i)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{"label":"Microsoft Edge","pattern":"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt","SeaMonkey",{"label":"Silk","pattern":"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{"label":"SRWare Iron","pattern":"Iron"},"Sunrise","Swiftfox","WebPositive","Opera Mini",{"label":"Opera Mini","pattern":"OPiOS"},"Opera",{"label":"Opera","pattern":"OPR"},"Chrome",{"label":"Chrome Mobile","pattern":"(?:CriOS|CrMo)"},{"label":"Firefox","pattern":"(?:Firefox|Minefield)"},{"label":"Firefox for iOS","pattern":"FxiOS"},{"label":"IE","pattern":"IEMobile"},{"label":"IE","pattern":"MSIE"},"Safari"]),q=t([{"label":"BlackBerry","pattern":"BB10"},"BlackBerry",{"label":"Galaxy S","pattern":"GT-I9000"},{"label":"Galaxy S2","pattern":"GT-I9100"},{"label":"Galaxy S3","pattern":"GT-I9300"},{"label":"Galaxy S4","pattern":"GT-I9500"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{"label":"Kindle Fire","pattern":"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation 3","PlayStation 4","PlayStation Vita","TouchPad","Transformer",{"label":"Wii U","pattern":"WiiU"},"Wii","Xbox One",{"label":"Xbox 360","pattern":"Xbox"},"Xoom"]),W=function(t){return h(t,function(t,i,n){return t||(i[q]||i[/^[a-z]+(?: +[a-z]+\b)*/i.exec(q)]||RegExp("\\b"+d(n)+"(?:\\b|\\w*\\d)","i").exec(e))&&n})}({"Apple":{"iPad":1,"iPhone":1,"iPod":1},"Archos":{},"Amazon":{"Kindle":1,"Kindle Fire":1},"Asus":{"Transformer":1},"Barnes & Noble":{"Nook":1},"BlackBerry":{"PlayBook":1},"Google":{"Google TV":1,"Nexus":1},"HP":{"TouchPad":1},"HTC":{},"LG":{},"Microsoft":{"Xbox":1,"Xbox One":1},"Motorola":{"Xoom":1},"Nintendo":{"Wii U":1,"Wii":1},"Nokia":{"Lumia":1},"Samsung":{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},"Sony":{"PlayStation 4":1,"PlayStation 3":1,"PlayStation Vita":1}}),z=function(t){return h(t,function(t,i){var n=i.pattern||d(i);return!t&&(t=RegExp("\\b"+n+"(?:/[\\d.]+|[ \\w.]*)","i").exec(e))&&(t=s(t,n,i.label||i)),t})}(["Windows Phone","Android","CentOS",{"label":"Chrome OS","pattern":"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);if($&&($=[$]),W&&!q&&(q=t([W])),(b=/\bGoogle TV\b/.exec(q))&&(q=b[0]),/\bSimulator\b/i.test(e)&&(q=(q?q+" ":"")+"Simulator"),"Opera Mini"==H&&/\bOPiOS\b/.test(e)&&D.push("running in Turbo/Uncompressed mode"),"IE"==H&&/\blike iPhone OS\b/.test(e)?(b=f(e.replace(/like iPhone OS/,"")),W=b.manufacturer,q=b.product):/^iP/.test(q)?(H||(H="Safari"),z="iOS"+((b=/ OS ([\d_]+)/i.exec(e))?" "+b[1].replace(/_/g,"."):"")):"Konqueror"!=H||/buntu/i.test(z)?W&&"Google"!=W&&(/Chrome/.test(H)&&!/\bMobile Safari\b/i.test(e)||/\bVita\b/.test(q))||/\bAndroid\b/.test(z)&&/^Chrome/.test(H)&&/\bVersion\//i.test(e)?(H="Android Browser",z=/\bAndroid\b/.test(z)?z:"Android"):"Silk"==H?(/\bMobi/i.test(e)||(z="Android",D.unshift("desktop mode")),/Accelerated *= *true/i.test(e)&&D.unshift("accelerated")):"PaleMoon"==H&&(b=/\bFirefox\/([\d.]+)\b/.exec(e))?D.push("identifying as Firefox "+b[1]):"Firefox"==H&&(b=/\b(Mobile|Tablet|TV)\b/i.exec(e))?(z||(z="Firefox OS"),q||(q=b[1])):H&&!(b=!/\bMinefield\b/i.test(e)&&/\b(?:Firefox|Safari)\b/.exec(H))||(H&&!q&&/[\/,]|^[^(]+?\)/.test(e.slice(e.indexOf(b+"/")+8))&&(H=null),(b=q||W||z)&&(q||W||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(z))&&(H=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(z)?z:b)+" Browser")):z="Kubuntu",j||(j=function(t){return h(t,function(t,i){return t||(RegExp(i+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(e)||0)[1]||null})}(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|Silk(?!/[\\d.]+$))","Version",d(H),"(?:Firefox|Minefield|NetFront)"])),(b="iCab"==$&&parseFloat(j)>3&&"WebKit"||/\bOpera\b/.test(H)&&(/\bOPR\b/.test(e)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(e)&&!/^(?:Trident|EdgeHTML)$/.test($)&&"WebKit"||!$&&/\bMSIE\b/i.test(e)&&("Mac OS"==z?"Tasman":"Trident")||"WebKit"==$&&/\bPlayStation\b(?! Vita\b)/i.test(H)&&"NetFront")&&($=[b]),"IE"==H&&(b=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(e)||0)[1])?(H+=" Mobile",z="Windows Phone "+(/\+$/.test(b)?b:b+".x"),D.unshift("desktop mode")):/\bWPDesktop\b/i.test(e)?(H="IE Mobile",z="Windows Phone 8.x",D.unshift("desktop mode"),j||(j=(/\brv:([\d.]+)/.exec(e)||0)[1])):"IE"!=H&&"Trident"==$&&(b=/\brv:([\d.]+)/.exec(e))&&(H&&D.push("identifying as "+H+(j?" "+j:"")),H="IE",j=b[1]),B){if(u(n,"global"))if(E&&(b=E.lang.System,L=b.getProperty("os.arch"),z=z||b.getProperty("os.name")+" "+b.getProperty("os.version")),x&&u(n,"system")&&(b=[n.system])[0]){z||(z=b[0].os||null);try{b[1]=n.require("ringo/engine").version,j=b[1].join("."),H="RingoJS"}catch(e){b[0].global.system==n.system&&(H="Narwhal")}}else"object"==typeof n.process&&!n.process.browser&&(b=n.process)?(H="Node.js",L=b.arch,z=b.platform,j=/[\d.]+/.exec(b.version)[0]):O&&(H="Rhino");else c(b=n.runtime)==_?(H="Adobe AIR",z=b.flash.system.Capabilities.os):c(b=n.phantom)==A?(H="PhantomJS",j=(b=b.version||null)&&b.major+"."+b.minor+"."+b.patch):"number"==typeof P.documentMode&&(b=/\bTrident\/(\d+)/i.exec(e))&&(j=[j,P.documentMode],(b=+b[1]+4)!=j[1]&&(D.push("IE "+j[1]+" mode"),$&&($[1]=""),j[1]=b),j="IE"==H?String(j[1].toFixed(1)):j[0]);z=z&&l(z)}j&&(b=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(j)||/(?:alpha|beta)(?: ?\d)?/i.exec(e+";"+(B&&r.appMinorVersion))||/\bMinefield\b/i.test(e)&&"a")&&(R=/b/i.test(b)?"beta":"alpha",j=j.replace(RegExp(b+"\\+?$"),"")+("beta"==R?N:M)+(/\d+\+?/.exec(b)||"")),"Fennec"==H||"Firefox"==H&&/\b(?:Android|Firefox OS)\b/.test(z)?H="Firefox Mobile":"Maxthon"==H&&j?j=j.replace(/\.[\d.]+/,".x"):/\bXbox\b/i.test(q)?(z=null,"Xbox 360"==q&&/\bIEMobile\b/.test(e)&&D.unshift("mobile mode")):!/^(?:Chrome|IE|Opera)$/.test(H)&&(!H||q||/Browser|Mobi/.test(H))||"Windows CE"!=z&&!/Mobi/i.test(e)?"IE"==H&&B&&null===n.external?D.unshift("platform preview"):(/\bBlackBerry\b/.test(q)||/\bBB10\b/.test(e))&&(b=(RegExp(q.replace(/ +/g," *")+"/([.\\d]+)","i").exec(e)||0)[1]||j)?(b=[b,/BB10/.test(e)],z=(b[1]?(q=null,W="BlackBerry"):"Device Software")+" "+b[0],j=null):this!=a&&"Wii"!=q&&(B&&F||/Opera/.test(H)&&/\b(?:MSIE|Firefox)\b/i.test(e)||"Firefox"==H&&/\bOS X (?:\d+\.){2,}/.test(z)||"IE"==H&&(z&&!/^Win/.test(z)&&j>5.5||/\bWindows XP\b/.test(z)&&j>8||8==j&&!/\bTrident\b/.test(e)))&&!C.test(b=f.call(a,e.replace(C,"")+";"))&&b.name&&(b="ing as "+b.name+((b=b.version)?" "+b:""),C.test(H)?(/\bIE\b/.test(b)&&"Mac OS"==z&&(z=null),b="identify"+b):(b="mask"+b,H=V?l(V.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(b)&&(z=null),B||(j=null)),$=["Presto"],D.push(b)):H+=" Mobile",(b=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(e)||0)[1])&&(b=[parseFloat(b.replace(/\.(\d)$/,".0$1")),b],"Safari"==H&&"+"==b[1].slice(-1)?(H="WebKit Nightly",R="alpha",j=b[1].slice(0,-1)):j!=b[1]&&j!=(b[2]=(/\bSafari\/([\d.]+\+?)/i.exec(e)||0)[1])||(j=null),b[1]=(/\bChrome\/([\d.]+)/i.exec(e)||0)[1],537.36==b[0]&&537.36==b[2]&&parseFloat(b[1])>=28&&"WebKit"==$&&($=["Blink"]),B&&(w||b[1])?($&&($[1]="like Chrome"),b=b[1]||(b=b[0],b<530?1:b<532?2:b<532.05?3:b<533?4:b<534.03?5:b<534.07?6:b<534.1?7:b<534.13?8:b<534.16?9:b<534.24?10:b<534.3?11:b<535.01?12:b<535.02?"13+":b<535.07?15:b<535.11?16:b<535.19?17:b<536.05?18:b<536.1?19:b<537.01?20:b<537.11?"21+":b<537.13?23:b<537.18?24:b<537.24?25:b<537.36?26:"Blink"!=$?"27":"28")):($&&($[1]="like Safari"),b=b[0],b=b<400?1:b<500?2:b<526?3:b<533?4:b<534?"4+":b<535?5:b<537?6:b<538?7:b<601?8:"8"),$&&($[1]+=" "+(b+="number"==typeof b?".x":/[.+]/.test(b)?"":"+")),"Safari"==H&&(!j||parseInt(j)>45)&&(j=b)),"Opera"==H&&(b=/\bzbov|zvav$/.exec(z))?(H+=" ",D.unshift("desktop mode"),"zvav"==b?(H+="Mini",j=null):H+="Mobile",z=z.replace(RegExp(" *"+b+"$"),"")):"Safari"==H&&/\bChrome\b/.exec($&&$[1])&&(D.unshift("desktop mode"),H="Chrome Mobile",j=null,/\bOS X\b/.test(z)?(W="Apple",z="iOS 4.3+"):z=null),j&&0==j.indexOf(b=/[\d.]+$/.exec(z))&&e.indexOf("/"+b+"-")>-1&&(z=p(z.replace(b,""))),$&&!/\b(?:Avant|Nook)\b/.test(H)&&(/Browser|Lunascape|Maxthon/.test(H)||"Safari"!=H&&/^iOS/.test(z)&&/\bSafari\b/.test($[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Sleipnir|Web)/.test(H)&&$[1])&&(b=$[$.length-1])&&D.push(b),D.length&&(D=["("+D.join("; ")+")"]),W&&q&&q.indexOf(W)<0&&D.push("on "+W),q&&D.push((/^on /.test(D[D.length-1])?"":"on ")+q),z&&(b=/ ([\d.+]+)$/.exec(z),y=b&&"/"==z.charAt(z.length-b[0].length-1),z={"architecture":32,"family":b&&!y?z.replace(b[0],""):z,"version":b?b[1]:null,"toString":function(){var e=this.version;return this.family+(e&&!y?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(b=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(L))&&!/\bi686\b/i.test(L)?(z&&(z.architecture=64,z.family=z.family.replace(RegExp(" *"+b),"")),H&&(/\bWOW64\b/i.test(e)||B&&/\w(?:86|32)$/.test(r.cpuClass||r.platform)&&!/\bWin64; x64\b/i.test(e))&&D.unshift("32-bit")):z&&/^OS X/.test(z.family)&&"Chrome"==H&&parseFloat(j)>=39&&(z.architecture=64),e||(e=null);var U={};return U.description=e,U.layout=$&&$[0],U.manufacturer=W,U.name=H,U.prerelease=R,U.product=q,U.ua=e,U.version=H&&j,U.os=z||{"architecture":null,"family":null,"version":null,"toString":function(){return"null"}},U.parse=f,U.toString=i,U.version&&D.unshift(j),U.name&&D.unshift(H),z&&H&&(z!=String(z).split(" ")[0]||z!=H.split(" ")[0]&&!q)&&D.push(q?"("+z+")":"on "+z),D.length&&(U.description=D.join(" ")),U}var m={"function":!0,"object":!0},g=m[typeof window]&&window||this,v=g,b=m[typeof n]&&n,y=m[typeof i]&&i&&!i.nodeType&&i,x=b&&y&&"object"==typeof t&&t;!x||x.global!==x&&x.window!==x&&x.self!==x||(g=x);var w=Math.pow(2,53)-1,C=/\bOpera/,k=this,_=Object.prototype,I=_.hasOwnProperty,T=_.toString,S=f();"function"==typeof e&&"object"==typeof e.amd&&e.amd?(g.platform=S,e(function(){return S})):b&&y?a(S,function(e,t){b[t]=e}):g.platform=S}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1);return delete t.noConflict,t}),csui.define("csui/lib/bootstrap3-typeahead",["csui/lib/jquery"],function(e){"use strict";function t(t,i){return e(t[i]).offset().top+e(t[i]).outerHeight()-n(t[i])}function i(t,i){var o=e(t[i]).offset().top+e(t[i]).outerHeight();return i+1<t.length&&(o+=n(t[i+1])),o}function n(t){var i=e(t).outerHeight();return Math.min(Math.max(2*e(t).height()-i,.4*i),32)}function o(){var t;return this.$scrollContainer[0]===this.$menu[0]?(t=0,this.$menu.find("li:not(.typeahead-force-scrollbar)").each(function(i,n){t+=e(n).outerHeight()})):t=this.$menu.outerHeight()-(this.$menu.find("li.typeahead-force-scrollbar").outerHeight()||0),t}var s=function(t,i){this.$element=e(t),this.scrollContainerHeight=!!i.scrollContainerHeight,this.options=e.extend({},e.fn.typeahead.defaults,i),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.select=this.options.select||this.select,this.autoSelect="boolean"!=typeof this.options.autoSelect||this.options.autoSelect,this.highlighter=this.options.highlighter||this.highlighter,this.render=this.options.render||this.render,this.updater=this.options.updater||this.updater,this.displayText=this.options.displayText||this.displayText,this.source=this.options.source,this.delay=this.options.delay,this.$menu=e(this.options.menu),this.options.pickerListId&&this.$menu.attr("id",i.pickerListId),this.options.pickerListClass&&this.$menu.addClass(this.options.pickerListClass),this.$appendTo=this.options.appendTo?e(this.options.appendTo):null,this.shown=!1,this.blur=this.options.blur||this.blur,this.focus=this.options.focus||this.focus,this.listen(),this.showHintOnFocus=("boolean"==typeof this.options.showHintOnFocus||"all"===this.options.showHintOnFocus)&&this.options.showHintOnFocus,this.afterSelect=this.options.afterSelect,this.currentHighlighter=this.options.currentHighlighter,this.nextHighlighter=this.options.nextHighlighter,this.accessibility=this.options.accessibility,this.addItem=!1,this.prettyScrolling=e.isFunction(e.fn.perfectScrollbar)&&this.options.prettyScrolling,this.$scrollContainer=this.options.scrollContainer?e(this.options.scrollContainer):this.$menu,this.handleNoResults=!!this.options.handleNoResults,this.emptyTemplate=this.handleNoResults&&this.options.emptyTemplate?this.options.emptyTemplate:"",this.handleNoResults&&(this.dataFound=!1),this.options.showMore&&(this.options.rollOver=!1)};s.prototype={"constructor":s,"select":function(){var e=this.$menu.find(".binf-active").data("value");if(this.$element.data("active",e),this.autoSelect||e){var t=this.updater(e);this.$element.val(this.displayText(t)||t).trigger("change"),this.afterSelect(t)}return this.hide()},"updater":function(e){return e},"setSource":function(e){this.source=e},"show":function(){var t,i=e.extend({},this.$element.position(),{"height":this.$element.outerHeight()});t="function"==typeof this.options.scrollHeight?this.options.scrollHeight.call():this.options.scrollHeight,this.$appendTo=this.$appendTo?this.$scrollContainer.appendTo(this.$appendTo):this.$scrollContainer.insertAfter(this.$element),this.options.beforeShow&&this.options.beforeShow(this),(this.$appendTo?this.$menu.appendTo(this.$appendTo):this.$menu.insertAfter(this.$element)).css({"top":i.top+i.height+t,"left":i.left}).show(),this.$scrollContainer[0]!==this.$menu[0]&&this.$scrollContainer.show();var n,s,r,l,a=[];this.options.showMore&&this.allItems&&(this.$scrollContainer.css("height","auto"),this.scrollItemsHeight=this.$scrollContainer.outerHeight(),this.$menu.html(this.allItems),delete this.allItems),this.scrollItemsHeight&&a.push(this.scrollItemsHeight),!this.scrollContainerHeight&&this.options.showMore&&this.options.items>0||(n=isNaN(this.options.scrollContainerHeight)?void 0:this.options.scrollContainerHeight-0,n?a.push(n):"auto"!==this.options.scrollContainerHeight&&(this.$scrollContainer.css("height",this.options.scrollContainerHeight),l=this.$scrollContainer.outerHeight())),(a.length>0||l)&&(s=this.$scrollContainer.outerHeight()-this.$scrollContainer.height(),r=o.call(this),a.push(r+s),n=1===a.length?a[0]:Math.min.apply(Math,a),(!l||n<l)&&this.$scrollContainer.css("height",n));var c=this.prettyScrolling?15:0;return this.prettyScrolling&&this.$scrollContainer.perfectScrollbar({"suppressScrollX":!0,"scrollYMarginOffset":c}),(this.prettyScrolling||this.options.showMore)&&!this.processMore&&this.$scrollContainer.scrollTop(0),this.shown=!0,this.options.afterShow&&this.options.afterShow(this),this.options.showMore&&(r=o.call(this),n=this.$scrollContainer.outerHeight(),s=n-this.$scrollContainer.height(),n-s+c>=r&&this.options.showMore&&this.options.showMore()&&(e('<li class="typeahead-force-scrollbar"></li>').appendTo(this.$menu).css({"background-color":"transparent","height":c+1}),this.prettyScrolling&&this.$scrollContainer.perfectScrollbar("update"))),this},"hide":function(){return this.$scrollContainer.hide(),this.$scrollContainer[0]!==this.$menu[0]&&this.$menu.hide(),this.shown=!1,this},"lookup":function(t){if(this.query=void 0!==t&&null!==t?t:this.$element.val()||"",this.query.length<this.options.minLength)return this.shown?this.hide():this;var i=e.proxy(function(){var t=this;this.query.length<this.options.minLength||(e.isFunction(this.source)?e.when(this.source(this.query,e.proxy(this.process,this))).done(function(e){t.process(e)}):this.source&&this.process(this.source))},this);clearTimeout(this.lookupWorker),this.lookupWorker=setTimeout(i,this.delay)},"process":function(t){this.dataFound=!0;var i=this;return t=e.grep(t,function(e){return i.matcher(e)}),0===t.length&&this.handleNoResults?(this.dataFound=!1,this.renderNoResults().show()):(t=this.sorter(t),t.length||this.options.addItem?(t.length>0?this.$element.data("active",t[0]):this.$element.data("active",null),this.options.addItem&&t.push(this.options.addItem),"all"==this.options.items||this.options.showMore?this.render(t).show():this.render(t.slice(0,this.options.items)).show()):this.shown?this.hide():this)},"matcher":function(e){return~this.displayText(e).toLowerCase().indexOf(this.query.toLowerCase())},"sorter":function(e){for(var t,i=[],n=[],o=[];t=e.shift();){var s=this.displayText(t);s.toLowerCase().indexOf(this.query.toLowerCase())?~s.indexOf(this.query)?n.push(t):o.push(t):i.push(t)}return i.concat(n,o)},"highlighter":function(t){var i,n,o,s,r,l=e("<div></div>"),a=this.query,c=t.toLowerCase().indexOf(a.toLowerCase());if(0===(i=a.length))return l.text(t).html();for(;c>-1;)n=t.substr(0,c),o=t.substr(c,i),s=t.substr(c+i),r=e("<strong></strong>").text(o),l.append(document.createTextNode(n)).append(r),t=s,c=t.toLowerCase().indexOf(a.toLowerCase());return l.append(document.createTextNode(t)).html()},"render":function(t){var i=this,n=this,o=!1,s=[];return t=e(t).map(function(t,r){function l(){t=e(i.options.item).data("value",r),t.find("a").html(i.highlighter(a)),t.attr("id","user-item"+r.cid),a==n.$element.val()&&(t.addClass("binf-active"),n.$element.data("active",r),o=!0)}var a=n.displayText(r);return l(),n.options.showMore&&!n.scrollItemsHeight&&n.options.items>0&&s.length<n.options.items&&(s.push(t[0]),l()),t[0]}),this.autoSelect&&!o&&(t.first().addClass("binf-active"),this.$element.data("active",t.first().data("value"))),this.options.items>0&&s.length===this.options.items?(this.allItems=t,this.$menu.html(s)):(delete this.allItems,this.$menu.html(t)),this.nextHighlighter(t.first()),this},"renderNoResults":function(){return this.$menu.html(this.emptyTemplate).addClass("csui-no-results-wrapper"),this},"displayText":function(e){return e.name||e},"next":function(t){var i=this.$menu.find(".binf-active"),n=i.next();if(!n.length){if(i.length&&!this.options.rollOver&&this.shown)return;n=e(this.$menu.find("li")[0])}i.removeClass("binf-active"),this.currentHighlighter(i),this.accessibility&&this.accessibility(n),n.addClass("binf-active"),this.scrollIntoView(n[0],t),this.nextHighlighter(n)},"prev":function(e){var t=this.$menu.find(".binf-active"),i=t.prev();if(!i.length){if(!this.options.rollOver)return;i=this.$menu.find("li").last()}t.removeClass("binf-active"),this.currentHighlighter(t),this.accessibility&&this.accessibility(i),i.addClass("binf-active"),this.scrollIntoView(i[0],e),this.nextHighlighter(i)},"forward":function(n){function o(e,n){if(!(n>=e.length-1)){for(var o=t(e,n),s=this.$scrollContainer.height(),r=n+1;r<e.length;r++){var l=i(e,r);if(l-s>o){r--;break}if(r+1>=e.length)return;if(l-s===o)break}return r<=n&&(r=n+1),r<e.length?r:void 0}}function s(t,i){var n=this.$menu.find("li:not(.typeahead-force-scrollbar)"),s=o.call(this,n,i);if(null==s){if(this.options.showMore&&this.options.showMore())return e.isFunction(this.source)?void this.source(this.query,e.proxy(r,this,i),{"more":!0}).then(function(e){r.call(this,i,e)}.bind(this)):void(this.source&&r.call(this,i,this.source));s=n.length-1}l.call(this,t,e(n[s]))}function r(e,t){this.processMore=!0,this.process(t),delete this.processMore,s.call(this,this.$menu.find(".binf-active"),e)}function l(e,t){e.removeClass("binf-active"),this.currentHighlighter(e),this.accessibility&&this.accessibility(t),t.addClass("binf-active"),this.scrollIntoView(t[0],n),this.nextHighlighter(t)}var a=this.$menu.find(".binf-active");a.length?s.call(this,a,this.$menu.find("li").index(a)):l.call(this,a,e(this.$menu.find("li")[0]))},"backward":function(n){function o(e,n){if(!(n<=0)){for(var o=i(e,n),s=this.$scrollContainer.height(),r=n-1;r>=0;r--){var l=t(e,r);if(o-s>l){r++;break}if(o-s===l)break}return r>=n&&(r=n-1),r>=0?r:void 0}}var s,r=this.$menu.find(".binf-active");if(r.length){var l=this.$menu.find("li:not(.typeahead-force-scrollbar)"),a=l.index(r),c=o.call(this,l,a);null==c&&(c=0),s=e(l[c]),r.removeClass("binf-active"),this.currentHighlighter(r),this.accessibility&&this.accessibility(s),s.addClass("binf-active"),this.scrollIntoView(s[0],n),this.nextHighlighter(s)}},"first":function(e){var t=this.$menu.find(".binf-active"),i=this.$menu.find("li").first();t.removeClass("binf-active"),this.currentHighlighter(t),this.accessibility&&this.accessibility(i),i.addClass("binf-active"),this.scrollIntoView(i,e),this.nextHighlighter(i)},"last":function(e){var t=this.$menu.find(".binf-active"),i=this.$menu.find("li").last();t.removeClass("binf-active"),this.currentHighlighter(t),this.accessibility&&this.accessibility(i),i.addClass("binf-active"),this.scrollIntoView(i,e),this.nextHighlighter(i)},"listen":function(){this.$element.on("focus",e.proxy(this.focus,this)).on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this)).on("mouseleave","li",e.proxy(this.mouseleave,this))},"destroy":function(){this.$element.data("typeahead",null),this.$element.data("active",null),this.$element.off("focus").off("blur").off("keypress").off("keyup"),this.eventSupported("keydown")&&this.$element.off("keydown"),this.$menu.remove()},"eventSupported":function(e){var t=e in this.$element;return t||(this.$element.setAttribute(e,"return;"),t="function"==typeof this.$element[e]),t},"move":function(e){function t(){if(this.shown&&!e.shiftKey)return e.preventDefault(),!0}switch(e.keyCode){case 9:case 13:case 27:this.shown&&e.preventDefault();break;case 33:t.call(this)&&this.backward(e);break;case 34:t.call(this)&&this.forward(e);break;case 35:e.ctrlKey&&(!this.shown&&e.preventDefault(),t.call(this)&&this.last(e));break;case 36:e.ctrlKey&&(!this.shown&&e.preventDefault(),
t.call(this)&&this.first(e));break;case 38:t.call(this)&&this.prev(e);break;case 40:t.call(this)&&this.next(e)}},"keydown":function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,33,34,35,36,9,13,27]),this.shown||40!=t.keyCode?this.move(t):this.lookup()},"keypress":function(e){this.suppressKeyPressRepeat||this.move(e)},"keyup":function(e){switch(e.keyCode){case 40:case 39:case 38:case 37:case 36:case 35:case 34:case 33:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;if(this.handleNoResults&&!this.dataFound)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;case 116:case 113:return;default:this.lookup()}e.preventDefault()},"focus":function(e){this.focused||(this.focused=!0,this.options.showHintOnFocus&&!0!==this.skipShowHintOnFocus&&("all"===this.options.showHintOnFocus?this.lookup(""):this.lookup())),this.skipShowHintOnFocus&&(this.skipShowHintOnFocus=!1)},"blur":function(e){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},"click":function(t){if(t.preventDefault(),this.dataFound){var i=t.target&&"LI"===t.target.nodeName?t.target:e(t.target).parentsUntil(this.$menu,"li")[0];i&&(this.currentHighlighter(this.$menu.find(".binf-active")),this.$menu.find(".binf-active").removeClass("binf-active"),e(i).addClass("binf-active"),this.nextHighlighter(this.$menu.find(".binf-active"))),this.skipShowHintOnFocus=!0,this.select(),this.$element[0].focus()}else this.hide()},"mouseenter":function(t){this.mousedover=!0,this.scrollByKey?delete this.scrollByKey:(this.currentHighlighter(this.$menu.find(".binf-active")),this.$menu.find(".binf-active").removeClass("binf-active"),e(t.currentTarget).addClass("binf-active"),this.nextHighlighter(this.$menu.find(".binf-active")))},"mouseleave":function(e){this.mousedover=!1,!this.focused&&this.shown&&this.hide()},"scrollIntoView":function(e,t){var i=this.$menu.find(e),o=this.$scrollContainer,s=i.outerHeight(),r=o[0].clientTop,l=parseFloat(o.css("padding-top").replace("px",""))||0,a=r+l,c=i.offset().top-o.offset().top-a,u=o.scrollTop(),d=o.height();if(t){var h=this.scrollByKey={"keyEvent":t};setTimeout(function(){this.scrollByKey&&this.scrollByKey===h&&delete this.scrollByKey}.bind(this),30)}var p=n(i);c<0?o.scrollTop(u+c):c+s+p>d&&o.scrollTop(u+c+p+s-d)}};var r=e.fn.typeahead;e.fn.typeahead=function(t){var i=arguments;return"string"==typeof t&&"getActive"==t?this.data("active"):this.each(function(){var n=e(this),o=n.data("typeahead"),r="object"==typeof t&&t;o||n.data("typeahead",o=new s(this,r)),"string"==typeof t&&(i.length>1?o[t].apply(o,Array.prototype.slice.call(i,1)):o[t]())})},e.fn.typeahead.defaults={"source":[],"items":8,"menu":'<ul class="typeahead binf-dropdown-menu" role="listbox" id="user-picker-ul"></ul>',"item":'<li role="option"><a href="#"></a></li>',"minLength":1,"scrollHeight":0,"autoSelect":!0,"afterSelect":e.noop,"currentHighlighter":e.noop,"nextHighlighter":e.noop,"addItem":!1,"delay":0,"prettyScrolling":!1,"scrollContainer":'<div class="typeahead scroll-container"></div>',"scrollContainerHeight":320,"rollOver":!0},e.fn.typeahead.Constructor=s,e.fn.typeahead.noConflict=function(){return e.fn.typeahead=r,this},e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var i=e(this);i.data("typeahead")||i.typeahead(i.data())})}),csui.define("csui/lib/jquery.mousehover",["csui/lib/jquery"],function(e){"use strict";function t(e,t,i){var n;if("object"==typeof e)return e;if(!e)throw new Error("Missing event handler or method.");if(i||(i="object"==typeof t?t:{}),n=i.namespace,n=n?"."+n:"","string"==typeof e){if("off"!==e)throw new Error("Unsupported method.");return{"namespace":n}}return{"handlerIn":e,"handlerOut":"function"==typeof t?t:e,"namespace":n}}var i,n=e.fn.mousehover;return navigator.userAgent.indexOf("iPad")>0||navigator.userAgent.indexOf("iPhone")>0?e.fn.mousehover=function(e,t,i){return this}:"onpointerenter"in window&&!1!==navigator.pointerEnabled?e.fn.mousehover=function(e,i,n){var o=t(e,i,n),s=o.namespace;return(e=o.handlerIn)?(i=o.handlerOut,this.on("pointerenter"+s,function(t){"mouse"===t.originalEvent.pointerType&&e.call(this,t)}).on("pointerleave"+s,function(e){"mouse"===e.originalEvent.pointerType&&i.call(this,e)})):this.off("pointerenter"+s+" pointerleave"+s)}:"ontouchstart"in window?(i="mousehover-start",e.fn.mousehover=function(n,o,s){var r=t(n,o,s),l=r.namespace;return(n=r.handlerIn)?(o=r.handlerOut,this.on("touchend"+l,function(){e(this).data(i,(new Date).getTime())}).on("mouseenter"+l,function(t){var o=e(this),s=o.data(i);if(s&&(new Date).getTime()-s<50)return e(this).removeData(i);e(this).data(i,!0),n.call(this,t)}).on("mouseleave"+l,function(t){var n=e(this);n.data(i)&&(n.removeData(i),o.call(this,t))})):this.off("touchend"+l+" mouseenter"+l+" mouseleave"+l)}):e.fn.mousehover=function(e,i,n){var o=t(e,i,n),s=o.namespace;return(e=o.handlerIn)?(i=o.handlerOut,this.on("mouseenter"+s,e).on("mouseleave"+s,i)):this.off("mouseenter"+s+" mouseleave"+s)},e.fn.mousehover.noConflict=function(){return e.fn.mousehover=n,this},e.fn.mousehover}),csui.define("csui/lib/fancytree/jquery.fancytree",["csui/lib/jquery","csui/lib/jquery.ui/js/jquery-ui"],function(e){"use strict";function t(t,i){t||(i=i?": "+i:"",e.error("Fancytree assertion failed"+i))}function i(e,t){var i,n,o=window.console?window.console[e]:null;if(o)try{o.apply(window.console,t)}catch(e){for(n="",i=0;i<t.length;i++)n+=t[i];o(n)}}function n(e){return!(!e.tree||void 0===e.statusNodeType)}function o(){var t,i,n,s,r,l=arguments[0]||{},a=1,c=arguments.length;if("object"==typeof l||e.isFunction(l)||(l={}),a===c)throw"need at least two args";for(;a<c;a++)if(null!=(t=arguments[a]))for(i in t)n=l[i],s=t[i],l!==s&&(s&&e.isPlainObject(s)?(r=n&&e.isPlainObject(n)?n:{},l[i]=o(r,s)):void 0!==s&&(l[i]=s));return l}function s(e,t,i,n,o){return function(){var i=t[e],s=n[e],r=t.ext[o],l=function(){return i.apply(t,arguments)},a=function(e){return i.apply(t,e)};return function(){var e=t._local,i=t._super,n=t._superApply;try{return t._local=r,t._super=l,t._superApply=a,s.apply(t,arguments)}finally{t._local=e,t._super=i,t._superApply=n}}}()}function r(t,i,n,o){for(var r in n)"function"==typeof n[r]?"function"==typeof t[r]?t[r]=s(r,t,i,n,o):"_"===r.charAt(0)?t.ext[o][r]=s(r,t,i,n,o):e.error("Could not override tree."+r+". Use prefix '_' to create tree."+o+"._"+r):"options"!==r&&(t.ext[o][r]=n[r])}function l(t,i){return void 0===t?e.Deferred(function(){this.resolve()}).promise():e.Deferred(function(){this.resolveWith(t,i)}).promise()}function a(t,i){return void 0===t?e.Deferred(function(){this.reject()}).promise():e.Deferred(function(){this.rejectWith(t,i)}).promise()}function c(e,t){return function(){e.resolveWith(t)}}function u(t){var i=e.extend({},t.data()),n=i.json;return delete i.fancytree,delete i.uiFancytree,n&&(delete i.json,i=e.extend(i,n)),i}function d(e){return(""+e).replace(w,function(e){return C[e]})}function h(e){return e=e.toLowerCase(),function(t){return t.title.toLowerCase().indexOf(e)>=0}}function p(e){var t=new RegExp("^"+e,"i");return function(e){return t.test(e.title)}}function f(i,n){var o,s,r,l;for(this.parent=i,this.tree=i.tree,this.ul=null,this.li=null,this.statusNodeType=null,this._isLoading=!1,this._error=null,this.data={},o=0,s=O.length;o<s;o++)r=O[o],this[r]=n[r];null==this.unselectableIgnore&&null==this.unselectableStatus||(this.unselectable=!0),n.hideCheckbox&&e.error("'hideCheckbox' node option was removed in v2.23.0: use 'checkbox: false'"),n.data&&e.extend(this.data,n.data);for(r in n)M[r]||e.isFunction(n[r])||P[r]||(this.data[r]=n[r]);null==this.key?this.tree.options.defaultKey?(this.key=this.tree.options.defaultKey(this),t(this.key,"defaultKey() must return a unique key")):this.key="_"+b._nextNodeKey++:this.key=""+this.key,n.active&&(t(null===this.tree.activeNode,"only one active node allowed"),this.tree.activeNode=this),n.selected&&(this.tree.lastSelectedNode=this),l=n.children,l?l.length?this._setChildren(l):this.children=this.lazy?[]:null:this.children=null,this.tree._callHook("treeRegisterNode",this.tree,!0,this)}function m(t){this.widget=t,this.$div=t.element,this.options=t.options,this.options&&(e.isFunction(this.options.lazyload)&&!e.isFunction(this.options.lazyLoad)&&(this.options.lazyLoad=function(){return b.warn("The 'lazyload' event is deprecated since 2014-02-25. Use 'lazyLoad' (with uppercase L) instead."),t.options.lazyload.apply(this,arguments)}),e.isFunction(this.options.loaderror)&&e.error("The 'loaderror' event was renamed since 2014-07-03. Use 'loadError' (with uppercase E) instead."),void 0!==this.options.fx&&b.warn("The 'fx' option was replaced by 'toggleEffect' since 2014-11-30."),void 0!==this.options.removeNode&&e.error("The 'removeNode' event was replaced by 'modifyChild' since 2.20 (2016-09-10).")),this.ext={},this.types={},this.columns={},this.data=u(this.$div),this._id=e.ui.fancytree._nextId++,this._ns=".fancytree-"+this._id,this.activeNode=null,this.focusNode=null,this._hasFocus=null,this._tempCache={},this._lastMousedownNode=null,this._enableUpdate=!0,this.lastSelectedNode=null,this.systemFocusElement=null,this.lastQuicksearchTerm="",this.lastQuicksearchTime=0,this.statusClassPropName="span",this.ariaPropName="li",this.nodeContainerAttrName="li",this.$div.find(">ul.fancytree-container").remove();var i,n={"tree":this};this.rootNode=new f(n,{"title":"root","key":"root_"+this._id,"children":null,"expanded":!0}),this.rootNode.parent=null,i=e("<ul>",{"class":"ui-fancytree fancytree-container fancytree-plain"}).appendTo(this.$div),this.$container=i,this.rootNode.ul=i[0],null==this.options.debugLevel&&(this.options.debugLevel=b.debugLevel)}if(e.ui&&e.ui.fancytree)return void e.ui.fancytree.warn("Fancytree: ignored duplicate include");var g,v,b=null,y=new RegExp(/\.|\//),x=/[&<>"'\/]/g,w=/[<>"'\/]/g,C={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},k={"16":!0,"17":!0,"18":!0},_={"8":"backspace","9":"tab","10":"return","13":"return","19":"pause","20":"capslock","27":"esc","32":"space","33":"pageup","34":"pagedown","35":"end","36":"home","37":"left","38":"up","39":"right","40":"down","45":"insert","46":"del","59":";","61":"=","96":"0","97":"1","98":"2","99":"3","100":"4","101":"5","102":"6","103":"7","104":"8","105":"9","106":"*","107":"+","109":"-","110":".","111":"/","112":"f1","113":"f2","114":"f3","115":"f4","116":"f5","117":"f6","118":"f7","119":"f8","120":"f9","121":"f10","122":"f11","123":"f12","144":"numlock","145":"scroll","173":"-","186":";","187":"=","188":",","189":"-","190":".","191":"/","192":"`","219":"[","220":"\\","221":"]","222":"'"},I={"16":"shift","17":"ctrl","18":"alt","91":"meta","93":"meta"},T={"0":"","1":"left","2":"middle","3":"right"},S="active expanded focus folder lazy radiogroup selected unselectable unselectableIgnore".split(" "),A={},E="columns types".split(" "),O="checkbox expanded extraClasses folder icon iconTooltip key lazy partsel radiogroup refKey selected statusNodeType title tooltip type unselectable unselectableIgnore unselectableStatus".split(" "),M={},N={},P={"active":!0,"children":!0,"data":!0,"focus":!0};for(g=0;g<S.length;g++)A[S[g]]=!0;for(g=0;g<O.length;g++)v=O[g],M[v]=!0,v!==v.toLowerCase()&&(N[v.toLowerCase()]=v);return t(e.ui,"Fancytree requires jQuery UI (http://jqueryui.com)"),Date.now||(Date.now=function(){return(new Date).getTime()}),f.prototype={"_findDirectChild":function(e){var t,i,n=this.children;if(n)if("string"==typeof e){for(t=0,i=n.length;t<i;t++)if(n[t].key===e)return n[t]}else{if("number"==typeof e)return this.children[e];if(e.parent===this)return e}return null},"_setChildren":function(e){t(e&&(!this.children||0===this.children.length),"only init supported"),this.children=[];for(var i=0,n=e.length;i<n;i++)this.children.push(new f(this,e[i]))},"addChildren":function(i,n){var o,s,r,l=this.getFirstChild(),a=this.getLastChild(),c=null,u=[];for(e.isPlainObject(i)&&(i=[i]),this.children||(this.children=[]),o=0,s=i.length;o<s;o++)u.push(new f(this,i[o]));if(c=u[0],null==n?this.children=this.children.concat(u):(n=this._findDirectChild(n),r=e.inArray(n,this.children),t(r>=0,"insertBefore must be an existing child"),this.children.splice.apply(this.children,[r,0].concat(u))),l&&!n){for(o=0,s=u.length;o<s;o++)u[o].render();l!==this.getFirstChild()&&l.renderStatus(),a!==this.getLastChild()&&a.renderStatus()}else(!this.parent||this.parent.ul||this.tr)&&this.render();return 3===this.tree.options.selectMode&&this.fixSelection3FromEndNodes(),this.triggerModifyChild("add",1===u.length?u[0]:null),c},"addClass":function(e){return this.toggleClass(e,!0)},"addNode":function(e,i){switch(void 0!==i&&"over"!==i||(i="child"),i){case"after":return this.getParent().addChildren(e,this.getNextSibling());case"before":return this.getParent().addChildren(e,this);case"firstChild":var n=this.children?this.children[0]:null;return this.addChildren(e,n);case"child":case"over":return this.addChildren(e)}t(!1,"Invalid mode: "+i)},"addPagingNode":function(t,i){var n,o;if(i=i||"child",!1===t){for(n=this.children.length-1;n>=0;n--)o=this.children[n],"paging"===o.statusNodeType&&this.removeChild(o);return void(this.partload=!1)}return t=e.extend({"title":this.tree.options.strings.moreData,"statusNodeType":"paging","icon":!1},t),this.partload=!0,this.addNode(t,i)},"appendSibling":function(e){return this.addNode(e,"after")},"applyPatch":function(t){if(null===t)return this.remove(),l(this);var i,n,o={"children":!0,"expanded":!0,"parent":!0};for(i in t)n=t[i],o[i]||e.isFunction(n)||(M[i]?this[i]=n:this.data[i]=n);return t.hasOwnProperty("children")&&(this.removeChildren(),t.children&&this._setChildren(t.children)),this.isVisible()&&(this.renderTitle(),this.renderStatus()),t.hasOwnProperty("expanded")?this.setExpanded(t.expanded):l(this)},"collapseSiblings":function(){return this.tree._callHook("nodeCollapseSiblings",this)},"copyTo":function(e,t,i){return e.addNode(this.toDict(!0,i),t)},"countChildren":function(e){var t,i,n,o=this.children;if(!o)return 0;if(n=o.length,!1!==e)for(t=0,i=n;t<i;t++)n+=o[t].countChildren();return n},"debug":function(e){this.tree.options.debugLevel>=4&&(Array.prototype.unshift.call(arguments,this.toString()),i("log",arguments))},"discard":function(){return this.warn("FancytreeNode.discard() is deprecated since 2014-02-16. Use .resetLazy() instead."),this.resetLazy()},"discardMarkup":function(e){var t=e?"nodeRemoveMarkup":"nodeRemoveChildMarkup";this.tree._callHook(t,this)},"error":function(e){this.options.debugLevel>=1&&(Array.prototype.unshift.call(arguments,this.toString()),i("error",arguments))},"findAll":function(t){t=e.isFunction(t)?t:h(t);var i=[];return this.visit(function(e){t(e)&&i.push(e)}),i},"findFirst":function(t){t=e.isFunction(t)?t:h(t);var i=null;return this.visit(function(e){if(t(e))return i=e,!1}),i},"_changeSelectStatusAttrs":function(e){var i=!1,n=this.tree.options,o=b.evalOption("unselectable",this,this,n,!1),s=b.evalOption("unselectableStatus",this,this,n,void 0);switch(o&&null!=s&&(e=s),e){case!1:i=this.selected||this.partsel,this.selected=!1,this.partsel=!1;break;case!0:i=!this.selected||!this.partsel,this.selected=!0,this.partsel=!0;break;case void 0:i=this.selected||!this.partsel,this.selected=!1,this.partsel=!0;break;default:t(!1,"invalid state: "+e)}return i&&this.renderStatus(),i},"fixSelection3AfterClick":function(e){var t=this.isSelected();this.visit(function(e){e._changeSelectStatusAttrs(t)}),this.fixSelection3FromEndNodes(e)},"fixSelection3FromEndNodes":function(e){function i(e){var t,o,s,r,l,a,c,u,d=e.children;if(d&&d.length){for(a=!0,c=!1,t=0,o=d.length;t<o;t++)s=d[t],r=i(s),b.evalOption("unselectableIgnore",s,s,n,!1)||(!1!==r&&(c=!0),!0!==r&&(a=!1));l=!!a||!!c&&void 0}else u=b.evalOption("unselectableStatus",e,e,n,void 0),l=null==u?!!e.selected:!!u;return e._changeSelectStatusAttrs(l),l}var n=this.tree.options;t(3===n.selectMode,"expected selectMode 3"),i(this),this.visitParents(function(e){var t,i,o,s,r,l=e.children,a=!0,c=!1;for(t=0,i=l.length;t<i;t++)o=l[t],b.evalOption("unselectableIgnore",o,o,n,!1)||(r=b.evalOption("unselectableStatus",o,o,n,void 0),s=null==r?!!o.selected:!!r,(s||o.partsel)&&(c=!0),s||(a=!1));s=!!a||!!c&&void 0,e._changeSelectStatusAttrs(s)})},"fromDict":function(t){for(var i in t)M[i]?this[i]=t[i]:"data"===i?e.extend(this.data,t.data):e.isFunction(t[i])||P[i]||(this.data[i]=t[i]);t.children&&(this.removeChildren(),this.addChildren(t.children)),this.renderTitle()},"getChildren":function(){if(void 0!==this.hasChildren())return this.children},"getFirstChild":function(){return this.children?this.children[0]:null},"getIndex":function(){return e.inArray(this,this.parent.children)},"getIndexHier":function(t,i){t=t||".";var n,o=[];return e.each(this.getParentList(!1,!0),function(e,t){n=""+(t.getIndex()+1),i&&(n=("0000000"+n).substr(-i)),o.push(n)}),o.join(t)},"getKeyPath":function(e){var t=[],i=this.tree.options.keyPathSeparator;return this.visitParents(function(e){e.parent&&t.unshift(e.key)},!e),i+t.join(i)},"getLastChild":function(){return this.children?this.children[this.children.length-1]:null},"getLevel":function(){for(var e=0,t=this.parent;t;)e++,t=t.parent;return e},"getNextSibling":function(){if(this.parent){var e,t,i=this.parent.children;for(e=0,t=i.length-1;e<t;e++)if(i[e]===this)return i[e+1]}return null},"getParent":function(){return this.parent},"getParentList":function(e,t){for(var i=[],n=t?this:this.parent;n;)(e||n.parent)&&i.unshift(n),n=n.parent;return i},"getPrevSibling":function(){if(this.parent){var e,t,i=this.parent.children;for(e=1,t=i.length;e<t;e++)if(i[e]===this)return i[e-1]}return null},"getSelectedNodes":function(e){var t=[];return this.visit(function(i){if(i.selected&&(t.push(i),!0===e))return"skip"}),t},"hasChildren":function(){if(this.lazy){if(null==this.children)return;if(0===this.children.length)return!1;if(1===this.children.length&&this.children[0].isStatusNode())return;return!0}return!(!this.children||!this.children.length)},"hasFocus":function(){return this.tree.hasFocus()&&this.tree.focusNode===this},"info":function(e){this.tree.options.debugLevel>=3&&(Array.prototype.unshift.call(arguments,this.toString()),i("info",arguments))},"isActive":function(){return this.tree.activeNode===this},"isBelowOf":function(e){return this.getIndexHier(".",5)>e.getIndexHier(".",5)},"isChildOf":function(e){return this.parent&&this.parent===e},"isDescendantOf":function(t){if(!t||t.tree!==this.tree)return!1;for(var i=this.parent;i;){if(i===t)return!0;i===i.parent&&e.error("Recursive parent link: "+i),i=i.parent}return!1},"isExpanded":function(){return!!this.expanded},"isFirstSibling":function(){var e=this.parent;return!e||e.children[0]===this},"isFolder":function(){return!!this.folder},"isLastSibling":function(){var e=this.parent;return!e||e.children[e.children.length-1]===this},"isLazy":function(){return!!this.lazy},"isLoaded":function(){return!this.lazy||void 0!==this.hasChildren()},"isLoading":function(){return!!this._isLoading},"isRoot":function(){return this.isRootNode()},"isPartsel":function(){return!this.selected&&!!this.partsel},"isPartload":function(){return!!this.partload},"isRootNode":function(){return this.tree.rootNode===this},"isSelected":function(){return!!this.selected},"isStatusNode":function(){return!!this.statusNodeType},"isPagingNode":function(){return"paging"===this.statusNodeType},"isTopLevel":function(){return this.tree.rootNode===this.parent},"isUndefined":function(){return void 0===this.hasChildren()},"isVisible":function(){var e,t,i=this.getParentList(!1,!1);for(e=0,t=i.length;e<t;e++)if(!i[e].expanded)return!1;return!0},"lazyLoad":function(e){return this.warn("FancytreeNode.lazyLoad() is deprecated since 2014-02-16. Use .load() instead."),this.load(e)},"load":function(e){var i,n,o=this,s=this.isExpanded();return t(this.isLazy(),"load() requires a lazy node"),e||this.isUndefined()?(this.isLoaded()&&this.resetLazy(),!1===(n=this.tree._triggerNodeEvent("lazyLoad",this))?l(this):(t("boolean"!=typeof n,"lazyLoad event must return source in data.result"),i=this.tree._callHook("nodeLoadChildren",this,n),s?(this.expanded=!0,i.always(function(){o.render()})):i.always(function(){o.renderStatus()}),i)):l(this)},"makeVisible":function(t){var i,n=this,o=[],s=new e.Deferred,r=this.getParentList(!1,!1),l=r.length,a=!(t&&!0===t.noAnimation),c=!(t&&!1===t.scrollIntoView);for(i=l-1;i>=0;i--)o.push(r[i].setExpanded(!0,t));return e.when.apply(e,o).done(function(){c?n.scrollIntoView(a).done(function(){s.resolve()}):s.resolve()}),s.promise()},"moveTo":function(i,n,o){void 0===n||"over"===n?n="child":"firstChild"===n&&(i.children&&i.children.length?(n="before",i=i.children[0]):n="child");var s,r=this.parent,l="child"===n?i:i.parent;if(this!==i){if(this.parent?l.isDescendantOf(this)&&e.error("Cannot move a node to its own descendant"):e.error("Cannot move system root"),l!==r&&r.triggerModifyChild("remove",this),1===this.parent.children.length){if(this.parent===l)return;this.parent.children=this.parent.lazy?[]:null,this.parent.expanded=!1}else s=e.inArray(this,this.parent.children),t(s>=0,"invalid source parent"),this.parent.children.splice(s,1);if(this.parent=l,l.hasChildren())switch(n){case"child":l.children.push(this);break;case"before":s=e.inArray(i,l.children),t(s>=0,"invalid target parent"),l.children.splice(s,0,this);break;case"after":s=e.inArray(i,l.children),t(s>=0,"invalid target parent"),l.children.splice(s+1,0,this);break;default:e.error("Invalid mode "+n)}else l.children=[this];o&&i.visit(o,!0),l===r?l.triggerModifyChild("move",this):l.triggerModifyChild("add",this),this.tree!==i.tree&&(this.warn("Cross-tree moveTo is experimantal!"),this.visit(function(e){e.tree=i.tree},!0)),r.isDescendantOf(l)||r.render(),l.isDescendantOf(r)||l===r||l.render()}},"navigate":function(t,i){function n(n){if(n){try{n.makeVisible({"scrollIntoView":!1})}catch(e){}return e(n.span).is(":visible")?!1===i?n.setFocus():n.setActive():(n.debug("Navigate: skipping hidden node"),void n.navigate(t,i))}}var o,s,r,a=e.ui.keyCode,c=null;switch(t){case a.BACKSPACE:this.parent&&this.parent.parent&&(r=n(this.parent));break;case a.HOME:this.tree.visit(function(t){if(e(t.span).is(":visible"))return r=n(t),!1});break;case a.END:this.tree.visit(function(t){e(t.span).is(":visible")&&(r=t)}),r&&(r=n(r));break;case a.LEFT:this.expanded?(this.setExpanded(!1),r=n(this)):this.parent&&this.parent.parent&&(r=n(this.parent));break;case a.RIGHT:this.expanded||!this.children&&!this.lazy?this.children&&this.children.length&&(r=n(this.children[0])):(this.setExpanded(),r=n(this));break;case a.UP:for(c=this.getPrevSibling();c&&!e(c.span).is(":visible");)c=c.getPrevSibling();for(;c&&c.expanded&&c.children&&c.children.length;)c=c.children[c.children.length-1];!c&&this.parent&&this.parent.parent&&(c=this.parent),r=n(c);break;case a.DOWN:if(this.expanded&&this.children&&this.children.length)c=this.children[0];else for(s=this.getParentList(!1,!0),o=s.length-1;o>=0;o--){for(c=s[o].getNextSibling();c&&!e(c.span).is(":visible");)c=c.getNextSibling();if(c)break}r=n(c);break;default:!1}return r||l()},"remove":function(){return this.parent.removeChild(this)},"removeChild":function(e){return this.tree._callHook("nodeRemoveChild",this,e)},"removeChildren":function(){return this.tree._callHook("nodeRemoveChildren",this)},"removeClass":function(e){return this.toggleClass(e,!1)},"render":function(e,t){return this.tree._callHook("nodeRender",this,e,t)},"renderTitle":function(){return this.tree._callHook("nodeRenderTitle",this)},"renderStatus":function(){return this.tree._callHook("nodeRenderStatus",this)},"replaceWith":function(i){var n,o=this.parent,s=e.inArray(this,o.children),r=this;return t(this.isPagingNode(),"replaceWith() currently requires a paging status node"),n=this.tree._callHook("nodeLoadChildren",this,i),n.done(function(e){var t=r.children;for(g=0;g<t.length;g++)t[g].parent=o;o.children.splice.apply(o.children,[s+1,0].concat(t)),r.children=null,r.remove(),o.render()}).fail(function(){r.setExpanded()}),n},"resetLazy":function(){this.removeChildren(),this.expanded=!1,this.lazy=!0,this.children=void 0,this.renderStatus()},"scheduleAction":function(t,i){this.tree.timer&&(clearTimeout(this.tree.timer),this.tree.debug("clearTimeout(%o)",this.tree.timer)),this.tree.timer=null;var n=this;switch(t){case"cancel":break;case"expand":this.tree.timer=setTimeout(function(){n.tree.debug("setTimeout: trigger expand"),n.setExpanded(!0)},i);break;case"activate":this.tree.timer=setTimeout(function(){n.tree.debug("setTimeout: trigger activate"),n.setActive(!0)},i);break;default:e.error("Invalid mode "+t)}},"scrollIntoView":function(i,o){if(void 0!==o&&n(o))throw"scrollIntoView() with 'topNode' option is deprecated since 2014-05-08. Use 'options.topNode' instead.";var s=e.extend({"effects":!0===i?{"duration":200,"queue":!1}:i,"scrollOfs":this.tree.options.scrollOfs,"scrollParent":this.tree.options.scrollParent,"topNode":null},o),r=s.scrollParent,a=this.tree.$container,c=a.css("overflow-y");r?r.jquery||(r=e(r)):this.tree.tbody?r=a.scrollParent():"scroll"===c||"auto"===c?r=a:(r=a.closest(".csui-perfect-scrolling"),0===r.length&&(r=a.scrollParent())),r[0]!==document&&r[0]!==document.body||(this.debug("scrollIntoView(): normalizing scrollParent to 'window':",r[0]),r=e(window));var u,d,h,p,f=new e.Deferred,m=this,g=e(this.span).height(),v=s.scrollOfs.top||0,b=s.scrollOfs.bottom||0,y=r.height(),x=r.scrollTop(),w=r,C=r[0]===window,k=s.topNode||null,_=null;return e(this.span).is(":visible")?(C?(d=e(this.span).offset().top,u=k&&k.span?e(k.span).offset().top:0,w=e("html,body")):(t(r[0]!==document&&r[0]!==document.body,"scrollParent should be a simple element or `window`, not document or body."),p=r.offset().top,d=e(this.span).offset().top-p+x,u=k?e(k.span).offset().top-p+x:0,h=Math.max(0,r.innerHeight()-r[0].clientHeight),y-=h),d<x+v?_=d-v:d+g>x+y-b&&(_=d+g-y+b,k&&(t(k.isRootNode()||e(k.span).is(":visible"),"topNode must be visible"),u<_&&(_=u-v))),null!==_?s.effects?(s.effects.complete=function(){f.resolveWith(m)},w.stop(!0).animate({"scrollTop":_},s.effects)):(w[0].scrollTop=_,f.resolveWith(this)):f.resolveWith(this),f.promise()):(this.warn("scrollIntoView(): node is invisible."),l())},"setActive":function(e,t){return this.tree._callHook("nodeSetActive",this,e,t)},"setExpanded":function(e,t){return this.tree._callHook("nodeSetExpanded",this,e,t)},"setFocus":function(e){return this.tree._callHook("nodeSetFocus",this,e)},"setSelected":function(e,t){return this.tree._callHook("nodeSetSelected",this,e,t)},"setStatus":function(e,t,i){return this.tree._callHook("nodeSetStatus",this,e,t,i)},"setTitle":function(e){this.title=e,this.renderTitle(),this.triggerModify("rename")},"sortChildren":function(e,t){var i,n,o=this.children;if(o){if(e=e||function(e,t){var i=e.title.toLowerCase(),n=t.title.toLowerCase();return i===n?0:i>n?1:-1},o.sort(e),t)for(i=0,n=o.length;i<n;i++)o[i].children&&o[i].sortChildren(e,"$norender$");"$norender$"!==t&&this.render(),this.triggerModifyChild("sort")}},"toDict":function(t,i){var n,o,s,r={},l=this;if(e.each(O,function(e,t){(l[t]||!1===l[t])&&(r[t]=l[t])}),e.isEmptyObject(this.data)||(r.data=e.extend({},this.data),e.isEmptyObject(r.data)&&delete r.data),i&&i(r,l),t&&this.hasChildren())for(r.children=[],n=0,o=this.children.length;n<o;n++)s=this.children[n],s.isStatusNode()||r.children.push(s.toDict(!0,i));return r},"toggleClass":function(t,i){var n,o,s=/\S+/g,r=t.match(s)||[],l=0,a=!1,c=this[this.tree.statusClassPropName],u=" "+(this.extraClasses||"")+" ";for(c&&e(c).toggleClass(t,i);n=r[l++];)if(o=u.indexOf(" "+n+" ")>=0,i=void 0===i?!o:!!i)o||(u+=n+" ",a=!0);else for(;u.indexOf(" "+n+" ")>-1;)u=u.replace(" "+n+" "," ");return this.extraClasses=e.trim(u),a},"toggleExpanded":function(){return this.tree._callHook("nodeToggleExpanded",this)},"toggleSelected":function(){return this.tree._callHook("nodeToggleSelected",this)},"toString":function(){return"FancytreeNode@"+this.key+"[title='"+this.title+"']"},"triggerModifyChild":function(t,i,n){var o,s=this.tree.options.modifyChild;s&&(i&&i.parent!==this&&e.error("childNode "+i+" is not a child of "+this),o={"node":this,"tree":this.tree,"operation":t,"childNode":i||null},n&&e.extend(o,n),s({"type":"modifyChild"},o))},"triggerModify":function(e,t){this.parent.triggerModifyChild(e,this,t)},"visit":function(e,t){var i,n,o=!0,s=this.children;if(!0===t&&(!1===(o=e(this))||"skip"===o))return o;if(s)for(i=0,n=s.length;i<n&&!1!==(o=s[i].visit(e,!0));i++);return o},"visitAndLoad":function(t,i,n){var o,s,r,a=this;return!t||!0!==i||!1!==(s=t(a))&&"skip"!==s?a.children||a.lazy?(o=new e.Deferred,r=[],a.load().done(function(){for(var i=0,n=a.children.length;i<n;i++){if(!1===(s=a.children[i].visitAndLoad(t,!0,!0))){o.reject();break}"skip"!==s&&r.push(s)}e.when.apply(this,r).then(function(){o.resolve()})}),o.promise()):l():n?s:l()},"visitParents":function(e,t){if(t&&!1===e(this))return!1;for(var i=this.parent;i;){if(!1===e(i))return!1;i=i.parent}return!0},"visitSiblings":function(e,t){var i,n,o,s=this.parent.children;for(i=0,n=s.length;i<n;i++)if(o=s[i],(t||o!==this)&&!1===e(o))return!1;return!0},"warn":function(e){this.tree.options.debugLevel>=2&&(Array.prototype.unshift.call(arguments,this.toString()),i("warn",arguments))}},m.prototype={"_makeHookContext":function(t,i,n){var o,s;return void 0!==t.node?(i&&t.originalEvent!==i&&e.error("invalid args"),o=t):t.tree?(s=t.tree,o={"node":t,"tree":s,"widget":s.widget,"options":s.widget.options,"originalEvent":i,"typeInfo":s.types[t.type]||{}}):t.widget?o={"node":null,"tree":t,"widget":t.widget,"options":t.widget.options,"originalEvent":i}:e.error("invalid args"),n&&e.extend(o,n),o},"_callHook":function(t,i,n){var o=this._makeHookContext(i),s=this[t],r=Array.prototype.slice.call(arguments,2);return e.isFunction(s)||e.error("_callHook('"+t+"') is not a function"),r.unshift(o),s.apply(this,r)},"_setExpiringValue":function(e,t,i){this._tempCache[e]={"value":t,"expire":Date.now()+(+i||50)}},"_getExpiringValue":function(e){var t=this._tempCache[e];return t&&t.expire>Date.now()?t.value:(delete this._tempCache[e],null)},"_requireExtension":function(i,n,o,s){null!=o&&(o=!!o);var r=this._local.name,l=this.options.extensions,a=e.inArray(i,l)<e.inArray(r,l),c=n&&null==this.ext[i],u=!c&&null!=o&&o!==a;return t(r&&r!==i,"invalid or same name"),!c&&!u||(s||(c||n?(s="'"+r+"' extension requires '"+i+"'",u&&(s+=" to be registered "+(o?"before":"after")+" itself")):s="If used together, `"+i+"` must be registered "+(o?"before":"after")+" `"+r+"`"),e.error(s),!1)},"activateKey":function(e,t){var i=this.getNodeByKey(e);return i?i.setActive(!0,t):this.activeNode&&this.activeNode.setActive(!1,t),i},"addPagingNode":function(e,t){return this.rootNode.addPagingNode(e,t)},"applyPatch":function(i){var n,o,s,r,l,a,u=i.length,d=[];for(o=0;o<u;o++)s=i[o],t(2===s.length,"patchList must be an array of length-2-arrays"),r=s[0],l=s[1],a=null===r?this.rootNode:this.getNodeByKey(r),a?(n=new e.Deferred,d.push(n),a.applyPatch(l).always(c(n,a))):this.warn("could not find node with key '"+r+"'");return e.when.apply(e,d).promise()},"clear":function(e){this._callHook("treeClear",this)},"count":function(){return this.rootNode.countChildren()},"debug":function(e){this.options.debugLevel>=4&&(Array.prototype.unshift.call(arguments,this.toString()),i("log",arguments))},"enable":function(e){!1===e?this.widget.disable():this.widget.enable()},"enableUpdate":function(e){return e=!1!==e,!!this._enableUpdate==!!e?e:(this._enableUpdate=e,e?(this.debug("enableUpdate(true): redraw "),this.render()):this.debug("enableUpdate(false)..."),!e)},"expandAll":function(e,t){e=!1!==e,this.visit(function(i){!1!==i.hasChildren()&&i.isExpanded()!==e&&i.setExpanded(e,t)})},"findAll":function(e){return this.rootNode.findAll(e)},"findFirst":function(e){return this.rootNode.findFirst(e)},"findNextNode":function(t,i,n){t="string"==typeof t?p(t):t,i=i||this.getFirstChild();var o=null,s=i.parent.children,r=null,l=function(e,t,i){var n,o,s=e.children,r=s.length,a=s[t]
;if(a&&!1===i(a))return!1;if(a&&a.children&&a.expanded&&!1===l(a,0,i))return!1;for(n=t+1;n<r;n++)if(!1===l(e,n,i))return!1;return o=e.parent,o?l(o,o.children.indexOf(e)+1,i):l(e,0,i)};return l(i.parent,s.indexOf(i),function(n){return n!==o&&(o=o||n,e(n.span).is(":visible")?(!t(n)||(r=n)===i)&&void 0:void n.debug("quicksearch: skipping hidden node"))}),r},"generateFormElements":function(t,i,n){function o(t){c.append(e("<input>",{"type":"checkbox","name":r,"value":t.key,"checked":!0}))}n=n||{};var s,r="string"==typeof t?t:"ft_"+this._id+"[]",l="string"==typeof i?i:"ft_"+this._id+"_active",a="fancytree_result_"+this._id,c=e("#"+a),u=3===this.options.selectMode&&!1!==n.stopOnParents;c.length?c.empty():c=e("<div>",{"id":a}).hide().insertAfter(this.$container),!1!==i&&this.activeNode&&c.append(e("<input>",{"type":"radio","name":l,"value":this.activeNode.key,"checked":!0})),n.filter?this.visit(function(e){var t=n.filter(e);if("skip"===t)return t;!1!==t&&o(e)}):!1!==t&&(s=this.getSelectedNodes(u),e.each(s,function(e,t){o(t)}))},"getActiveNode":function(){return this.activeNode},"getFirstChild":function(){return this.rootNode.getFirstChild()},"getFocusNode":function(){return this.focusNode},"getOption":function(e){return this.widget.option(e)},"getNodeByKey":function(e,t){var i,n;return!t&&(i=document.getElementById(this.options.idPrefix+e))?i.ftnode?i.ftnode:null:(t=t||this.rootNode,n=null,t.visit(function(t){if(t.key===e)return n=t,!1},!0),n)},"getRootNode":function(){return this.rootNode},"getSelectedNodes":function(e){return this.rootNode.getSelectedNodes(e)},"hasFocus":function(){return!!this._hasFocus},"info":function(e){this.options.debugLevel>=3&&(Array.prototype.unshift.call(arguments,this.toString()),i("info",arguments))},"loadKeyPath":function(t,i){var n,o,s,r=this,l=new e.Deferred,a=this.getRootNode(),c=this.options.keyPathSeparator,u=[],d=e.extend({},i);for("function"==typeof i?n=i:i&&i.callback&&(n=i.callback),d.callback=function(e,t,i){n&&n.call(e,t,i),l.notifyWith(e,[{"node":t,"status":i}])},null==d.matchKey&&(d.matchKey=function(e,t){return e.key===t}),e.isArray(t)||(t=[t]),o=0;o<t.length;o++)s=t[o],s.charAt(0)===c&&(s=s.substr(1)),u.push(s.split(c));return setTimeout(function(){r._loadKeyPathImpl(l,d,a,u).done(function(){l.resolve()})},0),l.promise()},"_loadKeyPathImpl":function(t,i,n,o){var s,r,l,a,u,d,h,p,f=this;for(u={},r=0;r<o.length;r++)for(h=o[r],d=n;h.length;){if(l=h.shift(),!(a=function(e,t){var n,o,s=e.children;if(s)for(n=0,o=s.length;n<o;n++)if(i.matchKey(s[n],t))return s[n];return null}(d,l))){this.warn("loadKeyPath: key not found: "+l+" (parent: "+d+")"),i.callback(this,l,"error");break}if(0===h.length){i.callback(this,a,"ok");break}if(a.lazy&&void 0===a.hasChildren()){i.callback(this,a,"loaded"),l=a.key,u[l]?u[l].pathSegList.push(h):u[l]={"parent":a,"pathSegList":[h]};break}i.callback(this,a,"loaded"),d=a}s=[];for(var m in u){var g=u[m];p=new e.Deferred,s.push(p),function(e,t,n){i.callback(f,t,"loading"),t.load().done(function(){f._loadKeyPathImpl.call(f,e,i,t,n).always(c(e,f))}).fail(function(n){f.warn("loadKeyPath: error loading lazy "+t),i.callback(f,a,"error"),e.rejectWith(f)})}(p,g.parent,g.pathSegList)}return e.when.apply(e,s).promise()},"reactivate":function(e){var t,i=this.activeNode;return i?(this.activeNode=null,t=i.setActive(!0,{"noFocus":!0}),e&&i.setFocus(),t):l()},"reload":function(e){return this._callHook("treeClear",this),this._callHook("treeLoad",this,e)},"render":function(e,t){return this.rootNode.render(e,t)},"selectAll":function(e){this.visit(function(t){t.setSelected(e)})},"setFocus":function(e){return this._callHook("treeSetFocus",this,e)},"setOption":function(e,t){return this.widget.option(e,t)},"toDict":function(e,t){var i=this.rootNode.toDict(!0,t);return e?i:i.children},"toString":function(){return"Fancytree@"+this._id},"_triggerNodeEvent":function(e,t,i,n){var o=this._makeHookContext(t,i,n),s=this.widget._trigger(e,i,o);return!1!==s&&void 0!==o.result?o.result:s},"_triggerTreeEvent":function(e,t,i){var n=this._makeHookContext(this,t,i),o=this.widget._trigger(e,t,n);return!1!==o&&void 0!==n.result?n.result:o},"visit":function(e){return this.rootNode.visit(e,!1)},"visitRows":function(e,t){if(t&&t.reverse)return delete t.reverse,this._visitRowsUp(e,t);var i,n,o,s,r=0,l=!1===t.includeSelf,a=!!t.includeHidden,c=t.start||this.rootNode.children[0];for(o=c.parent;o;){for(s=o.children,n=s.indexOf(c)+r,i=n;i<s.length;i++){if(c=s[i],!l&&!1===e(c))return!1;if(l=!1,c.children&&c.children.length&&(a||c.expanded)&&!1===c.visit(function(t){return!1!==e(t)&&(a||!t.children||t.expanded?void 0:"skip")},!1))return!1}c=o,o=o.parent,r=1}return!0},"_visitRowsUp":function(t,i){for(var n,o,s,r=!!i.includeHidden,l=i.start||this.rootNode.children[0];;){if(s=l.parent,n=s.children,n[0]===l)l=s,n=s.children;else for(o=n.indexOf(l),l=n[o-1];(r||l.expanded)&&l.children&&l.children.length;)n=l.children,s=l,l=n[n.length-1];if((r||e(l.span).is(":visible"))&&!1===t(l))return!1}},"warn":function(e){this.options.debugLevel>=2&&(Array.prototype.unshift.call(arguments,this.toString()),i("warn",arguments))}},e.extend(m.prototype,{"nodeClick":function(e){var t,i,n=e.targetType,o=e.node;if("expander"===n){if(o.isLoading())return void o.debug("Got 2nd click while loading: ignored");this._callHook("nodeToggleExpanded",e)}else if("checkbox"===n)this._callHook("nodeToggleSelected",e),e.options.focusOnSelect&&this._callHook("nodeSetFocus",e,!0);else{if(i=!1,t=!0,o.folder)switch(e.options.clickFolderMode){case 2:i=!0,t=!1;break;case 3:t=!0,i=!0}t&&(this.nodeSetFocus(e),this._callHook("nodeSetActive",e,!0)),i&&this._callHook("nodeToggleExpanded",e)}},"nodeCollapseSiblings":function(e,t){var i,n,o,s=e.node;if(s.parent)for(i=s.parent.children,n=0,o=i.length;n<o;n++)i[n]!==s&&i[n].expanded&&this._callHook("nodeSetExpanded",i[n],!1,t)},"nodeDblclick":function(e){"title"===e.targetType&&4===e.options.clickFolderMode&&this._callHook("nodeToggleExpanded",e),"title"===e.targetType&&e.originalEvent.preventDefault()},"nodeKeydown":function(t){var i,n,o,s=t.originalEvent,r=t.node,l=t.tree,a=t.options,c=s.which,u=s.key||String.fromCharCode(c),d=!!(s.altKey||s.ctrlKey||s.metaKey),h=!I[c]&&!_[c]&&!d,p=e(s.target),f=!0,m=!(s.ctrlKey||!a.autoActivate);if(r||(o=this.getActiveNode()||this.getFirstChild())&&(o.setFocus(),r=t.node=this.focusNode,r.debug("Keydown force focus on active node")),a.quicksearch&&h&&!p.is(":input:enabled"))return n=Date.now(),n-l.lastQuicksearchTime>500&&(l.lastQuicksearchTerm=""),l.lastQuicksearchTime=n,l.lastQuicksearchTerm+=u,i=l.findNextNode(l.lastQuicksearchTerm,l.getActiveNode()),i&&i.setActive(),void s.preventDefault();switch(b.eventToString(s)){case"+":case"=":l.nodeSetExpanded(t,!0);break;case"-":l.nodeSetExpanded(t,!1);break;case"space":r.isPagingNode()?l._triggerNodeEvent("clickPaging",t,s):b.evalOption("checkbox",r,r,a,!1)?l.nodeToggleSelected(t):l.nodeSetActive(t,!0);break;case"return":l.nodeSetActive(t,!0);break;case"home":case"end":case"backspace":case"left":case"right":case"up":case"down":r.navigate(s.which,m);break;default:f=!1}f&&s.preventDefault()},"nodeLoadChildren":function(i,n){var o,s,r,l=i.tree,a=i.node,c=Date.now();if(e.isFunction(n)&&(n=n.call(l,{"type":"source"},i),t(!e.isFunction(n),"source callback must not return another function")),n.url&&(a._requestId&&a.warn("Recursive load request #"+c+" while #"+a._requestId+" is pending."),o=e.extend({},i.options.ajax,n),a._requestId=c,o.debugDelay?(s=o.debugDelay,delete o.debugDelay,e.isArray(s)&&(s=s[0]+Math.random()*(s[1]-s[0])),a.warn("nodeLoadChildren waiting debugDelay "+Math.round(s)+" ms ..."),r=e.Deferred(function(t){setTimeout(function(){e.ajax(o).done(function(){t.resolveWith(this,arguments)}).fail(function(){t.rejectWith(this,arguments)})},s)})):r=e.ajax(o),n=new e.Deferred,r.done(function(t,o,s){var r,u;if("json"!==this.dataType&&"jsonp"!==this.dataType||"string"!=typeof t||e.error("Ajax request returned a string (did you get the JSON dataType wrong?)."),a._requestId&&a._requestId>c)return void n.rejectWith(this,["$recursive_request"]);if(i.options.postProcess){try{u=l._triggerNodeEvent("postProcess",i,i.originalEvent,{"response":t,"error":null,"dataType":this.dataType})}catch(e){u={"error":e,"message":""+e,"details":"postProcess failed"}}if(u.error)return r=e.isPlainObject(u.error)?u.error:{"message":u.error},r=l._makeHookContext(a,null,r),void n.rejectWith(this,[r]);(e.isArray(u)||e.isPlainObject(u)&&e.isArray(u.children))&&(t=u)}else t&&t.hasOwnProperty("d")&&i.options.enableAspx&&(t="string"==typeof t.d?e.parseJSON(t.d):t.d);n.resolveWith(this,[t])}).fail(function(e,t,i){var o=l._makeHookContext(a,null,{"error":e,"args":Array.prototype.slice.call(arguments),"message":i,"details":e.status+": "+i});n.rejectWith(this,[o])})),e.isFunction(n.then)&&e.isFunction(n.catch)&&(r=n,n=new e.Deferred,r.then(function(e){n.resolve(e)},function(e){n.reject(e)})),e.isFunction(n.promise))l.nodeSetStatus(i,"loading"),n.done(function(e){l.nodeSetStatus(i,"ok"),a._requestId=null}).fail(function(e){var t;if("$recursive_request"===e)return void a.warn("Ignored response for obsolete load request #"+c+" (expected #"+a._requestId+")");e.node&&e.error&&e.message?t=e:(t=l._makeHookContext(a,null,{"error":e,"args":Array.prototype.slice.call(arguments),"message":e?e.message||e.toString():""}),"[object Object]"===t.message&&(t.message="")),a.warn("Load children failed ("+t.message+")",t),!1!==l._triggerNodeEvent("loadError",t,null)&&l.nodeSetStatus(i,"error",t.message,t.details)});else if(i.options.postProcess){var u=l._triggerNodeEvent("postProcess",i,i.originalEvent,{"response":n,"error":null,"dataType":typeof n});(e.isArray(u)||e.isPlainObject(u)&&e.isArray(u.children))&&(n=u)}return e.when(n).done(function(n){var o,s;e.isPlainObject(n)&&(t(a.isRootNode(),"source may only be an object for root nodes (expecting an array of child objects otherwise)"),t(e.isArray(n.children),"if an object is passed as source, it must contain a 'children' array (all other properties are added to 'tree.data')"),o=n,n=n.children,delete o.children,e.each(E,function(e,t){void 0!==o[t]&&(l[t]=o[t],delete o[t])}),e.extend(l.data,o)),t(e.isArray(n),"expected array of children"),a._setChildren(n),l.options.nodata&&0===n.length&&(e.isFunction(l.options.nodata)?s=l.options.nodata.call(l,{"type":"nodata"},i):!0===l.options.nodata&&a.isRootNode()?s=l.options.strings.nodata:"string"==typeof l.options.nodata&&a.isRootNode()&&(s=l.options.nodata),s&&a.setStatus("nodata",s)),l._triggerNodeEvent("loadChildren",a)})},"nodeLoadKeyPath":function(e,t){},"nodeRemoveChild":function(i,n){var o,s=i.node,r=e.extend({},i,{"node":n}),l=s.children;if(1===l.length)return t(n===l[0],"invalid single child"),this.nodeRemoveChildren(i);this.activeNode&&(n===this.activeNode||this.activeNode.isDescendantOf(n))&&this.activeNode.setActive(!1),this.focusNode&&(n===this.focusNode||this.focusNode.isDescendantOf(n))&&(this.focusNode=null),this.nodeRemoveMarkup(r),this.nodeRemoveChildren(r),o=e.inArray(n,l),t(o>=0,"invalid child"),s.triggerModifyChild("remove",n),n.visit(function(e){e.parent=null},!0),this._callHook("treeRegisterNode",this,!1,n),l.splice(o,1)},"nodeRemoveChildMarkup":function(t){var i=t.node;i.ul&&(i.isRootNode()?e(i.ul).empty():(e(i.ul).remove(),i.ul=null),i.visit(function(e){e.li=e.ul=null}))},"nodeRemoveChildren":function(t){var i=t.tree,n=t.node;n.children&&(this.activeNode&&this.activeNode.isDescendantOf(n)&&this.activeNode.setActive(!1),this.focusNode&&this.focusNode.isDescendantOf(n)&&(this.focusNode=null),this.nodeRemoveChildMarkup(t),e.extend({},t),n.triggerModifyChild("remove",null),n.visit(function(e){e.parent=null,i._callHook("treeRegisterNode",i,!1,e)}),n.lazy?n.children=[]:n.children=null,n.isRootNode()||(n.expanded=!1),this.nodeRenderStatus(t))},"nodeRemoveMarkup":function(t){var i=t.node;i.li&&(e(i.li).remove(),i.li=null),this.nodeRemoveChildMarkup(t)},"nodeRender":function(i,n,o,s,r){var l,a,c,u,d,h,p,f=i.node,m=i.tree,g=i.options,v=g.aria,b=!1,y=f.parent,x=!y,w=f.children,C=null;if(!1!==m._enableUpdate&&(x||y.ul)){if(t(x||y.ul,"parent UL must exist"),x||(f.li&&(n||f.li.parentNode!==f.parent.ul)&&(f.li.parentNode===f.parent.ul?C=f.li.nextSibling:this.debug("Unlinking "+f+" (must be child of "+f.parent+")"),this.nodeRemoveMarkup(i)),f.li?this.nodeRenderStatus(i):(b=!0,f.li=document.createElement("li"),f.li.ftnode=f,f.key&&g.generateIds&&(f.li.id=g.idPrefix+f.key),f.span=document.createElement("span"),f.span.className="fancytree-node",v&&!f.tr&&e(f.li).attr("role","treeitem"),f.li.appendChild(f.span),this.nodeRenderTitle(i),g.createNode&&g.createNode.call(m,{"type":"createNode"},i)),g.renderNode&&g.renderNode.call(m,{"type":"renderNode"},i)),w){if(x||f.expanded||!0===o){for(f.ul||(f.ul=document.createElement("ul"),(!0!==s||r)&&f.expanded||(f.ul.style.display="none"),v&&e(f.ul).attr("role","group"),f.li?f.li.appendChild(f.ul):f.tree.$div.append(f.ul)),u=0,d=w.length;u<d;u++)p=e.extend({},i,{"node":w[u]}),this.nodeRender(p,n,o,!1,!0);for(l=f.ul.firstChild;l;)c=l.ftnode,c&&c.parent!==f?(f.debug("_fixParent: remove missing "+c,l),h=l.nextSibling,l.parentNode.removeChild(l),l=h):l=l.nextSibling;for(l=f.ul.firstChild,u=0,d=w.length-1;u<d;u++)a=w[u],c=l.ftnode,a!==c?f.ul.insertBefore(a.li,c.li):l=l.nextSibling}}else f.ul&&(this.warn("remove child markup for "+f),this.nodeRemoveChildMarkup(i));x||b&&y.ul.insertBefore(f.li,C)}},"nodeRenderTitle":function(t,i){var n,o,s,r,l,a,c,u,h=t.node,p=t.tree,f=t.options,m=f.aria,g=h.getLevel(),v=[];void 0!==i&&(h.title=i),h.span&&!1!==p._enableUpdate&&(l=m&&!1!==h.hasChildren()?" role='button'":"",g<f.minExpandLevel?(h.lazy||(h.expanded=!0),g>1&&v.push("<span "+l+" class='fancytree-expander fancytree-expander-fixed'></span>")):v.push("<span "+l+" class='fancytree-expander'></span>"),n=b.evalOption("checkbox",h,h,f,!1),n&&!h.isStatusNode()&&(l=m?" role='checkbox'":"",o="fancytree-checkbox",("radio"===n||h.parent&&h.parent.radiogroup)&&(o+=" fancytree-radio"),v.push("<span "+l+" class='"+o+"'></span>")),void 0!==h.data.iconClass&&(h.icon?e.error("'iconClass' node option is deprecated since v2.14.0: use 'icon' only instead"):(h.warn("'iconClass' node option is deprecated since v2.14.0: use 'icon' instead"),h.icon=h.data.iconClass)),s=b.evalOption("icon",h,h,f,!0),!1!==s&&(l=m?" role='presentation'":"",u=b.evalOption("iconTooltip",h,h,f,null),u=u?" title='"+d(u)+"'":"","string"==typeof s?y.test(s)?(s="/"===s.charAt(0)?s:(f.imagePath||"")+s,v.push("<img src='"+s+"' class='fancytree-icon'"+u+" alt='' />")):v.push("<span "+l+" class='fancytree-custom-icon "+s+"'"+u+"></span>"):s.text?v.push("<span "+l+" class='fancytree-custom-icon "+(s.addClass||"")+"'"+u+">"+b.escapeHtml(s.text)+"</span>"):s.html?v.push("<span "+l+" class='fancytree-custom-icon "+(s.addClass||"")+"'"+u+">"+s.html+"</span>"):v.push("<span "+l+" class='fancytree-icon'"+u+"></span>")),r="",f.renderTitle&&(r=f.renderTitle.call(p,{"type":"renderTitle"},t)||""),r||(c=b.evalOption("tooltip",h,h,f,null),!0===c&&(c=h.title),c=c?" title='"+d(c)+"'":"",a=f.titlesTabbable?" tabindex='0'":"",r="<span class='fancytree-title'"+c+a+">"+(f.escapeTitles?b.escapeHtml(h.title):h.title)+"</span>"),v.push(r),h.span.innerHTML=v.join(""),this.nodeRenderStatus(t),f.enhanceTitle&&(t.$title=e(">span.fancytree-title",h.span),r=f.enhanceTitle.call(p,{"type":"enhanceTitle"},t)||""))},"nodeRenderStatus":function(t){var i,n=t.node,o=t.tree,s=t.options,r=n.hasChildren(),l=n.isLastSibling(),a=s.aria,c=s._classNames,u=[],d=n[o.statusClassPropName];d&&!1!==o._enableUpdate&&(a&&(i=e(n.tr||n.li)),u.push(c.node),o.activeNode===n&&u.push(c.active),o.focusNode===n&&u.push(c.focused),n.expanded&&u.push(c.expanded),a&&(!1!==r?i.attr("aria-expanded",Boolean(n.expanded)):i.removeAttr("aria-expanded")),n.folder&&u.push(c.folder),!1!==r&&u.push(c.hasChildren),l&&u.push(c.lastsib),n.lazy&&null==n.children&&u.push(c.lazy),n.partload&&u.push(c.partload),n.partsel&&u.push(c.partsel),b.evalOption("unselectable",n,n,s,!1)&&u.push(c.unselectable),n._isLoading&&u.push(c.loading),n._error&&u.push(c.error),n.statusNodeType&&u.push(c.statusNodePrefix+n.statusNodeType),n.selected?(u.push(c.selected),a&&i.attr("aria-selected",!0)):a&&i.attr("aria-selected",!1),n.extraClasses&&u.push(n.extraClasses),!1===r?u.push(c.combinedExpanderPrefix+"n"+(l?"l":"")):u.push(c.combinedExpanderPrefix+(n.expanded?"e":"c")+(n.lazy&&null==n.children?"d":"")+(l?"l":"")),u.push(c.combinedIconPrefix+(n.expanded?"e":"c")+(n.folder?"f":"")),d.className=u.join(" "),n.li&&e(n.li).toggleClass(c.lastsib,l))},"nodeSetActive":function(i,n,o){o=o||{};var s,r=i.node,c=i.tree,u=i.options,d=!0===o.noEvents,h=!0===o.noFocus,p=!1!==o.scrollIntoView,f=r===c.activeNode;return n=!1!==n,f===n?l(r):n&&!d&&!1===this._triggerNodeEvent("beforeActivate",r,i.originalEvent)?a(r,["rejected"]):(n?(c.activeNode&&(t(c.activeNode!==r,"node was active (inconsistency)"),s=e.extend({},i,{"node":c.activeNode}),c.nodeSetActive(s,!1),t(null===c.activeNode,"deactivate was out of sync?")),u.activeVisible&&r.makeVisible({"scrollIntoView":p}),c.activeNode=r,c.nodeRenderStatus(i),h||c.nodeSetFocus(i),d||c._triggerNodeEvent("activate",r,i.originalEvent)):(t(c.activeNode===r,"node was not active (inconsistency)"),c.activeNode=null,this.nodeRenderStatus(i),d||i.tree._triggerNodeEvent("deactivate",r,i.originalEvent)),l(r))},"nodeSetExpanded":function(t,i,n){n=n||{};var o,s,r,c,u,d,h=t.node,p=t.tree,f=t.options,m=!0===n.noAnimation,g=!0===n.noEvents;if(i=!1!==i,h.expanded&&i||!h.expanded&&!i)return l(h);if(i&&!h.lazy&&!h.hasChildren())return l(h);if(!i&&h.getLevel()<f.minExpandLevel)return a(h,["locked"]);if(!g&&!1===this._triggerNodeEvent("beforeExpand",h,t.originalEvent))return a(h,["rejected"]);if(m||h.isVisible()||(m=n.noAnimation=!0),s=new e.Deferred,i&&!h.expanded&&f.autoCollapse){u=h.getParentList(!1,!0),d=f.autoCollapse;try{for(f.autoCollapse=!1,r=0,c=u.length;r<c;r++)this._callHook("nodeCollapseSiblings",u[r],n)}finally{f.autoCollapse=d}}return s.done(function(){var e=h.getLastChild();i&&f.autoScroll&&!m&&e?e.scrollIntoView(!0,{"topNode":h}).always(function(){g||t.tree._triggerNodeEvent(i?"expand":"collapse",t)}):g||t.tree._triggerNodeEvent(i?"expand":"collapse",t)}),o=function(n){var o,s,r=f._classNames,l=f.toggleEffect;if(h.expanded=i,p._callHook("nodeRender",t,!1,!1,!0),h.ul)if(o="none"!==h.ul.style.display,s=!!h.expanded,o===s)h.warn("nodeSetExpanded: UL.style.display already set");else{if(l&&!m)return e(h.li).addClass(r.animating),void(e.isFunction(e(h.ul)[l.effect])?(p.debug("use jquery."+l.effect+" method"),e(h.ul)[l.effect]({"duration":l.duration,"always":function(){e(this).removeClass(r.animating),e(h.li).removeClass(r.animating),n()}})):(e(h.ul).stop(!0,!0),e(h.ul).parent().find(".ui-effects-placeholder").remove(),e(h.ul).toggle(l.effect,l.options,l.duration,function(){e(this).removeClass(r.animating),e(h.li).removeClass(r.animating),n()})));h.ul.style.display=h.expanded||!parent?"":"none"}n()},i&&h.lazy&&void 0===h.hasChildren()?h.load().done(function(){s.notifyWith&&s.notifyWith(h,["loaded"]),o(function(){s.resolveWith(h)})}).fail(function(e){o(function(){s.rejectWith(h,["load failed ("+e+")"])})}):o(function(){s.resolveWith(h)}),s.promise()},"nodeSetFocus":function(t,i){var n,o=t.tree,s=t.node,r=o.options,l=!!t.originalEvent&&e(t.originalEvent.target).is(":input");if(i=!1!==i,o.focusNode){if(o.focusNode===s&&i)return;n=e.extend({},t,{"node":o.focusNode}),o.focusNode=null,this._triggerNodeEvent("blur",n),this._callHook("nodeRenderStatus",n)}i&&(this.hasFocus()||(s.debug("nodeSetFocus: forcing container focus"),this._callHook("treeSetFocus",t,!0,{"calledByNode":!0})),s.makeVisible({"scrollIntoView":!1}),o.focusNode=s,r.titlesTabbable?l||e(s.span).find(".fancytree-title").trigger("focus"):0===e(document.activeElement).closest(".fancytree-container").length&&e(o.$container).trigger("focus"),r.aria&&e(o.$container).attr("aria-activedescendant",e(s.tr||s.li).uniqueId().attr("id")),this._triggerNodeEvent("focus",t),r.autoScroll&&s.scrollIntoView(),this._callHook("nodeRenderStatus",t))},"nodeSetSelected":function(e,t,i){i=i||{};var n=e.node,o=e.tree,s=e.options,r=!0===i.noEvents,l=n.parent;if(t=!1!==t,!b.evalOption("unselectable",n,n,s,!1)){if(n._lastSelectIntent=t,!!n.selected===t&&(3!==s.selectMode||!n.partsel||t))return t;if(!r&&!1===this._triggerNodeEvent("beforeSelect",n,e.originalEvent))return!!n.selected;t&&1===s.selectMode?(o.lastSelectedNode&&o.lastSelectedNode.setSelected(!1),n.selected=t):3!==s.selectMode||!l||l.radiogroup||n.radiogroup?l&&l.radiogroup?n.visitSiblings(function(e){e._changeSelectStatusAttrs(t&&e===n)},!0):n.selected=t:(n.selected=t,n.fixSelection3AfterClick(i)),this.nodeRenderStatus(e),o.lastSelectedNode=t?n:null,r||o._triggerNodeEvent("select",e)}},"nodeSetStatus":function(t,i,n,o){function s(t,i){var n=r.children?r.children[0]:null;return n&&n.isStatusNode()?(e.extend(n,t),n.statusNodeType=i,l._callHook("nodeRenderTitle",n)):(r._setChildren([t]),r.children[0].statusNodeType=i,l.render()),r.children[0]}var r=t.node,l=t.tree;switch(i){case"ok":!function(){var e=r.children?r.children[0]:null;if(e&&e.isStatusNode()){try{r.ul&&(r.ul.removeChild(e.li),e.li=null)}catch(e){}1===r.children.length?r.children=[]:r.children.shift()}}(),r._isLoading=!1,r._error=null,r.renderStatus();break;case"loading":r.parent||s({"title":l.options.strings.loading+(n?" ("+n+")":""),"checkbox":!1,"tooltip":o},i),r._isLoading=!0,r._error=null,r.renderStatus();break;case"error":s({"title":l.options.strings.loadError+(n?" ("+n+")":""),"checkbox":!1,"tooltip":o},i),r._isLoading=!1,r._error={"message":n,"details":o},r.renderStatus();break;case"nodata":s({"title":n||l.options.strings.noData,"checkbox":!1,"tooltip":o},i),r._isLoading=!1,r._error=null,r.renderStatus();break;default:e.error("invalid node status "+i)}},"nodeToggleExpanded":function(e){return this.nodeSetExpanded(e,!e.node.expanded)},"nodeToggleSelected":function(e){var t=e.node,i=!t.selected;return t.partsel&&!t.selected&&!0===t._lastSelectIntent&&(i=!1,t.selected=!0),t._lastSelectIntent=i,this.nodeSetSelected(e,i)},"treeClear":function(e){var t=e.tree;t.activeNode=null,t.focusNode=null,t.$div.find(">ul.fancytree-container").empty(),t.rootNode.children=null},"treeCreate":function(e){},"treeDestroy":function(e){this.$div.find(">ul.fancytree-container").remove(),this.$source&&this.$source.removeClass("fancytree-helper-hidden")},"treeInit":function(t){var i=t.tree,n=i.options;i.$container.attr("tabindex",n.tabindex),e.each(E,function(e,t){void 0!==n[t]&&(i.info("Move option "+t+" to tree"),i[t]=n[t],delete n[t])}),n.rtl?i.$container.attr("DIR","RTL").addClass("fancytree-rtl"):i.$container.removeAttr("DIR").removeClass("fancytree-rtl"),n.aria&&(i.$container.attr("role","tree"),1!==n.selectMode&&i.$container.attr("aria-multiselectable",!0)),this.treeLoad(t)},"treeLoad":function(i,n){var o,s,r,l=i.tree,a=i.widget.element,c=e.extend({},i,{"node":this.rootNode});if(l.rootNode.children&&this.treeClear(i),n=n||this.options.source)"string"==typeof n&&e.error("Not implemented");else switch(s=a.data("type")||"html"){case"html":r=a.find(">ul:first"),r.addClass("ui-fancytree-source fancytree-helper-hidden"),n=e.ui.fancytree.parseHtml(r),this.data=e.extend(this.data,u(r));break;case"json":n=e.parseJSON(a.text()),a.contents().filter(function(){return 3===this.nodeType}).remove(),e.isPlainObject(n)&&(t(e.isArray(n.children),"if an object is passed as source, it must contain a 'children' array (all other properties are added to 'tree.data')"),o=n,n=n.children,delete o.children,e.each(E,function(e,t){void 0!==o[t]&&(l[t]=o[t],delete o[t])}),e.extend(l.data,o));break;default:e.error("Invalid data-type: "+s)}return this.nodeLoadChildren(c,n).done(function(){l.render(),3===i.options.selectMode&&l.rootNode.fixSelection3FromEndNodes(),l.activeNode&&l.options.activeVisible&&l.activeNode.makeVisible(),l._triggerTreeEvent("init",null,{"status":!0})}).fail(function(){l.render(),l._triggerTreeEvent("init",null,{"status":!1})})},"treeRegisterNode":function(e,t,i){},"treeSetFocus":function(t,i,n){var o;(i=!1!==i)!==this.hasFocus()&&(this._hasFocus=i,!i&&this.focusNode?this.focusNode.setFocus(!1):!i||n&&n.calledByNode||e(this.$container).trigger("focus"),this.$container.toggleClass("fancytree-treefocus",i),this._triggerTreeEvent(i?"focusTree":"blurTree"),i&&!this.activeNode&&(o=this._lastMousedownNode||this.getFirstChild())&&o.setFocus())},"treeSetOption":function(t,i,n){var o=t.tree,s=!0,r=!1,l=!1;switch(i){case"aria":case"checkbox":case"icon":case"minExpandLevel":case"tabindex":r=!0,l=!0;break;case"escapeTitles":case"tooltip":l=!0;break;case"rtl":!1===n?o.$container.removeAttr("DIR").removeClass("fancytree-rtl"):o.$container.attr("DIR","RTL").addClass("fancytree-rtl"),l=!0;break;case"source":s=!1,o._callHook("treeLoad",o,n),l=!0}o.debug("set option "+i+"="+n+" <"+typeof n+">"),s&&(this.widget._super?this.widget._super.call(this.widget,i,n):e.Widget.prototype._setOption.call(this.widget,i,n)),r&&o._callHook("treeCreate",o),l&&o.render(!0,!1)}}),e.widget("ui.fancytree",{"options":{"activeVisible":!0,"ajax":{"type":"GET","cache":!1,"dataType":"json"},"aria":!0,"autoActivate":!0,"autoCollapse":!1,"autoScroll":!1,"checkbox":!1,"clickFolderMode":4,"debugLevel":null,"disabled":!1,"enableAspx":!0,"escapeTitles":!1,"extensions":[],"toggleEffect":{"effect":"slideToggle","duration":200},"generateIds":!1,"icon":!0,"idPrefix":"ft_","focusOnSelect":!1,"keyboard":!0,"keyPathSeparator":"/","minExpandLevel":1,"nodata":!0,"quicksearch":!1,"rtl":!1,"scrollOfs":{"top":0,"bottom":0},"scrollParent":null,"selectMode":2,"strings":{"loading":"Loading...","loadError":"Load error!","moreData":"More...","noData":"No data."},"tabindex":"0","titlesTabbable":!1,"tooltip":!1,"_classNames":{"node":"fancytree-node","folder":"fancytree-folder","animating":"fancytree-animating","combinedExpanderPrefix":"fancytree-exp-","combinedIconPrefix":"fancytree-ico-","hasChildren":"fancytree-has-children","active":"fancytree-active","selected":"fancytree-selected","expanded":"fancytree-expanded","lazy":"fancytree-lazy","focused":"fancytree-focused","partload":"fancytree-partload","partsel":"fancytree-partsel","radio":"fancytree-radio","unselectable":"fancytree-unselectable","lastsib":"fancytree-lastsib","loading":"fancytree-loading","error":"fancytree-error","statusNodePrefix":"fancytree-statusnode-"},"lazyLoad":null,"postProcess":null},"_create":function(){this.tree=new m(this),this.$source=this.source||"json"===this.element.data("type")?this.element:this.element.find(">ul:first");var i,n,s,l=this.options,a=l.extensions,c=this.tree;for(s=0;s<a.length;s++)n=a[s],i=e.ui.fancytree._extensions[n],i||e.error("Could not apply extension '"+n+"' (it is not registered, did you forget to include it?)"),this.tree.options[n]=o({},i.options,this.tree.options[n]),t(void 0===this.tree.ext[n],"Extension name must not exist as Fancytree.ext attribute: '"+n+"'"),this.tree.ext[n]={},r(this.tree,c,i,n),c=i;void 0!==l.icons&&(!0!==l.icon?e.error("'icons' tree option is deprecated since v2.14.0: use 'icon' only instead"):(this.tree.warn("'icons' tree option is deprecated since v2.14.0: use 'icon' instead"),l.icon=l.icons)),void 0!==l.iconClass&&(l.icon?e.error("'iconClass' tree option is deprecated since v2.14.0: use 'icon' only instead"):(this.tree.warn("'iconClass' tree option is deprecated since v2.14.0: use 'icon' instead"),l.icon=l.iconClass)),void 0!==l.tabbable&&(l.tabindex=l.tabbable?"0":"-1",this.tree.warn("'tabbable' tree option is deprecated since v2.17.0: use 'tabindex='"+l.tabindex+"' instead")),this.tree._callHook("treeCreate",this.tree)},"_init":function(){this.tree._callHook("treeInit",this.tree),this._bind()},"_setOption":function(e,t){return this.tree._callHook("treeSetOption",this.tree,e,t)},"destroy":function(){this._unbind(),this.tree._callHook("treeDestroy",this.tree),e.Widget.prototype.destroy.call(this)},"_unbind":function(){var t=this.tree._ns;this.element.off(t),this.tree.$container.off(t),e(document).off(t)},"_bind":function(){var t=this,i=this.options,n=this.tree,o=n._ns;this._unbind(),n.$container.on("focusin"+o+" focusout"+o,function(t){var i=b.getNode(t),o="focusin"===t.type;if(!o&&i&&e(t.target).is("a"))return void i.debug("Ignored focusout on embedded <a> element.");if(o){if(n._getExpiringValue("focusin"))return void n.debug("Ignored double focusin.");n._setExpiringValue("focusin",!0,50),i||(i=n._getExpiringValue("mouseDownNode"))&&n.debug("Reconstruct mouse target for focusin from recent event.")}i?n._callHook("nodeSetFocus",n._makeHookContext(i,t),o):n.tbody&&e(t.target).parents("table.fancytree-container > thead").length?n.debug("Ignore focus event outside table body.",t):n._callHook("treeSetFocus",n,o)}).on("selectstart"+o,"span.fancytree-title",function(e){e.preventDefault()}).on("keydown"+o,function(e){if(i.disabled||!1===i.keyboard)return!0;var t,o=n.focusNode,s=n._makeHookContext(o||n,e),r=n.phase;try{return n.phase="userEvent",t=o?n._triggerNodeEvent("keydown",o,e):n._triggerTreeEvent("keydown",e),"preventNav"===t?t=!0:!1!==t&&(t=n._callHook("nodeKeydown",s)),t}finally{n.phase=r}}).on("mousedown"+o,function(e){var t=b.getEventTarget(e);n._lastMousedownNode=t?t.node:null,n._setExpiringValue("mouseDownNode",n._lastMousedownNode)}).on("click"+o+" dblclick"+o,function(e){if(i.disabled)return!0;var n,o=b.getEventTarget(e),s=o.node,r=t.tree,l=r.phase;if(!s)return!0;n=r._makeHookContext(s,e);try{switch(r.phase="userEvent",e.type){case"click":return n.targetType=o.type,s.isPagingNode()?!0===r._triggerNodeEvent("clickPaging",n,e):!1!==r._triggerNodeEvent("click",n,e)&&r._callHook("nodeClick",n);case"dblclick":return n.targetType=o.type,!1!==r._triggerNodeEvent("dblclick",n,e)&&r._callHook("nodeDblclick",n)}}finally{r.phase=l}})},"getActiveNode":function(){return this.tree.activeNode},"getNodeByKey":function(e){return this.tree.getNodeByKey(e)},"getRootNode":function(){return this.tree.rootNode},"getTree":function(){return this.tree}}),b=e.ui.fancytree,e.extend(e.ui.fancytree,{"version":"2.30.2","buildType":"production","debugLevel":3,"_nextId":1,"_nextNodeKey":1,"_extensions":{},"_FancytreeClass":m,"_FancytreeNodeClass":f,"jquerySupports":{"positionMyOfs":function(t,i,n,o){var s,r,l,a=e.map(e.trim(t).split("."),function(e){return parseInt(e,10)}),c=e.map(Array.prototype.slice.call(arguments,1),function(e){return parseInt(e,10)});for(s=0;s<c.length;s++)if(r=a[s]||0,l=c[s]||0,r!==l)return r>l;return!0}(e.ui.version,1,9)},"assert":function(e,i){return t(e,i)},"createTree":function(t,i){return e(t).fancytree(i).fancytree("getTree")},"debounce":function(e,t,i,n){var o;return 3===arguments.length&&"boolean"!=typeof i&&(n=i,i=!1),function(){var s=arguments;n=n||this,i&&!o&&t.apply(n,s),clearTimeout(o),o=setTimeout(function(){i||t.apply(n,s),o=null},e)}},"debug":function(t){e.ui.fancytree.debugLevel>=4&&i("log",arguments)},"error":function(t){e.ui.fancytree.debugLevel>=1&&i("error",arguments)},"escapeHtml":function(e){return(""+e).replace(x,function(e){return C[e]})},"fixPositionOptions":function(t){if((t.offset||(""+t.my+t.at).indexOf("%")>=0)&&e.error("expected new position syntax (but '%' is not supported)"),!e.ui.fancytree.jquerySupports.positionMyOfs){var i=/(\w+)([+-]?\d+)?\s+(\w+)([+-]?\d+)?/.exec(t.my),n=/(\w+)([+-]?\d+)?\s+(\w+)([+-]?\d+)?/.exec(t.at),o=(i[2]?+i[2]:0)+(n[2]?+n[2]:0),s=(i[4]?+i[4]:0)+(n[4]?+n[4]:0);t=e.extend({},t,{"my":i[1]+" "+i[3],"at":n[1]+" "+n[3]}),(o||s)&&(t.offset=o+" "+s)}return t},"getEventTarget":function(t){var i,n,o=t&&t.target?t.target.className:"",s={"node":this.getNode(t.target),"type":void 0};return/\bfancytree-title\b/.test(o)?s.type="title":/\bfancytree-expander\b/.test(o)?s.type=!1===s.node.hasChildren()?"prefix":"expander":/\bfancytree-checkbox\b/.test(o)?s.type="checkbox":/\bfancytree(-custom)?-icon\b/.test(o)?s.type="icon":/\bfancytree-node\b/.test(o)?s.type="title":t&&t.target&&(i=e(t.target),
i.is("ul[role=group]")?(n=s.node&&s.node.tree,(n||b).debug("Ignoring click on outer UL."),s.node=null):i.closest(".fancytree-title").length?s.type="title":i.closest(".fancytree-checkbox").length?s.type="checkbox":i.closest(".fancytree-expander").length&&(s.type="expander")),s},"getEventTargetType":function(e){return this.getEventTarget(e).type},"getNode":function(t){if(t instanceof f)return t;for(t instanceof e?t=t[0]:void 0!==t.originalEvent&&(t=t.target);t;){if(t.ftnode)return t.ftnode;t=t.parentNode}return null},"getTree":function(t){var i;return t instanceof m?t:(void 0===t&&(t=0),"number"==typeof t?t=e(".fancytree-container").eq(t):"string"==typeof t?t=e(t).eq(0):t instanceof e?t=t.eq(0):void 0!==t.originalEvent&&(t=e(t.target)),t=t.closest(":ui-fancytree"),i=t.data("ui-fancytree")||t.data("fancytree"),i?i.tree:null)},"evalOption":function(t,i,n,o,s){var r,l,a=i.tree,c=o[t],u=n[t];return e.isFunction(c)?(r={"node":i,"tree":a,"widget":a.widget,"options":a.widget.options,"typeInfo":a.types[i.type]||{}},null==(l=c.call(a,{"type":t},r))&&(l=u)):l=null!=u?u:c,null==l&&(l=s),l},"setSpanIcon":function(t,i,n){var o=e(t);"string"==typeof n?o.attr("class",i+" "+n):(n.text?o.text(""+n.text):n.html&&(t.innerHTML=n.html),o.attr("class",i+" "+(n.addClass||"")))},"eventToString":function(e){var t=e.which,i=e.type,n=[];return e.altKey&&n.push("alt"),e.ctrlKey&&n.push("ctrl"),e.metaKey&&n.push("meta"),e.shiftKey&&n.push("shift"),"click"===i||"dblclick"===i?n.push(T[e.button]+i):k[t]||n.push(_[t]||String.fromCharCode(t).toLowerCase()),n.join("+")},"info":function(t){e.ui.fancytree.debugLevel>=3&&i("info",arguments)},"keyEventToString":function(e){return this.warn("keyEventToString() is deprecated: use eventToString()"),this.eventToString(e)},"overrideMethod":function(t,i,n,o){var s,r=t[i]||e.noop;t[i]=function(){var e=o||this;try{return s=e._super,e._super=r,n.apply(e,arguments)}finally{e._super=s}}},"parseHtml":function(t){var i,n,o,s,r,l,a,c,d=t.find(">li"),h=[];return d.each(function(){var d,p,f=e(this),m=f.find(">span:first",this),g=m.length?null:f.find(">a:first"),v={"tooltip":null,"data":{}};for(m.length?v.title=m.html():g&&g.length?(v.title=g.html(),v.data.href=g.attr("href"),v.data.target=g.attr("target"),v.tooltip=g.attr("title")):(v.title=f.html(),(r=v.title.search(/<ul/i))>=0&&(v.title=v.title.substring(0,r))),v.title=e.trim(v.title),s=0,l=S.length;s<l;s++)v[S[s]]=void 0;for(i=this.className.split(" "),o=[],s=0,l=i.length;s<l;s++)n=i[s],A[n]?v[n]=!0:o.push(n);if(v.extraClasses=o.join(" "),a=f.attr("title"),a&&(v.tooltip=a),a=f.attr("id"),a&&(v.key=a),f.attr("hideCheckbox")&&(v.checkbox=!1),(d=u(f))&&!e.isEmptyObject(d)){for(p in N)d.hasOwnProperty(p)&&(d[N[p]]=d[p],delete d[p]);for(s=0,l=O.length;s<l;s++)a=O[s],null!=(c=d[a])&&(delete d[a],v[a]=c);e.extend(v.data,d)}t=f.find(">ul:first"),t.length?v.children=e.ui.fancytree.parseHtml(t):v.children=v.lazy?void 0:null,h.push(v)}),h},"registerExtension":function(i){t(null!=i.name,"extensions must have a `name` property."),t(null!=i.version,"extensions must have a `version` property."),e.ui.fancytree._extensions[i.name]=i},"unescapeHtml":function(e){var t=document.createElement("div");return t.innerHTML=e,0===t.childNodes.length?"":t.childNodes[0].nodeValue},"warn":function(t){e.ui.fancytree.debugLevel>=2&&i("warn",arguments)}}),e.ui.fancytree}),function(e){"function"==typeof csui.define&&csui.define.amd?csui.define("csui/lib/fancytree/jquery.fancytree.filter",["csui/lib/jquery","./jquery.fancytree"],e):"object"==typeof module&&module.exports?(require("./jquery.fancytree"),module.exports=e(require("csui/lib/jquery"))):e(jQuery)}(function(e){"use strict";function t(e){return(e+"").replace(/([.?*+\^\$\[\]\\(){}|-])/g,"\\$1")}function i(t){return t.indexOf(">")>=0?e("<div/>").html(t).text():t}var n=e.ui.fancytree.escapeHtml;return e.ui.fancytree._FancytreeClass.prototype._applyFilterImpl=function(o,s,r){var l,a,c,u,d,h=0,p=this.options,f=p.escapeTitles,m=p.autoCollapse,g=e.extend({},p.filter,r),v="hide"===g.mode,b=!!g.leavesOnly&&!s;if("string"==typeof o){if(""===o)return this.warn("Fancytree passing an empty string as a filter is handled as clearFilter()."),void this.clearFilter();l=g.fuzzy?o.split("").reduce(function(e,t){return e+"[^"+t+"]*"+t}):t(o),c=new RegExp(".*"+l+".*","i"),u=new RegExp(t(o),"gi"),o=function(e){if(!e.title)return!1;var t=f?e.title:i(e.title),o=!!c.test(t);return o&&g.highlight&&(f?(d=t.replace(u,function(e){return"\ufff7"+e+"\ufff8"}),e.titleWithHighlight=n(d).replace(/\uFFF7/g,"<mark>").replace(/\uFFF8/g,"</mark>")):e.titleWithHighlight=t.replace(u,function(e){return"<mark>"+e+"</mark>"})),o}}return this.enableFilter=!0,this.lastFilterArgs=arguments,this.$div.addClass("fancytree-ext-filter"),v?this.$div.addClass("fancytree-ext-filter-hide"):this.$div.addClass("fancytree-ext-filter-dimm"),this.$div.toggleClass("fancytree-ext-filter-hide-expanders",!!g.hideExpanders),this.visit(function(e){delete e.match,delete e.titleWithHighlight,e.subMatchCount=0}),a=this.getRootNode()._findDirectChild("__not_found__"),a&&a.remove(),p.autoCollapse=!1,this.visit(function(e){if(!b||null==e.children){var t=o(e),i=!1;if("skip"===t)return e.visit(function(e){e.match=!1},!0),"skip";t||!s&&"branch"!==t||!e.parent.match||(t=!0,i=!0),t&&(h++,e.match=!0,e.visitParents(function(e){e.subMatchCount+=1,!g.autoExpand||i||e.expanded||(e.setExpanded(!0,{"noAnimation":!0,"noEvents":!0,"scrollIntoView":!1}),e._filterAutoExpanded=!0)}))}}),p.autoCollapse=m,0===h&&g.nodata&&v&&(a=g.nodata,e.isFunction(a)&&(a=a()),!0===a?a={}:"string"==typeof a&&(a={"title":a}),a=e.extend({"statusNodeType":"nodata","key":"__not_found__","title":this.options.strings.noData},a),this.getRootNode().addNode(a).match=!0),this.render(),h},e.ui.fancytree._FancytreeClass.prototype.filterNodes=function(e,t){return"boolean"==typeof t&&(t={"leavesOnly":t},this.warn("Fancytree.filterNodes() leavesOnly option is deprecated since 2.9.0 / 2015-04-19. Use opts.leavesOnly instead.")),this._applyFilterImpl(e,!1,t)},e.ui.fancytree._FancytreeClass.prototype.applyFilter=function(e){return this.warn("Fancytree.applyFilter() is deprecated since 2.1.0 / 2014-05-29. Use .filterNodes() instead."),this.filterNodes.apply(this,arguments)},e.ui.fancytree._FancytreeClass.prototype.filterBranches=function(e,t){return this._applyFilterImpl(e,!0,t)},e.ui.fancytree._FancytreeClass.prototype.clearFilter=function(){var t,i=this.getRootNode()._findDirectChild("__not_found__"),n=this.options.escapeTitles,o=this.options.enhanceTitle;i&&i.remove(),this.visit(function(i){i.match&&i.span&&(t=e(i.span).find(">span.fancytree-title"),n?t.text(i.title):t.html(i.title),o&&o({"type":"enhanceTitle"},{"node":i,"$title":t})),delete i.match,delete i.subMatchCount,delete i.titleWithHighlight,i.$subMatchBadge&&(i.$subMatchBadge.remove(),delete i.$subMatchBadge),i._filterAutoExpanded&&i.expanded&&i.setExpanded(!1,{"noAnimation":!0,"noEvents":!0,"scrollIntoView":!1}),delete i._filterAutoExpanded}),this.enableFilter=!1,this.lastFilterArgs=null,this.$div.removeClass("fancytree-ext-filter fancytree-ext-filter-dimm fancytree-ext-filter-hide"),this.render()},e.ui.fancytree._FancytreeClass.prototype.isFilterActive=function(){return!!this.enableFilter},e.ui.fancytree._FancytreeNodeClass.prototype.isMatched=function(){return!(this.tree.enableFilter&&!this.match)},e.ui.fancytree.registerExtension({"name":"filter","version":"2.30.2","options":{"autoApply":!0,"autoExpand":!1,"counter":!0,"fuzzy":!1,"hideExpandedCounter":!0,"hideExpanders":!1,"highlight":!0,"leavesOnly":!1,"nodata":!0,"mode":"dimm"},"nodeLoadChildren":function(e,t){return this._superApply(arguments).done(function(){e.tree.enableFilter&&e.tree.lastFilterArgs&&e.options.filter.autoApply&&e.tree._applyFilterImpl.apply(e.tree,e.tree.lastFilterArgs)})},"nodeSetExpanded":function(e,t,i){return delete e.node._filterAutoExpanded,!t&&e.options.filter.hideExpandedCounter&&e.node.$subMatchBadge&&e.node.$subMatchBadge.show(),this._superApply(arguments)},"nodeRenderStatus":function(t){var i,n=t.node,o=t.tree,s=t.options.filter,r=e(n.span).find("span.fancytree-title"),l=e(n[o.statusClassPropName]),a=t.options.enhanceTitle,c=t.options.escapeTitles;return i=this._super(t),l.length&&o.enableFilter?(l.toggleClass("fancytree-match",!!n.match).toggleClass("fancytree-submatch",!!n.subMatchCount).toggleClass("fancytree-hide",!(n.match||n.subMatchCount)),!s.counter||!n.subMatchCount||n.isExpanded()&&s.hideExpandedCounter?n.$subMatchBadge&&n.$subMatchBadge.hide():(n.$subMatchBadge||(n.$subMatchBadge=e("<span class='fancytree-childcounter'/>"),e("span.fancytree-icon, span.fancytree-custom-icon",n.span).append(n.$subMatchBadge)),n.$subMatchBadge.show().text(n.subMatchCount)),!n.span||n.isEditing&&n.isEditing.call(n)||(n.titleWithHighlight?r.html(n.titleWithHighlight):c?r.text(n.title):r.html(n.title),a&&a({"type":"enhanceTitle"},{"node":n,"$title":r})),i):i}}),e.ui.fancytree}),csui.define("csui/behaviors/collection.error/collection.error.behavior",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/error/error.view"],function(e,t,i,n){"use strict";function o(t){var i=this.getOption(t);return e.isFunction(i)?i.call(this.view):i}return i.Behavior.extend({"constructor":function(s,r){i.Behavior.prototype.constructor.apply(this,arguments),this.view=r;var l=o.call(this,"collection")||r.collection||r.options.collection,a=r.getEmptyView;r.getEmptyView=function(){return l.error?n:a.apply(r,arguments)};var c=r.emptyViewOptions;r.emptyViewOptions=function(){var i=l.error;return i?{"model":new t.Model({"message":i.message})}:e.isFunction(c)?c.apply(r,arguments):c},this.listenTo(l,"error",function(){r.collection.reset()})}})}),csui.define("hbs!csui/behaviors/collection.state/impl/collection.state",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<p>"+e.escapeExpression((s=null!=(s=r(i,"message")||(null!=t?r(t,"message"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"message","hash":{},"loc":{"start":{"line":1,"column":3},"end":{"line":1,"column":14}}}):s))+"</p>"}});return i.registerPartial("csui_behaviors_collection.state_impl_collection.state",n),n}),csui.define("csui/behaviors/collection.state/collection.state.view",["csui/lib/underscore","csui/lib/marionette","hbs!csui/behaviors/collection.state/impl/collection.state"],function(e,t,i){"use strict";return t.ItemView.extend({"className":"csui-collection-state","template":i,"constructor":function(){t.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change:state",this.render).listenTo(this,"render",this._updateClasses)},"serializeData":function(){return e.extend(this.model.toJSON(),{"message":this.options.stateMessages[this.model.get("state")]})},"_updateClasses":function(){this.$el.removeClass("csui-state-empty csui-state-loading csui-state-failed").addClass("csui-state-"+this.model.get("state"))}})}),csui.define("csui/behaviors/collection.state/collection.state.behavior",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/behaviors/collection.state/collection.state.view"],function(e,t,i,n){"use strict";function o(t){var i=this.getOption(t);return e.isFunction(i)?i.call(this.view):i}return i.Behavior.extend({"constructor":function(s,r){i.Behavior.prototype.constructor.apply(this,arguments),this.view=r;var l=r.collection||r.options.collection,a=o.call(this,"collection")||l;this.listenTo(a,"request",this._fetchingCollectionStarted).listenTo(a,"sync",this._fetchingCollectionSucceeded).listenTo(a,"error",this._fetchingCollectionFailed).listenTo(l,"reset",this._collectionReset),this.collectionState=new t.Model({"state":a.fetching?"loading":a.error?"failed":a.length?"full":"empty"});var c=this.getOption("stateView");!e.isFunction(c)||c.prototype instanceof t.View||(c=c.call(r)),r.emptyView=c||n;var u=this;r.emptyViewOptions=function(){return e.extend({"model":u.collectionState,"stateMessages":o.call(u,"stateMessages")||{}},o.call(u,"stateViewOptions"))}},"_collectionReset":function(e){var t=this.collectionState.get("state");"loading"!==t&&"error"!==t&&this.collectionState.set("state",e.length?"full":"empty")},"_fetchingCollectionStarted":function(){0===this.view.collection.length&&(this.collectionState.set("state","loading"),this.view.collection.reset(),this.view.blockWithoutIndicator&&this.view.blockWithoutIndicator())},"_fetchingCollectionSucceeded":function(){this.collectionState.set("state",this.view.collection.length?"full":"empty"),this.view.unblockActions&&this.view.unblockActions()},"_fetchingCollectionFailed":function(){this.collectionState.set("state","failed"),this.view.unblockActions&&this.view.unblockActions()}})}),csui.define("csui/controls/dialog/dialog.view",["smart/controls/dialog/dialog.view","csui/lib/binf/js/binf"],function(e){return e.extend({"constructor":function(t){e.prototype.constructor.call(this,t)}})}),csui.define("csui/controls/dialog/impl/header.view",["smart/controls/dialog/header.view"],function(e){return e.extend({"constructor":function(t){e.prototype.constructor.call(this,t)}})}),csui.define("csui/controls/dialog/footer.view",["smart/controls/dialog/footer.view"],function(e){return e.extend({"constructor":function(t){e.prototype.constructor.call(this,t)}})}),csui.define("csui/models/facettopic",["csui/lib/backbone"],function(e){"use strict";return e.Model.extend({"idAttribute":"value","constructor":function(){e.Model.prototype.constructor.apply(this,arguments)}})}),csui.define("csui/models/facettopics",["csui/lib/backbone","csui/models/facettopic"],function(e,t){"use strict";return e.Collection.extend({"model":t,"constructor":function(t,i){e.Collection.prototype.constructor.apply(this,arguments)}})}),csui.define("csui/models/facet",["csui/lib/backbone","csui/models/facettopics"],function(e,t){"use strict";return e.Model.extend({"constructor":function(i){e.Model.prototype.constructor.apply(this,arguments),this.topics=new t(i&&i.topics)},"parse":function(e,t){return this.topics&&this.topics.reset(e.topics),e}})}),csui.define("csui/models/facets",["csui/lib/underscore","csui/lib/backbone","csui/models/facet","csui/utils/deepClone/deepClone"],function(e,t,i){"use strict";function n(e){return e.isFetchable&&e.isFetchable()}function o(e,t){return t=!!t,e.filter(function(e){return e.topics.some(function(e){var i=!!e.get("selected");return t===i})}).map(function(e){return e=e.toJSON(),e.topics=e.topics.filter(function(e){var i=!!e.selected;return t===i}),e})}return t.Collection.extend({"model":i,"constructor":function(e,i){t.Collection.prototype.constructor.apply(this,arguments),i||(i={}),this.filters=i.filters||[],this.itemsToShow=i.itemsToShow,this.facetIds=i.facetIds||[]},"clone":function(){return new this.constructor(this.models,{"filters":e.deepClone(this.filters)})},"setFilter":function(t,i,o){if(!e.isEqual(this.filters,t))return this.filters=t,!1!==i&&n(this)&&this.fetch(o),!0},"addFilter":function(t,i,o){var s,r=this.filters,l=[];if(Array.isArray(t)||(t=[t]),t.forEach(function(t){var i=e.findWhere(r,{"id":t.id});if(i){var n=i.values,o=t.values.filter(function(t){return!e.findWhere(n,{"id":t.id})});o.length&&(n.push.apply(n,o),s=!0)}else t.values.length&&l.push(t)}),l.length&&(r.push.apply(r,l),s=!0),s)return!1!==i&&n(this)&&this.fetch(o),!0},"removeFilter":function(t,i,o){var s;if(Array.isArray(t)||(t=[t]),this.filters=this.filters.facet?this.filters.facet:this.filters,this.filters=e.reject(this.filters,function(i){var n=e.findWhere(t,{"id":i.id});if(n){var o=n.values,r=e.reject(i.values,function(t){if(e.findWhere(o,{"id":t.id}))return s=!0,!0});if(!r.length)return s=!0,!0;i.values=r}}),s)return!1!==i&&n(this)&&this.fetch(o),!0},"clearFilter":function(e,t){if(this.filters.length>0)return this.filters=[],!1!==e&&n(this)&&this.fetch(t),!0},"getAvailableFacets":function(){return o(this,!1)},"getSelectedFacets":function(){return o(this,!0)}})}),csui.define("hbs!csui/controls/facet.bar/impl/facet.bar.item",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){return" csui-facet-item-content-readonly "},"3":function(e,t,i,n,o){return" csui-label-readonly "},"5":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <span class="csui-icon binf-close" data-csui-facet="'+e.escapeExpression((s=null!=(s=r(i,"facetId")||(null!=t?r(t,"facetId"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"facetId","hash":{},"loc":{"start":{"line":8,"column":58},"end":{"line":8,"column":69}}}):s))+'"\r\n            data-csui-topic="'+e.escapeExpression((s=null!=(s=r(i,"topicId")||(null!=t?r(t,"topicId"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"topicId","hash":{},"loc":{"start":{"line":9,"column":29},"end":{"line":9,"column":40}}}):s))+'"></span>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<a href="#" role="button" class="csui-facet-item-content'+(null!=(s=l(i,"unless").call(null!=t?t:e.nullContext||{},null!=t?l(t,"enableCloseIcon"):t,{"name":"unless","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":56},"end":{"line":1,"column":128}}}))?s:"")+'" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"facetItemAria")||(null!=t?l(t,"facetItemAria"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"facetItemAria","hash":{},"loc":{"start":{"line":1,"column":142},"end":{"line":1,"column":159}}}):r))+'">\r\n  <div>\r\n    <span class="csui-label'+(null!=(s=l(i,"unless").call(null!=t?t:e.nullContext||{},null!=t?l(t,"enableCloseIcon"):t,{"name":"unless","hash":{},"fn":e.program(3,o,0),"inverse":e.noop,"loc":{"start":{"line":3,"column":27},"end":{"line":3,"column":86}}}))?s:"")+'">\r\n      <span class="csui-facet-item-facet-name">'+e.escapeExpression((r=null!=(r=l(i,"facetName")||(null!=t?l(t,"facetName"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"facetName","hash":{},"loc":{"start":{"line":4,"column":47},"end":{"line":4,"column":60}}}):r))+':</span>\r\n      <span class="csui-facet-item-topic-name">'+e.escapeExpression((r=null!=(r=l(i,"topicName")||(null!=t?l(t,"topicName"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"topicName","hash":{},"loc":{"start":{"line":5,"column":47},"end":{"line":5,"column":60}}}):r))+"</span>\r\n    </span>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"enableCloseIcon"):t,{"name":"if","hash":{},"fn":e.program(5,o,0),"inverse":e.noop,"loc":{"start":{"line":7,"column":4},"end":{"line":10,"column":11}}}))?s:"")+"  </div>\r\n</a>\r\n"}});return i.registerPartial("csui_controls_facet.bar_impl_facet.bar.item",n),n}),csui.define("csui/controls/facet.bar/impl/facet.bar.item.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","hbs!csui/controls/facet.bar/impl/facet.bar.item"],function(e,t,i,n,o){return n.ItemView.extend({"className":"csui-facet-item","tagName":"li","template":o,"ui":{"item":".csui-facet-item","content":".csui-facet-item-content"},"events":{"click @ui.item":"cancelClick","click @ui.content":"cancelClick"},"templateHelpers":function(){return{"enableCloseIcon":this.enableCloseIcon}},"constructor":function(e){this.options=e||{},this.enableCloseIcon=!this.options.model||!this.options.model.get("readOnlyFilter"),n.ItemView.prototype.constructor.apply(this,arguments)},"cancelClick":function(e){t(e.target).hasClass("binf-close")||(e.preventDefault(),e.stopPropagation())}})}),csui.define("csui/controls/facet.bar/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/facet.bar/impl/nls/root/lang",{"clearAll":"Clear all","saveAs":"Save As","saveAsAria":"Save as Virtual Folder","previous":"Show previous filter(s)","next":"Show next filter(s)","filterListAria":"List of active filters","clearAllAria":"Clear all filters","facetItemAria":"Selected filter {0}:{1}, press to clear."}),csui.define("css!csui/controls/facet.bar/impl/facet.bar",[],function(){}),csui.define("csui/controls/facet.bar/facet.bar.items.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/controls/facet.bar/impl/facet.bar.item.view","i18n!csui/controls/facet.bar/impl/nls/lang","css!csui/controls/facet.bar/impl/facet.bar"],function(e,t,i,n,o){return i.CollectionView.extend({"childView":n,"tagName":"ol","className":"csui-facet-list","constructor":function(e){i.CollectionView.prototype.constructor.apply(this,arguments),this.listenTo(this.collection,"reset",this._checkOverflow),this.listenTo(this.collection,"change",this._checkOverflow),this.listenTo(this.collection,"add",this._checkOverflow),this.listenTo(this.collection,"remove",this._checkOverflow),this.listenTo(this,"dom:refresh",this._checkOverflow),this.listenTo(this,"dom:refresh",this._calcScrollSteps)},"onRender":function(){this.$el.attr("aria-label",o.filterListAria)},"_calcScrollSteps":function(){var e=this.$el[0],t=e.offsetWidth,i=e.scrollWidth;this.scrollStepPx=t/3*2,this.maxScrollLeft=i>t?i-t+8:0},"_checkOverflow":function(){if(this.$el.length){var e=this.$el[0],t=e.offsetWidth,i=e.scrollWidth;this.trigger("overflow",t<i),this.trigger("scrolled",{"currentScrollLeft":this.$el.scrollLeft(),"maxScrollLeft":this.maxScrollLeft})}},"scrollLeft":function(){var e=this.$el,t=e.scrollLeft(),i=t;return t<this.maxScrollLeft&&(i=t+this.scrollStepPx,i>this.maxScrollLeft&&(i=this.maxScrollLeft),e.animate({"scrollLeft":i},500)),this.trigger("scrolled",{"currentScrollLeft":i,"maxScrollLeft":this.maxScrollLeft}),i},"scrollRight":function(){var e=this.$el,t=e.scrollLeft(),i=0;return t>this.scrollStepPx&&(i=t-this.scrollStepPx),e.animate({"scrollLeft":i},500),this.trigger("scrolled",{"currentScrollLeft":i,"maxScrollLeft":this.maxScrollLeft}),e.scrollLeft()}})}),csui.define("hbs!csui/controls/facet.bar/impl/facet.bar",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<button class="binf-btn binf-btn-primary csui-filter-save binf-hidden"\r\n        aria-label="'+e.escapeExpression((s=null!=(s=r(i,"saveAsAria")||(null!=t?r(t,"saveAsAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"saveAsAria","hash":{},"loc":{"start":{"line":25,"column":20},"end":{"line":25,"column":34}}}):s))+'">'+e.escapeExpression((s=null!=(s=r(i,"saveas")||(null!=t?r(t,"saveas"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"saveas","hash":{},"loc":{"start":{"line":25,"column":36},"end":{"line":25,"column":46}}}):s))+"</button>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="csui-facet-list-bar">\r\n  <div class="csui-mover csui-overflow-left binf-hidden">\r\n    <a href="#" title="'+e.escapeExpression((r=null!=(r=l(i,"previous")||(null!=t?l(t,"previous"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"previous","hash":{},"loc":{"start":{"line":3,"column":23},"end":{"line":3,"column":35}}}):r))+'" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"previous")||(null!=t?l(t,"previous"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"previous","hash":{},"loc":{"start":{"line":3,"column":49},"end":{"line":3,"column":61}}}):r))+'">\r\n      <span class="csui-icon goto_previous_page"  ></span>\r\n    </a>\r\n    <span class="csui-facet-list-fade csui-facet-list-fadein"></span>\r\n  </div>\r\n\r\n  <div class="csui-facet-list-area"></div>\r\n\r\n  <div class="csui-mover csui-overflow-right binf-hidden">\r\n    <span class="csui-facet-list-fade csui-facet-list-fadeout"></span>\r\n    <a href="#" title="'+e.escapeExpression((r=null!=(r=l(i,"next")||(null!=t?l(t,"next"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"next","hash":{},"loc":{"start":{"line":13,"column":23},"end":{"line":13,"column":31}}}):r))+'" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"next")||(null!=t?l(t,"next"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"next","hash":{},"loc":{"start":{"line":13,"column":45},"end":{"line":13,"column":53}}}):r))+'">\r\n      <span class="csui-icon goto_next_page" ></span>\r\n    </a>\r\n  </div>\r\n</div>\r\n\r\n<a href="#" class="csui-clear-all binf-hidden" role="button" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"clearAllAria")||(null!=t?l(t,"clearAllAria"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"clearAllAria","hash":{},"loc":{"start":{"line":19,"column":73},"end":{"line":19,"column":89}}}):r))+"\">\r\n  <div class='cs-icon binf-close'></div>\r\n  <div class='clear-label'>"+e.escapeExpression((r=null!=(r=l(i,"clearAll")||(null!=t?l(t,"clearAll"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"clearAll","hash":{},"loc":{"start":{"line":21,"column":27},"end":{"line":21,"column":39}}}):r))+"</div>\r\n</a>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"showSaveFilter"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":23,"column":0},"end":{"line":26,"column":7}}}))?s:"")}});return i.registerPartial("csui_controls_facet.bar_impl_facet.bar",n),n}),csui.define("csui/controls/facet.bar/savefilter.unsupported.list.ids",["csui/lib/underscore","csui-ext!csui/controls/facet.bar/savefilter.unsupported.list.ids"],function(e,t){"use strict";return e.flatten(t)}),csui.define("csui/controls/facet.bar/facet.bar.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/models/facets","csui/models/facettopics","csui/controls/facet.bar/facet.bar.items.view","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/controls/facet.bar/impl/facet.bar","i18n!csui/controls/facet.bar/impl/nls/lang","csui/utils/commands","csui/controls/facet.bar/savefilter.unsupported.list.ids","css!csui/controls/facet.bar/impl/facet.bar"],function(e,t,i,n,o,s,r,l,a,c,u,d){"use strict";return n.LayoutView.extend({"className":"csui-facet-bar csui-facet-bar-hidden","template":a,"ui":{"facetListArea":"> .csui-facet-list-bar > .csui-facet-list-area","facetList":"> .csui-facet-list-bar > .div.csui-facet-list-area > .csui-facet-list","clearAll":".csui-clear-all","moveLeft":".csui-overflow-left","moveRight":".csui-overflow-right","movers":".csui-mover","leftFader":".csui-mover.csui-overflow-left > .csui-facet-list-fade","rightFader":".csui-mover.csui-overflow-right > .csui-facet-list-fade","saveFilter":".csui-filter-save"},"regions":{"facetBarItemsRegion":".csui-facet-list-area","clearAllRegion":".csui-clear-all"},"triggers":{"click .csui-clear-all":"clear:all"},"events":{"click @ui.moveLeft":"onMoveLeft","click @ui.moveRight":"onMoveRight","click .csui-facet-item .binf-close":"onRemoveFilter","click @ui.saveFilter":"onClickSaveFilter","keydown":"onKeyInView"},"constructor":function(o){n.LayoutView.prototype.constructor.apply(this,arguments),this.allTopicsCollection=new i.Collection(this._getAllTopics(this.collection.filters)),this.listenTo(this.collection,"reset",this._filtersUpdated,this),this.listenTo(this.collection,"set:readonly",this._filtersUpdated,this),this.onWinResize=t.bind(function(){this.render(),this._filtersUpdated()},this),e(window).on("resize.facetview",this.onWinResize)},"onKeyInView":function(t){var i=t.keyCode,n=!0,o=e(t.target);switch(i){case 46:o.parent().hasClass("csui-facet-item")&&(this._triggerRemoveFilter(o.find(".binf-close")),n=!1);break;case 13:o.parent().hasClass("csui-facet-item")&&(this._triggerRemoveFilter(o.find(".binf-close")),n=!1),o.hasClass("csui-clear-all")&&(this.ui.saveFilter&&this.ui.saveFilter.length>0&&this.ui.saveFilter.addClass("binf-hidden"),this.trigger("remove:all"),n=!1);break;case 32:n=!1}return n},"onDestroy":function(){e(window).off("resize.facetview",this.onWinResize)},"onRender":function(){this.visibleItemIndex=0,this.facetBarItemsView=new r({"collection":this.allTopicsCollection}),this.listenTo(this.facetBarItemsView,"overflow",this._makeSlideable),this.listenTo(this.facetBarItemsView,"scrolled",this._updateFading),this.facetBarItemsRegion.show(this.facetBarItemsView)},"onMoveLeft":function(e){e.preventDefault(),e.stopPropagation(),this.facetBarItemsView.scrollRight()},"onMoveRight":function(e){e.preventDefault(),e.stopPropagation(),this.facetBarItemsView.scrollLeft()},"_makeSlideable":function(e){e?(this.ui.facetListArea.addClass("csui-facet-list-overflowed"),this.ui.movers.removeClass("binf-hidden")):(this.ui.facetListArea.removeClass("csui-facet-list-overflowed"),this.ui.movers.addClass("binf-hidden"))},"_updateFading":function(e){0===e.currentScrollLeft?(this.ui.leftFader.addClass("binf-hidden"),this.ui.rightFader.removeClass("binf-hidden")):e.currentScrollLeft===e.maxScrollLeft?(this.ui.leftFader.removeClass("binf-hidden"),this.ui.rightFader.addClass("binf-hidden")):(this.ui.leftFader.removeClass("binf-hidden"),this.ui.rightFader.removeClass("binf-hidden"))},"_getAllTopics":function(){for(var e=[],i=this.collection.filters,n=0;n<i.length;n++){var o=i[n],s=o.values,r=o.id,l=o.readOnlyFilter,a=this.collection.get(r);if(a)for(var u=!!a&&a.get("name"),d=0;d<s.length;d++){var h=s[d],p=h.id,f=!!a.topics&&a.topics.get(p),m=!!f&&f.get("name");e.push({"facetName":u,"topicName":m,"facetId":r,"topicId":p,"facetItemAria":t.str.sformat(c.facetItemAria,u,m),"readOnlyFilter":l})}}return e},"_filtersUpdated":function(){var e=this._getAllTopics(this.collection.filters);if(this.allTopicsCollection.reset(e),this.allTopicsCollection.length>0){this.$el.removeClass("csui-facet-bar-hidden");e.some(function(e){return!0===e.readOnlyFilter})?this.$el.find(".csui-clear-all").addClass("binf-hidden"):this.$el.find(".csui-clear-all").removeClass("binf-hidden"),this.trigger("facet:bar:visible")}else this.$el.addClass("csui-facet-bar-hidden"),this.$el.find(".csui-clear-all").addClass("binf-hidden"),this.$el.find(".csui-filter-save").addClass("binf-hidden"),this.trigger("facet:bar:hidden");this.showSaveFilter&&this.allTopicsCollection.length>0&&this.ui.saveFilter&&this.ui.saveFilter.length>0&&this.ui.saveFilter.removeClass("binf-hidden"),this.facetBarItemsView&&this.facetBarItemsView.trigger("dom:refresh")},"showOrHideSaveFilterButton":function(){var e=this;if(d.length>0){return!t.some(d,function(i){var n="function"==typeof i.saveFilterUnsupportedList?i.saveFilterUnsupportedList(e.options):i.saveFilterUnsupportedList,o=e.options.context.getModel("node").attributes.type;if(t.isArray(n)||t.isNumber(n))return t.isArray(n)?t.contains(n,o):n===o;throw new Error("Unsupported object type")})}if(t.has(this.options,"showSaveFilter"))return this.options.showSaveFilter;var i=this.options.context&&this.options.context._factories.objecttypes&&t.has(this.options.context._factories.objecttypes.property.attributes,"objecttypes")&&this.options.context._factories.objecttypes.property.attributes.objecttypes;return!!t.find(i,function(e){return 899===e.type})},"templateHelpers":function(){return this.showSaveFilter=this.showOrHideSaveFilterButton(),{"clearAll":c.clearAll,"saveas":c.saveAs,"saveAsAria":c.saveAsAria,"showSaveFilter":this.showSaveFilter,"previous":c.previous,"next":c.next,"clearAllAria":c.clearAllAria}},"onClearAll":function(){
this.trigger("remove:all")},"onRemoveFilter":function(t){t.preventDefault(),t.stopPropagation(),this._triggerRemoveFilter(e(t.target))},"applyFilter":function(e){this.trigger("apply:filter",e.newFilter)},"onClickSaveFilter":function(e){e.preventDefault(),e.stopPropagation();var t=this.options.context,n=this.collection.connector,o=this.collection.node,s=this.collection,r=u.get("SaveFilter"),l=r.execute({"context":t,"nodes":new i.Collection(o),"facets":s,"container":o,"connector":n});l.always(function(){l.state()})},"_triggerRemoveFilter":function(e){this.trigger("remove:filter",{"id":e.attr("data-csui-facet"),"values":[{"id":e.attr("data-csui-topic")}]})}})}),csui.define("csui/controls/list/behaviors/list.item.keyboard.behavior",["module","csui/lib/underscore","csui/lib/jquery","csui/utils/log","csui/lib/marionette"],function(e,t,i,n,o){"use strict";function s(e){e.preventDefault(),e.stopPropagation()}return o.Behavior.extend({"ui":{"titleName":".list-item-title","moreActions":".csui-tileview-more-btn"},"events":function(){var e={"keydown @ui.titleName":"_doDefaultAction"};return e=this.view.showInlineActionBar?t.extend(e,{"keydown":"_handleInlineKeyDown"}):t.extend(e,{"keydown":"_doDefaultAction"})},"constructor":function(e,t){o.Behavior.prototype.constructor.apply(this,arguments)},"_doDefaultAction":function(e){13!=e.keyCode&&32!=e.keyCode||(e.stopPropagation(),this.view.trigger("click:item",{"target":this.view.model}))},"_handleInlineKeyDown":function(e){var t=i(e.target);switch(e.keyCode){case 13:this.view.onShowInlineMenu(e),this.ui.titleName.prop("tabindex",-1).trigger("focus"),s(e);break;case 27:this.view.onHideInlineMenu()&&(this.$el.trigger("focus"),s(e));break;case 37:this.ui.moreActions.is(t)||this.ui.moreActions.has(t).length?(this.ui.titleName.prop("tabindex",-1).trigger("focus"),s(e)):this.ui.titleName.is(t)&&s(e);break;case 39:this.ui.titleName.is(t)&&(this.view._inlineMenuView.acquireFocus(),s(e));break;default:(this.ui.moreActions.is(t)||this.ui.moreActions.has(t).length||this.ui.titleName.is(t))&&e.keyCode>=33&&e.keyCode<=40&&s(e)}}})}),csui.define("hbs!csui/controls/listitem/impl/inline.menu/inline.menu",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\r\n      title="'+e.escapeExpression((s=null!=(s=r(i,"dropDownText")||(null!=t?r(t,"dropDownText"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"dropDownText","hash":{},"loc":{"start":{"line":2,"column":13},"end":{"line":2,"column":29}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=r(i,"dropDownText")||(null!=t?r(t,"dropDownText"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"dropDownText","hash":{},"loc":{"start":{"line":2,"column":43},"end":{"line":2,"column":59}}}):s))+'" tabindex="-1"'},"3":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<span class="'+e.escapeExpression((s=null!=(s=r(i,"dropDownIcon")||(null!=t?r(t,"dropDownIcon"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"dropDownIcon","hash":{},"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":51}}}):s))+'"></span>'},"5":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=(r(i,"icon-v2")||t&&r(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"states":"true","iconName":null!=t?r(t,"dropDownIconName"):t},"loc":{"start":{"line":4,"column":26},"end":{"line":4,"column":79}}}))?s:""},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="csui-icon-group csui-menu-btn" role="button" aria-expanded="false" '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"dropDownText"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":79},"end":{"line":2,"column":81}}}))?s:"")+">\r\n  "+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"dropDownIcon"):t,{"name":"if","hash":{},"fn":e.program(3,o,0),"inverse":e.noop,"loc":{"start":{"line":3,"column":2},"end":{"line":3,"column":67}}}))?s:"")+"\r\n  "+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"dropDownIconName"):t,{"name":"if","hash":{},"fn":e.program(5,o,0),"inverse":e.noop,"loc":{"start":{"line":4,"column":2},"end":{"line":4,"column":86}}}))?s:"")+'\r\n</div>\r\n<div class="csui-icon-group csui-loading-parent-wrapper binf-disabled binf-hidden"\r\n      title="'+e.escapeExpression((r=null!=(r=l(i,"loadingTitle")||(null!=t?l(t,"loadingTitle"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"loadingTitle","hash":{},"loc":{"start":{"line":7,"column":13},"end":{"line":7,"column":29}}}):r))+'" role="presentation" tabindex="-1">\r\n  <div class="csui-loading-dots-wrapper">\r\n    <span class="csui-loading-dot"></span>\r\n    <span class="csui-loading-dot"></span>\r\n    <span class="csui-loading-dot"></span>\r\n  </div>\r\n</div>\r\n<div class="csui-menu-btn-region binf-hidden"></div>'}});return i.registerPartial("csui_controls_listitem_impl_inline.menu_inline.menu",n),n}),csui.define("csui/controls/listitem/impl/inline.menu/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/listitem/impl/inline.menu/nls/root/lang",{"loadingActions":"Loading {0}"}),csui.define("css!csui/controls/listitem/impl/inline.menu/inline.menu",[],function(){}),csui.define("csui/controls/listitem/impl/inline.menu/inline.menu.view",["require","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/controls/globalmessage/globalmessage","hbs!csui/controls/listitem/impl/inline.menu/inline.menu","i18n!csui/controls/listitem/impl/inline.menu/nls/lang","css!csui/controls/listitem/impl/inline.menu/inline.menu"],function(e,t,i,n,o,s,r,l){"use strict";return n.ItemView.extend({"tagName":"div","className":"csui-inline-menu","template":r,"templateHelpers":function(){return{"dropDownText":this.inlineActionbarOptions.dropDownText,"dropDownIconName":this.inlineActionbarOptions.dropDownIconName,"loadingTitle":t.str.sformat(l.loadingActions,this.inlineActionbarOptions.dropDownText),"dropDownIcon":this.inlineActionbarOptions.dropDownIcon}},"ui":{"moreToggle":".csui-menu-btn","toolbarContainer":".csui-menu-btn-region","dropdownToggle":".csui-menu-btn-region .binf-dropdown .binf-dropdown-toggle","loadingContainer":".csui-loading-parent-wrapper"},"events":{"click @ui.moreToggle":"onClickMenuButton","click @ui.dropdownToggle":"onClickMenuButton","keydown @ui.moreToggle":"onKeydownMenu","keydown @ui.dropdownToggle":"onKeydownMenu","click":"_onClickInlineMenu"},"constructor":function(e){e||(e={}),this.tileViewToolbarItems=e.tileViewToolbarItems||{},this.inlineActionbar=this.tileViewToolbarItems.inlineActionbar,this.inlineActionbarOptions=this.inlineActionbar&&this.inlineActionbar.options||{},n.ItemView.call(this,e)},"onBeforeDestroy":function(){this._destroyInlineMenu()},"_onClickInlineMenu":function(e){e.stopPropagation(),e.preventDefault()},"onClickMenuButton":function(e){e.preventDefault(),e.stopPropagation();var t=!!this.model.get("csuiLazyActionsRetrieved"),i=this.model.nonPromotedActionCommands;if(!t&&i&&i.length){var n=this;this._toggleLoadingIcon(!0),this.ui.loadingContainer.trigger("focus"),this.model.setEnabledLazyActionCommands(!0).done(function(){setTimeout(function(){n._showInlineMenu(e)},300)}).fail(function(e){n._toggleLoadingIcon(!1);var t=new o.Error(e);s.showMessage("error",t.message)})}else this._showInlineMenu(e)},"onKeydownMenu":function(e){switch(e.which){case 13:case 32:case 40:return this.onClickMenuButton(e),!1}},"acquireFocus":function(){this.$el.find("*[tabindex]:visible").first().trigger("focus")},"_toggleLoadingIcon":function(e){this.$el.attr("aria-busy",!!e),e?(this.ui.moreToggle.addClass("binf-hidden"),this.ui.loadingContainer.removeClass("binf-hidden")):(this.ui.moreToggle.removeClass("binf-hidden"),this.ui.loadingContainer.addClass("binf-hidden"))},"_toggleMenuButton":function(){this.ui.moreToggle.addClass("binf-hidden"),this.ui.loadingContainer.addClass("binf-hidden"),this.ui.toolbarContainer.removeClass("binf-hidden")},"_focusFirstItem":function(e){"keydown"==e.type&&this.$el.find(".binf-dropdown-menu li:first a").trigger("focus")},"closeDropdownMenuIfOpen":function(){this.inlineMenuBarView&&this.inlineMenuBarView.closeDropdownMenuIfOpen()&&this._removeContainerShowingInlineMenuClass()},"_addContainerShowingInlineMenuClass":function(){this.$el.closest(".tile-content").addClass("showing-inline-menu"),o.isEdge()&&this.inlineMenuBarView.$el.find("li.binf-dropdown a").each(function(){var e=i(this).attr("title");e&&i(this).data("title",e).removeAttr("title")})},"_removeContainerShowingInlineMenuClass":function(){this.$el.closest(".tile-content").removeClass("showing-inline-menu"),o.isEdge()&&this.inlineMenuBarView.$el.find("li.binf-dropdown a").each(function(){i(this).attr("title",i(this).data("title"))})},"_showInlineMenu":function(o){if(!this.isDestroyed){if(this.inlineMenuBarView)return this._addContainerShowingInlineMenuClass(),this.inlineMenuBarView.toggleDropdownMenu(),void this._focusFirstItem(o);e(["csui/controls/tableactionbar/tableactionbar.view"],t.bind(function(e){this.inlineMenuBarView=new e(t.extend({"context":this.options.context,"originatingView":this.options.originatingView,"commands":this.options.commands,"model":this.model,"collection":this.inlineActionbar,"containerCollection":this.model.collection,"status":{"originatingView":this.options.originatingView}},this.inlineActionbarOptions)),this._toggleMenuButton();var s=this.$el.find(".csui-menu-btn-region");new n.Region({"el":s}).show(this.inlineMenuBarView),this.listenTo(this.inlineMenuBarView,"before:execute:command",function(e){this.trigger("before:execute:command",e)}),this.listenTo(this.inlineMenuBarView,"after:execute:command",function(e){this.trigger("after:execute:command",e)}),this.listenTo(this.inlineMenuBarView,"destroy",function(e){i(document).off("scroll.inline.menu"),this._removeContainerShowingInlineMenuClass()});var r=this.inlineMenuBarView.$el.find("li.binf-dropdown");i(window).on("resize",this.closeDropdownMenuIfOpen.bind(this)),r.on("show.binf.dropdown",t.bind(function(){this._addContainerShowingInlineMenuClass()},this)),r.on("hide.binf.dropdown",t.bind(function(){this._removeContainerShowingInlineMenuClass()},this)),i(document).on("scroll.inline.menu",this.closeDropdownMenuIfOpen.bind(this)),this._addContainerShowingInlineMenuClass(),this.inlineMenuBarView.toggleDropdownMenu(!0),this._focusFirstItem(o)},this))}},"_destroyInlineMenu":function(){this.inlineMenuBarView&&this.inlineMenuBarView.destroy()}})}),csui.define("hbs!csui/controls/listitem/impl/listitemstandard",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){return'<a class="csui-tileview-contains-more-btn" tabindex="-1"> '},"3":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="csui-type-icon '+e.escapeExpression((s=null!=(s=r(i,"icon")||(null!=t?r(t,"icon"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"icon","hash":{},"loc":{"start":{"line":2,"column":45},"end":{"line":2,"column":53}}}):s))+'"></div>'},"5":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="'+e.escapeExpression((s=null!=(s=r(i,"end-icon-class")||(null!=t?r(t,"end-icon-class"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"end-icon-class","hash":{},"loc":{"start":{"line":4,"column":28},"end":{"line":4,"column":46}}}):s))+'"></div>'},"7":function(e,t,i,n,o){return'<div class="csui-tileview-more-btn"></div>'},"9":function(e,t,i,n,o){return"</a>"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"showInlineActionBar"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":0},"end":{"line":1,"column":92}}}))?s:"")+"\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"enableIcon"):t,{"name":"if","hash":{},"fn":e.program(3,o,0),"inverse":e.noop,"loc":{"start":{"line":2,"column":0},"end":{"line":2,"column":68}}}))?s:"")+'\r\n<div title="'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":20}}}):r))+'" class="list-item-title" role="link" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"itemLabel")||(null!=t?l(t,"itemLabel"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"itemLabel","hash":{},"loc":{"start":{"line":3,"column":70},"end":{"line":3,"column":83}}}):r))+'">'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":3,"column":85},"end":{"line":3,"column":93}}}):r))+"</div>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"end-icon"):t,{"name":"if","hash":{},"fn":e.program(5,o,0),"inverse":e.noop,"loc":{"start":{"line":4,"column":0},"end":{"line":4,"column":61}}}))?s:"")+"\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"showInlineActionBar"):t,{"name":"if","hash":{},"fn":e.program(7,o,0),"inverse":e.noop,"loc":{"start":{"line":5,"column":0},"end":{"line":5,"column":76}}}))?s:"")+"\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"showInlineActionBar"):t,{"name":"if","hash":{},"fn":e.program(9,o,0),"inverse":e.noop,"loc":{"start":{"line":6,"column":0},"end":{"line":6,"column":38}}}))?s:"")+"\r\n"}});return i.registerPartial("csui_controls_listitem_impl_listitemstandard",n),n}),csui.define("css!csui/controls/listitem/impl/listitemstandard",[],function(){}),csui.define("csui/controls/listitem/listitemstandard.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/behaviors/default.action/default.action.behavior","csui/controls/list/behaviors/list.item.keyboard.behavior","csui/utils/node.links/node.links","csui/controls/listitem/impl/inline.menu/inline.menu.view","csui/utils/accessibility","hbs!csui/controls/listitem/impl/listitemstandard","css!csui/controls/listitem/impl/listitemstandard"],function(e,t,i,n,o,s,r,l,a,c){"use strict";var u=a.isAccessibleTable();return i.ItemView.extend({"tagName":function(){return this.showInlineActionBar?"div":"a"},"className":"csui-item-standard binf-list-group-item","behaviors":{"DefaultAction":{"behaviorClass":o},"ListItemKeyboardBehavior":{"behaviorClass":s}},"template":c,"templateHelpers":function(){return e.reduce(this.options,function(e,t,i){if("string"==typeof t){var n=this._getValue(t);"icon"===i&&(n="csui-icon "+n,e.enableIcon=!0),e[i]=n}return e},{},this)},"constructor":function(t){t||(t={}),t.toolbarData&&this._setInlineActions(t),this.context=t.context,i.ItemView.call(this,t),this.listenTo(this,"doc:preview:generic:actions",this._highlightRow),this.$el.on("click",e.bind(function(e){n.isControlClick(e)||(e.preventDefault(),e.stopPropagation(),this.triggerMethod("click:item"))},this))},"_highlightRow":function(e,i){t("."+i).removeClass(i),this.$el.addClass(i)},"_setInlineActions":function(e){this.showInlineActionBar=!0,this.tileViewToolbarItems=e.toolbarData.toolbaritems,this.ui={"titleName":".list-item-title","icon":".csui-icon-group"},u||(this.events={"mouseenter":"onShowInlineMenu","mouseleave":"onHideInlineMenu","wheel":"onWheelEvent"})},"cascadeDestroy":function(){return!1},"setElementData":function(){var e;return this.showInlineActionBar?e=this.$el.find("a"):(e=this.$el,e.prop("tabindex","-1")),e},"onRender":function(){var e=this.model&&this.model.get("id");if(this.eleData=this.setElementData(),null!=e&&this.eleData.attr("href",r.getUrl(this.model)),this.options.refetchNodeActions&&this.model&&(this.model.refetchNodeActions=!0),this.model&&this.options&&this.options.checkDefaultAction){var t=!1===this.model.fetched||!this.defaultActionController.hasAction(this.model);this.$el[t?"addClass":"removeClass"]("inactive")}this.$el.removeAttr("role"),n.isHybrid()&&this.onShowInlineMenu()},"_getValue":function(t){if(0===t.indexOf("{")){var i=t.substring(1,t.length-1).split("."),n=this.model.attributes;return e.find(i,function(e){if(void 0===(n=n[e]))return!0}),n}return t},"onShowInlineMenu":function(e){var t=this.$el.find(".csui-tileview-more-btn");if(!n.isHybrid()||!e&&t.length){e&&e.preventDefault(),e&&e.stopPropagation(),this.$el.addClass("csui-tile-with-more-btn"),this._inlineMenuView=new l({"context":this.options.context,"originatingView":this,"commands":this.defaultActionController.commands,"model":this.model,"tileViewToolbarItems":this.tileViewToolbarItems});new i.Region({"el":t}).show(this._inlineMenuView),this.listenTo(this._inlineMenuView,"before:execute:command",function(e){this.trigger("before:execute:command",e)}),this.listenTo(this._inlineMenuView,"after:execute:command",function(){n.isHybrid()||this.onHideInlineMenu()})}},"onHideInlineMenu":function(e){return e&&n.isHybrid()?void(this._inlineMenuView&&this._inlineMenuView.inlineMenuBarView&&this._inlineMenuView.inlineMenuBarView.closeDropdownMenuIfOpen()):(this.$el.removeClass("csui-tile-with-more-btn"),this._inlineMenuView?(this._inlineMenuView.destroy(),this._inlineMenuView=void 0,!0):void 0)},"onWheelEvent":function(e){this._inlineMenuView&&this._inlineMenuView.closeDropdownMenuIfOpen()}})}),csui.define("hbs!csui/controls/list/impl/simplelist",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="cs-header binf-panel-heading cs-header-with-go-back" tabindex="0" role="link" aria-label="'+e.escapeExpression((s=null!=(s=r(i,"goBackAria")||(null!=t?r(t,"goBackAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"goBackAria","hash":{},"loc":{"start":{"line":2,"column":104},"end":{"line":2,"column":118}}}):s))+'">\r\n    <span class="icon circular arrow_back cs-go-back" title="'+e.escapeExpression((s=null!=(s=r(i,"goBackTooltip")||(null!=t?r(t,"goBackTooltip"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"goBackTooltip","hash":{},"loc":{"start":{"line":3,"column":61},"end":{"line":3,"column":78}}}):s))+'"></span>\r\n    <span class="cs-title cs-title-with-go-back" title="'+e.escapeExpression((s=null!=(s=r(i,"title")||(null!=t?r(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":4,"column":56},"end":{"line":4,"column":65}}}):s))+'">'+e.escapeExpression((s=null!=(s=r(i,"title")||(null!=t?r(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":4,"column":67},"end":{"line":4,"column":76}}}):s))+"</span>\r\n  </div>\r\n"},"3":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=r(i,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"title"):t,{"name":"if","hash":{},"fn":e.program(4,o,0),"inverse":e.noop,"loc":{"start":{"line":6,"column":0},"end":{"line":10,"column":0}}}))?s:""},"4":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="cs-header binf-panel-heading" tabindex="0">\r\n    <span class="cs-title" title="'+e.escapeExpression((s=null!=(s=r(i,"title")||(null!=t?r(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":8,"column":34},"end":{"line":8,"column":43}}}):s))+'">'+e.escapeExpression((s=null!=(s=r(i,"title")||(null!=t?r(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":8,"column":45},"end":{"line":8,"column":54}}}):s))+"</span>\r\n  </div>\r\n"},"6":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return' role="'+e.escapeExpression((s=null!=(s=r(i,"listRole")||(null!=t?r(t,"listRole"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"listRole","hash":{},"loc":{"start":{"line":13,"column":51},"end":{"line":13,"column":63}}}):s))+'"'},"8":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return' aria-label="'+e.escapeExpression((s=null!=(s=r(i,"listAria")||(null!=t?r(t,"listAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"listAria","hash":{},"loc":{"start":{"line":13,"column":100},"end":{"line":13,"column":112}}}):s))+'"'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(s=r(i,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"back_button"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.program(3,o,0),"loc":{"start":{"line":1,"column":0},"end":{"line":10,"column":7}}}))?s:"")+'\r\n<div class="cs-content csui-normal-scrolling">\r\n  <div class="cs-list-group"'+(null!=(s=r(i,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"listRole"):t,{"name":"if","hash":{},"fn":e.program(6,o,0),"inverse":e.noop,"loc":{"start":{"line":13,"column":28},"end":{"line":13,"column":71}}}))?s:"")+(null!=(s=r(i,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"listAria"):t,{"name":"if","hash":{},"fn":e.program(8,o,0),"inverse":e.noop,"loc":{"start":{"line":13,"column":71},"end":{"line":13,"column":120}}}))?s:"")+"></div>\r\n</div>\r\n"}});return i.registerPartial("csui_controls_list_impl_simplelist",n),n}),csui.define("hbs!csui/controls/list/impl/simplelistitem",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'aria-label="'+e.escapeExpression((s=null!=(s=r(i,"nameTitleAria")||(null!=t?r(t,"nameTitleAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"nameTitleAria","hash":{},"loc":{"start":{"line":1,"column":84},"end":{"line":1,"column":101}}}):s))+'"'},"3":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<span class="csui-type-icon '+e.escapeExpression((s=null!=(s=r(i,"icon")||(null!=t?r(t,"icon"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"icon","hash":{},"loc":{"start":{"line":2,"column":46},"end":{"line":2,"column":54}}}):s))+'"></span>'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="binf-list-group-item" title="'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":1,"column":41},"end":{"line":1,"column":49}}}):r))+'" '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"nameTitleAria"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":51},"end":{"line":1,"column":109}}}))?s:"")+">\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"enableIcon"):t,{"name":"if","hash":{},"fn":e.program(3,o,0),"inverse":e.noop,"loc":{"start":{"line":2,"column":0},"end":{"line":2,"column":70}}}))?s:"")+'\r\n<div title="'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":20}}}):r))+'" class="list-item-title">'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":3,"column":46},"end":{"line":3,"column":54}}}):r))+"</div>\r\n</div>\r\n"}});return i.registerPartial("csui_controls_list_impl_simplelistitem",n),n}),csui.define("csui/controls/list/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/list/impl/nls/root/lang",{"goBackTooltip":"Go back","goBackAria":"Go back to {0}","goBackTitleForEmptyTitle":"Back","emptyViewDefaultText":"No items.","clearAll":"Clear","clearAllAria":"Clear search","expandView":"Expand","expandAria":"Expand {0} widget","searchView":"Search","searchAria":"Search {0} widget","collapseSearch":"Close search","collapseAria":"Clear all and close search","elementsVisibleAria":"{0} Elements are visible in {1}","nameTitleAria":"{0} of type {1}","openPerspective":"Open Perspective","openPerspectiveTooltip":"Open Perspective"}),csui.define("css!csui/controls/list/impl/simplelist",[],function(){}),csui.define("csui/controls/list/simplelist.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/listitem/listitemstandard.view","csui/utils/node.links/node.links","hbs!csui/controls/list/impl/simplelist","hbs!csui/controls/list/impl/simplelistitem","csui/utils/nodesprites","i18n!csui/controls/list/impl/nls/lang","css!csui/controls/list/impl/simplelist"],function(e,t,i,n,o,s,r,l,a,c,u){"use strict";var d=n.ItemView.extend({"constructor":function(){n.ItemView.prototype.constructor.apply(this,arguments)},"tagName":"a","template":a,"events":{"click":"onClickItem"},"serializeData":function(){var e=n.ItemView.prototype.serializeData.apply(this,arguments);if(e){var t=e.icon;t&&(e.icon="csui-icon "+t)}return e},"onRender":function(){null!=(this.model&&this.model.get("id"))&&this.$el.attr("href",r.getUrl(this.model));var t,i=c.findByNode(this.model)||{};i.attributes&&(t=i.get("mimeType"));var n=t||this.model.get("type_name")||this.model.get("type");if(this.model.get("name")&&n){var o=e.str.sformat(u.nameTitleAria,this.model.get("name"),n);this.$el.attr("aria-label",o)}this.$el.attr("role",this.options.childRole)},"onClickItem":function(e){o.isControlClick(e)||(e.preventDefault(),e.stopPropagation(),this.trigger("click:item"))},"modelEvents":{"change":"render"}});return n.CompositeView.extend({"constructor":function(e){if(e||(e={}),e.data||(e.data={}),n.CompositeView.call(this,e),this.options.data&&this.options.data.items){if(!this.collection){var t=i.Collection.extend({"model":i.Model.extend({"idAttribute":null})});this.collection=new t}this.collection.add(this.options.data.items)}},"ui":{"header":".cs-header","headerGoBack":".cs-header-with-go-back","back":".cs-go-back","backTitle":".cs-title-with-go-back"},"events":{"click @ui.back":"onClickBack","click @ui.backTitle":"onClickBack","click @ui.headerGoBack":"onClickBack"},"childEvents":{"click:item":"onClickItem","render":"_onChildRender"},"className":"cs-simplelist binf-panel binf-panel-default","template":l,"templateHelpers":function(){var t=this.options.data.back_button,i=this.options.data.title;return!t||void 0!==i&&0!==i.length||(i=u.goBackTitleForEmptyTitle),{"back_button":t,"goBackTooltip":u.goBackTooltip,"goBackAria":e.str.sformat(u.goBackAria,i),"title":i,"listAria":this.options.data.listAria,"listRole":this.options.data.listRole}},"childViewContainer":".cs-list-group","childView":d,"childViewOptions":function(){return{"template":this.options.childViewTemplate,"childRole":this.options.data.childRole}},"_onChildRender":function(e){var t=e.$el;t.is("[data-csui-active]")&&t.addClass("binf-active").attr("aria-current","page")},"onDomRefresh":function(){var e=this.getSelectedItem();e&&!this._isScrolledIntoView(e.$el)&&this.setSelectedIndex(this.getSelectedIndex())},"getSelectedItem":function(){var e=this.getSelectedIndex();return this.children.findByIndex(e)},"getSelectedIndex":function(){var e=this.$el.find("[data-csui-active]");return this.$el.find(".cs-list-group>a").index(e)},"setSelectedIndex":function(t){if(!(isNaN(t)||t<0)){var i=e.str.sformat("div a:nth-child({0})",t+1),n=this.$(i);this._setCssItemSelected(n),n.first().trigger("focus");var o=this.$(".cs-content");if(!this._isScrolledIntoView(n)){var s=n.position().top,r=s>0?n.height()-o.height()+s:s;o.animate({"scrollTop":o.scrollTop()+r},500)}}},"setSelectedElement":function(e){var t=this.getItemIndex(e);-1!==t&&this.setSelectedIndex(t)},"getItemIndex":function(e){var t=-1;return this.children.some(function(i,n){if(i===e)return t=n,!0}),t},"selectedIndexElem":function(i){if(isNaN(i)||i<0)return null;var n=e.str.sformat("div a:nth-child({0})",i+1),o=this.$(n);return t(o[0])},"selectNext":function(){var e=this.getSelectedIndex(),t=Math.min(e+1,this.collection.models.length);this.setSelectedIndex(t)},"selectPrevious":function(){var e=this.getSelectedIndex(),t=Math.max(e-1,0);this.setSelectedIndex(t)},"onClickItem":function(e){e.cancelClick=!1,this.trigger("click:item",e),!1===e.cancelClick&&this._setCssItemSelected(e.$el)},"onClickBack":function(e){e.preventDefault(),e.stopPropagation(),this.clickBack()},"clickBack":function(){this.trigger("click:back")},"_setCssItemSelected":function(e){if(e instanceof t){e.siblings("[data-csui-active]").removeClass("binf-active").removeAttr("data-csui-active").removeAttr("aria-current"),e.addClass("binf-active").attr("data-csui-active","").attr("aria-current","page"),e.siblings().prop("tabindex","-1")}},"_isScrolledIntoView":function(e){var t=this.$(".cs-content"),i=e.position().top,n=i+e.height();return i>=0&&n<=t.height()}})}),csui.define("csui/models/node.facets2/facet.query.mixin",["csui/lib/underscore","csui/lib/jquery"],function(e,t){"use strict";function i(e,i){var o=n(e);if(o.length){var s={};return s[i]=o,t.param(s,!0)}return""}function n(t){return t&&e.map(t,o)||[]}function o(t){return t.id+":"+e.reduce(t.values,function(e,t){return e&&(e+="|"),e+t.id.toString()},"")}function s(e,i){if(e.length){var n={};return n[i]=e,t.param(n,!0)}return""}return{"mixin":function(t){return e.extend(t,{"makeFacetQuery":function(e){return this},"getFilterQuery":function(e){return i(e||this.filters,this.filterQueryParameterName)},"getFilterQueryValue":function(e){return n(e||this.filters)},"getFacetIdQuery":function(e){return s(e||this.facetIds,this.facetIdQueryParameterName)}})}}}),csui.define("csui/models/node.facets2/server.adaptor.mixin",["csui/lib/underscore","csui/lib/jquery","csui/utils/url","csui/models/node.facets2/facet.query.mixin"],function(e,t,i,n){"use strict";function o(t,i){var n=e.keys(i)[0],o=i[n];e.each(o,function(e){e.value=e.value.toString(),e.selected=t})}function s(t,i){var n=e.keys(i)[0],o=i[n],s=t[n]||{};return e.extend({"nodeFacetsCollection":this,"items_to_show":this.itemsToShow,"select_multiple":!0,"topics":o},s,{"id":n.toString()})}function r(t){var i=[];if(899===t.get("type")){var n=t.get("selected_facets");i=e.map(n,function(e){var t={"id":e[0],"values":[]};return e[1].forEach(function(e){
t.values.push({"id":e})}),t})}return i}return{"mixin":function(t){t.fetch;return n.mixin(t),e.extend(t,{"filterQueryParameterName":"where_facet","facetIdQueryParameterName":"facet_id","makeServerAdaptor":function(e){return this.makeFacetQuery(e)},"isFetchable":function(){var e=this.node,t=e.get("type"),i=e.get("location_id");return 899!==t||0!==i},"url":function(){var t=this.node.get(899===this.node.get("type")?"location_id":"id"),n=e.union(r(this.node),this.filters),o=this.getFilterQuery(n),s=this.getFacetIdQuery(),l=new i(this.connector.connection.url).getApiBase("v2"),a=i.combine(l,"/facets/",t);return this.itemsToShow&&(a=i.appendQuery(a,"top_values_limit="+this.itemsToShow)),o&&(a=i.appendQuery(a,o)),s&&(a=i.appendQuery(a,s)),a},"parse":function(t,i){var n=t.results.data||{},r=n.facets||{},l=n.values.selected||[],a=n.values.available||[];if(l.forEach(o.bind(null,!0)),a.forEach(o.bind(null,!1)),899===this.node.get("type")){var c=this.node.get("selected_facets")||[];c=c.map(function(e){return e[0]}),l=l.filter(function(t){var i=e.keys(t)[0];return!e.contains(c,i)})}return l.concat(a).map(s.bind(this,r))}})}}}),csui.define("csui/models/nodefacets2",["csui/lib/underscore","csui/models/facets","csui/models/mixins/node.resource/node.resource.mixin","csui/models/node.facets2/server.adaptor.mixin","csui/utils/deepClone/deepClone"],function(e,t,i,n){"use strict";var o=t.extend({"constructor":function(e,i){t.prototype.constructor.apply(this,arguments),this.makeNodeResource(i).makeServerAdaptor(i)},"isFetchable":function(){return this.areFacetsFetchable(this)},"clone":function(){return new this.constructor(this.models,{"node":this.node,"itemsToShow":this.itemsToShow,"facetIds":this.facetIds,"filters":e.deepClone(this.filters)})}});return i.mixin(o.prototype),n.mixin(o.prototype),o}),csui.define("csui/controls/facet.panel/impl/facet/facet.key.navigation",["csui/lib/underscore","csui/lib/jquery"],function(e,t){"use strict";return{"onKeyInView":function(e){var t=e.keyCode,i=!1;switch(t){case 27:this.trigger("escape:focus"),this.activeChild&&this.activeChild.removeClass("csui-focus");break;case 32:case 13:this.execute(this.activeChild);break;case 38:case 33:case 40:case 34:if(this.activeChild&&this.activeChild.hasClass("csui-focus"))break;i=!0;break;case 9:i=this.tab(e.shiftKey);break;default:i=!0}return i},"execute":function(e){this.$el.addClass("csui-focus"),this.$el.find(".facet-disabled").length?this.onShowFacet():this.setfocus(e)},"setfocus":function(e){if(e&&e.is(":visible")||(e=this.getActiveChild()),e.hasClass("csui-focus"))switch(e){case this.ui.facetHeaderIcon:if(this.ui.facetHeader.hasClass("binf-disabled"))break;e.trigger("click"),this.ui.facetHeaderIcon.hasClass("icon-expandArrowDown")?(this.trigger("escape:focus"),this.activeChild=this.getActiveChild()):e.addClass("csui-focus");break;case this.ui.apply:case this.ui.cancel:e.trigger("click"),this.trigger("escape:focus"),this.activeChild=void 0;break;case this.ui.facetMore:e.trigger("click"),e===this.ui.facetMore&&this.activateChild(e)}else this.activateChild(e)},"tab":function(e){var t=this.$el.find(".csui-facet-item:not(.binf-hidden)");return!this.activeChild||!this.activeChild.hasClass("csui-focus")||(this.activeChild=e?this._getPrevActiveChild(t):this._getNextActiveChild(t),this.activateChild(this.activeChild),!1)},"activateChild":function(e){e||(e=this.getActiveChild()),this.prevChild&&this.prevChild.removeClass("csui-focus"),e.addClass("csui-focus"),e.trigger("focus"),this.prevChild=this.activeChild},"getActiveChild":function(){var e=this.$el.find(".csui-facet-item:not(.binf-hidden)");if(!this.activeChild||!this.activeChild.is(":visible"))if(this.ui.facetHeaderIcon.hasClass("icon-expandArrowDown"))this.activeChild=this.ui.facetHeaderIcon;else{var i=e[0];this.activeChild=t(i).find(".csui-checkbox"),0===this.activeChild.length&&(this.activeChild=t(i).find("div[tabindex]")),this.activeChildIndex=0}return this.activeChild},"cursorNextFilter":function(e,i,n){var o=this.$el.find(".csui-facet-item:not(.binf-hidden)"),s=o.length-1;this.activeChildIndex=i?0===this.activeChildIndex?s:--this.activeChildIndex:this.activeChildIndex===s?0:++this.activeChildIndex,this.activeChild=t(o[this.activeChildIndex]).find(".csui-checkbox"),this.activeChild.length||(this.activeChild=t(o[this.activeChildIndex]).find(".csui-filter-name")),this.children.findByIndex(this.activeChildIndex).activeChild=this.activeChild,this.activateChild(this.activeChild)},"_getLastFilterFocus":function(e){var t=this.activeChildIndex;return this.activeChildIndex=t&&t<e.length?t:0,this.children.findByIndex(this.activeChildIndex).activeChild},"_getNextActiveChild":function(e){var t=this.activeChild,i=this.$el.find(".csui-multi-select");switch(this.activeChild){case this.ui.facetHeaderIcon:this.ui.facetHeaderIcon.hasClass("icon-expandArrowUp")&&(t=this._getLastFilterFocus(e));break;case this.ui.facetMore:i.length>0?t=this.ui.apply:0===i.length&&this.ui.facetHeaderIcon.hasClass("icon-expandArrowUp")&&(t=this.ui.facetHeaderIcon);break;case this.ui.cancel:i.length>0&&!this.ui.facetHeader.hasClass("binf-disabled")&&this.ui.facetHeaderIcon.hasClass("icon-expandArrowUp")?t=this.ui.facetHeaderIcon:this.ui.facetHeader.hasClass("binf-disabled")&&(t=this._getLastFilterFocus(e));break;case this.ui.apply:t=this.ui.cancel;break;default:this.ui.facetMore.length>0?t=this.ui.facetMore:i.length>0?t=this.ui.apply:0===i.length&&0===this.ui.facetMore.length&&(t=this.ui.facetHeaderIcon)}return t},"_getPrevActiveChild":function(e){var t=this.activeChild;switch(this.activeChild){case this.ui.facetHeaderIcon:this.$el.find(".csui-multi-select").length>0?t=this.ui.cancel:0===this.$el.find(".csui-multi-select").length&&0===this.ui.facetMore.length?t=this._getLastFilterFocus(e):0===this.$el.find(".csui-multi-select").length&&this.ui.facetMore.length>0&&(t=this.ui.facetMore);break;case this.ui.facetMore:t=this._getLastFilterFocus(e);break;case this.ui.cancel:t=this.ui.apply;break;case this.ui.apply:t=this.ui.facetMore.length>0?this.ui.facetMore:this._getLastFilterFocus(e);break;default:if(this.ui.facetHeader.hasClass("binf-disabled")){t=this.ui.cancel;break}t=this.ui.facetHeaderIcon}return t}}}),csui.define("csui/controls/checkbox/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/checkbox/impl/nls/root/lang",{"ariaLabel":"Item selection","title":"Item selection"}),csui.define("hbs!csui/controls/checkbox/impl/checkbox.view",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        aria-labelledBy="'+e.escapeExpression((s=null!=(s=r(i,"ariaLabelledBy")||(null!=t?r(t,"ariaLabelledBy"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"ariaLabelledBy","hash":{},"loc":{"start":{"line":3,"column":25},"end":{"line":3,"column":43}}}):s))+'"\r\n'},"3":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        aria-label="'+e.escapeExpression((s=null!=(s=r(i,"ariaLabel")||(null!=t?r(t,"ariaLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"ariaLabel","hash":{},"loc":{"start":{"line":5,"column":20},"end":{"line":5,"column":33}}}):s))+'"\r\n'},"5":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return e.escapeExpression((s=null!=(s=r(i,"label")||(null!=t?r(t,"label"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"label","hash":{},"loc":{"start":{"line":9,"column":15},"end":{"line":9,"column":24}}}):s))},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<button type="button" role="checkbox" class="csui-control csui-checkbox"\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"ariaLabelledBy"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.program(3,o,0),"loc":{"start":{"line":2,"column":2},"end":{"line":6,"column":9}}}))?s:"")+"  "+e.escapeExpression((r=null!=(r=l(i,"disabled")||(null!=t?l(t,"disabled"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"disabled","hash":{},"loc":{"start":{"line":7,"column":2},"end":{"line":7,"column":14}}}):r))+' title="'+e.escapeExpression((r=null!=(r=l(i,"title")||(null!=t?l(t,"title"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":7,"column":22},"end":{"line":7,"column":31}}}):r))+'" aria-checked="'+e.escapeExpression((r=null!=(r=l(i,"ariaChecked")||(null!=t?l(t,"ariaChecked"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"ariaChecked","hash":{},"loc":{"start":{"line":7,"column":47},"end":{"line":7,"column":62}}}):r))+'">\r\n  <span class="csui-checkbox-icon-container"></span>\r\n  '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"label"):t,{"name":"if","hash":{},"fn":e.program(5,o,0),"inverse":e.noop,"loc":{"start":{"line":9,"column":2},"end":{"line":9,"column":31}}}))?s:"")+"\r\n</button>"}});return i.registerPartial("csui_controls_checkbox_impl_checkbox.view",n),n}),csui.define("csui/controls/checkbox/checkbox.icons.v2",["csui/controls/icons.v2"],function(e){e.registerIcons({"csui_checkbox":'<svg class="csui-icon-v2 csui-impl-icon-v2__checkbox" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 32 32" xml:space="preserve"><path class="csui-icon-v2-metaphor2" d="M29.8556+26.8889C29.8556+28.6+28.4629+30+26.7606+30L5.09507+30C3.39278+30+2+28.6+2+26.8889L2+5.11111C2+3.4+3.39278+2+5.09507+2L26.7606+2C28.4629+2+29.8556+3.4+29.8556+5.11111L29.8556+26.8889Z" opacity="1" fill="#ffffff"/><path class="csui-icon-v2-metaphor0" d="M26.7606+3.55556C27.6133+3.55556+28.3081+4.254+28.3081+5.11111L28.3081+26.8889C28.3081+27.746+27.6133+28.4444+26.7606+28.4444L5.09507+28.4444C4.24238+28.4444+3.54754+27.746+3.54754+26.8889L3.54754+5.11111C3.54754+4.254+4.24238+3.55556+5.09507+3.55556L26.7606+3.55556M26.7606+2L5.09507+2C3.39278+2+2+3.4+2+5.11111L2+26.8889C2+28.6+3.39278+30+5.09507+30L26.7606+30C28.4629+30+29.8556+28.6+29.8556+26.8889L29.8556+5.11111C29.8556+3.4+28.4629+2+26.7606+2L26.7606+2Z" fill-rule="evenodd" clip-rule="evenodd" fill="#333333"/></svg>',"csui_checkbox-selected":'<svg class="csui-icon-v2 csui-impl-icon-v2__checkbox-selected" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 32 32" xml:space="preserve"><g opacity="1"><path class="csui-icon-v2-metaphor2" d="M26.8889+30L5.11111+30C3.39222+30+2+28.6078+2+26.8889L2+5.11111C2+3.39222+3.39222+2+5.11111+2L26.8889+2C28.6078+2+30+3.39222+30+5.11111L30+26.8889C30+28.6078+28.6078+30+26.8889+30Z" opacity="1" fill="#ffffff"/><path class="csui-icon-v2-metaphor2" d="M26.3818+29.3482L5.61822+29.3482C3.98022+29.3482+2.65178+28.0198+2.65178+26.3818L2.65178+5.61822C2.65178+3.98022+3.98022+2.65178+5.61822+2.65178L26.3833+2.65178C28.0213+2.65178+29.3498+3.98022+29.3498+5.61822L29.3498+26.3833C29.3482+28.0213+28.0213+29.3482+26.3818+29.3482Z" opacity="1" fill="#ffffff"/><path class="csui-icon-v2-metaphor0" d="M26.8889+3.55556C27.746+3.55556+28.4444+4.254+28.4444+5.11111L28.4444+26.8889C28.4444+27.746+27.746+28.4444+26.8889+28.4444L5.11111+28.4444C4.254+28.4444+3.55556+27.746+3.55556+26.8889L3.55556+5.11111C3.55556+4.254+4.254+3.55556+5.11111+3.55556L26.8889+3.55556M26.8889+2L5.11111+2C3.39222+2+2+3.39222+2+5.11111L2+26.8889C2+28.6078+3.39222+30+5.11111+30L26.8889+30C28.6078+30+30+28.6078+30+26.8889L30+5.11111C30+3.39222+28.6078+2+26.8889+2L26.8889+2Z" fill-rule="evenodd" clip-rule="evenodd" fill="#333333"/></g><path class="csui-icon-v2-metaphor0" d="M13.1129+23.4496L7.63733+17.974C7.02911+17.3658+7.02911+16.3827+7.63733+15.7744C8.24556+15.1662+9.22867+15.1662+9.83689+15.7744L13.1113+19.0489L21.7073+10.4529C22.3156+9.84467+23.2987+9.84467+23.9069+10.4529C24.5151+11.0611+24.5151+12.0442+23.9069+12.6524L13.1129+23.4496Z" fill-rule="evenodd" clip-rule="evenodd" fill="#333333"/></svg>',"csui_checkbox-mixed":'<svg class="csui-icon-v2 csui-impl-icon-v2_checkbox-mixed" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 32 32" xml:space="preserve"><g opacity="1"><path class="csui-icon-v2-metaphor2" d="M30+26.8889C30+28.6+28.6+30+26.8889+30L5.11111+30C3.4+30+2+28.6+2+26.8889L2+5.11111C2+3.4+3.4+2+5.11111+2L26.8889+2C28.6+2+30+3.4+30+5.11111L30+26.8889Z" opacity="1" fill="#ffffff"/><path class="csui-icon-v2-metaphor0" d="M26.8889+3.55556C27.746+3.55556+28.4444+4.254+28.4444+5.11111L28.4444+26.8889C28.4444+27.746+27.746+28.4444+26.8889+28.4444L5.11111+28.4444C4.254+28.4444+3.55556+27.746+3.55556+26.8889L3.55556+5.11111C3.55556+4.254+4.254+3.55556+5.11111+3.55556L26.8889+3.55556M26.8889+2L5.11111+2C3.4+2+2+3.4+2+5.11111L2+26.8889C2+28.6+3.4+30+5.11111+30L26.8889+30C28.6+30+30+28.6+30+26.8889L30+5.11111C30+3.4+28.6+2+26.8889+2L26.8889+2Z" fill-rule="evenodd" clip-rule="evenodd" fill="#333333"/><path class="csui-icon-v2-metaphor0" d="M22.2222+17.5556L9.77778+17.5556C8.84444+17.5556+8.22222+16.9333+8.22222+16C8.22222+15.0667+8.84444+14.4444+9.77778+14.4444L22.2222+14.4444C23.1556+14.4444+23.7778+15.0667+23.7778+16C23.7778+16.9333+23+17.5556+22.2222+17.5556Z" fill-rule="evenodd" clip-rule="evenodd" fill="#333333"/></g></svg>'})}),csui.define("css!csui/controls/control/impl/control",[],function(){}),csui.define("css!csui/controls/checkbox/impl/checkbox.view",[],function(){}),csui.define("csui/controls/checkbox/checkbox.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/icon/icon.view","i18n!csui/controls/checkbox/impl/nls/lang","hbs!csui/controls/checkbox/impl/checkbox.view","csui/controls/checkbox/checkbox.icons.v2","css!csui/controls/control/impl/control","css!csui/controls/checkbox/impl/checkbox.view"],function(e,t,i,n,o,s,r){"use strict";return n.ItemView.extend({"className":"csui-control-view csui-checkbox-view","template":r,"calculateIconName":function(){var e=this.model.get("checked");switch(this._iconName="csui_checkbox",e){case"true":this._iconName="csui_checkbox-selected";break;case"mixed":this._iconName="csui_checkbox-mixed";break;case"false":this._iconName="csui_checkbox"}return this._iconName},"setDisabled":function(e){this.model.set("disabled",!!e)},"templateHelpers":function(){return{"disabled":this.model.get("disabled")?"disabled":"","ariaChecked":this.model.get("checked"),"title":void 0!==this.title?this.title:s.title,"ariaLabelledBy":this.ariaLabelledBy,"ariaLabel":void 0!==this.ariaLabel?this.ariaLabel:s.ariaLabel,"label":this.label||""}},"ui":{"cb":"button.csui-control.csui-checkbox","checkboxIconContainer":".csui-checkbox-icon-container"},"events":{"click":"_toggleChecked"},"constructor":function(e){e||(e={}),this.ariaLabel=e.ariaLabel,this.ariaLabelledBy=e.ariaLabelledBy,this.title=e.title,this.label=e.label,e.model||(e.model=new i.Model({"disabled":void 0!==e.disabled&&e.disabled})),n.ItemView.prototype.constructor.call(this,e),this._setChecked(e.checked,{"silent":!0}),this.calculateIconName(),this.checkboxIconView=new o({"iconName":this._iconName,"size":"xsmall","states":"true"}),this.listenTo(this,"render",function(){new n.Region({"el":this.ui.checkboxIconContainer}).show(this.checkboxIconView)}),this._undelegateModelAndCollectionEvents(),this.listenTo(this.model,"change:disabled",this._handleDisableChanged),this.listenTo(this.model,"change:checked",this._handleCheckedChanged)},"setChecked":function(e){var t={"silent":!1};this.model.get("disabled")&&(t.silent=!0),this._setChecked(e,t)},"_updateIcon":function(){this.calculateIconName(),this.checkboxIconView.setIcon(this._iconName)},"_handleDisableChanged":function(){var e=this.model.get("disabled");this.ui.cb.prop("disabled",e)},"_handleCheckedChanged":function(){this._updateIcon();var e=this.model.get("checked");this.ui.cb.attr("aria-checked",e)},"_setChecked":function(e,t){switch(e){case"true":case!0:this.model.set("checked","true",t);break;case"mixed":this.model.set("checked","mixed",t);break;default:this.model.set("checked","false",t)}},"_toggleChecked":function(){if(!this.model.get("disabled")){var e=this.model.get("checked"),t={"sender":this,"model":this.model};this.triggerMethod("clicked",t),t.cancel||(e&&"false"!==e&&"mixed"!==e?this.model.set("checked","false"):this.model.set("checked","true"))}}})}),csui.define("hbs!csui/controls/facet.panel/impl/facet/facet.item",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="csui-facet-item-checkbox '+e.escapeExpression((s=null!=(s=r(i,"showOnHover")||(null!=t?r(t,"showOnHover"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"showOnHover","hash":{},"loc":{"start":{"line":2,"column":41},"end":{"line":2,"column":56}}}):s))+'">'+e.escapeExpression((s=null!=(s=r(i,"checkbox")||(null!=t?r(t,"checkbox"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"checkbox","hash":{},"loc":{"start":{"line":2,"column":58},"end":{"line":2,"column":70}}}):s))+"</div>\r\n"},"3":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="csui-total">'+e.escapeExpression((s=null!=(s=r(i,"count")||(null!=t?r(t,"count"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"count","hash":{},"loc":{"start":{"line":7,"column":26},"end":{"line":7,"column":35}}}):s))+"</div>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"enableCheckBox"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":0},"end":{"line":3,"column":7}}}))?s:"")+'  <div class="csui-filter-name" tabindex="-1" title="'+e.escapeExpression((r=null!=(r=l(i,"filterTitle")||(null!=t?l(t,"filterTitle"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"filterTitle","hash":{},"loc":{"start":{"line":4,"column":53},"end":{"line":4,"column":68}}}):r))+'" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"filterTitleAria")||(null!=t?l(t,"filterTitleAria"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"filterTitleAria","hash":{},"loc":{"start":{"line":4,"column":82},"end":{"line":4,"column":101}}}):r))+'">\r\n  <div class="csui-name">'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":5,"column":25},"end":{"line":5,"column":33}}}):r))+"</div>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"displayCount"):t,{"name":"if","hash":{},"fn":e.program(3,o,0),"inverse":e.noop,"loc":{"start":{"line":6,"column":2},"end":{"line":8,"column":9}}}))?s:"")+"</div>\r\n"}});return i.registerPartial("csui_controls_facet.panel_impl_facet_facet.item",n),n}),csui.define("csui/controls/facet.panel/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/facet.panel/impl/nls/root/lang",{"facetsTitle":"Refine by","facetsRegionAria":"Refinement options","facetTitleAria":"Refine by {0}","searchIconTooltip":"Search by {0}","filterTitle":"{0} ({1})","filterTitleAria":"Filter {0} with {1} items","filterTitleAriaNoDisplayCount":"Filter {0}","filterCheckboxAria":"Filter {0} with {1} items","filterCheckboxAriaNoDisplayCount":"Filter {0}","searchClearIconTooltip":"Clear all","emptyFacetMessage":"No filters available.","emptyFilteredFacetMessage":"No more filters available.","loadingFacetMessage":"Loading filters...","failedFacetMessage":"Loading filters failed.","noFiles":"No drop files were provided.","addTypeDenied":"Cannot add documents to {0}.","showMore":"Show more","showMoreAria":"Show more filters","showLess":"Show less","showLessAria":"Show less filters","apply":"Apply","applyFiltersAria":"Apply selected filters","clear":"Cancel","clearFiltersAria":"Clear selected filters","showFacetAria":"Show facet","hideFacetAria":"Hide facet","filterOptions":"Filter options"}),csui.define("css!csui/controls/facet.panel/impl/facet/facet.item",[],function(){}),csui.define("csui/controls/facet.panel/impl/facet/facet.item.view",["csui/lib/jquery","csui/utils/base","csui/lib/underscore","csui/lib/marionette","csui/controls/checkbox/checkbox.view","hbs!csui/controls/facet.panel/impl/facet/facet.item","i18n!csui/controls/facet.panel/impl/nls/lang","css!csui/controls/facet.panel/impl/facet/facet.item"],function(e,t,i,n,o,s,r){return n.ItemView.extend({"template":s,"className":"csui-facet-item","constructor":function(e){n.ItemView.prototype.constructor.apply(this,arguments),this.showInputOnHover=!t.isTouchBrowser()},"triggers":{"click .csui-filter-name":"single:filter:select"},"ui":{"name":".csui-name"},"events":{"click .csui-checkbox":"onToggleCheckbox","change .csui-checkbox":"onChangeValue","focus .csui-facet-item-checkbox":"onFocus","blur .csui-facet-item-checkbox":"onBlur","keydown .csui-facet-item-checkbox":"onToggleCheckbox","keydown .csui-filter-name":"onToggleCheckbox"},"templateHelpers":function(){var e,t,n,o=this.showInputOnHover?"":"csui-showAlways",s=this.options.model.get("count")?this.options.model.get("count"):this.options.model.get("total"),l=!0,a=this.options.context;if(!(a&&a._user&&a._user.get("privilege_system_admin_rights")))switch(this.options.displayCount){case"Never":l=!1;break;case"Always":l=!0;break;default:var c=this.options.displayCount&&this.options.displayCount.split(">")[1];l=!!c&&s>parseInt(c)}return this.showDisplayCount=l,e=l?i.str.sformat(r.filterTitleAria,this.options.model.get("name"),s):i.str.sformat(r.filterTitleAriaNoDisplayCount,this.options.model.get("name")),t=l?i.str.sformat(r.filterCheckboxAria,this.options.model.get("name"),s):i.str.sformat(r.filterCheckboxAriaNoDisplayCount,this.options.model.get("name")),n=l?i.str.sformat(r.filterTitle,this.options.model.get("name"),s):this.options.model.get("name"),{"showOnHover":o,"count":s,"enableCheckBox":this.options.enableCheckBoxes,"displayCount":l,"filterTitleAria":e,"filterCheckboxAria":t,"filterTitle":n}},"onToggleCheckbox":function(t){var i=t.keyCode,n=e(t.target);switch(t.preventDefault(),i){case 32:case 13:if(this.checkboxView){"true"===this.checkboxView.model.get("checked")?this.checkboxView.setChecked(!1):this.checkboxView.setChecked(!0)}else this.triggerMethod("single:filter:select");break;case 39:case 37:break;case 38:case 40:this.trigger("keyupdown",38===i,n);break;default:return!0}return!1},"onChangeValue":function(e){if(this.checkboxView){var t=e.target;this.checkboxView.setDisabled(t.disabled)}},"onDomRefresh":function(){if(this.options.enableCheckBoxes){var e=this.$el.find(".csui-facet-item-checkbox"),t=this.model.get("count")?this.options.model.get("count"):this.options.model.get("total"),s=this.showDisplayCount?i.str.sformat(r.filterTitleAria,this.model.get("name"),t):i.str.sformat(r.filterTitleAriaNoDisplayCount,this.model.get("name")),l=this.showDisplayCount?i.str.sformat(r.filterCheckboxAria,this.model.get("name"),t):i.str.sformat(r.filterCheckboxAriaNoDisplayCount,this.model.get("name"));if(!this.checkboxView){this.checkboxView=new o({"checked":!1,"disabled":!1,"ariaLabel":l,"title":s}),this.listenTo(this.checkboxView.model,"change:checked",function(){this.triggerMethod("multi:filter:select")});new n.Region({"el":e}).show(this.checkboxView)}}},"onFocus":function(t){var i=e(t.target).closest(".csui-facet");i.length>0&&i.addClass("csui-focus")},"onBlur":function(t){var i=e(t.target).closest(".csui-facet");i.length>0&&i.removeClass("csui-focus")},"getIndex":function(){return this._index}})}),csui.define("hbs!csui/controls/facet.panel/impl/facet/facet",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="csui-filter-more" role="button" tabindex="-1" aria-label="'+e.escapeExpression((s=null!=(s=r(i,"moreFiltersAria")||(null!=t?r(t,"moreFiltersAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"moreFiltersAria","hash":{},"loc":{"start":{"line":10,"column":74},"end":{"line":10,"column":93}}}):s))+'">\r\n        <div class="csui-more-text">'+e.escapeExpression((s=null!=(s=r(i,"more")||(null!=t?r(t,"more"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"more","hash":{},"loc":{"start":{"line":11,"column":36},"end":{"line":11,"column":44}}}):s))+'</div>\r\n        <div class="cs-icon '+e.escapeExpression((s=null!=(s=r(i,"more-icon")||(null!=t?r(t,"more-icon"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"more-icon","hash":{},"loc":{"start":{"line":12,"column":28},"end":{"line":12,"column":41}}}):s))+'"></div>\r\n    </div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="csui-facet-header">\r\n  <div class="header-label" title="'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":2,"column":35},"end":{"line":2,"column":43}}}):r))+'">'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":2,"column":45},"end":{"line":2,"column":53}}}):r))+'</div>\r\n  <div class="header-count" title="'+e.escapeExpression((r=null!=(r=l(i,"count")||(null!=t?l(t,"count"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"count","hash":{},"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":44}}}):r))+'"> ('+e.escapeExpression((r=null!=(r=l(i,"count")||(null!=t?l(t,"count"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"count","hash":{},"loc":{"start":{"line":3,"column":48},"end":{"line":3,"column":57}}}):r))+')</div>\r\n  <div class="cs-icon csui-button-icon icon-expandArrowUp" role="button" title="'+e.escapeExpression((r=null!=(r=l(i,"showFacetAria")||(null!=t?l(t,"showFacetAria"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"showFacetAria","hash":{},"loc":{"start":{"line":4,"column":80},"end":{"line":4,"column":97}}}):r))+'" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"showFacetAria")||(null!=t?l(t,"showFacetAria"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"showFacetAria","hash":{},"loc":{"start":{"line":4,"column":111},"end":{"line":4,"column":128}}}):r))+'" tabindex="-1"></div>\r\n</div>\r\n\r\n<div class="csui-facet-content '+e.escapeExpression((r=null!=(r=l(i,"show-content")||(null!=t?l(t,"show-content"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"show-content","hash":{},"loc":{"start":{"line":7,"column":31},"end":{"line":7,"column":47}}}):r))+'" role="presentation">\r\n  <div class="cs-filter-group" role="presentation"></div>\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"more"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":9,"column":2},"end":{"line":14,"column":9}}}))?s:"")+'  <div class="csui-facet-controls '+e.escapeExpression((r=null!=(r=l(i,"show-controls")||(null!=t?l(t,"show-controls"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"show-controls","hash":{},"loc":{"start":{"line":15,"column":34},"end":{"line":15,"column":51}}}):r))+'">\r\n      <button class="csui-btn binf-btn binf-btn-primary csui-apply" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"applyFiltersAria")||(null!=t?l(t,"applyFiltersAria"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"applyFiltersAria","hash":{},"loc":{"start":{"line":16,"column":80},"end":{"line":16,"column":100}}}):r))+'">'+e.escapeExpression((r=null!=(r=l(i,"apply")||(null!=t?l(t,"apply"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"apply","hash":{},"loc":{"start":{"line":16,"column":102},"end":{"line":16,"column":111}}}):r))+'</button>\r\n      <button class="csui-btn binf-btn binf-btn-secondary csui-clear" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"clearFiltersAria")||(null!=t?l(t,"clearFiltersAria"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"clearFiltersAria","hash":{},"loc":{"start":{"line":17,"column":82},"end":{"line":17,"column":102}}}):r))+'">'+e.escapeExpression((r=null!=(r=l(i,"clear")||(null!=t?l(t,"clear"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"clear","hash":{},"loc":{"start":{"line":17,"column":104},"end":{"line":17,"column":113}}}):r))+"</button>\r\n  </div>\r\n\r\n</div>\r\n"}});return i.registerPartial("csui_controls_facet.panel_impl_facet_facet",n),n}),csui.define("css!csui/controls/facet.panel/impl/facet/facet",[],function(){}),csui.define("csui/controls/facet.panel/impl/facet/facet.view",["csui/lib/underscore","module","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/models/facettopics","csui/models/nodefacets2","csui/controls/facet.panel/impl/facet/facet.key.navigation","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/facet.panel/impl/facet/facet.item.view","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","csui/controls/globalmessage/globalmessage","csui/controls/progressblocker/blocker","hbs!csui/controls/facet.panel/impl/facet/facet","i18n!csui/controls/facet.panel/impl/nls/lang","css!csui/controls/facet.panel/impl/facet/facet"],function(e,t,i,n,o,s,r,l,a,c,u,d,h,p,f){var m=t.config();e.defaults(m,{"displayCount":"Always"});var g=n.CompositeView.extend({"childView":c,"template":p,"className":"csui-facet","childViewContainer":".cs-filter-group","ui":{"facetContent":".csui-facet-content","facetHeader":".csui-facet-header","facetHeaderIcon":".csui-facet-header > .cs-icon","facetSubmitControls":".csui-facet-controls","facetCollapseControls":".csui-facet-collapse-controls","facetMoreText":".csui-more-text","facetMoreIcon":".csui-filter-more .cs-icon","facetMore":".csui-filter-more","apply":".csui-facet-controls .csui-apply","cancel":".csui-facet-controls .csui-clear","selectCount":".header-count"},"childEvents":{"single:filter:select":"onSingleFilterSelect","multi:filter:select":"onMultiFilterSelect","keyupdown":"cursorNextFilter","keyleftright":"cursorInsideFilter"},"events":{"click .csui-filter-more:not(.binf-disabled)":"onShowMore","click .csui-facet-header":"onShowFacet","mouseleave":"onMouseLeave","keydown":"onKeyInView"},"triggers":{"click .csui-clear":"clear:all","click .csui-apply":"apply:all"},"templateHelpers":function(){var e=this.showAll?f.showLess:f.showMore,t=this.showAll?f.showLessAria:f.showMoreAria;return{"more":this.haveMore?e:void 0,"moreFiltersAria":t,
"more-icon":this.showAll?"icon-expandArrowUp":"icon-expandArrowDown","apply":f.apply,"applyFiltersAria":f.applyFiltersAria,"clear":f.clear,"clearFiltersAria":f.clearFiltersAria,"show-controls":this.selectItems.length>0?"csui-multi-select":"","show-content":this.showFacet?"":"binf-hidden","showFacetAria":this.showFacet?f.hideFacetAria:f.showFacetAria}},"childViewOptions":function(){return{"enableCheckBoxes":void 0===this.model.get("select_multiple")||this.model.get("select_multiple"),"displayCount":m&&m.displayCount,"context":this.options.context}},"constructor":function(e){n.CompositeView.prototype.constructor.apply(this,arguments),this.$el.attr("tabindex",0),this.options=e||{},this.collection=new s,this.itemsToShow=this.model.get("items_to_show"),this.nodeFacetsCollection=this.model.get("nodeFacetsCollection"),this.showAll=!1,this._fillCollection();var t=this.model.has("total_displayable")?this.model.get("total_displayable"):this.model.topics.length;this.haveMore=t>this.collection.length,this.showFacet=!0,this.selectItems=[],this.listenTo(this,"add:child",this.propagateEventsToViews),this.options.blockingParentView&&h.delegate(this,this.options.blockingParentView)},"onClearAll":function(){this.$el.find(".csui-checkbox[aria-checked='true']").trigger("click"),this.selectItems=[],this.ui.facetCollapseControls.removeClass("multi-select"),this._setDisabledFilters(0),this.$el.removeClass("multi-select"),this._updateFacetSubmitControls(),this.ui.facetHeader.removeClass("binf-disabled"),this.trigger("activate:facet",this)},"onApplyAll":function(){var e=this.model,t=this._getFilterArray();this.newFilter={"id":e.get("id"),"values":t},this.trigger("apply:filter")},"onRender":function(){0===this.collection.length&&this.$el.hide(),this.$el.attr("role","menu"),this.$el.attr("aria-label",e.str.sformat(f.facetTitleAria,this.model.get("name")))},"onSingleFilterSelect":function(e){if(!e.$el.hasClass("binf-disabled"))if(this.$el.hasClass("multi-select"))e.$el.find(".csui-checkbox").trigger("click");else{var t=this.model;this.newFilter={"id":t.get("id"),"values":[{"id":e.model.get("value")}]},this.trigger("apply:filter")}},"onShowMore":function(e){e&&(e.preventDefault(),e.stopPropagation()),this.showAll=!this.showAll;var t=this;this._fillCollection().done(function(){var e=[];t.children.each(function(i,n){i.checkboxView&&(t.selectItems[n]?(i.checkboxView.setChecked(!0),e[n]=i):i.checkboxView.setChecked(!1))}),t.selectItems=e;var i=t._countCheckedItems();t._setDisabledFilters(i),t._setMoreLabel(t.showAll),t.trigger("facet:size:change")}).fail(function(){t.showAll=!t.showAll})},"onShowFacet":function(e){if(e&&(e.preventDefault(),e.stopPropagation()),this.showFacet=!this.showFacet,this.showFacet)this.ui.facetContent.removeClass("binf-hidden"),this.ui.facetCollapseControls.removeClass("multi-select"),this.ui.facetHeaderIcon[0].className="cs-icon csui-button-icon icon-expandArrowUp",this.ui.facetHeaderIcon[0].setAttribute("aria-label",f.hideFacetAria),this.ui.facetHeaderIcon[0].setAttribute("title",f.hideFacetAria);else{var t=this._countCheckedItems();this.ui.facetContent.addClass("binf-hidden"),this.ui.facetHeaderIcon[0].className="cs-icon csui-button-icon icon-expandArrowDown",this.ui.facetHeaderIcon[0].setAttribute("aria-label",f.showFacetAria),this.ui.facetHeaderIcon[0].setAttribute("title",f.showFacetAria),t&&this.ui.facetCollapseControls.addClass("multi-select")}this.trigger("facet:size:change")},"onMouseLeave":function(e){e.preventDefault(),e.stopPropagation()},"getIndex":function(){return this._index},"_countCheckedItems":function(){var e=0;return this.children.each(function(t){if(t.checkboxView){"true"===t.checkboxView.model.get("checked")&&e++}}),e},"onMultiFilterSelect":function(e){var t=this._countCheckedItems();this._updateSelectList(e),this._updateFacetSubmitControls(t),this._setDisabledFilters(t),this.selectItems=0===t?[]:this.selectItems,this.trigger("activate:facet",this)},"_updateFacetSubmitControls":function(){this._countCheckedItems()>0?(this.ui.facetSubmitControls.addClass("csui-multi-select"),this.$el.addClass("multi-select"),this.ui.facetHeader.addClass("binf-disabled")):(this.ui.facetSubmitControls.removeClass("csui-multi-select"),this.$el.removeClass("multi-select"),this.ui.facetHeader.removeClass("binf-disabled"))},"_updateSelectList":function(e){var t=e.getIndex();this.selectItems[t]?delete this.selectItems[t]:this.selectItems[t]=e},"_setDisabledFilters":function(t){var i=this.children.filter(function(e){if(e.checkboxView){return"false"===e.checkboxView.model.get("checked")}return!0});e.each(i,function(e){e.checkboxView.setDisabled(t>=5)}),this.ui.selectCount.text(t)},"_setMoreLabel":function(e){this.$el.find(".csui-facet-item.more");this.ui.facetMoreIcon[0]&&(e?(this.ui.facetMoreIcon[0].className="cs-icon icon-expandArrowUp",this.ui.facetMoreText.text(f.showLess),this.ui.facetMore[0].setAttribute("aria-label",f.showLessAria),this.ui.facetMoreText[0].setAttribute("aria-expanded","true")):(this.ui.facetMoreIcon[0].className="cs-icon icon-expandArrowDown",this.ui.facetMoreText.text(f.showMore),this.ui.facetMore[0].setAttribute("aria-label",f.showMoreAria),this.ui.facetMoreText[0].setAttribute("aria-expanded","false"))),this.trigger("facet:size:change")},"_getFilterArray":function(){var t=[];return e.each(this.selectItems,function(e){e&&t.push({"id":e.model.get("value")})}),t},"_fillCollection":function(){var e=this,t=i.Deferred();if(this.showAll){if(this.model.get("total_displayable")>this.model.topics.length){var n=this.model.get("id"),s={"filters":this.nodeFacetsCollection.filters,"facetIds":[n],"node":this.nodeFacetsCollection.node},l=new r(null,s);return this.blockActions&&this.blockActions(),l.fetch().always(function(){e.unblockActions&&e.unblockActions()}).done(function(){e.model.topics.reset(l.get(n).topics.models,{"silent":!0}),e.collection.reset(e.model.topics.models),t.resolve()}).fail(function(e){var i=new o.Error(e);d.showMessage("error",i.message),t.reject(i)}),t.promise()}this.collection.reset(this.model.topics.models)}else{var a=this.model.topics.first(this.itemsToShow);this.collection.reset(a)}return t.resolve().promise()}});return e.extend(g.prototype,l),e.extend(g.prototype,u),g}),csui.define("csui/controls/facet.panel/impl/facet.panel.key.navigation",["csui/lib/underscore","csui/lib/jquery"],function(e,t){"use strict";return{"currentlyFocusedElement":function(){var e=this.$(".cs-list-group .csui-facet[tabindex=-1]");return e.length&&e.prop("tabindex",0),this.getActiveChild()},"onSetNextChildFocus":function(e){this.activeChildIndex=e.getIndex()},"accActivateTabableRegion":function(){t(document).unbind("mousedown",this._onRemoveKeyboardFocus),t(document).bind("mousedown",this._onRemoveKeyboardFocus)},"_removeKeyboardFocus":function(){this.$el.find(".csui-focus").removeClass("csui-focus"),t(document).unbind("mousedown",this._onRemoveKeyboardFocus)},"onKeyInView":function(e){switch(e.keyCode){case 38:case 33:this._getPrevActiveChild().trigger("focus");break;case 40:case 34:this._getNextActiveChild().trigger("focus");break;default:return!0}return!1},"resetFacetFocus":function(e){e.$el.trigger("focus")},"getActiveChild":function(){if(!this.$childViewContainer)return t();if(!this.activeChild){var e=this.$childViewContainer[0];e&&e.childNodes[0]&&(this.activeChild=t(e.childNodes[0]),this.activeChildIndex=0)}return this.activeChild},"_getNextActiveChild":function(){var e=this.$childViewContainer[0].childNodes;return e.length-1>this.activeChildIndex?this.activeChildIndex++:this.activeChildIndex=0,t(e[this.activeChildIndex])},"_getPrevActiveChild":function(){var e=this.$childViewContainer[0].childNodes;return this.activeChildIndex>0?this.activeChildIndex--:this.activeChildIndex=e.length-1,t(e[this.activeChildIndex])}}}),csui.define("hbs!csui/controls/facet.panel/impl/facet.panel",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="cs-header binf-panel-heading">\r\n    <span class="cs-title">'+e.escapeExpression((s=null!=(s=r(i,"title")||(null!=t?r(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":3,"column":27},"end":{"line":3,"column":36}}}):s))+"</span>\r\n  </div>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"showTitle"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":0},"end":{"line":5,"column":7}}}))?s:"")+'\r\n<div class="cs-content" tabindex="-1">\r\n  <div class="cs-list-group" role="region" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"regionAria")||(null!=t?l(t,"regionAria"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"regionAria","hash":{},"loc":{"start":{"line":8,"column":55},"end":{"line":8,"column":69}}}):r))+'"></div>\r\n</div>\r\n\r\n\r\n'}});return i.registerPartial("csui_controls_facet.panel_impl_facet.panel",n),n}),csui.define("css!csui/controls/facet.panel/impl/facet.panel",[],function(){}),csui.define("csui/controls/facet.panel/facet.panel.view",["csui/lib/underscore","csui/lib/jquery","csui/models/facets","csui/controls/list/simplelist.view","csui/controls/facet.panel/impl/facet/facet.view","csui/behaviors/collection.state/collection.state.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/facet.panel/impl/facet.panel.key.navigation","csui/controls/progressblocker/blocker","csui/controls/mixins/view.events.propagation/view.events.propagation.mixin","hbs!csui/controls/facet.panel/impl/facet.panel","i18n!csui/controls/facet.panel/impl/nls/lang","css!csui/controls/facet.panel/impl/facet.panel"],function(e,t,i,n,o,s,r,l,a,c,u,d){"use strict";var h=n.extend({"template":u,"className":"cs-simplelist csui-facet-panel","behaviors":{"CollectionState":{"behaviorClass":s,"collection":function(){if(this.facets.length){var e=this._getAvailableFacets();this.facets.models=e.models,this.facets.length=e.length}return this.facets},"stateMessages":function(){return{"empty":e.isEmpty(this.facets.filters)?d.emptyFacetMessage:d.emptyFilteredFacetMessage,"loading":d.loadingFacetMessage,"failed":d.failedFacetMessage}}},"TabableRegion":{"behaviorClass":r}},"childView":o,"childViewOptions":function(){return{"blockingParentView":this.options.blockingParentView,"context":this.options.context}},"childEvents":{"apply:filter":"applyFilter","activate:facet":"setActiveFacet","facet:size:change":"_updateScrollbar","escape:focus":"resetFacetFocus"},"events":{"keydown":"onKeyInView"},"templateHelpers":function(){return{"showTitle":this.options.data.showTitle,"title":this.options.data.title,"regionAria":this.options.data.regionAria}},"onAddChild":function(e){var t=e.$el,i=this;e.getIndex()===this.collection.length-1&&t.css("border-bottom","0px"),t.on("focus",function(){i.onSetNextChildFocus(e)}),this.propagateEventsToViews(e)},"constructor":function(t){this.facets=t.collection,this.originatingView=t.originatingView,t.collection=this._getAvailableFacets(),n.prototype.constructor.apply(this,arguments),this.options.data.title=d.facetsTitle,this.options.data.regionAria=d.facetsRegionAria,this.options.data.showTitle=void 0===this.options.showTitle||this.options.showTitle,this._onRemoveKeyboardFocus=e.bind(this._removeKeyboardFocus,this),this.options.blockingParentView&&!this.options.blockingLocal?(a.delegate(this,this.options.blockingParentView),this.listenTo(this.facets,"request",this.blockActions).listenTo(this.facets,"sync",this.unblockActions).listenTo(this.facets,"error",this.unblockActions)):a.imbue({"parent":this,"local":this.options.blockingLocal})},"_getAvailableFacets":function(){var e=this.facets.getAvailableFacets();this.listenTo(this.facets,"reset",function(){var e=this.facets.getAvailableFacets();this.collection.reset(e)});var n=this;return this.listenTo(this.facets,"request",function(){n.originatingView&&n.originatingView.blockActions()}),this.listenTo(this.facets,"sync",function(){n.originatingView&&n.originatingView.unblockActions(),n.originatingView&&n.originatingView.filterToolItemModel&&n.originatingView.filterToolItemModel.get("isKeyEvent")&&t(n.$el.find(".csui-facet")[0]).trigger("focus")}),this.listenTo(this.facets,"destroy",function(){n.originatingView&&n.originatingView.unblockActions()}),this.listenTo(this,"destroy",function(){n.originatingView&&n.originatingView.unblockActions()}),this.listenTo(this.facets,"error",function(){n.originatingView&&n.originatingView.unblockActions()}),this.listenTo(this,"error",function(){n.originatingView&&n.originatingView.unblockActions()}),new i(e)},"isTabable":function(){return!(this.$el.parent().hasClass("binf-hidden")||this.$el.parent().hasClass("csui-facetview-hidden"))},"onRenderCollection":function(){this.trigger("refresh:tabindexes")},"onBeforeDestroy":function(){t(document).off("mousedown",this._onRemoveKeyboardFocus)},"applyFilter":function(e){this.trigger("apply:filter",e.newFilter)},"setActiveFacet":function(e){e.selectItems.length>0?this.children.each(function(t){t.getIndex()!==e.getIndex()&&t.$el.find(".csui-facet-content").addClass("facet-disabled")}):this.$el.find(".csui-facet-content").removeClass("facet-disabled")},"_updateScrollbar":function(){this.triggerMethod("update:scrollbar",this)}});return e.extend(h.prototype,l),e.extend(h.prototype,c),h}),csui.define("csui/controls/list/behaviors/list.view.keyboard.behavior",["module","csui/lib/underscore","csui/lib/jquery","csui/utils/log","csui/lib/marionette"],function(e,t,i,n,o){"use strict";function s(e){e.preventDefault(),e.stopPropagation()}var r={"none":-1,"search":0,"open_perspective":1,"close_search":1,"list":2,"footer":3};return o.Behavior.extend({"constructor":function(e,n){o.Behavior.prototype.constructor.apply(this,arguments),n.keyboardBehavior=this,this.tabableElements=[];var l=this;this.listenTo(n,"show",function(){l.refreshTabableElements(n)}),this.listenTo(n,"childview:click:item childview:click:tree:header",function(e){var t=n.selectedIndex,i=n.getElementByIndex(t);i&&i.prop("tabindex","-1"),n.currentTabPosition=r.list,n.selectedIndex=n.collection.indexOf(e.model),(i=n.getElementByIndex(n.selectedIndex))&&i.prop("tabindex","0")}),this.listenTo(n,"change:filterValue",function(){l.refreshTabableElements(n)}),this.listenTo(n,"before:collection:scroll:fetch",function(){n._beforeCollectionScrollFetch()}),this.listenTo(n,"collection:scroll:fetch",function(){n._afterCollectionScrollFetch()}),t.extend(n,{"_focusSearchButton":function(e){this.currentTabPosition=r.search;var t=e&&e.shiftKey;return i(t?this.ui.searchButton:this._isSearchInputVisible()?this.ui.searchInput:this.ui.searchButton)},"_isSearchInputVisible":function(){return this.ui.searchInput.css&&"none"!==this.ui.searchInput.css("display")},"_isOpenPerspectiveButtonFocusable":function(){return this.ui.openPerspectiveButton.css&&this.ui.openPerspectiveButton.hasClass("cs-open-perspective-button")&&"none"!==this.ui.openPerspectiveButton.css("display")},"_focusOpenPerspectiveButton":function(){return this.currentTabPosition=r.open_perspective,i(this.ui.openPerspectiveButton)},"_focusCloseSearchButton":function(){return this.currentTabPosition=r.close_search,i(this.ui.searchCloseButton)},"_focusList":function(e){return this.currentTabPosition=r.list,(this.selectedIndex<0||this.selectedIndex>this.collection.length-1)&&(this.selectedIndex=0),this.getElementByIndex(this.selectedIndex,e)},"_focusFooter":function(){return this.currentTabPosition=r.footer,i(this.ui.tileExpand)},"currentlyFocusedElement":function(e){if(this.isDestroyed)return this.$el;var i=this._getCurrentTabPosition();return(t.isUndefined(i)||i===r.none)&&(i=e&&e.shiftTab?this._isFooterVisible()?r.footer:r.list:this.hideSearch?this._enableOpenPerspective?r.open_perspective:r.list:r.search),this._setFocusAtTabPosition(i)},"_setFocusAtTabPosition":function(e){switch(e){case r.search:return this._focusSearchButton();case r.open_perspective:case r.close_search:return this._isSearchInputVisible()?this._focusCloseSearchButton():this._focusOpenPerspectiveButton();case r.list:return this._focusList();case r.footer:return this._focusFooter()}},"_isFooterInFocus":function(){return this.currentTabPosition===r.footer||this.ui.tileExpand.is(":focus")},"_isFooterVisible":function(){return this.ui.tileExpand.css&&"none"!==this.ui.tileExpand.css("display")&&!this.ui.tileExpand.hasClass("binf-hidden")&&this.ui.tileExpand.hasClass("tile-expand")},"_isFooterFocusable":function(){return this._isFooterVisible()},"isMoreActionsDropdownOpen":function(){return this.$el.find(".csui-table-cell-name-appendix .csui-table-actionbar .binf-dropdown-menu").is(":visible")},"_isSearchInFocus":function(){return this.currentTabPosition===r.search||this.ui.searchButton.is(":focus")||this.ui.searchInput.is(":focus")||this.ui.clearer.is(":focus")},"_isCloseSearchInFocus":function(){return this._isSearchInputVisible()&&this.currentTabPosition===r.close_search||this.ui.searchCloseButton.is(":focus")},"_isOpenPerspectiveButtonInFocus":function(){return this.currentTabPosition===r.title||this.ui.headerTitle.is(":focus")},"_isSearchButtonVisible":function(){return this.ui.searchButton.is(":visible")||this.ui.searchButton.hasClass&&!this.ui.searchButton.hasClass("binf-hidden")},"_isCloseSearchVisible":function(){return this.ui.searchCloseButton.is(":visible")||this.ui.searchCloseButton.hasClass&&!this.ui.searchCloseButton.hasClass("binf-hidden")},"_isSearchButtonFocusable":function(){return this._isSearchButtonVisible()},"_isCloseSearchFocusable":function(){return this._isCloseSearchVisible()},"_beforeCollectionScrollFetch":function(){if(this.selectedIndexInFocus=!1,this.selectedIndex>=0&&this.selectedIndex<this.collection.length){var e=this.getElementByIndex(this.selectedIndex);e&&e.is(":focus")&&(e.prop("tabindex","-1"),this.selectedIndexInFocus=!0)}},"_afterCollectionScrollFetch":function(){!0===this.selectedIndexInFocus&&this.selectedIndex>=0&&this.selectedIndex<this.collection.length&&setTimeout(this._setFocusToListElement.bind(this,this.selectedIndex),100)},"_setFocusToListElement":function(e){var t=this.getElementByIndex(e);t&&(t.prop("tabindex","0"),t.focus())},"_onKeyInSearchArea":function(e){this.ui.searchButton.is(":focus")||this.ui.searchCloseButton.is(":focus")||this.ui.clearer.is(":focus")?(s(e),i(e.target).trigger("click")):this.ui.searchInput.is(":focus")&&13===e.keyCode&&(s(e),this.filterChanged(e))},"_moveTo":function(e,t,i){s(e),this.trigger("before:keyboard:change:focus"),i&&i.prop("tabindex","-1"),t&&t.prop("tabindex","0"),t&&t.trigger("focus"),this.trigger("changed:focus"),this.trigger("after:keyboard:change:focus")},"onKeyInView":function(e){9===e.keyCode?this._onTabKey(e):32===e.keyCode||13===e.keyCode?this._onEnterOrSpace(e):27===e.keyCode&&this._onEscape(e)},"_onTabKey":function(e){(!this._isSearchInFocus()||this.ui.searchButton.is(":focus")||this.ui.searchCloseButton.is(":focus"))&&this._moveToTabPosition(e,this._getNextTabPosition(e))},"_isListFocusable":function(){return this.collection.length>0},"_getCurrentTabPosition":function(){var e=this.currentTabPosition;return this._isSearchInFocus()&&!this.ui.searchCloseButton.is(":focus")?e=r.search:this._isOpenPerspectiveButtonInFocus()?e=r.open_perspective:this._isFooterInFocus()?e=r.footer:this._isCloseSearchInFocus()&&(e=r.close_search),e},"_isTabPositionFocusable":function(e){switch(e){case r.footer:return this._isFooterFocusable();case r.list:return this._isListFocusable();case r.open_perspective:case r.close_search:return this._isSearchInputVisible()?this._isCloseSearchFocusable():this._isOpenPerspectiveButtonFocusable();case r.search:return this._isSearchButtonFocusable()}return!1},"_getFirstTabPosition":function(){return r.search},"_getLastTabPosition":function(){return r.footer},"_getValidTabPosition":function(e,t){var i,n=this._getFirstTabPosition(),o=this._getLastTabPosition();if(t)for(i=o;i>=n;i--)e!==i||this._isTabPositionFocusable(i)||e--;else for(i=n;i<=o;i++)e!==i||this._isTabPositionFocusable(i)||e++;return e<n||e>o?r.none:e},"_getNextTabPosition":function(e){var t=this._getCurrentTabPosition(),i=e.shiftKey;if(t!==r.none)return i?t--:t++,this._getValidTabPosition(t,i)},"_moveToTabPosition":function(e,t){var i;switch(t){case r.search:i=this._focusSearchButton;break;case r.open_perspective:case r.close_search:i=this._isSearchInputVisible()?this._focusSearchButton:this._focusOpenPerspectiveButton;break;case r.list:i=this._focusList;break;case r.footer:i=this._focusFooter}if(i){var n=i.apply(this,e);if(n&&n.length>0)return this._moveTo(e,n)}},"_onEnterOrSpace":function(e){this._isSearchInFocus()||this._isCloseSearchInFocus()?(this.currentTabPosition=r.search,this._onKeyInSearchArea(e)):(s(e),i(e.target).trigger("click"))},"_onEscape":function(e){if(this.isMoreActionsDropdownOpen())return!1;if(this._isSearchInFocus()||this._isCloseSearchInFocus()){this.ui.searchInput.is(":visible")&&(s(e),this.closeSearchClicked(e),setTimeout(t.bind(function(){this.ui.searchButton.prop("tabindex","0"),this.ui.searchButton.focus()},this),250))}},"onKeyDown":function(e){if(this._isSearchInFocus()||this._isFooterInFocus()||this._isCloseSearchInFocus())return void this.onKeyInView(e);var t;switch(e.which){case 33:case 36:t=this.getElementByIndex(this.selectedIndex),this._moveTo(e,this._selectFirstListElement(),t);break;case 34:case 35:t=this.getElementByIndex(this.selectedIndex),this._moveTo(e,this._selectLastListElement(e),t);break;case 38:this.selectedIndex>0?(t=this.getElementByIndex(this.selectedIndex),this._moveTo(e,this._selectPreviousListElement(e),t)):s(e);break;case 40:this.selectedIndex<this.collection.length-1?(t=this.getElementByIndex(this.selectedIndex),this._moveTo(e,this._selectNextListElement(),t)):s(e);break;default:return void this.onKeyInView(e)}},"_selectFirstListElement":function(){return this.selectedIndex=0,this.getElementByIndex(this.selectedIndex)},"_selectLastListElement":function(e){var t,i=this.selectedIndex;(i<0||i>=this.collection.length)&&(i=0);for(var n=this.collection.length;n>i&&!t;)n--,t=this.getElementByIndex(n,e);return t?(this.selectedIndex=n,t):this.getElementByIndex(this.selectedIndex)},"_selectNextListElement":function(){var e,t=this.selectedIndex;for((t<0||t>=this.collection.length)&&(t=-1);t<this.collection.length-1&&!e;)t++,e=this.getElementByIndex(t);return e?(this.selectedIndex=t,e):this.getElementByIndex(this.selectedIndex)},"_selectPreviousListElement":function(e){return this.selectedIndex>0&&this.selectedIndex--,this.getElementByIndex(this.selectedIndex,e)}})},"refreshTabableElements":function(e){n.debug("ListViewKeyboardBehavior::refreshTabableElements "+e.constructor.name)&&console.log(n.last),this.view.currentTabPosition=r.none,this.view.selectedIndex=-1}})}),csui.define("hbs!csui/controls/list/impl/emptylist",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="cs-emptylist-placeholder"></div>\r\n<div class="cs-emptylist-text"><p class="csui-no-result-message" title="'+e.escapeExpression((s=null!=(s=r(i,"text")||(null!=t?r(t,"text"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"text","hash":{},"loc":{"start":{"line":2,"column":72},"end":{"line":2,"column":80}}}):s))+'">'+e.escapeExpression((s=null!=(s=r(i,"text")||(null!=t?r(t,"text"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"text","hash":{},"loc":{"start":{"line":2,"column":82},"end":{"line":2,"column":90}}}):s))+'</p></div>\r\n<div class="cs-emptylist-placeholder"></div>\r\n'}});return i.registerPartial("csui_controls_list_impl_emptylist",n),n}),csui.define("css!csui/controls/list/impl/emptylist",[],function(){}),csui.define("csui/controls/list/emptylist.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","hbs!csui/controls/list/impl/emptylist","i18n!csui/controls/list/impl/nls/lang","css!csui/controls/list/impl/emptylist"],function(e,t,i,n,o){return i.ItemView.extend({"constructor":function(){i.ItemView.prototype.constructor.apply(this,arguments)},"className":"cs-emptylist-container","template":n,"templateHelpers":function(){return{"text":this.options.text||o.emptyViewDefaultText}}})}),csui.define("hbs!csui/controls/list/impl/list",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="tile-type-icon">\r\n      <span class="icon '+e.escapeExpression((s=null!=(s=r(i,"icon")||(null!=t?r(t,"icon"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"icon","hash":{},"loc":{"start":{"line":5,"column":24},"end":{"line":5,"column":32}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=r(i,"expandAria")||(null!=t?r(t,"expandAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"expandAria","hash":{},"loc":{"start":{"line":5,"column":46},"end":{"line":5,"column":60}}}):s))+'"></span>\r\n    </div>\r\n'},"3":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=r(i,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"imageUrl"):t,{"name":"if","hash":{},"fn":e.program(4,o,0),"inverse":e.noop,"loc":{"start":{"line":8,"column":4},"end":{"line":13,"column":11}}}))?s:""},"4":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <div class="tile-type-image '+e.escapeExpression((s=null!=(s=r(i,"imageClass")||(null!=t?r(t,"imageClass"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"imageClass","hash":{},"loc":{"start":{"line":9,"column":34},"end":{"line":9,"column":48}}}):s))+'">\r\n      <span class="tile-type-icon tile-type-icon-img"><img src="'+e.escapeExpression((s=null!=(s=r(i,"imageUrl")||(null!=t?r(t,"imageUrl"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"imageUrl","hash":{},"loc":{"start":{"line":10,"column":64},"end":{"line":10,"column":76}}}):s))+'"\r\n                                                           alt="'+e.escapeExpression((s=null!=(s=r(i,"expandAria")||(null!=t?r(t,"expandAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"expandAria","hash":{},"loc":{"start":{"line":11,"column":64},"end":{"line":11,"column":78}}}):s))+'"></span>\r\n      </div>\r\n'},"6":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <span class="icon-search-placeholder">'+(null!=(s=(l(i,"icon-v2")||t&&l(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"iconName":"csui_action_search32"},"loc":{"start":{"line":23,"column":46},"end":{"line":23,"column":91}}}))?s:"")+'</span>\r\n        <input class="search" type="search" placeholder="'+e.escapeExpression((r=null!=(r=l(i,"searchPlaceholder")||(null!=t?l(t,"searchPlaceholder"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"searchPlaceholder","hash":{},"loc":{"start":{"line":24,"column":57},"end":{"line":24,"column":78}}}):r))+'"\r\n               title="'+e.escapeExpression((r=null!=(r=l(i,"searchTitle")||(null!=t?l(t,"searchTitle"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"searchTitle","hash":{},"loc":{"start":{"line":25,"column":22},"end":{"line":25,"column":37}}}):r))+'">\r\n        <span class="clearer csui-icon formfield_clear" title="'+e.escapeExpression((r=null!=(r=l(i,"clearAll")||(null!=t?l(t,"clearAll"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"clearAll","hash":{},"loc":{"start":{"line":26,"column":63},"end":{"line":26,"column":75}}}):r))+'"\r\n              aria-label="'+e.escapeExpression((r=null!=(r=l(i,"clearAllAria")||(null!=t?l(t,"clearAllAria"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"clearAllAria","hash":{},"loc":{"start":{"line":27,"column":26},"end":{"line":27,"column":42}}}):r))+'" role="button"></span>\r\n        <span class="fadeout csui-icon" title="'+e.escapeExpression((r=null!=(r=l(i,"searchTitle")||(null!=t?l(t,"searchTitle"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"searchTitle","hash":{},"loc":{"start":{"line":28,"column":47},"end":{"line":28,"column":62}}}):r))+'"></span>\r\n'},"8":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <div title="'+e.escapeExpression((r=null!=(r=l(i,"searchTooltip")||(null!=t?l(t,"searchTooltip"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"searchTooltip","hash":{},"loc":{"start":{"line":34,"column":20},"end":{"line":34,"column":37}}}):r))+'" class="cs-icon-container cs-search-button"\r\n             role="button" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"searchAria")||(null!=t?l(t,"searchAria"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"searchAria","hash":{},"loc":{"start":{"line":35,"column":39},"end":{"line":35,"column":53}}}):r))+'" aria-expanded="false">\r\n          '+(null!=(s=(l(i,"icon-v2")||t&&l(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"states":"true","iconName":"csui_action_search32"},"loc":{"start":{"line":36,"column":10},"end":{"line":36,"column":69}}}))?s:"")+"\r\n        </div>\r\n"},"10":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <div title="'+e.escapeExpression((r=null!=(r=l(i,"openPerspectiveAria")||(null!=t?l(t,"openPerspectiveAria"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"openPerspectiveAria","hash":{},"loc":{"start":{"line":40,"column":20},"end":{"line":40,"column":43}}}):r))+'" class="cs-icon-container cs-open-perspective-button"\r\n             role="button" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"openPerspectiveAria")||(null!=t?l(t,"openPerspectiveAria"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"openPerspectiveAria","hash":{},"loc":{"start":{"line":41,"column":39},"end":{"line":41,"column":62}}}):r))+'">\r\n          '+(null!=(s=(l(i,"icon-v2")||t&&l(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"states":"true","iconName":"csui_action_expand32"},"loc":{"start":{"line":42,"column":10},"end":{"line":42,"column":69}}}))?s:"")+"\r\n        </div>\r\n"},"12":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <div title="'+e.escapeExpression((r=null!=(r=l(i,"searchCloseTooltip")||(null!=t?l(t,"searchCloseTooltip"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"searchCloseTooltip","hash":{},"loc":{"start":{"line":49,"column":20},"end":{"line":49,"column":42}}
}):r))+'" class="cs-icon-container cs-search-close-button"\r\n             role="button" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"searchCloseAria")||(null!=t?l(t,"searchCloseAria"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"searchCloseAria","hash":{},"loc":{"start":{"line":50,"column":39},"end":{"line":50,"column":58}}}):r))+'" aria-expanded="true">\r\n          '+(null!=(s=(l(i,"icon-v2")||t&&l(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"states":"true","iconName":"csui_action_close_mid"},"loc":{"start":{"line":51,"column":10},"end":{"line":51,"column":70}}}))?s:"")+"\r\n        </div>\r\n"},"14":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="tile-footer">\r\n    <div class="cs-more tile-expand" title="'+e.escapeExpression((r=null!=(r=l(i,"expandTitle")||(null!=t?l(t,"expandTitle"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"expandTitle","hash":{},"loc":{"start":{"line":66,"column":44},"end":{"line":66,"column":59}}}):r))+'" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"expandAria")||(null!=t?l(t,"expandAria"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"expandAria","hash":{},"loc":{"start":{"line":66,"column":73},"end":{"line":66,"column":87}}}):r))+'"\r\n         role="button">\r\n      '+(null!=(s=(l(i,"icon-v2")||t&&l(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"states":"true","iconName":"csui_action_expand32"},"loc":{"start":{"line":68,"column":6},"end":{"line":68,"column":65}}}))?s:"")+"\r\n    </div>\r\n  </div>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="tile-header">\r\n\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"icon"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.program(3,o,0),"loc":{"start":{"line":3,"column":2},"end":{"line":14,"column":9}}}))?s:"")+'\r\n  <div class="tile-title" title="'+e.escapeExpression((r=null!=(r=l(i,"title")||(null!=t?l(t,"title"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":16,"column":33},"end":{"line":16,"column":42}}}):r))+'">\r\n    <h2 class="csui-heading">'+e.escapeExpression((r=null!=(r=l(i,"title")||(null!=t?l(t,"title"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":17,"column":29},"end":{"line":17,"column":38}}}):r))+'</h2>\r\n  </div>\r\n\r\n  <div class="tile-controls">\r\n      <div class="search-box">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"hideSearch"):t,{"name":"if","hash":{},"fn":e.noop,"inverse":e.program(6,o,0),"loc":{"start":{"line":22,"column":7},"end":{"line":29,"column":15}}}))?s:"")+'      </div>\r\n\r\n    <div class="tile-icons">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"hideSearch"):t,{"name":"if","hash":{},"fn":e.noop,"inverse":e.program(8,o,0),"loc":{"start":{"line":33,"column":6},"end":{"line":38,"column":13}}}))?s:"")+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"enableOpenPerspective"):t,{"name":"if","hash":{},"fn":e.program(10,o,0),"inverse":e.noop,"loc":{"start":{"line":39,"column":6},"end":{"line":44,"column":13}}}))?s:"")+'    </div>\r\n\r\n    <div class="close-search-icon">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"hideSearch"):t,{"name":"if","hash":{},"fn":e.noop,"inverse":e.program(12,o,0),"loc":{"start":{"line":48,"column":6},"end":{"line":53,"column":13}}}))?s:"")+'    </div>\r\n  </div>\r\n\r\n</div>\r\n\r\n<div class="tile-content" role="listbox">\r\n  <div class="binf-list-group"></div>\r\n  <div class="binf-sr-only" aria-live="off"></div>\r\n</div>\r\n\r\n'+(null!=(s=l(i,"unless").call(null!=t?t:e.nullContext||{},null!=t?l(t,"enableOpenPerspective"):t,{"name":"unless","hash":{},"fn":e.program(14,o,0),"inverse":e.noop,"loc":{"start":{"line":64,"column":0},"end":{"line":71,"column":11}}}))?s:"")+"\r\n"}});return i.registerPartial("csui_controls_list_impl_list",n),n}),csui.define("css!csui/controls/list/impl/list",[],function(){}),csui.define("csui/controls/list/list.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/controls/list/emptylist.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","i18n","hbs!csui/controls/list/impl/list","i18n!csui/controls/list/impl/nls/lang","css!csui/controls/list/impl/list","csui/lib/jquery.ui/js/jquery-ui"],function(e,t,i,n,o,s,r,l,a){var c=i.ItemView.extend({"constructor":function(){i.ItemView.prototype.constructor.apply(this,arguments)}});return i.CompositeView.extend({"direction":r.settings.rtl?"right":"left","constructor":function(t){t||(t={}),e.defaults(t,{"filterValue":""}),this.behaviors&&e.any(this.behaviors,function(e,t){return e.behaviorClass===s})||(this.behaviors=e.extend({"PerfectScrolling":{"behaviorClass":s,"contentParent":"> .tile-content","suppressScrollX":!0,"scrollYMarginOffset":15}},this.behaviors)),i.CompositeView.prototype.constructor.call(this,t);var n=this.templateHelpers(),o=n&&n.title?n.title.toLowerCase():t&&t.data&&t.data.title?t.data.title:"",r={"title":o,"expandTitle":a.expandView,"expandAria":e.str.sformat(a.expandAria,o),"searchTooltip":a.searchView,"searchCloseTooltip":a.collapseSearch,"searchAria":e.str.sformat(a.searchAria,o),"searchCloseAria":a.collapseAria,"collapseSearchTooltip":a.collapseSearch,"openPerspectiveAria":a.openPerspective,"openPerspectiveTooltip":a.openPerspectiveTooltip};this.templateHelpers=e.defaults(n,r,a),this.listenToOnce(this.collection,"sync",function(){this.$el.removeClass("initialLoading")}),this.listenToOnce(this.collection,"error",e.bind(this.handleError,this)),this.listenToOnce(this.completeCollection,"error",e.bind(this.handleError,this)),this.listenTo(this,"doc:preview:generic:actions",this._highlightRow)},"handleError":function(){this.errorExists=!0,this.$el.addClass("csui-list-view-error")},"templateHelpers":function(){},"setValidator":function(){this.validator=setInterval(e.bind(this.validateInput,this),10)},"unsetValidator":function(){clearInterval(this.validator)},"className":"cs-list tile content-tile initialLoading","template":l,"childViewContainer":".binf-list-group","childView":c,"childViewOptions":function(){return{"template":this.options.childViewTemplate}},"emptyView":o,"ui":{"placeholderSearchIcon":".icon-search-placeholder","headerTitle":".tile-title","tileIcon":".tile-icons","searchIcon":".cs-search-icon","searchButton":".cs-search-button","searchCloseButton":".cs-search-close-button","searchBox":".search-box","searchInput":".search","clearer":".clearer","tileExpand":".tile-expand","fadeout":".fadeout","tileHeader":".tile-header","openPerspectiveButton":".cs-open-perspective-button","openPerspectiveIcon":".icon-perspective-open","tileControls":".tile-controls"},"events":{"keydown":"onKeyDown"},"triggers":{"click .tile-header":"before:click:header","click @ui.openPerspectiveButton":"click:open:perspective"},"_highlightRow":function(i,n){t("."+n).removeClass(n);var o=e.findIndex(this.collection.models,function(e){return e.get("id")===i.get("id")});if(-1!==o){var s=this.$childViewContainer,r=s&&s.children(),l=r&&r.eq(o);l&&l.addClass(n)}},"onKeyDown":function(e){},"onBeforeClickHeader":function(){this.errorExists||this.triggerMethod("click:header")},"onRender":function(){this.ui.placeholderSearchIcon.hide(),this.ui.searchInput.hide(),this.ui.clearer.toggle(!1),this.ui.placeholderSearchIcon.on("click",e.bind(this.placeholderSearchIconClicked,this)),this.ui.searchButton.on("click",e.bind(this.searchClicked,this)),this.ui.searchCloseButton.on("click",e.bind(this.closeSearchClicked,this)),this.ui.searchBox.on("click",e.bind(this.searchBoxClicked,this)),this.ui.clearer.on("click",e.bind(this.searchFieldClearerClicked,this)),this.ui.searchInput.on("input",e.bind(this.searchInput,this)),this.srOnly=this.$el.find(".tile-content .binf-sr-only"),this.tileHeader=this.$el.find(".tile-header"),this.titleId=e.uniqueId("dlgTitle"),this.$(this.ui.headerTitle).find(".csui-heading").attr("id",this.titleId),this.$(this.tileHeader).parent().attr("role","region").attr("aria-labelledby",this.titleId),this.$el.find(".tile-content").attr("aria-labelledby",this.titleId),this.$el.on("focusin",e.bind(this.focusinAria,this)),this.$el.on("focusout",e.bind(this.focusoutAria,this)),!1===n.isAppleMobile()&&this._enableOpenPerspective&&this._addActivationEventHandlers()},"_addActivationEventHandlers":function(){var e=this.$el;e.addClass("cs-no-expanding"),e.on("mouseover",function(){e.addClass("cs-hover")}).on("mouseleave",function(){e.removeClass("cs-hover cs-mousedown")}).on("mousedown",function(){e.addClass("cs-mousedown")}).on("mouseup",function(){e.removeClass("cs-mousedown")}).on("focusin",function(){e.addClass("cs-has-focus")}).on("focusout",function(){e.removeClass("cs-has-focus")}),this.ui.tileHeader.on("mouseover",function(){e.addClass("cs-tile-header-hover")}).on("mouseleave",function(){e.removeClass("cs-tile-header-hover")})},"focusOutHandle":void 0,"focusinAria":function(){this.focusOutHandle?(clearTimeout(this.focusOutHandle.handle),this.focusOutHandle=void 0):(this.srOnly.attr("aria-live","polite"),this.setElementsVisibleAria())},"focusoutAria":function(){var e=this;this.focusOutHandle=setTimeout(function(){e.srOnly.attr("aria-live","off"),e.srOnly.html(""),e.focusOutHandle=void 0},25)},"searchBoxClicked":function(e){e.stopPropagation()},"searchFieldClearerClicked":function(){this.ui.searchInput.val(""),this.filterChanged(),this.ui.searchInput.trigger("focus")},"placeholderSearchIconClicked":function(){this.ui.searchInput.trigger("focus")},"isSearchOpen":function(){return this.ui.searchInput.is&&this.ui.searchInput.is(":visible")},"searchClicked":function(t){this.ui.searchInput.val(""),this.ui.clearer.toggle(!1),this.ui.headerTitle.hide(),this.ui.searchInput.show("blind",{"direction":this.direction},200,e.bind(function(){this.ui.searchInput.prop("tabindex","0"),this.ui.searchInput.trigger("focus")},this)),this.setValidator(),this.ui.placeholderSearchIcon.show("fast"),this.$(this.ui.searchIcon).addClass("icon-search-hide"),this.$(this.ui.searchCloseButton).addClass("icon-search-hide"),this.ui.tileIcon.fadeOut(),this.ui.tileControls.addClass("search-enabled"),this.ui.searchCloseButton.fadeIn(),this.ui.searchCloseButton.prop("tabindex","0"),this.ui.fadeout.show(250,e.bind(function(){this._resetFilter()},this)),t&&t.stopPropagation()},"closeSearchClicked":function(t){this.ui.searchInput.val(""),this.ui.clearer.toggle(!1),this.ui.fadeout.hide(),this.ui.placeholderSearchIcon.hide(),this.ui.searchCloseButton.fadeOut(e.bind(function(){this.ui.tileIcon.fadeIn(),this.ui.headerTitle.show("fade",e.bind(function(){this.ui.searchButton.prop("tabindex","0"),this.ui.searchButton.trigger("focus"),this._resetFilter()},this))},this)),this.ui.tileControls.removeClass("search-enabled"),this.unsetValidator(),this.$(this.ui.searchIcon).removeClass("icon-search-hide"),this.$(this.ui.searchCloseButton).removeClass("icon-search-hide"),this.ui.searchInput.hide("blind",{"direction":this.direction},200),t&&t.stopPropagation()},"validateInput":function(){if(this.ui.searchInput.val){var e=this.ui.searchInput.val&&!!this.ui.searchInput.val().length;this.ui.clearer.toggle(e),this.ui.clearer.prop("tabindex",e?"0":"-1")}},"searchInput":function(t){this.keyInputTimer&&clearTimeout(this.keyInputTimer),this.keyInputTimer=setTimeout(e.bind(function(){this.keyInputTimer=void 0,this.filterChanged()},this),300)},"filterChanged":function(){this.options.filterValue=this.ui.searchInput.val(),this.trigger("change:filterValue"),this.setElementsVisibleAria()},"setElementsVisibleAria":function(){var t=this.collection?this.collection.size():"0";this.srOnly.text(e.str.sformat(a.elementsVisibleAria,t,this.templateHelpers.title))},"_resetFilter":function(){this.ui.searchInput.val(""),this.filterChanged()},"getElementByIndex":function(i){if(isNaN(i)||i<0)return null;var n=this.showInlineActionBar?"div.csui-item-standard:nth-child({0})":"div a:nth-child({0})",o=e.str.sformat(n,i+1),s=this.$(o);return 0===s.length&&(s=this._lookForElementToTabTo(i,['[role="option"] > div:not(.binf-hidden)','[role="option"]'])),s?t(s[0]):void 0},"_lookForElementToTabTo":function(e,i){var n,o=this.el;return i&&i.some(function(i){var s=o.querySelectorAll(i);if(s&&s.length>e)return n=t(s[e])}),n}})}),csui.define("csui/controls/list/list.state.view",["csui/behaviors/collection.state/collection.state.view","hbs!csui/controls/list/impl/emptylist","css!csui/controls/list/impl/emptylist"],function(e,t){"use strict";return e.extend({"constructor":function(){e.prototype.constructor.apply(this,arguments)},"className":"cs-emptylist-container "+e.prototype.className,"template":t,"serializeData":function(){var t=e.prototype.serializeData.apply(this,arguments);return{"text":"loading"===t.state?"":t.message}}})}),csui.define("csui/models/node.children2.lite/server.adaptor.mixin",["csui/lib/underscore","csui/utils/url","csui/models/browsable/v1.request.mixin","csui/models/browsable/v2.response.mixin","csui/models/mixins/appcontainer/appcontainer.mixin"],function(e,t,i,n,o){"use strict";return{"mixin":function(s){return n.mixin(s),i.mixin(s),o.mixin(s),e.extend(s,{"makeServerAdaptor":function(e){return this.useSpecialPaging=e.useSpecialPaging,this.makeBrowsableV1Request(e).makeBrowsableV2Response(e).makeAppContainer(e),this},"url":function(){var i,n,o=new t(this.node.connector.connection.url).getApiBase(2);if(this.useSpecialPaging){i=t.combine(o,"app/container",this.node.get("id"),"page");var s={"fields":e.without(this.getResourceFieldsUrlQuery().fields,"properties")};n=t.combineQueryString(this.getBrowsableUrlQuery(),s)}else i=t.combine(o,"nodes",this.node.get("id"),"nodes"),n=t.combineQueryString(this.getBrowsableUrlQuery(),this.getResourceFieldsUrlQuery(),this.getExpandableResourcesUrlQuery(),this.getStateEnablingUrlQuery(),this.getAdditionalResourcesUrlQuery(),this.getRequestedCommandsUrlQuery());return t.appendQuery(i,n)},"parse":function(e,t){if(this.useSpecialPaging){var i=this;e.results=e.results.map(function(e){return i.massageResponse(e)})}return this.parseBrowsedState(e,t),this.parseBrowsedItems(e,t)}})}}}),csui.define("csui/models/node.children2.lite/node.children2.lite",["module","csui/lib/underscore","csui/lib/backbone","csui/models/node/node.model","csui/models/node.children2/node.children2","csui/models/node.children2.lite/server.adaptor.mixin"],function(e,t,i,n,o,s){"use strict";var r=e.config();t.defaults(r,{"defaultPageSize":10});var l=o.extend({"model":n,"constructor":function(e,i){i=t.defaults({},i,{"top":r.defaultPageSize},i),o.prototype.constructor.call(this,e,i)}});return s.mixin(l.prototype),l}),csui.define("hbs!csui/controls/treebrowse/impl/tree.node.error",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<span class="csui-icon-group csui-tree-error-node-icon">\r\n  '+(null!=(s=(r(i,"icon-v2")||t&&r(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"size":"xsmall","iconName":"csui_action_close32"},"loc":{"start":{"line":2,"column":2},"end":{"line":2,"column":60}}}))?s:"")+"\r\n</span>"}});return i.registerPartial("csui_controls_treebrowse_impl_tree.node.error",n),n}),csui.define("csui/controls/treebrowse/impl/tree.node.error.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","hbs!csui/controls/treebrowse/impl/tree.node.error"],function(e,t,i,n){"use strict";return i.ItemView.extend({"tagName":"span","className":"csui-tree-error-node-icon-container","template":n,"constructor":function(e){e=e||{},i.ItemView.prototype.constructor.call(this,e)}})}),csui.define("csui/controls/treebrowse/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/treebrowse/impl/nls/root/lang",{"ShowMore":"Show more","ShowLess":"Show less","tooltipTreeNodeExpand":"Expand","tooltipTreeNodeCollapse":"Collapse","expandNetworkError":'Unable to open the "{0}" node as the connection is lost.',"showMoreNetworkError":"Unable to open the link as the connection is lost.","nodeDoesNotExistMsg":"Node does not exist."}),csui.define("csui/controls/treebrowse/impl/fancytree.overrides",["csui/lib/jquery","i18n!csui/controls/treebrowse/impl/nls/lang","csui/lib/fancytree/jquery.fancytree"],function(e,t){"use strict";return e.ui.fancytree.registerExtension({"name":"csui-overrides","version":"1.0.0","options":{"rootIndent":0,"levelIndent":12},"nodeRenderStatus":function(i){var n,o=i.node,s=e(o.span),r=o.getLevel(),l=o.isExpanded(),a=i.options["csui-overrides"],c=e(o[i.tree.statusClassPropName]),u=e(o.tr||o.li),d=s.find(".fancytree-expander");return n=this._super(i),d.attr("title",l?t.tooltipTreeNodeCollapse:t.tooltipTreeNodeExpand),!0===o.data.disabled?(c.addClass("fancytree-disabled"),i.options.aria&&u.attr("aria-disabled",!0)):i.options.aria&&u.attr("aria-disabled",!1),u.addClass("fancytree-level-"+r),i.tree.options.rtl?s.css({"paddingRight":(r-1)*a.levelIndent+a.rootIndent}):s.css({"paddingLeft":(r-1)*a.levelIndent+a.rootIndent}),o.isPagingNode()&&s.find(".fancytree-title:not(:has(.fancytree-paging-icon))").append('<span class="fancytree-paging-icon '+(o.data.showMore?"show-more":"show-less")+'">'),!0===o._isLoading?s.find(".fancytree-expander").append('<div class="fancytree-loader"></div>'):s.find(".fancytree-expander").empty(),!0===o.data.isErrorNode?s.addClass("fancytree-node-error"):!0===o.hasError&&s.addClass("fancytree-error"),n},"nodeSetActive":function(t,i,n){if(!0===t.node.data.disabled)return e.Deferred(function(){this.resolveWith(t)}).promise();this._super(t,i,n)},"treeSetFocus":function(e,t,i){!1===t&&this.focusNode&&(this._lastFocusNode=this.focusNode);var n=this._super(e,t,i);return!t||i&&i.calledByNode||this.focusNode||!this._lastFocusNode||this._lastFocusNode.setFocus(),n}}),e.ui.fancytree}),csui.define("css!csui/controls/treebrowse/impl/tree",[],function(){}),csui.define("csui/controls/treebrowse/tree.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/models/node/node.model","csui/controls/node-type.icon/node-type.icon.view","csui/controls/treebrowse/impl/tree.node.error.view","csui/lib/fancytree/jquery.fancytree","csui/controls/treebrowse/impl/fancytree.overrides","css!csui/controls/treebrowse/impl/tree"],function(e,t,i,n,o,s){"use strict";return i.ItemView.extend({"template":!1,"className":"csui-tree-browse","constructor":function(e){e=e||{};var r=["activate","beforeActivate","click","clickPaging","collapse","dblclick","expand","focus","init","keydown","lazyLoad","source","rtl"];this.treeOptions=t.extend(t.pick(e,r),{"extensions":["csui-overrides"],"csui-overrides":{"rootIndent":4,"levelIndent":24},"escapeTitles":!0,"autoActivate":!1,"icon":function(e,i){var r=i.node;if(!0===r.data.isErrorNode){return{"html":(new s).render().el.outerHTML}}if(!t.isEmpty(r.data)&&void 0==r.data.showMore){var l=r.data.origNode;l||(l=new n({"id":r.key}));return{"html":new o({"node":l,"size":"xsmall","states":"true","colorTheme":"tree"}).render().el.outerHTML}}}}),e=t.omit(e,r),i.ItemView.prototype.constructor.call(this,e)},"onBeforeRender":function(){this.tree=e.ui.fancytree.getTree(this.$el.fancytree(this.treeOptions))},"onBeforeDestroy":function(){this.tree&&this.tree.widget&&this.tree.widget.destroy()}})}),csui.define("hbs!csui/controls/treebrowse/impl/node.tree",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="csui-tree-browse-container"></div>'}});return i.registerPartial("csui_controls_treebrowse_impl_node.tree",n),n}),csui.define("css!csui/controls/treebrowse/impl/node.tree",[],function(){}),csui.define("csui/controls/treebrowse/node.tree.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/utils/contexts/factories/next.node","csui/utils/contexts/factories/ancestors","csui/controls/globalmessage/globalmessage","csui/utils/log","csui/models/node.children2.lite/node.children2.lite","csui/controls/treebrowse/tree.view","i18n","hbs!csui/controls/treebrowse/impl/node.tree","i18n!csui/controls/treebrowse/impl/nls/lang","css!csui/controls/treebrowse/impl/node.tree"],function(e,t,i,n,o,s,r,l,a,c,u,d,h,p){"use strict";a=a(e.id);return n.LayoutView.extend({"className":"csui-tree-browse-panel","template":h,"regions":{"treeRegion":".csui-tree-browse-container"},"behaviors":{"PerfectScrolling":{"behaviorClass":o,"suppressScrollX":!0}},"constructor":function(e){if(!e||!e.originatingView)throw new Error("originatingView option is mandatory");i.defaults(e,{"lazyTree":!0}),this.context=e.originatingView.context,this.connector=e.originatingView.connector,this.originatingView=e.originatingView,this.showItemsBlockSize=e.showItemsBlockSize||10,this.rootNodes=e.rootNodes||e.originatingView.rootNodes,this.lazyLoading=e.lazyTree,this.ancestors=this.context.getCollection(r),n.LayoutView.prototype.constructor.call(this,e),this.listenTo(this.originatingView.collection,"add",this._modelAdded,this),this.listenTo(this.originatingView.collection,"remove",this._modelRemoved,this),this.listenTo(this.originatingView.collection,"change:name sync",this._modelRenamed,this),this.listenTo(this.originatingView.container,"change:name",this._modelRenamed,this),this.listenTo(this.originatingView.container,"delete",this._modelRemoved,this)},"is":"NodeTreeView","onRender":function(){this.treeView=new u(this._buildTreeOptions()),this.treeRegion.show(this.treeView)},"updateNodes":function(){var e=this,t=this.treeView.tree.activeNode;if(t){var n=this.getUpdatedAncestors(this.ancestors),o=t.getParentList(!1,!0),s=0;if(o.forEach(function(t){t.title!==n[s].name&&e._updateNodeTitle(t,n[s].name),s++}),t.isExpanded()){var r=this.originatingView.collection.filter(function(e){return!0===e.get("container")}),l=t.getChildren();r.forEach(function(t){var n=i.find(l,function(e){return t.get("id").toString()===e.key});n&&n.key!==t.get(name)&&e._updateNodeTitle(n,t.get("name"))})}}},"getUpdatedAncestors":function(e){if(this.updateAncestors){var t=[],i=!1;return e.each(function(e){i?t.push({"id":e.get("id").toString(),"name":e.get("name")}):this.rootNodes.some(function(n){return n.get("id")===e.get("id")&&(i=!0,t.push({"id":e.get("id").toString(),"name":e.get("name")}),!0)})},this),t}return e.map(function(e){return{"id":e.get("id").toString(),"name":e.get("name")}})},"onDomRefresh":function(){this._clearTabIndexes()},"_clearTabIndexes":function(){var e=this.el.querySelectorAll(".ps-scrollbar-x[tabindex], .ps-scrollbar-y[tabindex]");if(e.length)for(var t=0;t<e.length;t++)e[t].setAttribute("tabindex",-1)},"_buildTreeOptions":function(){var e=this.context.getModel(s),n=this.context.getCollection(r),o=i.extend({"rtl":!(!d||!d.settings.rtl),"source":function(){var e=[];return this.rootNodes&&this.rootNodes.length>0?(i.each(this.rootNodes,function(t){e.push(t)}),this.updateAncestors=!0):e.push(n.first()),i.map(e,this._createTreeNode)},"init":function(e,t){function i(e){o._activateNode(t.tree,o.getUpdatedAncestors(n),void 0,e),!e&&o.updateNodes()}var o=this;this.listenTo(n,"update reset",function(){i(!1)}),t.tree.data.firstLoad=!0,i(!0)},"lazyLoad":function(e,n){var o=t.Deferred(),s=n.node;this._fetchNodeChildren(s,0,this._getInitialFetchLimit(s)).done(i.bind(function(e){s.hasError=!1;var t=this._getInitialShowLimit(s),n=i.map(e.models,this._createTreeNode),r=i.clone(n);s.data.totalCount=e.totalCount,s.data.allChildren=r,s.data.totalCount>t&&(n.splice(t),this._addPagingNode(n,r,s.data.totalCount,t)),o.resolve(n)},this)).fail(function(e){s.setStatus("ok"),404===e.status?(s.hasError=!0,this._makeErrorNode(s)):l.showMessage("error",i.str.sformat(p.expandNetworkError,s.title))}.bind(this)),n.result=o.promise()},"focus":function(e,t){t.node.scrollIntoView(!0)},"expand":function(){this.trigger("update:scrollbar")},"collapse":function(e,t){this.trigger("update:scrollbar"),t.node.resetLazy()},"click":function(e,t){if(i.isEmpty(t.node.data)||t.node.hasError||t.node.data.isErrorNode)return e.preventDefault(),e.stopPropagation(),!1;t.tree.activateKey(!1,{"noEvents":!0})},"dblclick":function(){return!1},"keydown":function(e,t){if(13===e.which||32===e.which){if(t.node.hasError||t.node.data.isErrorNode)return!1;t.tree.activateKey(!1,{"noEvents":!0})}},"clickPaging":function(e,t){this._clickPagingNode(t.node)},"beforeActivate":function(e,t){return!t.node.isPagingNode()||(t.tree.options.clickPaging.apply(this,arguments),!1)},"activate":function(t,i){var n=e.get("id").toString();n!=i.node.key&&(e.trigger("before:change:id",i.node.data.origNode,this),e.set({"id":i.node.key})),n!==i.node.key||i.tree.data.firstLoad||this.originatingView.collection.fetch({"reload":!0}),i.tree._currActiveNodeKey=i.node.key}},this.options);for(var a in o)i.isFunction(o[a])&&(o[a]=o[a].bind(this));return o},"_clickPagingNode":function(e){var i=t.Deferred();return this.lazyLoading?this._clickPagingNodeLazy(e).done(i.resolve):this._clickPagingNodePrefetch(e).done(i.resolve),i.promise()},"_makeErrorNode":function(e){e.addNode({"title":p.nodeDoesNotExistMsg,"isErrorNode":!0});e.setExpanded(!0,{"noEvents":!0})},"_getInitialFetchLimit":function(e){return this.lazyLoading?this.showItemsBlockSize:2*this.showItemsBlockSize},"_getInitialShowLimit":function(e){return this.showItemsBlockSize},"_createTreeNode":function(e){var t=!!e.get("container");return{"key":e.get("id"),"origNode":e,"title":e.get("name"),"tooltip":e.get("name"),"folder":t,"lazy":t}},"_fetchNodeChildren":function(e,n,o){var s=t.Deferred(),r=new c([],i.defaults({"autoreset":!0,"fields":{"properties":[]}},{"node":e.data.origNode}));return r.setFilter(-1,"type",{"fetch":!1}),this._setCollectionOptions(r,e.data.origNode,n,o),r.fetch().done(function(){s.resolve(r)}).fail(s.reject),s.promise()},"_activateNode":function(e,t,n,o){var s,r,l=this;if(t.length>0){if(s=t[0].id,!n){var c=e.rootNode.getChildren();r=i.find(c,{"key":s})}if(!r){var u=n||e.activeNode;r=u&&i.find(u.getChildren(),function(e){return e.key===s})}if(r||(r=e.getNodeByKey(s)),r)1===t.length?!0===o?(r.setExpanded(!0).done(function(){r.setActive(!0)}),e.data.firstLoad=!1):r.setActive(!0):r.setExpanded(!0).done(function(){t.splice(0,1),l._activateNode(e,t,r,o)});else{if(n){var d=n.getLastChild();if(d&&"paging"===d.statusNodeType&&d.data.showMore)return void l._clickPagingNode(d).done(function(){l._activateNode(e,t,n,o)})}a.error("Ancestor "+s+" not found in the tree, while trying to activate the node")&&console.error(a.last)}}},"_addPagingNode":function(e,t,i,n){var o=n<i;e.push({"statusNodeType":"paging","title":o?p.ShowMore:p.ShowLess,"data":{"allChildren":t,"currPageListSize":n,"showMore":o}})},"_displayLoader":function(e){var i=t(e.span),n=parseFloat(i.css("padding-left")),o=i.width();this.treeView.tree.nodeSetStatus({"node":e},"loading"),i.find(".fancytree-title").addClass("binf-hidden"),d&&d.settings.rtl?i.css({"paddingRight":n+o/2}):i.css({"paddingLeft":n+o/2})},"_clickPagingNodeLazy":function(e,n){var o,s,r=this,a=t.Deferred(),c=e.getParent(),u=e.data.allChildren,d=c.data.totalCount,h=e.getIndex(),f=e.data.showMore&&!0!==n;if(f)o=h+this.showItemsBlockSize,r._displayLoader(e),r._fetchNodeChildren(c,h,r.showItemsBlockSize).done(function(t){s=i.map(t.models,r._createTreeNode),d>u.length&&u.push.apply(u,s),r.treeView.tree.nodeSetStatus({"node":e},"ok"),r._addPagingNode(s,u,d,o),r._replacePagingNodeWithChildren(e,s,f,n).done(a.resolve)}).fail(function(t){r.treeView.tree.nodeSetStatus({"node":e},"ok"),l.showMessage("error",i.str.sformat(p.showMoreNetworkError))});else{s=[],o=r._getInitialShowLimit(e.parent),r._addPagingNode(s,u,d,o);for(var m=c.children.length-2;m>=o;m--)c.removeChild(c.children[m]);r._replacePagingNodeWithChildren(e,s,f,n).done(a.resolve)}return a.promise()},"_clickPagingNodePrefetch":function(e,n){function o(){var e=d.length;h>d.length&&(g=a._fetchNodeChildren(u,e,a.showItemsBlockSize),u.data.promise=g,g.done(function(e){var t=i.map(e.models,a._createTreeNode);g.finish=!0,d.push.apply(d,t)}).fail(function(){g.rejected=!0}))}var s,r,a=this,c=t.Deferred(),u=e.getParent(),d=e.data.allChildren,h=u.data.totalCount,f=e.getIndex(),m=e.data.showMore&&!0!==n,g=u.data.promise;if(m)s=f+a.showItemsBlockSize,!g||g.finish?(r=d.slice(f,s),s=d.length<s?d.length:s,o(),a._addPagingNode(r,d,h,s),a._replacePagingNodeWithChildren(e,r,m,n).done(c.resolve)):g.finish||g.rejected?g.rejected?l.showMessage("error",i.str.sformat(p.showMoreNetworkError)):console.error("Network issue fetching show more results"):(a._displayLoader(e),g.done(function(){a.treeView.tree.nodeSetStatus({"node":e},"ok"),r=d.slice(f,s),o(),a._addPagingNode(r,d,h,s),a._replacePagingNodeWithChildren(e,r,m,n).done(c.resolve)}).fail(function(){console.error("Network issue fetching show more results")}));else{r=[],s=a._getInitialShowLimit(e.parent),a._addPagingNode(r,d,h,s);for(var v=u.children.length-2;v>=s;v--)u.removeChild(u.children[v]);a._replacePagingNodeWithChildren(e,r,m,n).done(c.resolve)}return c.promise()},"_replacePagingNodeWithChildren":function(e,n,o,s){var r=e.getParent(),l=e.getIndex(),a=t.Deferred();return e.replaceWith(n).done(function(){this.trigger("update:scrollbar"),o&&e.tree._currActiveNodeKey&&i.any(n,{"key":e.tree._currActiveNodeKey})&&this._getActiveNode().setActive(!0,{"noFocus":!0,"noEvents":!0}),!0!==s&&r.children[l].setFocus(!0),a.resolve()}.bind(this)).fail(a.reject),a.promise()},"_setCollectionOptions":function(e,t,i,n){e.node=t,e.skipCount=i,e.topCount=n},"_getActiveNode":function(){var e=this.treeView.tree;return e.getNodeByKey(e._currActiveNodeKey)},"_addNewNode":function(e,t){var n,o,s=e.getLastChild(),r=s&&"paging"===s.statusNodeType,l=r?s.data.allChildren:e.getChildren(),a=i.map(l,function(e){return{"key":e.key,"title":e.title}});a.push(t),a=i.sortBy(a,function(e){return e.title.toLowerCase()}),i.find(a,function(e,i){if(e.key===t.key)return n=i,!0}),n<e.getChildren().length?(e.addChildren([t],-1===n?null:n),o=!0):n!==e.getChildren().length||r||(e.addChildren([t]),o=!0),r&&(s.data.allChildren.splice(n,0,t),o&&(s.data.currPageListSize=s.data.currPageListSize+1))},"_removeNode":function(e,t){var n=i.find(e.getChildren(),{"key":t.toString()});n&&n.remove();var o=e.getLastChild();o&&"paging"===o.statusNodeType&&(o.data.allChildren=i.reject(o.data.allChildren,{"key":t}),n&&(o.data.currPageListSize=o.data.currPageListSize-1),o.data.allChildren.length===o.data.currPageListSize&&e.removeChild(o))},"_modelAdded":function(e){var t=this,n=function(e){var n=t._getActiveNode(),o=n.key,s=t.treeView.tree.findAll(function(e){return e.isLoaded()&&o===e.key});i.each(s,function(i){t._addNewNode(i,t._createTreeNode(e))})};e.get("container")&&(e.get("id")?n(e):t.listenToOnce(e,"sync",function(){n(e)}))},"_modelRemoved":function(e){var t=this;if(e.get("container")){var n=e.get("id"),o=t.treeView.tree.findAll(function(e){if(e.isLoaded()&&e.hasChildren()){if(i.any(e.getChildren(),{"key":n.toString()}))return!0;var t=e.getLastChild();if("paging"===t.statusNodeType)return i.any(t.data.allChildren,{"key":n})}return!1});i.each(o,function(e){t._removeNode(e,n)})}},"_modelRenamed":function(e){var t=this;if(e.get("container")&&e.changed.name){var n=e.get("id"),o=t.treeView.tree.findAll(function(t){return"paging"===t.statusNodeType?(i.each(t.data.allChildren,function(t){t.key===n&&(t.title=e.get("name"))}),
!1):n.toString()===t.key});i.each(o,function(i){t._updateNodeTitle(i,e.get("name"))})}},"_updateNodeTitle":function(e,t){e.tooltip=t,e.setTitle(t)}})}),csui.define("hbs!csui/controls/listitem/impl/simpletreelistitem",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <span class="csui-button-icon container-icon '+e.escapeExpression((s=null!=(s=r(i,"icon")||(null!=t?r(t,"icon"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"icon","hash":{},"loc":{"start":{"line":3,"column":49},"end":{"line":3,"column":57}}}):s))+'"></span>\r\n'},"3":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return e.escapeExpression((s=null!=(s=r(i,"tooltip")||(null!=t?r(t,"tooltip"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"tooltip","hash":{},"loc":{"start":{"line":5,"column":46},"end":{"line":5,"column":57}}}):s))},"5":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return e.escapeExpression((s=null!=(s=r(i,"name")||(null!=t?r(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":5,"column":65},"end":{"line":5,"column":73}}}):s))},"7":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <span class="csui-button-icon dropdown-icon icon-expandArrowUp" title="'+e.escapeExpression((s=null!=(s=r(i,"collapseLabel")||(null!=t?r(t,"collapseLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"collapseLabel","hash":{},"loc":{"start":{"line":7,"column":75},"end":{"line":7,"column":92}}}):s))+'"></span>\r\n'},"9":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <span class="csui-button-icon dropdown-icon icon-expandArrowDown" title="'+e.escapeExpression((s=null!=(s=r(i,"expandLabel")||(null!=t?r(t,"expandLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"expandLabel","hash":{},"loc":{"start":{"line":9,"column":77},"end":{"line":9,"column":92}}}):s))+'"></span>\r\n'},"11":function(e,t,i,n,o){return" binf-hidden"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="cs-header binf-panel-heading" tabindex="-1" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"ariaName")||(null!=t?l(t,"ariaName"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"ariaName","hash":{},"loc":{"start":{"line":1,"column":68},"end":{"line":1,"column":80}}}):r))+'">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"icon"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":2,"column":2},"end":{"line":4,"column":9}}}))?s:"")+'  <div class="cs-title" title="'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"tooltip"):t,{"name":"if","hash":{},"fn":e.program(3,o,0),"inverse":e.program(5,o,0),"loc":{"start":{"line":5,"column":31},"end":{"line":5,"column":80}}}))?s:"")+'">'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":5,"column":82},"end":{"line":5,"column":90}}}):r))+"</div>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"expand"):t,{"name":"if","hash":{},"fn":e.program(7,o,0),"inverse":e.program(9,o,0),"loc":{"start":{"line":6,"column":2},"end":{"line":10,"column":9}}}))?s:"")+'</div>\r\n\r\n<div class="cs-content '+(null!=(s=l(i,"unless").call(null!=t?t:e.nullContext||{},null!=t?l(t,"expand"):t,{"name":"unless","hash":{},"fn":e.program(11,o,0),"inverse":e.noop,"loc":{"start":{"line":13,"column":23},"end":{"line":13,"column":64}}}))?s:"")+" "+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"flatten"):t,{"name":"if","hash":{},"fn":e.program(11,o,0),"inverse":e.noop,"loc":{"start":{"line":13,"column":65},"end":{"line":13,"column":99}}}))?s:"")+'">\r\n  <div role="group" class="cs-list-group"></div>\r\n</div>\r\n'}});return i.registerPartial("csui_controls_listitem_impl_simpletreelistitem",n),n}),csui.define("hbs!csui/controls/listitem/impl/simpletreelistleaf",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return e.escapeExpression((s=null!=(s=r(i,"tooltip")||(null!=t?r(t,"tooltip"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"tooltip","hash":{},"loc":{"start":{"line":3,"column":41},"end":{"line":3,"column":52}}}):s))},"3":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return e.escapeExpression((s=null!=(s=r(i,"name")||(null!=t?r(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":3,"column":60},"end":{"line":3,"column":68}}}):s))},"5":function(e,t,i,n,o){return'<div class="csui-tileview-more-btn"></div>'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="binf-list-group-item">\r\n  <span class="csui-type-icon '+e.escapeExpression((r=null!=(r=l(i,"icon")||(null!=t?l(t,"icon"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"icon","hash":{},"loc":{"start":{"line":2,"column":30},"end":{"line":2,"column":38}}}):r))+'"></span>\r\n  <div role="link" title="'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"tooltip"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.program(3,o,0),"loc":{"start":{"line":3,"column":26},"end":{"line":3,"column":75}}}))?s:"")+'"\r\n        class="list-item-title" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"itemLabel")||(null!=t?l(t,"itemLabel"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"itemLabel","hash":{},"loc":{"start":{"line":4,"column":44},"end":{"line":4,"column":57}}}):r))+'">'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":4,"column":59},"end":{"line":4,"column":67}}}):r))+"</div>\r\n  "+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"showInlineActionBar"):t,{"name":"if","hash":{},"fn":e.program(5,o,0),"inverse":e.noop,"loc":{"start":{"line":5,"column":2},"end":{"line":5,"column":78}}}))?s:"")+"\r\n</div>\r\n"}});return i.registerPartial("csui_controls_listitem_impl_simpletreelistleaf",n),n}),csui.define("csui/controls/listitem/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/listitem/impl/nls/root/lang",{"treeListExpandTooltip":"Expand","treeListCollapseTooltip":"Collapse","itemTitleLabel":"{0}, Press enter to open or right arrow to access other actions","typeAndNameAria":"{0} {1}"}),csui.define("css!csui/controls/listitem/impl/simpletreelistitem",[],function(){}),csui.define("csui/controls/listitem/simpletreelistitem.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/list/emptylist.view","csui/controls/node-type.icon/node-type.icon.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/utils/node.links/node.links","csui/behaviors/default.action/default.action.behavior","csui/controls/listitem/impl/inline.menu/inline.menu.view","csui/controls/list/behaviors/list.item.keyboard.behavior","csui/utils/accessibility","hbs!csui/controls/listitem/impl/simpletreelistitem","hbs!csui/controls/listitem/impl/simpletreelistleaf","i18n!csui/controls/listitem/impl/nls/lang","css!csui/controls/listitem/impl/simpletreelistitem"],function(e,t,i,n,o,s,r,l,a,c,u,d,h,p,f,m){"use strict";var g=h.isAccessibleTable(),v={"none":-1,"header":0,"list":1},b=n.ItemView.extend({"tagName":"a","attributes":function(){return{"role":"treeitem","tabindex":"-1"}},"template":f,"modelEvents":{"change":"render"},"ui":{"titleName":".list-item-title","moreActions":".csui-tileview-more-btn"},"events":function(){var t={"click":"onExecuteClick"};return this.options.toolbarData&&!g&&(t=e.extend(t,{"mouseenter":"onShowInlineMenu","mouseleave":"onHideInlineMenu","wheel":"onWheelEvent"})),t},"behaviors":{"DefaultAction":{"behaviorClass":c},"ListItemKeyboardBehavior":{"behaviorClass":d}},"onExecuteClick":function(e){o.isControlClick(e)||(e.stopPropagation(),e.preventDefault(),this.triggerMethod("click:item",{"target":this.model}))},"constructor":function(e){e||(e={}),this.showInlineActionBar=!!e.toolbarData,this.showInlineActionBar&&(this.triggers={},this.tileViewToolbarItems=e.toolbarData.toolbaritems),n.ItemView.prototype.constructor.apply(this,arguments),this.context=e.context,this.listenTo(this,"doc:preview:generic:actions",this._highlightRow)},"_highlightRow":function(e,i){t("."+i).removeClass(i),this.$el.addClass(i)},"cascadeDestroy":function(){return!1},"onShowInlineMenu":function(e){var t=this.$el.find(".csui-tileview-more-btn");if(!o.isHybrid()||!e&&t.length){e&&e.preventDefault(),e&&e.stopPropagation(),this.$el.addClass("csui-tile-with-more-btn"),this._inlineMenuView=new u({"context":this.options.context,"originatingView":this,"commands":this.defaultActionController.commands,"model":this.model,"tileViewToolbarItems":this.tileViewToolbarItems});new n.Region({"el":t}).show(this._inlineMenuView),this.listenTo(this._inlineMenuView,"before:execute:command",function(e){this.trigger("before:execute:command",e)}),this.listenTo(this._inlineMenuView,"after:execute:command",function(){o.isHybrid()||this.onHideInlineMenu()})}},"onHideInlineMenu":function(e){return e&&o.isHybrid()?void(this._inlineMenuView&&this._inlineMenuView.inlineMenuBarView&&this._inlineMenuView.inlineMenuBarView.closeDropdownMenuIfOpen()):(this.$el.removeClass("csui-tile-with-more-btn"),this._inlineMenuView?(this._inlineMenuView.destroy(),this._inlineMenuView=void 0,!0):void 0)},"onWheelEvent":function(e){this._inlineMenuView&&this._inlineMenuView.closeDropdownMenuIfOpen()},"onRender":function(){if(null!=(this.model&&this.model.get("id"))&&this.$el.attr("href",a.getUrl(this.model)),this.options.refetchNodeActions&&this.model&&(this.model.refetchNodeActions=!0),this._nodeIconView&&this._nodeIconView.destroy(),this._nodeIconView=new r({"el":this.$(".csui-type-icon").get(0),"node":this.model,"size":this.options.iconSize}),this.$el.attr("aria-label",e.str.sformat(m.typeAndNameAria,this._nodeIconView.model.get("title"),this.model.get("name"))),this._nodeIconView.render(),this.model&&this.options&&this.options.checkDefaultAction){var t=!1===this.model.fetched||!this.defaultActionController.hasAction(this.model);this.$el[t?"addClass":"removeClass"]("inactive")}o.isHybrid()&&this.onShowInlineMenu()},"onBeforeDestroy":function(){this._nodeIconView&&this._nodeIconView.destroy(),this._inlineMenuView&&this._inlineMenuView.destroy()}});return n.CompositeView.extend({"className":"cs-simpletreelistitem binf-panel binf-panel-default","attributes":function(){return{"role":"treeitem"}},"template":p,"templateHelpers":function(){return this._baseTemplateHelpers()},"_baseTemplateHelpers":function(){return{"icon":this.options.model&&this.options.model.get("icon"),"name":this.options.model&&this.options.model.get("name"),"expandLabel":m.treeListExpandTooltip,"collapseLabel":m.treeListCollapseTooltip}},"ui":{"header":".cs-header","headerDropdownIcon":".cs-header .dropdown-icon","content":"> .cs-content","contentList":"> .cs-content > .cs-list-group"},"events":{"keydown":"onKeyInView"},"childEvents":{"click:item":"onClickItem","render":"_onChildRender","before:execute:command":"onBeforeCommandExecution"},"childViewContainer":".cs-list-group","childView":b,"childViewOptions":function(){return{"text":this.options.emptyViewDefaultText,"checkDefaultAction":this.options.checkDefaultAction,"template":this.options.childViewTemplate,"templateHelpers":this.options.childViewTemplateHelpers,"toolbarData":this.options.toolbarData,"context":this.options.context,"iconSize":this.options.iconSize,"refetchNodeActions":this.options.refetchNodeActions}},"emptyView":s,"_onChildRender":function(e){var t=e.$el;t.is("[data-csui-active]")&&t.addClass("binf-active")},"onBeforeCommandExecution":function(e){this.trigger("before:execute:command",e)},"constructor":function(t){if(t||(t={}),t.model&&t.model.childrenCollection?t.collection=t.model.childrenCollection:t.collection=new i.Collection,t.templateHelpers){var o=this,s=t.templateHelpers;t.templateHelpers=function(){return e.isFunction(s)?e.extend(o._baseTemplateHelpers(),s.call(o)):e.extend(o._baseTemplateHelpers(),s)}}n.CompositeView.call(this,t)},"onRender":function(){this.model&&!0===this.model.get("flatten")&&(this.$el.addClass("flatten-tree"),this.ui.header.addClass("binf-hidden"),this.collection.length>0&&this.ui.content.removeClass("binf-hidden"),this.$el.removeAttr("role"),this.ui.contentList.removeAttr("role")),this.ui.header.on("click",e.bind(this.onClickHeader,this)),this._setDropdownIconClass(),this.tabPosition=v.none,this.selectedIndex=-1},"onClickHeader":function(e){e.preventDefault(),e.stopPropagation(),this.ui.content.toggleClass("binf-hidden"),this._setDropdownIconClass(),this.$el.trigger("focus"),this.tabPosition=v.header,this.selectedIndex=-1,this.triggerMethod("click:tree:header",this)},"_setDropdownIconClass":function(){this.ui.content.hasClass("binf-hidden")?(this.ui.headerDropdownIcon.removeClass("icon-expandArrowUp"),this.ui.headerDropdownIcon.addClass("icon-expandArrowDown"),this.ui.headerDropdownIcon.attr("title",m.treeListExpandTooltip),this.model&&!0!==this.model.get("flatten")&&this.$el.attr("aria-expanded","false")):(this.ui.headerDropdownIcon.addClass("icon-expandArrowUp"),this.ui.headerDropdownIcon.removeClass("icon-expandArrowDown"),this.ui.headerDropdownIcon.attr("title",m.treeListCollapseTooltip),this.model&&!0!==this.model.get("flatten")&&this.$el.attr("aria-expanded","true"))},"onClickItem":function(e){e.cancelClick=!1,this.triggerMethod("click:tree:item",e),!1===e.cancelClick&&(this._setCssItemSelected(e.$el),e.$el.trigger("focus")),this.tabPosition=v.list,this.selectedIndex=e._index?e._index:-1},"_setCssItemSelected":function(e){if(e instanceof t){e.siblings("[data-csui-active]").removeClass("binf-active").removeAttr("data-csui-active"),e.addClass("binf-active").attr("data-csui-active",""),e.siblings().prop("tabindex","-1")}},"currentlyFocusedElement":function(e){var t;if(e&&!this.ui.content.hasClass("binf-hidden")&&(34===e.keyCode||35===e.keyCode||38===e.keyCode||9===e.keyCode&&e.shiftKey)){var i=this.collection.length-1;if(t=this.getElementByIndex(i))return this.tabPosition=v.list,this.selectedIndex=i,t}if(this.model&&!0===this.model.get("flatten")){if(this.collection.length>0){var n=this.selectedIndex>0?this.selectedIndex:0;if(e&&38===e.keyCode&&(n=this.collection.length-1),t=this.getElementByIndex(n))return this.tabPosition=v.list,this.selectedIndex=n,t}}else{if(!(!this.ui.content.hasClass("binf-hidden")&&this.selectedIndex>=0&&this.collection.length>0))return this.tabPosition=v.header,this.selectedIndex=-1,this.$el;var o=this.selectedIndex;if(t=this.getElementByIndex(o))return this.tabPosition=v.list,this.selectedIndex=o,t}this.tabPosition=v.none,this.selectedIndex=-1},"_moveTo":function(e,t,i){e.preventDefault(),e.stopPropagation(),this.trigger("before:keyboard:change:focus"),i&&i.prop("tabindex","-1"),t.prop("tabindex","0"),t.trigger("focus"),this.trigger("changed:focus"),this.trigger("after:keyboard:change:focus")},"onKeyInView":function(e){var t;switch(e.keyCode){case 38:this.tabPosition===v.list&&0===this.selectedIndex?this.model&&!0===this.model.get("flatten")?(this.tabPosition=v.none,this.selectedIndex=-1):(t=this.getElementByIndex(this.selectedIndex),this.tabPosition=v.header,this.selectedIndex=-1,this._moveTo(e,this.$el,t)):this.tabPosition===v.list&&this.selectedIndex>0&&(t=this.getElementByIndex(this.selectedIndex),this._moveTo(e,this._selectPrevious(),t));break;case 40:this.ui.content.hasClass("binf-hidden")||this.selectedIndex<this.collection.length-1&&(this.tabPosition=v.list,t=this.getElementByIndex(this.selectedIndex),this._moveTo(e,this._selectNext(),t));break;case 33:case 34:this.tabPosition=v.none,this.selectedIndex=-1;break;case 13:case 32:this._clickTargetByKeyboard(e);break;case 37:if(this.tabPosition!==v.header||this.ui.content.hasClass("binf-hidden")){if(this.tabPosition===v.list){var i=this.model&&this.model.get("flatten");i||(t=this.getElementByIndex(this.selectedIndex),this.tabPosition=v.header,this.selectedIndex=-1,this._moveTo(e,this.$el,t))}}else this._clickTargetByKeyboard(e);break;case 39:this.tabPosition===v.header&&(this.ui.content.hasClass("binf-hidden")?this._clickTargetByKeyboard(e):this.collection.length>0&&(this.tabPosition=v.list,this.selectedIndex=0,this._moveTo(e,this.getElementByIndex(this.selectedIndex),this.$el)))}return!0},"_clickTargetByKeyboard":function(e){e.preventDefault(),e.stopPropagation(),t(e.target).find(".cs-header").trigger("click")},"_selectNext":function(){return this.selectedIndex<this.collection.length-1&&this.selectedIndex++,this.getElementByIndex(this.selectedIndex)},"_selectPrevious":function(){return this.selectedIndex>0&&this.selectedIndex--,this.getElementByIndex(this.selectedIndex)},"getElementByIndex":function(i){if(isNaN(i)||i<0)return null;var n=e.str.sformat("div a:nth-child({0})",i+1),o=this.$(n);return t(o[0])}})}),csui.define("hbs!csui/controls/list/impl/simpletreelist",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="cs-list-group"></div>\r\n'}});return i.registerPartial("csui_controls_list_impl_simpletreelist",n),n}),csui.define("css!csui/controls/list/impl/simpletreelist",[],function(){}),csui.define("csui/controls/list/simpletreelist.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/listitem/simpletreelistitem.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/default.action/default.action.behavior","hbs!csui/controls/list/impl/simpletreelist","css!csui/controls/list/impl/simpletreelist"],function(e,t,i,n,o,s,r,l,a){return n.CollectionView.extend({"constructor":function(t){t||(t={}),this.behaviors&&e.any(this.behaviors,function(e,t){return e.behaviorClass===r})||(this.behaviors=e.extend({"PerfectScrolling":{"behaviorClass":r,"contentParent":"> .cs-content","suppressScrollX":!0,"scrollYMarginOffset":15}},this.behaviors)),n.CollectionView.call(this,t)},"ui":{},"events":{},"childEvents":{"click:item":"onClickItem","render":"_onChildRender"},"className":"cs-simpletreelist binf-panel binf-panel-default","template":a,"childViewContainer":".cs-list-group","childView":s,"childViewOptions":function(){return{"template":this.options.childViewTemplate}},"_onChildRender":function(e){var t=e.$el;t.is("[data-csui-active]")&&t.addClass("binf-active")},"onClickItem":function(e){e.cancelClick=!1,this.trigger("click:item",e),!1===e.cancelClick&&this._setCssItemSelected(e.$el)},"_setCssItemSelected":function(e){if(e instanceof t){e.siblings("[data-csui-active]").removeClass("binf-active").removeAttr("data-csui-active"),e.addClass("binf-active").attr("data-csui-active","")}}})}),csui.define("csui/controls/listitem/inline.menu.view",["module","csui/controls/listitem/impl/inline.menu/inline.menu.view","css!csui/controls/listitem/impl/inline.menu/inline.menu"],function(e,t){return t.extend({"constructor":function(e){t.prototype.constructor.apply(this,arguments)}})}),csui.define("hbs!csui/controls/listitem/impl/listitemobject",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <img class="cs-icon" src="'+e.escapeExpression((s=null!=(s=r(i,"icon")||(null!=t?r(t,"icon"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"icon","hash":{},"loc":{"start":{"line":2,"column":28},"end":{"line":2,"column":36}}}):s))+'" alt="">\r\n'},"3":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="cs-key">'+e.escapeExpression((s=null!=(s=r(i,"key")||(null!=t?r(t,"key"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"key","hash":{},"loc":{"start":{"line":7,"column":24},"end":{"line":7,"column":31}}}):s))+"</div>\r\n"},"5":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <span class="cs-size"> ('+e.escapeExpression((s=null!=(s=r(i,"size")||(null!=t?r(t,"size"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"size","hash":{},"loc":{"start":{"line":12,"column":30},"end":{"line":12,"column":38}}}):s))+")</span>\r\n"},"7":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="cs-stage">\r\n      <span class="cs-label">'+e.escapeExpression((r(i,"csui-l10n")||t&&r(t,"csui-l10n")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},null!=(s=null!=t?r(t,"stage"):t)?r(s,"label"):s,{"name":"csui-l10n","hash":{},"loc":{"start":{"line":17,"column":29},"end":{"line":17,"column":54}}}))+'</span>\r\n      <span class="cs-value">'+e.escapeExpression(e.lambda(null!=(s=null!=t?r(t,"stage"):t)?r(s,"value"):s,t))+"</span>\r\n    </div>\r\n"},"9":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="cs-price '+e.escapeExpression((s=null!=(s=r(i,"priceClass")||(null!=t?r(t,"priceClass"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"priceClass","hash":{},"loc":{"start":{"line":25,"column":25},"end":{"line":25,"column":39}}}):s))+'">'+e.escapeExpression((s=null!=(s=r(i,"price")||(null!=t?r(t,"price"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"price","hash":{},"loc":{"start":{"line":25,"column":41},"end":{"line":25,"column":50}}}):s))+'</div>\r\n    <div class="cs-currency">'+e.escapeExpression((r(i,"csui-l10n")||t&&r(t,"csui-l10n")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},null!=t?r(t,"currency"):t,{"name":"csui-l10n","hash":{},"loc":{"start":{"line":26,"column":29},"end":{"line":26,"column":51}}}))+"</div>\r\n"},"11":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="cs-date">\r\n      <div class="cs-label">'+e.escapeExpression((r(i,"csui-l10n")||t&&r(t,"csui-l10n")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},null!=(s=null!=t?r(t,"date"):t)?r(s,"label"):s,{"name":"csui-l10n","hash":{},"loc":{"start":{"line":30,"column":28},"end":{"line":30,"column":52}}}))+'</div>\r\n      <div class="cs-value '+e.escapeExpression(e.lambda(null!=(s=null!=t?r(t,"date"):t)?r(s,"class"):s,t))+'">'+e.escapeExpression(e.lambda(null!=(s=null!=t?r(t,"date"):t)?r(s,"value"):s,t))+"</div>\r\n    </div>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"icon"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":0},"end":{"line":3,"column":7}}}))?s:"")+'\r\n<div class="cs-left">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"key"):t,{"name":"if","hash":{},"fn":e.program(3,o,0),"inverse":e.noop,"loc":{"start":{"line":6,"column":2},"end":{"line":8,"column":9}}}))?s:"")+'  <div class="cs-title">\r\n    <span class="cs-name">'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":10,"column":26},"end":{"line":10,"column":34}}}):r))+"</span>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"size"):t,{"name":"if","hash":{},"fn":e.program(5,o,0),"inverse":e.noop,"loc":{"start":{"line":11,"column":4},"end":{"line":13,"column":11}}}))?s:"")+"  </div>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"stage"):t)?l(s,"value"):s,{"name":"if","hash":{},"fn":e.program(7,o,0),"inverse":e.noop,"loc":{"start":{"line":15,"column":2},"end":{"line":20,"column":9}}}))?s:"")+'</div>\r\n\r\n<div class="cs-right">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"price"):t,{"name":"if","hash":{},"fn":e.program(9,o,0),"inverse":e.noop,"loc":{"start":{"line":24,"column":2},"end":{"line":27,"column":9}}}))?s:"")+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"date"):t)?l(s,"value"):s,{"name":"if","hash":{},"fn":e.program(11,o,0),"inverse":e.noop,"loc":{"start":{"line":28,"column":2},"end":{"line":33,"column":9}}}))?s:"")+"</div>\r\n"}});return i.registerPartial("csui_controls_listitem_impl_listitemobject",n),n}),csui.define("css!csui/controls/listitem/impl/listitemobject",[],function(){}),csui.define("csui/controls/listitem/listitemobject.view",["csui/lib/underscore","csui/lib/marionette","csui/lib/numeral","csui/lib/moment","csui/lib/handlebars","csui/utils/base","hbs!csui/controls/listitem/impl/listitemobject","csui/utils/handlebars/l10n","css!csui/controls/listitem/impl/listitemobject"],function(e,t,i,n,o,s,r){return t.ItemView.extend({"constructor":function(){t.ItemView.apply(this,arguments),this.$el.on("click",e.bind(function(e){s.isControlClick(e)||(e.preventDefault(),e.stopPropagation(),this.triggerMethod("click:item"))},this))},"className":"cs-item-object list-group-item binf-clearfix","template":r,"templateHelpers":function(){return this._getObject(this.options.data||{})},"_getObject":function(t){return e.reduce(t,function(e,t,i){return"string"==typeof t?t=this._getValue(t):"object"==typeof t&&(t=void 0!==t.expression?this._getValue(t):this._getObject(t)),e[i]=t,e},{},this)},"_getValue":function(e){var t;return"string"!=typeof e&&(t=e,e=e.expression),e=this._replacePlaceholders(e),t&&(e=this._applyValueRanges(e,t),e=this._applyValueMap(e,t)),e},"_replacePlaceholders":function(t){for(var i,n,o,s=/{([^}]+)}/g;i=s.exec(t);)n=i[1].split("."),o=this.model.attributes,e.find(n,function(e){if(null==(o=o[e]))return o="",!0}),t=t.substring(0,i.index)+o+t.substring(i.index+i[0].length);return t},"_applyValueMap":function(e,t){var i=t.valueMap;return i&&null==(e=i[e])&&(e=i["*"]),e},"_applyValueRanges":function(t,n){var o=n.valueRanges;if(o){var r;r="Date"===n.type?function(e){return s.parseDate(e)}:function(e){return i(e).value()},t=r(t),e.find(o,function(e){var i=e.greaterOrEqual;if(void 0!==i&&(i=r(i))>t)return!1;var n=e.lessThan;return!(void 0!==n&&(n=r(n))<=t)&&(t=e.value,!0)})}return t}})}),csui.define("hbs!csui/controls/listitem/impl/listitemstateful",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<span class="csui-type-icon '+e.escapeExpression((s=null!=(s=r(i,"icon")||(null!=t?r(t,"icon"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"icon","hash":{},"loc":{"start":{"line":2,"column":52},"end":{"line":2,"column":60}}}):s))+'"></span>'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="SLIIcon">\r\n      '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"enableIcon"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":2,"column":6},"end":{"line":2,"column":76}}}))?s:"")+'\r\n</div>\r\n<div class="SLIRightDiv">\r\n  <div class="SLITitleDiv">\r\n    <div class="SLITitle">\r\n      <span title="'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":7,"column":19},"end":{"line":7,"column":27}}}):r))+'">'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":7,"column":29},"end":{"line":7,"column":37}}}):r))+'</span>\r\n    </div>\r\n    <div class="SLIDescription">\r\n      <span title="'+e.escapeExpression((r=null!=(r=l(i,"description")||(null!=t?l(t,"description"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"description","hash":{},"loc":{"start":{"line":10,"column":19},"end":{"line":10,"column":34}}}):r))+'">'+e.escapeExpression((r=null!=(r=l(i,"description")||(null!=t?l(t,"description"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"description","hash":{},"loc":{"start":{"line":10,"column":36},"end":{"line":10,"column":51}}}):r))+'</span>\r\n    </div>\r\n  </div>\r\n  <div class="SLIInfo SLIInfo'+e.escapeExpression((r=null!=(r=l(i,"infoState")||(null!=t?l(t,"infoState"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"infoState","hash":{},"loc":{"start":{"line":13,"column":29},"end":{"line":13,"column":42}}}):r))+'">\r\n    <span title="'+e.escapeExpression((r=null!=(r=l(i,"info")||(null!=t?l(t,"info"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"info","hash":{},"loc":{"start":{"line":14,"column":17},"end":{"line":14,"column":25}}}):r))+'">'+e.escapeExpression((r=null!=(r=l(i,"info")||(null!=t?l(t,"info"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"info","hash":{},"loc":{"start":{"line":14,"column":27},"end":{"line":14,"column":35}}}):r))+"</span>\r\n  </div>\r\n</div>\r\n"}});return i.registerPartial("csui_controls_listitem_impl_listitemstateful",n),n}),csui.define("css!csui/controls/listitem/impl/listitemstateful",[],function(){}),csui.define("csui/controls/listitem/listitemstateful.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/controls/listitem/listitemstandard.view","hbs!csui/controls/listitem/impl/listitemstateful","css!csui/controls/listitem/impl/listitemstateful"],function(e,t,i,n,o){return n.extend({"className":"SLI binf-list-group-item","template":o,"constructor":function(){n.apply(this,arguments)}})}),csui.define("hbs!csui/controls/table/cells/search/category/impl/category.item",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="csui-category-value" role="listitem" title="'+e.escapeExpression((s=null!=(s=r(i,"value")||(null!=t?r(t,"value"):t))?s:e.hooks.helperMissing,
"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"value","hash":{},"loc":{"start":{"line":1,"column":56},"end":{"line":1,"column":65}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=r(i,"value")||(null!=t?r(t,"value"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"value","hash":{},"loc":{"start":{"line":1,"column":79},"end":{"line":1,"column":88}}}):s))+'">'+e.escapeExpression((s=null!=(s=r(i,"value")||(null!=t?r(t,"value"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"value","hash":{},"loc":{"start":{"line":1,"column":90},"end":{"line":1,"column":99}}}):s))+"</div>"}});return i.registerPartial("csui_controls_table_cells_search_category_impl_category.item",n),n}),csui.define("csui/controls/table/cells/search/category/category.popover.item.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","hbs!csui/controls/table/cells/search/category/impl/category.item"],function(e,t,i,n){"use strict";return i.ItemView.extend({"className":"csui-category-item","tagName":"li","template":n,"templateHelpers":function(){return{"value":this.model&&this.model.has("value_formatted")&&this.model.get("value_formatted")}},"attributes":{"role":"none"},"events":{"keydown .csui-category-value":"accessibility"},"constructor":function(e){e||(e={}),this.options=e,i.ItemView.prototype.constructor.call(this,e)},"accessibility":function(e){var i;switch(e.preventDefault(),e.stopPropagation(),this.$el.find(".csui-category-value").prop("tabindex",-1),e.keyCode){case 38:this.$el.prev().length?this.$el.prev().find(".csui-category-value").prop("tabindex",0).trigger("focus"):(i=this.options.parentView.$el.find(".csui-category-value"),t(i[i.length-1]).prop("tabindex",0).trigger("focus"));break;case 40:this.$el.next().length?this.$el.next().find(".csui-category-value").prop("tabindex",0).trigger("focus"):(i=this.options.parentView.$el.find(".csui-category-value"),t(i[0]).prop("tabindex",0).trigger("focus"));break;case 27:var n=this.options.originatingView.popoverEl.closest(".csui-search-metadata-value");n.length?n.trigger("focus"):this.options.originatingView.$el.trigger("focus"),this.options.originatingView.closePopover()}}})}),csui.define("hbs!csui/controls/table/cells/search/category/impl/category.list",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<ul class="csui-category-list" role="list"></ul>'}});return i.registerPartial("csui_controls_table_cells_search_category_impl_category.list",n),n}),csui.define("csui/controls/table/cells/search/category/category.popover.list.view",["csui/lib/underscore","csui/lib/marionette","csui/controls/table/cells/search/category/category.popover.item.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","hbs!csui/controls/table/cells/search/category/impl/category.list"],function(e,t,i,n,o){"use strict";return t.CompositeView.extend({"className":"csui-category-collection","template":o,"childViewContainer":".csui-category-list","childView":i,"childViewOptions":function(){return{"collection":this.options.collection,"originatingView":this.options.originatingView,"parentView":this}},"behaviors":{"PerfectScrolling":{"behaviorClass":n,"contentParent":"ul.csui-category-list","suppressScrollX":!0}},"constructor":function(e){e||(e={}),this.options=e,this.collection=e.collection,this.originatingView=e.originatingView,t.CompositeView.prototype.constructor.apply(this,arguments)}})}),csui.define("hbs!csui/controls/toolbar/toolitem",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){return""},"3":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=r(i,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"hasIcon"):t,{"name":"if","hash":{},"fn":e.program(4,o,0),"inverse":e.program(27,o,0),"loc":{"start":{"line":3,"column":2},"end":{"line":49,"column":9}}}))?s:""},"4":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=r(i,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"renderIconAndText"):t,{"name":"if","hash":{},"fn":e.program(5,o,0),"inverse":e.program(12,o,0),"loc":{"start":{"line":4,"column":4},"end":{"line":39,"column":11}}}))?s:""},"5":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <a title="'+e.escapeExpression((r=null!=(r=l(i,"title")||(null!=t?l(t,"title"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":5,"column":16},"end":{"line":5,"column":25}}}):r))+'" href="#"\r\n                         '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"linkRole"):t,{"name":"if","hash":{},"fn":e.program(6,o,0),"inverse":e.noop,"loc":{"start":{"line":6,"column":25},"end":{"line":6,"column":69}}}))?s:"")+'\r\n                         class="csui-toolitem '+e.escapeExpression((r=null!=(r=l(i,"disabledClass")||(null!=t?l(t,"disabledClass"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"disabledClass","hash":{},"loc":{"start":{"line":7,"column":46},"end":{"line":7,"column":63}}}):r))+' csui-toolitem-icon-text" data-cstabindex="-1">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"iconName"):t,{"name":"if","hash":{},"fn":e.program(8,o,0),"inverse":e.program(10,o,0),"loc":{"start":{"line":8,"column":8},"end":{"line":12,"column":15}}}))?s:"")+"      </a>\r\n"},"6":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return' role="'+e.escapeExpression((s=null!=(s=r(i,"linkRole")||(null!=t?r(t,"linkRole"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"linkRole","hash":{},"loc":{"start":{"line":6,"column":48},"end":{"line":6,"column":60}}}):s))+'" '},"8":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"          "+(null!=(s=(l(i,"icon-v2")||t&&l(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"on":null!=t?l(t,"iconStateIsOn"):t,"states":"true","theme":null!=t?l(t,"iconTheme"):t,"iconName":null!=t?l(t,"iconName"):t},"loc":{"start":{"line":9,"column":10},"end":{"line":9,"column":88}}}))?s:"")+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":9,"column":88},"end":{"line":9,"column":96}}}):r))+"\r\n"},"10":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'          <span class="'+e.escapeExpression((s=null!=(s=r(i,"icon")||(null!=t?r(t,"icon"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"icon","hash":{},"loc":{"start":{"line":11,"column":23},"end":{"line":11,"column":31}}}):s))+'"></span>'+e.escapeExpression((s=null!=(s=r(i,"name")||(null!=t?r(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":11,"column":40},"end":{"line":11,"column":48}}}):s))+"\r\n"},"12":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=r(i,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"renderTextOnly"):t,{"name":"if","hash":{},"fn":e.program(13,o,0),"inverse":e.program(16,o,0),"loc":{"start":{"line":15,"column":6},"end":{"line":38,"column":13}}}))?s:""},"13":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <a  href="#"\r\n                          '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"linkRole"):t,{"name":"if","hash":{},"fn":e.program(6,o,0),"inverse":e.noop,"loc":{"start":{"line":17,"column":26},"end":{"line":17,"column":70}}}))?s:"")+'\r\n                          class="csui-toolitem '+e.escapeExpression((r=null!=(r=l(i,"disabledClass")||(null!=t?l(t,"disabledClass"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"disabledClass","hash":{},"loc":{"start":{"line":18,"column":47},"end":{"line":18,"column":64}}}):r))+' csui-toolitem-textonly"\r\n                          data-cstabindex="-1">'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":19,"column":47},"end":{"line":19,"column":55}}}):r))+"\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"menuWithMoreOptions"):t,{"name":"if","hash":{},"fn":e.program(14,o,0),"inverse":e.noop,"loc":{"start":{"line":20,"column":10},"end":{"line":22,"column":17}}}))?s:"")+"        </a>\r\n"},"14":function(e,t,i,n,o){return'            <span class="csui-button-icon csui-icon-rightArrow icon-expandArrowUp"></span>\r\n'},"16":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <a href="#" title="'+e.escapeExpression((r=null!=(r=l(i,"title")||(null!=t?l(t,"title"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":25,"column":27},"end":{"line":25,"column":36}}}):r))+'"\r\n                    '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"linkRole"):t,{"name":"if","hash":{},"fn":e.program(6,o,0),"inverse":e.noop,"loc":{"start":{"line":26,"column":20},"end":{"line":26,"column":64}}}))?s:"")+'\r\n                    class="csui-toolitem '+e.escapeExpression((r=null!=(r=l(i,"disabledClass")||(null!=t?l(t,"disabledClass"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"disabledClass","hash":{},"loc":{"start":{"line":27,"column":41},"end":{"line":27,"column":58}}}):r))+' csui-toolitem-icononly"\r\n                    data-cstabindex="-1" '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"toolItemAria"):t,{"name":"if","hash":{},"fn":e.program(17,o,0),"inverse":e.program(19,o,0),"loc":{"start":{"line":28,"column":41},"end":{"line":30,"column":57}}}))?s:"")+"\r\n          "+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"hasToolItemAriaExpand"):t,{"name":"if","hash":{},"fn":e.program(21,o,0),"inverse":e.noop,"loc":{"start":{"line":31,"column":10},"end":{"line":31,"column":85}}}))?s:"")+">\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"iconName"):t,{"name":"if","hash":{},"fn":e.program(23,o,0),"inverse":e.program(25,o,0),"loc":{"start":{"line":32,"column":10},"end":{"line":36,"column":17}}}))?s:"")+"        </a>\r\n"},"17":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'aria-label="'+e.escapeExpression((s=null!=(s=r(i,"toolItemAria")||(null!=t?r(t,"toolItemAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"toolItemAria","hash":{},"loc":{"start":{"line":29,"column":38},"end":{"line":29,"column":54}}}):s))+'" '},"19":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\r\n                           aria-label="'+e.escapeExpression((s=null!=(s=r(i,"title")||(null!=t?r(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":30,"column":39},"end":{"line":30,"column":48}}}):s))+'" '},"21":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'aria-expanded="'+e.escapeExpression((s=null!=(s=r(i,"toolItemAriaExpand")||(null!=t?r(t,"toolItemAriaExpand"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"toolItemAriaExpand","hash":{},"loc":{"start":{"line":31,"column":54},"end":{"line":31,"column":76}}}):s))+'" '},"23":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"            "+(null!=(s=(r(i,"icon-v2")||t&&r(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"on":null!=t?r(t,"iconStateIsOn"):t,"states":"true","theme":null!=t?r(t,"iconTheme"):t,"iconName":null!=t?r(t,"iconName"):t},"loc":{"start":{"line":33,"column":12},"end":{"line":33,"column":90}}}))?s:"")+"\r\n"},"25":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'            <span class="'+e.escapeExpression((s=null!=(s=r(i,"icon")||(null!=t?r(t,"icon"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"icon","hash":{},"loc":{"start":{"line":35,"column":25},"end":{"line":35,"column":33}}}):s))+'"></span>\r\n'},"27":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <a href="#"\r\n                    '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"linkRole"):t,{"name":"if","hash":{},"fn":e.program(6,o,0),"inverse":e.noop,"loc":{"start":{"line":42,"column":20},"end":{"line":42,"column":64}}}))?s:"")+'\r\n                    class="csui-toolitem '+e.escapeExpression((r=null!=(r=l(i,"disabledClass")||(null!=t?l(t,"disabledClass"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"disabledClass","hash":{},"loc":{"start":{"line":43,"column":41},"end":{"line":43,"column":58}}}):r))+' csui-toolitem-textonly"\r\n                    data-cstabindex="-1">'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":44,"column":41},"end":{"line":44,"column":49}}}):r))+"\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"menuWithMoreOptions"):t,{"name":"if","hash":{},"fn":e.program(28,o,0),"inverse":e.noop,"loc":{"start":{"line":45,"column":6},"end":{"line":47,"column":13}}}))?s:"")+"    </a>\r\n"},"28":function(e,t,i,n,o){return'        <span class="csui-button-icon csui-icon-rightArrow icon-expandArrowUp"></span>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=r(i,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"isSeparator"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.program(3,o,0),"loc":{"start":{"line":1,"column":0},"end":{"line":50,"column":7}}}))?s:""}});return i.registerPartial("csui_controls_toolbar_toolitem",n),n}),csui.define("csui/controls/toolbar/toolitem.view",["require","i18n","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/mixins/view.state/toolitems.state.mixin","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!csui/controls/toolbar/toolitem","csui/controls/icons.v2","csui/lib/binf/js/binf"],function(e,t,i,n,o,s,r,l,a,c){"use strict";var u=s.ItemView.extend({"tagName":"li","className":function(){var e=this.model.get("className")||"";return this.model.isSeparator()&&(e+=" binf-divider"),e},"attributes":function(){var e={};if(this.model.isSeparator())e["aria-hidden"]="true";else{var t=this.model.get("signature")||"";e["data-csui-command"]=t.toLowerCase(),"add"===t.toLowerCase()&&(e["data-csui-addtype"]=this.model.get("commandData").type),this.options.role?e.role=this.options.role:e.role="none"}return e},"ui":{"link":"a"},"template":a,"templateHelpers":function(){var e=this.model.get("toolItemRole"),t=e||(this.model.isSeparator()?"none":void 0);t||(t=this.options.noMenuRoles?void 0:"menuitem");var i={"renderIconAndText":!0===this.options.renderIconAndText,"renderTextOnly":!0===this.options.renderTextOnly,"isSeparator":this.model.isSeparator(),"toolItemAria":this.model.get("toolItemAria"),"hasToolItemAriaExpand":void 0!==this.model.get("toolItemAriaExpand"),"toolItemAriaExpand":this.model.get("toolItemAriaExpand"),"linkRole":t,"hasIcon":this._hasIcon(),"icon":this._icon,"iconName":this._iconName,"iconStateIsOn":this._stateIsOn,"iconTheme":this.options.useIconsForDarkBackground?"dark":""},n=this.options.command;return i.disabledClass=n&&n.get("selfBlockOnly")&&n.get("isExecuting")?"binf-disabled":"",i.title=this.model.get("title")?this.model.get("title"):this.model.get("name"),i},"events":{"click a":"_handleClick","keydown":"onKeyInView"},"constructor":function(e){this.options=e||{},s.ItemView.prototype.constructor.apply(this,arguments),this._calculateIconName(),this.listenTo(this.model,"change:stateIsOn",function(){this._calculateIconName(),this.render(),this.makeFocusable()})},"onKeyInView":function(e){i(e.target);if(32===e.keyCode||13===e.keyCode)return this._handleClick(e,!0),!1},"saveRenderState":function(){this._renderState={},n.each(u.STATE_PARAMS,function(e){this._renderState[e]=this.options[e]},this)},"restoreRenderState":function(){this._renderState&&(n.each(u.STATE_PARAMS,function(e){this.options[e]=this._renderState[e]},this),this.render(),delete this._renderState)},"onBeforeRender":function(){var e=this.$el.find("a:focus");this.itemHadFocus=1===e.length},"onRender":function(){if(this.itemHadFocus){var e=this.$el.find("a:visible");e.attr("tabindex",0),e.addClass([l.accessibilityFocusableClass,l.accessibilityActiveElementClass]),e[0].focus(),this.itemHadFocus=!1}}},{"STATE_PARAMS":["renderIconAndText","renderTextOnly"]});return n.extend(u.prototype,r),u}),csui.define("hbs!csui/controls/toolbar/impl/flyout.toolitem",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=r(i,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"renderIconAndText"):t,{"name":"if","hash":{},"fn":e.program(2,o,0),"inverse":e.program(9,o,0),"loc":{"start":{"line":2,"column":0},"end":{"line":36,"column":7}}}))?s:""},"2":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <a aria-haspopup="true" title="'+e.escapeExpression((r=null!=(r=l(i,"title")||(null!=t?l(t,"title"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":3,"column":33},"end":{"line":3,"column":42}}}):r))+'" href="#" '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"linkRole"):t,{"name":"if","hash":{},"fn":e.program(3,o,0),"inverse":e.noop,"loc":{"start":{"line":3,"column":53},"end":{"line":3,"column":96}}}))?s:"")+'\r\n                     class="csui-toolitem csui-toolitem-icon-text" data-cstabindex="-1">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"iconName"):t,{"name":"if","hash":{},"fn":e.program(5,o,0),"inverse":e.program(7,o,0),"loc":{"start":{"line":5,"column":4},"end":{"line":9,"column":11}}}))?s:"")+'     <span class="csui-caret"></span>\r\n  </a>\r\n'},"3":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'role="'+e.escapeExpression((s=null!=(s=r(i,"linkRole")||(null!=t?r(t,"linkRole"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"linkRole","hash":{},"loc":{"start":{"line":3,"column":75},"end":{"line":3,"column":87}}}):s))+'" '},"5":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"      "+(null!=(s=(l(i,"icon-v2")||t&&l(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"on":null!=t?l(t,"iconStateIsOn"):t,"states":"true","theme":null!=t?l(t,"iconTheme"):t,"iconName":null!=t?l(t,"iconName"):t},"loc":{"start":{"line":6,"column":6},"end":{"line":6,"column":84}}}))?s:"")+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":6,"column":84},"end":{"line":6,"column":92}}}):r))+"\r\n"},"7":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <span class="'+e.escapeExpression((s=null!=(s=r(i,"icon")||(null!=t?r(t,"icon"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"icon","hash":{},"loc":{"start":{"line":8,"column":19},"end":{"line":8,"column":27}}}):s))+'"></span>'+e.escapeExpression((s=null!=(s=r(i,"name")||(null!=t?r(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":8,"column":36},"end":{"line":8,"column":44}}}):s))+"\r\n"},"9":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=r(i,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"renderTextOnly"):t,{"name":"if","hash":{},"fn":e.program(10,o,0),"inverse":e.program(13,o,0),"loc":{"start":{"line":13,"column":2},"end":{"line":35,"column":9}}}))?s:""},"10":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <a aria-haspopup="true" href="#" '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"linkRole"):t,{"name":"if","hash":{},"fn":e.program(3,o,0),"inverse":e.noop,"loc":{"start":{"line":14,"column":37},"end":{"line":14,"column":80}}}))?s:"")+'\r\n                      class="csui-toolitem csui-toolitem-textonly"\r\n                      data-cstabindex="-1" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"title")||(null!=t?l(t,"title"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":16,"column":55},"end":{"line":16,"column":64}}}):r))+'">'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":16,"column":66},"end":{"line":16,"column":74}}}):r))+"\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"menuWithMoreOptions"):t,{"name":"if","hash":{},"fn":e.program(11,o,0),"inverse":e.noop,"loc":{"start":{"line":17,"column":6},"end":{"line":19,"column":13}}}))?s:"")+'      <span class="csui-caret"></span>\r\n    </a>\r\n'},"11":function(e,t,i,n,o){return'        <span class="csui-button-icon csui-icon-rightArrow icon-expandArrowUp"></span>\r\n'},"13":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <a aria-haspopup="true" href="#" title="'+e.escapeExpression((r=null!=(r=l(i,"title")||(null!=t?l(t,"title"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":23,"column":44},"end":{"line":23,"column":53}}}):r))+'" '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"linkRole"):t,{"name":"if","hash":{},"fn":e.program(3,o,0),"inverse":e.noop,"loc":{"start":{"line":23,"column":55},"end":{"line":23,"column":98}}}))?s:"")+'\r\n                       class="csui-toolitem '+e.escapeExpression((r=null!=(r=l(i,"disabledClass")||(null!=t?l(t,"disabledClass"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"disabledClass","hash":{},"loc":{"start":{"line":24,"column":44},"end":{"line":24,"column":61}}}):r))+' csui-toolitem-icononly"\r\n                       data-cstabindex="-1" '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"toolItemAria"):t,{"name":"if","hash":{},"fn":e.program(14,o,0),"inverse":e.program(16,o,0),"loc":{"start":{"line":25,"column":44},"end":{"line":27,"column":53}}}))?s:"")+"\r\n      "+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"hasToolItemAriaExpand"):t,{"name":"if","hash":{},"fn":e.program(18,o,0),"inverse":e.noop,"loc":{"start":{"line":28,"column":6},"end":{"line":28,"column":81}}}))?s:"")+">\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"iconName"):t,{"name":"if","hash":{},"fn":e.program(20,o,0),"inverse":e.program(22,o,0),"loc":{"start":{"line":29,"column":6},"end":{"line":33,"column":13}}}))?s:"")+"    </a>\r\n"},"14":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'aria-label="'+e.escapeExpression((s=null!=(s=r(i,"toolItemAria")||(null!=t?r(t,"toolItemAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"toolItemAria","hash":{},"loc":{"start":{"line":26,"column":34},"end":{"line":26,"column":50}}}):s))+'" '},"16":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\r\n                       aria-label="'+e.escapeExpression((s=null!=(s=r(i,"title")||(null!=t?r(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":27,"column":35},"end":{"line":27,"column":44}}}):s))+'" '},"18":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'aria-expanded="'+e.escapeExpression((s=null!=(s=r(i,"toolItemAriaExpand")||(null!=t?r(t,"toolItemAriaExpand"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"toolItemAriaExpand","hash":{},"loc":{"start":{"line":28,"column":50},"end":{"line":28,"column":72}}}):s))+'" '},"20":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"        "+(null!=(s=(r(i,"icon-v2")||t&&r(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"on":null!=t?r(t,"iconStateIsOn"):t,"states":"true","theme":null!=t?r(t,"iconTheme"):t,"iconName":null!=t?r(t,"iconName"):t},"loc":{"start":{"line":30,"column":8},"end":{"line":30,"column":86}}}))?s:"")+"\r\n"},"22":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <span class="'+e.escapeExpression((s=null!=(s=r(i,"icon")||(null!=t?r(t,"icon"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"icon","hash":{},"loc":{"start":{"line":32,"column":21},"end":{"line":32,"column":29}}}):s))+'"></span>\r\n'},"24":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<a  aria-haspopup="true" href="#" '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"linkRole"):t,{"name":"if","hash":{},"fn":e.program(3,o,0),"inverse":e.noop,"loc":{"start":{"line":38,"column":34},"end":{"line":38,"column":77}}}))?s:"")+'\r\n                   class="csui-toolitem '+e.escapeExpression((r=null!=(r=l(i,"disabledClass")||(null!=t?l(t,"disabledClass"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"disabledClass","hash":{},"loc":{"start":{"line":39,"column":40},"end":{"line":39,"column":57}}}):r))+' csui-toolitem-textonly"\r\n                   data-cstabindex="-1" aria-label="'+e.escapeExpression((r=null!=(r=l(i,"title")||(null!=t?l(t,"title"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":40,"column":52},"end":{"line":40,"column":61}}}):r))+'">'+e.escapeExpression((r=null!=(r=l(i,"name")||(null!=t?l(t,"name"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":40,"column":63},"end":{"line":40,"column":71}}}):r))+"\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"menuWithMoreOptions"):t,{"name":"if","hash":{},"fn":e.program(25,o,0),"inverse":e.noop,"loc":{"start":{"line":41,"column":2},"end":{"line":43,"column":9}}}))?s:"")+'   <span class="csui-caret"></span>\r\n</a>\r\n'},"25":function(e,t,i,n,o){return'    <span class="csui-button-icon csui-icon-rightArrow icon-expandArrowUp"></span>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(s=r(i,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"hasIcon"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.program(24,o,0),"loc":{"start":{"line":1,"column":0},"end":{"line":46,"column":7}}}))?s:"")+'<ul class="binf-dropdown-menu" role="menu"></ul>\r\n'}});return i.registerPartial("csui_controls_toolbar_impl_flyout.toolitem",n),n}),csui.define("csui/controls/toolbar/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/toolbar/impl/nls/root/localized.strings",{"loadingActionsMessage":"Loading actions...","failedActionsMessage":"Loading actions failed.","showMoreLabel":"show more actions"}),csui.define("csui/controls/toolbar/flyout.toolitem.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/controls/toolbar/toolitem.view","csui/utils/base","csui/controls/mixins/view.state/toolitems.state.mixin","hbs!csui/controls/toolbar/impl/flyout.toolitem","i18n!csui/controls/toolbar/impl/nls/localized.strings"],function(e,t,i,n,o,s,r,l){"use strict";var a=i.CompositeView.extend({"tagName":"li","className":"csui-flyout binf-dropdown-submenu binf-pull-down","attributes":function(){var e=this.model.get("signature")||"",t={};return this.model.isSeparator()?t["aria-hidden"]="true":(t["data-csui-command"]=e.toLowerCase(),this.options.role?t.role=this.options.role:t.role="none"),t},"onDomRefresh":function(){this.$el.parent(".csui-toolbar, .csui-table-actionbar > ul.binf-nav").length?this.$el.addClass("binf-pull-down"):this.$el.removeClass("binf-pull-down"),this.$el.hasClass("binf-open")&&this.$el.trigger("click")},"template":r,"templateHelpers":function(){var e=this.options.command;return{"name":this.model.get("name"),"renderIconAndText":!0===this.options.renderIconAndText,"renderTextOnly":!0===this.options.renderTextOnly,"expandTitle":l.showMoreLabel,"toolItemAria":this.model.get("toolItemAria"),"hasToolItemAriaExpand":void 0!==this.model.get("toolItemAriaExpand"),"toolItemAriaExpand":this.model.get("toolItemAriaExpand"),"hasIcon":this._hasIcon(),"icon":this._icon,"iconName":this._iconName,"iconStateIsOn":this._stateIsOn,"iconTheme":this.options.useIconsForDarkBackground?"dark":"","disabledClass":e&&e.get("selfBlockOnly")&&e.get("isExecuting")?"binf-disabled":"","title":this.model.get("title")?this.model.get("title"):this.model.get("name"),"linkRole":this.options.noMenuRoles?void 0:"menuitem"}},"childViewContainer":".binf-dropdown-menu","getChildView":function(e){return e.toolItems&&e.toolItems.length?a:n},"childViewOptions":function(){return{"renderTextOnly":!0}},"childEvents":{"toolitem:action":function(e,t){this.triggerMethod("toolitem:action",t),this.$el.data("binf.dropdown.submenu")&&this.$el.data("binf.dropdown.submenu").hide()}},"ui":{"link":"a.csui-toolitem"},"events":{"click @ui.link":"activeSubmenu"},"onRender":function(){this.$el.binf_dropdown_submenu(),
this.$el.off("dom:refresh").on("dom:refresh",e.bind(this.onDomRefresh,this)),this.$el.off("binf.dropdown.submenu.after.show").on("binf.dropdown.submenu.after.show",e.bind(function(e){if(this.$el.parent().hasClass("csui-toolbar")||!this.$el.hasClass("binf-pull-down")){var t=this.$el.children().last();o.alignDropDownSubMenus({"targetEl":this.$el,"dropdownMenu":t})}},this))},"constructor":function(e){this.options=e||{},this.collection=e.collection||e.model&&e.model.toolItems,this.model=this.options.model,this._calculateIconName(),i.CompositeView.prototype.constructor.apply(this,arguments),this.listenTo(this.collection,"add change reset",function(e){this.el&&this.el.offsetWidth>0&&this.el.offsetHeight>0||(this._calculateIconName(),this.render())})},"onKeyInView":function(e){t(e.target);if(13===e.keyCode)return this._handleClick(e),!1},"activeSubmenu":function(e){if(o.isAppleMobile()){var i="true"===t(e.target).attr("aria-expanded"),n=this.$el.parent("ul.binf-dropdown-menu");i?n.removeClass("csui-submenu-active"):n.addClass("csui-submenu-active")}},"saveRenderState":function(){this._renderState={},e.each(a.STATE_PARAMS,function(e){this._renderState[e]=this.options[e]},this)},"restoreRenderState":function(){this._renderState&&(e.each(a.STATE_PARAMS,function(e){this.options[e]=this._renderState[e]},this),this.render(),delete this._renderState)}},{"STATE_PARAMS":["renderIconAndText","renderTextOnly"]});return e.extend(a.prototype,s),a}),csui.define("hbs!csui/controls/toolbar/impl/toolitem.custom",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return"<div class='custom-view-region'></div>\r\n"}});return i.registerPartial("csui_controls_toolbar_impl_toolitem.custom",n),n}),csui.define("csui/controls/toolbar/toolitem.custom.view",["module","csui/lib/underscore","csui/lib/marionette","csui/utils/commandhelper","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","hbs!csui/controls/toolbar/impl/toolitem.custom","csui/utils/log","csui/lib/binf/js/binf"],function(e,t,i,n,o,s,r){"use strict";r=r(e.id);var l=i.LayoutView.extend({"tagName":"li","attributes":function(){var e={"id":t.uniqueId(this.model.get("signature"))};return this.options.role?e.role=this.options.role:e.role="none",e},"template":s,"regions":{"customViewRegion":".custom-view-region"},"ui":{"customViewDiv":".custom-view-region"},"events":{"keydown":"onKeyInView","click":"_clickToolItem"},"destroy":function(){return this.customViewRegion&&this.customViewRegion.currentView||this.customView&&this.customView.destroy(),i.LayoutView.prototype.destroy.apply(this,arguments)},"constructor":function(e){e||(e={}),i.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"className":function(){return this.model.get("className")||""},"_disable":function(){this._wasFocusable=this._wasFocusable||this.ui.customViewDiv.hasClass("csui-acc-focusable"),this.$el.addClass("binf-hidden"),this.ui.customViewDiv.removeClass("csui-acc-focusable")},"_enable":function(){this.$el.removeClass("binf-hidden"),this._wasFocusable&&this.ui.customViewDiv.addClass("csui-acc-focusable")},"onRender":function(){var e=this.model.get("viewClass");if(e){var i,o=this.model.status,s=this.model.get("commandData");i=s&&!0===s.useContainer?o&&o.container:o&&n.getJustOneNode(o);var l=this.options.context||o&&o.context,a={"model":i,"context":l,"status":o,"toolbarCommandController":this.options.toolbarCommandController,"toolbarItemsMask":this.options.toolbarItemsMask,"originatingView":this.options.originatingView,"blockingParentView":this.options.blockingParentView,"useIconsForDarkBackground":this.options.useIconsForDarkBackground};if(s&&s.viewOptions&&t.extend(a,s.viewOptions),this.customView=new e(a),this.customView.enabled)try{this.customView.enabled()?this.customViewRegion.show(this.customView):this._disable()}catch(e){r.warn("Rendering an custom toolitem view failed.\n{0}",e.message)&&console.warn(r.last)}else this.customViewRegion.show(this.customView)}else this._disable()},"onShow":function(){t.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.triggerMethod("show")})},"onAfterShow":function(){t.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.triggerMethod("after:show")})},"_clickToolItem":function(e){e.preventDefault(),this.ui.customViewDiv.prop("tabindex","0"),this.ui.customViewDiv.trigger("focus"),this._closeDropdownToggleOnClick(),this.customView.el!==e.target&&0===this.customView.$el.find(e.target).length&&this.customView.$el.trigger("click")},"_closeDropdownToggleOnClick":function(){this.$el.closest("li.binf-dropdown.binf-open").find(".binf-dropdown-toggle").binf_dropdown("toggle")},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||this._clickToolItem(e)},"onUpdateEnabled":function(){this.model.get("viewClass")&&this.customView.enabled&&(this.customView.enabled()?(this._enable(),this.customViewRegion.currentView||this.customViewRegion.show(this.customView)):this._disable())}});return t.extend(l.prototype,o),l}),csui.define("csui/controls/toolbar/toolitems.view",["csui/lib/backbone","csui/lib/marionette","csui/controls/toolbar/toolitem.view","csui/controls/toolbar/flyout.toolitem.view","csui/controls/toolbar/toolitem.custom.view"],function(e,t,i,n,o){"use strict";return t.CollectionView.extend({"tagName":"ul","attributes":function(){var e={};return this.options.role?e.role=this.options.role:this.options.noMenuRoles?e.role="none":e.role="menu",e},"getChildView":function(t){var s=t.get("customView"),r=t.get("viewClass");if(!0===s&&r&&r.prototype instanceof e.View)return o;if(s){if(!0===s)return t.get("commandData").customView||i;if(s.prototype instanceof e.View)return s}return t.get("flyout")?n:i},"childViewOptions":function(e){return{"toolbarCommandController":this.options.toolbarCommandController,"toolbarItemsMask":this.options.toolbarItemsMask,"originatingView":this.options.originatingView,"blockingParentView":this.options.blockingParentView,"noMenuRoles":this.options.noMenuRoles,"useIconsForDarkBackground":this.options.useIconsForDarkBackground}},"collectionEvents":{"remain":"_updateCustomViews"},"constructor":function(e){t.CollectionView.prototype.constructor.apply(this,arguments)},"_updateCustomViews":function(){this.children.filter(function(e){return e instanceof o}).forEach(function(e){e.triggerMethod("update:enabled")})}})}),csui.define("csui/controls/toolbar/toolitem.model",["csui/lib/underscore","csui/lib/backbone"],function(e,t){"use strict";var i=t.Model.extend({"idAttribute":null,"isSeparator":function(){return this.get("signature")==i.separator_signature}});return i.createSeparator=function(){return new i({"signature":i.separator_signature})},i.separator_signature="-",i}),csui.define("csui/controls/toolbar/toolitems.factory",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/toolbar/toolitem.model"],function(e,t,i,n,o){"use strict";var s=i.Object.extend({"constructor":function e(s,r){this.collection=new t.Collection([],{"model":o}),this.runsInTouchBrowser=r&&void 0!==r.runsInTouchBrowser?r.runsInTouchBrowser:n.isTouchBrowser(),s instanceof e?this.collection.reset(s.collection.toJSON()):this.set(s),i.Object.prototype.constructor.call(this,r)},"clone":function(){return new s(this,this.options)},"set":function(t){e.isArray(t)?e.each(t,function(e){this._setToolItemDefinition(e)},this):this._setToolItemDefinition(t)},"addItem":function(e){var t,i=e.get("group"),n=!1;e.get("onlyInTouchBrowser")&&this.runsInTouchBrowser||(this.collection.find(function(e,o){if(e.get("group")===i)n=!0;else if(n)return t=o,!0}),n&&t?this.collection.add(e,{"at":t}):this.collection.add(e))},"reset":function(e){this.collection.reset(e)},"getCollection":function(){return this.collection},"_setToolItemDefinition":function(t){var i=this.runsInTouchBrowser;if(0===this.collection.length){var n=[];e.each(t,function(t,o){n.push({"signature":"disabled","group":o}),e.each(t,function(t){t.onlyInTouchBrowser&&!i||(t.group||e.extend(t,{"group":o}),n.push(t))})}),this.collection.reset(n)}}},{"cloneToolbarItems":function(e){return Object.keys(e).filter(function(e){return"clone"!==e}).reduce(function(t,i){return t[i]=e[i].clone(),t},{})}});return s}),csui.define("csui/controls/toolbar/toolitems.filtered.model",["module","require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/controls/toolbar/toolitem.model","csui/controls/toolbar/toolitems.factory","csui/utils/commands","csui/utils/log"],function(e,t,i,n,o,s,r,l,a){"use strict";function c(e,t,i){try{return t.enabled&&!t.enabled(i,{"data":e.get("commandData")})}catch(e){return a.warn('Evaluating the command "{0}" failed.\n{1}',t.get("signature"),e.message)&&console.warn(a.last),!0}}return a=a(e.id),o.Collection.extend({"constructor":function(e,t){if(i.isArray(e))this.unfilteredModels=e;else if(e instanceof r){var n=e.getCollection();this.unfilteredModels=n.models,this.listenTo(n,"add",this.refilter,this).listenTo(n,"remove",this.refilter,this).listenTo(n,"reset",function(){this.unfilteredModels=n.models,this.refilter()},this)}else e instanceof o.Collection&&e.model instanceof s&&(this.unfilteredModels=e.models);t||(t={}),this.commands=t.commands||l,this.addTrailingDivider=e.options?e.options.addTrailingDivider:t.addTrailingDivider,this.addGroupSeparators=e.options?!1!==e.options.addGroupSeparators:!1!==t.addGroupSeparators,this.suppressGroupSeparators=e.options?e.options.suppressGroupSeparators:t.suppressGroupSeparators,this.setStatus(t.status),this.delayedActions=t.delayedActions,this.mask=t.mask,this._filtering=0,o.Collection.prototype.constructor.call(this,this.unfilteredModels,t),this.delayedActions&&this.listenTo(this.delayedActions,"sync",this.refilter).listenTo(this.delayedActions,"error",this.refilter),this.mask&&this.listenTo(this.mask,"update",this.refilter)},"sort":function(e){e||(e={});var t=this.models,i=function(e,i){var n=!!t[e].get("csuiNonPromotedItem"),o=!!t[i].get("csuiNonPromotedItem");return!n&&o?-1:n&&!o?1:e-i};return this.models=t.map(function(e,t){return t}).sort(i).map(function(e){return t[e]}),e.silent||this.trigger("sort",this,e),this},"destroy":function(){this.stopListening()},"refilter":function(){function e(){var e=this.filterModels(this.unfilteredModels),t=this.length!==e.length||this._forceResetOnNextRefilter;if(t||(t=this.some(function(t,n){var o=e[n];return!i.isEqual(t.attributes,o.attributes)||!i.isEqual(t.toolItems,o.toolItems)})),t){var n=this.silentFetch&&!this._forceResetOnNextRefilter?{"silent":!0}:void 0;this.reset(e,n),delete this._forceResetOnNextRefilter}else this.trigger("remain",this);this.silentFetch=!1,--this._filtering}if(!1!==this._isActive&&!this._filtering){++this._filtering;var t=this._resolveCustomViews();t?t.always(e.bind(this)):e.call(this)}},"set":function(e,t){return this._filtering||(e=this.filterModels(e)),o.Collection.prototype.set.call(this,e,t)},"setStatus":function(e){if(e){if(this.status&&(this.status.nodes&&(this.status.nodes.remove(this.status.container),this.stopListening(this.status.nodes)),this.status.container&&this.stopListening(this.status.container)),this.status=e,e.nodes){var t=["change","reset"];t=i.union(t,e.listenEvents);var n=t.join(" ");this.listenTo(e.nodes,n,this.refilter)}e.container&&this.listenTo(e.container,"change",this.refilter)}},"updateStatus":function(e){this.status=i.extend({},this.status,e)},"setActive":function(e){!1===this._isActive&&this._isActive!==e&&(this._forceResetOnNextRefilter=!0),this._isActive=e},"filterModels":function(e){function t(e){var t,n=i.reject(e,function(e){if(e.isSeparator()){if(t)return!0;t=!0}else t=!1},this);return n.length&&n[n.length-1].isSeparator()&&n.pop(),n}++this._filtering;var n=this._filterToolItems(e);return n=i.reject(n,function(e){if(e.toolItems){var i=this._makeSubItems(e.toolItems);if(!i.length)return this._checkCommandEnableOrDisable(e);i=t.call(this,i),e.toolItems.set(i,{"silent":!0})}},this),n=t.call(this,n),--this._filtering,n},"_checkCommandEnableOrDisable":function(e){var t=e.get("signature"),n=t&&this.commands.get(t);if(n){var o=i.extend({},this.status.data,e.get("commandData"));return c(e,n,i.defaults({"toolItem":e,"data":o},this.status))}return!0},"_makeSubItems":function(e){function t(e){return i.reject(e,function(e){if(!e.toolItems||e.toolItems&&0===e.toolItems.length){if(!e.isSeparator())return this._checkCommandEnableOrDisable(e)}else{var i=t.call(this,e.toolItems.models);if(i.length&&i[0].isSeparator()&&i.shift(),i.length&&i[i.length-1].isSeparator()&&i.pop(),!i.length)return!0;e.toolItems.set(i,{"silent":!0})}},this)}var n=i.reject(e.models,function(t){if(t.get("subItemOf")){var i=e.find({"signature":t.get("subItemOf")});if(void 0!==i)return i.toolItems.push(t),!0}},this);return t.call(this,n)},"_filterToolItems":function(e){var t=new o.Collection(void 0,{"model":s});return i.each(e,function(e){if(!this.mask||this.mask.passItem(e)){e=e.clone();var n=e.get("flyout"),r=t;if(n){var l=t.findWhere({"flyout":n});l&&(r=l.toolItems),e.toolItems=new o.Collection(void 0,{"model":s})}var a=this.commands.get(e.get("signature")),u=e.get("enabled");if(a){var d=i.extend({},this.status.data,e.get("commandData")),h=i.defaults({"toolItem":e,"data":d},this.status);if(a.isNonPromoted&&a.isNonPromoted(h)&&e.set("csuiNonPromotedItem",!0),c(e,a,h)&&!u)e=null;else if(n){var p=e.get("actions");p&&(p=new o.Collection(p,{"model":s}),p=this._filterToolItems(p.models),e.toolItems.reset(p))}}else e.toolItems||u||(e=null);if(e){var f=e.get("group"),m=e.get("subItemOf"),g=r.findLastIndex(function(e){return e.get("group")===f});if(g<0){if(r.length>0&&this.addGroupSeparators&&!this.suppressGroupSeparators){var v=s.createSeparator();!!m&&v.set({"subItemOf":m,"silent":!0}),r.push(v)}r.push(e)}else r.add(e,{"at":g+1});e.status=this.status}}},this),t.models},"_resolveCustomViews":function(){var e=this.unfilteredModels.filter(function(e){return"string"==typeof e.get("customView")});if(e.length){var i=e.map(function(e){return e.get("customView")}),o=n.Deferred();return t(i,function(){for(var t=0,n=i.length;t<n;++t)e[t].set("customView",arguments[t]);o.resolve()},function(t){for(var n=0,s=i.length;n<s;++n)e[n].set("customView",t);o.reject(t)}),o.promise()}}})}),csui.define("hbs!csui/controls/toolbar/impl/lazy.loading.template",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<li role="none" class="csui-loading-parent-wrapper binf-disabled">\r\n  <span class="csui-loading-dots-wrapper">\r\n    <span class="csui-loading-dot"></span>\r\n    <span class="csui-loading-dot"></span>\r\n    <span class="csui-loading-dot"></span>\r\n  </span>\r\n</li>'}});return i.registerPartial("csui_controls_toolbar_impl_lazy.loading.template",n),n}),csui.define("csui/utils/high.contrast/detector",[],function(){"use strict";function e(){var e=document.createElement("div"),i=e.style;i.backgroundColor="rgb(127, 127, 127)",i.borderWidth="1px",i.borderStyle="solid",i.borderTopColor="#ff0000",i.borderRightColor="#00ffff",i.position="absolute",i.left="-9999px",i.width=e.style.height="2px";var n=document.body;n.appendChild(e),i=window.getComputedStyle(e);var o=i.backgroundColor;t="rgb(127, 127, 127)"===o?0:"rgb(255, 255, 255)"===o?2:1,n.removeChild(e);var s=t?"add":"remove",r="csui-highcontrast-light-on-dark";2===t&&(r="csui-highcontrast-dark-on-light"),document.documentElement.classList[s]("csui-highcontrast"),document.documentElement.classList[s](r)}var t;return{"load":function(i,n,o,s){function r(){if("complete"===document.readyState)return void 0===t&&e(),o(t),!0}s.isBuild?o(null):r()||document.addEventListener("readystatechange",r)}}}),csui.define("css!csui/controls/toolbar/impl/toolbar",[],function(){}),csui.define("csui/controls/toolbar/toolbar.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/toolbar/toolitem.view","csui/controls/toolbar/flyout.toolitem.view","csui/controls/toolbar/toolitem.custom.view","csui/controls/toolbar/toolitems.view","csui/models/nodes","csui/controls/toolbar/toolitems.filtered.model","hbs!csui/controls/toolbar/impl/lazy.loading.template","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/utils/base","csui/utils/high.contrast/detector!","csui/controls/globalmessage/globalmessage","csui/controls/icons.v2","css!csui/controls/toolbar/impl/toolbar"],function(e,t,i,n,o,s,r,l,a,c,u,d,h,p,f,m){"use strict";return l.extend({"parentScrollElement":".csui-metadata-myattachments","className":function(){var e="csui-align-left";return this.options.hAlign&&("right"===this.options.hAlign?e="csui-align-right":"none"===this.options.hAlign&&(e="")),"csui-toolbar binf-nav binf-nav-pills "+e},"events":{"keydown":"onKeyInView"},"childViewOptions":function(t){return e.extend(l.prototype.childViewOptions.call(this,t),{"collection":t.toolItems,"command":this.collection.commands&&this.collection.commands.findWhere({"signature":t.get("signature")}),"useIconsForDarkBackground":this._useIconsForDarkBackground})},"constructor":function i(n){n||(n={}),this.parentScrollElement=n.parentScrollElement||this.parentScrollElement,i.__super__.constructor.apply(this,arguments),n.el&&t(n.el).addClass(e.result(this,"className")),this._useIconsForDarkBackground=n.useIconsForDarkBackground&&2!==p||1===p,this.listenTo(this,"dom:refresh",this._onDomRefresh).listenTo(this,"before:execute:command",this._setBlocked).listenTo(this,"after:execute:command",this._setUnblocked),n.keyboardNavigationEnabled&&(this._keyboardNavigationEnabled=!0,this.listenTo(this.collection,"remove",function(){this._accFocusedToolbarItemIndex>this.collection.length-1&&(this._accFocusedToolbarItemIndex=this.collection.length-1)}),this.listenTo(this.collection,"reset",function(){this._accFocusedToolbarItemIndex=this.collection.length>0?0:-1}),this._accFocusedToolbarItemIndex=this.collection.length>0?0:-1),this.fetchingNonPromotedActions=!1,t(window).on("resize."+this.cid,this._handleWindowResize.bind(this))},"filter":function(e){return e},"_onDomRefresh":function(){this._adjusting||this._adjustToFit()},"onBeforeRender":function(){this._unwrapDropDown()},"onRender":function(){this._toolbarBlocked&&!this._isSingleCommandBlocked&&this.$el.addClass("binf-disabled")},"onDestroy":function(){t(window).off("resize."+this.cid)},"_getFocusedElementByIndex":function(e){var t=e+1;return this.$el.find(">li:nth-child("+t+")>a.csui-acc-focusable")},"getVisibleToolitemsCount":function(){return this.$el.find(">li>a.csui-acc-focusable").length},"currentlyFocusedElement":function(){return this._keyboardNavigationEnabled&&this._accFocusedToolbarItemIndex>=0?this._getFocusedElementByIndex(this._accFocusedToolbarItemIndex):t()},"setFocusByIndex":function(e){this._getFocusedElementByIndex(e).trigger("focus")},"letRightmostItemGetFocus":function(){this._accFocusedToolbarItemIndex=this.collection.length-1},"closeDropdown":function(){this.children.call("closeDropdown")},"onKeyInView":function(e){if(this._keyboardNavigationEnabled&&0!==this.collection.length)switch(e.keyCode){case 37:e.stopPropagation(),this._accFocusedToolbarItemIndex>0?(this._accFocusedToolbarItemIndex=this._accFocusedToolbarItemIndex-1,this.triggerMethod("changed:focus")):(this._accFocusedToolbarItemIndex=0,this.triggerMethod("focusout",{"direction":"left"}));break;case 39:e.stopPropagation(),this._accFocusedToolbarItemIndex<this.collection.length-1?(this._accFocusedToolbarItemIndex=this._accFocusedToolbarItemIndex+1,this.triggerMethod("changed:focus")):(this._accFocusedToolbarItemIndex=this.collection.length-1,this.triggerMethod("focusout",{"direction":"right"}))}},"_handleWindowResize":function(){if(this._handleWindowResizeTimeout&&clearTimeout(this._handleWindowResizeTimeout),!this.isDestroyed){var e=this;this._handleWindowResizeTimeout=setTimeout(function(){e._handleWindowResizeTimeout=void 0;var t=void 0===e.options.originatingView||e.options.originatingView.isDisplayed;!e.isDestroyed&&t&&e.render()},100),this._adjustToFit()}},"_setBlocked":function(e){var t=this,i=e.command,n=e.status&&e.status.toolItemView,o=i&&i.get("selfBlockOnly")&&n?n.$el.find("a"):this.$el;i.get("allowMultipleInstances")||(this._blockedTimer=setTimeout(function(){!1===t._toolbarBlocked&&o.removeClass("binf-disabled"),t._blockedTimer=void 0},500),this._toolbarBlocked=!0,this._isSingleCommandBlocked=!o.is(this.$el),o.addClass("binf-disabled"))},"_setUnblocked":function(e){this._toolbarBlocked=!1;var t=e.command,i=e.status&&e.status.toolItemView,n=t&&t.get("selfBlockOnly")&&i?i.$el.find("a"):this.$el;if(!this._blockedTimer&&(n.removeClass("binf-disabled"),e&&e.cancelled)){var o=this.$el.find("[data-csui-command="+e.commandSignature.toLowerCase()+"] a"),s=o.length?o.closest("ul.csui-more-dropdown-menu"):{};s.length?s.siblings("a.binf-dropdown-toggle").trigger("focus"):o.trigger("focus")}},"_adjustToFit":function(){if(!1!==this._isActive){this.trigger("before:adjust");var t=e.filter(this.children.toArray(),function(e){return e instanceof o||e instanceof s});t=e.sortBy(t,"cid"),e.isUndefined(this.options.maxItemsShown)?this._makeItemsFocusable(t):(this._unwrapDropDown(),this._adjusting=!0,this.el.classList.add("csui-measuring"),this.children.length>0&&(this._doAdjustToFit(t),this.options.lazyActions&&this._loadLazyActions()),this.el.classList.remove("csui-measuring"),this._adjusting=!1),this.trigger("after:adjust")}},"_makeItemsFocusable":function(t){e.each(t,function(e,t){e.makeFocusable()},this)},"_doAdjustToFit":function(t){var i=Math.round(this.$el.offset().top),n=Math.round(this.el.getBoundingClientRect()?this.el.getBoundingClientRect().width:this.$el.width()),o=this.$el.parents(".csui-table-rowselection-toolbar-view")?this.$el.parents(".csui-table-rowselection-toolbar-view").find(".csui-condensed-header-toggle-container").width():0;n=h.isIE11()?n-o:n,this.options.toolbarItemViewOptions={"toolItemCounter":0,"pEl":void 0,"pIsSeparator":void 0,"ppEl":void 0,"dropDownMenuEl":void 0,"currentRight":0,"rightMost":n,"firstOffsetY":i,"index":0,"separatorView":void 0},t.length>1||0===this.options.maxItemsShown?e.each(t,function(e,t){this.options.toolbarItemViewOptions.index=t,this._wrapToolItemView(e)},this):this._makeItemsFocusable(t)},"_loadLazyActions":function(){var t,n=!0,o=!0,s=[];if(t=this.collection.status.nodes instanceof a?this.collection.status.nodes:this.collection.status.nodes instanceof i.Collection?new a(this.collection.status.nodes.models):e.isArray(this.collection.status.nodes)?new a(this.collection.status.nodes):new a,t.connector||(t.connector=this.collection.status.collection.connector),t.each(function(e){n=n&&e.get("csuiLazyActionsRetrieved"),o=o&&e.isLocallyCreated,s=s.length?s:e.nonPromotedActionCommands}),t.nonPromotedActionCommands=s,t.lazyActionsRetrieved=n,!n&&!o&&s.length&&(this.fetchingNonPromotedActions||this._renderLazyActions(t),!this.$el.find(".csui-loading-parent-wrapper").length&&this.fetchingNonPromotedActions)){if(this.$el.find(".csui-more-dropdown-menu").length)this.$el.find(".binf-dropdown.csui-more-dropdown-wrapper").addClass("csui-toolbar-hide-child");else if(this.options.toolbarItemViewOptions){var r=this.options.toolbarItemViewOptions.currentRight+10+46;(this.options.toolbarItemViewOptions.toolItemCounter===this.options.maxItemsShown||r>this.options.toolbarItemViewOptions.rightMost)&&this.$el.find("li:last").addClass("csui-toolbar-hide-child")}this.$el.append(u)}},"_wrapToolItemView":function(t){var i=t.model.isSeparator();if(i||this.options.toolbarItemViewOptions.toolItemCounter++,this.options.toolbarItemViewOptions.dropDownMenuEl)i&&this.options.toolbarItemViewOptions.index+1===this.children.length||(t.$el.attr("role","none"),t.$el.find(".csui-flyout-arrow .csui-button-icon.icon-expandArrowDown").addClass("binf-hidden"),t.$el.find(".csui-toolitem.csui-flyout-arrow").removeClass("csui-flyout-arrow"),e.isFunction(t.renderTextOnly)&&t.renderTextOnly(!0),this.options.toolbarItemViewOptions.dropDownMenuEl.append(t.$el),t.triggerMethod("dom:refresh"),this.usePerfectScrollbar()&&this.options.toolbarItemViewOptions.dropDownMenuEl.perfectScrollbar("update"));else{if(i)this.options.toolbarItemViewOptions.separatorView=t;else{var n=Math.round(h.getOffset(t.$el).top),o=Math.round(t.$el[0].getBoundingClientRect()?t.$el[0].getBoundingClientRect().width:t.$el.width());this.options.toolbarItemViewOptions.currentRight=this.options.toolbarItemViewOptions.currentRight+parseInt(o,10),n!==this.options.toolbarItemViewOptions.firstOffsetY||this.options.toolbarItemViewOptions.currentRight>this.options.toolbarItemViewOptions.rightMost||this.options.toolbarItemViewOptions.toolItemCounter>this.options.maxItemsShown?this.options.toolbarItemViewOptions.pIsSeparator?this.options.toolbarItemViewOptions.ppEl&&(this.options.toolbarItemViewOptions.ppEl.$el.attr("role","none"),this.options.toolbarItemViewOptions.dropDownMenuEl=this._wrapWithDropDown(this.options.toolbarItemViewOptions.ppEl,t),this.options.toolbarItemViewOptions.dropDownMenuEl.children().first().after(this.options.toolbarItemViewOptions.pEl.$el)):this.options.toolbarItemViewOptions.pEl?(this.options.toolbarItemViewOptions.pEl.$el.attr("role","none"),this.options.toolbarItemViewOptions.dropDownMenuEl=this._wrapWithDropDown(this.options.toolbarItemViewOptions.pEl,t)):this.options.toolbarItemViewOptions.dropDownMenuEl=this._wrapWithDropDown(t,t):t.makeFocusable()}this.options.toolbarItemViewOptions.ppEl=this.options.toolbarItemViewOptions.pEl,this.options.toolbarItemViewOptions.pEl=t,this.options.toolbarItemViewOptions.pIsSeparator=i}},"_wrapWithDropDown":function(i,n){e.isFunction(i.renderTextOnly)&&i.renderTextOnly(!0);var o=i.$el;o.wrap('<li role="none" class="binf-dropdown csui-wrapper csui-more-dropdown-wrapper"><ul class="binf-dropdown-menu csui-more-dropdown-menu" role="menu"></ul></li>');var s=this._makeDropDown(),r=this.$("li.csui-wrapper");r.prepend(s);var l=r.find("> ul.binf-dropdown-menu");o.find(".csui-flyout-arrow .csui-button-icon.icon-expandArrowDown").addClass("binf-hidden"),o.find(".csui-toolitem.csui-flyout-arrow.csui-acc-focusable").removeClass("csui-flyout-arrow"),e.isFunction(n.renderTextOnly)&&n.renderTextOnly(!0),n.$el.find(".csui-flyout-arrow .csui-button-icon.icon-expandArrowDown").addClass("binf-hidden"),n.$el.find(".csui-toolitem.csui-flyout-arrow").removeClass("csui-flyout-arrow"),l.append(n.$el),n.triggerMethod("dom:refresh"),o.trigger("dom:refresh");var a=this;return this.$el.off("show.binf.dropdown."+this.cid).on("show.binf.dropdown."+this.cid,e.bind(function(){var e=l.closest(a.parentScrollElement);if(e&&e.length>0){var t=e.height(),i=parseInt(e.css("margin-top"))+parseInt(e.css("margin-bottom"));if(l.height()+i>t){var n=t-i;l.css({"overflow":"hidden","padding":"0","max-height":n+"px"}),setTimeout(function(){l.perfectScrollbar({"suppressScrollX":!0}),l.perfectScrollbar("update")},1)}}},a)),this.$el.off("binf.dropdown.after.show."+this.cid).on("binf.dropdown.after.show."+this.cid,function(e){a.usePerfectScrollbar()?(l.addClass("csui-perfect-scrolling"),l.perfectScrollbar({"suppressScrollX":!0,"includePadding":!0})):l.addClass("csui-normal-scrolling csui-no-scroll-x"),h.alignDropDownMenu({"targetEl":t(e.target)}),a.trigger("toolbar.show"),h.isAppleMobile()&&l.hasClass("csui-submenu-active")&&l.removeClass("csui-submenu-active")}),l},"_unwrapDropDown":function(){var i=this.$("li.csui-wrapper"),n=i.find("> ul.binf-dropdown-menu"),o=this.$el.find(".csui-loading-parent-wrapper");if(o&&o.remove(),n.length>0){n.children("li").each(function(e,n){i.before(n),t(n).trigger("dom:refresh")}),i.remove()}var s=this.$el.find(".csui-flyout.binf-dropdown");s.length&&e.each(s,function(e){t(e).find("ul li").length>=1&&(t(e).find("> .csui-toolitem").addClass("csui-flyout-arrow"),t(e).find(".csui-flyout-arrow .csui-button-icon.icon-expandArrowDown").removeClass("binf-hidden"))}),this.children.forEach(function(t){e.isFunction(t.restoreRenderState)&&t.restoreRenderState()})},"_makeDropDown":function(){var e='<a href="#" role='+(this.options.noMenuRoles?'"button"':'"menuitem"')+' class="binf-dropdown-toggle csui-acc-focusable " data-binf-toggle="dropdown" aria-expanded="false" aria-haspopup="true"';return this.options.dropDownText?e+=' title="'+this.options.dropDownText+'" aria-label="'+this.options.dropDownText+'">':e+=">",this.options.dropDownIconName?e+=m.getIconByNameWithOptions({"iconName":this.options.dropDownIconName,"theme":this._useIconsForDarkBackground?"dark":"","states":!0}):this.options.dropDownIcon?e+='<span class="'+this.options.dropDownIcon+'"></span>':this.options.dropDownText&&(e+=this.options.dropDownText),e+="</a>"},"appendLazyActions":function(){var t=this,i=e.sortBy(t.children.toArray(),"cid"),n=0,r=e.filter(t.collection.models,function(e){return e});e.each(r,function(e){var r=i[n],l=e.get("name");if(r&&r.model.get("name")===l)e.get("flyout")&&e.toolItems.length!==r.model.toolItems.length&&r.collection.reset(e.toolItems.models),n++;else if(t.options.toolbarItemViewOptions){t.options.toolbarItemViewOptions.index++;var a=e.get("flyout")?s:o,c=t.addChild(e,a,t.options.toolbarItemViewOptions.index);t._wrapToolItemView(c),r&&t.removeChildView(r),n++}})},"startLazyLoading":function(){this.options.toolbarItemViewOptions.dropDownMenuEl.append(u)},"stopLazyLoading":function(){this.$el.find(".csui-loading-parent-wrapper").remove()},"_renderLazyActions":function(t){if(!t.lazyActionsRetrieved){var i=this;this.fetchingNonPromotedActions=!0,t.setEnabledLazyActionCommands(!0).done(e.bind(function(){i.fetchingNonPromotedActions=!1;var e=i.$el.find(".csui-loading-parent-wrapper");e.animate("width: 0",300,function(){e.remove(),i.$el.find(".csui-toolbar-hide-child").removeClass("csui-toolbar-hide-child"),i.collection.silentFetch=!0,i.collection.refilter(),i.appendLazyActions(),i.triggerMethod("dom:refresh"),i.trigger("render:lazy:actions")})}),this).fail(function(e){i.fetchingNonPromotedActions=!1;var t=i.$el.find(".csui-loading-parent-wrapper"),n=new h.Error(e);t.length&&t.remove(),f.showMessage("error",n.message)})}},"usePerfectScrollbar":function(){return d.usePerfectScrollbar()},"setActive":function(e){this._isActive=e}})}),csui.define("csui/controls/toolbar/toolbar.command.controller",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/commandhelper","csui/utils/commands"],function(e,t,i,n,o,s){"use strict";function r(e){e||(e={}),this.commands=e.commands||s,this.nameAttribute=e.nameAttribute}return n=n(e.id),t.extend(r.prototype,i.Events,{"toolitemClicked":function(e,s){var r=e.get("signature"),l=this.commands.get(r),a=e.get("name"),c=e.get("type"),u=t.extend({},s.data,e.get("commandData"));s=t.defaults({"toolItem":e,"data":u},s);var d={"status":s,"commandSignature":r,"addableType":c,"addableTypeName":a,"command":l};if(!1===e.get("execute")||!l.execute)return d.execute=!1,d.toolItem=e,this.trigger("before:execute:command",d),this.trigger("click:toolitem:action",d),this.trigger("after:execute:command",d);this.trigger("before:execute:command",d),i.trigger("closeToggleAction");var h=this;h.commandSignature=r;var p,f={"context":s.context,"addableType":c,"addableTypeName":a,"nameAttribute":h.nameAttribute};try{if(!l)throw new Error('Command "'+r+'" not found.');p=l.execute(s,f)}catch(e){return n.warn('Executing the command "{0}" failed.\n{1}',l.get("signature"),e.message)&&console.warn(n.last),d.error=e,this.trigger("after:execute:command",d)}return p?o.handleExecutionResults(p,{"command":l,"suppressSuccessMessage":s.forwardToTable||s.suppressSuccessMessage,"suppressFailMessage":s.suppressFailMessage}).done(function(e){e&&!e[0].cancelled&&(d.newNodes=e,h.trigger("after:execute:command",d))}).fail(function(e){void 0===e&&(e={"cancelled":!0,"command":l,"status":s,"commandSignature":h.commandSignature}),h.trigger("after:execute:command",e)}):this.trigger("after:execute:command",d)}}),
r.extend=i.View.extend,r}),csui.define("csui/controls/toolbar/toolitems.mask",["csui/lib/underscore","csui/lib/backbone"],function(e,t){"use strict";function i(e,t){t||(t={}),!1!==t.normalize&&(e=this._normalizeMask(e)),this.blacklist=e.blacklist,this.whitelist=e.whitelist,this.storeMask()}return e.extend(i.prototype,t.Events,{"toJSON":function(){return{"blacklist":e.clone(this.blacklist),"whitelist":e.clone(this.whitelist)}},"clone":function(){return new this.constructor(this)},"clearMask":function(e){var t=this.blacklist.length||this.whitelist.length;return this.blacklist.splice(0),this.whitelist.splice(0),!t||e&&e.silent||this.trigger("update",this),t},"extendMask":function(e,t){t||(t={}),!1!==t.normalize&&(e=this._normalizeMask(e));var i=this._extendList(this.blacklist,e.blacklist);return i=this._extendList(this.whitelist,e.whitelist)||i,i&&!t.silent&&this.trigger("update",this),i},"resetMask":function(e,t){t||(t={}),!1!==t.normalize&&(e=this._normalizeMask(e));var i=this._replaceList(this.blacklist,e.blacklist);return i=this._replaceList(this.whitelist,e.whitelist)||i,i&&!t.silent&&this.trigger("update",this),i},"storeMask":function(){this.originalBlacklist=e.clone(this.blacklist),this.originalWhitelist=e.clone(this.whitelist)},"restoreMask":function(e){return e||(e={}),this.resetMask({"blacklist":this.originalBlacklist,"whitelist":this.originalWhitelist},{"silent":e.silent,"normalize":!1})},"restoreAndResetMask":function(e,t){t||(t={}),!1!==t.normalize&&(e=this._normalizeMask(e));var i=this.restoreMask({"silent":!0});return i=this.extendMask(e,{"silent":!0,"normalize":!1})||i,i&&!t.silent&&this.trigger("update",this),i},"maskItems":function(i){return i instanceof t.Collection&&(i=i.models),e.filter(i,this.passItem,this)},"passItem":function(e){return e instanceof t.Model&&(e=e.attributes),!this._containsRule(e,this.blacklist)&&(!this.whitelist.length||this._containsRule(e,this.whitelist))},"_containsRule":function(t,i){return e.any(i,e.bind(this._matchesRule,this,t))},"_matchesRule":function(t,i){if(t.signature!=i.signature)return!1;var n=t.commandData||{};return e.all(i.commandData,function(e,t){return e==n[t]})},"_extendList":function(t,i){return e.reduce(i,function(i,n){return e.any(t,function(t){return e.isEqual(n,t)})||(t.push(n),i=!0),i},!1)},"_reduceList":function(t,i){var n=e.chain(t).map(function(t,n){return!e.any(i,function(i){return e.isEqual(t,i)})&&n+1}).compact().value();return e.each(n,function(e,i){t.splice(e-i-1,1)}),!!n.length},"_replaceList":function(e,t){var i=this._reduceList(e,t);return this._extendList(e,t)||i},"_normalizeMask":function(e){return e||(e={}),{"blacklist":this._normalizeList(e.blacklist),"whitelist":this._normalizeList(e.whitelist)}},"_normalizeList":function(t){return t?e.map(t,this._normalizeRule,this):[]},"_normalizeRule":function(t){return e.isObject(t)?t:{"signature":t}}}),i.extend=t.Model.extend,i}),csui.define("hbs!csui/controls/toolbar/impl/toolbar.state",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<p>"+e.escapeExpression((s=null!=(s=r(i,"message")||(null!=t?r(t,"message"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"message","hash":{},"loc":{"start":{"line":1,"column":3},"end":{"line":1,"column":14}}}):s))+"</p>\r\n"}});return i.registerPartial("csui_controls_toolbar_impl_toolbar.state",n),n}),csui.define("csui/controls/toolbar/toolbar.state.view",["csui/lib/underscore","csui/lib/marionette","hbs!csui/controls/toolbar/impl/toolbar.state","i18n!csui/controls/toolbar/impl/nls/localized.strings"],function(e,t,i,n){"use strict";return t.ItemView.extend({"tagName":"li","className":"csui-toolbar-state","template":i,"constructor":function(){t.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change",function(){this.isDestroyed||this.render()}),this.statusMessages={"loading":n.loadingActionsMessage,"failed":n.failedActionsMessage}},"serializeData":function(){var t=this.model.get("showMessage")?this.statusMessages[this.model.get("state")]:void 0;return e.extend(this.model.toJSON(),{"message":t})}})}),csui.define("csui/controls/toolbar/toolbar.state.behavior",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/toolbar/toolbar.state.view"],function(e,t,i,n){"use strict";return i.Behavior.extend({"constructor":function(o,s){i.Behavior.prototype.constructor.apply(this,arguments),this.view=s;var r=s.collection||s.options.collection,l=this.getOption("delayedActions");!e.isFunction(l)||l instanceof t.Collection||(l=l.call(s)),!l&&r&&(l=r.delayedActions),l&&this.listenTo(l,"request",this._fetchingActionsStarted).listenTo(l,"sync",this._fetchingActionsSucceeded).listenTo(l,"error",this._fetchingActionsFailed),this.listenTo(r,"reset change",this._fetchingActionsSucceeded),s.actionState=new t.Model({"state":l&&(l.fetching?"loading":l.error?"failed":r.length?"full":"empty"),"showMessage":!0}),s.emptyView=n,s.emptyViewOptions={"model":s.actionState,"toolbarView":s},this.listenTo(s,"render",this._updateClasses)},"_fetchingActionsStarted":function(){this.view.actionState.set("state","loading"),this._updateClasses()},"_fetchingActionsSucceeded":function(e){this.view.actionState.set("state",e.length?"":"emptyfull"),this._updateClasses()},"_fetchingActionsFailed":function(){this.view.actionState.set("state","failed"),this._updateClasses()},"_updateClasses":function(){this.view.$el.removeClass("csui-state-empty csui-state-loading csui-state-failed").addClass("csui-state-"+this.view.actionState.get("state"))}})}),csui.define("csui/controls/toolbar/delayed.toolbar.view",["csui/controls/toolbar/toolbar.view","csui/controls/toolbar/toolbar.state.behavior"],function(e,t){"use strict";return e.extend({"behaviors":{"ToolbarState":{"behaviorClass":t,"delayedActions":function(){return this.options.delayedActions}}},"constructor":function(t){e.prototype.constructor.apply(this,arguments)}})}),csui.define("csui/controls/fileupload/impl/upload.controller",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/base","csui/utils/taskqueue","csui/utils/contexts/factories/task.queue.factory","csui/utils/contexts/factories/connector","csui/models/version","csui/utils/url","csui/utils/commandhelper","csui/lib/underscore.deepExtend"],function(e,t,i,n,o,s,r,l,a,c,u){"use strict";function d(e){e||(e={}),this.options=e;var t=this.options.context;this.connector=t.getObject(l),this.container=e.container?e.container.clone():null,this.originatingView=e.originatingView?e.originatingView:null,e.context?this.queue=e.context.getCollection(r,{"options":{"parallelism":e.parallelism||h.parallelism,"permanent":!0}}):this.queue=new s({"parallelism":e.parallelism||h.parallelism}),this.chunkQueue=new s({"parallelism":e.parallelism||h.parallelism})}var h=e.config();return t.defaults(h,{"parallelism":3}),t.extend(d.prototype,n.Events,{"scheduleFileForUpload":function(e){this.queue.pending.add({"worker":t.bind(this._uploadFile,this,e)})},"_uploadFile":function(e){var i,n,s=e.container||this.container,r=e.deferred,l=e.node,c=e.version||e.get("newVersion"),u=e.get("file"),d=e.get("extended_data");if(t.isArray(l.get("versions"))&&!!l.attributes&&!!l.attributes.versions&&l.attributes.versions.push(c.attributes),c)l.has("id")||l.set("id",e.get("id")),c instanceof a||(c=new a({"id":l.get("id")})),n={},e.get("add_major_version")&&(n.add_major_version=e.get("add_major_version"));else{if(!s)throw new Error("Container node is missing.");n={"name":e.get("newName")||u.name,"type":void 0!==l.get("type")?l.get("type"):void 0!==e.get("type")?e.get("type"):144,"parent_id":s.get("id"),"advanced_versioning":!!s.get("versions_control_advanced")}}if(o.getMetadataLanguageInfo().enabled&&e.get("multilingual_provided")&&t.extend(n,{"name_multilingual":e.get("name_multilingual")}),d&&t.deepExtend(n,d),s&&136===s.get("type")&&e.get("order_new")&&(n.order_new=e.get("order_new")),(144===n.type||c)&&(n.external_modify_date=e.get("file").lastModifiedDate,void 0===n.external_modify_date&&(n.external_modify_date=new Date(e.get("file").lastModified))),!l.connector){if(!s)throw new Error("Either node or container have to be connected.");s.connector.assignTo(l)}c&&!c.connector&&l.connector.assignTo(c);var p=this;return h.largeFileSettings=this.originatingView&&this.originatingView.largeFileSettingsModel&&this.originatingView.largeFileSettingsModel.get("largeFileSettings"),h.largeFileSettings&&h.largeFileSettings.is_enabled&&u.size>h.largeFileSettings.min_size&&u.size<h.largeFileSettings.max_size?(i=this.getUploadId(u).done(function(i){var n=e.get("state");"aborted"!==n&&"stopped"!==n?p.uploadAllParts(i,u,e).done(function(){var i=e.get("state");"aborted"!==i&&"stopped"!==i?p.completeUpload(e).done(function(){var i=e.get("state");if("aborted"!==i&&"stopped"!==i)if(l.get("id")){var n=l.get("id");p.createVersion(n,e).done(function(i){var n=i.results.data.versions.file_size,s=o.formatFileSize(n);c.set("file_size_formatted",s),c.isLocallyCreated=!0,i.results&&i.results.data&&i.results.data.properties&&i.results.data.versions&&t.extend(c.attributes,i.results.data.properties,i.results.data.versions),p.fetchNode(i,l).done(function(){return r.resolve(e),r.promise()}).catch(function(t){var i=new o.RequestErrorMessage(t);r.reject(e,i)})}).catch(function(t){p.handleCatch(t,e)})}else p.createNode(u,e).done(function(t){p.fetchNode(t,l).done(function(){return r.resolve(e),r.promise()}).catch(function(t){var i=new o.RequestErrorMessage(t);r.reject(e,i)})}).catch(function(t){p.handleCatch(t,e)});else r.reject(e)}).catch(function(t){p.handleCatch(t,e)}):r.reject(e)}).catch(function(t){for(var i,n=0;n<t.length;n++)t[n].length>1&&(i=t[n][1]);p.handleCatch(i,e)}):r.reject(e)}).fail(function(t){p.handleCatch(t,e)}),r.fail(function(e,t){t||i.abort()})):(i=(c||l).save(n,{"data":n,"files":{"file":u}}),i.progress(function(t,i){r.notify(e,t)}).then(function(e,t,i){if(l)return l=p.checkAndGetIfExistingNode(l),l.fetch({"collection":l.collection,"refreshCache":!0})}).done(function(t,i,n){r.resolve(e)}).fail(function(t,i,n){var s=new o.RequestErrorMessage(t);r.reject(e,s)}),r.fail(function(t,i){i||r.reject(e)})),e.promise()},"checkAndGetIfExistingNode":function(e){var t=e.get("id");if(!t)return e;var i=e.collection&&e.collection.findWhere({"id":t});return i||e},"getUploadId":function(e){var t=this.connector.getConnectionUrl().getApiBase("v2"),i={"file_size":e.size,"file_name":e.name,"mime_type":e.type},n={"url":c.combine(t,"multipart"),"type":"POST","data":i,"contentType":"application/x-www-form-urlencoded"};return this.connector.makeAjaxCall(n)},"uploadAllParts":function(e,t,n){var o=e.results.data,s=this,r=o.part_size,l=n.get("largeFile");if(l.uploadKey=o.upload_key,l.maxRetries=o.max_retries,l.fileChunks.total=o.num_parts,n.set({"state":"processing"}),l.state="processing",!l.slicedFiles)for(var a=0;a<o.num_parts;a++)l.fileChunks.slicedFiles[a]=t.slice(a*r,(a+1)*r,"application/octet-stream");n.set("largeFile",l),n.attributes.upload_key=o.upload_key;var c=s.uploadChunk(n);return i.whenAll.apply(i,c)},"uploadChunk":function(e){var n=e.get("largeFile"),o=this,s=this.connector.getConnectionUrl().getApiBase("v2")+"multipart/"+n.uploadKey,r=n.fileChunks.slicedFiles.map(function(l,a){var c=new FormData,u=i.Deferred();c.append("part_content",l);var d=s+"/"+(a+1),h={"url":d,"method":"POST","data":c,"processData":!1,"contentType":!1};return o.chunkQueue.pending.add({"worker":t.bind(function(){var t=(o.connector.makeAjaxCall(h).done(function(){var t=e.get("count");n=e.get("largeFile",n),e.set({"count":l.size+t}),e.set("largeFile",n),u.resolve(l)}).catch(function(e){u.reject(l,e)}),e.get("state"));if("aborted"!==t&&"stopped"!==t)return u.promise();u.reject(e)},o,h)}),u.promise(r)});return r},"completeUpload":function(e){var t=e.get("largeFile"),i=this.connector.getConnectionUrl().getApiBase("v2")+"multipart/"+t.uploadKey,n={"url":i,"type":"POST","contentType":"application/x-www-form-urlencoded"};return this.connector.makeAjaxCall(n)},"createNode":function(e,t){var i=t.get("largeFile"),n=this.connector.getConnectionUrl().getApiBase("v2")+"nodes",o={"parent_id":this.container.get("id"),"type":144,"name":e.name,"upload_key":i.uploadKey},s={"url":n,"type":"POST","data":o,"contentType":"application/x-www-form-urlencoded"};return this.connector.makeAjaxCall(s)},"createVersion":function(e,t){var i=t.get("largeFile"),n=this.connector.getConnectionUrl().getApiBase("v2")+"nodes/"+e+"/versions",o={"upload_key":i.uploadKey},s={"url":n,"type":"POST","data":o,"contentType":"application/x-www-form-urlencoded"};return this.connector.makeAjaxCall(s)},"fetchNode":function(e,t){if(t)return t=this.checkAndGetIfExistingNode(t),t.attributes=e.results.data.properties,e.results.data.versions&&t.set("versions",e.results.data.versions),t.fetch({"collection":t.collection,"refreshCache":!0})},"handleCatch":function(e,t){var i=t.deferred;if(e.status>=400){var n=new o.RequestErrorMessage(e);i.reject(t,n)}else this.isRetry=!0,this.retryUpload(t)},"retryUpload":function(e){var t=e.deferred,i=this;if(navigator.onLine){this.isRetry&&(this.isRetry=!1,this.queue=new s({"parallelism":this.options.parallelism||h.parallelism}));var n=e.get("file"),o=n.size,r=e.get("largeFile"),l={"size":o,"uploadKey":"","state":"pending","fileChunks":{"slicedFiles":[],"total":0}};l.retryCount=r.retryCount,l.maxRetries=r.maxRetries,e.set({"count":0}),e.attributes.upload_key="",e.set("largeFile",l);var a=e.get("state");!l.maxRetries&&"pending"===a||"aborted"!==a&&"stopped"!==a&&l.retryCount<l.maxRetries?(l.retryCount=l.retryCount+1,e.set("largeFile",l),this.scheduleFileForUpload(e)):t.reject(e)}else var c=setInterval(function(){navigator.onLine&&(clearInterval(c),i.retryUpload(e))},2e3)}}),d.extend=n.View.extend,d}),csui.define("csui/controls/disclosure/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/disclosure/impl/nls/root/lang",{"ariaLabel":"Information disclosure","titleDisclosed":"See all","titleExpanded":"See less"}),csui.define("hbs!csui/controls/disclosure/impl/disclosure.view",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"    "+(null!=(s=(r(i,"icon-v2")||t&&r(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"size":"xsmall","iconName":"csui_caret_up"},"loc":{"start":{"line":4,"column":4},"end":{"line":4,"column":56}}}))?s:"")+"\r\n"},"3":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"    "+(null!=(s=(r(i,"icon-v2")||t&&r(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"size":"xsmall","iconName":"csui_caret_down"},"loc":{"start":{"line":6,"column":4},"end":{"line":6,"column":58}}}))?s:"")+"\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<button class="csui-control csui-disclosure" aria-expanded="'+e.escapeExpression((r=null!=(r=l(i,"ariaExpanded")||(null!=t?l(t,"ariaExpanded"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"ariaExpanded","hash":{},"loc":{"start":{"line":1,"column":60},"end":{"line":1,"column":76}}}):r))+'"\r\n        aria-label="'+e.escapeExpression((r=null!=(r=l(i,"ariaLabel")||(null!=t?l(t,"ariaLabel"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"ariaLabel","hash":{},"loc":{"start":{"line":2,"column":20},"end":{"line":2,"column":33}}}):r))+'" '+e.escapeExpression((r=null!=(r=l(i,"disabled")||(null!=t?l(t,"disabled"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"disabled","hash":{},"loc":{"start":{"line":2,"column":35},"end":{"line":2,"column":47}}}):r))+' title="'+e.escapeExpression((r=null!=(r=l(i,"title")||(null!=t?l(t,"title"):t))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":2,"column":55},"end":{"line":2,"column":64}}}):r))+'">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"ariaExpanded"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.program(3,o,0),"loc":{"start":{"line":3,"column":2},"end":{"line":7,"column":9}}}))?s:"")+"</button>"}});return i.registerPartial("csui_controls_disclosure_impl_disclosure.view",n),n}),csui.define("csui/controls/disclosure/disclosure.icons.v2",["csui/controls/icons.v2"],function(e){e.registerIcons({"csui_caret_up":'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" class="csui-icon-v2 csui-impl-icon-v2__caret_up" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 18 18" xml:space="preserve"> <polyline fill="none" stroke="#333333" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" points="4,12 9,7 14,12 "/></svg>',"csui_caret_down":'<svg version="1.1" xmlns="http://www.w3.org/2000/svg" class="csui-icon-v2 csui-impl-icon-v2__caret_down" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 18 18" xml:space="preserve"> <polyline fill="none" stroke="#333333" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" points="14,7 9,12 4,7 "/></svg>'})}),csui.define("css!csui/controls/disclosure/impl/disclosure.view",[],function(){}),csui.define("csui/controls/disclosure/disclosure.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/behaviors/keyboard.navigation/retainfocus.behavior","i18n!csui/controls/disclosure/impl/nls/lang","hbs!csui/controls/disclosure/impl/disclosure.view","csui/controls/disclosure/disclosure.icons.v2","css!csui/controls/control/impl/control","css!csui/controls/disclosure/impl/disclosure.view"],function(e,t,i,n,o,s,r,l){"use strict";return n.ItemView.extend({"className":"csui-control-view csui-disclosure-view","template":r,"templateHelpers":function(){var e=this.model.get("expanded");return{"disabled":this.model.get("disabled")?"disabled":"","ariaExpanded":e,"title":e?this.titleExpanded?this.titleExpanded:s.titleExpanded:this.titleDisclosed?this.titleDisclosed:s.titleDisclosed,"ariaLabel":e?this.ariaLabelExpanded?this.ariaLabelExpanded:s.ariaLabel:this.ariaLabelDisclosed?this.ariaLabelDisclosed:s.ariaLabel}},"modelEvents":{"change:disabled":"render","change:expanded":"render"},"events":{"click":"_toggleExpanded"},"behaviors":{"RetainFocusBehavior":{"behaviorClass":o}},"constructor":function(e){e||(e={}),this.ariaLabelDisclosed=e.ariaLabelDisclosed,this.ariaLabelExpanded=e.ariaLabelExpanded,this.titleDisclosed=e.titleDisclosed,this.titleExpanded=e.titleExpanded,e.model||(e.model=new i.Model({"disabled":void 0!==e.disabled&&e.disabled})),n.ItemView.prototype.constructor.call(this,e),this.setExpanded(e.expanded)},"setDisabled":function(e){this.model.set("disabled",!!e)},"setExpanded":function(e){var t={"silent":!1};switch(this.model.get("disabled")&&(t.silent=!0),e){case"true":case!0:this.model.set("expanded",!0,t);break;default:this.model.set("expanded",!1,t)}},"_toggleExpanded":function(){if(!this.model.get("disabled")){var e=this.model.get("expanded"),t={"sender":this,"model":this.model};this.triggerMethod("clicked",t),t.cancel||this.model.set("expanded",!e)}}})}),csui.define("csui/models/appliedcategory",["csui/lib/underscore","csui/lib/backbone","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/uploadable/uploadable.mixin"],function(e,t,i,n){var o=t.Model.extend({"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments),this.makeConnectable(i).makeUploadable(i)},"isNew":function(){return!!this.get("category_id")},"parse":function(e,t){var i=this.attributes;return i.category_id&&(e.id=i.category_id,delete i.category_id),e}});return n.mixin(o.prototype),i.mixin(o.prototype),o}),csui.define("csui/models/appliedcategories/server.adaptor.mixin",["csui/lib/jquery","csui/lib/underscore","csui/utils/url"],function(e,t,i){"use strict";return{"mixin":function(e){return t.extend(e,{"makeServerAdaptor":function(e){return this},"url":function(){return i.combine(this.node.urlBase(),"categories")},"parse":function(e,t){return this.sortInitially(e.data)},"sortInitially":function(e){return t.isArray(e)?t.sortBy(e,function(e){return e.name.toLowerCase()}):e}})}}}),csui.define("csui/models/appliedcategories",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/mixins/node.resource/node.resource.mixin","csui/models/appliedcategory","csui/models/appliedcategories/server.adaptor.mixin"],function(e,t,i,n,o,s){"use strict";var r=t.Collection.extend({"model":o,"constructor":function(e,i){this.sortInitially=i.sortInitially?i.sortInitially:this.sortInitially,t.Collection.prototype.constructor.apply(this,arguments),this.makeNodeResource(i)},"clone":function(){return new this.constructor(this.models,{"node":this.node})}});return n.mixin(r.prototype),s.mixin(r.prototype),r}),csui.define("csui/models/fileupload",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/log","csui/models/node/node.model","csui/models/version"],function(e,t,i,n,o,s,r){"use strict";var l=t.extend({"idAttribute":null},e.config());return n.Model.extend({"defaults":{"state":"pending","count":0,"total":0,"errorMessage":"","sequence":0},"idAttribute":l.idAttribute,"constructor":function(e,o){n.Model.prototype.constructor.apply(this,arguments),o||(o={}),this.node=o.node,this.node?this.setVersion(o):this.setNode(o),this.deferred=i.Deferred(),this.deferred.progress(t.bind(this.onStateChange,this)).done(t.bind(this.onStateChange,this)).fail(t.bind(this.onStateChange,this)),this._updateFileAttributes(!0),this.listenTo(this,"change:file",t.bind(this._updateFileAttributes,this,!1))},"setVersion":function(e){this.set("newVersion",!0,{"silent":!0}),this.version=new r({"id":this.node.get("id")},{"connector":e.connector||this.node.connector})},"setNode":function(e){this.container=e.container,this.node=new s(void 0,t.extend({"connector":e.connector||this.container&&this.container.connector},e,{"collection":this.get("collection")}))},"abort":function(e){this.deferred.reject(this,e)},"promise":function(){return this.deferred.promise()},"onStateChange":function(e,t){var i=this.deferred.state();"pending"==i?i="processing":"rejected"===i&&(e&&e.get("file")&&this.set({"count":e.get("file").size,"silent":!0}),t&&t.message?(this.set("errorMessage",t.message),t.statusCode>=500&&this.set({"serverFailure":!0})):i=t&&t.state?t.state:"aborted");var n={"state":i};if(t&&"progress"===t.type){var o=t.loaded,s=this.get("total");t.lengthComputable&&t.total>s&&(s=t.total,n.total=s),this.get("count")<o&&o<=s&&(n.count=o)}this.set(n)},"_updateFileAttributes":function(e){var t=this.get("file");t&&this.set({"name":t.name,"total":t.size},e?{"silent":!0}:{})}})}),csui.define("csui/models/fileuploads",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/log","csui/models/fileupload"],function(e,t,i,n,o,s){var r=n.Collection.extend({"model":s,"constructor":function(e,t){n.Collection.prototype.constructor.apply(this,arguments)},"state":function(){var e=!1,t=!1;return this.all(function(i){var n=i.get("state"),o="rejected"==n;return e=e||o,t=t||"processing"==n,o||"resolved"==n})?e?"rejected":"resolved":t?"processing":"pending"},"abort":function(e){this.forEach(function(t){t.get("abortState")&&(t.abort(),t.set("state",e))})}});return r.version="1.0",r}),csui.define("csui/models/namequery/server.adaptor.mixin",["csui/lib/jquery","csui/lib/underscore","csui/utils/url","csui/models/fileupload"],function(e,t,i,n){"use strict";return{"mixin":function(o){return t.extend(o,{"makeServerAdaptor":function(e){return this},"url":function(){return i.combine(this.connector.connection.url,"validation/nodes")},"queryNames":function(t){var i=this.get("containerId"),n=e.Deferred();return this.fileGroups=this._getFileNameGroups(t),0===this.fileGroups.length?n.reject():this._runQuery(0,i,n),n.promise()},"runQuery":function(e,t){var i={"parent_id":e,"names":t};return this._jqxhr(i)},"_jqxhr":function(t){var i=e.Deferred();return this.save(t,{"data":t}).done(i.resolve).fail(i.reject),i.promise()},"_runQuery":function(e,t,i){var n=this,o=this.fileGroups;if(o&&o[e]){var s={"parent_id":t,"names":this._getFileNames(o[e])};this._jqxhr(s).done(function(s,r,l){n._addResults(s,o[e]),o[++e]?n._runQuery(e,t,i):i.resolve(n.cleanFiles,n.conflictFiles)}).fail(function(e,t,n){i.reject(e)})}},"_addResults":function(e,i){function o(e,i){e instanceof n?(e.set({"type":void 0!==i.type&&null!==i.type?i.type:e.get("subType"),"versioned":i.versioned}),i.id&&e.set("id",i.id)):t.extend(e,{"id":i.id,"type":i.type,"versioned":i.versioned})}t.each(i,function(i){var s=i.newName||i.name||i.get("newName")||i.get("name"),r=t.find(e.results,function(e){return e.name===s})||{};if(i instanceof n){0===i.get("subType")&&(r.type=0)}else 0===i.type&&(r.type=0);o.call(this,i,r),r.id?this.conflictFiles.push(i):this.cleanFiles.push(i)},this)},"_getFileNames":function(e){var i=[];return t.each(e,function(e){var t="";t=e instanceof n?e.get("newName")||e.get("name"):e.newName||e.name,i.push(t)}),i},"_getFileNameGroups":function(t){for(var i=e.isArray(t)?t:t.models,n=0,o=1,s=i.length,r=[];n<s;){for(var l=[],a=this.config.filesPerQuery*o++;n<s&&n<a;n++)i[n].index=n,l.push(i[n]);r.push(l)}return r}})}}}),csui.define("csui/models/namequery",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/namequery/server.adaptor.mixin"],function(e,t,i,n,o,s,r){"use strict";var l=e.config();i.defaults(l,{"filesPerQuery":10});var a=n.Model.extend({"constructor":function(e,t){n.Model.prototype.constructor.apply(this,arguments),this.conflictFiles=[],this.cleanFiles=[],this.config=l,this.makeConnectable(t).makeUploadable(t)}});return s.mixin(a.prototype),o.mixin(a.prototype),r.mixin(a.prototype),a}),csui.define("csui/models/versions",["module","csui/lib/backbone","csui/utils/log","csui/models/version"],function(e,t,i,n){"use strict";var o=t.Collection.extend({"model":n,"constructor":function(e,i){t.Collection.prototype.constructor.apply(this,arguments),this.options=i||{},this.options.connector&&this.options.connector.assignTo(this)},"setOrder":function(e,t){if(this.orderBy!==e)return this.orderBy=e,!0},"resetOrder":function(e){if(this.orderBy)return this.orderBy=void 0,!1!==e&&this.fetch(),!0},"setLimit":function(e,t,i){if(this.skipCount!==e||this.topCount!==t)return this.skipCount=e,this.topCount=t,!1!==i&&this.fetch(),!0},"resetLimit":function(e){if(this.skipCount)return this.skipCount=0,!1!==e&&this.fetch(),!0}});return o.version="1.0",o}),csui.define("csui/models/server.adaptors/nodeversions.mixin",["csui/lib/underscore","csui/utils/url"],function(e,t){"use strict";function i(e,t){var i=[];(e.actions.findRecursively("download")||e.actions.findRecursively("Download"))&&i.push({"signature":"versions_download"},{"signature":"versions_open"}),(e.actions.findRecursively("delete")||e.actions.findRecursively("Delete"))&&i.push({"signature":"versions_delete"}),(e.actions.findRecursively("properties")||e.actions.findRecursively("Properties"))&&i.push({"signature":"versions_properties"}),t.actions=i}function n(){return t.combine(this.connector.getConnectionUrl().getApiBase("v2"),"/nodes/"+this.node.get("id"),"/versions?expand="+encodeURIComponent("versions{owner_id}")+"&metadata&actions")}function o(){var e=t.combineQueryString(this.getExpandableResourcesUrlQuery(),{"extra":!1,"commands":this.options.commands||[]});return t.combine(this.node.urlBase(),"/versions?"+e)}function s(t){var n=t.definitions,o=e.keys(n);if(!this.options.onlyClientSideDefinedColumns&&t.definitions_order)for(var s=0;s<t.definitions_order.length;s++){var r=t.definitions_order[s];n[r].definitions_order=500+s}return this.columns.reset(this.getColumnModels(o,n)),t.data&&e.each(t.data,function(e){e.id_expand={},e.id_expand.type=this.node.get("type"),e.commands||e.actions||i(this.node,e)},this),t.data}function r(t){var i=t.results[0].metadata.versions,n=[],o=e.keys(i);return this.columns.reset(this.getColumnModels(o,i)),t.results&&e.each(t.results,function(e){e.data.versions.id_expand={},e.data.versions.id_expand.type=this.node.get("type"),l(e.actions,e.data.versions),n.push(e.data.versions)},this),n}function l(t,i){i.actions=[],e.each(t.data,function(e){e.signature=e.name,i.actions.push(e)})}return{"mixin":function(t){return e.extend(t,{"makeServerAdaptor":function(e){return this},"url":function(){return this.options.useV2RestApi?n.call(this):o.call(this)},"parse":function(e){return this.options.useV2RestApi?r.call(this,e):s.call(this,e)},"getColumnModels":function(t,i){return e.reduce(t,function(t,n){if(n.indexOf("_formatted")>=0){var o=n.replace(/_formatted$/,"");if(i[o])return t}else{var s=i[n];if(!s.definitions_order){var r=i[n+"_formatted"];r&&r.definitions_order&&(s.definitions_order=r.definitions_order)}}var l=i[n];switch(n){case"name":l=e.extend(l,{"default_action":!0,"contextual_menu":!1,"editable":!0,"filter_key":"name"})}return l.sort=!0,t.push(e.extend({"column_key":n},l)),t},[])}})}}}),csui.define("csui/models/nodeversions",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/base","csui/utils/log","csui/utils/url","csui/models/versions","csui/models/actions","csui/models/columns","csui/models/mixins/node.resource/node.resource.mixin","csui/models/mixins/expandable/expandable.mixin","csui/models/browsable/client-side.mixin","csui/models/server.adaptors/nodeversions.mixin","csui/utils/deepClone/deepClone"],function(e,t,i,n,o,s,r,l,a,c,u,d,h){"use strict";var p=r.extend({"constructor":function(e,t){r.prototype.constructor.apply(this,arguments),this.makeNodeResource(t).makeExpandable(t).makeClientSideBrowsable(t).makeServerAdaptor(t),this.columns=new a},"clone":function(){return new this.constructor(this.models,{"node":this.node,"skip":this.skipCount,"top":this.topCount,"filter":t.deepClone(this.filters),"orderBy":t.clone(this.orderBy),"expand":t.clone(this.expand),"commands":t.clone(this.options.commands)})}});d.mixin(p.prototype),u.mixin(p.prototype),c.mixin(p.prototype),h.mixin(p.prototype);var f=p.prototype.setOrder;return p.prototype.setOrder=function(e,t){return f.call(this,e,t)},p}),csui.define("csui/models/node.facets/facet.query.mixin",["csui/lib/underscore","csui/lib/jquery"],function(e,t){"use strict";function i(e,t){var i=o(e),n={};return i.length&&(n[t]=i),n}function n(e,n){var o=i(e,n);return t.param(o,!0)}function o(t){return t&&e.map(t,s)||[]}function s(t){return t.id+":"+e.reduce(t.values,function(e,t){return e&&(e+="|"),e+t.id.toString()},"")}return{"mixin":function(t){return e.extend(t,{"makeFacetQuery":function(e){return this},"getFilterParam":function(e){return i(e||this.filters,this.filterQueryParameterName)},"getFilterQuery":function(e){return n(e||this.filters,this.filterQueryParameterName)},"getFilterQueryValue":function(e){return o(e||this.filters)}})}}}),csui.define("csui/models/widget/search.results/search.facet.query.mixin",["csui/lib/underscore","csui/lib/jquery"],function(e,t){"use strict";function i(e,t){var i=o(e),n={};return i.length&&(n[t]=i),n}function n(e,n){var o=i(e,n);return t.param(o,!0)}function o(t){return t&&e.map(t,s)||[]}function s(t){return t.id+":{"+e.reduce(t.values,function(e,t){return e&&(e+=","),e+t.id.toString()},"")+"}"}return{"mixin":function(t){return e.extend(t,{"makeFacetQuery":function(e){return this},"getFilterParam":function(e){return i(e||this.filters,this.filterQueryParameterName)},"getFilterQuery":function(e){
return n(e||this.filters,this.filterQueryParameterName)},"getFilterQueryValue":function(e){return o(e||this.filters)}})}}}),csui.define("csui/models/node.facets/server.adaptor.mixin",["csui/lib/underscore","csui/lib/jquery","csui/utils/url","csui/models/node.facets/facet.query.mixin"],function(e,t,i,n){"use strict";function o(t,i){var n=e.keys(i)[0],o=i[n];e.each(o,function(e){e.value=e.value.toString(),e.selected=t})}function s(t,i){var n=e.keys(i)[0],o=i[n],s=t[n]||{};return e.extend({"items_to_show":5,"select_multiple":!0,"topics":o},s,{"id":n.toString()})}function r(t){var i=[];if(899===t.get("type")){var n=t.get("selected_facets");i=e.map(n,function(e){var t={"id":e[0],"values":[]};return e[1].forEach(function(e){t.values.push({"id":e})}),t})}return i}return{"mixin":function(t){t.fetch;return n.mixin(t),e.extend(t,{"filterQueryParameterName":"where_facet","makeServerAdaptor":function(e){return this.makeFacetQuery(e)},"isFetchable":function(){var e=this.node,t=e.get("type"),i=e.get("location_id");return 899!==t||0!==i},"url":function(){var t=this.node.get(899===this.node.get("type")?"location_id":"id"),n=e.union(r(this.node),this.filters),o=this.getFilterQuery(n),s=i.combine(this.connector.connection.url,"nodes",t,"/facets");return o&&(s+="?"+o),s},"parse":function(t,i){var n=t.facets||{},r=n.properties||{},l=n.selected_values||[],a=n.available_values||[];if(l.forEach(o.bind(null,!0)),a.forEach(o.bind(null,!1)),899===this.node.get("type")){var c=this.node.get("selected_facets")||[];c=c.map(function(e){return e[0]}),l=l.filter(function(t){var i=e.keys(t)[0];return!e.contains(c,i)})}return l.concat(a).map(s.bind(null,r))}})}}}),csui.define("csui/models/nodefacets",["csui/lib/underscore","csui/models/facets","csui/models/mixins/node.resource/node.resource.mixin","csui/models/node.facets/server.adaptor.mixin","csui/utils/deepClone/deepClone"],function(e,t,i,n){"use strict";var o=t.extend({"constructor":function(e,i){t.prototype.constructor.apply(this,arguments),this.makeNodeResource(i).makeServerAdaptor(i)},"clone":function(){return new this.constructor(this.models,{"node":this.node,"filters":e.deepClone(this.filters)})}});return i.mixin(o.prototype),n.mixin(o.prototype),o}),csui.define("csui/models/node/node.facet.factory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/node","csui/models/nodefacets"],function(e,t,i,n,o,s){return n.extend({"propertyPrefix":"facets","constructor":function(r,l){n.prototype.constructor.apply(this,arguments);var a=this.options.facets||{};if(!(a instanceof i.Collection)){var c=a.options&&a.options.node||r.getModel(o,l),u=e.config();a=new s(a.models,t.defaults(u.options,a.options,{"autoreset":!0},{"node":c}))}this.property=a},"fetch":function(e){return this.property.fetch(e)}})}),csui.define("csui/models/node/node.facet2.factory",["module","nuc/lib/underscore","nuc/lib/backbone","csui/utils/contexts/mixins/clone.and.fetch.mixin","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/node","csui/models/nodefacets2"],function(e,t,i,n,o,s,r){var l=o.extend({"propertyPrefix":"facets2","constructor":function(n,l){o.prototype.constructor.apply(this,arguments);var a=this.options.facets2||{};if(!(a instanceof i.Collection)){var c=a.options&&a.options.node||n.getModel(s,l),u=e.config();a=new r(a.models,t.defaults(u.options,a.options,{"autoreset":!0},{"node":c}))}this.property=a,this.makeCloneAndFetch(l)},"isFetchable":function(){return this.property.isFetchable()},"fetch":function(e){return this.property.fetch(e)}});return n.mixin(l.prototype),l}),csui.define("csui/models/widget/search.results/search.response.mixin",["csui/lib/underscore","csui/utils/base","csui/utils/accessibility","csui/models/ancestor","csui/models/node/node.model"],function(e,t,i,n,o){"use strict";var s=i.isAccessibleTable();return{"mixin":function(t){return e.extend(t,{"makeSearchResponse":function(e){return this},"parseSearchResponse":function(e,t){var i=e.collection.sorting;i&&(this.previousQuery=this.options.query.attributes.where),this.orderBy=this.orderBy?this.orderBy:i&&i.sort&&i.sort[0],this.previousOrderBy=this.orderBy,this.excludeSelectedAndInvalidFacets(e);var r=e.results;if(r)for(var l in r)if(r.hasOwnProperty(l)){if(r[l].data&&r[l].data.properties){if(r[l].bestbet&&(r[l].data.properties.bestbet=r[l].bestbet),r[l].nickname&&(r[l].data.properties.nickname=r[l].nickname),r[l].data.versions&&r[l].data.versions.file_size&&(r[l].data.properties.size=r[l].data.versions.file_size),r[l].data.versions&&r[l].data.versions.version_id&&(r[l].data.properties.version_id=r[l].data.versions.version_id),r[l].data.properties&&r[l].data.properties.container&&r[l].data.properties.container&&(r[l].data.properties.size=r[l].data.properties.container_size),r[l].data.properties.summary){var a=r[l].data.properties.summary;r[l].data.properties.stringifiedSummary=this.jsonToStringTokenizer(a),r[l].data.properties.summary=s?r[l].data.properties.stringifiedSummary:Array.isArray(a)&&a.length>1?a:1===a.length&&a[0].length?a:void 0}r[l].data.properties.reserved_user_id_expand&&(r[l].data.properties.reserved_user_id=r[l].data.properties.reserved_user_id_expand)}if(r[l].links&&r[l].links.ancestors){var c=[],u=r[l].links.ancestors,d=[];if(u)for(var h in u)if(u.hasOwnProperty(h)){var p=new n,f=parseInt(h,10),m={},g=u[f];m.id=g.href.substring(g.href.lastIndexOf("/")+1,g.href.length),m.volume_id=0===f?m.id:d[0],m.parent_id=0===f?"-1":d[f-1],o.usesIntegerId&&(m.id=parseInt(m.id),m.volume_id=parseInt(m.volume_id),m.parent_id=parseInt(m.parent_id)),d.push(m.id),m.name=g.name,m.showAsLink=!0,p.attributes=m,c.push(p)}r[l].data.properties.ancestors=c}for(var v in r[l].data.regions)r[l].data.regions.hasOwnProperty(v)&&(r[l].data.properties[v]=r[l].data.regions[v]);r[l].search_result_metadata&&(r[l].data.properties.search_result_metadata=r[l].search_result_metadata)}},"jsonToStringTokenizer":function(e){var t="";for(var i in e)e.hasOwnProperty(i)&&(t+=e[i].type?e[i].text:e[i]);return t},"parseBrowsedItems":function(e,t){return e.results},"excludeSelectedAndInvalidFacets":function(e){var t=e.collection.searching;if(t&&t.facets&&t.facets.available){var i=t.facets.available;if(t.facets.selected)for(var n=t.facets.selected,o=n.length,s=0;s<o;s++)for(var r=i.length,l=0;l<r;l++){var a=i[l].name;if("OTObjectSize"===a)i.splice(l,1),r=i.length,l--;else if(a===n[s].name)for(var c=n[s].facet_items.length,u=0;u<c;u++)for(var d=i[l].facet_items.length,h=0;h<d;h++)i[l].facet_items[h].display_name===n[s].facet_items[u].display_name&&(i[l].facet_items.splice(h,1),h--,d=i[l].facet_items.length);else 0===i[l].facet_items.length&&(i.splice(l,1),r=i.length,l--)}}}})}}}),csui.define("csui/models/widget/search.results/server.adaptor.mixin",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/widget/search.results/search.facet.query.mixin","csui/models/node.columns2"],function(e,t,i,n,o){"use strict";function s(t,i){return e.map(t,function(t){var n=e.map(t.facet_items,function(e){return{"name":e.display_name,"total":e.count,"value":e.value,"selected":i}});return{"id":t.name,"name":t.display_name,"type":t.type,"topics":n,"items_to_show":5,"select_multiple":!0}})}return{"mixin":function(t){n.mixin(t);var r=t.sync;return e.extend(t,{"filterQueryParameterName":"filter","makeServerAdaptor":function(e){return this.makeFacetQuery(e)},"cacheId":"","url":function(){var e=this.connector.getConnectionUrl().getApiBase("v2");return i.combine(e,"search")},"sync":function(t,i,n){var o=this.options.query.toJSON(),s=this.options.urlOptions||["'highlight_summaries'"];return void 0!==n.fetchFacets&&(this.fetchFacets=n.fetchFacets),this.fetchFacets&&s.push("'facets'"),this.options.query.resetDefaults&&(this.skipCount=0,this.options.query.resetDefaults=!1),!this.searchFacets||this.searchFacets.filters&&0!==this.searchFacets.filters.length||s.push("'featured'"),this.searchFacets&&e.extend(o,this.getFilterParam(this.searchFacets.filters)),e.extend(o,this._getBrowsableParams()),e.extend(o,this.getStateEnablingUrlQuery()),e.extend(o,this.getResourceFieldsUrlQuery()),e.extend(o,this.getRequestedCommandsUrlQuery()),o.options="{"+s.toString()+"}",o.expand="properties{original_id,owner_user_id,create_user_id,owner_id,reserved_user_id,parent_id,locked_user_id}",o.lookfor=this.options.query.get("lookfor"),o.modifier=this.options.query.get("modifier"),(this.orderBy||this.pagination)&&this.cacheId&&(o.cache_id=this.cacheId,this.pagination=!1),e.extend(n,{"type":"POST","contentType":"application/x-www-form-urlencoded","data":o,"traditional":!0}),r.apply(this,arguments)},"_getBrowsableParams":function(){var e=this.getBrowsableParams();return e&&e.sort&&(0===e.sort.search("asc_desc_")||0===e.sort.search("asc_asc_"))&&(e.sort=e.sort.replace("asc_","")),e},"parse":function(t,i){if(t.featured&&(t.featured=e.filter(t.featured,function(e){return!!e.bestbet||!!e.nickname})),this.addRegionsToPromotedList(t.featured),t.collection.searching){var n=new o,s=e.clone(t.collection.searching.regions_metadata),r=e.clone(e.uniq(t.collection.searching.regions_order)),l=[];e.each(s,function(e,t){var i=500+r.indexOf(t);e.definitions_order=i,e.key=t,e.sortable=!1,e.column_key=t,e.column_name=t,e.default_action=["OTLocation","OTName","OTMIMEType"].indexOf(t)>=0,e.default=["OTLocation","OTName","OTMIMEType"].indexOf(t)>=0,e.completeName=e.name,e.titleAttr=e.name.replace(/:([^\s])/,": $1"),e.name=e.name&&e.name.replace(/^[^:]*:\s*/,""),l.push(e)}),l.push({"key":"favorite","column_key":"favorite","default":!0}),l.push({"key":"reserved","column_key":"reserved","default":!0});var a=e.pluck(t.results,"search_result_metadata"),c=e.where(a,{"current_version":!1});c=c.length?c:e.where(a,{"version_type":"minor"}),c&&c.length>0&&l.push({"key":"version_id","column_key":"version_id"}),n.reset(l),t.collection.searching.sortedColumns=n,e.each(t.results,function(e){e.data.versions&&e.search_result_metadata&&(!1===e.search_result_metadata.current_version||"minor"===e.search_result_metadata.version_type)&&(e.data.versions.current_version=!1)})}var u=t.collection.sorting.links;for(var d in u)if(0===d.search("asc_")){var h=this.trimSortOptionName(u[d].name);h=h.trim();var p=t.collection.searching.sortedColumns.where({"completeName":h});p&&p.length>0&&p[0].set("sort",!0)}return t.results=t.featured&&t.collection.sorting&&"relevance"===t.collection.sorting.sort[0]?t.featured.concat(t.results):t.results,this.parseBrowsedState(t.collection,i),this.parseSearchResponse(t,i),i.fetchFacets&&this._parseFacets(t.collection.searching.facets),t.results.sorting=t.collection.sorting,this.cacheId=t.collection&&t.collection.searching&&t.collection.searching.cache_id?t.collection.searching.cache_id:"",this.parseBrowsedItems(t,i)},"trimSortOptionName":function(e){return e.replace(/\(([;\s\w\"\=\,\:\.\/\~\{\}\?\!\-\%\&\#\$\^\(\)]*?)\)/g,"")},"addRegionsToPromotedList":function(t){e.each(t,function(e,t){e.data.regions={"OTMIMEType":e.data.properties.mime_type,"OTName":e.data.properties.name,"OTLocation":e.data.properties.parent_id,"OTObjectDate":e.data.properties.create_date,"OTModifyDate":e.data.properties.modify_date,"OTObjectSize":e.data.properties.size_formatted}})},"_parseFacets":function(e){var t;e&&(t=s(e.selected,!0).concat(s(e.available,!1))),this.searchFacets.reset(t)}})}}}),csui.define("csui/models/widget/search.results/search.results.model",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/models/node/node.model","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/browsable.mixin","csui/models/browsable/v1.request.mixin","csui/models/browsable/v2.response.mixin","csui/models/mixins/state.requestor/state.requestor.mixin","csui/models/mixins/v2.delayed.commandable/v2.delayed.commandable.mixin","csui/models/mixins/v2.additional.resources/v2.additional.resources.mixin","csui/models/mixins/v2.fields/v2.fields.mixin","csui/models/mixins/v2.expandable/v2.expandable.mixin","csui/models/widget/search.results/search.response.mixin","csui/models/widget/search.results/server.adaptor.mixin","csui/utils/contexts/perspective/plugins/node/node.extra.data","csui/utils/contexts/perspective/plugins/node/utils/merge.extra.data","i18n!csui/models/widget/nls/lang","csui/utils/deepClone/deepClone"],function(e,t,i,n,o,s,r,l,a,c,u,d,h,p,f,m,g,v,b){"use strict";var y=i.Collection.extend({"model":n,"constructor":function(e,t){this.options=t||(t={}),i.Collection.prototype.constructor.call(this,e,t),this.title=b.searchResults,t.fields||(t.fields=g.getModelFields()),t.expand||(t.expand=v(g.getModelExpand(),{"properties":["reserved_user_id","original_id","owner_user_id","create_user_id","owner_id","reserved_user_id","parent_id"]})),this.makeConnectable(t).makeFetchable(t).makeAdditionalResourcesV2Mixin(t).makeBrowsable(t).makeBrowsableV1Request(t).makeFieldsV2(t).makeExpandableV2(t).makeBrowsableV2Response(t).makeStateRequestor(t).makeDelayedCommandableV2(t).makeSearchResponse(t).makeServerAdaptor(t)},"clone":function(){return new this.constructor(this.models,{"connector":this.connector,"skip":this.skipCount,"top":this.topCount,"filter":e.deepClone(this.filters),"orderBy":e.clone(this.orderBy),"expand":e.clone(this.expand),"includeActions":this.includeActions,"commands":e.clone(this.commands),"defaultActionCommands":e.clone(this.defaultActionCommands),"delayRestCommands":this.delayRestCommands})},"isFetchable":function(){return!!this.options.query.get("where")||!!this.options.query.get("query_id")},"setDefaultPageNum":function(){this.skipCount=0},"setPreviousOrder":function(e,t){if(this.previousOrderBy!=e)return this.previousOrderBy=e,!1!==t&&this.fetch({"skipSort":!1}),!0},"getResourceScope":function(){return e.deepClone({"includeResources":this._additionalResources,"commands":this.commands,"defaultActionCommands":this.defaultActionCommands})},"setResourceScope":function(e){this.excludeResources(),e.includeResources&&this.includeResources(e.includeResources),this.resetCommands(),e.commands&&this.setCommands(e.commands),this.resetDefaultActionCommands(),e.defaultActionCommands&&this.setDefaultActionCommands(e.defaultActionCommands)}});return r.mixin(y.prototype),l.mixin(y.prototype),a.mixin(y.prototype),h.mixin(y.prototype),p.mixin(y.prototype),o.mixin(y.prototype),s.mixin(y.prototype),c.mixin(y.prototype),d.mixin(y.prototype),f.mixin(y.prototype),m.mixin(y.prototype),u.mixin(y.prototype),y}),csui.define("csui/models/permission/permission.table.columns.model",["csui/lib/underscore","csui/lib/backbone"],function(e,t,i,n){return t.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0}})}),csui.define("hbs!csui/utils/commands/impl/full.page.modal/full.page.modal",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="binf-modal-dialog">\r\n  <div class="binf-modal-content">\r\n  </div>\r\n</div>\r\n'}});return i.registerPartial("csui_utils_commands_impl_full.page.modal_full.page.modal",n),n}),csui.define("css!csui/utils/commands/impl/full.page.modal/full.page.modal",[],function(){}),csui.define("csui/utils/commands/impl/full.page.modal/full.page.modal.view",["csui/lib/jquery","csui/lib/marionette","csui/utils/non-emptying.region/non-emptying.region","hbs!csui/utils/commands/impl/full.page.modal/full.page.modal","css!csui/utils/commands/impl/full.page.modal/full.page.modal","csui/lib/binf/js/binf"],function(e,t,i,n){"use strict";return t.LayoutView.extend({"className":"csui-full-page-modal binf-modal binf-fade","template":n,"regions":{"content":".binf-modal-content"},"events":{"shown.binf.modal":"_refresh","hidden.binf.modal":"destroy"},"constructor":function(e){t.LayoutView.prototype.constructor.apply(this,arguments),this.view=this.options.view},"show":function(){var t=e.fn.binf_modal.getDefaultContainer();return new i({"el":t}).show(this),this},"onRender":function(){this.listenTo(this.view,"destroy",function(){this.$el.binf_modal("hide")}),this.content.show(this.options.view),e(window).scrollTop(0),this.$el.binf_modal({"backdrop":"static","keyboard":!1})},"_refresh":function(){this.view.triggerMethod("dom:refresh")}})}),csui.define("csui/utils/thumbnail/server.adaptor.mixin",["csui/lib/underscore","csui/utils/thumbnail/thumbnail.object","csui/utils/url"],function(e,t,i){"use strict";return{"mixin":function(t){return e.extend(t,{"makeServerAdaptor":function(e){return this},"url":function(){var e=this.options.node,t=e.get("id"),n=e.get("version_number"),o=n?"&version_number="+n:"";return i.combine(e.connector.connection.url,"/nodes",t,"/thumbnails/medium/content?suppress_response_codes"+o)},"available":function(){var t=[144,145,736,749];return e.contains(t,this.options.node.get("type"))},"getPhotOptions":function(e){e=e||this.options.node;var t=e&&e.get("id");return{"url":i.combine(e.connector.connection.url,"/nodes",t,"/content?action=open&suppress_response_codes"),"dataType":"binary"}},"getContentUrl":function(e){return URL.createObjectURL(e)}})}}}),csui.define("csui/utils/thumbnail/thumbnail.object",["csui/lib/jquery","csui/lib/marionette","csui/utils/url","csui/utils/base","csui/utils/thumbnail/server.adaptor.mixin"],function(e,t,i,n,o){"use strict";var s=t.Object.extend({"constructor":function(e){t.Object.prototype.constructor.apply(this,arguments),this.node=this.options.node,this.listenTo(this.node,"change:id",this.loadUrl).listenTo(this,"destroy",this.release),this.makeServerAdaptor(e)},"loadUrl":function(){if(!this.node.get("csuiThumbnailImageUrl")){var e=this.url(),t=this;return this.release(),this.node.connector.makeAjaxCall({"url":e,"dataType":"binary"}).then(function(e){t.load(e)},function(e){t._failureHandler(e)})}},"load":function(e){var t=this;if(e.type&&e.type.match(/application\/json/i)){var i=new window.FileReader;i.readAsText(e),i.onload=function(e){var i=JSON.parse(e.target.result);404===i.statusCode&&t._failureHandler(i.error)}}else t.imgUrl=URL.createObjectURL(e),t.options.node.set("csuiThumbnailImageUrl",t.imgUrl,{"silent":!0}),t.triggerMethod("loadUrl",t,t.imgUrl)},"release":function(){this.imgUrl&&(URL.revokeObjectURL(this.imgUrl),delete this.imgUrl,this.options.node.unset("csuiThumbnailImageUrl",{"silent":!0}))},"_failureHandler":function(t){var i=new n.Error(new Error(t));return this.triggerMethod("error",this,i),e.Deferred().reject(i).promise()}});return o.mixin(s.prototype),s}),csui.define("hbs!csui/utils/thumbnail/loading.thumbnail",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<p>"+e.escapeExpression((s=null!=(s=r(i,"loading")||(null!=t?r(t,"loading"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"loading","hash":{},"loc":{"start":{"line":1,"column":3},"end":{"line":1,"column":14}}}):s))+"</p>\r\n"}});return i.registerPartial("csui_utils_thumbnail_loading.thumbnail",n),n}),csui.define("hbs!csui/utils/thumbnail/no.thumbnail",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<p>"+e.escapeExpression((s=null!=(s=r(i,"notAvailable")||(null!=t?r(t,"notAvailable"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"notAvailable","hash":{},"loc":{"start":{"line":1,"column":3},"end":{"line":1,"column":19}}}):s))+"</p>\r\n"}});return i.registerPartial("csui_utils_thumbnail_no.thumbnail",n),n}),csui.define("hbs!csui/utils/thumbnail/thumbnail",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<img src="'+e.escapeExpression((s=null!=(s=r(i,"url")||(null!=t?r(t,"url"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"url","hash":{},"loc":{"start":{"line":1,"column":10},"end":{"line":1,"column":17}}}):s))+'" alt="">\r\n'}});return i.registerPartial("csui_utils_thumbnail_thumbnail",n),n}),csui.define("css!csui/utils/thumbnail/thumbnail",[],function(){}),csui.define("csui/utils/thumbnail/thumbnail.view",["csui/lib/marionette","csui/utils/thumbnail/thumbnail.object","hbs!csui/utils/thumbnail/loading.thumbnail","hbs!csui/utils/thumbnail/no.thumbnail","hbs!csui/utils/thumbnail/thumbnail","i18n!csui/utils/impl/nls/lang","css!csui/utils/thumbnail/thumbnail"],function(e,t,i,n,o,s){"use strict";return e.ItemView.extend({"className":"csui-thumbnail","getTemplate":function(){var e=this.thumbnail.imgUrl;return void 0===e?i({"loading":s.Loading}):e?o:n({"notAvailable":s.NotAvailable})},"constructor":function(i){e.ItemView.prototype.constructor.apply(this,arguments),this.thumbnail=this.options.thumbnail||new t({"node":this.options.node}),this.listenTo(this.thumbnail,"loadUrl",this.render),this.listenTo(this.thumbnail,"error",this.render),this.listenTo(this,"render",function(){void 0===this.thumbnail.imgUrl&&this.thumbnail.loadUrl()}),this.listenTo(this,"destroy",function(){this.thumbnail.destroy()})},"serializeData":function(){return{"imgUrl":this.thumbnail.imgUrl}}})}),csui.define("hbs!csui/utils/expiration.warning/impl/expiration.warning",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="div-inline csui-expiration-warning-dialog-text">'+e.escapeExpression((s=null!=(s=r(i,"warningText")||(null!=t?r(t,"warningText"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"warningText","hash":{},"loc":{"start":{"line":2,"column":62},"end":{"line":2,"column":77}}}):s))+'</div><BR>\r\n  <div class="div-inline csui-expiration-warning-dialog-timevalue">\r\n    <span class="csui-time-value-min"></span>:<span class="csui-time-value-sec"></span>\r\n  </div>\r\n\r\n  <p id="csui-expiration-timer-live" aria-live="assertive" aria-atomic="true"></p>  \r\n'},"3":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="div-inline csui-expiration-warning-dialog-text">'+e.escapeExpression((s=null!=(s=r(i,"warningText")||(null!=t?r(t,"warningText"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"warningText","hash":{},"loc":{"start":{"line":9,"column":62},"end":{"line":9,"column":77}}}):s))+"</div>  \r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=r(i,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"isExpirationWarningContent"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.program(3,o,0),"loc":{"start":{"line":1,"column":0},"end":{"line":10,"column":7}}}))?s:""}});return i.registerPartial("csui_utils_expiration.warning_impl_expiration.warning",n),n}),csui.define("csui/utils/expiration.warning/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/utils/expiration.warning/impl/nls/root/lang",{"dialogExpirationWarningTitle":"Session timeout warning","dialogExpirationWarningText":"Your session will expire automatically in","dialogExpirationWarningButtonContinueSession":"Continue session","dialogExpirationWarningButtonContinueSessionTooltip":"Refresh session and continue work","dialogExpirationWarningButtonContinueSessionAria":"Refresh session and continue work","dialogExpirationWarningButtonTerminateSession":"End session now","dialogExpirationWarningButtonTerminateSessionTooltip":"Trigger logout now","dialogExpirationWarningButtonTerminateSessionAria":"Trigger logout now","dialogExpirationWarningLoggedOutText":"Performing sign out...","dialogExpirationWarningButtonLeave":"Close","dialogExpirationWarningButtonLeaveTooltip":"Close the dialog and redirect to target page","dialogExpirationWarningButtonLeaveAria":"Close the dialog and redirect to target page","dialogExpirationWarningAriaTime":"The session expires in {{overallSeconds}} seconds","dialogExpirationWarningAriaSessionExpired":"The session has expired"}),csui.define("csui/utils/expiration.warning/impl/minutes.view",["module","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/lib/handlebars"],function(e,t,i,n,o){"use strict";return n=n(e.id),i.ItemView.extend({"className":"csui-time-value-min-value","tagName":"span","modelEvents":{"change":"render"},"template":o.compile("{{timeValueMinutes}}"),"templateHelpers":function(){return{"timeValueMinutes":this.model.get("minutes")}},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.call(this,e)}})}),csui.define("csui/utils/expiration.warning/impl/seconds.view",["module","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/lib/handlebars"],function(e,t,i,n,o){"use strict";return n=n(e.id),i.ItemView.extend({"className":"csui-time-value-sec-value","tagName":"span","modelEvents":{"change":"render"},"template":o.compile("{{timeValueSeconds}}"),"templateHelpers":function(){return{"timeValueSeconds":this.model.get("seconds")}},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.call(this,e)}})}),csui.define("css!csui/utils/expiration.warning/impl/expiration.warning",[],function(){}),csui.define("csui/utils/expiration.warning/impl/expiration.warning.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","csui/utils/base","hbs!csui/utils/expiration.warning/impl/expiration.warning","i18n!csui/utils/expiration.warning/impl/nls/lang","csui/utils/log","csui/utils/expiration.warning/impl/minutes.view","csui/utils/expiration.warning/impl/seconds.view","csui/lib/handlebars","css!csui/utils/expiration.warning/impl/expiration.warning"],function(e,t,i,n,o,s,r,l,a,c,u,d){"use strict";a=a(e.id);var h=o.Model.extend({"defaults":{"initTime":Date.now(),"timer":-1,"minutes":0,"seconds":0}});return n.LayoutView.extend({"className":"csui-expiration-warning","template":r,"templateHelpers":function(){return{"isExpirationWarningContent":!0,"warningText":l.dialogExpirationWarningText,"msgId":t.uniqueId("msg")}},"regions":{"timeValueMinRegion":"span.csui-time-value-min","timeValueSecRegion":"span.csui-time-value-sec"},"constructor":function(e){if(e||(e={}),this.authenticator=e.authenticator,this.shouldDisplayExpirationWarning=e.shouldDisplayExpirationWarning,this.UserSession=e.userSession,this.startTime=e.startTime,this.timerId=void 0,this.isFinished=!1,this.timeAriaTemplate=d.compile(l.dialogExpirationWarningAriaTime),e.model=this._createModel(),n.LayoutView.prototype.constructor.call(this,e),s.isIE11()){var t=this,o=function(){t.render()};i(window).on("resize",o),this.once("before:destroy",function(){i(window).off("resize",o)})}this._createTimer()},"_createModel":function(){var e=this._getReactionDuration(),t=this._getMinutesSeconds(e);return new h({"timer":e,"minutes":t.minutes,"seconds":t.seconds})},"_updateAriaTimeLabel":function(e){var t;e<=0?(t=l.dialogExpirationWarningAriaSessionExpired,document.getElementById("csui-expiration-timer-live").setAttribute("aria-label",t)):e%10==0&&(t=this.timeAriaTemplate({"overallSeconds":e}),document.getElementById("csui-expiration-timer-live").setAttribute("aria-label",t))},"_createTimer":function(){var e=this.model.get("timer"),t=this;t.model.set({"initTime":Date.now()},{"silent":!0});var i=t.model.get("initTime")+1e3*e;this.isFinished=!1,a.info("expiration.warning.view: _createTimer: used sessionReactionTime: "+t._getReactionDuration()+" (Date: "+t.UserSession.currentDateUTC()+").")&&console.log(a.last),this.timerId=setInterval(function(){var e=t.model.get("timer");if(--e<0&&(e=0,t._clearWarningTimer(),a.info("expiration.warning.view: _createTimer: Expiration warning timeout expired, session timed out (Date: "+t.UserSession.currentDateUTC()+").")&&console.log(a.last),t._updateAriaTimeLabel(e),t.UserSession.performSessionExpired(t.authenticator,!1),t.isFinished=!0),!t.isFinished){var n=Date.now(),o=(i-n+500)/1e3;o<e&&o>0&&(a.info("expiration.warning.view: _createTimer: Adjusting timer value to actual time, using: "+o+"(currentTimer was: "+e+")")&&console.log(a.last),e=o),a.debug("expiration.warning.view: _createTimer: Setting timer in model to "+e)&&console.log(a.last);var s=t._getMinutesSeconds(e);t.model.set({"timer":e,"minutes":s.minutes,"seconds":s.seconds}),t._updateAriaTimeLabel(e),a.debug("expiration.warning.view: _createTimer: Expected end time in ms: "+i+" (current: "+n+", diff: "+(i-n)+")")&&console.log(a.last)}},1e3)},"onClearTimer":function(){a.debug("expiration.warning.view: onClearTimer: clearing view timer...")&&console.log(a.last),this._clearWarningTimer()},"onBeforeDestroy":function(){this._clearWarningTimer()},"_clearWarningTimer":function(){this.timerId&&(clearInterval(this.timerId),this.timerId=void 0)},"_getReactionDuration":function(){var e=void 0!==this.startTime?this.startTime:this.UserSession.getSessionReactionTime()/1e3-1;return e<0&&(e=0),e},"_getMinutesSeconds":function(e){var t,i;return t=parseInt(e/60,10),i=parseInt(e%60,10),t=t<10?"0"+t:t,i=i<10?"0"+i:i,{"minutes":t,"seconds":i}},"onRender":function(){if(this.shouldDisplayExpirationWarning&&!this.isFinished&&this.isRendered){var e=new c({"model":this.model}),t=new u({"model":this.model});this.showChildView("timeValueMinRegion",e),this.showChildView("timeValueSecRegion",t)}},"onKeyInView":function(e){32!==e.keyCode&&13!==e.keyCode||(e.preventDefault(),e.stopPropagation(),i(e.target).trigger("click"))}})}),csui.define("csui/utils/expiration.warning/expiration.warning.dialog",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/expiration.warning/impl/expiration.warning.view","csui/dialogs/modal.alert/modal.alert","i18n!csui/utils/expiration.warning/impl/nls/lang","csui/utils/log","css!csui/utils/expiration.warning/impl/expiration.warning"],function(e,t,i,n,o,s,r,l){"use strict";function a(e){var i=[];!0===e?(i.push({"showYes":!0,"labelYes":r.dialogExpirationWarningButtonContinueSession,"tooltipYes":r.dialogExpirationWarningButtonContinueSessionTooltip,"ariaYes":r.dialogExpirationWarningButtonContinueSessionAria,"clickYes":function(e){var i=t.extend({"dialogOptions":h},{"dialog":e});!0===i.dialogOptions.authenticator.isAuthenticated()&&i.dialogOptions.cbClearExpirationTimer(),i.dialog&&!i.dialog.isDestroyed&&i.dialog.updateButtons({"disableYes":!0,"disableNo":!0}),l.info("expiration.warning.dialog: User continued session, performing REST-call (Date: "+i.dialogOptions.userSession.currentDateUTC()+").")&&console.log(l.last),i.dialogOptions.userSession.continueSession(i.dialogOptions.authenticator)}}),i.push({"showNo":!0,"labelNo":r.dialogExpirationWarningButtonTerminateSession,"tooltipNo":r.dialogExpirationWarningButtonTerminateSessionTooltip,"ariaNo":r.dialogExpirationWarningButtonTerminateSessionAria,"clickNo":function(e){var i=t.extend({"dialogOptions":h},{"dialog":e});i.dialogOptions.cbClearExpirationTimer(),i.dialog&&!i.dialog.isDestroyed&&i.dialog.updateButtons({"disableNo":!0,"disableYes":!0}),l.info("expiration.warning.dialog: User terminated session, performing signOut (Date: "+i.dialogOptions.userSession.currentDateUTC()+").")&&console.log(l.last),i.dialogOptions.userSession.signOut(i.dialogOptions.authenticator)}})):i.push({"showYes":!0,"labelYes":r.dialogExpirationWarningButtonLeave,"tooltipYes":r.dialogExpirationWarningButtonLeaveTooltip,"ariaYes":r.dialogExpirationWarningButtonLeaveAria,"clickYes":function(e){var i=t.extend({"dialogOptions":h},{"dialog":e});i.dialogOptions.cbClearExpirationTimer(),
i.dialog&&!i.dialog.isDestroyed&&i.dialog.updateButtons({"disableYes":!0}),l.info("expiration.warning.dialog: Redirecting to target page...'")&&console.log(l.last),i.dialogOptions.userSession.redirectToTargetPage(i.dialogOptions.authenticator)}});var n,o=i.length,s={"showYes":!1,"showNo":!1,"showCancel":!1};for(n=0;n<o;n++)s=t.extend(s,i[n]);return s}function c(e){return e||(e={}),this.UserSession=e.userSession,this.authenticator=e.authenticator,this.authenticator||l.error("expiration.warning.dialog: showExpirationWarningDialog: Given authenticator is 'undefined'!")&&console.error(l.last),this.shouldDisplayExpirationWarning=!(!e.startWithWarningContent||!0!==e.startWithWarningContent),this.cbClearExpirationTimer=e.clearExpirationTimer,this.startTime=e.startTime,this.buttonsData=a(this.shouldDisplayExpirationWarning),h={"userSession":this.UserSession,"authenticator":this.authenticator,"shouldDisplayExpirationWarning":this.shouldDisplayExpirationWarning,"startTime":this.startTime,"cbClearExpirationTimer":this.cbClearExpirationTimer,"buttonsData":this.buttonsData},d(h)}function u(e){var t=this,n=i.Deferred();return e.show().then(function(i){t.buttonsData.clickYes(e),n.resolve(i)},function(i){t.buttonsData.clickNo(e),n.reject(i)}),n.promise()}function d(e){return new s(t.defaults({"dialogSize":p},{"bodyView":o,"bodyViewOptions":{"userSession":e.userSession,"authenticator":e.authenticator,"startTime":e.startTime,"shouldDisplayExpirationWarning":e.shouldDisplayExpirationWarning},"title":r.dialogExpirationWarningTitle,"showTitleCloseButton":!1,"staticBackdrop":!0,"closeWithEsc":!1,"buttons":e.buttonsData},s.defaultOptions.Warning))}l=l(e.id);var h,p="md";return{"createExpirationWarningDialog":c,"showExpirationWarningDialog":u}}),csui.define("json!csui/utils/commands/open.types.json",{"mimeTypesForOpen":["application/atom+xml","application/font-woff","application/javascript","application/json","application/mathml+xml","application/ogg","application/pdf","application/postscript","application/rdf+xml","application/rss+xml","application/vnd.mozilla.xul+xml","application/xhtml+xml","application/xml","application/x-shockwave-flash","audio/3gpp","audio/3gpp2","audio/aac","audio/aiff","audio/amr","audio/basic","audio/flac","audio/midi","audio/mp3","audio/mp4","audio/mpeg","audio/mpeg3","audio/ogg","audio/vorbis","audio/wav","audio/webm","audio/x-m4a","audio/x-ms-wma","audio/x-wav","audio/vnd.rn-realaudio","audio/vnd.wave","image/bmp","image/cis-cod","image/gif","image/ief","image/jpeg","image/webp","image/pict","image/pipeg","image/png","image/svg+xml","image/tiff","image/vnd.microsoft.icon","image/webp","image/x-cmu-raster","image/x-cmx","image/x-icon","image/x-portable-anymap","image/x-portable-bitmap","image/x-portable-graymap","image/x-portable-pixmap","image/x-rgb","image/x-xbitmap","image/x-xpixmap","image/x-xwindowdump","message/rfc822","multipart/related","multipart/x-mixed-replace","text/css","text/html","text/plain","text/xml","video/3gpp","video/3gpp2","video/avi","video/divx","video/flc","video/mp4","video/mpeg","video/ogg","video/quicktime","video/sd-video","video/webm","video/x-dv","video/x-m4v","video/x-mpeg","video/x-ms-asf","video/x-ms-wmv","video/x-msvideo"],"officeMimeTypes":["application/msword","application/vnd.ms-word","application/vnd.msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.wordprocessing-openxml","application/vnd.ces-quickword","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.document.12","application/mspowerpoint","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.ces-quickpoint","application/vnd.presentation-openxml","application/vnd.presentation-openxmlm","application/vnd.ms-powerpoint.presentation.macroEnabled.12","application/msexcel","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ces-quicksheet","application/vnd.spreadsheet-openxml","application/vnd.ms-excel.sheet.macroEnabled.12","text/csv"]}),csui.define("csui/utils/commands/open.plugins/impl/csv.plugin",["csui/lib/underscore","csui/lib/jquery","csui/models/version"],function(e,t,i){"use strict";function n(){}var o=window.csui.requirejs.s.contexts._.config.config["csui/utils/commands/open"]||{};return o=e.extend({"CSViewerIsAvailable":!1,"CSViewerSupportedMimeTypes":[],"csViewerView":"csv/widgets/csviewer/csviewer.view"},o),o.CSViewerSupportedMimeTypes=e.invoke(o.CSViewerSupportedMimeTypes,"toLowerCase"),n.prototype.widgetView=o.csViewerView,n.prototype.getUrlQuery=function(e){var n={"func":"doc.ViewDoc","nodeid":e.get("id")};return e instanceof i&&(n.vernum=e.get("version_number")),t.Deferred().resolve(n).promise()},n.prototype.needsAuthentication=function(e){return!0},n.isSupported=function(e){var t=e.get("mime_type");return t&&o.CSViewerIsAvailable&&o.CSViewerSupportedMimeTypes.indexOf(t.toLowerCase())>=0},n}),csui.define("csui/utils/commands/open.plugins/impl/browser.plugin",["csui/lib/underscore","csui/lib/jquery","csui/utils/base","json!csui/utils/commands/open.types.json","csui/utils/content.helper"],function(e,t,i,n,o){"use strict";function s(){}function r(e){var n,s=(e.get("mime_type")||"").toLowerCase();!i.isAppleMobile()&&l.officeMimeTypes.indexOf(s)>=0&&(n=!0);var r=o.getContentPageUrl(e,{"download":!!n});return t.Deferred().resolve(r).promise()}var l=window.csui.requirejs.s.contexts._.config.config["csui/utils/commands/open"]||{},a=e.chain(navigator.plugins||[]).map(function(t){return e.chain(t).map(function(e){return e.type}).value()}).flatten().compact().invoke("toLowerCase").value();return l=e.extend({"mimeTypesForOpen":n.mimeTypesForOpen,"officeMimeTypes":n.officeMimeTypes,"forceDownloadForMimeTypes":[],"forceDownloadForAll":!1},l),l.mimeTypesForOpen=e.invoke(l.mimeTypesForOpen,"toLowerCase"),l.officeMimeTypes=e.invoke(l.officeMimeTypes,"toLowerCase"),l.forceDownloadForMimeTypes=e.invoke(l.forceDownloadForMimeTypes,"toLowerCase"),l.mimeTypesForOpen=e.chain(l.mimeTypesForOpen).concat(a).unique().invoke("toLowerCase").value(),s.prototype.getUrl=function(e){return r(e)},s.isSupported=function(e){var t=e.get("mime_type");if(t)return t=t.toLowerCase(),i.isAppleMobile()||l.mimeTypesForOpen.indexOf(t)>=0&&l.forceDownloadForMimeTypes.indexOf(t)<0&&!l.forceDownloadForAll},s.prototype.needsAuthentication=function(e){return!0},s}),csui.define("csui/utils/commands/open.plugins/impl/core.open.plugins",["csui/utils/commands/open.plugins/impl/brava.plugin","csui/utils/commands/open.plugins/impl/csv.plugin","csui/utils/commands/open.plugins/impl/browser.plugin"],function(e,t,i){"use strict";return[{"sequence":200,"plugin":e,"decides":e.isSupported},{"sequence":400,"plugin":t,"decides":t.isSupported},{"sequence":600,"plugin":i,"decides":i.isSupported}]}),csui.define("csui/utils/contexts/factories/search.results.factory",["require","module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/search.query.factory","csui/models/widget/search.results/search.results.model","csui/utils/commands","csui/utils/base"],function(e,t,i,n,o,s,r,l,a,c){return o.extend({"propertyPrefix":"searchResults","constructor":function(e,r){o.prototype.constructor.apply(this,arguments);var c=this.options.searchResults||{};if(!(c instanceof n.Collection)){var u=e.getObject(s,r),d=r.searchResults.query,h=t.config();c=new l(c.models,i.extend({"connector":u,"query":d,"stateEnabled":!0,"commands":a.getAllSignatures()},c.options,h.options,{"autofetch":!0,"autoreset":!0}))}this.property=c},"isFetchable":function(){return this.property.isFetchable()},"fetch":function(e){!this.property.fetched&&this.property.fetch({"success":i.bind(this._onSearchResultsFetched,this,e),"error":i.bind(this._onSearchResultsFailed,this,e)})},"_onSearchResultsFetched":function(e){return!0},"_onSearchResultsFailed":function(e,t,i){var n=new c.RequestErrorMessage(i);csui.require(["csui/dialogs/modal.alert/modal.alert"],function(e){e.showError(n.toString())})}},{"getDefaultResourceScope":function(){return i.deepClone({"commands":a.getAllSignatures()})}})}),csui.define("hbs!csui/controls/signin/impl/signin",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="login-container">\r\n  <div class="login-controls">\r\n    <div class="branding"><span role="presentation" class="ot-logo">&nbsp;</span></div>\r\n    <div class="login-error" id="loginError"></div>\r\n    <div class="login-form-wrapper">\r\n      <form>\r\n        <div class="binf-form-group binf-has-feedback">\r\n          <div class="col-md-20">\r\n            <input id="inputUsername" type="text" class="binf-form-control binf-input-lg textbox hasclear"\r\n                   placeholder="'+e.escapeExpression((s=null!=(s=r(i,"placeholderusername")||(null!=t?r(t,"placeholderusername"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"placeholderusername","hash":{},"loc":{"start":{"line":10,"column":32},"end":{"line":10,"column":55}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=r(i,"userNameAria")||(null!=t?r(t,"userNameAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"userNameAria","hash":{},"loc":{"start":{"line":10,"column":69},"end":{"line":10,"column":85}}}):s))+'">\r\n              <span id="usernameclearer" class="clearer clear-icon binf-form-control-feedback"></span>\r\n\r\n          </div>\r\n        </div>\r\n        <div class="binf-form-group binf-has-feedback">\r\n          <div class="col-md-20">\r\n            <input id="inputPassword" type="password"\r\n                   class="binf-form-control binf-input-lg textbox hasclear"\r\n                   placeholder="'+e.escapeExpression((s=null!=(s=r(i,"placeholderpassword")||(null!=t?r(t,"placeholderpassword"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"placeholderpassword","hash":{},"loc":{"start":{"line":19,"column":32},"end":{"line":19,"column":55}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=r(i,"passwordAria")||(null!=t?r(t,"passwordAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"passwordAria","hash":{},"loc":{"start":{"line":19,"column":69},"end":{"line":19,"column":85}}}):s))+'">\r\n              <span id="passwordclearer" class="clearer clear-icon binf-form-control-feedback"></span>\r\n          </div>\r\n        </div>\r\n        <button id="buttonSubmit" type="button" class="login-btn">'+e.escapeExpression((s=null!=(s=r(i,"buttontext")||(null!=t?r(t,"buttontext"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"buttontext","hash":{},"loc":{"start":{"line":23,"column":66},"end":{"line":23,"column":80}}}):s))+"</button>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</div>\r\n"}});return i.registerPartial("csui_controls_signin_impl_signin",n),n}),csui.define("csui/controls/signin/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/controls/signin/impl/nls/root/localized.strings",{"signinButtonText":"Sign in","signinForgotPassword":"Forgot password?","signinPlaceholderUsername":"User name","usernameAria":"Enter user name","signinPlaceholderPassword":"Password","passwordAria":"Enter password","signinInvalidUsernameOrPassword":"You have entered an invalid user name or password. Please try again."}),csui.define("css!csui/controls/signin/impl/css/signin",[],function(){}),csui.define("csui/controls/signin/signin.view",["module","csui/lib/underscore","csui/lib/jquery","csui/utils/authenticators/basic.authenticator","csui/utils/authenticators/credentials.authenticator","csui/utils/contexts/page/page.context","csui/utils/connector","csui/utils/contexts/factories/connector","csui/lib/marionette","hbs!csui/controls/signin/impl/signin","i18n!csui/controls/signin/impl/nls/localized.strings","css!csui/controls/signin/impl/css/signin"],function(e,t,i,n,o,s,r,l,a,c,u){"use strict";var d=t.extend({"useBasicAuthentication":!1},e.config());return a.ItemView.extend({"constructor":function(){a.ItemView.apply(this,arguments)},"className":"cs-signin","template":c,"triggers":{"click button":"click:button","mousedown @ui.usernameclearer":"click:usernameclearer","mousedown @ui.passwordclearer":"click:passwordclearer","focus @ui.username":"focus:username","focus @ui.password":"focus:password","change @ui.password":"change:password","change @ui.username":"change:username"},"ui":{"username":"#inputUsername","password":"#inputPassword","button":"#buttonSubmit","passwordclearer":"#passwordclearer","usernameclearer":"#usernameclearer","loginerror":"#loginError"},"onRender":function(){this.ui.usernameclearer.toggle(!1),this.ui.passwordclearer.toggle(!1),this.ui.username.prop("autofocus",!0)},"onClickPasswordclearer":function(e){this.ui.password.val("").trigger("focus"),this._unsetErrorStyle(),this.ui.passwordclearer.hide()},"onClickUsernameclearer":function(e){this.ui.username.val("").trigger("focus"),this._unsetErrorStyle(),this.ui.usernameclearer.hide()},"onFocusUsername":function(){this.validate()},"onFocusPassword":function(){this.validate()},"onChangeUsername":function(){this.validate()},"onChangePassword":function(){this.validate()},"templateHelpers":function(){return{"buttontext":u.signinButtonText,"copyright":u.signinCopyright,"forgotpassword":u.signinForgotPassword,"placeholderusername":u.signinPlaceholderUsername,"usernameAria":u.usernameAria,"placeholderpassword":u.signinPlaceholderPassword,"passwordAria":u.passwordAria}},"events":{"keyup .binf-form-control":"validate","keydown button":"onKeyPress"},"onKeyPress":function(e){this.ui.button.prop("disabled")||13!==e.which||this.ui.button.toggleClass("login-btn-enabled")},"validate":function(e){this._unsetErrorStyle();var t=!!this.ui.username.val().length,n=t&&!0,o=i(document.activeElement).is(this.ui.username),s=i(document.activeElement).is(this.ui.password);this.ui.usernameclearer.toggle(t&&o),this.ui.passwordclearer.toggle(s),this.ui.button.prop("disabled",!n),this.ui.button.toggleClass("login-btn-enabled",n),n&&e&&13===e.which&&(e.preventDefault(),this.ui.button.trigger("click"))},"onClickButton":function(){this.ui.button.toggleClass("login-btn-enabled",!1);var e={"username":this.ui.username.val(),"password":this.ui.password.val()},i=d.useBasicAuthentication;if(!this.authenticator){var r=t.defaults({"credentials":e},this.options.connection),a=i?n:o,c=new a({"connection":r}).on("loggedIn",t.bind(function(){this.ui.button.toggleClass("login-btn-enabled",!0),this.trigger("success",{"username":e.username,"session":r.session})},this));this.authenticator=c}var u=t.bind(function(){var e=new s,t=e.getObject(l),i=this.authenticator.connection.session;t.authenticator.updateAuthenticatedSession(i)},this),h=t.bind(function(t,i){this.ui.button.toggleClass("login-btn-enabled",!0),this._setErrorStyle(),this.trigger("failure",{"username":e.username,"error":t})},this);i?this.authenticator.check({"credentials":e},u,h):this.authenticator.login({"data":e},u,h)},"_setErrorStyle":function(){this.ui.username.trigger("focus").trigger("select"),this.ui.password.val(""),this.ui.usernameclearer.toggle(!0),this.ui.passwordclearer.toggle(!0),this.ui.loginerror.html(u.signinInvalidUsernameOrPassword),this.$(".binf-form-group").addClass("binf-has-error"),this.$(".clearer").removeClass("clear-icon").addClass("error-icon")},"_unsetErrorStyle":function(){this.ui.loginerror.html(""),this.$(".binf-form-group").removeClass("binf-has-error"),this.$(".clearer").removeClass("error-icon").addClass("clear-icon")}})}),csui.define("hbs!csui/utils/impl/signin.dialog/signin",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="csui-signin binf-modal">\r\n  <div class="binf-modal-dialog">\r\n    <div class="binf-modal-content"></div>\r\n  </div>\r\n</div>'}});return i.registerPartial("csui_utils_impl_signin.dialog_signin",n),n}),csui.define("css!csui/utils/impl/signin.dialog/signin",[],function(){}),csui.define("csui/utils/impl/signin.dialog/signin.dialog",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/controls/signin/signin.view","hbs!csui/utils/impl/signin.dialog/signin","css!csui/utils/impl/signin.dialog/signin","csui/lib/binf/js/binf"],function(e,t,i,n,o){"use strict";function s(e){this.connection=e.connection}return e.extend(s.prototype,{"show":function(){var e=t.Deferred(),s=t.fn.binf_modal.getDefaultContainer(),r=t(o()).appendTo(s),l=new i.Region({"el":r.find(".binf-modal-content")[0]}),a=new n({"connection":this.connection});return a.on("success",function(t){r.binf_modal("hide"),e.resolve(t)}),l.show(a),r.on("shown.binf.modal",function(){a.triggerMethod("dom:refresh")}).on("hidden.binf.modal",function(){a.destroy()}).binf_modal({"backdrop":"static","keyboard":!1}),e.promise()}}),s}),csui.define("csui/utils/toolitem.masks/global.toolitems.mask",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask"],function(e,t,i){"use strict";return i.extend({"constructor":function(){i.prototype.constructor.apply(this);var n=e.config();t.each(n,function(e,t){this.extendMask(e)},this),this.storeMask()}})}),csui.define("css!csui/controls/form/impl/form",[],function(){}),csui.define("csui/models/form",["csui/lib/underscore","csui/lib/backbone","csui/lib/jsonpath"],function(e,t,i){"use strict";var n=t.Model.extend({"constructor":function(e,i){this.options=i||(i={}),t.Model.prototype.constructor.call(this,e,i)},"getValue":function(e){var t=this.get("data");return t=t&&e?n.getValueOnPath(t,e):null},"setValue":function(e,t){var i=this.get("data");return i=i&&e?n.setValueOnPath(i,e,t):null}},{"getValueOnPath":function(e,t){return t&&(t=t.replace(/^\//,"$.").replace(/\//,"."),e=i(e,t),e=e?e[0]:null),e},"setValueOnPath":function(e,t,n){if(t){var o=t.replace(/^.*\/([^\/]+)$/,"$1"),s=o.indexOf("[")>0?o.replace(/^.*\[(\d+)\]$/,"$1"):void 0;void 0!==s?(t=t.replace(/^(.*)\[[^\]]\]+$/,"$1").replace(/^\//,"$.").replace(/\//,"."),e=i(e,t),e?(e=e[0],e[parseInt(s,10)]=n):e=null):(t=t.replace(/^(.*)\/[^\/]+$/,"$1").replace(/^\//,"$.").replace(/\//,"."),t&&"/"!==t&&(e=i(e,t))&&(e=e[0]),e?e[o]=n:e=null)}return e},"pluckPrimitiveFields":function(t){function i(t,o){return e.reduce(e.keys(t),function(o,s){var r=t[s];return e.isArray(r)?o[s]=n(r):e.isObject(r)?o=i(r,o):o[s]=r,o},o||{},this)}function n(t){return e.map(t,function(t){return e.isArray(t)?n(t):e.isObject(t)?i(t):t})}return i(t)}});return n}),csui.define("csui/models/appliedcategoryform",["csui/lib/underscore","csui/utils/url","csui/models/form","csui/models/mixins/node.connectable/node.connectable.mixin"],function(e,t,i,n){"use strict";var o=i.extend({"constructor":function(e,t){i.prototype.constructor.call(this,e,t),this.makeNodeConnectable(t),t&&(this.action=this.options.action,this.categoryId=this.options.categoryId)},"clone":function(){return new this.constructor(this.attributes,{"node":this.node,"action":this.action,"categoryId":this.categoryId})},"url":function(){var i=e.str.sformat("forms/nodes/categories/{0}?id={1}&category_id={2}",this.action,this.node.get("id"),this.categoryId);return t.combine(this.connector.connection.url,i)},"parse":function(t,i){var n=e.extend({"data":{},"schema":{},"options":{}},t.form||t.forms&&t.forms[0]||t),s=n.title||this.get("title");n.options=e.omit(n.options,"form"),void 0===n.schema.title&&(n.schema.title=s),n.title||(n.title=s),void 0===n.role_name&&(n.role_name="categories");var r=n.categoryId||i&&i.categoryId||this.categoryId;return r&&o.updateInternalProperties(r,n),n}},{"updateInternalProperties":function(e,t){var i=t.data,n=t.schema,o=t.options,s=e+"_1",r=i[s]||{},l=Object.keys(r),a=n.properties&&n.properties[s];a&&(a.readonly=!1,a=a.properties||(a.properties={}),Object.keys(a).forEach(function(e){a[e].readonly="metadata_token"!==e}),l.forEach(function(e){a[e]||(a[e]={"readonly":"metadata_token"!==e})}));var c=o.fields&&o.fields[s];c&&(c.hidden=!0,c=c.fields||(c.fields={}),Object.keys(c).forEach(function(e){c[e].hidden=!0}),l.forEach(function(e){c[e]||(c[e]={"hidden":!0})}))}});return n.mixin(o.prototype),o}),csui.define("csui/widgets/metadata/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/widgets/metadata/impl/nls/root/lang",{"metadataRegionAria":"Metadata content","properties":"Properties","versions":"Versions","general":"General","audit":"Audit","releases":"Releases","MenuItemRename":"Rename","MenuItemEdit":"Edit","MenuItemCopy":"Copy","MenuItemMove":"Move","MenuItemDownload":"Download","MenuItemReserve":"Reserve","MenuItemUnreserve":"Unreserve","MenuItemAddVersion":"Add version","MenuItemDelete":"Delete","addItemMetadataDialogButtonAddTitle":"Add","addItemMetadataDialogButtonUploadTitle":"Upload","addItemMetadataDialogButtonCancelTitle":"Cancel","addItemMetadataDialogTitle1":"Add {0}","addItemMetadataDialogTitleGeneric":"Item","addDocumentMetadataDialogTitle":"Upload file","addFolderMetadataDialogTitle":"Upload folder","addDocumentsMetadataDialogTitle":"Upload files","addFoldersMetadataDialogTitle":"Upload folders","addItemsMetadataDialogTitle":"Upload items","addDocumentMetadataDialogAddButtonTitle":"Upload","addItemPlaceHolderName":"Enter name","emptyObjectNameAria":"Object name","itemTitleAria":"{0}, click to edit","editNameTooltip":"Edit name","saveEditNameTooltip":"Save","cancelEditNameTooltip":"Cancel","failedToSaveName":"Failed to save name.","failedToCreateItem":"Failed to create the new item.","failedToValidateForms":"Failed to validate all Forms.  Please check that all required fields are entered.","switchLanguageTooltip":"Switch language","gotoPreviousCategoryTooltip":"Show previous Category","gotoNextCategoryTooltip":"Show next Category","addNewProperties":"Add properties","addNewCategory":"Add a new Category","addNewCategoryDialogTitle":"Add Category","addNewCategoryDialogAddButtonTitle":"Add","removeCategoryTooltip":"Remove this Category","removeCategoryWarningTitle":"Remove Category","removeCategoryWarningMessage":'Do you want to remove Category "{0}"?',"removeCategoryFailMessageTitle":"Remove Category Failed","removeCategoryFailMessage":'Failed to remove Category "{0}". \n\n{1}',"getPropertyPanelsFailTitle":"Error Loading Properties","getCategoryActionsFailTitle":"Get Category Actions","getCategoryActionsFailMessage":'Failed to get Category actions for node "{0}". \n\n{1}',"getActionsForACategoryFailMessage":'Failed to get actions for Category "{0}" of node "{1}". \n\n{2}',"addNewCategoryFailTitle":"Add Category to node","addNewCategoryFailMessage":'Failed to add Category "{0}" to node "{1}" with node ID "{2}". \n\n{3}',"categoryExistsMessage":'Error: Category "{0}" already exists.',"loadNewCategoryFailTitle":"Get new Category Form","loadNewCategoryFailMessage":'Failed to get Form for Category "{0}" on node "{1}" with node ID "{2}". \n\n{3}',"selectCategoryTitle":"Select a Category to add","selectCategoryButtonLabel":"Add","viewShortcutMessage":"View shortcut","viewOriginalMessage":"View original","shortcutLocationLabel":"Original location","closeMetadataButtonTooltip":"Close metadata","formValidationErrorMessage":"Required fields must be filled","hideValidationErrorMessageIconTooltip":"Hide validation error","missingRequiredMetadataForDocuments":"Missing required metadata for some document(s).","goBackTooltip":"Go back","onlyRequiredFieldsLabel":"Only required fields (*)","defaultDialogTitle":"Metadata","defaultDialogOkButtonTitle":"OK","defaultDialogCancelButtonTitle":"Cancel","moveOneItemMetadataDialogTitle":"Move {0} item","moveMultipleItemsMetadataDialogTitle":"Move {0} items","moveItemsMetadataDialogButtonTitle":"Move","copyOneItemMetadataDialogTitle":"Copy {0} item","copyMultipleItemsMetadataDialogTitle":"Copy {0} items","copyItemsMetadataDialogButtonTitle":"Copy","missingRequiredMetadataForObjects":"Missing required metadata for some object(s).","inheritanceOriginalProperties":"with original properties","inheritanceDestinationProperties":"with destination properties","inheritanceMergedProperties":"with combined properties","requiredTooltip":"Required","requiredPassedTooltip":"Required fields satisfied.","restructureOneItemMetadataDialogTitle":"Restructure {0} item","restructureMultipleItemsMetadataDialogTitle":"Restructure {0} items","restructureItemsMetadataDialogButtonTitle":"Restructure","ToolbarItemVersionInfo":"Properties","ToolbarItemVersionDelete":"Delete","ToolbarItemPromoteVersion":"Promote to major","ToolbarItemVersionPurgeAll":"Purge all previous Versions","ToolbarItemVersionDownload":"Download","ToolbarItemDocVersionPreview":"View","ToolbarItemCopyLink":"Copy link","ToolbarItemEmailLink":"Mail as link","ToolbarItemMore":"More actions","versionColumnSizeTitle":"Size","versionColumnVersionNumberTitle":"Version","openDoc":"Open {0}","openDocAria":"Open {0} {1}","versionNumInBrowserTitle":"Version {0}","docPreviewAlt":"Document Preview","versionTableAria":"Versions of {0}","action":"Action","date":"Date","user":"User","auditNoResultsPlaceholder":"No results found","auditTableAria":"Audit events of {0}","release":"Release","created":"Created","createdBy":"Created By","releasesNoResultsPlaceholder":"There are no releases available for this compound document.","releasesTableAria":"Releases of {0}","formFieldItemIdLabel":"Item ID","formFieldSizeLabel":"Size","formFieldTypeLabel":"Type","formFieldReservedStatusLabel":"Status","formFieldReservedByLabel":"Reserved by","UrlLabel":"Web address","UrlTitle":"Web address","alpacaPlaceholderNotAvailable":"n/a","alpacaPlaceholderUrl":"Add web address","alpacaPlaceholderOTNodePicker":"Select","alpacaPlaceholderDescription":"Add description","NoOwner":"<No Owner>","showMore":"Show more","showMoreAria":"Show more actions of {0}","collapse":"Hide item list","expand":"Show item list","permissionPage":"Permission Page of {0}"}),csui.define("csui/models/forms",["csui/lib/backbone","csui/models/form"],function(e,t){"use strict";return e.Collection.extend({"model":t,"constructor":function(t,i){this.options=i||(i={}),e.Collection.prototype.constructor.call(this,t,i)}})}),csui.define("csui/models/nodeforms",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/base","csui/models/forms","csui/models/mixins/node.resource/node.resource.mixin"],function(e,t,i,n,o,s,r,l){"use strict";var a=r.extend({"constructor":function(e,t){r.prototype.constructor.apply(this,arguments),this.makeNodeResource(t)},"parse":function(e){return e.forms}});return l.mixin(a.prototype),a}),csui.define("csui/models/nodecreateforms",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/base","csui/models/nodeforms","csui/models/node.createform/server.adaptor.mixin"],function(e,t,i,n,o,s,r,l){"use strict";var a=r.extend({"constructor":function(e,t){if(r.prototype.constructor.apply(this,arguments),this.type=t.type,this.docParentId=t.docParentId,void 0===this.type)throw new Error(this.ERR_CONSTRUCTOR_NO_TYPE_GIVEN)},"clone":function(){return new this.constructor(this.models,{"node":this.node,"type":this.type})}},{"ERR_CONSTRUCTOR_NO_TYPE_GIVEN":"No creation type given in constructor"});return i.extend(a,{"version":"1.0"}),l.mixin(a.prototype),a}),csui.define("csui/models/nodeupdateforms",["csui/lib/underscore","csui/models/node/node.model","csui/models/nodeforms","csui/models/form","csui/models/appliedcategoryform"],function(e,t,i,n,o){"use strict";function s(e,t){return"categories"===e.role_name?new o(e,t):new n(e,t)}return i.extend({"constructor":function(e,t){i.prototype.constructor.apply(this,arguments),this.makeNodeResource(t)},"model":s,"clone":function(){return new this.constructor(this.models,{"node":this.node})},"url":function(){return e.str.sformat("{0}/forms/nodes/update?id={1}",this.connector.connection.url,this.node.get("id"))},"parse":function(e){var t=[];return(e.forms||[]).forEach(this._parseForm.bind(this,t)),t},"_parseForm":function(e,t){"categories"===t.role_name?this._parseCategory(e,t):"systemattributes"===t.role_name?this.node.systemattributes=t:e.push(t)},"_parseCategory":function(e,i){var n=i.data||{},o=i.schema&&i.schema.properties||{},s=i.options&&i.options.fields||{};Object.keys(o).forEach(function(i){t.usesIntegerId&&(i=+i);var r=n[i]||{},l=o[i]||{},a=s[i]||{},c=l.title,u=!1!==a.removeable;e.push({"id":i,"name":c,"title":c,"data":r,"role_name":"categories","removeable":u,"allow_delete":u,"categoryId":i,"options":a,"schema":l})})}})}),csui.define("csui/widgets/metadata/metadata.forms/server.adaptor.mixin",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/base","csui/utils/url","csui/models/appliedcategories","csui/models/form","csui/models/appliedcategoryform","i18n!csui/widgets/metadata/impl/nls/lang","csui/models/nodecreateforms","csui/models/nodeupdateforms","csui/models/node/node.model","csui/models/version"],function(e,t,i,n,o,s,r,l,a,c,u,d,h,p){"use strict";var f={"makeServerAdaptor":function(e){return this},"sync":function(e,t,n){return"read"===e?"copy"===this.action||"move"===this.action||"restructure"===this.action?this._getMetadataCopyMoveItemForms(e,t,n):"create"===this.action||void 0===this.node.get("id")?this._getMetadataAddItemForms(e,t,n):this.node instanceof p?this._getMetadataVersionsForms(e,t,n):this._getMetadataForms(e,t,n):i.Collection.prototype.sync.apply(this,arguments)},"_getMetadataForms":function(e,i,n){i.trigger("request",i,void 0,n);var o=this.node,s=(o.get("type"),new d(void 0,{"node":o}));return s.fetch().then(t.bind(function(e,t,i){s.each(function(e){e.set("allow_delete",e.get("removeable"))}),this.options=n,this.forms=s.models,n.success&&n.success(this.forms,"success")},this)).fail(function(e,t,i){n.error&&n.error(e,t,i)})},"_getMetadataVersionsForms":function(i,n,o){n.trigger("request",n,void 0,o);var r=e.Deferred(),l=this.node,c=l.get("id"),u=l.get("version_number"),d=l.connector,p=s.combine(d.connection.url,"forms/nodes/versions/categories"),f={"url":p+"?"+e.param({"id":c,"version_number":u})};return d.makeAjaxCall(f).done(t.bind(function(e,i,n){var s=[],l=e.forms[0];if(l){void 0===this.roles&&(this.roles={}),void 0===this.roles.categories&&(this.roles.categories={});var c=t.keys(l.options.fields);t.each(c,function(e){var i=l.schema.properties[e].title,n=l.data[e],o=l.options.fields[e],r=l.schema.properties[e];h.usesIntegerId&&(e=parseInt(e));var c=new a({"id":e,"title":i,"allow_delete":!1,"removeable":!1},{"node":this.node,"categoryId":e,"action":"none"});s.push(c),c.set({"data":n,"options":o,"schema":t.omit(r,["description"]),"role_name":"categories","removeable":!1})},this)}o.success&&o.success(s,"success"),r.resolve()},this)).fail(function(){r.reject.apply(r,arguments)}),r.promise()},"_getMetadataAddItemForms":function(i,n,o){n.trigger("request",n,void 0,o);var s=this.node.get("data"),r=this.formCollection||new u(void 0,{"node":this.container,"docParentId":this.node.get("docParentId"),"type":this.node.get("type")}),l=this.node.get("forms")||void 0,a=this.node.get("xhr")||void 0;return l&&a?(l.forms[0].id="general",this._pushForms(l,s,o),this.fetching=!1,this.fetched=!0,e.Deferred().resolve()):r.fetch().then(t.bind(function(e,t,i){this._pushForms(e,s,o)},this)).fail(function(e,t,i){o.error&&o.error(e,t,i)})},"_pushForms":function(e,i,n){var o=[],s=this.node.get("name");void 0!==s&&(e.forms[0].data.name=s);var r=this.node.get("type");if(1===r){var a=this.node.get("original_id");void 0!==a&&(e.forms[0].data.original_id=a)}else if(140===r){var c=this.node.get("url");c&&c.length>0&&(e.forms[0].data.url=c)
}else if(144===r&&(void 0!==s&&(e.forms[0].data.file=s),i)){var u=e.forms[0].data;i.name&&(u.name=i.name),i.description&&(u.description=i.description),i.advanced_versioning&&(u.advanced_versioning=i.advanced_versioning)}t.each(e.forms,function(e){"categories"===e.role_name?this._pushCategoryForms(e,o,n):o.push(new l(e))},this),n.success&&n.success(o,"success")},"_pushCategoryForms":function(e,i,n){var o=this.node.get("data"),s=t.keys(e.options.fields);t.each(s,function(s){if(-1===t.indexOf(this.node.removedCategories,s)){var r=e.schema.properties[s].title,l=e.data[s];o&&o.roles&&o.roles.categories&&o.roles.categories[s]&&(l=t.extend(l,o.roles.categories[s]));var c=e.options.fields[s],u=t.omit(e.schema.properties[s],"description");h.usesIntegerId&&(s=parseInt(s));var d=!c||!1!==c.removeable,p=new a({"id":s,"title":r,"data":l,"options":c,"schema":u,"role_name":"categories","allow_delete":d,"removeable":d},{"node":this.node,"categoryId":s,"action":"none"});n.reset?i.push(p):this.add(p)}},this)},"_getMetadataCopyMoveItemForms":function(i,n,o){n.trigger("request",n,void 0,o);var s,r=e.Deferred(),l=this,c=this.node.get("id"),u=this.container.connector,d={"original":0,"destination":1,"merged":2};"copy"===l.action?s="/forms/nodes/copy":"move"===l.action?s="/forms/nodes/move":"restructure"===l.action&&(s="/forms/nodes/move");var p={"url":u.connection.url+s+"?"+e.param({"id":c,"parent_id":l.container.get("id"),"inheritance":d[l.inheritance]})};return u.makeAjaxCall(p).done(function(e,i,n){var s,c=[];if(e.forms.length>1&&(s=t.find(e.forms,function(e){return"categories"===e.role_name})),s){var u=s.role_name;void 0===l.roles&&(l.roles={}),void 0===l.roles[u]&&(l.roles[u]={});var d=l.node.get("data"),p={};d&&d.roles&&d.roles[u]&&(p=d.roles[u]);var f=t.keys(s.options.fields);t.each(f,function(e){if(-1===t.indexOf(l.node.removedCategories,e)){var i=s.schema.properties[e].title,n=s.data[e],o=s.options.fields[e],r=s.schema.properties[e],d=h.usesIntegerId?parseInt(e):e,f=!1!==o.removeable,m=new a({"id":d,"title":i,"removeable":f,"allow_delete":f},{"node":l.node,"categoryId":d,"action":"none"});c.push(m),!1===t.isEmpty(p[e])&&t.each(n,function(i,o){t.has(p[e],o)&&(n[o]=p[e][o])}),m.set({"data":n,"options":o,"schema":t.omit(r,["description"]),"role_name":u})}})}o.success&&o.success(c,"success"),r.resolve()}).fail(function(e,t,i){o.error&&o.error(e,t,i),r.reject.apply(r,arguments)}),r.promise()}};return{"mixin":function(e){return t.extend(e,f)}}}),csui.define("csui/widgets/metadata/metadata.forms",["csui/lib/backbone","csui/utils/log","csui/models/mixins/node.connectable/node.connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/widgets/metadata/metadata.forms/server.adaptor.mixin"],function(e,t,i,n,o){"use strict";var s=e.Collection.extend({"constructor":function(t,i){i||(i={}),this.action=i.action,this.inheritance=i.inheritance,this.container=i.container,this.formCollection=i.formCollection,e.Collection.prototype.constructor.apply(this,arguments),this.makeNodeConnectable(i).makeFetchable(i).makeServerAdaptor(i)}});return i.mixin(s.prototype),n.mixin(s.prototype),o.mixin(s.prototype),s}),csui.define("csui/widgets/search.results/controls/sorting/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/widgets/search.results/controls/sorting/impl/nls/root/localized.strings",{"sortBy":"Sort by...","sortByThis":"Sort by {0}","sortOptionsAria":"Sort options","ascending":"{0}: Click to sort ascending","descending":"{0}: Click to sort descending"}),csui.define("hbs!csui/widgets/search.results/controls/sorting/impl/sort.menu",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="csui-search-sort-options ">\r\n    <button id="'+e.escapeExpression((s=null!=(s=r(i,"id")||(null!=t?r(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":3,"column":16},"end":{"line":3,"column":22}}}):s))+'" type="button" class="binf-btn binf-btn-default binf-dropdown-toggle"\r\n            data-binf-toggle="dropdown" aria-haspopup="true" aria-expanded="false" aria-label="'+e.escapeExpression((s=null!=(s=r(i,"sortButtonAria")||(null!=t?r(t,"sortButtonAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"sortButtonAria","hash":{},"loc":{"start":{"line":4,"column":95},"end":{"line":4,"column":113}}}):s))+'">\r\n      <span class="cs-label">'+e.escapeExpression((s=null!=(s=r(i,"title")||(null!=t?r(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":5,"column":29},"end":{"line":5,"column":38}}}):s))+'</span>\r\n      <span class="cs-icon icon-caret-down"></span>\r\n    </button>\r\n    <ul class="binf-dropdown-menu" role="menu" aria-label="'+e.escapeExpression((s=null!=(s=r(i,"listAria")||(null!=t?r(t,"listAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"listAria","hash":{},"loc":{"start":{"line":8,"column":59},"end":{"line":8,"column":71}}}):s))+'"></ul>\r\n  </div>\r\n  <a href="javascript:void(0);" class="cs-icon search-sort-btn icon-sortArrowDown"></a>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=r(i,"if").call(null!=t?t:e.nullContext||{},null!=t?r(t,"sortEnable"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":0},"end":{"line":11,"column":7}}}))?s:""}});return i.registerPartial("csui_widgets_search.results_controls_sorting_impl_sort.menu",n),n}),csui.define("csui/widgets/search.results/controls/sorting/sort.menu.view",["module","require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","i18n!csui/widgets/search.results/controls/sorting/impl/nls/localized.strings","hbs!csui/widgets/search.results/controls/sorting/impl/sort.menu","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/lib/binf/js/binf"],function(e,t,i,n,o,s,r,l,a,c,u){return s.ItemView.extend({"className":"cs-sort-links","template":a,"templateHelpers":function(){var e={"sortBy":l.sortBy};this.selected.get("title")?this.selected.get("title"):this.constants.DEFAULT_SORT;return{"messages":e,"sortEnable":this.collection.models.length&&!!this.collection.sorting&&this.options.enableSorting,"id":n.uniqueId("sortButton"),"sortButtonAria":l.sortOptionsAria,"listAria":l.sortOptionsAria}},"constants":{"SORT_ASC":"asc","SORT_DESC":"desc","DEFAULT_SORT":"relevance"},"events":{"click .binf-dropdown-menu > li > a":"onSortOptionClick","click a.search-sort-btn":"onSortOrderClick","keydown":"onKeyInView"},"ui":{"toggle":">.csui-search-sort-options>.binf-dropdown-toggle","selectedLabel":">.csui-search-sort-options>.binf-dropdown-toggle >.cs-label","selectedIcon":">.csui-search-sort-options>.binf-dropdown-toggle >.cs-icon","sortOrderBtn":"a.search-sort-btn","dropdownToggle":".binf-dropdown-toggle"},"constructor":function(e){if(s.View.prototype.constructor.apply(this,arguments),this.config=this.options.config||{},this.selected=new o.Model,this.collection){var t=this.options.orderBy||this.collection.orderBy;this.collection.setOrder(t,!1),this.listenTo(this.collection,"reset",this.render)}this.listenTo(this.collection,"change",this._refreshSelection),this.listenTo(this.selected,"change",this._updateSelection)},"onRender":function(){var e=this;if(this.ui.toggle.binf_dropdown(),this.ui.dropdownToggle.on("binf.dropdown.after.show",function(){e.trigger("ensure:scrollbar")}),this.ui.sortOrderBtn.hide(),void 0!==this.collection.sorting&&void 0!==this.collection.sorting.links)if(this.collection.sorting.sort&&this.collection.sorting.sort[0]!==this.constants.DEFAULT_SORT?(this._setSelection(this.collection.sorting.links[this.collection.sorting.sort]),this._addDropdownItems(i.extend({},this.collection.sorting.links),this.collection.sorting.sort[0]),this.ui.sortOrderBtn.show()):(this._setSelection(this.collection.sorting.links[this.constants.DEFAULT_SORT]),this._addDropdownItems(i.extend({},this.collection.sorting.links),""),this.$el.find(".binf-dropdown-menu > :first-child").addClass("binf-active"),this.$el.find(".binf-dropdown-menu > :first-child a.csui-sort-option").attr("aria-checked","true"),this.$el.find(".binf-dropdown-menu > :first-child .cs-icon").addClass("icon-listview-checkmark"),this.ui.sortOrderBtn.hide()),this.ui.selectedLabel.text(this.selected.get("title")),this.selected.get("order")===this.constants.SORT_ASC){this.ui.sortOrderBtn.removeClass("icon-sortArrowDown"),this.ui.sortOrderBtn.addClass("icon-sortArrowUp");var t=n.str.sformat(l.descending,this.selected.get("titleAttr"));this.ui.sortOrderBtn.attr("title",t).attr("aria-label",t)}else{this.ui.sortOrderBtn.removeClass("icon-sortArrowUp"),this.ui.sortOrderBtn.addClass("icon-sortArrowDown");var o=n.str.sformat(l.ascending,this.selected.get("titleAttr"));this.ui.sortOrderBtn.attr("title",o).attr("aria-label",o)}},"onKeyInView":function(e){9===e.keyCode&&!!this.$el.find(".binf-open")&&this.$el.find(".binf-open").removeClass("binf-open")},"behaviors":{"PerfectScrolling":{"behaviorClass":c,"contentParent":".binf-dropdown-menu","suppressScrollX":!0},"TabableRegionBehavior":{"behaviorClass":u}},"currentlyFocusedElement":function(e){var t=this.$("*[tabindex]");return t.length&&t.prop("tabindex",0),e&&e.shiftKey?i(t[t.length-1]):this.orderClicked?this.ui.sortOrderBtn:i(t[0])},"_setSelection":function(e){var t={};this.collection.sorting.sort?(0===this.collection.sorting.sort[0].indexOf(this.constants.SORT_DESC)&&(t.id=this.collection.sorting.sort[0].replace(/desc_/g,""),t.order=this.constants.SORT_DESC),0===this.collection.sorting.sort[0].indexOf(this.constants.SORT_ASC)&&(t.id=this.collection.sorting.sort[0].replace(/asc_/g,""),t.order=this.constants.SORT_ASC)):(t.id="",t.order=this.constants.SORT_DESC),t.titleAttr=n.str.trim(e&&e.name?this.trimSortOptionName(e.name):"empty"),t.title=this.truncateCategoryName(t.titleAttr);var i=n.str.sformat(l.sortByThis,this.formatColon(t.titleAttr));this.$el.find(".csui-search-sort-options \t.binf-dropdown-toggle").attr("title",i),this.selected.set(t)},"_updateSelection":function(){this.ui.selectedLabel.text(this.selected.get("title"))},"_refreshSelection":function(e){e.collection&&e.collection.inMetadataNavigationView&&(e.collection.isSortOptionSelected=!0),e.get("id")===this.selected.get("id")&&this._setSelection(e)},"resetCollection":function(e,t){this.collection.setOrder(e,!0)},"sortPage":function(e){e.preventDefault(),e.stopPropagation();var t=[],n=i(e.currentTarget).attr("data-csui-sortoption-id");void 0!==n?t.push(n+" "+this.constants.SORT_DESC):t.push(this.constants.DEFAULT_SORT),this.resetCollection(t.join(),!0)},"_addDropdownItems":function(e,t){var i=this.$el.find(".binf-dropdown-menu"),n=this;if(e[this.constants.DEFAULT_SORT]){var o=n.trimSortOptionName(e[n.constants.DEFAULT_SORT].name);i.append('<li role="presentation"><a role="menuitemradio" aria-checked="false" href="#" class="csui-sort-option" data-binf-toggle="tab"><span class="cs-icon"></span><span class="cs-label" title="'+o+'">'+o+"</span></a></li>"),delete e[n.constants.DEFAULT_SORT]}for(var s in e)if(0===s.search("asc_"))delete e[s];else{var r=s.replace(/desc_/g,""),l=n.trimSortOptionName(e[s].name);l=n.formatColon(l);var a=n.truncateCategoryName(l);t.split(/_(.+)/,2)[1]===s.split(/_(.+)/,2)[1]?i.append('<li role="presentation" class="binf-active"><a role="menuitemradio" aria-checked="true" data-csui-sortoption-id="'+r+'" href="#" class="csui-sort-option" data-binf-toggle="tab"><span class="cs-icon icon-listview-checkmark"></span><span class="cs-label" title="'+l+'">'+a+"</span></a></li>"):i.append('<li role="presentation"><a role="menuitemradio" aria-checked="false" data-csui-sortoption-id="'+r+'" href="#" class="csui-sort-option" data-binf-toggle="tab"><span class="cs-icon"></span><span class="cs-label" title="'+l+'">'+a+"</span></a></li>")}},"activate":function(e){!0===this.$el.find("li").hasClass("binf-active")&&(this.$el.find("li").removeClass("binf-active"),this.$el.find("li a.csui-sort-option").attr("aria-checked","false"),this.$el.find("li .cs-icon").removeClass("icon-listview-checkmark")),i(e.parentElement).addClass("binf-active"),i(e).find("a.csui-sort-option").attr("aria-checked","true"),i(e).find("span.cs-icon").addClass("icon-listview-checkmark")},"resetSelection":function(e,t){var i={};i.id=e,i.title=n.str.trim(t.innerText),i.titleAttr=n.str.trim(t.title),i.order=this.constants.SORT_DESC,this.selected.set(i)},"onSortOptionClick":function(e){this.collection.isSortOptionSelected=!0,e.preventDefault(),e.stopPropagation(),this.orderClicked=!1,this.activate(e.currentTarget);var t=i(e.currentTarget).attr("data-csui-sortoption-id");void 0===t&&(t=""),this.sortPage(e),this.ui.toggle.binf_dropdown("toggle"),this.trigger("change:sortOrder")},"onSortOrderClick":function(e){this.collection.isSortOptionSelected=!0,e.preventDefault(),e.stopPropagation(),this.orderClicked=!0;var t=[];this.ui.sortOrderBtn.hasClass("icon-sortArrowDown")?(this.ui.sortOrderBtn.removeClass("icon-sortArrowDown"),this.ui.sortOrderBtn.addClass("icon-sortArrowUp"),t.push(this.selected.id+" "+this.constants.SORT_ASC)):(this.ui.sortOrderBtn.removeClass("icon-sortArrowUp"),this.ui.sortOrderBtn.addClass("icon-sortArrowDown"),t.push(this.selected.id+" "+this.constants.SORT_DESC)),this.collection.setOrder(t.join(),!0)},"trimSortOptionName":function(e){return e.replace(/\(([;\s\w\"\=\,\:\.\/\~\{\}\?\!\-\%\&\#\$\^\(\)]*?)\)/g,"")},"truncateCategoryName":function(e,t){return e.replace(/^[^:]*:\s*/,"")},"formatColon":function(e){return e.replace(/:([^\s])/,": $1")}})}),csui.define("csui/widgets/metadata/impl/metadata.forms",["csui/widgets/metadata/metadata.forms"],function(e){return e});csui.define("csui/widgets/metadata/impl/metadata.utils",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/widgets/metadata/impl/metadata.forms","csui/models/appliedcategories/category.validation.model"],function(e,t,i,n,o,s){function r(){}return e.extend(r.prototype,i.Events,{"ContainerHasEnforcedEmptyRequiredMetadata":function(n){var s=t.Deferred(),r=new i.Model({"name":n.name,"id":n.id,"docParentId":n.docParentId,"type":n.addableType});n.enforcedRequiredAttrs&&(r.options||(r.options={}),r.options.enforcedRequiredAttrs=!0);var l=new o(void 0,{"node":r,"action":n.action,"connector":n.container.connector,"container":n.container,"inheritance":n.inheritance,"autofetch":!0,"autoreset":!0});return l.fetch().done(e.bind(function(){if(0===l.models.length)s.resolve({"hasRequiredMetadata":!1});else{var e=this.FormsCollectionHasRequiredAttributes(l);s.resolve({"hasRequiredMetadata":!e,"initialFormData":l})}},this)),s.promise()},"FormsCollectionHasRequiredAttributes":function(t){var i=!0;return e.each(t.models,e.bind(function(e){var t=this._checkForAlpacaRequiredFields(e);i=i&&t},this)),i},"jsonObjTraverse":function(t,i,n,o,s,r){for(var l in t)t.hasOwnProperty(l)&&(void 0!==t[n]&&t[n]===o&&-1===e.indexOf(s,r)&&s.push(r),"object"==typeof t[l]&&this.jsonObjTraverse(t[l],i+"."+l,n,o,s,l))},"_checkForAlpacaRequiredFields":function(t){var i=!0,n=t.get("data"),o=t.get("options"),s=t.get("schema"),r=[],l=[],a=[];this.jsonObjTraverse(s,"","required",!0,l,"properties"),this.jsonObjTraverse(o,"","validate",!1,a,"fields");var c=function(e,t){return t.filter(function(t){return-1===e.indexOf(t)})}(a,l),u=function(e,t,i,n){for(var o in e)e.hasOwnProperty(o)&&(o===i&&n.push(e[i]),"object"==typeof e[o]&&u(e[o],t+"."+o,i,n))};if(c){var d=!1;e.each(c,function(t){if(r=[],u(n,"",t.toString(),r),e.each(r,function(t){var n=function(t){if(t instanceof Array&&(null!==t||""!==t))e.each(t,function(e){n(e)});else if(null===t||""===t)return void(d=!0)};if(d)return void(i=!1);n(t)}),d)return void(i=!1)})}return i},"AlpacaFormOptionsSchemaHaveRequiredFields":function(e,t,i){var n=!1,o=[];if(i&&"general"===i){if(t&&t.properties){t.properties.name&&(t.properties.name.required=!1),t.properties.advanced_versioning&&(t.properties.advanced_versioning.required=!1),t.properties.file&&(t.properties.file.required=!1);for(var s in t.properties)t.properties.hasOwnProperty(s)&&t.properties[s].required&&!e.fields[s].hidden&&(n=!0)}}else t&&!1===n&&(this.jsonObjTraverse(t,"","required",!0,o,"properties"),o.length>0&&(n=!0));return n},"ContainerHasEnforcedEmptyRequiredMetadataOnNodes":function(i){if(!i.items||i.items.length<1||!i.container)return t.Deferred().reject({});var n=t.Deferred(),o=e.map(i.items,function(e){return e.id}),r={"ids":o},l=i.container.connector;return new s({},{"connector":l}).save(r,{"type":"POST","processData":!1,"contentType":!1}).done(e.bind(function(e){if("original"===i.inheritance)n.resolve({"requiredMetadata":!1,"enforcedItems":e.results});else if(e.results&&e.results.length>0){var t={"action":i.action,"id":e.results[0].id,"inheritance":i.inheritance,"container":i.container,"enforcedRequiredAttrs":!0};this.ContainerHasEnforcedEmptyRequiredMetadata(t).done(function(t){!0===t.hasRequiredMetadata?n.resolve({"requiredMetadata":!0,"enforcedItems":e.results}):n.resolve({"requiredMetadata":!1,"enforcedItems":e.results})}).fail(function(e){n.reject(e)})}else n.resolve({"requiredMetadata":!1,"enforcedItems":e.results})},this)).fail(function(e){n.reject(e)}),n.promise()}}),r.prototype.get=i.Model.prototype.get,e.extend(r,{"version":"1.0"}),r}),csui.define("csui/models/appliedcategories/category.action.server.adaptor.mixin",["csui/lib/jquery","csui/lib/underscore","csui/utils/url","csui/models/version"],function(e,t,i,n){"use strict";return{"mixin":function(e){return t.extend(e,{"makeServerAdaptor":function(e){return this},"url":function(){return i.combine(this.node.urlBase(),this.options.urlResource)},"parse":function(){return this.node instanceof n?{}:void 0===this.node.get("id")||this.options.action?{"categories_add":"dummy value"}:this.constructor.__super__.parse.apply(this,arguments)}})}}}),csui.define("csui/models/appliedcategories/appliedcategoriesaction",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/appliedcategories","csui/models/version","csui/models/appliedcategories/category.action.server.adaptor.mixin"],function(e,t,i,n,o,s,r){"use strict";var l=o.extend({"constructor":function(e,i){o.prototype.constructor.apply(this,arguments),this.options=i||{},t.defaults(this.options,{"urlResource":""})},"fetch":function(){return this.node instanceof s||void 0===this.node.get("id")||this.options.action?(this.fetching=!1,this.fetched=!0,e.Deferred().resolve()):o.prototype.fetch.apply(this,arguments)},"isFetchable":function(){return!!this.node.isFetchableDirectly&&this.node.isFetchableDirectly()}});return r.mixin(l.prototype),l}),csui.define("csui/temporary/cop/commands/defaultactionitems",[],function(){"use strict";return[{"equals":{"type":[356,357]},"signature":"OpenBlog","sequence":30},{"equals":{"type":[123475,123476]},"signature":"OpenFAQ","sequence":30},{"equals":{"type":[123469,123470]},"signature":"OpenForum","sequence":30},{"equals":{"type":[5573,5574]},"signature":"OpenWiki","sequence":30},{"equals":{"type":3030331},"signature":"OpenMailStore","sequence":30}]}),csui.define("csui/temporary/activeviews/commands/defaultactionitems",[],function(){"use strict";return[{"equals":{"type":30309},"signature":"Disabled","sequence":30}]}),csui.define("csui/temporary/appearances/commands/defaultactionitems",[],function(){"use strict";return[{"equals":{"type":480},"signature":"Disabled","sequence":30}]}),csui.define("csui/utils/letter-avatar-random-color/letter-avatar-colors",["module"],function(e){var t={"colors":["#414979","#2e3d98","#4f3690","#e00051","#006353","#007599","#147bbc","#a0006b","#ba004C"]};return{"getLetterAvatarColor":function(e){if(!e)return"";var i=0,n=0,o=e.length;e=e.toUpperCase();for(var s=0;s<o;s++)i+=e.charCodeAt(s);return n=parseInt(i.toString().split("").pop()),n=9===n?n-1:n,t.colors[n]}}}),csui.define("csui/utils/user.avatar.color",["csui/lib/underscore","csui/utils/letter-avatar-random-color/letter-avatar-colors"],function(e,t){return{"getUserAvatarColor":function(i){if(!i||e.isEmpty(i))return"";var n=i.initials&&i.initials.length>1?i.initials:i.name?i.name.substring(0,2):"";return t.getLetterAvatarColor(n)}}}),csui.define("csui/controls/node-type.icon/node-type.icon.item.view.mixin",["csui/lib/underscore","csui/lib/jquery","csui/utils/user.avatar.color","csui/utils/nodesprites","csui/controls/node-type.icon/node-type.icon.view"],function(e,t,i,n,o){return{"mixin":function(s){return e.extend(s,{"makeNodeTypeIconItemView":function(){this.listenTo(this,"destroy",function(){this.nodeTypeIconView&&this.nodeTypeIconView.destroy()})},"renderNodeTypeIconView":function(e,s,r,l,a){var c=t(s);s=c[0]?c:s,r=r||"",l=l||"",a=a||{};var u=(" "+r+" ").indexOf(" csui-initials ")>=0,d={"node":e,"nodeSprite":u?new n.model({"className":r}):a.nodeSprite,"size":a.size};this.nodeTypeIconView&&this.nodeTypeIconView.destroy();var h=this.nodeTypeIconView=new o(d);if(h.render(),h.$el.removeAttr("title aria-label"),h.$el.addClass(s.attr("class")),u){var p,f=e.attributes.initials;if(f)p=i.getUserAvatarColor(e.attributes);else{var m=e.get(e.nameAttribute||"name")||"",g=m.trim().indexOf(" ");f=g>0?m[0]+m[g+1]:m.substring(0,2),p=i.getUserAvatarColor({"initials":f})}h.ui.iconElement.text(f),h.ui.iconElement.css("background",p)}h.ui.iconElement.addClass(r),h.ui.imageElement.addClass(l),s.replaceWith(h.el)}})}}}),csui.define("bundles/csui-view-support",["csui/lib/ally","csui/lib/bootstrap3-typeahead","csui/lib/jquery.mousehover","csui/lib/fancytree/jquery.fancytree","csui/lib/fancytree/jquery.fancytree.filter","csui/behaviors/collection.error/collection.error.behavior","csui/behaviors/collection.state/collection.state.behavior","csui/behaviors/collection.state/collection.state.view","csui/controls/dialog/dialog.view","csui/controls/dialog/impl/header.view","csui/controls/dialog/footer.view","csui/controls/facet.bar/facet.bar.view","csui/controls/facet.panel/facet.panel.view","csui/controls/list/behaviors/list.view.keyboard.behavior","csui/controls/list/emptylist.view","csui/controls/list/list.view","csui/controls/list/list.state.view","csui/controls/treebrowse/node.tree.view","css!csui/controls/list/impl/list","csui/controls/list/simplelist.view","csui/controls/list/simpletreelist.view","csui/controls/listitem/inline.menu.view","csui/controls/listitem/listitemobject.view","csui/controls/listitem/listitemstandard.view","csui/controls/listitem/listitemstateful.view","csui/controls/listitem/simpletreelistitem.view","csui/controls/table/cells/search/category/category.popover.list.view","csui/controls/toolbar/toolbar.view","csui/controls/toolbar/toolbar.command.controller","csui/controls/toolbar/toolitem.model","csui/controls/toolbar/toolitem.custom.view","csui/controls/toolbar/toolitem.view","csui/controls/toolbar/flyout.toolitem.view","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitems.filtered.model","csui/controls/toolbar/toolitems.mask","csui/controls/toolbar/delayed.toolbar.view","csui/controls/toolbar/toolbar.state.behavior","hbs!csui/controls/toolbar/toolitem","csui/controls/fileupload/impl/upload.controller","csui/controls/checkbox/checkbox.view","csui/controls/disclosure/disclosure.view","i18n!csui/controls/listitem/impl/nls/lang","csui/models/appliedcategories","csui/models/appliedcategory","csui/models/fileupload","csui/models/fileuploads","csui/models/namequery","csui/models/nodeversions","csui/models/versions","csui/models/facet","csui/models/facets","csui/models/facettopic","csui/models/facettopics","csui/models/node.facets/facet.query.mixin","csui/models/node.facets2/facet.query.mixin","csui/models/widget/search.results/search.facet.query.mixin","csui/models/node/node.facet.factory","csui/models/node/node.facet2.factory","csui/models/nodefacets","csui/models/nodefacets2","csui/models/widget/search.results/search.results.model","csui/models/permission/permission.table.columns.model","csui/utils/commands/impl/full.page.modal/full.page.modal.view","csui/utils/thumbnail/thumbnail.object","csui/utils/thumbnail/thumbnail.view","csui/utils/expiration.warning/expiration.warning.dialog","json!csui/utils/commands/open.types.json","csui/utils/commands/open.plugins/impl/core.open.plugins","csui/utils/contexts/factories/search.results.factory","csui/utils/high.contrast/detector","csui/utils/impl/signin.dialog/signin.dialog","csui/utils/toolitem.masks/global.toolitems.mask","css!csui/controls/form/impl/form","csui/widgets/metadata/metadata.forms","csui/widgets/search.results/controls/sorting/sort.menu.view","csui/widgets/metadata/impl/metadata.forms","csui/widgets/metadata/impl/metadata.utils","i18n!csui/widgets/metadata/impl/nls/lang","csui/models/appliedcategoryform","csui/models/appliedcategories/appliedcategoriesaction","csui/models/form","csui/models/forms","csui/models/nodecreateforms","csui/models/nodeforms","csui/models/nodeupdateforms","csui/temporary/cop/commands/defaultactionitems","csui/temporary/activeviews/commands/defaultactionitems","csui/temporary/appearances/commands/defaultactionitems","csui/models/node.facets/server.adaptor.mixin","csui/models/node.facets2/server.adaptor.mixin","csui/widgets/metadata/metadata.forms/server.adaptor.mixin","csui/models/appliedcategories/server.adaptor.mixin","csui/models/appliedcategories/category.action.server.adaptor.mixin","csui/models/namequery/server.adaptor.mixin","csui/utils/user.avatar.color","csui/utils/letter-avatar-random-color/letter-avatar-colors","csui/controls/node-type.icon/node-type.icon.item.view.mixin"],{}),csui.require(["require","css"],function(e,t){t.styleLoad(e,"csui/bundles/csui-view-support",!0)});
//# sourceMappingURL=csui-view-support.js.map