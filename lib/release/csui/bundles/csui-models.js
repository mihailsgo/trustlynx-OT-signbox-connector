csui.define("csui/models/audit/server.adaptor.mixin",["csui/lib/underscore","csui/utils/url"],function(e,i){"use strict";return{"mixin":function(t){return e.extend(t,{"makeServerAdaptor":function(e){return this},"url":function(){var e=new i(this.connector.connection.url).getApiBase(2),t=i.combineQueryString(this.getBrowsableUrlQuery(),{"expand":"audit{id, user_id, agent_id}"});return i.combine(e,"nodes",this.options.node.get("id"),"audit?"+t)},"parse":function(e,i){return this.parseBrowsedState(e,i),this.columns&&this.columns.resetColumnsV2(e,this.options),this.auditEvents.add(e.results.data.audit_event_types),e.results.data.audit},"isFetchable":function(){return!!this.options}})}}}),csui.define("csui/models/audit/audit.collection",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/browsable.mixin","csui/models/browsable/v2.response.mixin","csui/models/browsable/v1.request.mixin","csui/models/audit/server.adaptor.mixin","csui/models/nodechildrencolumn","csui/models/nodechildrencolumns","csui/models/node/node.model"],function(e,i,t,s,n,o,r,a,c,u,l,d){var m={"auditName":"audit_name","auditDate":"audit_date","userIdKey":"user_id","dateType":"-7"},p=u.extend({"constructor":function(e,i){u.prototype.constructor.call(this,e,i)}}),f=l.extend({"model":p,"resetColumnsV2":function(e,i){this.models.length||this.resetCollection(this.getV2Columns(e),i)},"getColumnModels":function(i,t){var s=l.prototype.getColumnModels.call(this,i,t);return e.each(s,function(e){e.column_key===m.auditDate&&(e.sort=!0)}),s},"getV2Columns":function(i){var t=i.results&&i.results[0]&&i.results[0].metadata&&i.results[0].metadata.properties||{};t.audit_name={"filter":!0},t.audit_date={},t.user_id={"filter":!0},t.audit_name.key=m.auditName,t.audit_date.key=m.auditDate,t.user_id.key=m.userIdKey,t.audit_date.type=m.dateType;var s=e.keys(t);return this.getColumnModels(s,t)}}),h=t.Model.extend({}),g=t.Collection.extend({"model":h,"constructor":function(e,i){this.options=i||{},t.Collection.prototype.constructor.call(this,e,i)}}),v=d.extend({}),_=t.Collection.extend({"model":v,"constructor":function(e,i){this.options=i||{},t.Collection.prototype.constructor.call(this,e,i),this.makeConnectable(i).makeFetchable(i).makeBrowsable(i).makeBrowsableV2Response(i).makeBrowsableV1Request(i).makeServerAdaptor(i),this.columns=new f,this.auditEvents=new g}});return s.mixin(_.prototype),n.mixin(_.prototype),o.mixin(_.prototype),r.mixin(_.prototype),a.mixin(_.prototype),c.mixin(_.prototype),_}),csui.define("csui/models/authenticated.user.node.permission",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/resource/resource.mixin","csui/models/mixins/including.additional.resources/including.additional.resources.mixin"],function(e,i,t,s,n,o){"use strict";var r=i.Model.extend({"constructor":function(e,t){t||(t={}),i.Model.prototype.constructor.call(this,e,t),this.makeResource(t).makeIncludingAdditionalResources(t).makeExpandable(t),this.options=t},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})},"url":function(){var e=this.node?this.node.get("id"):this.options.node.get("id"),i=this.options.user.get("id"),s=new t(this.connector.connection.url).getApiBase("v2");return t.combine(s,"/nodes/",e,"/permissions/effective/",i)},"parse":function(e){var i=e.results&&e.results.data&&e.results.data.permissions;return i?this.node&&!this.node.get("container")&&-1!==i.permissions.indexOf("add_items")&&i.permissions.splice(i.permissions.indexOf("add_items"),1):i={},i},"hasEditPermissionRights":function(){if(this.node&&"simple"===this.node.get("permissions_model"))return!1;var i=this.get("permissions");return i&&e.isArray(i)&&e.contains(i,"edit_permissions")}});return o.mixin(r.prototype),s.mixin(r.prototype),n.mixin(r.prototype),r}),csui.define("csui/models/server.adaptors/favorite2.mixin",["csui/lib/underscore","csui/utils/url"],function(e,i){"use strict";return{"mixin":function(t){var s=t.parse,n=t.sync;return e.extend(t,{"makeServerAdaptor":function(e){return this},"parse":function(i,t){if(i.results&&(i=i.results),e.isEmpty(i))return{};if(t.attrs){var n={};return e.each(e.keys(t.attrs),function(e){n["favorite_"+e]=t.attrs[e]},this),n}i.data&&i.data.properties&&i.data.favorites&&(i.data.properties.favorite_name=i.data.favorites.name,i.data.properties.favorite_tab_id=i.data.favorites.tab_id);var o=s.call(this,i);return o.actions&&(o.actions=e.reject(o.actions,function(e){return"rename"==e.signature||"delete"==e.signature}),o.actions.push({"signature":"favorite_rename"})),o},"sync":function(t,s,o){var r=!1;if("update"===t||"patch"===t){var a={};if(e.each(e.keys(o.attrs),function(e){var i=e;0===e.indexOf("favorite_")&&(r=!0,i=e.substr("favorite_".length)),a[i]=o.attrs[e]}),o.attrs=a,r){var c=this.connector.getConnectionUrl().getApiBase("v2");c=i.combine(c,"/members/favorites"),c=i.combine(c,s.id),o.url=c}}return n.call(this,t,s,o)}})}}}),csui.define("csui/models/favorite2",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/node/node.model","csui/models/server.adaptors/favorite2.mixin","csui/utils/deepClone/deepClone"],function(e,i,t,s,n){"use strict";var o=s.extend({"mustRefreshAfterPut":!1,"idAttribute":"id","constructor":function(e,i){s.prototype.constructor.apply(this,arguments),this.makeServerAdaptor(i)}});return n.mixin(o.prototype),o}),csui.define("csui/models/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/models/impl/nls/root/lang",{"serverCallPrecheckFailedMissingConnector":"Missing connector data for server call.","serverCallPrecheckFailedModelIsNew":"Model is new.","fav_parent_id":"Location","fav_favorite_name":"Name","fav_size":"Size","fav_ungrouped":"Ungrouped","name":"Name","type":"Type","version":"Version","state":"State","favorite":"Favorite","toggleDetails":"Toggle Details","parentID":"Parent ID"}),csui.define("csui/models/favorite2column",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","i18n!csui/models/impl/nls/lang"],function(e,i,t,s){"use strict";return i.Model.extend({"idAttribute":null,"constructor":function(e,t){if(e&&!e.title){var n="fav_"+e.column_key;e.title=s[n]}i.Model.prototype.constructor.call(this,e,t)}})}),csui.define("csui/models/favorite2columns",["csui/lib/underscore","csui/lib/backbone","csui/models/favorite2column","i18n!csui/models/impl/nls/lang"],function(e,i,t,s){"use strict";return i.Collection.extend({"model":t,"constructor":function(e,t){e||(e=[{"default_action":!0,"key":"type","name":s.type,"type":2},{"default_action":!0,"key":"favorite_name","name":s.name,"type":-1},{"key":"reserved","name":s.state,"type":5},{"key":"parent_id","name":s.parentID,"type":2},{"key":"favorite","name":s.favorite,"type":5}],e.forEach(function(e,i){e.definitions_order=i+100,e.column_key=e.key})),i.Collection.prototype.constructor.call(this,e,t)}})}),csui.define("csui/models/server.adaptors/favorites2.mixin",["csui/lib/underscore","csui/utils/url"],function(e,i){"use strict";return{"mixin":function(t){return e.extend(t,{"makeServerAdaptor":function(e){return this},"url":function(){var e=this.connector.getConnectionUrl().getApiBase("v2"),t=i.combineQueryString(this.getAdditionalResourcesUrlQuery(),this.getResourceFieldsUrlQuery(),this.getExpandableResourcesUrlQuery(),this.getStateEnablingUrlQuery(),this.getRequestedCommandsUrlQuery(),this.getSortByOrderUrlQuery());return e=i.combine(e,"/members/favorites"),t?e+"?"+t:e},"getSortByOrderUrlQuery":function(){return{"sort":"order"}},"parse":function(e,i){return this.parseBrowsedState({"results":e},i),this.parseBrowsedItems(e,i)}})}}}),csui.define("csui/models/favorites2",["csui/lib/underscore","csui/lib/backbone","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/mixins/v2.additional.resources/v2.additional.resources.mixin","csui/models/mixins/v2.fields/v2.fields.mixin","csui/models/mixins/v2.expandable/v2.expandable.mixin","csui/models/mixins/state.requestor/state.requestor.mixin","csui/models/mixins/v2.commandable/v2.commandable.mixin","csui/models/browsable/client-side.mixin","csui/models/browsable/v2.response.mixin","csui/models/mixins/v2.delayed.commandable/v2.delayed.commandable.mixin","csui/models/favorite2","csui/models/favorite2columns","csui/models/server.adaptors/favorites2.mixin","csui/utils/deepClone/deepClone"],function(e,i,t,s,n,o,r,a,c,u,l,d,m,p,f){"use strict";var h=i.Collection.extend({"model":m,"constructor":function(t,s){i.Collection.prototype.constructor.apply(this,arguments),this.callCounter=0,s&&(this.options=e.pick(s,["connector","autoreset","includeResources","fields","expand","commands"])),this.makeConnectable(s).makeFetchable(s).makeAdditionalResourcesV2Mixin(s).makeFieldsV2(s).makeExpandableV2(s).makeStateRequestor(s).makeCommandableV2(s).makeClientSideBrowsable(s).makeBrowsableV2Response(s).makeDelayedCommandableV2(s).makeServerAdaptor(s),this.columns=new p(s.columns)},"_prepareModel":function(e,t){return t||(t={}),t.promotedActionCommands=this.promotedActionCommands,t.nonPromotedActionCommands=this.nonPromotedActionCommands,i.Collection.prototype._prepareModel.call(this,e,t)},"clone":function(){var i=new this.constructor(this.models,{"connector":this.connector,"fields":e.deepClone(this.fields),"expand":e.deepClone(this.expand),"includeResources":e.clone(this._additionalResources),"skip":this.skipCount,"top":this.topCount,"filter":e.deepClone(this.filters),"orderBy":this.orderBy,"commands":e.clone(this.commands),"defaultActionCommands":e.clone(this.defaultActionCommands),"delayRestCommands":this.delayRestCommands});return this.columns&&i.columns.reset(this.columns.toJSON()),i.actualSkipCount=this.actualSkipCount,i.totalCount=this.totalCount,i.filteredCount=this.filteredCount,i},"getResourceScope":function(){return e.deepClone({"fields":this.fields,"expand":this.expand,"includeResources":this._additionalResources,"commands":this.commands,"defaultActionCommands":this.defaultActionCommands})},"setResourceScope":function(e){this.excludeResources(),e.includeResources&&this.includeResources(e.includeResources),this.resetFields(),e.fields&&this.setFields(e.fields),this.resetExpand(),e.expand&&this.setExpand(e.expand),this.resetCommands(),e.commands&&this.setCommands(e.commands),this.resetDefaultActionCommands(),e.defaultActionCommands&&this.setDefaultActionCommands(e.defaultActionCommands)}});return u.mixin(h.prototype),l.mixin(h.prototype),t.mixin(h.prototype),s.mixin(h.prototype),n.mixin(h.prototype),o.mixin(h.prototype),r.mixin(h.prototype),a.mixin(h.prototype),c.mixin(h.prototype),d.mixin(h.prototype),f.mixin(h.prototype),h}),csui.define("csui/models/favorite2group",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/mixins/resource/resource.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/favorites2","csui/utils/deepClone/deepClone"],function(e,i,t,s,n,o){"use strict";var r=i.Model.extend({"mustRefreshAfterPut":!1,"idAttribute":"tab_id","constructor":function(e,t){i.Model.prototype.constructor.call(this,e,t),this.makeResource(t),this.makeUploadable(t),e||(e={}),this.favorites=new o(e.favorites,{"connector":t.connector,"autoreset":!0,"tab_id":this.get("tab_id"),"columns":e.favorite_columns,"commands":t&&t.commands,"stateEnabled":t.stateEnabled})},"urlRoot":function(){var e=this.connector.getConnectionUrl().getApiBase("v2");return t.combine(e,"/members/favorites/tabs/")},"parse":function(e,i){return e.results&&e.results.data?{"tab_id":e.results.data.tab_id}:e}});return s.mixin(r.prototype),n.mixin(r.prototype),r}),csui.define("csui/models/server.adaptors/favorite2groups.mixin",["csui/lib/jquery","csui/lib/underscore","csui/utils/url","i18n!csui/models/impl/nls/lang"],function(e,i,t,s){"use strict";return{"mixin":function(e){return i.extend(e,{"makeServerAdaptor":function(e){return this},"sync":function(e,t,s){if("read"!==e)throw new Error("Only fetching groups with favorites is supported.");var n=this.connector.makeAjaxCall({"url":this.url()}).then(function(e){return e}),o=this.favorites,r=i.omit(s,["success","error"]),a=o.fetch(r).then(function(e){return o});return s.parse=!1,this.syncFromMultipleSources([n,a],this._createMergedResponse,s)},"_createMergedResponse":function(e,i,t){var n=i.toJSON(),o=i.columns;return e.results.push({"data":{"name":s.fav_ungrouped,"order":-1,"tab_id":-1}}),e.results.map(function(e){e=e.data;var i=e.tab_id;return e.favorites=n.filter(function(e){return e.favorite_tab_id===i||-1===i&&null===e.favorite_tab_id}),e.favorite_columns=o.toJSON(),e})},"parse":function(e,i){return e},"url":function(){var e=this.connector.getConnectionUrl().getApiBase("v2"),i=t.combineQueryString(this.getAdditionalResourcesUrlQuery(),this.getResourceFieldsUrlQuery(),this.getExpandableResourcesUrlQuery(),this.getSortByOrderUrlQuery());return e=t.combine(e,"/members/favorites/tabs"),i?e+"?"+i:e}})}}}),csui.define("csui/models/favorite2groups",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/utils/base","csui/models/mixins/syncable.from.multiple.sources/syncable.from.multiple.sources.mixin","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/mixins/v2.additional.resources/v2.additional.resources.mixin","csui/models/mixins/v2.fields/v2.fields.mixin","csui/models/mixins/v2.expandable/v2.expandable.mixin","csui/models/mixins/state.requestor/state.requestor.mixin","csui/models/favorite2group","csui/models/favorites2","csui/models/server.adaptors/favorite2groups.mixin","i18n!csui/models/impl/nls/lang"],function(e,i,t,s,n,o,r,a,c,u,l,d,m,p,f,h){"use strict";var g=t.Collection.extend({"model":m,"constructor":function(e,s){t.Collection.prototype.constructor.apply(this,arguments),s&&(this.options=i.pick(s,["connector","autoreset","includeResources","fields","expand"])),this.makeConnectable(s).makeFetchable(s).makeAdditionalResourcesV2Mixin(s).makeFieldsV2(s).makeExpandableV2(s).makeServerAdaptor(s).makeStateRequestor(s),s&&(this.favorites=s.favorites,this.commands=s.commands),this.favorites||(this.favorites=new p(void 0,{"connector":this.connector,"autoreset":!0,"commands":this.commands})),this.on("sync",this._setupEventPropagation,this),this.on("add",this._propagateFavorite2CollectionOptions,this),this.on("reset",function(e,i){var t=this;e.each(function(s){t._propagateFavorite2CollectionOptions(s,e,i)})},this)},"_fetch":function(e){return e||(e={}),e.originalSilent=e.silent,e.silent=!0,this.originalFetch.call(this,e)},"_prepareModel":function(e,i){return i||(i={}),i.commands=this.commands,i.stateEnabled=this.stateEnabled,t.Collection.prototype._prepareModel.call(this,e,i)},"_setupEventPropagation":function(){var e=this;this.each(function(i){i.favorites.listenTo(i.favorites,"reset update",function(i,t){e.trigger("update",e,t)})},this)},"_propagateFavorite2CollectionOptions":function(e,t,s){e.favorites.setFilter(i.deepClone(this.favorites.filters),!1),e.favorites.setOrder(this.favorites.orderBy,!1),e.favorites.setFields(i.deepClone(this.favorites.fields)),e.favorites.setExpand(i.deepClone(this.favorites.expand)),this.favorites.commands&&e.favorites.setCommands(this.favorites.commands),e.favorites.promotedActionCommands=this.favorites.promotedActionCommands,e.favorites.nonPromotedActionCommands=this.favorites.nonPromotedActionCommands,e.favorites.each(function(i){i.promotedActionCommands=e.favorites.promotedActionCommands,i.nonPromotedActionCommands=e.favorites.nonPromotedActionCommands})},"clone":function(){return new this.constructor(this.models,{"connector":this.connector,"filter":i.deepClone(this.filters),"orderBy":this.orderBy,"fields":i.clone(this.fields),"expand":i.clone(this.expand),"commands":i.clone(this.commands),"favorites":this.favorites.clone()})},"getSortByOrderUrlQuery":function(){return{"sort":"order"}},"resetCollection":function(e,i){this.reset(e,i),this.fetched=!0},"saveAll":function(){var i=this,t=this.map(function(e){var i,t=e.get("tab_id");return i=-1==t?null:e.get("name"),{"name":i,"tab_id":t,"favorites":e.favorites.map(function(e){return{"id":e.get("id"),"name":e.get("favorite_name")}})}}),o=this.connector.getConnectionUrl().getApiBase("v2");o=s.combine(o,"/csui/favorites"),this.callCounter++;var r={"type":"PUT","url":o,"data":t,"beforeSend":function(e,t){e.counter=i.callCounter}},a=e.Deferred(),c=this.connector.makeAjaxCall(r);return c.then(function(e){if(c.counter<i.callCounter)a.reject();else{r={"type":"GET","url":i.url()};i.connector.makeAjaxCall(r).then(function(t){t.results&&t.results instanceof Array&&t.results.forEach(function(e,t){if(e.data){var s=i.at(t);i.remove(s,{"silent":!0}),s.set("tab_id",e.data.tab_id,{"silent":!0}),i.add(s,{"at":t,"silent":!0}),s.set("order",e.data.order,{"silent":!0});for(var n=0;n<s.favorites.length;n++){var o=s.favorites.at(n);s.favorites.remove(o,{"silent":!0}),o.set("favorite_tab_id",e.data.tab_id,{"silent":!0}),s.favorites.add(o,{"at":n,"silent":!0})}}}),a.resolve(e),i.trigger("bulk:update:succeed")},function(e,t){var s=new n.RequestErrorMessage(e);a.reject(s),i.trigger("bulk:update:fail")})}},function(e,t){if(e.counter<i.callCounter)a.reject();else{var s=new n.RequestErrorMessage(e);a.reject(s)}i.trigger("bulk:update:fail")}),a.promise()}});return o.mixin(g.prototype),r.mixin(g.prototype),a.mixin(g.prototype),c.mixin(g.prototype),u.mixin(g.prototype),d.mixin(g.prototype),f.mixin(g.prototype),l.mixin(g.prototype),g}),csui.define("csui/models/server.adaptors/favorite.model.mixin",["csui/lib/jquery","csui/lib/underscore","csui/utils/url","i18n!csui/models/impl/nls/lang"],function(e,i,t,s){"use strict";return{"mixin":function(e){return i.extend(e,{"makeServerAdaptor":function(e){return this},"url":function(){return t.combine(this.options.connector.getConnectionUrl().getApiBase("v2"),"members/favorites",this.get("id"))},"_serverCallPreCheck":function(){return this.isNew()?{"error":s.serverCallPrecheckFailedModelIsNew}:this.options&&this.options.connector?void 0:{"error":s.serverCallPrecheckFailedMissingConnector}},"_serverCallUpdateFavorite":function(e,t,s){var n=this._serverCallPreCheck();if(void 0!==n)return void t.reject(n);var o={"type":e,"url":this.url()};if("POST"===e){var r=this.get("tab_id"),a=this.get("name");if(void 0!==r||void 0!==a){var c={};void 0!==a&&i.extend(c,{"name":a}),void 0!==r&&-1!==r&&i.extend(c,{"tab_id":r}),i.extend(o,{"data":c})}}this.options.connector.makeAjaxCall(o).done(i.bind(function(e){if(this.set("selected",s),window.csui&&window.csui.mobile){this.get("node").fetch({"force":!0})}t.resolve(e)},this)).fail(function(e){t.reject(e)})}})}}}),csui.define("csui/models/favorite.model",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/base","csui/utils/url","csui/models/server.adaptors/favorite.model.mixin","i18n!csui/models/impl/nls/lang"],function(e,i,t,s,n,o,r){"use strict";var a=t.Model.extend({"constructor":function(e,i){i||(i={}),this.options=i,t.Model.prototype.constructor.apply(this,arguments),this.makeServerAdaptor(i)},"isNew":function(){return void 0===this.get("id")},"addToFavorites":function(){var i=e.Deferred();return this._serverCallUpdateFavorite("POST",i,!0),i.promise()},"removeFromFavorites":function(){var i=e.Deferred();return this._serverCallUpdateFavorite("DELETE",i,!1),i.promise()}});return o.mixin(a.prototype),a}),csui.define("csui/models/permission/permission.action.server.adaptor.mixin",["csui/lib/underscore","csui/utils/url"],function(e,i){"use strict";var t={"mixin":function(t){return e.extend(t,{"makeServerAdaptor":function(e){return this},"urlBase":function(){var t=this.get("type"),s=this.get("right_id"),n=this.nodeId,o=this.apply_to,r=this.include_sub_types,a="",c=this.options.connector.getConnectionUrl().getApiBase("v2");if(e.isNumber(n)&&!(n>0))throw new Error("Unsupported id value");if(c=i.combine(c,"nodes",n,"permissions"),o&&(a=i.combineQueryString(a,{"apply_to":o})),r&&e.each(r,function(e){a=i.combineQueryString(a,{"include_sub_types":e})}),a=a.length>0?"?"+a:a,t)if("custom"!==t)c=i.combine(c,t+a);else{if(e.isNumber(s)&&!(s>0))throw new Error("Unsupported permission type or user id");c=i.combine(c,t,s+a)}else c=i.combine(c,"custom"+a);return c},"url":function(){var e=this.urlBase();return e},"parse":function(e,i){if(this.collection){var t,s=e.permissions?e.permissions.indexOf("add_items"):-1;this.collection.isContainer?(t=e.permissions?e.permissions.indexOf("add_major_version"):-1,this.collection.options.node&&this.collection.options.node.get("advancedVersioningEnabled")||-1===t||e.permissions.splice(t,1)):(-1!==s&&e.permissions.splice(s,1),t=e.permissions?e.permissions.indexOf("add_major_version"):-1,this.collection.options.node&&this.collection.options.node.get("advanced_versioning")||-1===t||e.permissions.splice(t,1))}return e}})},"getPermissionLevel":function(e,i,s,n,o){var r,a=9;return i?(a++,n.get("advancedVersioningEnabled")||a--):s||a--,e&&e.length>0&&"simple"!==n.get("permissions_model")?r=e.indexOf("edit_permissions")>=0&&e.length===a?t.PERMISSION_LEVEL_FULL_CONTROL:e.indexOf("edit_permissions")<0&&e.indexOf("delete")>=0&&e.length===a-1?t.PERMISSION_LEVEL_WRITE:e.indexOf("see_contents")>=0&&2===e.length?t.PERMISSION_LEVEL_READ:t.PERMISSION_LEVEL_CUSTOM:e&&e.length>0&&"simple"===n.get("permissions_model")?e.indexOf("edit_permissions")>=0?r=t.PERMISSION_LEVEL_FULL_CONTROL:e.indexOf("edit_permissions")<0&&e.indexOf("delete")>=0?r=t.PERMISSION_LEVEL_WRITE:e.indexOf("see_contents")>=0&&2===e.length&&(r=t.PERMISSION_LEVEL_READ):("public"===o.get("type")||o.get("right_id"))&&(r=t.PERMISSION_LEVEL_NONE),r},"getReadPermissions":function(){return["see","see_contents"]},"getWritePermissions":function(e,i,t){var s=["see","see_contents","modify","edit_attributes","add_items","reserve","add_major_version","delete_versions","delete"];return e?t||s.splice(s.indexOf("add_major_version"),1):(s.splice(s.indexOf("add_items"),1),i||s.splice(s.indexOf("add_major_version"),1)),s},"getFullControlPermissions":function(e,i,t){var s=["see","see_contents","modify","edit_attributes","add_items","reserve","add_major_version","delete_versions","delete","edit_permissions"];return e?t||s.splice(s.indexOf("add_major_version"),1):(s.splice(s.indexOf("add_items"),1),i||s.splice(s.indexOf("add_major_version"),1)),s},"getPermissionsByLevelExceptCustom":function(e,i,s,n){var o=null;switch(e){case t.PERMISSION_LEVEL_NONE:o=[];break;case t.PERMISSION_LEVEL_READ:o=t.getReadPermissions();break;case t.PERMISSION_LEVEL_WRITE:o=t.getWritePermissions(i,s,n);break;case t.PERMISSION_LEVEL_FULL_CONTROL:o=t.getFullControlPermissions(i,s,n)}return o}};return t.PERMISSION_LEVEL_NONE=0,t.PERMISSION_LEVEL_READ=1,t.PERMISSION_LEVEL_WRITE=2,t.PERMISSION_LEVEL_FULL_CONTROL=3,t.PERMISSION_LEVEL_CUSTOM=4,t}),csui.define("csui/models/permission/nodepermission.model",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/permission/permission.action.server.adaptor.mixin"],function(e,i,t,s,n,o,r,a){"use strict";function c(){return a.getPermissionLevel(this.get("permissions"),this.collection.isContainer,this.collection.options.node&&this.collection.options.node.get("advanced_versioning"),this.collection.options.node,this)}var u=i.extend({"idAttribute":null},e.config()),l=s.Model.extend({"idAttribute":u.idAttribute,"defaults":{"addEmptyAttribute":!0},"constructor":function(e,t){e||(e={}),t||(t={}),s.Model.prototype.constructor.call(this,e,t),this.options=i.pick(t,["connector"]),this.makeConnectable(t).makeUploadable(t)},"isNew":function(){return!this.get("type")||!(this.has("right_id")||"public"===this.get("type"))}},{"getPermissionLevel":c,"getReadPermissions":a.getReadPermissions,"getWritePermissions":a.getWritePermissions,"getFullControlPermissions":a.getFullControlPermissions,"getPermissionsByLevelExceptCustom":a.getPermissionsByLevelExceptCustom});return l.prototype.PERMISSION_LEVEL_NONE=l.PERMISSION_LEVEL_NONE=a.PERMISSION_LEVEL_NONE,l.prototype.PERMISSION_LEVEL_READ=l.PERMISSION_LEVEL_READ=a.PERMISSION_LEVEL_READ,l.prototype.PERMISSION_LEVEL_WRITE=l.PERMISSION_LEVEL_WRITE=a.PERMISSION_LEVEL_WRITE,l.prototype.PERMISSION_LEVEL_FULL_CONTROL=l.PERMISSION_LEVEL_FULL_CONTROL=a.PERMISSION_LEVEL_FULL_CONTROL,l.prototype.PERMISSION_LEVEL_CUSTOM=l.PERMISSION_LEVEL_CUSTOM=a.PERMISSION_LEVEL_CUSTOM,l.prototype.getPermissionLevel=l.getPermissionLevel,l.prototype.getReadPermissions=l.getReadPermissions,l.prototype.getWritePermissions=l.getWritePermissions,l.prototype.getFullControlPermissions=l.getFullControlPermissions,l.prototype.getPermissionsByLevelExceptCustom=l.getPermissionsByLevelExceptCustom,o.mixin(l.prototype),r.mixin(l.prototype),a.mixin(l.prototype),l}),csui.define("csui/models/permission/permission.response.mixin",["csui/lib/underscore","csui/utils/base"],function(e,i){"use strict";return{"mixin":function(i){return e.extend(i,{"makePermissionResponse":function(e){return this},"parsePermissionResponse":function(i,t,s){if(i.results&&i.results.data&&i.results.data.permissions&&!e.isEmpty(i.results.data.permissions)){var n=i.results.data.permissions;if(e.isArray(n)){n=e.reject(n,function(e){return"public"===e.type&&!e.permissions});var o=e.find(n,function(e){return"owner"===e.type}),r=e.find(n,function(e){return"group"===e.type});o&&o.permissions&&r&&!r.permissions&&(n=e.reject(n,function(e){return"group"===e.type&&!e.permissions})),o&&!o.permissions&&r&&r.permissions&&(n=e.reject(n,function(e){return"owner"===e.type&&!e.permissions})),o&&!o.permissions&&r&&!r.permissions&&(n=e.reject(n,function(e){return"group"===e.type&&!e.permissions}))}else e.isObject(n)&&(n=[],i.results.data.permissions&&i.results.data.permissions.permissions.length>0&&n.push(i.results.data.permissions));i.results.data.permissions=n}}})}}}),csui.define("csui/models/permission/server.adaptor.mixin",["csui/lib/underscore","csui/utils/url"],function(e,i){"use strict";return{"mixin":function(t){return e.extend(t,{"makeServerAdaptor":function(e){return this},"url":function(){var e,t=i.combine(this.connector.getConnectionUrl().getApiBase("v2"),"nodes",this.options.node.get("id"));return this.options.memberId?(t+="/permissions/effective/"+this.options.memberId,e=i.combineQueryString({"expand":"permissions{right_id}"},e)):e=i.combineQueryString({"fields":["properties{container, name, type, versions_control_advanced, permissions_model}","permissions{right_id, permissions, type}","versions{version_id}"],"expand":["permissions{right_id}"]},e),e&&(t+="?"+e),t},"parse":function(e,i){if(e.results&&e.results.data&&(this.parsePermissionResponse(e,i,this.options.clearEmptyPermissionModel),!this.options.node.get("isNotFound")))return this.nodeName=e.results.data.properties?e.results.data.properties.name:"",(void 0===this.isContainer||e.results.data.properties)&&(this.isContainer=!e.results.data.properties||e.results.data.properties.container),e.results.data.permissions}})}}}),csui.define("csui/models/permission/nodeuserpermissions",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/permission/nodepermission.model","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/browsable/browsable.mixin","csui/models/browsable/v2.response.mixin","csui/models/mixins/v2.expandable/v2.expandable.mixin","csui/models/permission/permission.response.mixin","csui/models/permission/server.adaptor.mixin"],function(e,i,t,s,n,o,r,a,c,u,l,d,m){"use strict";var p=e.config();t.defaults(p,{"defaultPageSize":30});var f=s.Collection.extend({"model":o,"constructor":function(e,i){i=t.defaults({},i,{"top":p.defaultPageSize},i),s.Collection.prototype.constructor.apply(this,arguments),this.makeFetchable(i),this.options=i,this.includeActions=i.includeActions,this.query=this.options.query,this.makeConnectable(i).makeFetchable(i).makeBrowsable(i).makeBrowsableV2Response(i).makePermissionResponse(i)},"isFetchable":function(){return!0},"setOrder":function(e,i){if(this.orderBy!=e)return this.orderBy=e,!1!==i&&this.fetch({"skipSort":!1}),!0},"processForEmptyOwner":function(){this.findWhere({"type":"owner"})||this.findWhere({"type":"group"})||this.add({"permissions":null,"right_id":null,"type":"owner"},{"at":0})},"addPublicAccess":function(e){this.findWhere({"type":"owner"})&&this.findWhere({"type":"group"})?this.add(e,{"at":2}):this.add(e,{"at":1})},"addOwnerOrGroup":function(e,i){var t=this.findWhere({"type":"owner"});if(t&&null===t.get("permissions")){var s=this.at(0);this.remove(s,{"silent":i}),this.add(e,{"at":0})}else this.add(e,{"at":"owner"===e.get("type")?0:1})}});return a.mixin(f.prototype),c.mixin(f.prototype),u.mixin(f.prototype),r.mixin(f.prototype),l.mixin(f.prototype),d.mixin(f.prototype),m.mixin(f.prototype),f}),csui.define("csui/models/server.module/server.module.collection",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone"],function(e,i,t,s){"use strict";var n=e.config().modules||{},o=i.map(n,function(e,i){return e.id=i,e}),r=s.Model.extend({"defaults":{"id":null,"title":null},"constructor":function e(i,t){e.__super__.constructor.apply(this,arguments)}});return s.Collection.extend({"model":r,"constructor":function e(i,t){i||(i=o),e.__super__.constructor.call(this,i,t)},"sync":function(e,i,t){if("read"!==e)throw new Error("Only fetching the server modules is supported.");var s=this;return t||(t={}),this._resolveServerModules().then(function(){var e=s.toJSON();t.success&&t.success(e,t),s.trigger("sync",s,e,t)})},"_resolveServerModules":function(e){e=i.extend({},this.options,e);var s=t.Deferred(),o=this.find(function(i){var t=n[i.id];if(t)i.set(t.attributes);else if(!e.ignoreErrors)return!0});if(o){var r=new Error("Invalid module prefix: "+o.id);return s.reject(r)}return s.resolve().promise()}})}),csui.define("csui/models/specificnodemodel",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/mixins/node.resource/node.resource.mixin"],function(e,i,t,s){"use strict";var n=i.Model.extend({"constructor":function(e,t){this.options=t||(t={}),i.Model.prototype.constructor.call(this,arguments),this.makeNodeResource(t)},"parse":function(e){return e},"url":function(){var i,s=this.options.node,n=s.get("id");return i=e.str.sformat("forms/nodes/properties/specific?id={0}",n),t.combine(this.options.connector.connection.url,i)}});return s.mixin(n.prototype),n}),csui.define("csui/models/mixins/versions/v2.versions.response.mixin",["csui/lib/underscore"],function(e){"use strict";function i(i,t){t.actions=[],e.each(i.data,function(e){e.signature=e.name,t.actions.push(e)})}return{"mixin":function(t){return e.extend(t,{"makeVersionableV2Response":function(e){return this},"parseVersionsResponse":function(e){return e.results&&e.results.data?(e.results.actions&&i.call(this,e.results.actions,e.results.data.versions),e.results.data.versions):e}})}}}),csui.define("csui/models/server.adaptors/version.mixin",["csui/lib/underscore","csui/utils/url"],function(e,i){"use strict";return{"mixin":function(t){return e.extend(t,{"makeServerAdaptor":function(e){return this},"url":function(){var e=i.combine(this.connector.getConnectionUrl().getApiBase("v2"),"nodes",this.get("id"),"versions");if(!this.isNew()){e=i.combine(e,this.get("version_number"));var t=i.combineQueryString(this.getExpandableResourcesUrlQuery(),this.getRequestedCommandsUrlQuery());t&&(e+="?"+t)}return e},"parse":function(i){var t=i.data||this.parseVersionsResponse(i);if(t.id_expand&&t.id_expand.type&&(t.type=t.id_expand.type),t.version_number_name&&(t.version_number_name_formatted=t.version_number_name),t.commands){var s=t.commands;t.actions=e.chain(s).keys().map(function(e){var i=s[e];return i.signature=e,i}).value(),delete t.commands,
delete t.commands_map,delete t.commands_order}return t}})}}}),csui.define("csui/models/version",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/url","csui/models/actions","csui/models/mixins/v2.delayed.commandable/v2.delayed.commandable.mixin","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/resource/resource.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/mixins/versions/v2.versions.response.mixin","csui/models/server.adaptors/version.mixin","csui/utils/deepClone/deepClone"],function(e,i,t,s,n,o,r,a,c,u,l,d){"use strict";var m=t.Model.extend({"idAttribute":"version_number","constructor":function(e,s){e||(e={}),s=i.extend({"expand":["user","versions{id, owner_id}"]},s),this.lazyActionsDisabled=s.lazyActionsDisabled||!0,t.Model.prototype.constructor.call(this,e,s),this.makeResource(s).makeUploadable(s).makeVersionableV2Response(s).makeDelayedCommandableV2(s).makeExpandable(s).makeServerAdaptor(s),e.actions||(this.actions=new o)},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector,"expand":i.deepClone(this.expand)})},"set":function(e,i,s){var n;return null==e?this:("object"==typeof e?(n=e,s=i):(n={})[e]=i,s||(s={}),n.actions&&(this.actions?this.actions.reset(n.actions,s):this.actions=new o(n.actions)),t.Model.prototype.set.call(this,n,s))},"isNew":function(){return!this.has("version_number")},"isFetchable":function(){return!(!this.get("id")||!this.get("version_number"))}});return a.mixin(m.prototype),u.mixin(m.prototype),c.mixin(m.prototype),r.mixin(m.prototype),l.mixin(m.prototype),d.mixin(m.prototype),m}),csui.define("csui/models/view.state.model",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/log","csui/utils/url","csui/utils/namedsessionstorage"],function(e,i,t,s,n,o){"use strict";var r;csui.require(["i18n!csui/pages/start/nls/lang"],function(e){r=e}.bind(this));var a=Object.freeze({"LAST_ROUTER":"lastRouter","CURRENT_ROUTER":"currentRouter","CURRENT_ROUTER_FRAGMENT":"currentRouterFragment","CURRENT_ROUTER_NAVIGATE_OPTIONS":"currentRouterNavigateOptions","CURRENT_ROUTER_SCOPE_ID":"currentRouterScopeId","BACK_TO_TITLE":"back_to_title","METADATA_CONTAINER":"metadata_container","STATE":"state","DEFAULT_STATE":"default_state","SESSION_STATE":"session_state","NAVIGATION_HISTORY_ARRAY":"navigationHistoryArray","URL_PARAMS":"urlParams","ALLOW_WIDGET_URL_PARAMS":"allowWidgetUrlParams","START_ID":"start_id","BREADCRUMB":"breadcrumb","QUERY_STRING_PARAMS":"query_string_params"}),c=0;return t.Model.extend({"constructor":function(s,n){t.Model.prototype.constructor.apply(this,arguments),0===c?this.storage=new o(e.id):(this.storage=new o(e.id+"_"+c),this.storage.destroy()),c++,this.set("enabled",!!s&&s.enabled),this._navigationHistory=[],i.values(a).forEach(function(e){var t=s?s[e]:this.storage.get(e);!t||-1===e.indexOf("Array")&&-1===e.indexOf("urlParams")||(t=i.isString(t)?JSON.parse(t):t),this.listenTo(this,"change:"+e,this._syncWithStorage.bind(this,e)),this.set(e,t)}.bind(this)),this._navigationHistory=this.get(a.NAVIGATION_HISTORY_ARRAY)||[]},"CONSTANTS":a,"_setViewStateAttribute":function(e,t,s,n){if(n||(n={}),this._getViewStateAttribute(e,t)!==s){var o=this.get(e)||{};return o=i.clone(o),void 0===s||""===s?delete o[t]:o[t]=s,n=i.omit(n,"encode"),this.set(e,o,n),this._syncWithStorageIfSilentUpdate(e,n),!0}},"_getViewStateAttribute":function(e,i,t){var s=this.get(e);if(s)return s[i]},"setViewState":function(e,i,t){if("state"!==e)return this._setViewStateAttribute(a.STATE,e,i,t);this.set(a.STATE,i,t),this._syncWithStorageIfSilentUpdate(a.STATE,t)},"getViewState":function(e,i){return this._getViewStateAttribute(a.STATE,e,i)},"setDefaultViewState":function(e,i,t){return this._setViewStateAttribute(a.DEFAULT_STATE,e,i,t)},"getDefaultViewState":function(e,i){return this._getViewStateAttribute(a.DEFAULT_STATE,e,i)},"setSessionViewState":function(e,t,s){if(s||(s={}),this.getSessionViewState(e)!==t){var n=this.get(a.SESSION_STATE)||{};return n=i.clone(n),n[e]=t,this.set(a.SESSION_STATE,n,s),this._syncWithStorageIfSilentUpdate(a.SESSION_STATE,s),!0}},"getSessionViewState":function(e){var i=this.get(a.SESSION_STATE);if(i)return i[e]},"_syncWithStorageIfSilentUpdate":function(e,i){i&&i.silent&&this._syncWithStorage(e)},"_syncWithStorage":function(e){var t=this.get(e);i.isArray(t)&&(t=JSON.stringify(t)),this.storage.set(e,t)},"getCurrentRouterName":function(){return this.get(this.CONSTANTS.CURRENT_ROUTER)},"onNavigationStarted":function(e,i){this.trigger("before:navigate"),this.set("navigated",!0);var t=this.isSameRoutingInfo(e,this.getLastHistoryEntry());i||(t=!1),this.set(this.CONSTANTS.LAST_ROUTER,this.get(this.CONSTANTS.CURRENT_ROUTER)),t?(this._currentHistoryEntry=void 0,this._restoreStatesFromHistoryEntry(this._navigationHistory.pop()),this.unset(a.NAVIGATION_HISTORY_ARRAY,{"silent":!0}),this.set(a.NAVIGATION_HISTORY_ARRAY,this._navigationHistory)):this._savePotentialHistoryEntry()},"_savePotentialHistoryEntry":function(){var e=this.storage,i=e.get(a.CURRENT_ROUTER);if(i){var t=this.get("saved_viewstate");t||(t=this.storage.get(a.STATE));var s=this.get("PerspectiveRouting").getRouter(i);this._currentHistoryEntry={"router":i,"back_to_title":this.storage.get(a.BACK_TO_TITLE),"urlParam":s&&s.urlParams,"fragment":this.storage.get(a.CURRENT_ROUTER_FRAGMENT),"scopeId":this.storage.get(a.CURRENT_ROUTER_SCOPE_ID),"navigateOptions":this.storage.get(a.CURRENT_ROUTER_NAVIGATE_OPTIONS),"state":t,"sessionState":this.storage.get(a.SESSION_STATE),"defaultState":this.storage.get(a.DEFAULT_STATE)}}},"getPotentialHistoryEntry":function(){return this._currentHistoryEntry},"onContextFetch":function(){this.trigger("navigate",this._currentHistoryEntry),this.unset("isFromHistory",{"silent":!0}),this._currentHistoryEntry&&this._addRouterInfoToHistory(this._currentHistoryEntry)},"_restoreStatesFromHistoryEntry":function(e){if(e){var i={"isFromHistory":!0,"state":e.state,"default_state":e.defaultState,"session_state":e.sessionState};this.set(i,{"silent":!0}),["state","default_state","session_state"].forEach(function(e){this._syncWithStorage(e)}.bind(this))}},"_addRouterInfoToHistory":function(e){this._navigationHistory.length>0&&JSON.stringify(e)===JSON.stringify(this._navigationHistory[this._navigationHistory.length-1])||(this._navigationHistory.push(e),this._navigationHistory.length>50&&this._navigationHistory.shift(),this.unset(a.NAVIGATION_HISTORY_ARRAY,{"silent":!0}),this.set(a.NAVIGATION_HISTORY_ARRAY,this._navigationHistory))},"_copyAttributes":function(e){Object.keys(e.attributes).forEach(function(i){this.unset(i),this.set(i,e.get(i))}.bind(this))},"saveHistory":function(){this.savedViewStateModel=this.clone(),this.savedViewStateModel._copyAttributes(this),this._resetAttributes()},"_resetAttributes":function(){this._navigationHistory=[],this.unset(a.NAVIGATION_HISTORY_ARRAY,{"silent":!0}),this.set(a.NAVIGATION_HISTORY_ARRAY,this._navigationHistory),this.set(a.LAST_ROUTER,void 0),this.set(a.CURRENT_ROUTER,void 0),this.set(a.CURRENT_ROUTER_FRAGMENT,void 0),this.set(a.CURRENT_ROUTER_NAVIGATE_OPTIONS,void 0),this.set(a.CURRENT_ROUTER_SCOPE_ID,void 0),this.set(a.BACK_TO_TITLE,void 0),this.set(a.METADATA_CONTAINER,void 0),this.set(a.STATE,void 0),this.set(a.DEFAULT_STATE,void 0),this.set(a.SESSION_STATE,void 0),this.set(a.URL_PARAMS,void 0),this.set(a.ALLOW_WIDGET_URL_PARAMS,void 0),this.set(a.SESSION_STATE,void 0),this.set(a.START_ID,void 0),this.set(a.BREADCRUMB,void 0)},"restoreHistory":function(){if(this.savedViewStateModel){this._copyAttributes(this.savedViewStateModel),this.savedViewStateModel.clean(),this.savedViewStateModel=void 0;var e=this.storage.get(a.NAVIGATION_HISTORY_ARRAY);e&&(e=JSON.parse(e),this._navigationHistory=e)}},"hasRouted":function(){return this._navigationHistory.length>0},"isSameRoutingInfo":function(e,i){return e&&i&&e.router===i.router&&e.fragment===i.fragment},"clean":function(){this.clear(),this.storage.destroy()},"getBackToTitle":function(){var e=r.back;if(this._currentHistoryEntry)e=this._currentHistoryEntry.back_to_title||e;else{var i=this.getLastRouterIndex();if(-1!==i){var t=this._navigationHistory[i];t&&(e=t.back_to_title||e)}}return e},"clearHistory":function(){this._navigationHistory=[],this.unset(a.NAVIGATION_HISTORY_ARRAY,{"silent":!0}),this.set(a.NAVIGATION_HISTORY_ARRAY,this._navigationHistory)},"clearCurrentHistoryEntry":function(){this._currentHistoryEntry=void 0},"getLastRouterIndex":function(){var e=-1,i=this._navigationHistory;if(i&&i.length>0)for(var t=i.length-1;t>=0;t--)if(i[t].router!==this.get(a.CURRENT_ROUTER)){e=t;break}return e},"getIndexOfOfLastApplicationScope":function(){var e=-1,i=this._navigationHistory;if(i&&i.length>0)for(var t=i.length-1;t>=0;t--)if(i[t].scopeId!==this.get(a.CURRENT_ROUTER_SCOPE_ID)){e=t;break}return e},"getLastHistoryEntry":function(){return this._navigationHistory&&this._navigationHistory.length>0&&this._navigationHistory[this._navigationHistory.length-1]},"getHistory":function(){return this._navigationHistory},"restoreRouterOfLastApplicationScope":function(){this._restoreHistoryEntryByIndex(this.getIndexOfOfLastApplicationScope())},"restoreLastRouter":function(){this._restoreHistoryEntryByIndex(this.getLastRouterIndex())},"restoreLastFragment":function(){this._restoreHistoryEntryByIndex(this._navigationHistory.length-1)},"restoreHistoryEntryByIndex":function(e){return this._restoreHistoryEntryByIndex(e)},"_restoreHistoryEntryByIndex":function(e){if(-1!==e&&e<this._navigationHistory.length){this._navigationHistory.length=e+1;var i=this.getLastHistoryEntry();this._restoreStatesFromHistoryEntry(i),this.get("PerspectiveRouting").restoreRouter(i)}else window.history.back()},"addUrlParameters":function(e,i,t,s){if(s||this.get(this.CONSTANTS.ALLOW_WIDGET_URL_PARAMS)){var n=this.get("PerspectiveRouting"),o=this.get("activeRouterInstance"),r=o&&o.name;return r=r||this.get(a.CURRENT_ROUTER),n&&n.addUrlParameters(r,e,t)}},"clear":function(){this.storage.destroy(),this._navigationHistory=[],this._currentHistoryEntry=void 0,t.Model.prototype.clear.call(this,{"silent":!0})},"hasNotNavigatedAndNotJustStarted":function(){}},{"CONSTANTS":a,"clean":function(){new o(e.id).destroy()}})}),csui.define("csui/models/perspective/personalization.server.adaptor.mixin",["csui/lib/underscore","csui/lib/jquery","csui/utils/url"],function(e,i,t){"use strict";return{"mixin":function(i){return e.extend(i,{"makeServerAdaptor":function(e){return this},"url":function(){var e=this.get("perspective_id"),i=new t(this.connector.connection.url).getApiBase("v2");if(!e)throw new Error("Unsupported perspective_id value");return i=t.combine(i,"perspectives",e,"personalization")}})}}}),csui.define("csui/models/perspective/localstorage.server.adaptor.mixin",["csui/lib/underscore","csui/lib/jquery","csui/utils/url","csui/utils/namedlocalstorage"],function(e,i,t,s){"use strict";return{"mixin":function(t){return e.extend(t,{"makeServerAdaptor":function(e){return this},"getStorage":function(){var e=i.Deferred(),t=this;return csui.require(["csui/utils/contexts/factories/user"],function(i){var n=t.options.context.getModel(i),o=n.get("id");if(!o){var r=t.options.context.getFactory(i);r.initialResponse&&(o=r.initialResponse.data.id)}return t.namedLocalStorage||(t.namedLocalStorage=new s("perspective:personalization:"+o)),t.namedLocalStorage,e.resolve(t.namedLocalStorage)},e.reject),e},"savePerspective":function(){var e=this;return this.getStorage().then(function(i){return i.set(e.getNodeId(),e.toJSON())})},"fetchPerspective":function(){var e=this;return this.getStorage().then(function(i){return i.get(e.getNodeId())})},"sync":function(t,s,n){var o=i.Deferred();switch(t){case"create":case"update":case"patch":s.savePerspective().then(function(){o.resolve(this)},o.reject);break;case"read":s.fetchPerspective().then(function(i){e.isEmpty(i)||s.set(i),o.resolve(s)},o.reject);break;default:o.reject()}return o.promise()}})}}}),csui.define("csui/utils/perspective/perspective.util",["module"],function(e){function i(e){return!!(e&&e.schema&&e.schema.required&&e.schema.required.length>0)}function t(e){return e=e||{},!e.callback&&!i(e)}function s(){return f}function n(e){switch(e){case p.MODE_PERSONALIZE:return p.WIDGET_SHORTCUTS;default:return p.WIDGET_PERSPECTIVE_PLACEHOLDER}}function o(e,i){return e.type===p.WIDGET_PERSPECTIVE_PLACEHOLDER||n(i)===e.type&&e.options&&e.__isPlacehoder}function r(e){var i=p.WIDGET_ID_PERSPECTIVE_PREFIX;return e===p.MODE_PERSONALIZE&&(i=p.WIDGET_ID_PESONALIZATION_PREFIX),i+ +new Date}function a(e){var i=e&&e[p.KEY_WIDGET_ID];return!!i&&c(i)}function c(e){return e&&e.substr(0,p.WIDGET_ID_PESONALIZATION_PREFIX.length)===p.WIDGET_ID_PESONALIZATION_PREFIX}function u(e){return e&&!!e[p.KEY_WIDGET_ID]}function l(e){return e&&"csui/widgets/error"===e.type}function d(e){return l(e)?d(e.options.originalWidget):e&&!a(e)&&!0===e[p.KEY_HIDDEN]}function m(e,i){l(e)?m(e.options.originalWidget,i):e&&(e[p.KEY_HIDDEN]=i)}var p=Object.freeze({"MODE_EDIT_PERSPECTIVE":"edit","MODE_PERSONALIZE":"personalize","WIDGET_PERSPECTIVE_PLACEHOLDER":"csui/perspective.manage/widgets/perspective.placeholder","WIDGET_SHORTCUTS":"csui/widgets/shortcuts","KEY_WIDGET_ID":"w_id","KEY_HIDDEN":"hidden","WIDGET_ID_PERSPECTIVE_PREFIX":"pman-","WIDGET_ID_PESONALIZATION_PREFIX":"personal-"}),f=[p.KEY_WIDGET_ID,p.KEY_HIDDEN];return{"MODE_EDIT_PERSPECTIVE":p.MODE_EDIT_PERSPECTIVE,"MODE_PERSONALIZE":p.MODE_PERSONALIZE,"WIDGET_PERSPECTIVE_PLACEHOLDER":p.WIDGET_PERSPECTIVE_PLACEHOLDER,"WIDGET_SHORTCUTS":p.WIDGET_SHORTCUTS,"KEY_WIDGET_ID":p.KEY_WIDGET_ID,"WIDGET_ID_PERSPECTIVE_PREFIX":p.WIDGET_ID_PERSPECTIVE_PREFIX,"WIDGET_ID_PESONALIZATION_PREFIX":p.WIDGET_ID_PESONALIZATION_PREFIX,"isEligibleForLiveWidget":t,"hasRequiredFields":i,"isEmptyPlaceholder":o,"getExtraWidgetKeys":s,"getEmptyPlaceholderWidgetType":n,"generateWidgetId":r,"isPersonalWidget":a,"isPersonalWidgetId":c,"hasWidgetId":u,"isHiddenWidget":d,"setWidgetHidden":m}}),csui.define("csui/models/perspective/personalize/delta.generator",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/perspective/perspective.util"],function(e,i,t,s){var n=function(e){this.personalization=e.personalization,this.perspective=e.perspective,this.perspective instanceof t.Model&&(this.perspective=this.perspective.toJSON())};return i.extend(n.prototype,{"getDeltaOfCurrentPerspective":function(e,t){e=i.reject(e,s.isPersonalWidget);var n=i.pluck(e,s.KEY_WIDGET_ID),o=i.filter(t,s.isPersonalWidget),r=i.partition(t,s.isHiddenWidget);return{"perspectiveWidgets":n,"personalWidgets":o,"order":i.pluck(r[1],s.KEY_WIDGET_ID),"hidden":i.pluck(r[0],s.KEY_WIDGET_ID)}},"getDelta":function(){var e=i.pick(this.perspective,"type","perspective_id","perspective_version");switch(e.perspective_id=e.perspective_id||this.perspective.id,this.perspective.override?i.extend(e,i.pick(this.perspective.override,"perspective_id","perspective_version")):e.perspective_version=e.perspective_version||1,this.perspective.type){case"flow":var t=this.getDeltaOfCurrentPerspective(this.perspective.options.widgets,this.personalization.options.widgets);return i.extend(e,t),e;case"sidepanel-right":case"sidepanel-left":return i.extend(e,{"banner":this.getDeltaOfCurrentPerspective(this.perspective.options.banner,this.personalization.options.banner),"content":this.getDeltaOfCurrentPerspective(this.perspective.options.content,this.personalization.options.content),"sidebar":this.getDeltaOfCurrentPerspective(this.perspective.options.sidebar,this.personalization.options.sidebar)}),e;default:throw new Error("Personalization not supported.")}}}),n}),csui.define("csui/models/perspective/personalize/delta.resolver",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/perspective/perspective.util"],function(e,i,t,s){var n=function(e){this.delta=e.delta,this.perspective=e.perspective,this.perspective instanceof t.Model&&(this.perspective=this.perspective.toJSON())};return i.extend(n.prototype,{"resolveContent":function(e,t){t=this.delta[t];var n,o,r,a,c,u=this.delta.personalWidgets||t&&t.personalWidgets,l=this.delta.order||t&&t.order,d=this.delta.hidden||t&&t.hidden;return u=this.delta.personalWidgets||t&&t.personalWidgets,n=i.indexBy(u,s.KEY_WIDGET_ID),o=i.indexBy(e,s.KEY_WIDGET_ID),l=i.filter(l,function(e){return i.has(o,e)||i.has(n,e)}),d=i.filter(d,function(e){return i.has(o,e)}),r=i.filter(e,function(e){var t=e[s.KEY_WIDGET_ID];return!i.contains(l,t)&&!i.contains(d,t)}),a=i.map(l,function(e){return s.isPersonalWidgetId(e)?n[e]:o[e]}),c=i.map(d,function(e){var t=i.clone(o[e]);return s.setWidgetHidden(t,!0),t}),i.union(a,r,c)},"canMergeDelta":function(){return this.perspective.perspectiveId===this.delta.perspectiveId&&this.perspective.type===this.delta.type||"sidepanel-right"===this.delta.type&&"sidepanel-left"===this.perspective.type||"sidepanel-left"===this.delta.type&&"sidepanel-right"===this.perspective.type},"getPersonalization":function(){if(!this.canMergeDelta())return this.perspective;var e=i.clone(this.perspective);switch(this.delta.type){case"flow":return i.extend(e,{"options":{"widgets":this.resolveContent(this.perspective.options.widgets)},"personalizations":this.delta}),e;case"sidepanel-right":case"sidepanel-left":return i.extend(e,{"options":{"content":this.resolveContent(this.perspective.options.content,"content"),"sidebar":this.resolveContent(this.perspective.options.sidebar,"sidebar"),"banner":this.resolveContent(this.perspective.options.banner,"banner")},"personalizations":this.delta}),e;default:return e}}}),n}),csui.define("csui/models/perspective/personalize/personalize.guide",["module","csui/models/perspective/personalize/delta.generator","csui/models/perspective/personalize/delta.resolver"],function(e,i,t){return{"getDelta":function(e,t){return new i({"perspective":e,"personalization":t}).getDelta()},"getPersonalization":function(e,i){return new t({"perspective":e,"delta":i}).getPersonalization()}}}),csui.define("csui/models/perspective/personalization.model",["require","module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/models/node/node.model","csui/models/mixins/uploadable/uploadable.mixin","csui/models/mixins/connectable/connectable.mixin","csui/models/perspective/personalization.server.adaptor.mixin","csui/models/perspective/localstorage.server.adaptor.mixin","csui/models/perspective/personalize/personalize.guide","csui/utils/perspective/perspective.util"],function(e,i,t,s,n,o,r,a,c,u,l,d){"use strict";var m=s.extend({"persistOnLocalStorage":!1},i.config()),p=n.Model.extend({"constructor":function e(i,t){e.__super__.constructor.apply(this,arguments),this.options=t,m.persistOnLocalStorage?this.makeServerAdaptor(t):this.makeUploadable(t).makeConnectable(t).makeServerAdaptor(t),this.resolvePersonalization=!0},"getPerspectiveId":function(){return this.get("perspective_id")},"getPerspective":function(){return this.resolvePersonalization||this.personalization,this.personalization=l.getPersonalization(this.options.perspective,this.toJSON()),this.resolvePersonalization=!1,this.personalization},"setPerspective":function(e,i){var t=l.getDelta(this.options.perspective,e);this.set(t,i),this.resolvePersonalization=!0},"update":function(e,i){var t=this.getPerspective();s.extend(t,e.perspective),this.setPerspective(t,i)},"prepareFormData":function(e,i){return{"personalizations":JSON.stringify(e),"perspective_id":this.get("perspective_id"),"perspective_version":this.get("perspective_version"),"node":this.getNodeId()}},"getNodeId":function(){return this.options.sourceModel&&this.options.sourceModel instanceof o&&this.options.sourceModel.has("id")?this.options.sourceModel.get("id"):"landing-page"}},{"loadPersonalization":function(e,i){var n,o=e.get("perspective");if(!o)return t.Deferred().resolve().promise();if(m.persistOnLocalStorage)n=p.loadPersonalizationFromLocalStorage(e,i,o);else if(o.personalizations){var r=new p(o.personalizations,{"sourceModel":e,"perspective":o});n=t.Deferred().resolve(r.getPerspective())}else n=t.Deferred().resolve();return n.then(function(e){if(e&&!s.isEmpty(e))return s.defaults(e,{"perspectiveMode":d.MODE_PERSONALIZE})}),n.promise()},"loadPersonalizationFromLocalStorage":function(e,i,n){var o=t.Deferred(),r=new p({},{"sourceModel":e,"context":i,"perspective":n});return r.fetch().then(function(){var e=r.getPerspective();s.isEmpty(e)?o.resolve():o.resolve(e)},function(e){o.reject(e)}),o.promise()}});return m.persistOnLocalStorage?u.mixin(p.prototype):(r.mixin(p.prototype),a.mixin(p.prototype),c.mixin(p.prototype)),p}),csui.define("csui/models/compound.document/reorganize/server.adaptor.mixin",["csui/lib/underscore","csui/lib/jquery","csui/utils/url"],function(e,i,t){"use strict";return{"mixin":function(i){return e.extend(i,{"makeServerAdaptor":function(e){return this},"url":function(){var e=this.connector.connection.url.replace("/v1","/v2"),i=t.combineQueryString({"expand":"properties{original_id}"});return t.combine(e,"nodes/"+this.options.nodeId+"/nodes/all?"+i)},"parse":function(e,i){return e.results}})}}}),csui.define("csui/models/compound.document/reorganize/reorganize.collection",["csui/lib/underscore","csui/lib/backbone","nuc/models/browsable/browsable.mixin","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","nuc/models/browsable/v1.request.mixin","csui/models/browsable/v2.response.mixin","csui/models/node/node.model","csui/models/compound.document/reorganize/server.adaptor.mixin","csui/models/mixins/v2.additional.resources/v2.additional.resources.mixin","csui/models/mixins/v2.fields/v2.fields.mixin","csui/models/mixins/v2.expandable/v2.expandable.mixin","csui/models/mixins/state.requestor/state.requestor.mixin","csui/models/mixins/v2.delayed.commandable/v2.delayed.commandable.mixin"],function(e,i,t,s,n,o,r,a,c,u,l,d,m,p){var f=i.Collection.extend({"model":a,"constructor":function(e,t){this.options=t||{},i.Collection.prototype.constructor.call(this,e,t),this.makeConnectable(t).makeFetchable(t).makeBrowsableV2Response(t).makeAdditionalResourcesV2Mixin(t).makeFieldsV2(t).makeExpandableV2(t).makeStateRequestor(t).makeServerAdaptor(t)}});return t.mixin(f.prototype),o.mixin(f.prototype),r.mixin(f.prototype),s.mixin(f.prototype),n.mixin(f.prototype),c.mixin(f.prototype),u.mixin(f.prototype),l.mixin(f.prototype),d.mixin(f.prototype),m.mixin(f.prototype),p.mixin(f.prototype),f}),csui.define("csui/models/widget/widget.model",["require","module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/log","csui/models/server.module/server.module.collection","csui/models/tool.item.config/tool.item.config.collection","csui/models/tool.item.mask/tool.item.mask.collection"],function(e,i,t,s,n,o,r,a,c){"use strict";o=o(i.id);var u=n.Model.extend({"defaults":{"id":null,"view":null,"manifest":null,"error":null},"constructor":function e(i,s){this.options=t.defaults({},s,{"includeView":!0,"includeManifest":!0,"includeServerModule":!0,"includeToolItems":!0}),this.options.includeToolItems&&(this.options.includeManifest=!0),e.__super__.constructor.call(this,i,this.options),this.serverModule=new r.prototype.model,this.actions=new n.Collection},"getDefaultData":function(){var e=this.get("manifest");return e?this._getDefaultPropertyValue(e.schema):{}},"_getDefaultPropertyValue":function(e){if(e)return"object"===e.type?t.reduce(e.properties,function(e,i,t){return e[t]=this._getDefaultPropertyValue(i),e},{},this):e.default},"_getDefaultPrimitiveValue":function(e){if(e){var i=e.default;if(void 0!==i)return i;switch(e.type){case"string":return"";case"integer":case"number":return 0;case"boolean":return!1;case"array":return[];case"null":return null}}},"sync":function(e,i,n){if("read"!==e)throw new Error("Only fetching the widget is supported.");n=t.extend({},this.options,n),t.defaults(n,{"includeView":this.options.includeView,"includeManifest":this.options.includeManifest,"includeServerModule":this.options.includeServerModule,"includeToolItems":this.options.includeToolItems}),n.includeToolItems&&(n.includeManifest=!0);var o=this._resolveServerModules(n),r=this._resolveToolItems(n),a=this._resolveToolItemMasks(n),c=this;return s.when(o,r,a).then(t.bind(this._resolveWidget,this,n)).then(function(){var e=c.toJSON();n.success&&n.success(e,n),c.trigger("sync",c,e,n)},function(){var e=c.get("error");return n.error&&n.error(e,n),c.trigger("error",c,e,n),s.Deferred().reject(e)})},"_resolveWidget":function(e){var i=this._resolveView(e),t=this._resolveManifest(e),n=this;return s.when(i,t).then(function(){n._updateServerModule(e),n._updateActions(e)})},"_resolveView":function(i){var t=s.Deferred();if(i.includeView){var n=this,o=this.getModuleData(),r=this.getViewModulePath(o);e([r],function(e){n.set("view",e),t.resolve()},function(e){n.set("error",e),i.ignoreErrors?t.resolve():t.reject(e)})}else t.resolve();return t.promise()},"_resolveManifest":function(i){var t=s.Deferred();if(i.includeManifest){var n=this,o=this.getModuleData(),r=this.getManifestModulePath(o);e([r],function(s){if(n._needsLocalization(s)){var a=n.getLocalizedManifestModulePath(o);e([a],function(e){s=u.resolveLocalizedManifest(r,s,e),n.set("manifest",s),t.resolve()},function(e){n.has("error")||n.set("error",e),i.ignoreErrors||i.ignoreManifestErrors?(n.set("manifest",s),t.resolve()):t.reject(e)})}else n.set("manifest",s),t.resolve()},function(e){n.has("error")||n.set("error",e),i.ignoreErrors||i.ignoreManifestErrors?(n.set("manifest",{}),t.resolve()):t.reject(e)})}else t.resolve();return t.promise()},"_resolveServerModules":function(e){var i;return e.includeServerModule&&!e.serverModules?(e.serverModules=i=new r,i.fetch({"ignoreErrors":e.ignoreErrors})):s.Deferred().resolve().promise()},"_resolveToolItems":function(e){var i;return e.includeToolItems&&!e.toolItems?(e.toolItems=i=new a,i.fetch({"ignoreErrors":e.ignoreErrors})):s.Deferred().resolve().promise()},"_resolveToolItemMasks":function(e){var i;return e.includeToolItems&&!e.toolItemMasks?(e.toolItemMasks=i=new c,i.fetch({"ignoreErrors":e.ignoreErrors})):s.Deferred().resolve().promise()},"_getModulePrefix":function(){var e=this.get("id"),i=e.indexOf("/");return i<0?"csui":e.substring(0,i)},"getModuleData":function(){var e,i=this.get("id"),t=i.lastIndexOf("/");return t<0?e="csui/widgets/"+i:(e=i,i=i.substring(t+1)),{"name":i,"path":e}},"getViewModulePath":function(e){return e.path+"/"+e.name+".view"},"getManifestModulePath":function(e){return"json!"+e.path+"/"+e.name+".manifest.json"},"getLocalizedManifestModulePath":function(e){return"i18n!"+e.path+"/impl/nls/"+e.name+".manifest"},"_updateServerModule":function(e){if(e.includeServerModule){var i=this._getModulePrefix(),t=e.serverModules.get(i),s=t&&t.toJSON()||{"id":i};this.serverModule.set(s)}},"_updateActions":function(e){if(e.includeToolItems){var i=this.get("manifest"),t=i&&i.actions;this.actions.reset(t,{"silent":!0}),this.actions.each(function(i){i.toolItems=e.toolItems.get(i.get("toolItems")),i.toolItemMasks=e.toolItemMasks.get(i.get("toolItemMasks")),i.toolbars=new n.Collection(i.get("toolbars"))}),e.silent||this.actions.trigger("reset",this.actions,e)}},"_needsLocalization":function(e){function i(e){return"string"==typeof e&&0===e.indexOf("{{")&&e.lastIndexOf("}}")===e.length-2}var s;for(var n in e)if(e.hasOwnProperty(n)){if(s=e[n],i(s))return!0;if(t.isArray(s)){for(var o=0;o<s.length;o++)if(i(s[o]))return!0}else if("object"==typeof s)return this._needsLocalization(s)}}},{"resolveLocalizedManifest":function(e,i,s){function n(i,s){function r(e){return t.isString(e)&&0===e.indexOf("{{")&&e.lastIndexOf("}}")===e.length-2&&e.substring(2,e.length-2)}var a,c,u,l,d,m;for(a in i)if(i.hasOwnProperty(a))if(c=i[a],u=r(c))i[a]=s[u]||s[a]||c;else if(t.isArray(c))for(d=s[a]||[],m=0;m<c.length;++m)l=c[m],u=r(l),u?c[m]=d[m]||s[u]||s[a]||l:t.isObject(l)&&(c[m]=n(l,d[m]||s));else t.isObject(c)&&(s[a]&&o.warn('Hierarchical format has been detected in the localization module "{0}". It has been deprecated and the support for it will be removed. Please, change it to the flat format as soon as possible. Although JSON format allows using nested objects, automated translation tools can handle only key-value pairs. That is why localization modules has to contain only one object with properties pointing to strings.',e)&&console.log(o.last),i[a]=n(c,s[a]||s));return i}return n(i,s)}});return u}),csui.define("csui/models/widget/widget.collection",["require","module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/models/widget/widget.model","csui/models/server.module/server.module.collection","csui/models/tool.item.config/tool.item.config.collection","csui/models/tool.item.mask/tool.item.mask.collection"],function(e,i,t,s,n,o,r,a,c){"use strict";var u=i.config().widgets||[];t.isArray(u)||(u=Array.prototype.concat.apply([],t.values(u))),u=t.map(u,function(e){return{"id":e}});var l=n.Collection.extend({"model":o,"constructor":function e(i,s){this.options=t.defaults({},s,{"includeView":!0,"includeManifest":!0,"includeServerModule":!0,"includeToolItems":!0}),this.options.includeToolItems&&(this.options.includeManifest=!0),i||(i=u),e.__super__.constructor.call(this,i,s)},"sync":function(e,i,n){if("read"!==e)throw new Error("Only fetching the widgets is supported.");var o=this;n=t.extend({},this.options,n),n.includeToolItems&&(n.includeManifest=!0);var r=this._resolveServerModules(n),a=this._resolveToolItems(n),c=this._resolveToolItemMasks(n);return s.when(r,a,c).then(t.bind(this._resolveWidgets,this,n)).then(function(){var e=o.toJSON();n.success&&n.success(e,n),o.trigger("sync",o,e,n)})},"_prepareModel":function(e,i){return i||(i={}),t.defaults(i,{"includeView":this.options.includeView,"includeManifest":this.options.includeManifest,"includeServerModule":this.options.includeServerModule,"includeToolItems":this.options.includeToolItems}),l.__super__._prepareModel.call(this,e,i)},"_resolveServerModules":function(e){var i=e.serverModules;return i||!e.includeServerModule?s.Deferred().resolve().promise():(i=e.serverModules=new r,i.fetch({"ignoreErrors":!1!==e.ignoreErrors}))},"_resolveToolItems":function(e){var i=e.toolItems;return i||!e.includeToolItems?s.Deferred().resolve().promise():(i=e.toolItems=new a,i.fetch({"ignoreErrors":!1!==e.ignoreErrors}))},"_resolveToolItemMasks":function(e){var i=e.toolItemMasks;return i||!e.includeToolItems?s.Deferred().resolve().promise():(i=e.toolItemMasks=new c,i.fetch({"ignoreErrors":!1!==e.ignoreErrors}))},"_resolveWidgets":function(e){var i=this.filter(function(e){return e.has("id")&&!(e.has("view")||e.has("manifest")||e.has("error"))}),n=t.invoke(i,"fetch",{"ignoreErrors":!1!==e.ignoreErrors,"ignoreManifestErrors":!1!==e.ignoreManifestErrors,"includeView":e.includeView,"includeManifest":e.includeManifest,"includeServerModule":e.includeServerModule,"includeToolItems":e.includeToolItems,"serverModules":e.serverModules,"toolItems":e.toolItems,"toolItemMasks":e.toolItemMasks});return s.when.apply(s,n)}});return l}),csui.define("csui/models/zipanddownload/zipanddownload.preflight",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/uploadable/uploadable.mixin"],function(e,i,t,s,n,o,r){"use strict";var a=(i.extend({"idAttribute":null},e.config()),s.Model.extend({"constructor":function(e,i){e||(e={}),i||(i={}),this.options=i,s.Model.prototype.constructor.call(this,e,i),this.options.connector=i.collection&&i.collection.connector||i.container&&i.container.connector||i.nodes.models&&i.nodes.models[0].connector,this.makeConnectable(i).makeUploadable(i)},"urlBase":function(){var e=this.options.connector.getConnectionUrl().getApiBase("v2");return e=n.combine(e,"zipanddownload"),e=this.preflight?n.combine(e,"preflight",""):n.combine(e,"")},"url":function(){var e=this.urlBase();return e},"parse":function(e,i){return e}}));return o.mixin(a.prototype),r.mixin(a.prototype),a}),
csui.define("csui/models/zipanddownload/zipanddownload.stages",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/models/mixins/connectable/connectable.mixin"],function(e,i,t,s,n){"use strict";var o=t.Model.extend({"constructor":function(e,i){this.options=i||(i={}),t.Model.prototype.constructor.apply(this,arguments),this.makeConnectable(i)},"url":function(){var e=this.options.connector.getConnectionUrl().getApiBase("v2");return s.combine(e,"zipanddownload",this.get("id"))},"parse":function(e){return this.updateLocation(e.results.data.jobs),e.results.data.jobs},"updateLocation":function(i){i.complete&&i.unprocessed_items_list&&i.unprocessed_items_list.length>0&&e.each(i.unprocessed_items_list,function(e,i){if(e.path){var t=e.path.split("\\");t.length>0&&""!==t[t.length-1]?e.parentLocation=t[t.length-1]:t.length>0&&(e.parentLocation=t[t.length-2])}})}});return n.mixin(o.prototype),o}),csui.define("csui/utils/mime.types",["csui/lib/underscore"],function(e){"use strict";function i(e){if(!e||-1===e.indexOf("."))return"";var i="";switch(e.split(".").pop()){case"dwg":case"dxf":case"svf":i="drawing/dwg";break;case"jar":case"war":i="application/x-zip";break;case"XLS5":case"xlb":case"xlsx":i="application/vnd.ms-excel";break;case"pptx":case"ppt":i="application/vnd.ms-powerpoint";break;case"docx":case"doc":i="application/msword";break;case"vob":i="video/mpeg";break;case"odf":case"xsm":i="application/vnd.oasis.opendocument.formula"}return i}return{"getMimeType":i}}),csui.define("csui/utils/classic.nodes/classic.nodes",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/mixins/rules.matching/rules.matching.mixin","csui-ext!csui/utils/classic.nodes/classic.nodes"],function(e,i,t,s,n){"use strict";var o=i.Model.extend({"defaults":{"sequence":100,"url":null,"urlQuery":null,"force":!1},"constructor":function(e,t){i.Model.prototype.constructor.apply(this,arguments),this.makeRulesMatching(t)}});s.mixin(o.prototype);var r=i.Collection.extend({"model":o,"comparator":"sequence","constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments)},"findByNode":function(e,i){var t=this.find(function(i){return i.matchRules(e,i.attributes)});if(t)return{"url":this._getUrl(t,e,i),"forced":t.get("forced")}},"isForced":function(e,i){return this.some(function(i){return i.get("forced")&&i.matchRules(e,i.attributes)})},"isSupported":function(e,i){return this.some(function(i){return i.matchRules(e,i.attributes)})},"getUrl":function(e,i){var t=this.find(function(i){return i.matchRules(e,i.attributes)});if(t)return this._getUrl(t,e,i)},"_getUrl":function(e,i,s){var n=e.get("url");if(n)"string"==typeof n?n=this._replaceParameters(n,i.attributes):"function"==typeof n&&(n=n(i));else{var o=e.get("urlQuery");if(o){"string"==typeof o?o=this._replaceParameters(o,i.attributes):"function"==typeof o&&(o=o(i));var r=s&&s.connector||i.connector;n=r?new t(r.connection.url).getCgiScript():"",o=t.combineQueryString(o),n=t.appendQuery(n,o)}}return n},"_replaceParameters":function(i,t){for(var s,n,o,r,a=t.attributes,c=/{([^}]+)}/g;s=c.exec(i);)n=s[1].split("."),o=a,e.find(n,function(e){if(null==(o=o[e]))return o="",!0}),r=s.index,i=i.substring(0,r)+encodeURIComponent(o)+i.substring(r+s[0].length);return i}}),a=new r;return n&&a.add(e.flatten(n,!0)),a}),csui.define("csui/utils/defaultactionitems",["csui/lib/underscore","csui/models/actionitems","csui-ext!csui/utils/defaultactionitems"],function(e,i,t){"use strict";var s=new i;return t&&s.add(e.flatten(t,!0)),s}),csui.define("csui/utils/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/utils/impl/nls/root/lang",{"NodeTypeSearchQuery":"Search","NodeTypeSearchForm":"Search form","NodeTypeURL":"Web address","NodeTypeAudio":"Audio","NodeTypeCompressed":"Compressed File","NodeTypeImage":"Image","NodeTypeText":"Text Document","NodeTypeHtml":"Html Document","NodeTypeUnknown":"Unknown","NodeTypeVideo":"Video","NodeTypeDOC":"Microsoft Word","NodeTypePDF":"Portable Document Format","NodeTypePPT":"Microsoft Powerpoint","NodeTypePresentation":"Presentation","NodeTypeXLS":"Microsoft Excel","NodeTypeSpreadsheet":"Spreadsheet","NodeTypeFormula":"Formula","NodeTypePublisher":"Microsoft Publisher","NodeTypeVisio":"Microsoft Visio","NodeTypeMPP":"Microsoft Project","NodeTypeONE":"Microsoft OneNote","NodeTypeSDD":"Document template","NodeTypeDWG":"Autocad Drawing","Loading":"Loading...","NotAvailable":"Not available."}),csui.define("csui/utils/nodesprites",["csui/lib/underscore","csui/lib/backbone","csui/models/mixins/rules.matching/rules.matching.mixin","i18n!csui/utils/impl/nls/lang","csui-ext!csui/utils/nodesprites"],function(e,i,t,s,n){var o=i.Model.extend({"defaults":{"sequence":100,"className":null},"constructor":function(e,t){i.Model.prototype.constructor.apply(this,arguments),this.makeRulesMatching(t)}});t.mixin(o.prototype);var r=i.Collection.extend({"model":o,"comparator":"sequence","constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments)},"findClass":function(i,t,s){var n=this.find(function(n){var o=n.get(i);if(void 0!==o){if(e.isArray(o[t]))for(var r=o[t],a=0;a<r.length;a++)if(r[a]===s)return!0;return o[t]===s}});return n?n.get("className"):void 0},"findTypeByNode":function(i){var t=i.get("type_name")||s.NodeTypeUnknown,n=this.findByNode(i);if(n){var o=e.result(n.attributes,"mimeType");o&&(t=o)}return t},"findClassByNode":function(i){var t=this.findByNode(i);return t&&e.result(t.attributes,"className")||""},"findByNode":function(e){return this.find(function(i){return i.matchRules(e,i.attributes)})}}),a=new r([{"equalsNoCase":{"mime_type":["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.spreadsheetml.template","application/vnd.ms-excel.sheet.macroEnabled.12","application/vnd.ms-excel.template.macroEnabled.12","application/vnd.ms-excel.addin.macroEnabled.12","application/vnd.ms-excel.sheet.binary.macroEnabled.12"]},"className":"csui-icon mime_excel","iconName":"csui_mime_excel","mimeType":s.NodeTypeXLS,"sequence":50},{"equalsNoCase":{"mime_type":["application/visio","application/x-visio","application/vnd.visio","application/visio.drawing","application/vsd","application/x-vsd","image/x-vsd","application/vnd.visio2013","application/vnd.ms-visio.drawing","application/vnd.ms-visio.viewer","application/vnd.ms-visio.stencil","application/vnd.ms-visio.template"]},"className":"csui-icon mime_visio","iconName":"csui_mime_visio","mimeType":s.NodeTypeVisio,"sequence":50},{"equalsNoCase":{"mime_type":["application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.spreadsheet-template","application/vnd.sun.xml.calc","application/vnd.sun.xml.calc.template","application/vnd.stardivision.calc","application/x-starcalc"]},"className":"csui-icon mime_spreadsheet","iconName":"csui_mime_spreadsheet","mimeType":s.NodeTypeSpreadsheet,"sequence":50},{"equalsNoCase":{"mime_type":["application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.presentationml.template","application/vnd.openxmlformats-officedocument.presentationml.slideshow","application/vnd.ms-powerpoint.addin.macroEnabled.12","application/vnd.ms-powerpoint.presentation.macroEnabled.12","application/vnd.ms-powerpoint.template.macroEnabled.12","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"]},"className":"csui-icon mime_powerpoint","iconName":"csui_mime_powerpoint","mimeType":s.NodeTypePPT,"sequence":50},{"equalsNoCase":{"mime_type":["application/vnd.google-apps.presentation","application/x-iwork-keynote-sffkey","application/vnd.wolfram.mathematica","application/vnd.wolfram.player","application/vnd.oasis.opendocument.presentation","application/vnd.oasis.opendocument.presentation-template","application/vnd.sun.xml.impress","application/vnd.sun.xml.impress.template","application/vnd.stardivision.impress","application/vnd.stardivision.impress-packed","application/x-starimpress","application/vnd.lotus-freelance","application/vnd.stardivision.impress","application/vnd.corel-presentations","application/vnd.sun.xml.impress","application/vnd.ms-officetheme","application/vnd.sun.xml.impress.template "]},"className":"csui-icon mime_presentation","iconName":"csui_mime_presentation","mimeType":s.NodeTypePresentation,"sequence":50},{"equalsNoCase":{"mime_type":["application/vnd.ms-publisher","application/x-mspublisher"]},"className":"csui-icon mime_publisher","iconName":"csui_mime_publisher","mimeType":s.NodeTypePublisher,"sequence":50},{"equalsNoCase":{"mime_type":["application/vnd.oasis.opendocument.formula","application/vnd.sun.xml.math","application/vnd.stardivision.math","application/x-starmath"]},"className":"csui-icon mime_formula","iconName":"csui_mime_formula","mimeType":s.NodeTypeFormula,"sequence":50},{"equalsNoCase":{"mime_type":["application/vnd.pdf","application/x-pdf","application/pdf"]},"className":"csui-icon mime_pdf","iconName":"csui_mime_pdf","mimeType":s.NodeTypePDF,"sequence":50},{"equalsNoCase":{"mime_type":["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"]},"className":"csui-icon mime_word","iconName":"csui_mime_word","mimeType":s.NodeTypeDOC,"sequence":50},{"equalsNoCase":{"mime_type":["application/dwg","drawing/dwg"]},"className":"csui-icon mime_dwg","iconName":"csui_mime_dwg","mimeType":s.NodeTypeDWG,"sequence":50},{"equalsNoCase":{"mime_type":["application/onenote","application/msonenote"]},"className":"csui-icon mime_onenote","iconName":"csui_mime_onenote","mimeType":s.NodeTypeONE,"sequence":50},{"equalsNoCase":{"mime_type":["application/vnd.ms-project","application/msproj","application/msproject","application/x-msproject","application/x-ms-project","application/mpp"]},"className":"csui-icon mime_project","iconName":"csui_mime_project","mimeType":s.NodeTypeMPP,"sequence":50},{"startsWithNoCase":{"mime_type":"image/"},"className":"csui-icon mime_image","iconName":"csui_mime_image","mimeType":s.NodeTypeImage,"sequence":50},{"startsWithNoCase":{"mime_type":"audio/"},"className":"csui-icon mime_audio","iconName":"csui_mime_audio","mimeType":s.NodeTypeAudio,"sequence":50},{"startsWithNoCase":{"mime_type":"text/"},"className":"csui-icon mime_paper","iconName":"csui_mime_paper","mimeType":s.NodeTypeText,"sequence":50},{"equalsNoCase":{"mime_type":"text/html"},"className":"csui-icon mime_html","iconName":"csui_mime_html","mimeType":s.NodeTypeHtml,"sequence":40},{"startsWithNoCase":{"mime_type":"video/"},"className":"csui-icon mime_video","iconName":"csui_mime_video","mimeType":s.NodeTypeVideo,"sequence":50},{"equalsNoCase":{"mime_type":["application/x-rar-compressed","application/zip","application/x-zip","application/x-zip-compressed"]},"className":"csui-icon mime_zip","iconName":"csui_mime_zip","mimeType":s.NodeTypeCompressed,"sequence":50},{"equals":{"type":136},"className":"csui-icon compound_document","iconName":"csui_mime_compound_document","withColorSchemaIconName":"csui_colorschema_mime_compound_document","sequence":100},{"equals":{"type":138},"className":"csui-icon csui-mime-compound-release","iconName":"csui_mime_compound_release32","sequence":100},{"equals":{"type":139},"className":"csui-icon csui-mime-compound-revision","iconName":"csui_mime_compound_revision32","sequence":100},{"equals":{"type":144},"className":"csui-icon mime_document","iconName":"csui_mime_document","sequence":100},{"equals":{"type":736},"className":"csui-icon mime_drawing","iconName":"csui_mime_drawing","sequence":100},{"equals":{"type":258},"className":"csui-icon csui-icon-saved-search-query","iconName":"csui_mime_saved_search","mimeType":s.NodeTypeSearchQuery,"sequence":100},{"equals":{"type":292},"className":"csui-icon csui-icon-query-form-search","iconName":"csui_mime_query_form_search","mimeType":s.NodeTypeSearchForm,"sequence":100},{"equals":{"type":140},"className":"csui-icon url1","iconName":"csui_mime_url","mimeType":s.NodeTypeURL,"sequence":100},{"equals":{"type":1},"className":"csui-icon shortcut1","iconName":"csui_mime_shortcut","withColorSchemaIconName":"csui_colorschema_mime_shortcut","sequence":100},{"equals":{"type":2},"className":"csui-icon mime_generation","iconName":"csui_mime_generation","sequence":100},{"equals":{"type":131},"className":"csui-icon category1","iconName":"csui_mime_category","sequence":100},{"equals":{"type":202},"className":"csui-icon csui-icon-project","iconName":"csui_mime_cs_project","withColorSchemaIconName":"csui_colorschema_mime_cs_project","sequence":100},{"equals":{"type":298},"className":"csui-icon collection","iconName":"csui_mime_collection","withColorSchemaIconName":"csui_colorschema_mime_collection","sequence":100},{"equals":{"type":141},"className":"csui-icon csui-icon-enterprise-volume","iconName":"csui_mime_enterprise","sequence":100},{"equals":{"type":142},"className":"csui-icon csui-icon-personal-volume","iconName":"csui_mime_enterprise","sequence":100},{"equals":{"type":133},"className":"csui-icon csui-icon-category-volume","iconName":"csui_mime_category_volume","sequence":100},{"equals":{"type":132},"className":"csui-icon csui-icon-node-category-folder","iconName":"csui_mime_category_volume","sequence":100},{"equals":{"type":299},"className":"csui-icon csui-icon-node-livereport","iconName":"csui_mime_livereport","withColorSchemaIconName":"csui_colorschema_mime_livereport","sequence":100},{"equals":{"type":212},"className":"csui-icon csui-icon-node-milestone","iconName":"csui_mime_milestone","sequence":100},{"equals":{"type":218},"className":"csui-icon csui-icon-node-poll","iconName":"csui_mime_poll","sequence":100},{"equals":{"type":384},"className":"csui-icon csui-icon-node-prospector","iconName":"csui_mime_prospector","sequence":100},{"equals":{"type":206},"className":"csui-icon csui-icon-node-task","iconName":"csui_mime_task","sequence":100},{"equals":{"type":205},"className":"csui-icon csui-icon-node-task-group","iconName":"csui_mime_task_group","sequence":100},{"equals":{"type":204},"className":"csui-icon csui-icon-node-task-list","iconName":"csui_mime_task_list","withColorSchemaIconName":"csui_colorschema_mime_task_list","sequence":100},{"equals":{"type":957},"className":"csui-icon csui-icon-perspective","iconName":"csui_mime_perspective","sequence":100},{"equals":{"type":958},"className":"csui-icon csui-icon-rule","iconName":"csui_mime_rule","sequence":100},{"equals":{"type":955},"className":"csui-icon csui-icon-perspective-assets-folder","iconName":"csui_mime_perspective_assets_folder","sequence":100},{"equals":{"type":954},"className":"csui-icon csui-icon-perspective-assets-volume","iconName":"csui_mime_perspective_assets_volume","sequence":100},{"equals":{"type":899},"className":"csui-icon csui-icon-node-virtual-folder","iconName":"csui_mime_virtual_folder","withColorSchemaIconName":"csui_colorschema_mime_virtual_folder","sequence":100},{"equals":{"type":146},"className":"csui-icon mime_custom_view","iconName":"csui_mime_custom_view","sequence":30},{"equals":{"type":153},"className":"csui-icon assignment-workflow","iconName":"csui_mime_assignment_workflow","sequence":100},{"equals":{"type":128},"className":"csui-icon mime_workflow_map","iconName":"csui_mime_workflow_map","withColorSchemaIconName":"csui_colorschema_mime_workflow_map","sequence":100},{"equals":{"type":190},"className":"csui-icon mime_workflow_status","iconName":"csui_mime_workflow_status","withColorSchemaIconName":"csui_colorschema_mime_workflow_status","sequence":100},{"equals":{"type":207},"className":"csui-icon mime_channel","iconName":"csui_mime_channel","withColorSchemaIconName":"csui_colorschema_mime_channel","sequence":100},{"equals":{"type":208},"className":"csui-icon mime_news","iconName":"csui_mime_news_item","sequence":100},{"equals":{"type":215},"className":"csui-icon mime_discussion","iconName":"csui_mime_conversation","sequence":100},{"equals":{"type":335},"className":"csui-icon mime_xml_dtd","iconName":"csui_mime_xml","withColorSchemaIconName":"csui_colorschema_mime_xml","sequence":30},{"equals":{"type":223},"className":"csui-icon mime_form","iconName":"csui_mime_form","withColorSchemaIconName":"csui_colorschema_mime_form","sequence":100},{"equals":{"type":230},"className":"csui-icon mime_form_template","iconName":"csui_mime_layout_template","withColorSchemaIconName":"csui_colorschema_mime_layout_template","sequence":100},{"equals":{"type":1281},"className":"csui-icon icon-pulse-comment","iconName":"csui_mime_pulse_comment","sequence":100},{"equals":{"type":5574},"className":"csui-icon mime_wiki_page","iconName":"csui_mime_wiki_page","sequence":10},{"equals":{"type":5573},"className":"csui-icon mime_wiki","iconName":"csui_mime_wiki","withColorSchemaIconName":"csui_colorschema_mime_wiki","sequence":10},{"equals":{"container":"nonselectable"},"className":"csui-icon mime_folder_nonselectable","iconName":"csui_mime_folder_nonselectable32","sequence":1e3},{"equals":{"container":!0},"className":"csui-icon mime_folder","iconName":"csui_mime_folder","withColorSchemaIconName":"csui_colorschema_mime_folder","sequence":1e3},{"equals":{"type":901},"className":"csui-icon mime_facets_volume","iconName":"csui_mime_facets_volume","sequence":100},{"equals":{"type":902},"className":"csui-icon csui-icon-custom-column","iconName":"csui_mime_custom_column","sequence":100},{"equals":{"type":903},"className":"csui-icon mime_facets_tree","iconName":"csui_mime_facets_tree","sequence":100},{"equals":{"type":904},"className":"csui-icon mime_facets","iconName":"csui_mime_facets","sequence":100},{"className":"csui-icon mime_document","iconName":"csui_mime_document","sequence":1e4},{"startsWithNoCase":{"mime_type":"application/sdd"},"className":"csui-icon mime_application","iconName":"csui_mime_application","mimeType":s.NodeTypeSDD,"sequence":50}]);return n&&a.add(e.flatten(n,!0)),a}),csui.define("csui/utils/node.info.sprites",["csui/lib/underscore","csui/lib/backbone","csui-ext!csui/utils/node.info.sprites"],function(e,i,t){var s=i.Model.extend({"defaults":{"sequence":100},"constructor":function(e,t){i.Model.prototype.constructor.apply(this,arguments)}}),n=i.Collection.extend({"model":s,"comparator":"sequence","constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments)}}),o=new n;return t&&o.add(e.flatten(t,!0)),o}),csui.define("csui/utils/smart.nodes/smart.nodes",["csui/lib/underscore","csui/lib/backbone","csui/models/mixins/rules.matching/rules.matching.mixin","csui-ext!csui/utils/smart.nodes/smart.nodes"],function(e,i,t,s){"use strict";var n=i.Model.extend({"defaults":{"sequence":100},"constructor":function(e,t){i.Model.prototype.constructor.apply(this,arguments),this.makeRulesMatching(t)}});t.mixin(n.prototype);var o=i.Collection.extend({"model":n,"comparator":"sequence","constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments)},"isSupported":function(e,i){return this.some(function(i){return i.matchRules(e,i.attributes)})}}),r=new o;return s&&r.add(e.flatten(s,!0)),r}),csui.define("csui/utils/user.session/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/utils/user.session/impl/nls/root/lang",{"errorTerminateSession":"Terminating the session failed.","errorContinueSession":"Continuing the session failed.","errorHttpPrefix":"HTTP"}),csui.define("csui/utils/user.session/user.session",["module","require","csui/lib/underscore","csui/lib/jquery","csui/utils/log","csui/utils/url","csui/utils/base","i18n!csui/utils/user.session/impl/nls/lang"],function(e,i,t,s,n,o,r,a){"use strict";n=n(e.id);return function(){function i(){return O}function c(){return k}function u(){return R}function l(){return A}function d(){return(new Date).toUTCString()}function m(){return c()+i()}function p(e){if(e)if(e.expires&&e.serverDate){if(new Date(e.expires).getTime()<=new Date(e.serverDate).getTime()){var i=new Date;e.serverDate=i.toUTCString(),e.expires=new Date(i.getTime()+m()).toUTCString(),n.warn("user.session: _ensureExpiresTime: Provided 'serverDate' is newer or equal than 'expires' value, exceptionally replacing values (expires: "+e.expires+").")&&console.warn(n.last)}}else{var t=new Date;e.serverDate=t.toUTCString(),e.expires=new Date(t.getTime()+m()).toUTCString(),n.warn("user.session: _ensureExpiresTime: Adding 'serverDate' and 'expires' information to session (expires: "+e.expires+").")&&console.warn(n.last)}else n.error("user.session: _ensureExpiresTime: The provided argument 'session' is undefined!")&&console.error(n.last)}function f(e){var i=e.connection.session,t=0;if(p(i),i&&void 0!==i.expires&&"string"==typeof i.expires&&i.expires.length>0){var s=new Date(i.expires);isNaN(s.getTime())&&(s=new Date((new Date).getTime()+m()),n.info("user.session: _calcExpirationStartTime: Got unparseable date value for expires '"+i.expires+"', using fallback value '"+s.toUTCString()+"'.")&&console.log(n.last),i.expires=s.toUTCString());var o=s.getTime();o-=P,o<0&&(o=0);var r=new Date(i.serverDate);isNaN(r.getTime())&&(r=new Date,n.warn("user.session: _calcExpirationStartTime: Got unparseable date value for serverDate '"+i.serverDate+"', using fallback value '"+r.toUTCString()+"'.")&&console.warn(n.last),i.serverDate=r.toUTCString());var a=r.getTime();n.info("user.session: _calcExpirationStartTime: srvDate: "+i.serverDate+", expires: "+i.expires+" (Date: "+d()+").")&&console.log(n.last),t=a>=o?0:o-a,t/=1e3}else n.error("user.session: _calcExpirationStartTime: The provided authenticator.connection.session has no expiration information.")&&console.error(n.last);return n.info("user.session: _calcExpirationStartTime: secs until expiration: "+t)&&console.log(n.last),t}function h(){return!(!0!==this.isSessionExpirationEnabled()||!M)&&1==this.getCookieExpirationMode()}function g(e,i){if(e&&e.isAuthenticated())if(i&&i.settings&&i.settings.url){var t=new o(i.settings.url).getAbsolute().toLowerCase(),s=t.match(/^.*\/(api\/[^?]+)/);if(s){var r=s[1];n.debug("user.session: updateSessionTicket: Resetting expiration timer based on call '"+r+"'.")&&console.log(n.last),this.clearExpirationTimer(),this._createExpirationTimer(e)}}else n.debug("user.session: updateSessionTicket: Resetting expiration timer based on unspecified call.")&&console.log(n.last),this.clearExpirationTimer(),this._createExpirationTimer(e);else n.warn("user.session: updateSessionTicket: Authenticator has to be 'authenticated' before updating session ticket!")&&console.warn(n.last)}function v(e){e&&e.isAuthenticated()?(n.debug("user.session: startExpirationTimer: Creating new expiration timer with provided authenticator...")&&console.log(n.last),this.clearExpirationTimer(),this._createExpirationTimer(e)):console.warn("user.session: startExpirationTimer: Unable to start expiration timer, you have to provide an (still) authenticated 'authenticator'! Verify your parameter(s) for startExpirationTimer() function.")}function _(){n.debug("user.session: clearExpirationTimer: called...")&&console.log(n.last),q&&(clearInterval(q),q=void 0)}function y(e){var i=f(e),t=this,s=this.getSessionReactionTime()/1e3,o=function(){var i=!1;return function(s){i||(i=!0,n.info("user.session: expirationTimer: current time for expiration warning count down: "+t.currentDateUTC())&&console.log(n.last),t.displayExpirationWarning(e,{"startWithWarningContent":!0,"startTime":s}))}}();q=setInterval(function(){--i<s&&(n.info("user.session: current expiration value: "+i)&&console.log(n.last),i>=0?o(i):(t.clearExpirationTimer(),n.info("user.session: expirationTimer: Switching to LoggedOut dialog content due to expired session...")&&console.log(n.last),t.sendAuthenticatorEvent(e),t.performSessionExpired(e,!1)))},1e3)}function x(e){e?(n.debug("user.session: Sending event 'clear:timer' to dialog...")&&console.log(n.last),e.triggerMethod("clear:timer","someValue")):n.debug("user.session: Skipping sending event 'clear:timer' to dialog, because dialog is already destroyed.")&&console.log(n.last)}function b(e,i){var t=this;csui.require(["csui/utils/expiration.warning/expiration.warning.dialog"],function(s){var o={"userSession":t,"authenticator":e,"startWithWarningContent":i.startWithWarningContent,"startTime":i.startTime,"clearExpirationTimer":function(){t.clearExpirationTimer()}};L=s.createExpirationWarningDialog(o),s.showExpirationWarningDialog(L).always(function(e){n.debug("user.session: _showExpirationWarningDialog: Expiration dialog was finished, setting internal dialog to undefined.")&&console.log(n.last),L=void 0})})}function E(e,i){if(void 0===L&&!0===this.isSessionExpirationEnabled())if(i&&!0===i.startWithWarningContent){if(this._shouldDisplayExpirationWarning())return this._showExpirationWarningDialog(e,i)}else if(M)return i=i||{},i.startWithWarningContent=!1,this._showExpirationWarningDialog(e,i)}function S(e){n.debug("user.session: redirectToTargetPage: Called ...")&&console.log(n.last);var i=new o(e.connection.url).getCgiScript(),t=o.appendQuery(i,"func=csui.redirecttotarget");location.href=t}function T(e,i){var t=this;!0===this.isSessionExpirationEnabled()?U?n.debug("user.session: performSessionExpired: A logout is already executed.")&&console.log(n.last):(U=!0,n.debug("user.session: performSessionExpired: Initiating automatic logout ...")&&console.log(n.last),this.clearExpirationTimer(),!0===i?(n.info("user.session: performSessionExpired: Session expired, performing requested redirect (Date: "+this.currentDateUTC()+").")&&console.log(n.last),this.redirectToTargetPage(e)):(n.info("user.session: performSessionExpired: Session expired, performing signOut (Date: "+this.currentDateUTC()+").")&&console.log(n.last),this.signOut(e,{"onErrorRedirect":!0,"isSessionExpired":!0}).done(function(){U=!1,n.debug("user.session: performSessionExpired: Automatic logout requests successfully sent.")&&console.log(n.last)}).fail(function(){U=!1,n.info("user.session: performSessionExpired: Sending automatic logout requests returned error.")&&console.log(n.last)}).always(function(){n.info("user.session: performSessionExpired: Sending automatic logout requests finished, spawning redirect timer.")&&console.log(n.last);var i=setTimeout(function(){U=!1,i&&(clearTimeout(i),i=void 0),n.info("user.session: performSessionExpired: Redirecting to target page...'")&&console.log(n.last),t.redirectToTargetPage(e)},P)}))):(n.debug("user.session: performSessionExpired: Skipping automatic logout due to disabled expiration handling.")&&console.log(n.last),this.clearExpirationTimer())}function N(e){var i=this,t=new o(e.connection.url).getCgiScript(),s=o.combine(t,"api/v1/auth");e.makeAjaxCall({"url":s,"headers":{"OTCSTicket":e.connection.session.ticket},"success":function(i,t,o){n.debug("Receiving request response from {0}.",s)&&console.log(n.last),i=e.parseResponse(i,o),e.updateAuthenticatedSession(i,o)}}).done(function(){i.startExpirationTimer(e),n.info("expiration.warning.dialog: Processed continue session (Date: "+i.currentDateUTC()+").")&&console.log(n.last)}).fail(function(t){i.sendAuthenticatorEvent(e,"failedTicketRefresh");var s=a.errorContinueSession,o=new r.RequestErrorMessage(t),c=a.errorHttpPrefix+" "+o.statusCode+(o.message?": ":"")+o.message;n.error("expiration.warning.dialog: Processing continue session failed with an error (Date: "+i.currentDateUTC()+"). Error: "+c+".")&&console.error(n.last),csui.require(["csui/dialogs/modal.alert/modal.alert"],function(t){t.showError(s+"\n"+c).always(function(){i.redirectToTargetPage(e)})})})}function w(e,i){e&&e.trigger(i||"loggedOut",{"sender":e})}function I(e,i){var t=s.Deferred(),c=this;if(i||(i={}),e&&e.isAuthenticated()){var u=new o(e.connection.url).getCgiScript();csui.require(["csui/utils/routing","csui/utils/open.authenticated.page"],function(s,l){if(s.routesWithSlashes())if(!0===c.isSessionExpirationEnabled())if(e&&e.makeAjaxCall&&"function"==typeof e.makeAjaxCall){var d=o.combine(u,"api/v1/auth/logouttoken");e.makeAjaxCall({"url":d,"headers":{"OTCSTicket":e.connection.session.ticket},"success":function(i,t,s){n.debug("Receiving request response from {0}.",d)&&console.log(n.last),i=e.parseResponse(i,s),e.updateAuthenticatedSession(i,s)}}).then(function(s){var r="func=csui.dologout&secureRequestToken="+encodeURIComponent(s.token);!0===i.isSessionExpired&&(r+="&authcontext=sessionexpired");var a=o.appendQuery(u,r);l(e.connection,a,{"openInNewTab":!1}).always(function(){e.unauthenticate(i.unauthenticateReason||{"reason":"logged-out"}),n.debug("user.session: signOut: The logout request was sent to server (Date: "+c.currentDateUTC()+").")&&console.log(n.last),t.resolve()})},function(s){var o=a.errorTerminateSession,u=new r.RequestErrorMessage(s),l=a.errorHttpPrefix+" "+u.statusCode+(u.message?": ":"")+u.message;!0===i.onErrorRedirect?(e.unauthenticate(i.unauthenticateReason||{"reason":"logged-out"}),n.info("user.session: signOut: Terminate session was not successful, redirecting ... (Date: "+c.currentDateUTC()+"). Error: "+l+".")&&console.error(n.last),c.redirectToTargetPage(e)):(n.error("user.session: signOut: Terminate session failed with an error (Date: "+c.currentDateUTC()+"). Error: "+l+".")&&console.error(n.last),csui.require(["csui/dialogs/modal.alert/modal.alert"],function(t){t.showError(o+"\n"+l).always(function(){e.unauthenticate(i.unauthenticateReason||{"reason":"logged-out"}),c.redirectToTargetPage(e)})})),t.reject(s)})}else e.unauthenticate(i.unauthenticateReason||{"reason":"logged-out"}),n.debug("user.session: signOut: makeAjaxCall is not available, so performing redirect to target page (Date: "+c.currentDateUTC()+").")&&console.log(n.last),c.redirectToTargetPage(e),t.resolve();else n.debug("user.session: signOut: Session expiration handling is disabled, skipping logout (Date: "+c.currentDateUTC()+").")&&console.log(n.last),t.resolve();else{e.unauthenticate(i.unauthenticateReason||{"reason":"logged-out"});var m=C.signInPageUrl,p=location.search;p+=p?"&":"?",p+="nextUrl="+encodeURIComponent(location.pathname);var f=m+p+location.hash;n.debug("user.session: signOut: Performed unauthenticate with redirect to development signIn page.")&&console.log(n.last),location.href=f,t.resolve()}})}else n.info("user.session: signOut: Authenticator is not 'authenticated' anymore, just returning success.")&&console.log(n.last),t.resolve();return t.promise()}n.info("user.session: module.config is: "+JSON.stringify(e.config()))&&console.log(n.last);var C=t.extend({"signInPageUrl":"signin.html","kindnessPeriod":3e4,"cookieExpirationMode":1,"enableExpirationHandling":!1},e.config()),R=null!=C.enableExpirationHandling&&C.enableExpirationHandling,A=null==C.cookieExpirationMode?1:C.cookieExpirationMode,k=null==C.sessionInactivity?18e5:C.sessionInactivity,O=null==C.sessionReactionTime?18e4:C.sessionReactionTime,P=null==C.kindnessPeriod?3e4:C.kindnessPeriod,M=A>0,D={"enableExpirationHandling":R,"cookieExpirationMode":A,"sessionInactivity":k,"sessionReactionTime":O,"kindnessPeriod":P};n.warn("user.session: used config: "+JSON.stringify(D))&&console.warn(n.last);var q,L,U=!1;return{"getSessionReactionTime":i,"getSessionInactivity":c,"isSessionExpirationEnabled":u,"getCookieExpirationMode":l,"currentDateUTC":d,"signOut":I,"continueSession":N,"redirectToTargetPage":S,"updateSessionTicket":g,"startExpirationTimer":v,"displayExpirationWarning":E,"performSessionExpired":T,"clearExpirationTimer":_,"stopExpirationWarningViewTimer":x,"sendAuthenticatorEvent":w,"_createExpirationTimer":y,"_shouldDisplayExpirationWarning":h,"_showExpirationWarningDialog":b}}()}),csui.define("csui/utils/authenticators/interactive.credentials.authenticator",["require","module","csui/lib/underscore","csui/utils/authenticators/request.authenticator"],function(e,i,t,s){"use strict";return s.extend({"interactive":function(){return!0},"constructor":function(e){
s.prototype.constructor.call(this,e)},"authenticate":function(e,i,n){"function"==typeof e&&(i,i=e,e=void 0),s.prototype.authenticate.call(this,e,i,t.bind(this.openSignInDialog,this,i))},"openSignInDialog":function(e){if(!this.reauthenticating){var i=this;i.reauthenticating=!0,csui.require(["csui/utils/impl/signin.dialog/signin.dialog","csui/controls/progressblocker/blocker"],function(t,s){var n=new t({"connection":i.connection});s.suppressAll(),n.show().done(function(t){i.connection.session=t.session,i.reauthenticating=!1,s.resumeAll(),e(i.connection)})})}}})}),csui.define("hbs!csui/utils/authenticators/impl/redirecting.form.authenticator",["module","hbs","nuc/lib/handlebars"],function(e,i,t){var s=t.template({"1":function(e,i,t,s,n){var o,r=e.lookupProperty||function(e,i){if(Object.prototype.hasOwnProperty.call(e,i))return e[i]};return"        "+(null!=(o=(r(t,"icon-v2")||i&&r(i,"icon-v2")||e.hooks.helperMissing).call(null!=i?i:e.nullContext||{},{"name":"icon-v2","hash":{"on":null!=i?r(i,"on"):i,"states":"true","iconName":null!=i?r(i,"iconName"):i},"loc":{"start":{"line":4,"column":8},"end":{"line":4,"column":59}}}))?o:"")+"        \r\n"},"3":function(e,i,t,s,n){var o,r=e.lookupProperty||function(e,i){if(Object.prototype.hasOwnProperty.call(e,i))return e[i]};return'        <div class="icon circular '+e.escapeExpression((o=null!=(o=r(t,"iconRight")||(null!=i?r(i,"iconRight"):i))?o:e.hooks.helperMissing,"function"==typeof o?o.call(null!=i?i:e.nullContext||{},{"name":"iconRight","hash":{},"loc":{"start":{"line":6,"column":34},"end":{"line":6,"column":47}}}):o))+'"></div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,i,t,s,n){var o,r,a=e.lookupProperty||function(e,i){if(Object.prototype.hasOwnProperty.call(e,i))return e[i]};return'<button class="csui-signin-close csui-with-iframe" title="'+e.escapeExpression((r=null!=(r=a(t,"dialogCloseButtonTooltip")||(null!=i?a(i,"dialogCloseButtonTooltip"):i))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=i?i:e.nullContext||{},{"name":"dialogCloseButtonTooltip","hash":{},"loc":{"start":{"line":1,"column":58},"end":{"line":1,"column":86}}}):r))+'"\r\n    aria-label="'+e.escapeExpression((r=null!=(r=a(t,"dialogCloseAria")||(null!=i?a(i,"dialogCloseAria"):i))?r:e.hooks.helperMissing,"function"==typeof r?r.call(null!=i?i:e.nullContext||{},{"name":"dialogCloseAria","hash":{},"loc":{"start":{"line":2,"column":16},"end":{"line":2,"column":35}}}):r))+'">    \r\n'+(null!=(o=a(t,"if").call(null!=i?i:e.nullContext||{},null!=i?a(i,"iconName"):i,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.program(3,n,0),"loc":{"start":{"line":3,"column":4},"end":{"line":7,"column":11}}}))?o:"")+"</button>\r\n"}});return t.registerPartial("csui_utils_authenticators_impl_redirecting.form.authenticator",s),s}),csui.define("csui/utils/authenticators/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("csui/utils/authenticators/impl/nls/root/lang",{"dialogCloseButtonTooltip":"Close","dialogCloseButtonAria":"Close sign in dialog"}),csui.define("css!csui/utils/authenticators/impl/redirecting.form.authenticator",[],function(){}),csui.define("csui/utils/authenticators/redirecting.form.authenticator",["require","module","csui/lib/underscore","csui/lib/backbone","csui/lib/jquery","csui/utils/log","csui/utils/authenticators/request.authenticator","csui/utils/user.session/user.session","hbs!csui/utils/authenticators/impl/redirecting.form.authenticator","i18n!csui/utils/authenticators/impl/nls/lang","css!csui/utils/authenticators/impl/redirecting.form.authenticator"],function(e,i,t,s,n,o,r,a,c,u){"use strict";o=o(i.id);var l=i.config(),d=l.authenticationIFrameTimeout||3e3,m=l.showCloseButtonOnError;return r.extend({"interactive":function(){return!1},"constructor":function(e){r.prototype.constructor.call(this,e)},"authenticate":function(e,i,s){"function"==typeof e&&(s=i,i=e,e=void 0),r.prototype.authenticate.call(this,e,i,t.bind(this.initiateLoginSequence,this,i,s))},"updateAuthenticatedSession":function(e,i){r.prototype.updateAuthenticatedSession.call(this,e,i),this.connection.session&&this.connection.session.ticket?a?a.updateSessionTicket(this,i||e):o.info("redirecting.form.authenticator: updateAuthenticatedSession: UserSession is undefined, unable to updateSessionTicket in UserSession.")&&console.log(o.last):o.error("redirecting.form.authenticator: updateAuthenticatedSession: Cannot get 'ticket' from just updated session, invalid request!")&&console.error(o.last)},"unauthenticate":function(e){return this.isAuthenticated()&&e&&e.reason&&("logged-out"===e.reason||"expired"===e.reason)&&a&&!0===a.isSessionExpirationEnabled()&&(o.debug("redirecting.form.authenticator: unauthenticate: clearing expiration timer based on logged-out or expired.")&&console.log(o.last),a.clearExpirationTimer()),r.prototype.unauthenticate.apply(this,arguments)},"initiateLoginSequence":function(e,i){function t(){!1!==b||x.isAuthenticated()||(o.warn("redirecting.form.authenticator: Sending 'failedTicketRefresh' event...")&&console.log(o.last),x.trigger("failedTicketRefresh",{"sender":x}))}function r(){p(),b=!0,_&&_.destroy(),b=!1}function l(){csui.require(["csui/controls/progressblocker/blocker"],function(e){e.suppressAll()})}function p(){csui.require(["csui/controls/progressblocker/blocker"],function(e){e.resumeAll()})}function f(i){if(i.origin!==y)return void(o.warn("redirecting.form.authenticator: event.origin and urlOrigin differ, aborting!")&&console.warn(o.last));if("csuiTicketLoaded"===i.data)o.info("redirecting.form.authenticator: Sending getOrigin back to child.")&&console.log(o.last),i.source.postMessage("getOrigin","*");else if(i.data.ticket){o.debug("redirecting.form.authenticator: Redirecting Form Authenticator received new ticket.")&&console.log(o.last),window.removeEventListener("message",f,!1),v&&clearTimeout(v),v=void 0,r();var t=x.connection.session||(x.connection.session={});t.ticket=i.data.ticket,t.expires=i.data.expires,t.serverDate=i.data.serverDate,e&&e(x.connection),a&&a.updateSessionTicket(x),o.info("redirecting.form.authenticator: Sending 'loggedIn' event...")&&console.log(o.last),x.trigger("loggedIn",{"sender":x,"connection":x.connection})}}function h(){v=setTimeout(g,d)}function g(){_&&(_.$el.removeClass("binf-hidden"),l())}var v,_,y,x=this,b=!1;!function(e){return!!e}(x.getUserId())?function(){csui.require(["csui/controls/dialog/dialog.view","csui/widgets/error.global/error.global.view"],function(e,i){function n(){t(),a.off("destroy",n),a.off("childview:destroy",n),a.destroy()}var o=new s.Model({"message":"The userId is undefined, the preceding authentication failed. Please initialize CSUI in a correct way.","hideNavigationButtons":!0,"showCloseButton":m,"errorCode":401,"showLogout":!1}),r=new i({"model":o}),a=new e({"standardHeader":!1,"view":r,"fullSize":!0});a.on("destroy",n).on("childview:destroy",n).show(),l()})}():(window.addEventListener("message",f,!1),function(){var e=n.Deferred();return csui.require(["csui/lib/marionette","csui/controls/dialog/dialog.view","csui/utils/url"],function(i,s,o){var r=o.appendQuery(new o(x.connection.url).getCgiScript(),"func=csui.ticket");r=o.appendQuery(r,"userid="+x.getUserId()),y=new o(x.connection.url).getOrigin();var a=new i.View({"el":n("<iframe>",{"width":"100%","height":"100%","src":r})}),l=i.ItemView.extend({"ui":{"closeButton":"button.csui-signin-close"},"templateHelpers":function(){return{"dialogCloseButtonTooltip":u.dialogCloseButtonTooltip,"dialogCloseAria":u.dialogCloseButtonAria,"iconName":"csui_action_close_white32","on":"false"}},"template":c,"events":{"click @ui.closeButton":"onButtonClick"},"onButtonClick":function(e){_.onClickClose(e)}});_=new s({"className":"csui-signin-close","standardHeader":!1,"view":a,"fullSize":!0,"footerView":new l}),a.render(),_.on("destroy",function(){t()}).show({"render":!1}),_.$el.css({"z-index":"1061"}),_.$el.addClass("binf-hidden"),e.resolve()},e.reject),e.promise()}().done(h))}})}),csui.define("csui/utils/authenticators/core.authenticators",["module","csui/lib/underscore","csui/utils/authenticators/ticket.authenticator","csui/utils/authenticators/interactive.credentials.authenticator","csui/utils/authenticators/redirecting.form.authenticator"],function(e,i,t,s,n){"use strict";var o=window.csui.requirejs.s.contexts._.config.config["csui/utils/interactiveauthenticator"]||{},r=o.enabled,a=e.config();return o=i.extend({"enableInteractiveAuthenticator":void 0===a.enableRedirectingFormAuthenticator&&!1!==r,"enableRedirectingFormAuthenticator":!1},a),[{"sequence":500,"authenticator":o.enableInteractiveAuthenticator?s:o.enableRedirectingFormAuthenticator?n:t}]}),csui.define("csui/models/compound.document/releases/server.adaptor.mixin",["csui/lib/underscore","csui/lib/jquery","csui/utils/url"],function(e,i,t){"use strict";return{"mixin":function(s){return e.extend(s,{"makeServerAdaptor":function(){return this},"url":function(){var e=new t(this.connector.connection.url).getApiBase(2),i=t.combineQueryString(this.getBrowsableUrlQuery(),this.getRequestedCommandsUrlQuery(),this.getExpandableResourcesUrlQuery(),this.getAdditionalResourcesUrlQuery(),this.getStateEnablingUrlQuery(),this.getResourceFieldsUrlQuery(),{"expand":"properties{create_user_id,locked_user_id}"});return t.combine(e,"nodes",this.options.node.get("id"),"releases?"+i)},"parse":function(e,t){var s=[],n=e.results;return this.parseBrowsedState(e,t),this.columns&&this.columns.resetColumnsV2(e,this.options),i.each(n,function(e){var i=n[e].data.properties;s.push({"type":i.type,"type_name":i.type_name,"name":i.name,"release_value":i.release+"."+i.revision,"created":i.create_date,"createdBy":i.create_user_id_expand.name,"id":i.id,"locked":i.locked,"locked_user_id_expand":i.locked&&i.locked_user_id_expand,"reserved_user_id_expand":i.locked&&i.reserved_user_id_expand,"locked_date":i.locked_date,"container":i.container,"openable":!0,"favorite":i.favorite,"actions":n[e].actions,"locked_user_id":i.locked&&i.locked_user_id})}),s},"isFetchable":function(){return!!this.options}})}}}),csui.define("csui/models/node.createform/server.adaptor.mixin",["csui/lib/jquery","csui/lib/underscore","csui/utils/url"],function(e,i,t){"use strict";return{"mixin":function(s){return i.extend(s,{"makeServerAdaptor":function(e){return this},"url":function(){var i={"parent_id":this.docParentId?this.docParentId:this.node.get("id"),"type":this.type},s="forms/nodes/create?"+e.param(i);return t.combine(this.node.connector.connection.url,s)},"parse":function(e){var t=e.forms;return i.each(t,function(e){e.id=e.schema.title}),t&&t.length&&(t[0].id="general"),t}})}}}),csui.define("csui/models/server.info/server.adaptor.mixin",["csui/lib/underscore","csui/utils/url"],function(e,i){"use strict";return{"mixin":function(t){return e.extend(t,{"makeServerAdaptor":function(e){return this},"url":function(){return i.combine(this.connector.getConnectionUrl().getApiBase("v1"),"serverInfo")},"parse":function(e){return this._changing=!1,e}})}}}),csui.define("csui/models/permission/permission.precheck.server.adaptor",["csui/lib/underscore","csui/utils/url"],function(e,i){"use strict";return{"mixin":function(t){return e.extend(t,{"makeServerAdaptor":function(e){return this},"url":function(){var e=i.combine(this.connector.getConnectionUrl().getApiBase("v2"),"nodes",this.get("id"),"/descendents/subtypes/exists");return void 0!==this.get("subType")&&(e=i.appendQuery(e,"sub_types="+this.get("subType"))),this.get("include_sub_items")&&(e=i.appendQuery(e,"include_sub_items="+this.get("include_sub_items"))),e},"parse":function(e,i){return e}})}}}),csui.define("csui/models/appliedcategories/category.server.adaptor.mixin",["csui/lib/jquery","csui/lib/underscore","csui/utils/url"],function(e,i,t){"use strict";return{"mixin":function(e){return i.extend(e,{"makeServerAdaptor":function(e){return this},"url":function(){var e=this.id;return e?t.combine(this.node.urlBase(),"categories",e):t.combine(this.node.urlBase(),"categories")},"parse":function(e,i){return this.sortInitially(e.data)},"sortInitially":function(e){return i.isArray(e)?i.sortBy(e,function(e){return e.name.toLowerCase()}):e}})}}}),csui.define("csui/models/appliedcategories/category",["csui/lib/backbone","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/resource/resource.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/appliedcategories/category.server.adaptor.mixin"],function(e,i,t,s,n){"use strict";var o=e.Model.extend({"idAttribute":null,"constructor":function(i,t){e.Model.prototype.constructor.call(this,i,t),this.node=t.node,this.id=t.id,this.makeResource(t).makeUploadable(t).makeExpandable(t).makeServerAdaptor(t)},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})}});return i.mixin(o.prototype),s.mixin(o.prototype),t.mixin(o.prototype),n.mixin(o.prototype),o}),csui.define("csui/models/appliedcategories/systemattributes.server.adaptor.mixin",["csui/lib/jquery","csui/lib/underscore","csui/utils/url"],function(e,i,t){"use strict";return{"mixin":function(e){return i.extend(e,{"makeServerAdaptor":function(e){return this},"url":function(){var e=this.id,i=this.connector.getConnectionUrl().getApiBase("v2");return i=t.combine(i,"nodes",e,"systemattributes")},"parse":function(e,i){return e}})}}}),csui.define("csui/models/appliedcategories/systemattributes.model",["csui/lib/backbone","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/resource/resource.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/appliedcategories/systemattributes.server.adaptor.mixin"],function(e,i,t,s,n){"use strict";var o=e.Model.extend({"idAttribute":null,"constructor":function(i,t){e.Model.prototype.constructor.call(this,i,t),this.node=t.node,this.id=t.id,this.makeResource(t).makeUploadable(t).makeExpandable(t).makeServerAdaptor(t)},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})}});return i.mixin(o.prototype),s.mixin(o.prototype),t.mixin(o.prototype),n.mixin(o.prototype),o}),csui.define("csui/models/appliedcategories/category.validation.server.adaptor.mixin",["csui/lib/jquery","csui/lib/underscore","csui/utils/url"],function(e,i,t){"use strict";return{"mixin":function(e){return i.extend(e,{"makeServerAdaptor":function(e){return this},"url":function(){var e=this.connector.getConnectionUrl().getApiBase("v1");return e=t.combine(e,"validation/nodes/categories/enforcement")},"parse":function(e,i){return e}})}}}),csui.define("csui/models/appliedcategories/category.validation.model",["csui/lib/backbone","csui/models/mixins/expandable/expandable.mixin","csui/models/mixins/resource/resource.mixin","csui/models/mixins/uploadable/uploadable.mixin","csui/models/appliedcategories/category.validation.server.adaptor.mixin"],function(e,i,t,s,n){"use strict";var o=e.Model.extend({"idAttribute":null,"constructor":function(i,t){e.Model.prototype.constructor.call(this,i,t),this.makeResource(t).makeUploadable(t).makeExpandable(t).makeServerAdaptor(t)},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})}});return i.mixin(o.prototype),s.mixin(o.prototype),t.mixin(o.prototype),n.mixin(o.prototype),o}),csui.define("csui/models/navigation.history",["module","csui/lib/underscore","csui/lib/backbone","csui/models/view.state.model"],function(e,i,t,s){"use strict";var n=t.History.extend({"constructor":function(s){t.History.prototype.constructor.apply(this,arguments);var n=i.extend({"urlCanChange":!0},e.config());this.urlCanChange=n.urlCanChange},"is":"CSUINavigationHistory","checkUrl":function(e){this.urlCanChange&&t.History.prototype.checkUrl.call(this,e)},"_updateHash":function(e,i,s){this.urlCanChange&&t.History.prototype._updateHash.call(this,e,i,s)},"matchRoot":function(){return!this.urlCanChange||t.History.prototype.matchRoot.call(this)}}),o=new n;return t.history=o,o}),csui.define("bundles/csui-models",["csui/models/audit/audit.collection","csui/models/authenticated.user.node.permission","csui/models/favorite2","csui/models/favorite2group","csui/models/favorite2groups","csui/models/favorites2","csui/models/favorite2column","csui/models/favorite2columns","csui/models/favorite.model","csui/models/permission/nodepermission.model","csui/models/permission/nodeuserpermissions","csui/models/server.module/server.module.collection","csui/models/specificnodemodel","csui/models/version","csui/models/view.state.model","csui/models/perspective/personalization.model","csui/models/perspective/personalize/delta.generator","csui/models/perspective/personalize/delta.resolver","csui/models/compound.document/reorganize/reorganize.collection","csui/models/widget/widget.collection","csui/models/widget/widget.model","csui/models/zipanddownload/zipanddownload.preflight","csui/models/zipanddownload/zipanddownload.stages","i18n!csui/models/impl/nls/lang","csui/utils/mime.types","csui/utils/classic.nodes/classic.nodes","csui/utils/defaultactionitems","csui/utils/nodesprites","csui/utils/node.info.sprites","i18n!csui/utils/impl/nls/lang","csui/utils/smart.nodes/smart.nodes","csui/utils/perspective/perspective.util","csui/utils/user.session/user.session","csui/utils/authenticators/core.authenticators","csui/utils/authenticators/interactive.credentials.authenticator","csui/utils/authenticators/redirecting.form.authenticator","csui/models/compound.document/releases/server.adaptor.mixin","csui/models/audit/server.adaptor.mixin","csui/models/node.createform/server.adaptor.mixin","csui/models/permission/server.adaptor.mixin","csui/models/permission/permission.action.server.adaptor.mixin","csui/models/server.info/server.adaptor.mixin","csui/models/permission/permission.precheck.server.adaptor","csui/models/appliedcategories/category","csui/models/appliedcategories/category.server.adaptor.mixin","csui/models/appliedcategories/systemattributes.model","csui/models/appliedcategories/systemattributes.server.adaptor.mixin","csui/models/appliedcategories/category.validation.server.adaptor.mixin","csui/models/appliedcategories/category.validation.model","csui/models/compound.document/reorganize/server.adaptor.mixin","csui/models/navigation.history"],{});
//# sourceMappingURL=csui-models.js.map