csui.define("workflow/toolbars/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/toolbars/impl/nls/root/lang",{"NodesTableToolbarInitiateLabel":"Start workflow","NodesTableToolbarEditLabel":"Edit"}),csui.define("css!workflow/toolbars/impl/workflow.nodestable.toolbaritems",[],function(){}),csui.define("workflow/toolbars/workflow.nodestable.toolbaritems",["i18n!workflow/toolbars/impl/nls/lang","css!workflow/toolbars/impl/workflow.nodestable.toolbaritems"],function(e){"use strict";return{"tableHeaderToolbar":[{"signature":"InitiateWorkflow","name":e.NodesTableToolbarInitiateLabel,"group":"main"},{"signature":"InitiateDocumentWorkflow","name":e.NodesTableToolbarInitiateLabel,"group":"main"},{"signature":"EditWorkflowMap","name":e.NodesTableToolbarEditLabel,"group":"main"}],"inlineActionbar":[{"signature":"InitiateWorkflow","name":e.NodesTableToolbarInitiateLabel,"icon":"icon icon-toolbar-wfinitiate","group":"other"},{"signature":"InitiateDocumentWorkflow","name":e.NodesTableToolbarInitiateLabel,"icon":"icon icon-toolbar-wfinitiate","group":"other"},{"signature":"EditWorkflowMap","name":e.NodesTableToolbarEditLabel,"icon":"icon icon-toolbar-edit","group":"other"}]}}),csui.define("workflow/toolbars/workflow.expanded.widget.toolbaritems",["i18n!workflow/toolbars/impl/nls/lang","css!workflow/toolbars/impl/workflow.nodestable.toolbaritems"],function(e){"use strict";return{"tableHeaderToolbar":[{"signature":"InitiateDocumentWorkflow","name":e.NodesTableToolbarInitiateLabel,"group":"main"}],"inlineActionbar":[{"signature":"InitiateDocumentWorkflow","name":e.NodesTableToolbarInitiateLabel,"icon":"icon icon-toolbar-wfinitiate","group":"other"}]}}),csui.define("workflow/toolbars/workflow.search.toolbaritems",["i18n!workflow/toolbars/impl/nls/lang","css!workflow/toolbars/impl/workflow.nodestable.toolbaritems"],function(e){"use strict";return{"otherToolbar":[{"signature":"InitiateWorkflow","name":e.NodesTableToolbarInitiateLabel,"group":"main"},{"signature":"InitiateDocumentWorkflow","name":e.NodesTableToolbarInitiateLabel,"group":"main"}],"tableHeaderToolbar":[{"signature":"InitiateWorkflow","name":e.NodesTableToolbarInitiateLabel,"group":"main"}],"inlineToolbar":[{"signature":"InitiateWorkflow","name":e.NodesTableToolbarInitiateLabel,"icon":"icon icon-toolbar-wfinitiate","group":"other"},{"signature":"InitiateDocumentWorkflow","name":e.NodesTableToolbarInitiateLabel,"icon":"icon icon-toolbar-wfinitiate","group":"other"}],"tabularInlineToolbar":[{"signature":"InitiateWorkflow","name":e.NodesTableToolbarInitiateLabel,"icon":"icon icon-toolbar-wfinitiate","group":"other"}]}}),csui.define("workflow/toolbars/workflow.workspaceheader.toolbaritems",["i18n!workflow/toolbars/impl/nls/lang"],function(e){"use strict";return{"delayedActionsToolbar":[{"signature":"InitiateDocumentWorkflow","name":e.NodesTableToolbarInitiateLabel}]}}),csui.define("workflow/models/activity/activity.model",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone"],function(e,t,i){"use strict";return i.Model.extend({"constructor":function(e,t){t||(t={}),this.connector=t.connector||t.collection.connector,i.Model.prototype.constructor.apply(this,arguments)}})}),csui.define("workflow/models/activity/activity.collection.model",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","workflow/models/activity/activity.model"],function(e,t,i,n,o){"use strict";return i.Collection.extend({"model":o,"url":function(){var e=this.connector.connection.url.replace("/v1","/v2");return n.combine(e,"processes",this._processId,"subprocesses",this._subprocessId,"activities")},"parse":function(e){return e.results.data},"constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments),t&&t.connector&&t.connector.assignTo(this)},"isFetchable":function(){return void 0!==this._processId&&void 0!==this._subprocessId},"setData":function(e){this._processId=e.processId,this._subprocessId=e.subprocessId}})}),csui.define("workflow/models/activity/activity.collection.model.factory",["csui/lib/jquery","csui/lib/underscore","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","workflow/models/activity/activity.collection.model"],function(e,t,i,n,o){"use strict";return i.extend({"propertyPrefix":"activities","constructor":function(e,t){i.prototype.constructor.apply(this,arguments);var s=e.getObject(n,t);this.context=e,this.property=new o(void 0,{"connector":s})},"isFetchable":function(){return this.property.isFetchable()},"fetch":function(e){return this.property.fetch(e)}})}),csui.define("workflow/widgets/workitem/workitem.activities/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/widgets/workitem/workitem.activities/impl/nls/root/lang",{"actionLabel":"Action taken","actionAriaLabel":"Action taken by","actionTextAttachmentAttach":"Attach","actionTextAttachmentUpdate":"Update","actionTextAttachmentDelete":"Delete","actionTextForward":"Forward","actionTextReassign":"Re-assign","actionTextReview":"Send for review","actionTextReply":"Reply","actionTextSendOn":"Send on","actionTextStart":"Start","actionTextForwardTo":"Forwarded to:","actionTextReassignTo":"Reassigned to:","actionTextReviewTo":"Sent to:","viewTitle":"Activities","anonymousUserName":"Anonymous User","dateAria":"{0}: Date of Activity","activityAria":"{0}:{1} at {2}:{3}","linkTitleAria":"{0} of type {1}"}),csui.define("hbs!workflow/widgets/workitem/workitem.activities/impl/activity.item",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <div class="attachment">\r\n            <div class="attachment-icon">'+e.escapeExpression((s=null!=(s=l(i,"attachmentIcon")||(null!=t?l(t,"attachmentIcon"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"attachmentIcon","hash":{},"loc":{"start":{"line":15,"column":41},"end":{"line":15,"column":59}}}):s))+'</div>\r\n            <div class="attachment-name" title="'+e.escapeExpression((s=null!=(s=l(i,"attachmentName")||(null!=t?l(t,"attachmentName"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"attachmentName","hash":{},"loc":{"start":{"line":16,"column":48},"end":{"line":16,"column":66}}}):s))+'">\r\n                <div class="attachment-link"><a href="'+e.escapeExpression((s=null!=(s=l(i,"attachmentUrl")||(null!=t?l(t,"attachmentUrl"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"attachmentUrl","hash":{},"loc":{"start":{"line":17,"column":54},"end":{"line":17,"column":71}}}):s))+'"\r\n                                                aria-describedby="'+e.escapeExpression((s=null!=(s=l(i,"attachmentDescID")||(null!=t?l(t,"attachmentDescID"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"attachmentDescID","hash":{},"loc":{"start":{"line":18,"column":66},"end":{"line":18,"column":86}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"attachmentName")||(null!=t?l(t,"attachmentName"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"attachmentName","hash":{},"loc":{"start":{"line":18,"column":88},"end":{"line":18,"column":106}}}):s))+'</a></div>\r\n            </div>\r\n        </div>\r\n        <p id="'+e.escapeExpression((s=null!=(s=l(i,"attachmentDescID")||(null!=t?l(t,"attachmentDescID"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"attachmentDescID","hash":{},"loc":{"start":{"line":21,"column":15},"end":{"line":21,"column":35}}}):s))+'" class="attachment-desc" title="'+e.escapeExpression((s=null!=(s=l(i,"attachmentDesc")||(null!=t?l(t,"attachmentDesc"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"attachmentDesc","hash":{},"loc":{"start":{"line":21,"column":68},"end":{"line":21,"column":86}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"attachmentDesc")||(null!=t?l(t,"attachmentDesc"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"attachmentDesc","hash":{},"loc":{"start":{"line":21,"column":88},"end":{"line":21,"column":106}}}):s))+"</p>\r\n"},"3":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"comment"):t,{"name":"if","hash":{},"fn":e.program(4,o,0),"inverse":e.noop,"loc":{"start":{"line":23,"column":8},"end":{"line":25,"column":15}}}))?s:"")+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"reassign"):t,{"name":"if","hash":{},"fn":e.program(6,o,0),"inverse":e.noop,"loc":{"start":{"line":26,"column":8},"end":{"line":31,"column":15}}}))?s:"")},"4":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'            <p class="comment" title="'+e.escapeExpression((s=null!=(s=l(i,"commentText")||(null!=t?l(t,"commentText"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"commentText","hash":{},"loc":{"start":{"line":24,"column":38},"end":{"line":24,"column":53}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"commentText")||(null!=t?l(t,"commentText"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"commentText","hash":{},"loc":{"start":{"line":24,"column":55},"end":{"line":24,"column":70}}}):s))+"</p>\r\n"},"6":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'            <div class="reassign">\r\n                <p class="reassign-label">'+e.escapeExpression((s=null!=(s=l(i,"reassignLabel")||(null!=t?l(t,"reassignLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"reassignLabel","hash":{},"loc":{"start":{"line":28,"column":42},"end":{"line":28,"column":59}}}):s))+'</p>\r\n                <div class="reassign-user"></div>\r\n            </div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="activity-item">\r\n    <div class="header">\r\n        <div hidden id='+e.escapeExpression((l=null!=(l=a(i,"ariaDescribedById")||(null!=t?a(t,"ariaDescribedById"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"ariaDescribedById","hash":{},"loc":{"start":{"line":3,"column":23},"end":{"line":3,"column":44}}}):l))+">"+e.escapeExpression((l=null!=(l=a(i,"activityAriaDescription")||(null!=t?a(t,"activityAriaDescription"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"activityAriaDescription","hash":{},"loc":{"start":{"line":3,"column":45},"end":{"line":3,"column":72}}}):l))+'</div>\r\n        <div class="details">\r\n            <div class="user"></div>\r\n            <p class="date" aria-label="'+e.escapeExpression((l=null!=(l=a(i,"dateAria")||(null!=t?a(t,"dateAria"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"dateAria","hash":{},"loc":{"start":{"line":6,"column":40},"end":{"line":6,"column":52}}}):l))+'" title="'+e.escapeExpression((l=null!=(l=a(i,"exactDate")||(null!=t?a(t,"exactDate"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"exactDate","hash":{},"loc":{"start":{"line":6,"column":61},"end":{"line":6,"column":74}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"date")||(null!=t?a(t,"date"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"date","hash":{},"loc":{"start":{"line":6,"column":76},"end":{"line":6,"column":84}}}):l))+'</p>\r\n        </div>\r\n        <p class="action">\r\n            <span class="action-label">'+e.escapeExpression((l=null!=(l=a(i,"actionLabel")||(null!=t?a(t,"actionLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"actionLabel","hash":{},"loc":{"start":{"line":9,"column":39},"end":{"line":9,"column":54}}}):l))+'</span>\r\n            <span class="action-text">'+e.escapeExpression((l=null!=(l=a(i,"action")||(null!=t?a(t,"action"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"action","hash":{},"loc":{"start":{"line":10,"column":38},"end":{"line":10,"column":48}}}):l))+"</span>\r\n        </p>\r\n    </div>\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"attachment"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.program(3,o,0),"loc":{"start":{"line":13,"column":4},"end":{"line":32,"column":11}}}))?s:"")+"</div>"}});return i.registerPartial("workflow_widgets_workitem_workitem.activities_impl_activity.item",n),n}),csui.define("css!workflow/widgets/workitem/workitem.activities/impl/activity.item",[],function(){}),csui.define("workflow/widgets/workitem/workitem.activities/impl/activity.item.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/behaviors/default.action/default.action.behavior","csui/controls/form/fields/userfield.view","csui/controls/node-type.icon/node-type.icon.view","csui/models/member","csui/models/node/node.model","csui/utils/base","csui/utils/commands/open","csui/utils/nodesprites","i18n!workflow/widgets/workitem/workitem.activities/impl/nls/lang","hbs!workflow/widgets/workitem/workitem.activities/impl/activity.item","css!workflow/widgets/workitem/workitem.activities/impl/activity.item"],function(e,t,i,n,o,s,l,a,r,c,u,d,p,m){"use strict";return n.LayoutView.extend({"className":"workflow-activity","template":m,"tagName":"li","templateHelpers":function(){this.activityAriaDescribedById=e.uniqueId("ActivityDescID_");var t,i=this._getAttachmentInfo(),n=this.model.get("comment"),o=this._getAuditDate(!0),s=this._getAuditAction();t=n&&0!==n.length?n:"";var l=e.str.sformat(p.activityAria,p.actionLabel,s,o,t);return{"date":o,"exactDate":this._getAuditDate(!1),"actionLabel":p.actionLabel,"action":s,"comment":n&&0!==n.length,"commentText":n,"reassign":this._isReassignAction(),"reassignLabel":this._getReassignLabel(),"attachment":i.isAttachmentAction,"attachmentUrl":i.url,"attachmentName":i.name,"attachmentDesc":i.description,"attachmentDisabled":this._hasAttachmentOpenAction(),"dateAria":p.dateAria.replace("{0}",o),"attachmentDescID":e.uniqueId("descID_"),"activityAriaDescription":l,"ariaDescribedById":this.activityAriaDescribedById}},"events":{"click .attachment-name > a":"onDownloadAttachment"},"_getAuditDate":function(e){return!0===e?c.formatFriendlyDateTime(this.model.get("date")):c.formatExactDateTime(this.model.get("date"))},"_getAuditAction":function(){var e,t=this.model.get("action");switch(t){case"start":t=p.actionTextStart;break;case"sendon":t=p.actionTextSendOn;break;case"forward":t=p.actionTextForward;break;case"review":t=p.actionTextReview;break;case"reassign":t=p.actionTextReassign;break;case"reply":t=p.actionTextReply;break;case"disposition":e=this.model.get("action_properties"),t=e.label||e.event;break;case"attachment":switch(e=this.model.get("action_properties"),e.event){case"create":t=p.actionTextAttachmentAttach;break;case"delete":t=p.actionTextAttachmentDelete;break;case"addversion":t=p.actionTextAttachmentUpdate}}return t},"_isReassignAction":function(){var e=this.model.get("action");return"forward"===e||"review"===e||"reassign"===e},"_isAttachmentAction":function(){return"attachment"===this.model.get("action")},"_hasAttachmentOpenAction":function(){return this.nodeModel&&this.nodeModel.actions.get("open")},"_getAttachmentInfo":function(){var t={"isAttachmentAction":this._isAttachmentAction()};if(!0===t.isAttachmentAction){var n=this.model.get("action_properties").node;e.isUndefined(n)||(t.id=n.id,t.name=n.name,t.description=n.description,t.type=n.type,t.mime_type=n.mime_type,t.container=n.container,t.isNodeDeleted=n.isNodeDeleted,t.type_name=n.type_name,t.url=o.getDefaultActionNodeUrl(new i.Model(n,{"connector":this.model.connector})))}return t},"_getReassignLabel":function(){var e=this.model.get("action");switch(e){case"forward":e=p.actionTextForwardTo;break;case"reassign":e=p.actionTextReassignTo;break;case"review":e=p.actionTextReviewTo}return e},"regions":{"userRegion":".activity-item .user","reassignUserRegion":".activity-item .reassign-user","attachmentIconRegion":".activity-item .attachment-icon"},"constructor":function(e){e||(e={}),n.LayoutView.prototype.constructor.apply(this,arguments)},"onDownloadAttachment":function(e){e.preventDefault(),this._hasAttachmentOpenAction()&&(new u).execute({"nodes":new i.Collection([this.nodeModel])},{"context":this.options.context})},"showIcon":function(t){var i=new l({"node":t.nodeModel});this.attachmentIconRegion&&this.attachmentIconRegion.show(i),this._hasAttachmentOpenAction()||(t.nodeModel.get("isNodeDeleted")?this.$(".attachment .attachment-link").addClass("disabled"):this.$(".attachment > div").addClass("disabled"));var n,o=d.findByNode(t.nodeModel)||{};o.attributes&&(n=o.get("mimeType"));var s=n||t.nodeModel.get("type_name")||t.nodeModel.get("type");if(t.nodeModel.get("name")&&s){var a=e.str.sformat(p.linkTitleAria,t.nodeModel.get("name"),s);this.$(".attachment-name a").attr("aria-label",a)}},"onRender":function(){var e=this,n=t.Deferred(),o=this.model.get("user_id");if(o&&0!==o){n=new a({"id":o},{"connector":e.options.connector}).fetch()}else n.resolve({"data":{"display_name":p.anonymousUserName}});if(t.when(n).then(function(t){var n=new s({"context":e.options.context,"mode":"readonly","model":new i.Model({"data":t.data,"schema":{"readonly":!0}}),"alpaca":{"options":{}}});e.listenTo(n,"render",function(){var e=n.$("a.esoc-user-container").attr("aria-label");n.$("a.esoc-user-container").attr("aria-label",p.actionAriaLabel+e),n.$("a.esoc-user-container").attr("aria-describedby",this.activityAriaDescribedById)}),e.userRegion&&e.userRegion.show(n)}),!0===this._isReassignAction()){var l=t.Deferred(),c=this.model.get("action_properties").user_id;if(c&&0!==c){l=new a({"id":c},{"connector":e.options.connector}).fetch()}else l.resolve({"data":{"display_name":p.anonymousUserName}});t.when(l).then(function(t){var n=new s({"context":e.options.context,"mode":"readonly","model":new i.Model({"data":t.data,"schema":{"readonly":!0}}),"alpaca":{"options":{}}});e.listenTo(n,"render",function(){var e=n.$("a.esoc-user-container").attr("aria-label"),t=this._getReassignLabel();n.$("a.esoc-user-container").attr("aria-label",t.substring(0,t.length-1)+e)}),e.reassignUserRegion&&e.reassignUserRegion.show(n)})}!0===this._isAttachmentAction()&&(e.nodeModel=new r(this._getAttachmentInfo(),{"connector":this.options.connector,"expand":{"properties":["original_id"]},"commands":["open"],"defaultActionCommands":["open"]}),this.model.get("action_properties").node.isNodeDeleted?this.showIcon(e):e.nodeModel.fetch().then(function(){e.showIcon(e)}))}})}),csui.define("workflow/widgets/workitem/workitem.activities/impl/activity.list.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","workflow/models/activity/activity.collection.model.factory","workflow/widgets/workitem/workitem.activities/impl/activity.item.view","i18n!workflow/widgets/workitem/workitem.activities/impl/nls/lang"],function(e,t,i,n,o,s,l){"use strict";return i.CollectionView.extend({"className":"workflow-activity-list","childView":s,"tagName":"ul","focusableElements":[],"childViewOptions":function(){return{"context":this.options.context,"connector":this.collection.connector}},"behaviors":{"TabableRegion":{"behaviorClass":n}},"events":{"keydown":"onKeyDown"},"selectedIndex":0,"onKeyDown":function(e){var t;switch(e.keyCode){case 38:t=this.currentlyFocusedElement(),this._moveTo(e,this._selectPrevious(),t);break;case 40:t=this.currentlyFocusedElement(),this._moveTo(e,this._selectNext(),t)}},"_moveTo":function(t,i,n){t.preventDefault(),t.stopPropagation(),setTimeout(e.bind(function(){i.trigger("focus"),n.prop("tabindex","-1"),i.prop("tabindex","0")},this),50)},"_selectNext":function(){return this.selectedIndex<this.focusableElements.length-1&&this.selectedIndex++,this.currentlyFocusedElement()},"_selectPrevious":function(){return this.selectedIndex>0&&this.selectedIndex--,this.currentlyFocusedElement()},"currentlyFocusedElement":function(){this.focusableElements=[];var i=this.$("li"),n=this;return e.each(i,function(i){var o=t(i).find(".esoc-user-container");e.each(o,function(e){n.focusableElements.push(e)});var s=t(i).find(".attachment-name > a");e.each(s,function(e){n.focusableElements.push(e)})}),this.focusableElements.length>this.selectedIndex?this.$(this.focusableElements[this.selectedIndex]):null},"constructor":function(e){e||(e={}),e.collection=e.collection?e.collection:e.context.getModel(o),void 0!==e.processId&&void 0!==e.subprocessId&&e.collection.setData({"processId":e.processId,"subprocessId":e.subprocessId}),i.CollectionView.prototype.constructor.apply(this,arguments)}})}),csui.define("hbs!workflow/widgets/workitem/workitem.activities/impl/workitem.activities",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="workflow-activities" tabindex="-1"></div>\r\n'}});return i.registerPartial("workflow_widgets_workitem_workitem.activities_impl_workitem.activities",n),n}),csui.define("css!workflow/widgets/workitem/workitem.activities/impl/workitem.activities",[],function(){}),csui.define("workflow/widgets/workitem/workitem.activities/workitem.activities.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","workflow/widgets/workitem/workitem.activities/impl/activity.list.view","hbs!workflow/widgets/workitem/workitem.activities/impl/workitem.activities","css!workflow/widgets/workitem/workitem.activities/impl/workitem.activities"],function(e,t,i,n,o,s,l){"use strict";var a=i.LayoutView.extend({"className":"workflow-activities-container","template":l,"regions":{"activitiesListRegion":".workflow-activities"},"constructor":function(e){this.options=e||(e={}),i.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"behaviors":{"ScrollingBehavior":{"behaviorClass":n,"contentParent":".workflow-activities","suppressScrollX":!0}},"onRender":function(){var e=new s(this.options);this.activitiesListRegion.show(e)}});return e.extend(a.prototype,o),a}),csui.define("workflow/widgets/workitem/workitem.activities/workitem.activities.controller",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/contexts/factories/node","workflow/utils/workitem.extension.controller","workflow/models/activity/activity.collection.model.factory","workflow/widgets/workitem/workitem.activities/workitem.activities.view","i18n!workflow/widgets/workitem/workitem.activities/impl/nls/lang"],function(e,t,i,n,o,s,l,a,r,c){"use strict";return l.extend({"type":100,"sub_type":100,"position":2,"constructor":function(e,t){l.prototype.constructor.apply(this,arguments),t||(t={}),this.context=e.context},"validate":function(e,t){return e===this.type&&t===this.sub_type},"execute":function(e){var i=t.Deferred();if(e.extensionPoint!==l.ExtensionPoints.AddSidebar||e.model.get("isDraft")||void 0!==e.model.get("isDoc")||void 0!==e.model.get("isDocDraft"))return i.resolve({}),i.promise();var n=this.context.getModel(a);n.setData({"processId":e.model.get("process_id"),"subprocessId":e.model.get("subprocess_id")}),n.fetch();var o={"title":c.viewTitle,"position":this.position,"viewToRender":r,"viewToRenderOptions":{"context":this.context,"collection":n}};return i.resolve(o),i.promise()}})}),csui.define("workflow/behaviors/list.keyboard.behavior",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette"],function(e,t,i,n){"use strict";return n.Behavior.extend({"defaults":{"currentlyFocusedElementSelector":"li:nth-child({0})"},"constructor":function(e,o){n.Behavior.prototype.constructor.apply(this,arguments),t.extend(o,{"selectedIndex":0,"$inlineItems":void 0,"inlineItemIndex":0,"inlineDropDownIsOpenSelector":"","$inlineItemsDropDown":void 0,"inlineItemDropDownIndex":-1,"onKeyDown":function(e){var t;switch(e.keyCode){case 27:this.inlineItemDropDownIndex=-1;break;case 38:void 0!==this.$inlineItemsDropDown&&0!==this.$inlineItemsDropDown.length&&this.$(this.inlineDropDownIsOpenSelector).length>0?this._moveInlineMenu(e,this._selectPreviousInlineElementMenu()):(t=this.currentlyFocusedElement(),this._moveTo(e,this._selectPrevious(),t));break;case 40:void 0!==this.$inlineItemsDropDown&&0!==this.$inlineItemsDropDown.length&&this.$(this.inlineDropDownIsOpenSelector).length>0?this._moveInlineMenu(e,this._selectNextInlineElementMenu()):(t=this.currentlyFocusedElement(),this._moveTo(e,this._selectNext(),t));break;case 39:i(e.target).hasClass("cs-input")||0!==this.$inlineItems.length&&0===this.$(this.inlineDropDownIsOpenSelector).length&&this._moveInline(e,this._selectNextInlineElement());break;case 37:i(e.target).hasClass("cs-input")||0!==this.$inlineItems.length&&0===this.$(this.inlineDropDownIsOpenSelector).length&&this._moveInline(e,this._selectPreviousInlineElement())}},"_moveInlineMenu":function(e,i){e.preventDefault(),e.stopPropagation(),setTimeout(t.bind(function(){this.$inlineItemsDropDown.prop("tabindex","-1"),i.trigger("focus"),i.prop("tabindex","0")},this),50)},"_selectNextInlineElementMenu":function(){return this.inlineItemDropDownIndex<this.$inlineItemsDropDown.length-1&&this.inlineItemDropDownIndex++,this.$(this.$inlineItemsDropDown[this.inlineItemDropDownIndex])},"_selectPreviousInlineElementMenu":function(){return this.inlineItemDropDownIndex>0&&this.inlineItemDropDownIndex--,this.$(this.$inlineItemsDropDown[this.inlineItemDropDownIndex])},"_moveInline":function(e,i){e.preventDefault(),e.stopPropagation(),setTimeout(t.bind(function(){this.$inlineItems.prop("tabindex","-1"),i.trigger("focus"),i.prop("tabindex","0")},this),50)},"_selectNextInlineElement":function(){return this.inlineItemIndex<this.$inlineItems.length-1&&this.inlineItemIndex++,this.$(this.$inlineItems[this.inlineItemIndex])},"_selectPreviousInlineElement":function(){return this.inlineItemIndex>0&&this.inlineItemIndex--,this.$(this.$inlineItems[this.inlineItemIndex])},"_moveTo":function(e,i,n){e.preventDefault(),e.stopPropagation(),setTimeout(t.bind(function(){i.trigger("focus"),n.prop("tabindex","-1"),i.prop("tabindex","0")},this),50)},"_selectNext":function(){var e=this.collection||this.model;return this.selectedIndex<e.length-1&&this.selectedIndex++,this.currentlyFocusedElement()},"_selectPrevious":function(){return this.selectedIndex>0&&this.selectedIndex--,this.currentlyFocusedElement()},"currentlyFocusedElementSelector":this.options.currentlyFocusedElementSelector,"currentlyFocusedElement":function(){var e=this.collection||this.model;0!==this.selectedIndex&&this.selectedIndex>=e.length&&(this.selectedIndex=e.length-1);var t=this.$(this.currentlyFocusedElementSelector);return t.length>this.selectedIndex?this.$(t[this.selectedIndex]):null}})}})}),csui.define("workflow/widgets/workitem/workitem.attachments/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/widgets/workitem/workitem.attachments/impl/nls/root/lang",{"TabTitle":"Attachments","AddToolbarItemLabel":"Add attachment","AddFromContentServerLabel":"Add from Content Server","AddFromDesktopLabel":"Add from Desktop","AddShortcutLabel":"Add shortcut","AddDocumentLabel":"Add document(s)","ButtonLabelAdd":"Add","CommandNameAdd":"Add","CommandVerbAdd":"add","CommandDoneVerbAdd":"copied","AddPageLeavingWarning":"If you leave the page now, pending items will not be added.","AddingOneFile":"Adding file","AddFilesSucceeded":"{0} files succeeded.","AddOneFileSucceeded":"Add succeeded.","AddFiles":"Adding {0} files","AddFilesFailed":"{2} files failed to add.","AddFilesOneFailed":"1 file failed to add.","CopyOneFileFailed":"Copy failed","CopyingNodes":"Copying {0} nodes","CopyingNode":"Copying 1 node","DropMessage":"Drop your item(s) here","EmptyDragAndDropMessage":"Drag and drop files here","MessageItemCopied":"{0} item copied.","MessageItemsCopied":"{0} items copied.","AddingNodes":"Adding {0} nodes","AddingNode":"Adding 1 node","MessageItemAdded":"{0} item Added.","MessageItemsAdded":"{0} items Added.","ErrorMessageLoadAttachments":"Workflow attachments could not be loaded.","DescriptionPlaceholder":"Add description","NamePlaceholder":"Enter file name","FileAlreadyExists":"An item with the name '{0}' already exists","MaxLengthReached":"This field must contain at most 248 numbers or characters.","Cancel":"Cancel","NoFiles":"No files were dropped.","AddTypeDenied":"Cannot add documents to {1}.","AttachmentsFailMessageTitle":"Unable to start the workflow","AttachmentsFailMessage":"An error prevented {0} from being attached to the workflow.","linkTitleAria":"{0} of type {1}"}),csui.define("workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments.draganddrop.view",["csui/lib/underscore","csui/lib/marionette","csui/controls/draganddrop/draganddrop.view","csui/controls/fileupload/fileupload","csui/controls/globalmessage/globalmessage","i18n!workflow/widgets/workitem/workitem.attachments/impl/nls/lang"],function(e,t,i,n,o,s){"use strict";return i.extend({"constructor":function(e){i.prototype.constructor.call(this,e)},"onDropView":function(t){t.preventDefault(),t.stopPropagation();var i=this,l=t.originalEvent&&t.originalEvent.dataTransfer||{"files":t.originalEvent&&t.originalEvent.target&&t.originalEvent.target.files||[]};this.checkFiles(l).always(function(t){if(t=e.reject(t,function(e){return e instanceof Error}),t.length)if(1===t.length&&(i.collection.singleFileUpload=!0),i.canAdd()){var l=n.newUpload(e.extend({"originatingView":i.parentView},e.clone(i.options))),a=i.container?i.container.get("id"):void 0,r=i.parentView&&i.parentView.options&&i.parentView.options.collection&&i.parentView.options.collection.node?i.parentView.options.collection.node.get("id"):void 0;a!==r&&(l.originalCollectionUrl=""),l.addFilesToUpload(t,{"collection":i.collection})}else{var c=i.container.get("name");o.showMessage("error",s.AddTypeDenied.replace("{1}",c))}else o.showMessage("error",s.NoFiles)}),this.disable()},"onOverView":function(t){t.preventDefault(),t.stopPropagation(),this.parentView.showDropMessage=!0,this.parentView.checkDropMessage=!0,this.leaveViewTimeout?(clearTimeout(this.leaveViewTimeout),this.leaveViewTimeout=void 0):this.options.hideDropMessage||this.enable(!1);var i=t.originalEvent&&t.originalEvent.dataTransfer,n=i.items,o=n&&n.length&&e.all(n,function(e){return"file"===e.kind}),l=i&&i.types,a=l&&l.length&&e.any(l,function(e){return"files"===e.toLowerCase()}),r=s.dropInvalid;if(this.valid=n&&o||a,!this.canAdd()){var c=this.isDndSupportedContainer(this.parentView.container);this.valid=c&&this.options.isSupportedRowView,r=s.dropNotPermitted}if(this.currentRowHighlightedTarget&&(this.highlightedTarget=this.currentRowHighlightedTarget,this.currentRowHighlightedTarget=void 0),!this.options.hideDropMessage&&this.valid&&this._resetMessage({"items":n}),!this.overViewTimeout){this.overViewTimeout=void 0;var u,d=this.parentView.csuiDropMessage,p=d.hasClass("csui-disabled");this.valid?(p&&d.removeClass("csui-disabled"),u={"disabled":!1,"highlightedTarget":this.highlightedTarget}):(!p&&d.addClass("csui-disabled"),this.options.hideDropMessage||d.html(this.template({"message":r})),u={"disabled":!0}),this.options.hideDropMessage||d.show(),this.visible=!0,this.trigger("drag:over",this,u)}}})
}),csui.define("workflow/widgets/workitem/workitem.attachments/impl/workitem.attachment.tableactionbar",["csui/lib/backbone","csui/controls/tableactionbar/tableactionbar.view","csui/models/nodes","csui/utils/commandhelper","csui/utils/commands/properties"],function(e,t,i,n,o){"use strict";return t.extend({"onChildviewToolitemAction":function(t,s){var l,a=s.toolItem.get("signature"),r=this.commands.findWhere({"signature":a}),c={"nodes":new i([this.model]),"container":this.container,"collection":this.containerCollection,"originatingView":this.originatingView,"context":this.options.context};e.trigger("closeToggleAction"),"Properties"===a?(this.originatingView.collection.propertiesAction=!0,this.propertiesCommand=new o,l=this.propertiesCommand.execute(c)):l=r.execute(c),n.handleExecutionResults(l,{"command":r,"suppressSuccessMessage":c.suppressSuccessMessage})}})}),csui.define("workflow/widgets/workitem/workitem.attachments/workitem.attachments.toolbaritems",["csui/lib/underscore","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui-ext!workflow/widgets/workitem/workitem.attachments/toolbaritems"],function(e,t,i,n,o){"use strict";var s={"inlineActionbar":new t({"other":[{"signature":"Properties","name":n.ToolbarItemInfo,"icon":"icon icon-toolbar-metadata"},{"signature":"Edit","name":n.ToolbarItemEdit,"icon":"icon icon-toolbar-edit"},{"signature":"Download","name":n.ToolbarItemDownload,"icon":"icon icon-toolbar-download"},{"signature":"OpenShortlink","name":n.ToolbarItemOpen,"icon":"icon icon-toolbar-shortcut"},{"signature":"InlineEdit","name":n.ToolbarItemRename,"icon":"icon icon-toolbar-rename"},{"signature":"Copy","name":n.ToolbarItemCopy,"icon":"icon icon-toolbar-copy"},{"signature":"Move","name":n.ToolbarItemMove,"icon":"icon icon-toolbar-move"},{"signature":"AddVersion","name":n.ToolbarItemAddVersion,"icon":"icon icon-toolbar-add-version"},{"signature":"Delete","name":n.ToolbarItemDelete,"icon":"icon icon-toolbar-delete"}]},{"maxItemsShown":4,"dropDownText":n.ToolbarItemMore,"dropDownIcon":"icon icon-toolbar-more"})};return o&&function(t){e.each(t,function(t){e.each(t,function(t,n){var o=s[n];if(!o)throw new Error("Invalid target toolbar: "+n);e.each(t,function(e){e=new i(e),o.addItem(e)})})})}(o),s}),csui.define("workflow/commands/open.shortlink/open.shortlink",["module","csui/lib/underscore","csui/lib/jquery","csui/utils/commandhelper","csui/models/command"],function(e,t,i,n,o){"use strict";return o.extend({"defaults":{"signature":"OpenShortlink","command_key":["openshortlink","OpenShortlink"],"name":"OpenShortlink","verb":"OpenShortlink","doneVerb":"OpenShortlink","scope":"single"},"execute":function(e,t){var o=n.getJustOneNode(e),s=i.Deferred();return o.set("ActionBarShortcutOpenCommand",!0,{"silent":!0}),o.unset("ActionBarShortcutOpenCommand"),s.resolve(),s.promise()}})}),csui.define("hbs!workflow/widgets/workitem/workitem.attachments/impl/workitem.attachmentitem",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="workitem-attachments-item">\r\n  <div class="workitem-attachments-icon"></div>\r\n  <div class="workitem-attachments-info">\r\n    <a class="workitem-attachments-name" href="'+e.escapeExpression((s=null!=(s=l(i,"defaultActionUrl")||(null!=t?l(t,"defaultActionUrl"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"defaultActionUrl","hash":{},"loc":{"start":{"line":4,"column":47},"end":{"line":4,"column":67}}}):s))+'">\r\n      <div class="workitem-attachment-name" title="'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":5,"column":51},"end":{"line":5,"column":59}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":5,"column":61},"end":{"line":5,"column":69}}}):s))+'</div>\r\n    </a>\r\n\r\n    <input id="workitem-attachments-name-input-'+e.escapeExpression((s=null!=(s=l(i,"nodeId")||(null!=t?l(t,"nodeId"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"nodeId","hash":{},"loc":{"start":{"line":8,"column":47},"end":{"line":8,"column":57}}}):s))+'" class="workitem-attachments-name-input\r\n    binf-form-control cs-input rename-field binf-hidden" placeholder="'+e.escapeExpression((s=null!=(s=l(i,"namePlaceholder")||(null!=t?l(t,"namePlaceholder"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"namePlaceholder","hash":{},"loc":{"start":{"line":9,"column":70},"end":{"line":9,"column":89}}}):s))+'"\r\n           tabindex="-1" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"namePlaceholder")||(null!=t?l(t,"namePlaceholder"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"namePlaceholder","hash":{},"loc":{"start":{"line":10,"column":37},"end":{"line":10,"column":56}}}):s))+'" title="'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":10,"column":65},"end":{"line":10,"column":73}}}):s))+'">\r\n    <span class="workitem-attachments-name-cancel csui-undo edit-cancel inline-edit-icon\r\n      rename-field binf-hidden" tabindex="-1" title="'+e.escapeExpression((s=null!=(s=l(i,"cancel")||(null!=t?l(t,"cancel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"cancel","hash":{},"loc":{"start":{"line":12,"column":53},"end":{"line":12,"column":63}}}):s))+'"></span>\r\n\r\n    <div id="workitem-attachments-error-message-'+e.escapeExpression((s=null!=(s=l(i,"nodeId")||(null!=t?l(t,"nodeId"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"nodeId","hash":{},"loc":{"start":{"line":14,"column":48},"end":{"line":14,"column":58}}}):s))+'"\r\n         class="workitem-attachments-error-message binf-hidden"></div>\r\n\r\n    <div class="workitem-attachments-description">\r\n        <textarea id="workitem-attachments-description-input-'+e.escapeExpression((s=null!=(s=l(i,"nodeId")||(null!=t?l(t,"nodeId"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"nodeId","hash":{},"loc":{"start":{"line":18,"column":61},"end":{"line":18,"column":71}}}):s))+'" class="workitem-attachments-description-input binf-form-control cs-input rename-field\r\n      binf-hidden" placeholder="'+e.escapeExpression((s=null!=(s=l(i,"descriptionPlaceholder")||(null!=t?l(t,"descriptionPlaceholder"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"descriptionPlaceholder","hash":{},"loc":{"start":{"line":19,"column":32},"end":{"line":19,"column":58}}}):s))+'" tabindex="-1" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"descriptionPlaceholder")||(null!=t?l(t,"descriptionPlaceholder"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"descriptionPlaceholder","hash":{},"loc":{"start":{"line":19,"column":86},"end":{"line":19,"column":112}}}):s))+'" rows="2"></textarea>\r\n      <span class="workitem-attachments-description-cancel csui-undo edit-cancel inline-edit-icon\r\n      rename-field binf-hidden" tabindex="-1" title="'+e.escapeExpression((s=null!=(s=l(i,"cancel")||(null!=t?l(t,"cancel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"cancel","hash":{},"loc":{"start":{"line":21,"column":53},"end":{"line":21,"column":63}}}):s))+'"></span>\r\n\r\n      <div class="wrap">\r\n        <div>\r\n\r\n        <span\r\n            class="workitem-attachment-description workitem-attachments-description-ro binf-hidden"\r\n            title="'+e.escapeExpression((s=null!=(s=l(i,"description")||(null!=t?l(t,"description"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"description","hash":{},"loc":{"start":{"line":28,"column":19},"end":{"line":28,"column":34}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"description")||(null!=t?l(t,"description"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"description","hash":{},"loc":{"start":{"line":28,"column":36},"end":{"line":28,"column":51}}}):s))+'</span>\r\n\r\n          <span\r\n              class="workitem-attachment-description workitem-attachments-empty-description-ro binf-hidden"\r\n              title="'+e.escapeExpression((s=null!=(s=l(i,"descriptionPlaceholder")||(null!=t?l(t,"descriptionPlaceholder"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"descriptionPlaceholder","hash":{},"loc":{"start":{"line":32,"column":21},"end":{"line":32,"column":47}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"descriptionPlaceholder")||(null!=t?l(t,"descriptionPlaceholder"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"descriptionPlaceholder","hash":{},"loc":{"start":{"line":32,"column":49},"end":{"line":32,"column":75}}}):s))+'</span>\r\n\r\n        </div>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n  <div class="workitem-attachments-actions"></div>\r\n</div>\r\n'}});return i.registerPartial("workflow_widgets_workitem_workitem.attachments_impl_workitem.attachmentitem",n),n}),csui.define("css!workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments",[],function(){}),csui.define("workflow/widgets/workitem/workitem.attachments/impl/workitem.attachmentitem.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/default.action/default.action.behavior","csui/utils/log","csui/controls/globalmessage/globalmessage","workflow/widgets/workitem/workitem.attachments/impl/workitem.attachment.tableactionbar","csui/controls/node-type.icon/node-type.icon.view","workflow/widgets/workitem/workitem.attachments/workitem.attachments.toolbaritems","workflow/commands/open.shortlink/open.shortlink","hbs!workflow/widgets/workitem/workitem.attachments/impl/workitem.attachmentitem","i18n!workflow/widgets/workitem/workitem.attachments/impl/nls/lang","css!workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments"],function(e,t,i,n,o,s,l,a,r,c,u,d){"use strict";return i.ItemView.extend({"className":"workitem-attachment-properties","template":u,"tagName":"li","behaviors":{"DefaultAction":{"behaviorClass":n}},"templateHelpers":function(){var e;return this.model.attributes.id?e=this.model.attributes.id:this.model.attributes.original_id&&(e=this.model.attributes.original_id),{"name":this.model.get("name"),"description":this.model.get("description"),"defaultActionUrl":n.getDefaultActionNodeUrl(this.model),"descriptionPlaceholder":d.DescriptionPlaceholder,"namePlaceholder":d.NamePlaceholder,"nodeId":e,"cancel":d.Cancel}},"ui":{"attachmentItem":".workitem-attachments-item","attachmentIcon":".workitem-attachments-icon","attachmentAction":"a.workitem-attachments-name","attachmentDescription":"div.workitem-attachments-description","attachmentDescriptionRO":"span.workitem-attachments-description-ro","attachmentDescriptionInput":".workitem-attachments-description-input","attachmentDescriptionCancel":".workitem-attachments-description-cancel","attachmentNameInput":".workitem-attachments-name-input","attachmentName":".workitem-attachment-name","attachmentErrorMsg":".workitem-attachments-error-message","attachmentNameCancel":".workitem-attachments-name-cancel","attachmentEmptyDescriptionRO":".workitem-attachments-empty-description-ro"},"events":{"keydown":"onKeyDown","mouse:enter":"onMouseEnter","mouse:leave":"onMouseLeave","focusin @ui.attachmentAction":"onFocusIn","focusout @ui.attachmentItem":"onFocusOutItem","click @ui.attachmentAction":"onClickItem"},"triggers":{"mouseenter":"mouse:enter","mouseleave":"mouse:leave","click @ui.attachmentDescriptionRO, @ui.attachmentEmptyDescriptionRO":"click:description","click @ui.attachmentDescriptionCancel,@ui.attachmentNameCancel":"click:cancel","click ":"click:item:brava"},"constructor":function(e){this.options=e,i.ItemView.prototype.constructor.call(this,e),this.listenTo(this.model,"change:csuiInlineFormErrorMessage",this.onRenameMode),this.listenTo(this.model,"change:ActionBarShortcutOpenCommand",this.openShortlink),this.listenTo(this.model,"change:mime_type",this.render)},"onKeyDown":function(e){var i=e.keyCode,n=t(e.target),o=!0;switch(i){case 9:n.hasClass("workitem-attachments-description-input")&&this.ui.attachmentDescriptionCancel.hasClass("binf-hidden")&&(this.ui.attachmentNameInput.trigger("focus"),o=!1),n.hasClass("workitem-attachments-name-input")&&(this.ui.attachmentDescriptionInput.trigger("focus"),o=!1),n.hasClass("workitem-attachments-description-input")&&this.ui.attachmentNameCancel.hasClass("binf-hidden")&&(this.ui.attachmentDescriptionInput.trigger("focus"),o=!1);break;case 27:(n.hasClass("cs-input")||n.hasClass("edit-cancel"))&&(this._cancelEdit(),o=!1);break;case 32:case 13:n.hasClass("workitem-attachments-item")&&(e.preventDefault(),e.stopPropagation(),this.triggerMethod("click:item:brava",this)),n.hasClass("cs-input")?13===i&&(e.preventDefault(),e.stopPropagation(),o=!1,this.validateFileName()&&!this._parent.errorCase&&(this._cancelEdit(),this._submitDescription())):n.hasClass("edit-cancel")&&(e.preventDefault(),e.stopPropagation(),o=!1,this._cancelEdit());break;case 113:this.ui.attachmentDescriptionRO.hasClass("binf-hidden")&&this.ui.attachmentEmptyDescriptionRO.hasClass("binf-hidden")||this.onRenameMode(),n.hasClass("cs-input")&&(e.preventDefault(),e.stopPropagation(),o=!1,this.validateFileName()&&!this._parent.errorCase&&(this._submitDescription(),this._cancelEdit()))}return o},"onFocusIn":function(e){this._showActionBar({"view":e,"model":e.model})},"onMouseEnter":function(e){this._showActionBar({"view":e,"model":e.model})},"onMouseLeave":function(e){this._destroyActionBar()},"onClickItem":function(i){if(i.preventDefault(),this.cancelPrevEdit(),(this.model.get("container")||this.model.original&&this.model.original.get("container"))&&this.options.view){var n={"validate":!1},o=!1,s=this.options.view;!0===this.options.view.isAttachmentCentric&&0===s.$el.find(".workflow-workitem-body").length&&(o=!0),this.options.view.model.trigger("form:isValid",n),this.options.view.model.get("isWFStatusItemAttachment")?this.triggerMethod("execute:defaultAction",this.model):n.validate||o?((this.options.view.model.get("isDraft")||this.options.view.model.get("isDocDraft")||this.options.view.model.get("isDoc"))&&this.options.view.model.trigger("form:saveForms"),this.options.view.blockActions(),t.when.apply(t,this.options.view.model.get("saveFormsList")).done(e.bind(function(){this.triggerMethod("execute:defaultAction",this.model)},this)).always(e.bind(function(e){this.options.view.unblockActions()},this))):!0===this.options.view.isAttachmentCentric&&this.showWfPropertiesmetadataDropDownView(s)}else this.triggerMethod("execute:defaultAction",this.model)},"onClickDescription":function(e){this._editDescription()},"onClickCancel":function(e){this._cancelEdit()},"onFocusOutItem":function(e){var i=t(e.relatedTarget);if(!(i.hasClass("cs-input")||i.hasClass("edit-cancel")||t(e.target).hasClass("edit-cancel")||t(e.target).hasClass("needsclick")))if(this.isEditMode()&&this.validateFileName()&&!this._parent.errorCase){this._submitDescription();var n=!1,o=t(t(":active").length?":active":":hover"),s=t(o[o.length-1]);(s.hasClass("workitem-attachment-description")||s.hasClass("workitem-attachment-name")||s.hasClass("icon icon-toolbar-rename"))&&(n=!0),n||this._cancelEdit()}else!1===i.hasClass("csui-toolitem")&&!1===i.hasClass("workitem-expand-icon")&&(this._destroyActionBar(),this.$(".workitem-attachments-name").prop("tabindex","0"))},"_editDescription":function(){var t=this.model.actions.findWhere({"signature":"Rename"}),i=this.model.actions.findWhere({"signature":"rename"});if(!(e.isUndefined(t)&&(e.isUndefined(i)||this._parent.errorCase)||(this.cancelPrevEdit(),this._destroyActionBar(),this.ui.attachmentDescriptionRO.hasClass("binf-hidden")&&this.ui.attachmentEmptyDescriptionRO.hasClass("binf-hidden")))){var n=this.model.get("description");this.ui.attachmentDescriptionInput.val(n),this.model.get("description")?this.ui.attachmentDescriptionRO.addClass("binf-hidden"):this.ui.attachmentEmptyDescriptionRO.addClass("binf-hidden"),this.ui.attachmentDescriptionInput.removeClass("binf-hidden"),this.ui.attachmentDescriptionCancel.removeClass("binf-hidden"),this.ui.attachmentItem.addClass("workitem-attachments-description-edit"),this.ui.attachmentDescriptionInput.trigger("focus"),this._parent.editMode=this.model.get("id"),this.triggerMethod("editmode:item",this)}},"_submitDescription":function(){if(this.ui.attachmentDescriptionRO.hasClass("binf-hidden")){var t=this.ui.attachmentDescriptionInput.val().trim(),i=this.model.get("description"),n=this._checkName(),o=this.model.get("name");0===n.length?this._cancelEdit():(this.model.set({"name":n,"description":t}),this.model.save({"name":n,"description":t},{"wait":!0,"patch":!0,"includeActions":!0}).done(e.bind(function(){var t=this.model.clone();t.collection=this.model.collection,t.fetch().then(e.bind(function(){this.model.set(t.attributes),t.original&&(this.model.original=t.original),this.$(".workitem-attachments-actions>div>ul>li>a.csui-toolitem").length>0&&this._updateActionBarAndPrepareKeyboardAccess()},this))},this)).fail(e.bind(function(e){s.showMessage("error",e.responseJSON.error),this.model.set({"name":o,"description":i}),this.model.fetch(),this.render()},this)),this._parent.errorCase=!1)}},"_checkName":function(){return this.ui.attachmentName.hasClass("binf-hidden")&&this.ui.attachmentDescriptionRO.hasClass("binf-hidden")?this.ui.attachmentNameInput.val().trim():this.model.get("name")},"_cancelEdit":function(){if(this.ui.attachmentDescriptionRO.hasClass("binf-hidden")){this.ui.attachmentErrorMsg.text(""),this.ui.attachmentErrorMsg.attr("title",""),this.ui.attachmentErrorMsg.addClass("binf-hidden"),this.$el.find("#workitem-attachments-name-input-"+this.model.attributes.id).removeClass("workitem-attachments-error-display"),this.ui.attachmentItem.removeClass("workitem-attachments-edit-error"),this.ui.attachmentDescriptionInput.addClass("binf-hidden"),this.ui.attachmentDescriptionCancel.addClass("binf-hidden"),this.model.get("description")?this.ui.attachmentDescriptionRO.removeClass("binf-hidden"):this.ui.attachmentEmptyDescriptionRO.removeClass("binf-hidden"),this.ui.attachmentName.removeClass("binf-hidden"),this.ui.attachmentNameInput.addClass("binf-hidden"),this.ui.attachmentNameCancel.addClass("binf-hidden"),this.ui.attachmentItem.removeClass("workitem-attachments-actions-display"),this.ui.attachmentItem.removeClass("workitem-attachments-description-edit");var e=this.model.get("name"),t=this.model.get("description");this.ui.attachmentName.text(e),this.ui.attachmentName.attr("title",e),this.ui.attachmentDescriptionRO.text(t),this.ui.attachmentDescriptionRO.attr("title",t),delete this._parent.editMode,this.triggerMethod("editmode:item",this),this._parent.errorCase=!1}},"isEditMode":function(){return!(!this._parent.editMode||this.model.get("id")!==this._parent.editMode)},"onRender":function(){if(this.iconView=new a({"node":this.model}),this.iconView.render(),this.ui.attachmentIcon.prepend(this.iconView.$el),this.model.get("description"))this.ui.attachmentDescriptionRO.removeClass("binf-hidden");else{var t=this.options.view.model.get("mapsList");(!t||1!==t.length)&&this.options.view.model.get("isDoc")||this.options.view.model.get("isWFStatusItemAttachment")||this.ui.attachmentEmptyDescriptionRO.removeClass("binf-hidden")}if(this.options.defaultActionController&&!this.options.defaultActionController.hasAction(this.model)){this.$el.find(".workitem-attachments-icon").addClass("workitem-attachment-inactive"),this.$el.find(".workitem-attachments-name").addClass("workitem-attachment-inactive")}if(this.model.isLocallyCreated&&this.model.collection.singleFileUpload&&e.delay(e.bind(function(){!0!==this.options.view.model.get("isAttachmentCentric")&&this._editDescription(),this.model.isLocallyCreated=void 0,this.model.collection.singleFileUpload=void 0},this),500),this.model.attributes)var i=this.model.get("mime_type");var n=i||this.model.get("type_name")||this.model.get("type");if(this.model.get("name")&&n){var o=e.str.sformat(d.linkTitleAria,this.model.get("name"),n);this.$el.find(".workitem-attachments-name").attr("aria-label",o)}},"_updateActionBarAndPrepareKeyboardAccess":function(){this.tableActionBarView.$el.find(".binf-dropdown-menu").addClass("binf-dropdown-menu-right"),this.tableActionBarView.$el.find(".binf-dropdown-toggle").addClass("workitem-expand-icon");var t=this;this._parent.inlineItemIndex=0,this._parent.inlineItemDropDownIndex=-1,this._parent.$inlineItems=this.$(".workitem-attachments-name");var i=this.$(".workitem-attachments-actions>div>ul>li>a.csui-toolitem");i.prop("tabindex","-1");var n=this.$(".workitem-attachments-actions .binf-dropdown-toggle");n.prop("tabindex","-1"),e.each(i,function(e){t._parent.$inlineItems.push(e)}),e.each(n,function(e){t._parent.$inlineItems.push(e)}),this._parent.inlineDropDownIsOpenSelector="li.binf-dropdown.binf-open";var o=this.$(".workitem-attachments-actions .binf-dropdown-menu a");o.prop("tabindex","-1"),this._parent.$inlineItemsDropDown=[],e.each(o,function(e){t._parent.$inlineItemsDropDown.push(e)}),t._parent.$inlineItemsDropDown=this.$(t._parent.$inlineItemsDropDown)},"_showActionBar":function(t){if(!(this.isEditMode()||this.$el.filter(".drag-over").length>0)){this._destroyActionBar(),this.defaultActionController&&this.defaultActionController.hasAction(this.model)?this.defaultActionController.commands.add(new c):this.defaultActionController.commands.remove([{"id":"OpenShortlink"}]),!0===this.options.view.model.get("isAttachmentCentric")&&(r.inlineActionbar.options.maxItemsShown=1),this.tableActionBarView=new l(e.extend({"context":this.options.context,"commands":this.defaultActionController.commands,"collection":r.inlineActionbar,"model":this.model,"container":this.options.container,"originatingView":this.options.view,"containerCollection":this.model.collection},r.inlineActionbar.options,{"inlineActionBarStyle":"csui-table-actionbar-bubble"})),this.tableActionBarView.actionState.set("state","full"),this.tableActionBarView.render(),this.tableActionBarView.triggerMethod("before:show"),this.tableActionBarView.triggerMethod("show");var i=this.$el.find(".workitem-attachments-actions");i.append(this.tableActionBarView.$el),i.addClass("workitem-attachments-actions-full"),this.tableActionBarView.triggerMethod("after:show"),this._updateActionBarAndPrepareKeyboardAccess()}},"openShortlink":function(){this._destroyActionBar(),this.triggerMethod("execute:defaultAction",this.model)},"_destroyActionBar":function(e){if(this.tableActionBarView){this.$el.removeClass("workitem-attachments-actions-full"),this.tableActionBarView.destroy(),this.tableActionBarView=null}},"onRenameMode":function(){var t=this.model.actions.findWhere({"signature":"Rename"}),i=this.model.actions.findWhere({"signature":"rename"});if(!(e.isUndefined(t)&&(e.isUndefined(i)||this._parent.errorCase)||this.ui.attachmentName.hasClass("binf-hidden"))){this.cancelPrevEdit(),this._destroyActionBar();var n=this.model.get("name");this.ui.attachmentNameInput.val(n),this.ui.attachmentName.addClass("binf-hidden"),this.ui.attachmentErrorMsg.addClass("binf-hidden"),this.ui.attachmentNameInput.removeClass("binf-hidden"),this.ui.attachmentItem.addClass("workitem-attachments-actions-display");var o=this.model.get("description");this.ui.attachmentDescriptionInput.val(o),this.model.get("description")?this.ui.attachmentDescriptionRO.addClass("binf-hidden"):this.ui.attachmentEmptyDescriptionRO.addClass("binf-hidden"),this.ui.attachmentDescriptionInput.removeClass("binf-hidden"),this.ui.attachmentNameCancel.removeClass("binf-hidden"),e.delay(e.bind(function(){this.ui.attachmentNameInput.trigger("focus")},this),700);var s=void 0!==n&&""!==n?n.length:0;n.lastIndexOf(".")>0&&n.lastIndexOf(".")<n.length-1&&(s=n.lastIndexOf(".")),document.getElementById("workitem-attachments-name-input-"+this.model.attributes.id).setSelectionRange(0,s),this._parent.editMode=this.model.get("id"),this.triggerMethod("editmode:item",this)}},"validateFileName":function(){var t,i=this,n=!0,o=d.MaxLengthReached,s=d.FileAlreadyExists;return i._parent.errorCase=!1,i.ui.attachmentName.hasClass("binf-hidden")&&i.ui.attachmentDescriptionRO.hasClass("binf-hidden")&&(t=i.ui.attachmentNameInput.val(),t.length>248?n=i.setErrorMessage(o):i.model.collection.forEach(function(o){t&&t!==i.model.get("name")&&t.toLowerCase()===o.attributes.name.toLowerCase()&&(s=e.str.sformat(s,t),n=i.setErrorMessage(s))})),n},"setErrorMessage":function(e){return this.$el.find("#workitem-attachments-name-input-"+this.model.attributes.id).addClass("workitem-attachments-error-display"),this.ui.attachmentItem.addClass("workitem-attachments-edit-error"),this.ui.attachmentErrorMsg.text(e),this.ui.attachmentErrorMsg.attr("title",e),this.ui.attachmentErrorMsg.hasClass("binf-hidden")&&this.ui.attachmentErrorMsg.removeClass("binf-hidden"),this._parent.errorCase=!0,!1},"cancelPrevEdit":function(){var t,i;if(this._parent.$el.find(".workitem-attachments-item.workitem-attachments-actions-display").length?t="workitem-attachments-actions-display":this._parent.$el.find(".workitem-attachments-item.workitem-attachments-description-edit").length&&(t="workitem-attachments-description-edit"),i=this._parent.$el.find("."+t),i.length){i.removeClass(t),i.find(".workitem-attachments-description-input").addClass("binf-hidden"),i.find(".edit-cancel").addClass("binf-hidden"),i.find(".workitem-attachment-name").removeClass("binf-hidden"),i.find(".workitem-attachments-name-input").addClass("binf-hidden"),i.find(".workitem-attachments-error-message").addClass("binf-hidden");var n,o,s=this,l=i.find(".workitem-attachment-name"),a=i.find("span.workitem-attachments-description-ro"),r=i.find("span.workitem-attachments-empty-description-ro");e.each(this._parent.collection.models,function(e){e.get("id")===s._parent.editMode&&(n=e.get("name"),o=e.get("description"),o?(i.find("span.workitem-attachments-description-ro").removeClass("binf-hidden"),a.text(o),a.attr("title",o)):(i.find("span.workitem-attachments-empty-description-ro").removeClass("binf-hidden"),r.text(d.DescriptionPlaceholder),r.attr("title",d.DescriptionPlaceholder)),l.text(n),l.attr("title",n),!0===s._parent.errorCase&&(s._parent.errorCase=!1,delete s._parent.editMode,i.find("#workitem-attachments-name-input-"+e.attributes.id).removeClass("workitem-attachments-error-display")))})}},"showWfPropertiesmetadataDropDownView":function(e){var t=e.attachmentNavigationView.mdv.metadataTabView.tabLinks,i=t&&t.collection.filter(function(e){return"workflow-properties"===e.get("name")});if(i&&i.length>0){var n=i[0],o=t.children._indexByModel[n.cid],s=t.children._views[o],l=n.collection.indexOf(n);if(s){s.$el.hasClass("binf-active")||(s.triggerMethod("clear:active:tab"),s.ui.link.binf_tab("show")),s._parent.options.activeTab&&s._parent.options.activeTab.set("tabIndex",l),s.triggerMethod("click:link"),s._parent.$el.removeClass("binf-open");s._parent.$el.find("button.binf-dropdown-toggle").attr("aria-expanded","false")}}}})}),csui.define("workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments.emptyDragAndDrop.view",["csui/lib/underscore","csui/lib/marionette","i18n!workflow/widgets/workitem/workitem.attachments/impl/nls/lang","css!workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments"],function(e,t,i){"use strict";return t.ItemView.extend({"template":"<div></div>","className":"workitem-attachments-emptylist","tagName":"li","constructor":function(){t.ItemView.prototype.constructor.apply(this,arguments)}})}),csui.define("hbs!workflow/widgets/workitem/workitem.attachments/impl/workitem.attachmentlist",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="workitem-dragdrop-area">\r\n  <div class="workitem-dragdrop-icon">\r\n    <p class="work-item-attachments-draganddrop">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"messages"):t)?l(s,"dragAndDropEmptyMsg"):s,t))+"</p>\r\n  </div>\r\n</div>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"messages"):t)?l(s,"isAssignment"):s,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":0},"end":{"line":7,"column":7}}}))?s:"")+'<div class="workitem-attachments-scrolling" tabindex="-1">\r\n  <ul class="workitem-attachments-itemlist">\r\n  </ul>\r\n</div>'}});return i.registerPartial("workflow_widgets_workitem_workitem.attachments_impl_workitem.attachmentlist",n),n}),csui.define("workflow/widgets/workitem/workitem.attachments/impl/workitem.attachmentlist.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/models/node/node.addable.type.collection","csui/utils/log","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/default.action/default.action.behavior","workflow/behaviors/list.keyboard.behavior","workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments.draganddrop.view","workflow/widgets/workitem/workitem.attachments/impl/workitem.attachmentitem.view","workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments.emptyDragAndDrop.view","hbs!workflow/widgets/workitem/workitem.attachments/impl/workitem.attachmentlist","i18n!workflow/widgets/workitem/workitem.attachments/impl/nls/lang","css!workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments"],function(e,t,i,n,o,s,l,a,r,c,u,d,p,m){"use strict";return i.CompositeView.extend({"childViewContainer":".workitem-attachments-itemlist","childView":u,"emptyView":d,"childViewOptions":function(){var e=this.options,t=e.view;return t.collection=this.collection,{"defaultActionController":this.defaultActionController,"context":e.context,"view":t,"container":e.container}},"childEvents":{"editmode:item":"onEditModeItem","click:item:brava":"onClickItemBrava"},"events":{"keydown":"onKeyDown"},"behaviors":{"DefaultAction":{"behaviorClass":a},"TabableRegion":{"behaviorClass":n},"ListKeyboard":{"behaviorClass":r,"currentlyFocusedElementSelector":".workitem-attachments-item"},"ScrollingInstructions":{"behaviorClass":l,"contentParent":".workitem-attachments-scrolling","suppressScrollX":!0,"scrollYMarginOffset":16}},"className":"workflow-attachmentlist-form","template":p,"ui":{"dragAndDropArea":"div.workitem-dragdrop-area"},"templateHelpers":function(){var e=!this.wfstatus;return{"messages":{"dragAndDropEmptyMsg":m.EmptyDragAndDropMessage,"isAssignment":e}}},"constructor":function(e){this.options=e,i.CompositeView.prototype.constructor.apply(this,arguments)},"onBeforeRenderEmpty":function(){this.ui.dragAndDropArea.addClass("workitem-dragdrop-area-empty")},"onBeforeRemoveEmpty":function(){this.ui.dragAndDropArea.removeClass("workitem-dragdrop-area-empty")},"onShow":function(){if(this._canApplyDragAndDrop()&&!this.dragNDrop&&this.setDragNDrop(),!0===this.options.view.model.get("isAttachmentCentric")){
var e=this.children.findByIndex(0);this.options.attachmentcentricview._showNode(e.model),this._setCssItemSelected(e.$el),this.setCurrentNextActiveAttachmentModels(e.model),e.model&&1===e.model.get("type")&&this.options.attachmentcentricview.mdn.trigger("load:item",e)}},"_canApplyDragAndDrop":function(){var e=this.options.view.model,t=e.get("mapsList");return!e.get("isDoc")||t&&1===t.length},"onAddChild":function(e){if(this.selectedIndex=0,this.trigger("refresh:tabindexes"),this._canApplyDragAndDrop()&&this._setDragNDropRow(e),!0===this.options.view.model.get("isAttachmentCentric")){if(0===this.$el.find("[data-workflow-active]").length){if(this.collection.length>0){var t=this.children.findByIndex(0);t.model&&t.model.isLocallyCreated&&this.collection.singleFileUpload&&this._showAttachmentMetadataBravaPreview(t)}}else this.setCurrentNextActiveAttachmentModels(this.currentActiveAttachmentModel)}},"onRemoveChild":function(){if(this.selectedIndex=0,this.trigger("refresh:tabindexes"),!0===this.options.view.model.get("isAttachmentCentric")){if(0===this.$el.find("[data-workflow-active]").length)if(this.collection.length>0){var e;e=this.nextAttachmentModel?this.children.findByModel(this.nextAttachmentModel):this.children.findByIndex(0),e&&this._showAttachmentMetadataBravaPreview(e)}else this.options.attachmentcentricview._emptyView(),this.options.attachmentcentricview.mdn.trigger("clear:item");else this.setCurrentNextActiveAttachmentModels(this.currentActiveAttachmentModel)}},"onEditModeItem":function(e){t.isFunction(e.isEditMode)&&!e.isEditMode()&&this.trigger("refresh:tabindexes")},"onClickItemBrava":function(t){if(!0===this.options.view.model.get("isAttachmentCentric")){var i=e(e(":active").length?":active":":hover"),n=e(i[i.length-1]),o=this.options.attachmentcentricview.mdv.model.get("id");t.model.get("id")===o||t.isEditMode()||n.hasClass("workitem-attachment-description")||n.hasClass("workitem-attachment-name")||n.hasClass("icon icon-toolbar-rename")||n.hasClass("icon")||n.hasClass("csui-toolitem csui-toolitem-textonly")||this._showAttachmentMetadataBravaPreview(t)}},"setCurrentNextActiveAttachmentModels":function(e){this.currentActiveAttachmentModel=e,this.nextAttachmentModel=this.collection.at(this.collection.indexOf(this.currentActiveAttachmentModel)+1)},"_showAttachmentMetadataBravaPreview":function(e){!0===this.options.view.model.get("isAttachmentCentric")&&this.options.attachmentcentricview&&(this.options.attachmentcentricview._showNode(e.model),this._setCssItemSelected(e.$el),this.options.attachmentcentricview.mdn.trigger("load:item",e),this.setCurrentNextActiveAttachmentModels(e.model),this.removeFullExpand())},"removeFullExpand":function(){var e=this.options.view.$el.find(".workitem-bravaview"),t=this.options.view.$el.find(".workitem-row-middle-section");e.length>0&&e.parent().length>0&&t.length>0&&(e.parent().show(),t.removeClass("fullexpand"))},"_setCssItemSelected":function(t){if(t instanceof e){t.siblings("[data-workflow-active]").removeClass("workitem-attachment-active").removeAttr("data-workflow-active").removeAttr("aria-current"),t.addClass("workitem-attachment-active").attr("data-workflow-active","").attr("aria-current","page")}},"_isDragNDropSupportedRow":function(e){return e&&0===e.get("type")},"_setDragNDropRow":function(e){var i=e&&e.model,n=this._isDragNDropSupportedRow(i),s=this.options.context,l=n?e.el:this,a=n?i:this.collection.node,r=n?l:this.ui.dragAndDropArea;this.addableTypes=new o(void 0,{"node":a}),this.addableTypes.fetch().done(t.bind(function(){n&&(l.dragNDrop=new c({"container":a,"collection":this.collection,"addableTypes":this.addableTypes,"context":s,"highlightedTarget":r,"originatingView":this,"isSupportedRowView":n,"hideDropMessage":!0}),this.listenTo(l.dragNDrop,"drag:over",this._addDragDropBorder,this),this.listenTo(l.dragNDrop,"drag:leave",this._removeDragDropBorder,this),l.dragNDrop.setDragParentView(this,e.el))},this))},"setDragNDrop":function(){this.addableTypes=new o(void 0,{"node":this.collection.node}),this.addableTypes.fetch().done(t.bind(function(){this.dragNDrop=new c({"container":this.collection.node,"collection":this.collection,"context":this.options.context,"addableTypes":this.addableTypes}),this.listenTo(this.dragNDrop,"drag:over",this._addDragDropBorder,this),this.listenTo(this.dragNDrop,"drag:leave",this._removeDragDropBorder,this),this.csuiDropMessage&&(this.csuiDropMessage.remove(),this.csuiDropMessage=void 0),this.dragNDrop.setDragParentView(this,this.ui.dragAndDropArea)},this))},"_addDragDropBorder":function(t,i){var n=i&&i.disabled?"addClass":"removeClass",o=i&&i.highlightedTarget?i.highlightedTarget:this.ui.dragAndDropArea;e(o).addClass("drag-over")[n]("csui-disabled")},"_removeDragDropBorder":function(t){var i=this.ui.dragAndDropArea;t&&t.highlightedTarget&&t.valid?e(t.highlightedTarget).removeClass("drag-over"):e(i).removeClass("drag-over")},"onDomRefresh":function(){this.collection.propertiesAction&&(i.CollectionView.prototype._renderChildren.call(this),this.collection.propertiesAction=!1,this.onShow())}})}),csui.define("workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments.addfromDesktop",["module","require","csui/lib/underscore","csui/lib/jquery","csui/utils/commands/add","csui/dialogs/file.open/file.open.dialog"],function(e,t,i,n,o,s){"use strict";return o.extend({"_selectFilesForUpload":function(e,t){var i=n.Deferred();return new s({"multiple":!0}).on("add:files",function(n){csui.require(["csui/controls/fileupload/fileupload"],function(o){i.resolve(),o.newUpload(e,t).addFilesToUpload(n,{"collection":e.collection}),1===n.length&&(e.collection.singleFileUpload=!0)})}).on("cancel",function(){i.reject()}).show(),i.promise()}})}),csui.define("workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments.addfromCS",["module","require","csui/lib/underscore","csui/lib/jquery","csui/utils/log","csui/utils/url","csui/models/command","csui/utils/commandhelper","csui/utils/command.error","i18n!workflow/widgets/workitem/workitem.attachments/impl/nls/lang"],function(e,t,i,n,o,s,l,a,r,c){"use strict";var u=e.config();i.defaults(u,{"parallelism":3});var d,p,m,h,f,w;return l.extend({"defaults":{"signature":"Add","name":c.CommandNameAdd,"verb":c.CommandVerbAdd,"doneVerb":c.CommandDoneVerbAdd,"pageLeavingWarning":c.AddPageLeavingWarning},"execute":function(e,t){var o=this,s=n.Deferred(),l=e.context||t&&t.context,a=e.collection;return e.suppressSuccessMessage=!0,csui.require(["csui/controls/globalmessage/globalmessage","csui/controls/conflict.resolver/conflict.resolver","csui/utils/taskqueue","csui/dialogs/node.picker/impl/header/apply.properties.selector/apply.properties.selector.view","csui/models/fileuploads","csui/utils/page.leaving.blocker"],function(){d=arguments[0],p=arguments[1],m=arguments[2],h=arguments[3],f=arguments[4],w=arguments[5],o._selectCopyOptions(e).done(function(t){var n=t.nodes,r=a.node,u=t.applyProperties;o._announceOperationStart(e.originatingView);var p=i.map(n,function(e){var t={"id":e.get("id"),"name":e.get("name"),"container":e.get("container"),"mime_type":e.get("mime_type"),"original_id":e.get("original_id"),"original":e.original,"type":e.get("type"),"size":e.get("size"),"type_name":e.get("type_name"),"state":"pending","count":0,"total":1,"enableCancel":!1};return 144===e.get("type")&&(t.size_formatted=e.get("size_formatted")),t}),m=i.map(p,function(e){return i.clone(e)});o._resolveNamingConflicts(r,m).done(function(n){i.each(n,function(e){void 0===e.id&&(e.id=i.findWhere(p,{"name":e.name}).id)}),o._metadataHandling(n,i.extend(t,{"context":l,"targetFolder":r})).done(function(){var t=new f(n),l=a.connector;o._copySelectedNodes(t,l,r,u,!0,e.collection).done(function(){d.hideFileUploadProgress();var e=1===n.length?c.MessageItemCopied:c.MessageItemsCopied;e=i.str.sformat(e,n.length),d.showMessage("success",e),s.resolve()}).always(function(){o._announceOperationEnd(e.originatingView,!0)}).fail(function(){s.reject()})}).fail(function(t){o._announceOperationEnd(e.originatingView,!0),s.reject(t)})}).fail(function(t){o._announceOperationEnd(e.originatingView,!0),s.reject(t)})})},function(e){s.reject(e)}),s.promise()},"_announceOperationStart":function(e){var t=e.resultsView||e.tableView;t&&t.blockActions(),w.enable(this.get("pageLeavingWarning"))},"_announceOperationEnd":function(e,t){w.disable();var i=e.resultsView||e.tableView;i&&(t&&i.collection.fetch(),i.unblockActions())},"_selectCopyOptions":function(e){var t=this,o=n.Deferred();return csui.require(["csui/dialogs/node.picker/node.picker"],function(n){var s=i.extend({"selectableTypes":e.validTypes,"showAllTypes":!0,"dialogTitle":c.AddDocumentLabel,"selectButtonLabel":c.ButtonLabelAdd,"initialContainer":e.container,"startLocation":"enterprise.volume","propertiesSeletor":!0,"globalSearch":!0,"startLocations":["enterprise.volume","current.location","personal.volume","favorites","recent.containers"]},e);t.nodePicker=new n(s),t.nodePicker.show().done(function(){o.resolve.apply(o,arguments)}).fail(function(){o.reject.apply(o,arguments)})},function(e){o.reject(e)}),o.promise()},"_resolveNamingConflicts":function(e,t){var n=1===t.length?c.CopyingNode:c.CopyingNodes;return new p({"h1Label":i.str.sformat(n,t.length),"actionBtnLabel":"Add","excludeAddVersion":!0,"container":e,"files":t}).run()},"_metadataHandling":function(e,t){var i=n.Deferred();return csui.require(["csui/widgets/metadata/metadata.copy.move.items.controller"],function(n){var o,s=t.openSelectedProperties,l=t.applyProperties,a=new n;if(s)o=a.CopyMoveItemsWithMetadata;else{if(l!==h.APPLY_DESTINATION_PROPERTIES&&l!==h.COMBINE_ALL_PROPERTIES)return i.resolve();o=a.CopyMoveItemsRequiredMetadata}l===h.KEEP_ORIGINAL_PROPERTIES?t.inheritance="original":l===h.APPLY_DESTINATION_PROPERTIES?t.inheritance="destination":l===h.COMBINE_ALL_PROPERTIES&&(t.inheritance="merged"),t.action="copy",o.call(a,e,t).done(function(){i.resolve()}).fail(function(e){i.reject(e)})},function(e){o.warn("Failed to load MetadataCopyMoveItemsController. {0}",e),i.reject(e)}),i.promise()},"_copySelectedNodes":function(e,t,o,s,l,a){var p=this,h=new m({"parallelism":u.parallelism}),f=i.map(e.models,function(i){var c=n.Deferred();return h.pending.add({"worker":function(){var n=i.attributes,u=o.get("id");return p._getCategories(n,t,u,s).done(function(o){p._copyNode(o,n,t,u,i.node).done(function(){i.set("count",1),i.deferred.resolve(i),l&&p._addToCurrentTable(i.node,a,e),c.resolve(n)}).fail(function(e){i.deferred.reject(i,new r(e)),c.reject()})}).fail(function(e){i.deferred.reject(i,new r(e)),c.reject()}),c.promise()}}),c.promise()});return d.showFileUploadProgress(e,{"oneFileTitle":c.AddingOneFile,"oneFileSuccess":c.AddOneFileSucceeded,"multiFileSuccess":c.AddFilesSucceeded,"oneFilePending":c.AddingOneFile,"multiFilePending":c.AddFiles,"oneFileFailure":c.AddFilesOneFailed,"multiFileFailure":c.AddFilesFailed,"oneFailure":c.AddFilesOneFailed,"enableCancel":!1}),n.whenAll.apply(n,f)},"_addToCurrentTable":function(e,t,i){e.isLocallyCreated=!0,1===i.length&&(t.singleFileUpload=!0),a.refreshModelAttributesFromServer(e,t).done(function(){e.original&&(e.attributes.original_id=0,e.original=void 0),t.unshift(e)})},"_copyNode":function(e,t,i,n,o){var s={"original_id":t.id,"parent_id":n,"name":t.newName?t.newName:t.name,"roles":e};return o.connector||i.assignTo(o),o.save(s,{"data":s,"url":i.connection.url+"/nodes"})},"_getCategories":function(e,t,i,o){var s=n.Deferred();if(e.extended_data&&e.extended_data.roles)s.resolve(e.extended_data.roles);else{var l="?id="+e.id+"&parent_id="+i,a={"url":t.connection.url+"/forms/nodes/copy"+l,"method":"get"};t.makeAjaxCall(a).then(function(e){var t,i=e.forms[1].data;t={},t[h.KEEP_ORIGINAL_PROPERTIES]="original",t[h.APPLY_DESTINATION_PROPERTIES]="destination",t[h.COMBINE_ALL_PROPERTIES]="merged";var n=i[t[o]];s.resolve({"categories":n})}).fail(function(e){s.reject(e)})}return s.promise()}})}),csui.define("workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments.addShortcut",["module","require","csui/lib/underscore","csui/lib/jquery","csui/models/command","csui/utils/commandhelper","csui/utils/command.error","csui/models/node/node.model","i18n!workflow/widgets/workitem/workitem.attachments/impl/nls/lang"],function(e,t,i,n,o,s,l,a,r){"use strict";var c=e.config();i.defaults(c,{"parallelism":3});var u,d,p,m,h,f;return o.extend({"defaults":{"signature":"Add","name":r.CommandNameAdd,"verb":r.CommandVerbAdd,"doneVerb":r.CommandDoneVerbAdd,"pageLeavingWarning":r.AddPageLeavingWarning},"execute":function(e,t){this.options=t;var o=this,s=n.Deferred(),l=e.collection;return e.suppressSuccessMessage=!0,csui.require(["csui/controls/globalmessage/globalmessage","csui/controls/conflict.resolver/conflict.resolver","csui/utils/taskqueue","csui/dialogs/node.picker/impl/header/apply.properties.selector/apply.properties.selector.view","csui/models/fileuploads","csui/utils/page.leaving.blocker"],function(){u=arguments[0],d=arguments[1],p=arguments[2],m=arguments[3],h=arguments[4],f=arguments[5],o._selectShortCutCreateOptions(e).done(function(t){var n=t.nodes,a=l.node,c=t.applyProperties;o._announceOperationStart(e.originatingView);var d=i.map(n,function(e){return{"id":e.get("id"),"name":e.get("name"),"container":e.get("container"),"mime_type":e.get("mime_type"),"original_id":e.get("original_id"),"original_id_expand":e.get("original_id_expand"),"type":e.get("type"),"size":e.get("size"),"type_name":e.get("type_name"),"state":"pending","count":0,"total":1,"enableCancel":!1}}),p=i.map(d,function(e){return i.clone(e)});o._resolveNamingConflicts(a,p).done(function(t){i.each(t,function(e){e.type=i.findWhere(d,{"name":e.name}).type});var n=new h(t),p=l.connector;o._createSelectedNodes(n,p,a,c,!0,e.collection).done(function(){u.hideFileUploadProgress();var e=1===t.length?r.MessageItemAdded:r.MessageItemsAdded;e=i.str.sformat(e,t.length),u.showMessage("success",e),s.resolve()}).always(function(){o._announceOperationEnd(e.originatingView,!0)}).fail(function(){s.reject()})}).fail(function(t){o._announceOperationEnd(e.originatingView,!0),s.reject(t)})})},function(e){s.reject(e)}),s.promise()},"_announceOperationStart":function(e){var t=e.resultsView||e.tableView;t&&t.blockActions(),f.enable(this.get("pageLeavingWarning"))},"_announceOperationEnd":function(e,t){f.disable();var i=e.resultsView||e.tableView;i&&(t&&i.collection.fetch(),i.unblockActions())},"_selectShortCutCreateOptions":function(e){var t=this,o=n.Deferred();return csui.require(["csui/dialogs/node.picker/node.picker"],function(n){var s=i.extend({"showAllTypes":!0,"dialogTitle":r.AddDocumentLabel,"selectButtonLabel":r.ButtonLabelAdd,"initialContainer":e.container,"startLocation":"enterprise.volume","propertiesSeletor":!0,"globalSearch":!0,"startLocations":["enterprise.volume","current.location","personal.volume","favorites","recent.containers"]},e);t.nodePicker=new n(s),t.nodePicker.show().then(function(n){var o=[];return i.each(n.nodes,function(i){var n=new a({"type":t.options.type,"icon":i.get("icon"),"type_name":t.options.type_name,"container":!1,"name":i.get("name"),"original_id":i.get("id"),"original_id_expand":i.attributes},{"connector":e.container.connector});o.push(n)}),n.nodes=o,n}).done(function(){o.resolve.apply(o,arguments)}).fail(function(){o.reject.apply(o,arguments)})},function(e){o.reject(e)}),o.promise()},"_resolveNamingConflicts":function(e,t){var n=1===t.length?r.AddingNode:r.AddingNodes;return new d({"h1Label":i.str.sformat(n,t.length),"actionBtnLabel":"Add","excludeAddVersion":!0,"container":e,"files":t}).run()},"_createSelectedNodes":function(e,t,o,s,a,d){var m=this,h=new p({"parallelism":c.parallelism}),f=i.map(e.models,function(i){var r=n.Deferred();return h.pending.add({"worker":function(){var n=i.attributes,c=o.get("id");return m._getCategories(n,t,c,s).done(function(o){m._createNode(o,n,t,c,i.node).done(function(){i.set("count",1),i.deferred.resolve(i),a&&m._addToCurrentTable(i.node,d,e),r.resolve(n)}).fail(function(e){i.deferred.reject(i,new l(e)),r.reject()})}).fail(function(e){i.deferred.reject(i,new l(e)),r.reject()}),r.promise()}}),r.promise()});return u.showFileUploadProgress(e,{"oneFileTitle":r.AddingOneFile,"oneFileSuccess":r.AddOneFileSucceeded,"multiFileSuccess":r.AddFilesSucceeded,"oneFilePending":r.AddingOneFile,"multiFilePending":r.AddFiles,"oneFileFailure":r.AddFilesOneFailed,"multiFileFailure":r.AddFilesFailed,"oneFailure":r.AddFilesOneFailed,"enableCancel":!1}),n.whenAll.apply(n,f)},"_addToCurrentTable":function(e,t,i){e.isLocallyCreated=!0,1===i.length&&(t.singleFileUpload=!0),s.refreshModelAttributesFromServer(e,t).done(function(){t.unshift(e)})},"_createNode":function(e,t,i,n,o){var s={"original_id":t.original_id,"parent_id":n,"name":t.newName?t.newName:t.name,"roles":e,"action":"create","type":t.type,"original_id_expand":t.original_id_expand};return o.connector||i.assignTo(o),o.save(s,{"data":s,"url":i.connection.url+"/nodes"})},"_getCategories":function(e,t,i,o){var s=n.Deferred();if(e.extended_data&&e.extended_data.roles)s.resolve(e.extended_data.roles);else{var l="?type="+e.type+"&parent_id="+i,a={"url":t.connection.url+"/forms/nodes/create"+l,"method":"get"};t.makeAjaxCall(a).then(function(e){var t,i=e.forms[0].data;t={},t[m.KEEP_ORIGINAL_PROPERTIES]="original",t[m.APPLY_DESTINATION_PROPERTIES]="destination",t[m.COMBINE_ALL_PROPERTIES]="merged";var n=i[t[o]];s.resolve({"categories":n})}).fail(function(e){s.reject(e)})}return s.promise()}})}),csui.define("hbs!workflow/widgets/workitem/workitem.attachments/impl/workitem.attachmenttoolbar",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="workitem-attachment-toolbar-view tile-nav">\r\n  <div class="workitem-attachment-toolbar-add"></div>\r\n</div>\r\n'}});return i.registerPartial("workflow_widgets_workitem_workitem.attachments_impl_workitem.attachmenttoolbar",n),n}),csui.define("workflow/widgets/workitem/workitem.attachments/impl/workitem.attachmenttoolbar.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/controls/globalmessage/globalmessage","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/toolbar/toolbar.view","workflow/widgets/workitem/workitem.attachments/workitem.attachments.toolbaritems","workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments.addfromDesktop","workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments.addfromCS","workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments.addShortcut","hbs!workflow/widgets/workitem/workitem.attachments/impl/workitem.attachmenttoolbar","i18n!workflow/widgets/workitem/workitem.attachments/impl/nls/lang","css!workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments"],function(e,t,i,n,o,s,l,a,r,c,u,d,p,m){"use strict";var h=i.LayoutView.extend({"template":p,"regions":{"addToolbarRegion":".workitem-attachment-toolbar-add"},"behaviors":{"TabableRegion":{"behaviorClass":s}},"toolbarItemSelector":"a."+s.accessibilityFocusableClass,"events":{"keydown":"onKeyInView"},"currentlyFocusedElement":function(){var t=this.$(this.toolbarItemSelector);return t.length?e(t[this.accNthToolbarItemFocused]):null},"constructor":function(e){e||(e={}),this.context=e.context,this.toolbarCollection=e.toolbarCollection,this.originatingView=e.originatingView,this.addableTypes=e.addableTypes,this.container=e.container,this.attachmentCollection=e.attachmentCollection,this.accNthToolbarItemFocused=0,i.LayoutView.prototype.constructor.apply(this,arguments)},"initialize":function(){this.toolbarView=new a({"collection":this.toolbarCollection,"maxItemsShown":0,"dropDownText":m.AddToolbarItemLabel,"dropDownIcon":"icon icon-toolbarAdd"}),this.addFromCSCommand=new u,this.addFromFileSysCommand=new c,this.addShortCutCommand=new d,this.listenTo(this.toolbarView,"childview:toolitem:action",this._toolbarItemClicked),this.propagateEventsToRegions()},"onRender":function(){this.addToolbarRegion.show(this.toolbarView)},"_closeMenu":function(e,t){var i=this.$el.find("li.binf-dropdown.binf-open");if(i.length>0){var n=this.$el.find("li.binf-dropdown.binf-open > a");i.removeClass("binf-open"),n.attr("aria-expanded","false"),t&&(e.preventDefault(),e.stopPropagation())}},"onKeyInView":function(e){switch(e.keyCode){case 27:this._closeMenu(e,!0);break;case 9:this._closeMenu(e,!1)}},"_toolbarItemClicked":function(e){switch(e.model.get("id")){case"copy":var t=this.addableTypes.map(function(e){return e.get("type")});this.addFromCSCommand.execute({"originatingView":this.originatingView,"context":this.context,"container":this.container,"collection":this.attachmentCollection,"validTypes":t});break;case"filesystem":var i={"originatingView":this.originatingView,"context":this.context,"container":this.container,"collection":this.attachmentCollection,"data":this.addableTypes},n={"context":this.context,"addableType":e.model.get("type"),"addableTypeName":e.model.get("name")};this.addFromFileSysCommand.execute(i,n);break;case"shortcut":this.addShortCutCommand.execute({"originatingView":this.originatingView,"context":this.context,"container":this.container,"collection":this.attachmentCollection},{"type":1,"type_name":"shortcut"});break;default:o.showMessage("warning","not implemented")}}});return t.extend(h.prototype,l),h}),csui.define("hbs!workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="workitem-attachment-toolbar"></div>\r\n<div class="workitem-attachment-list"></div>'}});return i.registerPartial("workflow_widgets_workitem_workitem.attachments_impl_workitem.attachments",n),n}),csui.define("workflow/widgets/workitem/workitem.attachments/workitem.attachments.view",["csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","csui/lib/jquery","csui/dialogs/modal.alert/modal.alert","csui/utils/log","csui/models/nodechildren","csui/models/node.children2/node.children2","csui/models/node/node.addable.type.collection","csui/controls/progressblocker/blocker","csui/controls/globalmessage/globalmessage","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/toolbar/toolitem.model","workflow/widgets/workitem/workitem.attachments/impl/workitem.attachmentlist.view","workflow/widgets/workitem/workitem.attachments/impl/workitem.attachmenttoolbar.view","hbs!workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments","i18n!workflow/widgets/workitem/workitem.attachments/impl/nls/lang","css!workflow/widgets/workitem/workitem.attachments/impl/workitem.attachments"],function(e,t,i,n,o,s,l,a,r,c,u,d,p,m,h,f,w,g){"use strict";var b=t.LayoutView.extend({"className":"workitem-attachments","template":w,"regions":{"toolbar":".workitem-attachment-toolbar","list":".workitem-attachment-list"},"constructor":function(e){e||(e={}),this.context=e.context,t.LayoutView.prototype.constructor.apply(this,arguments)},"_prepareAttachmentActions":function(){var t=n.Deferred();return this.toolbarCollection=new i.Collection,this.addableTypes=new r(void 0,{"node":this.model}),this.addableTypes.fetch().done(e.bind(function(){var e,t,i;this.addableTypes.forEach(function(n){switch(n.get("type")){case 1:e=new m({"name":g.AddShortcutLabel,"id":"shortcut"}),e.status={};break;case 144:i=new m({"name":g.AddFromDesktopLabel,"id":"filesystem","type":n.get("type")}),i.status={};break;default:t||(t=new m({"name":g.AddFromContentServerLabel,"id":"copy"}),t.status={})}}),i&&this.toolbarCollection.add(i),t&&this.toolbarCollection.add(t),e&&this.toolbarCollection.add(e)},this)).always(function(){t.resolve()}),t.promise()},"initialize":function(){this.options.blockingParentView?c.delegate(this,this.options.blockingParentView):c.imbue(this),this.blockActions();var t=this.options.view.model.get("mapsList");if(!0!==this.options.view.model.get("isDoc")||t&&1===t.length)this._prepareAttachmentActions().done(e.bind(function(){var t=this.model;if(this.toolbar){this.attachmentCollection=this.options.attachmentCollection?this.options.attachmentCollection:new a(void 0,e.defaults({"autoreset":!0,"includeActions":!1,"delayRestCommands":!0,"fields":{"properties":[],"versions.element(0)":["owner_id"]},"expand":{"properties":["node","original_id"]},"commands":["openshortlink","download","properties","rename","delete","default","addcategory","open","edit","addversion","copy","move"]},{"node":t})),this.toolbarView=new f({"context":this.context,"originatingView":this,"toolbarCollection":this.toolbarCollection,"addableTypes":this.addableTypes,"container":this.model,"attachmentCollection":this.attachmentCollection}),this.toolbar.show(this.toolbarView),this.toolbarCollection.length<=0&&this.toolbar.$el.addClass("binf-hidden");var i=this.options.view.model.get("docModels"),s=this.options.view.model.get("isNewDraft");if(i&&s){var l=[],r=0,c=this,u=[];e.each(i,function(e){var t=e.attributes,i={"original_id":t.original_id,"parent_id":c.model.get("id"),"name":t.newName?t.newName:t.name,"action":"create","type":t.type,"original_id_expand":t.original_id_expand},n={"name":i.name,"promise":e.save(i,{"data":i,"url":c.model.connector.connection.url+"/nodes"})};l.push(n)}),e.each(l,function(t){t.promise.fail(e.bind(function(e){u.push(" "+t.name)},c)).always(e.bind(function(t){if(r===i.length-1)if(0===u.length)c.showAttachments();else{this.unblockActions();var n=g.AttachmentsFailMessageTitle,s=e.str.sformat(g.AttachmentsFailMessage,u),l=o.showError(s,n);l.always(function(){c.options.view.parentView._navigateToDocParentNode()})}r++},c))})}else this.showAttachments();n("<input>").attr({"type":"hidden","id":"attachmentFolderId","name":"attachmentFolderId","value":this.model.get("id")}).appendTo(".workitem-view"),this.attachments=new h({"context":this.context,"container":this.model,"collection":this.attachmentCollection,"view":this.options.view,"attachmentcentricview":this.options.attachmentcentricview}),this.propagateEventsToRegions()}},this));else{var i=this.options.view.model.get("docModels");i&&(this.attachmentCollection=new l(i,{}),this.attachments=new h({"context":this.context,"collection":this.attachmentCollection,"view":this.options.view,"attachmentcentricview":this.options.attachmentcentricview}),this.attachments.render())}},"showAttachments":function(){var t=this.options.view.model.get("isDoc")||this.options.view.model.get("isDocDraft");!0===this.attachmentCollection.fetched&&void 0===t?(this.attachments=this.attachments?this.attachments:new h({"context":this.context,"container":this.model,"collection":this.attachmentCollection,"view":this.options.view,"attachmentcentricview":this.options.attachmentcentricview}),this.list.show(this.attachments),this.unblockActions()):this.attachmentCollection.fetch().done(e.bind(function(){this.attachmentCollection.length>0?this.attachmentCollection.delayedActions.fetch().done(e.bind(function(){this.list&&this.list.show(this.attachments)},this)):this.toolbarCollection.length>0&&this.list.show(this.attachments)},this)).fail(e.bind(function(){u.showMessage("error",g.ErrorMessageLoadAttachments)},this)).always(e.bind(function(){this.unblockActions()},this))}});return e.extend(b.prototype,d),b}),csui.define("workflow/widgets/workitem/workitem.attachments/workitem.attachments.controller",["csui/lib/underscore","csui/lib/jquery","csui/utils/log","csui/utils/contexts/factories/node","csui/behaviors/default.action/impl/defaultaction","workflow/utils/workitem.extension.controller","workflow/widgets/workitem/workitem.attachments/workitem.attachments.view","i18n!workflow/widgets/workitem/workitem.attachments/impl/nls/lang"],function(e,t,i,n,o,s,l,a){"use strict";return s.extend({"type":1,"sub_type":1,"position":1,"constructor":function(e,t){s.prototype.constructor.apply(this,arguments),t||(t={}),this.context=e.context},"validate":function(e,t){return e===this.type&&t===this.sub_type},"execute":function(i){var r=i.extensionPoint,c=i.data,u=i.parentView,d=t.Deferred();if(r===s.ExtensionPoints.AddSidebar){var p=new o,m=this.context.getModel(n,{"attributes":{"id":c.attachment_folder_id},"options":{"defaultActionCommands":p.actionItems.getAllCommandSignatures(p.commands),"delayRestCommands":!0}});return m.fetch().done(e.bind(function(e){e.title=a.TabTitle,e.position=this.position,e.viewToRender=l,e.viewToRenderOptions={"context":this.context,"model":m,"view":u},d.resolve(e)},this)).fail(e.bind(function(e){e.errorMsg=a.ErrorMessageLoadAttachments,d.reject(e)},this)),d.promise()}return d.resolve({}),d.promise()}})}),csui.define("hbs!workflow/controls/popover/impl/popover",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"isGroup"):t,{"name":"if","hash":{},"fn":e.program(2,o,0),"inverse":e.noop,"loc":{"start":{"line":2,"column":2},"end":{"line":16,"column":9}}}))?s:""},"2":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="wfstatus-usercard-list-header">\r\n      <div class="wfstatus-usercard-popover-header-labels">\r\n        <div class="wfstatus-usercard-popover-header-group-label"\r\n             title="'+e.escapeExpression((s=null!=(s=l(i,"groupName")||(null!=t?l(t,"groupName"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"groupName","hash":{},"loc":{"start":{"line":6,"column":20},"end":{"line":6,"column":33}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"groupName")||(null!=t?l(t,"groupName"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"groupName","hash":{},"loc":{"start":{"line":6,"column":35},"end":{"line":6,"column":48}}}):s))+'</div>\r\n        <div class="wfstatus-usercard-popover-header-group-status"\r\n             title="'+e.escapeExpression((s=null!=(s=l(i,"status")||(null!=t?l(t,"status"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"status","hash":{},"loc":{"start":{"line":8,"column":20},"end":{"line":8,"column":30}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"status")||(null!=t?l(t,"status"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"status","hash":{},"loc":{"start":{"line":8,"column":32},"end":{"line":8,"column":42}}}):s))+'</div>\r\n      </div>\r\n      <input class="search wfstatus-user-input" type="search" title="Search by Group User"\r\n             style="display: none">\r\n      <div\r\n          class="cs-search-icon icon icon-search csui-acc-focusable-active wfstatus-user-search-icon"\r\n          title="Search by Group User"></div>\r\n    </div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"listViewMulCurrentSteps"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":0},"end":{"line":17,"column":7}}}))?s:"")+'<div class="popover wfstatus-popover-scrolling wfstatus-popover-content large"></div>\r\n'}});return i.registerPartial("workflow_controls_popover_impl_popover",n),n}),csui.define("css!workflow/controls/popover/impl/popover",[],function(){}),
csui.define("workflow/controls/popover/popover.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/tile/behaviors/perfect.scrolling.behavior","hbs!workflow/controls/popover/impl/popover","css!workflow/controls/popover/impl/popover"],function(e,t,i,n,o,s,l){"use strict";function a(i){e("workflow/utils/workitem.util").unbindPopover(i);var n=c(i);if(u(i),i.cardViewOptions.listViewMulCurrentSteps){var o=i.cardViewOptions;n.listViewMulCurrentSteps=o.listViewMulCurrentSteps,o.popoverCardsListView.makeDefaultStepCardActive(),t(".wfstatus-stepcard").addClass("wfstatus-list-current-step")}n.popoverView.userPopoverOptions=n.popoverView.setPopoverSize(n),p(n)}function r(){t(window).off("resize.onPopOver"),t(window).off("popstate.onPopOver"),t(window).off("hashchange.onPopOver"),t(".wfstatus-table tbody").off("scroll"),t(".binf-modal-backdrop").off("keydown click"),t(".binf-modal-header").off("keydown click")}function c(e){var n,s,l,a,r={},c=i.uniqueId(3),u=t.fn.binf_modal.getDefaultContainer();n=document.createElement("div"),n.id="wfstatus-popover_"+c,a="#wfstatus-popover_"+c,n.setAttribute("class","wfstatus-popover"),s=document.createElement("div"),s.className="wfstatus-popover-arrow",s.id="wfstatus-popover-pointer_"+c,l=document.createElement("div"),l.id="wfstatus-popover-mask_"+c,t(e.delegateTarget).css("overflow","hidden"),r.widgetDialog=n,r.widgetDialogPointer=s,r.widgetDialogMask=l,r.placeholder=e.delegateTarget,r.widgetBaseElement=e.delegateTarget,r.container=1===t(u).find(".wfstatus-model-content").length?t(u).find(".wfstatus-model-content"):t(".binf-modal-content").last(),t(u).append(l).append(n).append(s);var d=new o.Region({"el":a}),p=new m(e.cardViewOptions);return d.show(p),r.userPopoverOptions=p.userPopoverOptions,r.popoverView=p,t(a).css({"display":"block"}).animate({"opacity":1}),r}function u(i){var n=e("workflow/utils/workitem.util");t(".binf-modal-header").on("keydown click",{"callbackFun":n.unbindPopover,"popoverOptions":i},d),t(".binf-modal-backdrop").on("keydown click",{"callbackFun":n.unbindPopover,"popoverOptions":i},d),t(window).on("resize.onPopOver",function(){n.unbindPopover(i)}),t(window).on("popstate.onPopOver",function(){n.unbindPopover(i)}),t(window).on("hashchange.onPopOver",function(){n.unbindPopover(i)}),t(".wfstatus-table tbody").on("scroll",function(){n.unbindPopover(i)}),t(document).off("focusin.binf.modal")}function d(e){function i(){if(s){var e=s.popoverOptions;"keydown"===o.type&&t(e).on("keyup",function(i){t(e).is(":focus")&&(t(e).off("keyup"),i.stopPropagation())}),e&&(e.trigger("focus"),setTimeout(function(){e.trigger("focus")},1))}}var n=!1,o=e||window.event,s=o.data.popoverOptions;"popstate"===o.type||"hashchange"===o.type?n=!0:"keyup"===o.type||"keydown"===o.type?27!==o.keyCode&&27!==o.which||(t(".wfstatus-popover").is(":visible")&&t(".cs-dialog").is(":visible")&&(n=!0),i()):"resize"===o.type?(t(".wfstatus-popover").is(":visible")&&t(".cs-dialog").is(":visible")&&(n=!0),i()):t(o.target).closest(".wfstatus-popover").length||"click"!==o.type||t(o.target).closest("[id*=wfstatus-popover]").length&&!t(o.target).closest("[id*=wfstatus-popover-mask_]").length||t(o.target).closest("[class*=ui-autocomplete]").length||(n=!0),s.cardViewOptions.stepCardsListView&&(s.cardViewOptions.stepCardsListView.options.listViewMulCurrentSteps=!1),n&&o.data.callbackFun(s)}function p(e){var i,n,o,s,l,a,r,c,u,d,p=t(e.widgetDialog),m=t(e.widgetDialogPointer),h=t(e.widgetBaseElement),f=!1,w=e.container,g=t(".wfstatus-popover-content");if(e.widgetBaseElement=0===t(e.widgetBaseElement).width()?t("[data-value="+t(e.widgetBaseElement).attr("data-value")+"]"):e.widgetBaseElement,p.css({"position":"absolute","left":"0","top":"0"}),m.css({"position":"absolute","left":"0","top":"0"}).addClass("wfstatus-popover-arrow-left"),e.listViewMulCurrentSteps)i="center top",n="center bottom";else{i="left top";n="left+"+parseInt(h.outerWidth()+10,10)+" top -"+h.parent().height()/2}p.position({"my":i,"at":n,"of":e.widgetBaseElement,"collision":"flipfit flipfit"}),o=p.offset().left,s=p.offset().top,u=s+p.height(),l=o+p.width(),a=h.offset().left,r=h.offset().top,d=r+h.height();var b=w.offset().top,v=w.offset().top+w.height();if(c=h.parent().height()===h.height(),c&&(r=h.offset().top+Math.ceil(h.height()/4)+2),e.listViewMulCurrentSteps){var k=a+h.width()/2;if(s>r)p.css("top",d),d=h.offset().top+h.height(),g.css("max-height",v-d),m.css({"position":"absolute","left":k,"top":d-10}),m.removeClass("wfstatus-popover-arrow-left").addClass("wfstatus-popover-arrow-up"),f=parseInt(t(m).css("left").replace("px",""),10)+1>h.offset().left;else{var y=!1;s<b?(p.css("top",b),g.css("max-height",h.offset().top-b)):s+p.height()>v&&(p.css("top",d),d=h.offset().top+h.height(),g.css("max-height",v-d),m.css({"position":"absolute","left":k,"top":d/2-1}),m.removeClass("wfstatus-popover-arrow-right").addClass("wfstatus-popover-arrow-up"),y=!0),y||(m.css({"position":"absolute","left":k,"top":h.offset().top-1}),m.removeClass("wfstatus-popover-arrow-right").addClass("wfstatus-popover-arrow-down"))}}else{o<a?(m.css({"position":"absolute","left":l,"top":r+10}),m.removeClass("wfstatus-popover-arrow-left").addClass("wfstatus-popover-arrow-right"),f=parseInt(t(m).css("left").replace("px",""),10)+1>h.offset().left):(m.css({"position":"absolute","left":o-10,"top":r+10}),m.removeClass("wfstatus-popover-arrow-right").addClass("wfstatus-popover-arrow-left"),f=parseInt(t(m).css("left").replace("px",""),10)+1<h.offset().left+h.width());var x=e.popoverView.userPopoverOptions,C=x.userPopoverSize;if(w.height()>C?p.css("max-height",C):p.css("max-height",w.height()),u=s+p.height(),2===x.assigneesLength?(s<r||s>b)&&p.css("top",d-C):1===x.assigneesLength&&u<d&&p.css("top",s+(d-u)),s=p.offset().top,s<b&&p.css("top",s+(b-s)),s=p.offset().top,(u=s+p.height())>v){p.css("top",s-(u-v));var _=m.offset().top;_+22>v&&m.css("top",_-(_+22-v))}e.listViewMulCurrentSteps||(f?(p.css({"left":t(window).width()/2-p.width()/2}),m.css({"opacity":"0"})):m.css({"opacity":"1"}))}}var m=o.LayoutView.extend({"className":"wfstatus-popover-class","template":l,"tagName":"div","constructor":function(e){e=e||{},this.cardListView=e.popoverCardsListView,o.LayoutView.prototype.constructor.call(this,e)},"regions":{"popover":".wfstatus-popover-content"},"events":{"click .wfstatus-user-search-icon":"toggleSearchInput","keyup .wfstatus-user-input":"searchUser"},"ui":{"wfstatusUserInput":".wfstatus-user-input"},"behaviors":{"PerfectScrolling":{"behaviorClass":s,"contentParent":".wfstatus-popover-scrolling","scrollXMarginOffset":30,"suppressScrollX":!0,"scrollYMarginOffset":15}},"templateHelpers":function(){var t=e("workflow/utils/workitem.util"),i=this.model.get("assignedto")?this.model.get("assignedto"):this.model.get("task_assignees")?this.model.get("task_assignees").assignedto:void 0,n=void 0!==i,o=null===this.model.get("task_due_date")?"":this.model.get("task_due_date"),s=null===this.model.get("task_status")?"":this.model.get("task_status"),l={"dueDate":o,"status":s},a=t.formatStatus(l);return{"groupName":!0===n?i.groupName:"","isGroup":n,"status":a.status,"listViewMulCurrentSteps":!(this.cardListView&&this.cardListView.options.listViewMulCurrentSteps)}},"onRender":function(){this.popover.show(this.cardListView)},"searchUser":function(e){var t,n=e.currentTarget.value,o=this.cardListView.completeCollection;if(n&&n.length>0){var s=n.toLowerCase().split(" ");t=o.filter(function(e){var t=e.get("name"),n=e.get("first_name"),o=e.get("last_name");return t=t?t.trim().toLowerCase():"",n=n?n.trim().toLowerCase():"",o=o?o.trim().toLowerCase():"",i.reduce(s,function(e,i){return e&&(t.indexOf(i)>=0||n.indexOf(i)>=0||o.indexOf(i)>=0)},!0)})}else t=this.cardListView.completeCollection.models;this.cardListView.Usercollection.reset(t)},"toggleSearchInput":function(){this.ui.wfstatusUserInput.hasClass("binf-active")?(t(".wfstatus-user-input").hide(),t(".wfstatus-usercard-popover-header-labels").show(),this.ui.wfstatusUserInput.removeClass("binf-active")):(t(".wfstatus-user-input").show(),t(".wfstatus-usercard-popover-header-labels").hide(),this.ui.wfstatusUserInput.addClass("binf-active"))},"setPopoverSize":function(e){var i={},n=this.$el.find(".wfstatus-popover-content.popover"),o=t(e.widgetDialog);if(this.cardListView&&this.cardListView.options.listViewMulCurrentSteps)switch(this.model.get("parallel_steps").length){case 1:n.addClass("wfstatus-list-step-card-size-single");break;case 2:n.addClass("wfstatus-list-step-card-size-double");break;case 3:n.addClass("wfstatus-list-step-card-size-triple");break;default:n.addClass("wfstatus-list-step-card-size-large")}else{var s=!(!this.model.get("task_assignees")||!this.model.get("task_assignees").assignedto)||!!this.model.get("assignedto"),l=this,a={};if(s){var r=this.model,c=r.get("assignedto")&&r.get("assignedto").assignees?r.get("assignedto").assignees:r.get("task_assignees").assignees;c.length<3&&(a.popoverContentEle=n,a.popoverView=l,a.assignees=c,a=l.getGroupPopoverHeightOptions(a))}else n.addClass("small"),a.model=this.model,a.popoverView=l,a=l.getSingleUserPopoverHeightFactor(a);var u=a&&a.factor?a.factor:1;i.assigneesLength=a&&a.assigneesLength?a.assigneesLength:0,i.userPopoverSize=o.height()/u}return i},"getUsercardDeatilsCount":function(e){var t=0,i=0,n={};return e.emailAddress&&""!==e.emailAddress&&(i+=1),e.phone&&""!==e.phone&&(t+=1),n.phoneCount=t,n.emailCount=i,n},"getGroupPopoverHeightOptions":function(e){var t,n,o,s=0,l=0,a={},r=e.popoverContentEle,c=e.popoverView,u=e.assignees;if(u)switch(u.length){case 1:o=u[0],n=c.getUsercardDeatilsCount(o),s=n.phoneCount,l=n.emailCount,r.addClass("small"),t=1===s&&1===l?1.022652428091991:1===s?1.130653266331658:1===l?1.142063636363636:1.286165534883721,a.assigneesLength=1;break;case 2:i.each(u,function(e){n=c.getUsercardDeatilsCount(e),s+=n.phoneCount,l+=n.emailCount}),t=2===l&&2===s?1.050982178217822:1===l&&2===s?1.109999058047493:2===l&&1===s?1.115023871721592:1===l&&1===s?1.185727272727273:2===l?1.192028571428571:1===l?1.272123846153846:2===s?1.178691694915254:1===s?1.266257668711656:1.362422006688963,a.assigneesLength=u.length}return a.factor=t,a},"getSingleUserPopoverHeightFactor":function(e){var t,i=e.model,n=e.popoverView,o=i.get("task_assignees")?i.get("task_assignees"):i.get("parallel_steps")[0].task_assignees,s=o.assignee[0],l=n.getUsercardDeatilsCount(s),a=l.phoneCount,r=l.emailCount;return t=1===a&&1===r?1.031887005649718:1===a?1.175157894736842:1===r?1.19411666666667:1.3965,{"factor":t,"assigneesLength":1}}});return{"ShowPopOver":a,"UnbindPopoverEvents":r}}),csui.define("workflow/controls/userpicker/userpicker.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/userpicker/userpicker.view"],function(e,t,i,n,o){"use strict";return o.extend({"events":{"change @ui.searchbox":"onChange"},"behaviors":{"TabableRegion":{"behaviorClass":n}},"constructor":function(e){o.prototype.constructor.call(this,e),this.listenTo(this,"item:change",this.onItemChanged)},"currentlyFocusedElement":function(){return t(this.ui.searchbox)},"onChange":function(e){var t=this.model?this.model.get("name_formatted"):"";(""===this.ui.searchbox.val()&&t||t&&t!==this.ui.searchbox.val()&&(this.collection&&0===this.collection.length||0===this.$el.find("ul.typeahead.binf-dropdown-menu li.binf-active").length))&&(this.ui.searchbox.val(""),this.triggerMethod("item:remove"))},"onItemChanged":function(e){this.model=e.item}})}),csui.define("hbs!workflow/widgets/action/action.body/impl/action.body",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){return'  \x3c!-- Authenticate Area --\x3e\r\n  <div class="workitem-action-authenticate">\r\n    \x3c!--Here renders the authentication control--\x3e\r\n  </div>\r\n'},"3":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="workitem-action-assignee-selector">\r\n    <div class="workitem-action-assignee">\r\n      <div class="assignee-label">\r\n        <span class="binf-glyphicon binf-glyphicon-star"></span>\r\n        '+e.escapeExpression((l=null!=(l=a(i,"assigneePickerLabel")||(null!=t?a(t,"assigneePickerLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"assigneePickerLabel","hash":{},"loc":{"start":{"line":13,"column":8},"end":{"line":13,"column":31}}}):l))+'\r\n      </div>\r\n      <div class="assignee-picker">\r\n        \x3c!-- Here renders the assignee user picker --\x3e\r\n      </div>\r\n    </div>\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"showAssigneeOptionsSelector"):t,{"name":"if","hash":{},"fn":e.program(4,o,0),"inverse":e.noop,"loc":{"start":{"line":19,"column":4},"end":{"line":28,"column":11}}}))?s:"")+"  </div>\r\n"},"4":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <div class="workitem-action-assignee-options">\r\n        <div class="assignee-label">\r\n          '+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"lang"):t)?l(s,"assigneeOptionLabel"):s,t))+'\r\n        </div>\r\n        <div class="assignee-options">\r\n          \x3c!-- Here render the assignee type selector --\x3e\r\n        </div>\r\n      </div>\r\n'},"6":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"showAssigneeReadOnly"):t,{"name":"if","hash":{},"fn":e.program(7,o,0),"inverse":e.noop,"loc":{"start":{"line":31,"column":2},"end":{"line":38,"column":9}}}))?s:""},"7":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="workitem-action-assignee-label">\r\n      <div class="assignee-label">\r\n        '+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"lang"):t)?l(s,"assigneeLabelLabel"):s,t))+'\r\n      </div>\r\n      <div class="assignee-name"></div>\r\n    </div>\r\n'},"9":function(e,t,i,n,o){return'  \x3c!-- Comment Area --\x3e\r\n  <div class="workitem-action-comment">\r\n    \x3c!-- Here renders the commenting control --\x3e\r\n  </div>\r\n'},"11":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="workitem-action-reviewDuration">\r\n    \x3c!--Here renders the review duration control--\x3e\r\n    <div class="durationLabel">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"lang"):t)?l(s,"durationLabel"):s,t))+'</div>\r\n    <div class="durationDiv">\r\n      <div class="durationTextField">\r\n      </div>\r\n      <div class="durationUnitSection"> </div>\r\n    </div>\r\n  </div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"showAuthenticate"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":0},"end":{"line":6,"column":7}}}))?s:"")+"\x3c!-- Assignee area --\x3e\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"showAssigneeSelector"):t,{"name":"if","hash":{},"fn":e.program(3,o,0),"inverse":e.program(6,o,0),"loc":{"start":{"line":8,"column":0},"end":{"line":39,"column":7}}}))?s:"")+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"showComment"):t,{"name":"if","hash":{},"fn":e.program(9,o,0),"inverse":e.noop,"loc":{"start":{"line":40,"column":0},"end":{"line":45,"column":7}}}))?s:"")+"\x3c!--Duration option--\x3e\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"showDurationOption"):t,{"name":"if","hash":{},"fn":e.program(11,o,0),"inverse":e.noop,"loc":{"start":{"line":47,"column":0},"end":{"line":57,"column":7}}}))?s:"")}});return i.registerPartial("workflow_widgets_action_action.body_impl_action.body",n),n}),csui.define("hbs!workflow/widgets/action/action.body/impl/action.body.comment",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="comment-label">'+e.escapeExpression((s=null!=(s=l(i,"label")||(null!=t?l(t,"label"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"label","hash":{},"loc":{"start":{"line":1,"column":27},"end":{"line":1,"column":36}}}):s))+'</div>\r\n<textarea class="comment-input" rows="6" placeholder="'+e.escapeExpression((s=null!=(s=l(i,"placeholder")||(null!=t?l(t,"placeholder"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"placeholder","hash":{},"loc":{"start":{"line":2,"column":54},"end":{"line":2,"column":69}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"ariaLabel")||(null!=t?l(t,"ariaLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"ariaLabel","hash":{},"loc":{"start":{"line":2,"column":83},"end":{"line":2,"column":96}}}):s))+'"></textarea>\r\n\r\n'}});return i.registerPartial("workflow_widgets_action_action.body_impl_action.body.comment",n),n}),csui.define("hbs!workflow/widgets/action/action.body/impl/action.body.reviewDurationDate",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="durationRegion"></div>\r\n<div class="has-error-label binf-hidden" role="alert" aria-hidden="true">\r\n  <span id="errorDuration"></span>\r\n</div>'}});return i.registerPartial("workflow_widgets_action_action.body_impl_action.body.reviewDurationDate",n),n}),csui.define("hbs!workflow/widgets/action/action.body/impl/action.body.reviewDurationUnit",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="durationUnitRegion"></div>\r\n'}});return i.registerPartial("workflow_widgets_action_action.body_impl_action.body.reviewDurationUnit",n),n}),csui.define("hbs!workflow/widgets/action/action.body/impl/action.body.authenticate",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="authenticate-description" id="authenticateDescLabelAndUserID">\r\n  '+e.escapeExpression((s=null!=(s=l(i,"authenticateDescLabelAndUser")||(null!=t?l(t,"authenticateDescLabelAndUser"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"authenticateDescLabelAndUser","hash":{},"loc":{"start":{"line":2,"column":2},"end":{"line":2,"column":34}}}):s))+'\r\n</div>\r\n<div class="authenticate-description" id="authenticateEnterPasswordID">\r\n  '+e.escapeExpression((s=null!=(s=l(i,"authenticateEnterPassword")||(null!=t?l(t,"authenticateEnterPassword"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"authenticateEnterPassword","hash":{},"loc":{"start":{"line":5,"column":2},"end":{"line":5,"column":31}}}):s))+'\r\n</div>\r\n<div class="authenticate-label">\r\n<span class="binf-glyphicon binf-glyphicon-star"></span>\r\n  '+e.escapeExpression((s=null!=(s=l(i,"label")||(null!=t?l(t,"label"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"label","hash":{},"loc":{"start":{"line":9,"column":2},"end":{"line":9,"column":11}}}):s))+'\r\n</div>\r\n<div class="authenticate-textbox">\r\n  <input type="password" class="authenticate-input" placeholder="'+e.escapeExpression((s=null!=(s=l(i,"placeholder")||(null!=t?l(t,"placeholder"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"placeholder","hash":{},"loc":{"start":{"line":12,"column":65},"end":{"line":12,"column":80}}}):s))+'"\r\n         aria-label="'+e.escapeExpression((s=null!=(s=l(i,"ariaLabel")||(null!=t?l(t,"ariaLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"ariaLabel","hash":{},"loc":{"start":{"line":13,"column":21},"end":{"line":13,"column":34}}}):s))+'" aria-required="true"\r\n         aria-labelledby="authenticateDescLabelAndUserID authenticateEnterPasswordID"></input>\r\n  <div class="has-error-label binf-hidden" role="alert" aria-hidden="true">\r\n   <span id="error">\r\n    '+e.escapeExpression((s=null!=(s=l(i,"authenticateFailed")||(null!=t?l(t,"authenticateFailed"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"authenticateFailed","hash":{},"loc":{"start":{"line":17,"column":4},"end":{"line":17,"column":26}}}):s))+"\r\n    </span>\r\n  </div>\r\n</div>"}});return i.registerPartial("workflow_widgets_action_action.body_impl_action.body.authenticate",n),n}),csui.define("hbs!workflow/widgets/action/action.body/impl/assigneetypeselector",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="assignee-type-selector-region"></div>'}});return i.registerPartial("workflow_widgets_action_action.body_impl_assigneetypeselector",n),n}),csui.define("workflow/widgets/action/action.body/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/widgets/action/action.body/impl/nls/root/lang",{"assigneePickerLabel":"Forward to","assigneeOptionLabel":"Options to accept","assigneePickerPlaceholder":"Enter user name","assigneeCurrentUserMessage":"You are the current user","commentTextFieldLabel":"Add comments","commentTextFieldPlaceholder":"Add message","commentAriaLabelReply":"{0}: {1}","assigneeOptionOneMember":"One group member","assigneeOptionAllMembers":"All group members","assigneeLabelLabel":"To","authenticateTextFieldLabel":"Password","authenticateTextFieldPlaceholder":"Enter password","authenticateDescriptionLabel":"Additional user authentication is required.","authenticateEnterPassword":"Enter password for user {0}.","authenticationFailed":"Authentication failed. Please check your spelling.","durationLabel":"Duration","durationUnitOptionLabel":"Duration unit options","durationDayUnit":"Days","durationHourUnit":"Hours","durationNumberFailed":"This value must be a number.","durationMaximumFailed":"The maximum value for this field is {0}.","durationPlaceholder":"Add value"}),csui.define("css!workflow/widgets/action/action.body/impl/action.body",[],function(){}),csui.define("workflow/widgets/action/action.body/action.body.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca.lite","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/form/fields/selectfield.view","csui/controls/form/fields/userfield.view","csui/controls/form/fields/textfield.view","workflow/controls/userpicker/userpicker.view","hbs!workflow/widgets/action/action.body/impl/action.body","hbs!workflow/widgets/action/action.body/impl/action.body.comment","hbs!workflow/widgets/action/action.body/impl/action.body.reviewDurationDate","hbs!workflow/widgets/action/action.body/impl/action.body.reviewDurationUnit","hbs!workflow/widgets/action/action.body/impl/action.body.authenticate","hbs!workflow/widgets/action/action.body/impl/assigneetypeselector","i18n!workflow/widgets/action/action.body/impl/nls/lang","css!workflow/widgets/action/action.body/impl/action.body"],function(e,t,i,n,o,s,l,a,r,c,u,d,p,m,h,f,w,g){"use strict";var b=n.LayoutView.extend({"className":"action-comment","template":p,"templateHelpers":function(){return{"label":this.labelText,"placeholder":this.placeholderText,"ariaLabel":this.ariaLabel}},"ui":{"textbox":".comment-input"},"events":{"change @ui.textbox":"onChangeTextBox"},"behaviors":{"TabableRegion":{"behaviorClass":s,"initialActivationWeight":100}},"constructor":function(e){this.options=e||{},this.labelText=this.options.commentLabel||g.commentTextFieldLabel,this.ariaLabel=this.options.commentAriaLabel||g.commentTextFieldLabel,this.placeholderText=this.options.commentPlaceholder||g.commentTextFieldPlaceholder,n.LayoutView.prototype.constructor.call(this,e)},"onChangeTextBox":function(){this.triggerMethod("comment:changed",{"text":this.ui.textbox.val()})},"currentlyFocusedElement":function(){return e(this.ui.textbox)}}),v=n.LayoutView.extend({"className":"action-reviewDuration","template":m,"templateHelpers":function(){return{"durationLabel":this.durationLabel}},"regions":{"durationTextField":".durationRegion"},"ui":{"textbox":"#durationField","lblErrorMessage":".has-error-label","lblErrorMessageText":"#errorDuration"},"constructor":function(e){this.durationLabel=g.durationLabel,n.LayoutView.prototype.constructor.call(this)},"onRender":function(){this.durationField=new c({"model":new i.Model({"id":"durationField","options":{"placeholder":g.durationPlaceholder}}),"id":"durationFieldDIV","mode":"writeonly","labelId":g.durationLabel,"alpaca":{"options":{"mode":"writeonly"}}}),this.durationTextField.show(this.durationField)},"onKeyUpTextBox":function(){this.triggerMethod("duration:changed",{"number":this.$("#durationField").val()})},"currentlyFocusedElement":function(){return this.$("#durationField")},"events":{"keyup @ui.textbox":"onKeyUpTextBox"},"behaviors":{"TabableRegion":{"behaviorClass":s,"initialActivationWeight":100}}}),k=n.LayoutView.extend({"className":"action-reviewDuration","template":h,"templateHelpers":function(){return{}},"regions":{"selectUnit":".durationUnitRegion"},"constructor":function(e){this.durationUnit=e||g.durationDayUnit,n.LayoutView.prototype.constructor.call(this)},"onRender":function(){var e=new i.Collection([{"id":g.durationDayUnit,"name":g.durationDayUnit},{"id":g.durationHourUnit,"name":g.durationHourUnit}]);this.unitOptions=new a({"id":"unitOptionSelector","model":new i.Model({"options":{"isMultiFieldItem":!1,"label":g.durationUnitOptionLabel}}),"selected":e.get(g.durationDayUnit),"collection":e,"alpaca":{"options":{"setRequiredFieldsEditable":!0},"schema":{"readonly":!1}}}),this.unitOptions.alpacaField={"options":{"mode":"create"},"schema":{"readonly":!1},"setValueAndValidate":function(){return!0},"setValue":function(){},"parent":{}},this.selectUnit.show(this.unitOptions),this.listenTo(this.unitOptions,"field:changed",t.bind(function(e){this.triggerMethod("durationUnit:changed",{"option":e.fieldvalue})},this))},"currentlyFocusedElement":function(){return this.$(".binf-btn")},"behaviors":{"TabableRegion":{"behaviorClass":s,"initialActivationWeight":100}}}),y=n.LayoutView.extend({"className":"action-authenticate","template":f,"templateHelpers":function(){return{"lang":g,"label":this.labelText,"placeholder":this.placeholderText,"ariaLabel":this.ariaLabel,"authenticateDescLabelAndUser":this.authenticateDescLabel,"authenticateFailed":this.authenticationFailed,"authenticateEnterPassword":this.authenticateEnterPassword}},"constructor":function(e){this.options=e||{},this.labelText=g.authenticateTextFieldLabel,this.ariaLabel=g.authenticateTextFieldLabel,this.placeholderText=g.authenticateTextFieldPlaceholder,this.authenticateDescLabel=g.authenticateDescriptionLabel;var i=e||"";this.authenticateEnterPassword=t.str.sformat(g.authenticateEnterPassword,i),this.authenticationFailed=g.authenticationFailed,n.LayoutView.prototype.constructor.call(this,e)},"ui":{"txtPassword":".authenticate-input","lblErrorMessage":".has-error-label"},"events":{"keyup @ui.txtPassword":"onKeyUpTextBox"},"onKeyUpTextBox":function(){this.triggerMethod("authenticate:changed",{"text":this.ui.txtPassword.val()})},"currentlyFocusedElement":function(){return e(this.ui.txtPassword)},"behaviors":{"TabableRegion":{"behaviorClass":s,"initialActivationWeight":100}}}),x=n.LayoutView.extend({"className":"assignee-options-select","template":w,"templateHelpers":function(){return{"lang":g}},"regions":{"selectField":".assignee-type-selector-region"},"behaviors":{"TabableRegion":{"behaviorClass":s,"initialActivationWeight":100}},"constructor":function(e){n.LayoutView.prototype.constructor.call(this,e)},"onRender":function(){var e=new i.Collection([{"id":g.assigneeOptionOneMember,"name":g.assigneeOptionOneMember},{"id":g.assigneeOptionAllMembers,"name":g.assigneeOptionAllMembers}]);this.assingeeOptions=new a({"id":"assigneeOptionSelector","model":new i.Model({"options":{"isMultiFieldItem":!1,"label":g.assigneeOptionLabel}}),"selected":e.get(g.assigneeOptionOneMember),"collection":e,"alpaca":{"options":{"setRequiredFieldsEditable":!0},"schema":{"readonly":!1}}}),this.assingeeOptions.alpacaField={"options":{"mode":"create"},"schema":{"readonly":!1},"setValueAndValidate":function(){return!0},"setValue":function(){},"parent":{}},this.selectField.show(this.assingeeOptions),this.listenTo(this.assingeeOptions,"field:changed",t.bind(function(e){this.triggerMethod("assigneeOption:changed",{"option":e.fieldvalue})},this))},"currentlyFocusedElement":function(){if(this.$el.is(":visible"))return this.$(".binf-dropdown-toggle")}}),C=n.LayoutView.extend({"className":"workitem-action-body","template":d,"templateHelpers":function(){return{"lang":g,"showAssigneeSelector":this.showAssigneeSelector,"showAssigneeOptionsSelector":this.showAssigneeOptionsSelector,"showAssigneeReadOnly":this.showAssigneeReadOnly,"showComment":this.showComment,"showAuthenticate":this.showAuthenticate,"showDurationOption":this.showDurationOption,"assigneePickerLabel":this.texts.assigneeLabel||g.assigneePickerLabel}},"regions":{"assigneeRegion":".workitem-action-assignee .assignee-picker","assigneeTypeRegion":".workitem-action-assignee-options .assignee-options","assigneeLabelRegion":".workitem-action-assignee-label .assignee-name","commentRegion":".workitem-action-comment","authenticateInputRegion":".workitem-action-authenticate","reviewDurationDateRegion":".workitem-action-reviewDuration .durationTextField","reviewDurationUnitRegion":".workitem-action-reviewDuration .durationUnitSection"},"ui":{"assigneeOptionsLabel":".workitem-action-assignee-options .assignee-label","assigneeOptionsSelector":".workitem-action-assignee-options .assignee-options"},"constructor":function(e){this.showAssigneeSelector=e.model.get("requireAssignee"),this.showAssigneeReadOnly=!this.showAssigneeSelector&&e.model.get("readonlyAssignee"),this.showAssigneeOptionsSelector=e.model.get("assigneeOptions"),this.showComment=e.model.get("requireComment"),e.model.get("assignee")&&(this.userId=e.model.get("assignee").get("id"),this.assigneeAttributes=e.model.get("assignee").attributes),this.showAuthenticate=e.model.get("authentication"),e.model.get("currentUser")&&(this.currentUser=e.model.get("currentUser")),this.showDurationOption=e.model.get("durationOption"),this.duration=e.model.get("duration"),this.durationUnit=e.model.get("durationUnit"),this.texts=e.model.get("texts")||{},this.showAssigneeReadOnly?this.texts.commentAriaLabel=t.str.sformat(g.commentAriaLabelReply,this.texts.commentLabel,this.assigneeAttributes.display_name):this.texts.commentAriaLabel=this.texts.commentLabel,n.LayoutView.prototype.constructor.call(this,e),this.listenTo(this.model,"change:authentication_error",this._onAuthenticationError),this.propagateEventsToRegions()},"onRender":function(){if(this.showAssigneeSelector){var e,n=this.options.model.get("userPickerOptions");e=n&&"custom"===n.scope?n.customUserPicker:new u({"context":this.options.context,"limit":20,"clearOnSelect":!1,"placeholder":this.texts.assigneePlaceholder||g.assigneePickerPlaceholder,"ariaLabel":this.texts.assigneeLabel||g.assigneePickerLabel,"disabledMessage":g.assigneeCurrentUserMessage,
"onRetrieveMembers":t.bind(this.onRetrieveMembers,this),"prettyScrolling":!0,"initialActivationWeight":100,"isRequired":!0}),this.listenTo(e,"dom:refresh",function(){this.showAuthenticate||e.$("input").trigger("focus")}),this.assigneeRegion.show(e),this.listenTo(e,"item:change",this.onUserChanged),this.listenTo(e,"item:remove",this.onUserRemoved)}if(this.showAssigneeReadOnly){var o=new r({"context":this.options.context,"mode":"readonly","model":new i.Model({"data":this.assigneeAttributes,"schema":{"readonly":!0}}),"alpaca":{"options":{}}});this.assigneeLabelRegion.show(o)}if(this.showAssigneeOptionsSelector){var s=new x({"context":this.options.context});this.listenTo(s,"assigneeOption:changed",this.onAssigneeOptionChanged),this.assigneeTypeRegion.show(s),this._hideAssigneeOptions(!0)}if(this.showAuthenticate&&(this.authenticate=new y(this.currentUser),this.listenTo(this.authenticate,"dom:refresh",function(){this.authenticate.$("input").trigger("focus"),this.authenticate.$("input").val(""),this.authenticate.triggerMethod("authenticate:changed")}),this.listenTo(this.authenticate,"authenticate:changed",this._onAuthenticateChanged),this.authenticateInputRegion.show(this.authenticate)),this.showComment){var l=new b(this.texts);this.listenTo(l,"comment:changed",this.onCommentChanged),this.commentRegion.show(l)}this.showDurationOption&&(this.reviewDurationDate=new v(this.duration),this.reviewDurationUnit=new k(this.durationUnit),this.listenTo(this.reviewDurationDate,"duration:changed",this._onReviewDurationChanged),this.listenTo(this.reviewDurationUnit,"durationUnit:changed",this._onReviewDurationUnitChanged),this.reviewDurationDateRegion.show(this.reviewDurationDate),this.reviewDurationUnitRegion.show(this.reviewDurationUnit))},"_onReviewDurationChanged":function(e){this._validateNumberAndMax(e.number)?(this.model.set("duration",e.number),this.reviewDurationUnit.triggerMethod("durationUnit:changed"),this.reviewDurationDate.ui.lblErrorMessage.addClass("binf-hidden"),this.reviewDurationDate.$("#durationField").removeClass("has-error")):(this.model.set("duration","error"),this.reviewDurationDate.ui.lblErrorMessage.removeClass("binf-hidden"),this.reviewDurationDate.$("#durationField").addClass("has-error"))},"_onReviewDurationUnitChanged":function(e){t.isUndefined(e)?this.model.set("duration_unit",this.reviewDurationUnit.unitOptions.curVal.id):this.model.set("duration_unit",e.option)},"_validateNumberAndMax":function(e){if(this.reviewDurationDate.ui.lblErrorMessageText.text(""),t.isEmpty(e))return!0;if(!o.testRegex(o.regexps.number,e))return this.reviewDurationDate.ui.lblErrorMessageText.text(g.durationNumberFailed),!1;var i=parseFloat(e);return!isNaN(i)&&(!(i>11574)||(this.reviewDurationDate.ui.lblErrorMessageText.text(t.str.sformat(g.durationMaximumFailed,"11574")),!1))},"_onAuthenticationError":function(e){this.authenticate.ui.txtPassword.addClass("has-error"),this.authenticate.ui.txtPassword.val(""),this.authenticate.ui.txtPassword.trigger("focus"),this.authenticate.ui.txtPassword.removeAttr("aria-labelledby"),this.authenticate.ui.txtPassword.attr("aria-labelledby","error"),this.authenticate.triggerMethod("authenticate:changed"),this.authenticate.ui.lblErrorMessage.removeClass("binf-hidden")},"_onAuthenticateChanged":function(e){t.isUndefined(e)?this.model.set("authentication_info",{"password":""}):this.model.set("authentication_info",{"password":e.text}),""!==this.model.get("authentication_error")&&this.model.set("authentication_error","")},"onCommentChanged":function(e){this.model.set("comment",e.text)},"onAssigneeOptionChanged":function(e){e.option===g.assigneeOptionAllMembers?this.model.set("assigneeOption",2):this.model.set("assigneeOption",0)},"onUserChanged":function(e){var i=e.item;if(i.get("disabled")){var n=this.assigneeRegion.currentView;n&&n.ui.searchbox.val(""),i=void 0}this.model.set("assignee",i),i&&0===i.get("type")||t.isUndefined(i)?this._hideAssigneeOptions(!0):this._hideAssigneeOptions(!1)},"onUserRemoved":function(e){this.model.set("assignee",void 0),this._hideAssigneeOptions(!0)},"onRetrieveMembers":function(e){var t=this;this.userId&&e.collection.each(function(e){e.get("id")===t.userId&&e.set("disabled",!0)})},"_hideAssigneeOptions":function(e){e?(this.ui.assigneeOptionsLabel.addClass("binf-hidden"),this.ui.assigneeOptionsSelector.addClass("binf-hidden")):(this.ui.assigneeOptionsLabel.removeClass("binf-hidden"),this.ui.assigneeOptionsSelector.removeClass("binf-hidden"))}});return t.extend(C.prototype,l),C}),csui.define("workflow/dialogs/action.dialog/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/dialogs/action.dialog/impl/nls/root/lang",{"submitButtonLabel":"Submit","cancelButtonLabel":"Cancel","ActionFailMessageTitle":'Action "{0}" failed',"ActionFailMessage":'Action "{0}" failed. \n\n{1}',"DialogDefaultTitle":"{0}: Workflow step"}),csui.define("css!workflow/dialogs/action.dialog/impl/action.dialog",[],function(){}),csui.define("workflow/dialogs/action.dialog/action.dialog",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/controls/dialog/dialog.view","csui/dialogs/modal.alert/modal.alert","workflow/widgets/action/action.body/action.body.view","i18n!workflow/dialogs/action.dialog/impl/nls/lang","css!workflow/dialogs/action.dialog/impl/action.dialog"],function(e,t,i,n,o,s,l){"use strict";return n.extend({"className":"workflow-action-dialog","constructor":function(t){var i=this;this.options=t||{},this.model=this.options.model,this.action=this.model.get("action"),this.model.get("assignee")&&(this.userId=this.model.get("assignee").get("id")),this.texts=t.model.get("texts")||{};var o=[];o.push({"id":i.action.get("id"),"label":this.texts.submitLabel||l.submitButtonLabel,"toolTip":this.texts.submitLabel||l.submitButtonLabel,"disabled":!this._isValidAuthInfoAndValidAssignee(),"default":!0,"click":function(){i.onClickAction()}}),o.push({"label":this.texts.cancelLabel||l.cancelButtonLabel,"toolTip":this.texts.cancelLabel||l.cancelButtonLabel,"close":!0,"click":function(){i.model.set("comment","")}});var a=this.model.get("title");e.isUndefined(a)&&(a=e.str.sformat(l.DialogDefaultTitle,this.action.get("label"))),e.defaults(t,{"title":a,"buttons":o});var r=new s(t);e.extend(t,{"view":r}),n.prototype.constructor.call(this,t),this.listenTo(this.model,"change:assignee",this.onChangedAssignee),this.listenTo(this.model,"change:duration",this.onChangedDuration),this.listenTo(this.model,"change:authentication_info",this.onChangedAuthenticationInfo)},"onChangedAuthenticationInfo":function(){this.updateButton(this.action.get("id"),{"disabled":!this._isValidAuthInfoAndValidAssignee()})},"onClickAction":function(){e.isFunction(this.options.callback)&&(this.updateButton(this.action.get("id"),{"disabled":!0}),this.options.callback(this.model))},"onChangedAssignee":function(){this.updateButton(this.action.get("id"),{"disabled":!this._isValidAuthInfoAndValidAssignee()})},"onChangedDuration":function(){this.updateButton(this.action.get("id"),{"disabled":!this._isValidAuthInfoAndValidAssignee()})},"_isValidAuthInfo":function(){var e=!1;return this.model.get("authentication")?this.model.get("authentication_info")&&""!==this.model.get("authentication_info").password&&(e=!0):e=!0,e},"_isValidAssignee":function(){var e=!1;return this.model.get("requireAssignee")?this.model.get("assignee")&&this.model.get("assignee").get("id")!==this.userId&&(e=!0):e=!0,e},"_isValidDuration":function(){var t=!1;return this.model.get("durationOption")?this.model.get("duration")&&"error"!==this.model.get("duration")?t=!0:(e.isUndefined(this.model.get("duration"))||""===this.model.get("duration"))&&(t=!0):t=!0,t},"_isValidAuthInfoAndValidAssignee":function(){var e=!1;return this._isValidAssignee()&&this._isValidAuthInfo()&&this._isValidDuration()&&(e=!0),e}})}),csui.define("workflow/dialogs/action.dialog/action.dialog.model",["csui/lib/underscore","csui/lib/backbone"],function(e,t){"use strict";return t.Model.extend({"defaults":{"title":void 0,"action":void 0,"requireComment":!1,"comment":void 0,"requireAssignee":!1,"readonlyAssignee":!1,"assigneeOptions":!1,"assignee":void 0,"texts":{},"authentication":!1,"currentUser":void 0,"authentication_info":void 0,"authentication_error":"","durationOption":!1},"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments)}})}),csui.define("workflow/models/wfstatus/wfstatus.model",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url"],function(e,t,i,n){"use strict";return i.Model.extend({"constructor":function(e,t){i.Model.prototype.constructor.apply(this,arguments),t&&t.connector&&t.connector.assignTo(this)},"url":function(){var e=this.connector.connection.url.replace("/v1","/v2"),t=n.combine(e,"workflows/status/widget"),i=this.get("filterWorkflowtype"),o=this.get("retention"),s=this.get("selectionType"),l=this.get("wfstatusfilter"),a=this.get("referenceid");if(!i){var r=!this.get("filterWorkflows")||this.get("filterWorkflows").filterInitiated,c=!this.get("filterWorkflows")||this.get("filterWorkflows").filterManaged;i="Both",r&&c?i="Both":r?i="Initiated":c&&(i="Managed")}return t+="?selectionType="+s,l&&""!==l?t+="&wfstatusfilter="+l:(t+="&wfretention="+o,t+="&kind="+i),a&&(t+="&nodeid="+a),t},"parse":function(e){return e.results},"isFetchable":function(){return!0},"sendReAssignAction":function(i){var o=this.connector.connection.url.replace("/v1","/v2"),s=n.combine(o,"workflows","status"),l=new FormData,a={"workid":i.wfData.process_id||i.wfData.processId,"subworkid":i.wfData.subprocess_id||i.wfData.subProcessId,"taskid":i.wfData.task_id||i.wfData.taskId,"newuserid":i.model.get("assignee"),"comment":i.model.get("comment")},r=t.Deferred();l.append("body",JSON.stringify(a));var c={"type":"POST","url":s,"data":l,"contentType":!1,"processData":!1};return this.connector&&this.connector.extendAjaxOptions(c),t.ajax(c).done(e.bind(function(e){r.resolve(e)},this)).fail(e.bind(function(e){var t="";e.responseText&&(t=JSON.parse(e.responseText)),r.reject(t)},this)),r}})}),csui.define("workflow/models/wfstatus/wfstatus.model.factory",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","workflow/models/wfstatus/wfstatus.model"],function(e,t,i,n,o,s){"use strict";return n.extend({"propertyPrefix":"wfstatus","constructor":function(e,t){n.prototype.constructor.apply(this,arguments);var i=e.getObject(o,t);this.context=e,this.property=new s(t,{"connector":i})},"isFetchable":function(){return this.property.isFetchable()},"fetch":function(e){return this.property.fetch(e)}})}),csui.define("hbs!workflow/controls/usercards/impl/usercard",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="binf-row">\r\n    <div class="wfstatus-mini-profile-user binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      <div class="binf-row">\r\n        <div class="wfstatus-mini-profile-details">\r\n          <div class="wfstatus-group-profile-img">\r\n                <span class="wfstatus-mini-profile-avatar">\r\n                    <a href="javascript:void(0);" class="wfstatus-group-profile-pic">\r\n                        <span\r\n                            class="wfstatus-miniprofile-default-avatar-show default-group-avatar image_group_placeholder"\r\n                            title="'+e.escapeExpression((l=null!=(l=a(i,"name")||(null!=t?a(t,"name"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":12,"column":35},"end":{"line":12,"column":43}}}):l))+'"></span>\r\n                    </a>\r\n                </span>\r\n          </div>\r\n          <div class="binf-col-lg-10 binf-col-md-10 binf-col-sm-10 binf-col-xs-10">\r\n            <div class="binf-row">\r\n              <div class="wfstatus-mini-profile-userinfo binf-col-lg-7 binf-col-md-7 binf-col-sm-7 binf-col-xs-7">\r\n                <div class="wfstatus-mini-profile-user-displayname">\r\n                  <a href="javascript:void(0);" class="wfstatus-mini-profile-group-name binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12"title="'+e.escapeExpression((l=null!=(l=a(i,"name")||(null!=t?a(t,"name"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":20,"column":155},"end":{"line":20,"column":163}}}):l))+'">\r\n                    '+e.escapeExpression((l=null!=(l=a(i,"name")||(null!=t?a(t,"name"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":21,"column":20},"end":{"line":21,"column":28}}}):l))+'\r\n                  </a>\r\n                </div>\r\n              </div>\r\n              <div class="wfstatus-usercard-wfstatus binf-col-lg-3 binf-col-md-3 binf-col-sm-3 binf-col-xs-3" title="'+e.escapeExpression((l=null!=(l=a(i,"status")||(null!=t?a(t,"status"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"status","hash":{},"loc":{"start":{"line":25,"column":117},"end":{"line":25,"column":127}}}):l))+'">\r\n                '+e.escapeExpression((l=null!=(l=a(i,"status")||(null!=t?a(t,"status"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"status","hash":{},"loc":{"start":{"line":26,"column":16},"end":{"line":26,"column":26}}}):l))+'\r\n              </div>\r\n            </div> \r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class="binf-row">\r\n        <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 wfstatus-usercard-footer-col">\r\n          <div class="wfstatus-usercard-actions wfstatus-usercard-footer">\r\n            <div class="wfstatus-usercard-inline-actions">\r\n              <div class="wfstatus-reassignButton">\r\n                  <span><button class="csui-btn binf-btn binf-btn-primary wfstatus-reassign-btn" title="'+e.escapeExpression((l=null!=(l=a(i,"ReassignLabel")||(null!=t?a(t,"ReassignLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"ReassignLabel","hash":{},"loc":{"start":{"line":37,"column":104},"end":{"line":37,"column":121}}}):l))+'" tabindex="0">'+e.escapeExpression((l=null!=(l=a(i,"ReassignLabel")||(null!=t?a(t,"ReassignLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"ReassignLabel","hash":{},"loc":{"start":{"line":37,"column":136},"end":{"line":37,"column":153}}}):l))+"</button>\r\n                  </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"MultiUser"):t,{"name":"if","hash":{},"fn":e.program(2,o,0),"inverse":e.noop,"loc":{"start":{"line":45,"column":4},"end":{"line":49,"column":11}}}))?s:"")+"  </div>\r\n"},"2":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"notLastUser"):t,{"name":"if","hash":{},"fn":e.program(3,o,0),"inverse":e.noop,"loc":{"start":{"line":46,"column":6},"end":{"line":48,"column":13}}}))?s:""},"3":function(e,t,i,n,o){return"        <hr>\r\n"},"5":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="binf-row">\r\n    <div class="wfstatus-mini-profile-user binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12">\r\n      <div class="binf-row">\r\n        <div class="wfstatus-mini-profile-details">\r\n          <div class="wfstatus-user-profile-img">\r\n                <span class="wfstatus-mini-profile-avatar">\r\n                    <a href="javascript:void(0);" class="wfstatus-user-profile-pic">\r\n                        <span class="image_user_placeholder wfstatus-miniprofile-default-avatar-'+e.escapeExpression((l=null!=(l=a(i,"displayDefaultPic")||(null!=t?a(t,"displayDefaultPic"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"displayDefaultPic","hash":{},"loc":{"start":{"line":59,"column":96},"end":{"line":59,"column":117}}}):l))+'" style="background: '+e.escapeExpression((l=null!=(l=a(i,"userBackgroundColor")||(null!=t?a(t,"userBackgroundColor"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"userBackgroundColor","hash":{},"loc":{"start":{"line":59,"column":138},"end":{"line":59,"column":161}}}):l))+'" title="'+e.escapeExpression((l=null!=(l=a(i,"name")||(null!=t?a(t,"name"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":59,"column":170},"end":{"line":59,"column":178}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"initials")||(null!=t?a(t,"initials"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"initials","hash":{},"loc":{"start":{"line":59,"column":180},"end":{"line":59,"column":192}}}):l))+'</span>\r\n                        <img id="wfstatus-mini-profile-pic-'+e.escapeExpression((l=null!=(l=a(i,"id")||(null!=t?a(t,"id"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":60,"column":59},"end":{"line":60,"column":65}}}):l))+'" class="wfstatus-userprofile-img binf-img-circle-'+e.escapeExpression((l=null!=(l=a(i,"displayPic")||(null!=t?a(t,"displayPic"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"displayPic","hash":{},"loc":{"start":{"line":60,"column":115},"end":{"line":60,"column":129}}}):l))+'" src="'+e.escapeExpression((l=null!=(l=a(i,"photoUrl")||(null!=t?a(t,"photoUrl"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"photoUrl","hash":{},"loc":{"start":{"line":60,"column":136},"end":{"line":60,"column":148}}}):l))+'" title="'+e.escapeExpression((l=null!=(l=a(i,"name")||(null!=t?a(t,"name"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":60,"column":157},"end":{"line":60,"column":165}}}):l))+'">\r\n                    </a>\r\n                </span>\r\n          </div>\r\n          <div class="binf-col-lg-10 binf-col-md-10 binf-col-sm-10 binf-col-xs-10">\r\n            <div class="binf-row">\r\n              <div class="wfstatus-mini-profile-userinfo binf-col-lg-7 binf-col-md-7 binf-col-sm-7 binf-col-xs-7">\r\n                <div class="wfstatus-mini-profile-user-displayname">\r\n                  <a href="javascript:void(0);" class="wfstatus-mini-profile-user-name " title="'+e.escapeExpression((l=null!=(l=a(i,"name")||(null!=t?a(t,"name"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":68,"column":96},"end":{"line":68,"column":104}}}):l))+'">\r\n                    '+e.escapeExpression((l=null!=(l=a(i,"name")||(null!=t?a(t,"name"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":69,"column":20},"end":{"line":69,"column":28}}}):l))+'\r\n                  </a>\r\n                </div>\r\n              </div>\r\n              <div class="wfstatus-usercard-wfstatus binf-col-lg-3 binf-col-md-3 binf-col-sm-3 binf-col-xs-3" title="'+e.escapeExpression((l=null!=(l=a(i,"status")||(null!=t?a(t,"status"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"status","hash":{},"loc":{"start":{"line":73,"column":117},"end":{"line":73,"column":127}}}):l))+'">\r\n                '+e.escapeExpression((l=null!=(l=a(i,"status")||(null!=t?a(t,"status"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"status","hash":{},"loc":{"start":{"line":74,"column":16},"end":{"line":74,"column":26}}}):l))+"\r\n              </div>\r\n            </div>\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"hasContactInfo"):t,{"name":"if","hash":{},"fn":e.program(6,o,0),"inverse":e.noop,"loc":{"start":{"line":77,"column":12},"end":{"line":93,"column":19}}}))?s:"")+'          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      <div class="binf-row">\r\n        <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 wfstatus-usercard-footer-col">\r\n        <div class="wfstatus-usercard-actions wfstatus-usercard-footer">\r\n          <div class="wfstatus-usercard-inline-actions">\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"isChatEnabled"):t,{"name":"if","hash":{},"fn":e.program(11,o,0),"inverse":e.noop,"loc":{"start":{"line":102,"column":12},"end":{"line":109,"column":19}}}))?s:"")+"\r\n\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"displayReassign"):t,{"name":"if","hash":{},"fn":e.program(13,o,0),"inverse":e.noop,"loc":{"start":{"line":112,"column":12},"end":{"line":118,"column":19}}}))?s:"")+"          </div>  \r\n        </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"MultiUser"):t,{"name":"if","hash":{},"fn":e.program(2,o,0),"inverse":e.noop,"loc":{"start":{"line":124,"column":4},"end":{"line":128,"column":11}}}))?s:"")+"  </div>\r\n"},"6":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'              <div class="binf-row">\r\n                <div class="binf-col-lg-12 binf-col-md-12 binf-col-sm-12 binf-col-xs-12 wfstatus-usercard-user-details">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"business_email"):t,{"name":"if","hash":{},"fn":e.program(7,o,0),"inverse":e.noop,"loc":{"start":{"line":80,"column":18},"end":{"line":85,"column":25}}}))?s:"")+"\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"business_phone"):t,{"name":"if","hash":{},"fn":e.program(9,o,0),"inverse":e.noop,"loc":{"start":{"line":87,"column":18},"end":{"line":90,"column":25}}}))?s:"")+"                </div>\r\n              </div>\r\n"},"7":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                    <div class="wfstatus-mini-profile-user-displayemail">\r\n                      <a class="wfstatus-mini-profile-user-email" href="mailto:'+e.escapeExpression((s=null!=(s=l(i,"business_email")||(null!=t?l(t,"business_email"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"business_email","hash":{},"loc":{"start":{"line":82,"column":79},"end":{"line":82,"column":97}}}):s))+'"\r\n                        title="'+e.escapeExpression((s=null!=(s=l(i,"business_email")||(null!=t?l(t,"business_email"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"business_email","hash":{},"loc":{"start":{"line":83,"column":31},"end":{"line":83,"column":49}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"business_email")||(null!=t?l(t,"business_email"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"business_email","hash":{},"loc":{"start":{"line":83,"column":51},"end":{"line":83,"column":69}}}):s))+"</a>\r\n                    </div>\r\n"},"9":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                    <div class="wfstatus-mini-profile-user-phone"\r\n                        title="'+e.escapeExpression((s=null!=(s=l(i,"business_phone")||(null!=t?l(t,"business_phone"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"business_phone","hash":{},"loc":{"start":{"line":89,"column":31},"end":{"line":89,"column":49}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"PhoneLabel")||(null!=t?l(t,"PhoneLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"PhoneLabel","hash":{},"loc":{"start":{"line":89,"column":51},"end":{"line":89,"column":65}}}):s))+" "+e.escapeExpression((s=null!=(s=l(i,"business_phone")||(null!=t?l(t,"business_phone"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"business_phone","hash":{},"loc":{"start":{"line":89,"column":66},"end":{"line":89,"column":84}}}):s))+"</div>\r\n"},"11":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'              <div class="wfstatus-chatButton">\r\n                  <a href=\''+e.escapeExpression((s=null!=(s=l(i,"chatURI")||(null!=t?l(t,"chatURI"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"chatURI","hash":{},"loc":{"start":{"line":104,"column":27},"end":{"line":104,"column":38}}}):s))+"' class='wfstatus-chat-icon'>\r\n                      <span><button class=\"csui-btn binf-btn binf-btn-secondary wfstatus-chat-btn\" title=\""+e.escapeExpression((s=null!=(s=l(i,"ChatLabel")||(null!=t?l(t,"ChatLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"ChatLabel","hash":{},"loc":{"start":{"line":105,"column":106},"end":{"line":105,"column":119}}}):s))+'"\r\n                                    tabindex="0">'+e.escapeExpression((s=null!=(s=l(i,"ChatLabel")||(null!=t?l(t,"ChatLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"ChatLabel","hash":{},"loc":{"start":{"line":106,"column":49},"end":{"line":106,"column":62}}}):s))+"</button>\r\n                      </span></a>\r\n              </div>\r\n"},"13":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'              <div class="wfstatus-reassignButton">\r\n                  <span><button class="csui-btn binf-btn binf-btn-primary wfstatus-reassign-btn" title="'+e.escapeExpression((s=null!=(s=l(i,"ReassignLabel")||(null!=t?l(t,"ReassignLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"ReassignLabel","hash":{},"loc":{"start":{"line":114,"column":104},"end":{"line":114,"column":121}}}):s))+'"\r\n                                tabindex="0">'+e.escapeExpression((s=null!=(s=l(i,"ReassignLabel")||(null!=t?l(t,"ReassignLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"ReassignLabel","hash":{},"loc":{"start":{"line":115,"column":45},"end":{"line":115,"column":62}}}):s))+"</button>\r\n                  </span>\r\n              </div>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"\x3c!-- Here if the assigneeType '1' is for group and '0' for user and handlebars considering '1' as true and '0' as false--\x3e\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"assigneeType"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.program(5,o,0),"loc":{"start":{"line":2,"column":0},"end":{"line":130,"column":7}}}))?s:"")}});return i.registerPartial("workflow_controls_usercards_impl_usercard",n),n}),csui.define("workflow/controls/usercards/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/controls/usercards/nls/root/lang",{"PhoneLabel":"Phone:","ChatButtonLabel":"Chat","ReassignButtonLabel":"Reassign","ReassignTo":"Reassign to","SuccessMessage":" Workflow step was successfully reassigned","ErrorMessage":"Could not reassign step","DialogHeaderMessage":"Reassign workflow step","commentPlaceholder":"Type a message"}),csui.define("css!workflow/controls/usercards/impl/usercard",[],function(){}),csui.define("workflow/controls/usercards/usercard.view",["require","csui/lib/jquery","csui/utils/url","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/contexts/factories/connector","csui/controls/toolbar/toolbar.view","csui/controls/globalmessage/globalmessage","csui/utils/user.avatar.color","workflow/dialogs/action.dialog/action.dialog","workflow/dialogs/action.dialog/action.dialog.model","workflow/models/wfstatus/wfstatus.model.factory","hbs!workflow/controls/usercards/impl/usercard","i18n!workflow/controls/usercards/nls/lang","css!workflow/controls/usercards/impl/usercard"],function(e,t,i,n,o,s,l,a,r,c,u,d,p,m,h){"use strict";return s.ItemView.extend({"template":m,"className":"wfstatus-usercard","constructor":function(e){s.ItemView.prototype.constructor.apply(this,arguments),this.model.connector=this.options.context.getObject(l,this.options)},"events":{"mouseenter .wfstatus-mini-profile-user":"showActions","mouseleave .wfstatus-mini-profile-user":"hideActions","click .wfstatus-mini-profile-user-name, .wfstatus-user-profile-img":"showUserProfileDialog","click .wfstatus-reassignButton":"showReassignDialogView"},"templateHelpers":function(){var t=c.getUserAvatarColor(this.model.attributes),i=e("workflow/models/wfstatus/wfstatus.collection.factory"),o=e("workflow/utils/workitem.util"),s=null===this.model.get("first_name")?"":this.model.get("first_name"),l=null===this.model.get("last_name")?"":this.model.get("last_name"),a=s+" "+l,r=this.model.get("name"),u=this.model.get("business_phone"),d=this.model.get("business_email"),p=this.model.get("photo_url"),m=this.model.get("id"),f=this.model.collection.at(this.model.collection.length-1),w=f.get("id")===this.model.get("id"),g=this.options.status,b=this.model.get("name"),v=this.options.context.getCollection(i),k=v.options.chatSettings,y=!!k&&k.chatEnabled,x=this.model.get("type"),C="",_={},D={},M="",T=this.options.originatingView.model.get("hasReassignAction");return C=this.options.nodeModel?this.options.nodeModel.get("task_status"):this.options.originatingView.model.get("status_key"),D.domain=k.chatDomain,D.tguser=b,M=o.getChatURI(D),1===x?_={"name":b,"id":m,"MultiUser":!this.model.get("singleUser"),"notLastUser":!w}:0===x&&(_={"name":" "===a?r:a,"business_phone":u||"","business_email":d||"","photoUrl":null===p?null:p,"id":m,"displayPic":null===p?"hide":"show","displayDefaultPic":null===p?"show":"hide","ChatLabel":h.ChatButtonLabel,"PhoneLabel":h.PhoneLabel,"MultiUser":!this.model.get("singleUser"),"notLastUser":!w,"displayReassign":"completed"!==C&&"stopped"!==C&&T,"hasContactInfo":!(!u&&!d),"initials":this.model.get("initials"),"userBackgroundColor":t}),n.extend(_,{"ReassignLabel":h.ReassignButtonLabel,"status":g,"assigneeType":x,"isChatEnabled":y,"chatURI":M}),_},"showActions":function(){this.model.get("singleUser")||(this.$el.find(".wfstatus-usercard-actions").addClass("wfstatus-usercard-footer"),this.$el.find(".wfstatus-chatButton").show(),this.$el.find(".wfstatus-reassignButton").show())},"hideActions":function(){this.model.get("singleUser")||(this.$el.find(".wfstatus-chatButton").hide(),this.$el.find(".wfstatus-reassignButton").hide(),this.$el.find(".wfstatus-usercard-actions").removeClass("wfstatus-usercard-footer"))},"onRender":function(){var i=e("workflow/utils/workitem.util"),n=this;i.showProfilePic(this.model).always(function(e){var i=URL.createObjectURL(e),o=t("#wfstatus-mini-profile-pic-"+n.model.get("id"));n.model.attributes.photoUrl=i,o.attr("src",i)}),this.firstUser=this.model.collection.at(0).get("id")===this.model.get("id");var o=!this.model.get("singleUser")&&this.firstUser;this.$el.find(".wfstatus-usercard-actions").addClass("wfstatus-usercard-footer"),o||this.hideActions()},"showReassignDialogView":function(e){var t=this.model.set({"id":"Reassign"}),i={
"requireAssignee":!0,"assigneeOptions":!1,"texts":{"assigneeLabel":h.ReassignTo,"commentPlaceholder":h.commentPlaceholder}},o=new d(n.extend({"title":h.DialogHeaderMessage,"requireComment":this.getOption("wfData").comments_on?this.getOption("wfData").comments_on:this.getOption("originatingView").model.get("comments_on"),"action":t},i));this.actionDialog=new u({"context":this.options.context,"model":o,"callback":n.bind(this.reAssignUser,this)}),this.actionDialog.show()},"updateReassignedStepCard":function(e){var t=e.step,i=e.resp;t.task_assignees=i.task_assignees,t.task_name=i.task_name,t.task_status=i.task_status},"reAssignUser":function(t,i){var o=t.get("comment");n.isUndefined(o)||0===o.length||this.model.set("comment",o,{"silent":!0});var s=t.get("assignee");n.isUndefined(s)||this.model.set("assignee",s.get("id"),{"silent":!0}),this.wfstatusmodel=this.options.context.getModel(p);var l=this;l.wfstatusmodel.sendReAssignAction(l.options).done(n.bind(function(t){var i,o=e("workflow/utils/workitem.util"),s=l.options.originatingView,a=s.model,c=t.results[0],u=s.options.tableView,d=l.options.nodeModel,p="next"===l.options.stepType,m={};if(m.assignedto=c.task_assignees.assignedto,m.assignees=c.task_assignees.assignee,m.isReassign=!0,i=o.getAssignee(m),l.options.stepCardsListView||l.options.wfData&&l.options.wfData.updateCurrentStepAssignee){var f,w,g=a.get("parallel_steps");if(this.options.wfData&&this.options.wfData.updateCurrentStepAssignee){var b=c.task_name;g[0].task_assignees=c.task_assignees,g[0].task_name=b,g[0].task_status=c.task_status,a.set("step_name",b)}else{f=l.options.nodeModel.get("task_id");var v;l.options.stepCardsListView.options.listViewMulCurrentSteps?(v=g[0].task_id,n.any(g,function(e){if(e.task_id===f){var t={"steps":g,"step":e,"resp":c,"cellModel":a,"firstTaskId":v};return l.updateReassignedStepCard(t),!0}})):(w=l.options.stepCardsListView.options.step_list,n.each([w,g],function(e){v=e[0].task_id,n.any(e,function(t){if(t.task_id===f){var i={"steps":e,"step":t,"resp":c,"cellModel":a,"firstTaskId":v};return l.updateReassignedStepCard(i),!0}})}))}}if(p||!f||w&&1===w.length)l.updatingView(l,a,c,u,i,p);else{var k=a.collection.where({"process_id":a.get("process_id"),"subprocess_id":a.get("subprocess_id"),"task_id":f});k&&k.length>0&&l.updatingView(l,k[0],c,u,i,p)}d&&(d.set("task_assignees",c.task_assignees),d.set("task_name",c.task_name),d.set("task_status",c.task_status)),r.showMessage("success",h.SuccessMessage)},this)).fail(n.bind(function(e){r.showMessage("error",""===e.error?h.ErrorMessage:e.error)})).always(n.bind(function(){e("workflow/utils/workitem.util").unbindPopover(i),n.isUndefined(this.actionDialog)||this.actionDialog.destroy()},l))},"updatingView":function(e,t,i,o,s,l){var a=i.task_assignees,r=t.collection.wfstatus;l||(n.has(a,"assignedto")?(a.assignedto.assignees=a.assignee,t.set({"assignedto":a.assignedto,"userId":a.assignedto.groupId}),a.assignee.length>0?t.set({"assignee_count":a.assigneeCount,"assignee":s}):t.set("assignee","")):1===a.assignee.length&&(t.unset("assignedto"),t.set({"assignee_count":a.assigneeCount,"assignee":s,"userId":a.assignee[0].userId})),o.updateRow(t),1===t.collection.length&&(r?(r.get("data").assignee=a.assignee,r.trigger("change",r)):(e.wfstatusmodel.get("data").assignee=a.assignee,e.wfstatusmodel.trigger("change"))))},"showUserProfileDialog":function(e){var i=this.model.connector,o=this.options.context,s=t(".wfstatus.csui-expanded"),l=this;this.model.attributes.display_name=this.model.get("name_formatted"),csui.require(["esoc/controls/userwidget/userwidget.view"],function(e){function a(i,o,l){var r;r=l?new e(o):i,r.showUserProfileDialog(),r.off("userwidgetview.show.user.dialog").on("userwidgetview.show.user.dialog",function(t){var i=n.extend({},o);t.options.userid=t.options.model.id;var s=n.extend(i,t.options);delete s.model,s.display_name=t.options.model.attributes.display_name,a(e,s,!0)}),t(".wfstatus-user-profile-dialog .esoc-user-widget-dialog-back").off("click").on("click",function(){var e=r.util.userStack.pop();e.model.id===r.model.id&&(e=r.util.userStack.pop()),a(e,void 0,!1)}),t(".wfstatus-user-widget-dialog-back").off("click").on("click",function(){(t(".esoc-user-widget-dialog").is(":visible")||t(".wfstatus-user-profile-dialog").is(":visible"))&&t(".wfstatus-user-profile-dialog .cs-close").trigger("click"),s.show()}),t(".esoc-user-widget-dialog .cs-close").off("click").on("click",function(){r.util.userStack=[],s.show()}),r.util.userDialog&&r.util.userDialog.listenTo(r.util.userDialog,"destroy",function(){s.show()})}var r={};r.model=l.model,r.connector=i,r.userid=l.model.get("id"),r.context=o,r.baseElement=void 0,r.showUserProfileLink=!0,r.loggedUserId=l.model.get("id"),r.dialogClassName="wfstatus-user-profile-dialog",r.dialogiconLeft="arrow_back wfstatus-user-widget-dialog-back",r.dialogiconRight="wfstatus-no-righticon",a(e,r,!0)})}})}),csui.define("workflow/models/wfstatus/usercard.model",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/url","workflow/controls/usercards/usercard.view"],function(e,t,i,n,o){"use strict";return i.Model.extend({"constructor":function(e){i.Model.prototype.constructor.apply(this,arguments),e&&e.connector&&e.connector.assignTo(this)},"url":function(){var e=this.connector.connection.url.replace("/v1","/v2"),t=n.combine(e,"/members/");return n.combine(t,this.get("userId"))}})}),csui.define("workflow/controls/usercards/usercards.view",["csui/lib/underscore","csui/lib/marionette","csui/controls/tile/behaviors/perfect.scrolling.behavior","workflow/controls/usercards/usercard.view","css!workflow/controls/usercards/impl/usercard"],function(e,t,i,n){"use strict";return t.CollectionView.extend({"childView":n,"className":"wfstatus-usercards-list","constructor":function(e){t.CollectionView.prototype.constructor.apply(this,arguments)},"childViewOptions":function(){return{"options":this,"status":this.options.status,"context":this.options.context,"originatingView":this.options.originatingView,"nodeModel":this.options.nodeModel,"stepCardsListView":this.options.stepCardsListView,"wfData":this.options.wfData,"stepType":this.options.stepType}}})}),csui.define("hbs!workflow/controls/usercards/impl/usercards.list",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="wfstatus-usercard-list"> </div>'}});return i.registerPartial("workflow_controls_usercards_impl_usercards.list",n),n}),csui.define("workflow/controls/usercards/usercards.list.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/url","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/models/member/member.model","csui/models/member/membercollection","workflow/controls/usercards/usercard.view","workflow/models/wfstatus/usercard.model","workflow/controls/usercards/usercards.view","workflow/utils/workitem.util","hbs!workflow/controls/usercards/impl/usercards.list","css!workflow/controls/usercards/impl/usercard"],function(e,t,i,n,o,s,l,a,r,c,u,d,p,m){"use strict";return o.LayoutView.extend({"childView":c,"className":"wfstatus-usercard-layout","template":m,"tagName":"div","regions":{"usercardLayout":".wfstatus-usercard-list"},"constructor":function(e){e=e||{},o.LayoutView.prototype.constructor.call(this,e)},"onRender":function(){var e=this;if(this.model.get("assignedto")){var t=new a({"groupId":this.model.get("assignedto").groupId},{"connector":this.model.connector});new r(void 0,{"member":t,"autofetch":!0,"connector":this.model.connector}).fetch().done(function(t){var n=i.sortBy(t.results,"type");e.renderUserCards(n)})}else new u({"userId":this.model.get("userId"),"connector":this.model.connector}).fetch().done(function(t){var i=t.results.data.properties;i.singleUser=!0,e.renderUserCards(i)})},"renderUserCards":function(t){var i={"dueDate":this.model.get("task_due_date")?this.model.get("task_due_date"):this.model.get("due_date"),"status":this.model.get("task_status")?this.model.get("task_status"):this.model.get("status_key")},n=e("workflow/utils/workitem.util"),o=n.formatStatus(i);this.Usercollection=new r(t,{}),this.usercardCollectionView=new d({"collection":this.Usercollection,"status":o.status,"context":this.options.context,"options":this,"originatingView":this.options.originatingView,"nodeModel":this.options.nodeModel,"stepCardsListView":this.options.stepCardsListView,"wfData":this.options.wfData,"stepType":this.options.stepType}),this.completeCollection=new r(t,{}),this.usercardLayout.show(this.usercardCollectionView)}})}),csui.define("hbs!workflow/controls/stepcards/impl/stepcard",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="wfstatus-step-assignee" title="'+e.escapeExpression((s=null!=(s=l(i,"assignee")||(null!=t?l(t,"assignee"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"assignee","hash":{},"loc":{"start":{"line":11,"column":47},"end":{"line":11,"column":59}}}):s))+'">\r\n      '+e.escapeExpression((s=null!=(s=l(i,"assignee")||(null!=t?l(t,"assignee"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"assignee","hash":{},"loc":{"start":{"line":12,"column":6},"end":{"line":12,"column":18}}}):s))+"\r\n    </div>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="wfstatus-step-info" taskId="'+e.escapeExpression((l=null!=(l=a(i,"task_id")||(null!=t?a(t,"task_id"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"task_id","hash":{},"loc":{"start":{"line":1,"column":40},"end":{"line":1,"column":51}}}):l))+'">\r\n  <div class="wfstatus-type-icon">\r\n    <span class="wfstatus-title-icon wfstatus-'+e.escapeExpression((l=null!=(l=a(i,"stepIcon")||(null!=t?a(t,"stepIcon"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"stepIcon","hash":{},"loc":{"start":{"line":3,"column":46},"end":{"line":3,"column":58}}}):l))+'-step-icon" aria-hidden="true"></span>\r\n  </div>\r\n  <div class="wfstatus-step-header">\r\n    <div class="wfstatus-step-name" title="'+e.escapeExpression((l=null!=(l=a(i,"stepName")||(null!=t?a(t,"stepName"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"stepName","hash":{},"loc":{"start":{"line":6,"column":43},"end":{"line":6,"column":55}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"stepName")||(null!=t?a(t,"stepName"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"stepName","hash":{},"loc":{"start":{"line":6,"column":57},"end":{"line":6,"column":69}}}):l))+'</div>\r\n    <div class="wfstatus-step-status" title="'+e.escapeExpression((l=null!=(l=a(i,"stepStatus")||(null!=t?a(t,"stepStatus"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"stepStatus","hash":{},"loc":{"start":{"line":7,"column":45},"end":{"line":7,"column":59}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"stepStatus")||(null!=t?a(t,"stepStatus"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"stepStatus","hash":{},"loc":{"start":{"line":7,"column":61},"end":{"line":7,"column":75}}}):l))+"</div>\r\n  </div>\r\n\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"assignee"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":10,"column":2},"end":{"line":14,"column":9}}}))?s:"")+'\r\n  <div class="wfstatus-stepcard-action">\r\n    <div class="wfstatus-open-workflow-button">\r\n            <span><button class="binf-btn binf-btn-default" title="'+e.escapeExpression((l=null!=(l=a(i,"OpenWorkflowLabel")||(null!=t?a(t,"OpenWorkflowLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"OpenWorkflowLabel","hash":{},"loc":{"start":{"line":18,"column":67},"end":{"line":18,"column":88}}}):l))+'"\r\n                          tabindex="0">'+e.escapeExpression((l=null!=(l=a(i,"OpenWorkflowLabel")||(null!=t?a(t,"OpenWorkflowLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"OpenWorkflowLabel","hash":{},"loc":{"start":{"line":19,"column":39},"end":{"line":19,"column":60}}}):l))+"</button>\r\n            </span>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n\r\n"}});return i.registerPartial("workflow_controls_stepcards_impl_stepcard",n),n}),csui.define("workflow/controls/stepcards/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/controls/stepcards/nls/root/lang",{"OpenWorkflow":"Open Workflow","NoStepAvailable":"The next step is dependent on the user action in the Current Step or there are multiple steps possible","systemUserText":"System"}),csui.define("css!workflow/controls/stepcards/impl/stepcard",[],function(){}),csui.define("workflow/controls/stepcards/stepcard.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/contexts/factories/connector","workflow/controls/popover/popover.view","workflow/controls/usercards/usercards.list.view","hbs!workflow/controls/stepcards/impl/stepcard","i18n!workflow/controls/stepcards/nls/lang","css!workflow/controls/stepcards/impl/stepcard"],function(e,t,i,n,o,s,l,a,r,c){"use strict";return o.ItemView.extend({"template":r,"className":"wfstatus-stepcard","constructor":function(e){o.ItemView.prototype.constructor.apply(this,arguments),this.stepCardsListView=this.options.stepCardsListView,this.model.connector=this.options.context.getObject(s,this.options),this.listenTo(this.model,"change",this.render)},"templateHelpers":function(){var t={},n=this.model.get("task_assignees"),o=e("workflow/utils/workitem.util"),s=null===this.model.get("task_name")?"":this.model.get("task_name"),l=null===this.model.get("task_due_date")?"":this.model.get("task_due_date"),a=null===this.model.get("task_status")?"":this.model.get("task_status"),r="",u=this.model.get("task_id"),d={"dueDate":l,"status":a},p=o.formatStatus(d);return null!==n&&(n.assignees=n.assignee,r=o.getAssignee(n)),t={"taskId":u,"stepStatus":p.status,"stepName":s,"assignee":r,"stepIcon":a},i.extend(t,{"OpenWorkflowLabel":c.OpenWorkflow}),t},"events":{"click .wfstatus-step-assignee":"showUserPopOver"},"showUserPopOver":function(){var e=this.model.get("task_assignees"),n=e.assignee,o=this.options.context,s=t(0!==t(".wfstatusitem-step-cards").length?".wfstatusitem-step-cards":".wfstatus-stepcard-layout"),r=s.position().top;if(1!==n.length||n[0].loginName!==c.systemUserText){r&&t(".wfstatusitem-user-cards").css({"top":r}),this.model.unset("userId"),this.model.unset("assignedto"),1===n.length?this.model.set("userId",n[0].userId):this.model.set("assignedto",e.assignedto);var u={"model":this.model,"nodeModel":this.model,"context":o,"originatingView":this.options.cellView,"currentView":this,"stepCardsListView":this.stepCardsListView,"stepType":this.options.stepType,"wfData":i.pick(this.model.attributes,"process_id","subprocess_id","task_id","userId")};u.popoverCardsListView=new a(u);var d={"delegateTarget":this.$el,"cardViewOptions":u};0!==n.length&&l.ShowPopOver(d)}}})}),csui.define("hbs!workflow/controls/stepcards/impl/stepcard.empty",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="wfstatus-step-info">\r\n\r\n  <div class="wfstatus-step-header">\r\n    <div class="wfstatus-empty-message" title="'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"messages"):t)?l(s,"NoStepAvailable"):s,t))+'">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"messages"):t)?l(s,"NoStepAvailable"):s,t))+"</div>\r\n  </div>\r\n\r\n</div>\r\n\r\n\r\n"}});return i.registerPartial("workflow_controls_stepcards_impl_stepcard.empty",n),n}),csui.define("workflow/controls/stepcards/stepcard.empty.view",["csui/lib/underscore","csui/lib/marionette","i18n!workflow/controls/stepcards/nls/lang","hbs!workflow/controls/stepcards/impl/stepcard.empty","css!workflow/controls/stepcards/impl/stepcard"],function(e,t,i,n){"use strict";return t.ItemView.extend({"template":n,"className":"wfstatus-stepcard","templateHelpers":function(){return{"messages":{"NoStepAvailable":i.NoStepAvailable}}},"constructor":function(){t.ItemView.prototype.constructor.apply(this,arguments)}})}),csui.define("hbs!workflow/controls/stepcards/impl/stepcards",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="wfstatus-stepcards"></div>\r\n'}});return i.registerPartial("workflow_controls_stepcards_impl_stepcards",n),n}),csui.define("workflow/controls/stepcards/stepcards.view",["csui/lib/underscore","csui/lib/marionette","workflow/controls/stepcards/stepcard.view","workflow/controls/stepcards/stepcard.empty.view","hbs!workflow/controls/stepcards/impl/stepcards","css!workflow/controls/stepcards/impl/stepcard"],function(e,t,i,n,o){"use strict";return t.CompositeView.extend({"childView":i,"childViewOptions":function(){return{"context":this.options.context,"cellView":this.options.cellView,"wfStatusInfoModel":this.options.wfStatusInfoModel,"stepCardsListView":this.options.stepCardsListView,"stepType":this.options.stepType}},"emptyView":n,"className":"wfstatus-stepcards-view binf-col-md-12 binf-col-sm-9 binf-col-xs-12","template":o,"constructor":function(e){t.CompositeView.prototype.constructor.apply(this,arguments)}})}),csui.define("hbs!workflow/controls/stepcards/impl/stepcards.list",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="wfstatus-stepcard-list"></div>'}});return i.registerPartial("workflow_controls_stepcards_impl_stepcards.list",n),n}),csui.define("workflow/controls/stepcards/stepcards.list.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/models/nodes","csui/controls/tile/behaviors/perfect.scrolling.behavior","workflow/controls/stepcards/stepcard.view","workflow/controls/stepcards/stepcards.view","hbs!workflow/controls/stepcards/impl/stepcards.list","css!workflow/controls/stepcards/impl/stepcard"],function(e,t,i,n,o,s,l,a,r,c){"use strict";return o.LayoutView.extend({"childView":a,"className":"wfstatus-stepcard-layout","template":c,"tagName":"div","behaviors":{"PerfectScrolling":{"behaviorClass":l,"contentParent":".wfstatus-stepcard-list","scrollXMarginOffset":30,"suppressScrollX":!0,"scrollYMarginOffset":15}},"regions":{"stepcardLayout":".wfstatus-stepcard-list"},"events":{"click .wfstatus-stepcard":"makeStepCardActive"},"constructor":function(e){e=e||{},o.LayoutView.prototype.constructor.call(this,e)},"onRender":function(){var e,t;this.options.listViewMulCurrentSteps?(t=this.options.model.get("parallel_steps"),e="current"):(t=this.options.step_list,e=this.options.stepType),this.stepcollection=new s(t,{}),this.stepcardCollectionView=new r({"collection":this.stepcollection,"context":this.options.context,"cellView":this.options.cellView,"stepCardsListView":this,"wfStatusInfoModel":this.options.wfStatusInfoModel,"stepType":e}),this.stepcardLayout.show(this.stepcardCollectionView)},"makeDefaultStepCardActive":function(){t(".wfstatus-stepcard").eq(0).addClass("active"),t(".wfstatus-stepcard-layout .wfstatus-title-icon").eq(0).addClass("active")},"makeStepCardActive":function(i){if(t(".wfstatus-stepcard.active").length>0){t(".wfstatus-stepcard-layout .wfstatus-title-icon").eq(0).removeClass("active");var n=e("workflow/utils/workitem.util"),o={"stepCardsListView":this},s={"cardViewOptions":o};n.unbindPopover(s);var l=t(".wfstatus-stepcard.active").eq(0);t(l).removeClass("active")}t(i.currentTarget).addClass("active")}})}),csui.define("hbs!workflow/widgets/wfstatus/impl/wfstatusitem.body",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <span class="wfstatusitem-stopped-label">'+e.escapeExpression((s=null!=(s=l(i,"stoppedLabel")||(null!=t?l(t,"stoppedLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"stoppedLabel","hash":{},"loc":{"start":{"line":5,"column":47},"end":{"line":5,"column":63}}}):s))+' </span>\r\n      <span class="wfstatusitem-stopped-on-label">'+e.escapeExpression((s=null!=(s=l(i,"onLabel")||(null!=t?l(t,"onLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"onLabel","hash":{},"loc":{"start":{"line":6,"column":50},"end":{"line":6,"column":61}}}):s))+' </span>\r\n      <span class="wfstatusitem-stoppeddate">'+e.escapeExpression((s=null!=(s=l(i,"stoppedDate")||(null!=t?l(t,"stoppedDate"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"stoppedDate","hash":{},"loc":{"start":{"line":7,"column":45},"end":{"line":7,"column":60}}}):s))+"</span>\r\n"},"3":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"showDateHeader"):t,{"name":"if","hash":{},"fn":e.program(4,o,0),"inverse":e.noop,"loc":{"start":{"line":9,"column":6},"end":{"line":11,"column":13}}}))?s:""},"4":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <span class="wfstatusitem-date">'+e.escapeExpression((s=null!=(s=l(i,"startDate")||(null!=t?l(t,"startDate"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"startDate","hash":{},"loc":{"start":{"line":10,"column":40},"end":{"line":10,"column":53}}}):s))+" - "+e.escapeExpression((s=null!=(s=l(i,"endDate")||(null!=t?l(t,"endDate"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"endDate","hash":{},"loc":{"start":{"line":10,"column":56},"end":{"line":10,"column":67}}}):s))+"</span>\r\n"},"6":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return e.escapeExpression((s=null!=(s=l(i,"panelEndDate")||(null!=t?l(t,"panelEndDate"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"panelEndDate","hash":{},"loc":{"start":{"line":17,"column":23},"end":{"line":17,"column":39}}}):s))},"8":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="wfstatusitem-step-row-main">\r\n      <div class="wfstatusitem-step">\r\n        <div class="wfstatusitem-step-row">\r\n          <span class="wfstatusitem-step-left-label">  </span>\r\n          <div type="next" class="wfstatusitem-step-circle wfstatusitem-link\r\n      wfstatusitem-next-step-icon"></div>\r\n        </div>\r\n        <div class="wfstatusitem-bar"></div>\r\n      </div>\r\n      <span type="next" class="wfstatusitem-step-right-label wfstatusitem-next-step-label">\r\n        '+e.escapeExpression((s=null!=(s=l(i,"nextStepLabel")||(null!=t?l(t,"nextStepLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"nextStepLabel","hash":{},"loc":{"start":{"line":35,"column":8},"end":{"line":35,"column":25}}}):s))+'</span>\r\n    </div>\r\n    <div class="wfstatusitem-step-row-main">\r\n      <div class="wfstatusitem-step">\r\n        <div class="wfstatusitem-step-row">\r\n          <span class="wfstatusitem-step-left-label">'+e.escapeExpression((s=null!=(s=l(i,"currentStepDate")||(null!=t?l(t,"currentStepDate"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"currentStepDate","hash":{},"loc":{"start":{"line":40,"column":53},"end":{"line":40,"column":72}}}):s))+' </span>\r\n          <div type="current" class="wfstatusitem-step-circle wfstatusitem-link\r\n      wfstatusitem-current-step-icon"></div>\r\n        </div>\r\n        <div class="wfstatusitem-bar"></div>\r\n      </div>\r\n      <span type="current" class="wfstatusitem-step-right-label wfstatusitem-current-step-label">\r\n        '+e.escapeExpression((s=null!=(s=l(i,"currentStepLabel")||(null!=t?l(t,"currentStepLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"currentStepLabel","hash":{},"loc":{"start":{"line":47,"column":8},"end":{"line":47,"column":28}}}):s))+" </span>\r\n    </div>\r\n"},"10":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="wfstatusitem-step-row-main">\r\n      <div class="wfstatusitem-step">\r\n        <div class="wfstatusitem-step-row">\r\n          <span class="wfstatusitem-step-left-label"> </span>\r\n          <div type="stopped" class="wfstatusitem-step-circle wfstatusitem-link\r\n      wfstatusitem-stopped-step-icon"></div>\r\n        </div>\r\n        <div class="wfstatusitem-bar"></div>\r\n      </div>\r\n      <span type="stopped" class="wfstatusitem-step-right-label wfstatusitem-stopped-step-label">\r\n        '+e.escapeExpression((s=null!=(s=l(i,"stoppedStepLabel")||(null!=t?l(t,"stoppedStepLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"stoppedStepLabel","hash":{},"loc":{"start":{"line":62,"column":8},"end":{"line":62,"column":28}}}):s))+"</span>\r\n    </div>\r\n"},"12":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="wfstatusitem-step-row-main">\r\n      <div class="wfstatusitem-step">\r\n        <div class="wfstatusitem-step-row">\r\n          <span class="wfstatusitem-step-left-label"> </span>\r\n          <div type="completed" class="wfstatusitem-step-circle wfstatusitem-link\r\n      wfstatusitem-completed-step-icon"></div>\r\n        </div>\r\n        <div class="wfstatusitem-bar"></div>\r\n      </div>\r\n      <span type="completed"\r\n            class="wfstatusitem-step-right-label wfstatusitem-completed-step-label">\r\n        '+e.escapeExpression((s=null!=(s=l(i,"completedStepLabel")||(null!=t?l(t,"completedStepLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"completedStepLabel","hash":{},"loc":{"start":{"line":78,"column":8},"end":{"line":78,"column":30}}}):s))+"</span>\r\n    </div>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="wfstatusitem-progressbar">\r\n\r\n  <div class="wfstatusitem-date">\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"stoppedDate"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.program(3,o,0),"loc":{"start":{"line":4,"column":4},"end":{"line":12,"column":11}}}))?s:"")+'  </div>\r\n  <div class="wfstatusitem-step">\r\n    <div class="wfstatusitem-step-row">\r\n      <span class="wfstatusitem-step-left-label">'+(null!=(s=a(i,"unless").call(null!=t?t:e.nullContext||{},null!=t?a(t,"stoppedDate"):t,{"name":"unless","hash":{},"fn":e.program(6,o,0),"inverse":e.noop,"loc":{"start":{"line":16,"column":49},"end":{"line":17,"column":50}}}))?s:"")+'</span>\r\n      <div class="wfstatusitem-step-circle"></div>\r\n      <span class="wfstatusitem-step-right-label"> '+e.escapeExpression((l=null!=(l=a(i,"endLabel")||(null!=t?a(t,"endLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"endLabel","hash":{},"loc":{"start":{"line":19,"column":51},"end":{"line":19,"column":63}}}):l))+' </span>\r\n    </div>\r\n    <div class="wfstatusitem-bar"></div>\r\n  </div>\r\n\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"showCurrent"):t,{"name":"if","hash":{},"fn":e.program(8,o,0),"inverse":e.noop,"loc":{"start":{"line":24,"column":2},"end":{"line":49,"column":9}}}))?s:"")+"\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"showStopped"):t,{"name":"if","hash":{},"fn":e.program(10,o,0),"inverse":e.noop,"loc":{"start":{"line":51,"column":2},"end":{"line":64,"column":9}}}))?s:"")+"\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"showCompleted"):t,{"name":"if","hash":{},"fn":e.program(12,o,0),"inverse":e.noop,"loc":{"start":{"line":66,"column":2},"end":{"line":80,"column":9}}}))?s:"")+'\r\n  <div class="wfstatusitem-step">\r\n    <div class="wfstatusitem-step-row">\r\n      <span class="wfstatusitem-step-left-label"> '+e.escapeExpression((l=null!=(l=a(i,"startDate")||(null!=t?a(t,"startDate"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"startDate","hash":{},"loc":{"start":{"line":84,"column":50},"end":{"line":84,"column":63}}}):l))+' </span>\r\n      <div class="wfstatusitem-step-circle"></div>\r\n      <span class="wfstatusitem-step-right-label"> '+e.escapeExpression((l=null!=(l=a(i,"startLabel")||(null!=t?a(t,"startLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"startLabel","hash":{},"loc":{"start":{"line":86,"column":51},"end":{"line":86,"column":65}}}):l))+' </span>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n<div class="wfstatusitem-step-cards"></div>\r\n<div class="wfstatusitem-user-cards"></div>'}});return i.registerPartial("workflow_widgets_wfstatus_impl_wfstatusitem.body",n),n}),csui.define("workflow/widgets/wfstatus/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/widgets/wfstatus/impl/nls/root/lang",{"months":["January","February","March","April","May","June","July","August","September","October","November","December"],"dialogTitle":"Workflow Tracking","emptyListText":"There are no items to display","totalMsg":"Total","onTime":"On time","completed":"Completed","late":"Late","stopped":"Stopped","expandLabel":"Expand","stepDueDateLabel":"Step Due date","workflowDueDateLabel":"Workflow Due date","currentStepNameLabel":"Current step","assignedToLabel":"Assigned to","startDateLabel":"Start date","startedLabel":"Started","workflowIDLabel":"Workflow-ID","statusLabel":"Status","initiatorLabel":"Initiator","wfNameLabel":"Workflow name","NameLabel":"Name","allFilterLabel":"All","completedFilterLabel":"Completed","stoppedFilterLabel":"Stopped","lateFilterLabel":"Late","ontimeFilterLabel":"On Time","headerFilterTitle":"Refine by","headerFilterLabel":"Show items with status","days":"days","day":"day","statusOnLabel":"on","dueInLabel":"due in","dueLabel":"due","todayLabel":"today","details":"Details","attachments":"Attachments","startLabel":"Start","endLabel":"End","currentStepLabel":"Current Step","nextStepLabel":"Next Step","stoppedStepLabel":"Stopped","completedStepLabel":"Completed Step","currentStepsLabel":"Current Steps","completedStepsLabel":"Completed Steps","workflowStopDialogMessage":"Are you sure you want to stop? A stopped Workflow cannot be resumed.","workflowStopDialogTitle":"Stop Workflow","stoppedWorkflowMessage":"One Workflow has been stopped.","stopActionLabel":"Stop","deleteActionLabel":"Delete","deleteWorkflowDialogTitle":"Delete Workflow","deleteWorkflowDialogMessage":"Are you sure you want to delete? This Workflow will be permanently deleted.","deletedWorkflowMessage":"One Workflow has been deleted.","backgroundStepText":"System Monitored","systemUserText":"System","multipleUserText":"Multiple Users"}),
csui.define("css!workflow/widgets/wfstatus/impl/wfstatus.progress",[],function(){}),csui.define("workflow/widgets/wfstatus/impl/wfstatusitem.body.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","workflow/controls/stepcards/stepcards.list.view","hbs!workflow/widgets/wfstatus/impl/wfstatusitem.body","i18n!workflow/widgets/wfstatus/impl/nls/lang","css!workflow/widgets/wfstatus/impl/wfstatus.progress"],function(e,t,i,n,o,s,l){"use strict";return n.LayoutView.extend({"template":s,"className":"wfstatusitem-content","constructor":function(e){this.options=e,this.model=e.model,this.defaults={"currentStepPosition":191},t(window).on("resize.app",this.adjustStepCardPosition),n.LayoutView.prototype.constructor.call(this,e)},"ui":{"nodeIcon":".wfstatusitem-step-circle","nodeLabel":".wfstatusitem-step-right-label","currentStepIcon":".wfstatusitem-current-step-icon","completedStepIcon":".wfstatusitem-completed-step-icon","stoppedStepIcon":".wfstatusitem-stopped-step-icon","nextStepIcon":".wfstatusitem-next-step-icon","currentStepLabel":".wfstatusitem-current-step-label","completedStepLabel":".wfstatusitem-completed-step-label","stoppedStepLabel":".wfstatusitem-stopped-step-label","nextStepLabel":".wfstatusitem-next-step-label","stepCard":".wfstatus-step-info"},"events":{"click @ui.currentStepIcon, @ui.currentStepLabel,@ui.completedStepIcon,@ui.completedStepLabel, @ui.nextStepIcon, @ui.nextStepLabel, @ui.stoppedStepLabel, @ui.stoppedStepIcon":"onClickStep"},"regions":{"progressbar":".wfstatusitem-progressbar","stepcards":".wfstatusitem-step-cards"},"templateHelpers":function(){var t=e("workflow/utils/workitem.util"),i=this.model.get("details"),n=i.date_initiated&&i.end_date,o=this.model.get("step_list"),s=o&&o.current,a=o&&o.completed,r=o&&o.stopped,c=s&&s.length>=1?t.dateConversion(s[0].task_start_date,"Month DD"):"",u=i.stoppedDate?t.dateConversion(i.stoppedDate):"",d=n?this.getDateHeader(i.start_date,i.end_date):"";return{"startLabel":l.startLabel,"endLabel":l.endLabel,"currentStepLabel":s&&s.length>1?l.currentStepsLabel:l.currentStepLabel,"nextStepLabel":l.nextStepLabel,"stoppedStepLabel":l.stoppedStepLabel,"completedStepLabel":a&&a.length>1?l.completedStepsLabel:l.completedStepLabel,"wfName":i.wf_name,"startDate":d?d.startDate:"","panelStartDate":i.date_initiated,"currentStepDate":c,"endDate":d?d.endDate:"","panelEndDate":""===i.end_date?"":t.dateConversion(i.end_date,"Month DD"),"dueDate":i.due_date,"status":i.status_key,"assignee":i.assignee,"userId":i.userId,"showDateHeader":n,"showCompleted":!(!a||0===a.length),"showStopped":!(!r||0===r.length),"showCurrent":!(!s||0===s.length),"stoppedDate":u,"stoppedLabel":l.stopped,"onLabel":l.statusOnLabel}},"getDateHeader":function(t,i){var n=new Date(t),o=new Date(i),s=e("workflow/utils/workitem.util"),l={};return l.endDate=s.dateConversion(i),n.getFullYear()===o.getFullYear()?l.startDate=s.dateConversion(t,"Month DD"):l.startDate=s.dateConversion(t),l},"onClickStep":function(i){e("workflow/utils/workitem.util").unbindPopover(),this.removeFocusIcons();var n,s,l,a,r,c=i&&i.currentTarget?i.currentTarget.getAttribute("type"):i;if(this.currentAction=c,c){switch(c){case"current":this.showArrow(this.ui.currentStepIcon,this.ui.currentStepLabel),n=this.ui.currentStepLabel.position();break;case"completed":this.showArrow(this.ui.completedStepIcon,this.ui.completedStepLabel),n=this.ui.completedStepLabel.position();break;case"stopped":this.showArrow(this.ui.stoppedStepIcon,this.ui.stoppedStepLabel),n=this.ui.stoppedStepLabel.position();break;case"next":this.showArrow(this.ui.nextStepIcon,this.ui.nextStepLabel),n=this.ui.nextStepLabel.position()}l=this.model.get("step_list")[c],a={"step_list":l,"context":this.options.context,"cellView":this.options.cellView,"wfStatusInfoModel":this.model,"stepType":c},this.stepcardsListView=new o(a),this.stepcards.show(this.stepcardsListView),s=n.top,r=t(".wfstatus-stepcard").height(),s=0!==s?s-r/2+14:this.defaults.currentStepPosition,t(".wfstatusitem-step-cards").css({"top":s}),t(".wfstatus-stepcard").addClass("progress-panel");var u=s/16+13;t(".wfstatus-stepcard-list").css({"height":"calc(100vh - "+u+"rem)"}),this.stepcardsListView.makeDefaultStepCardActive()}},"adjustStepCardPosition":function(e){var i=t(t(".wfstatusitem-body"))[0].offsetHeight;"object"==typeof e&&(e=t(".wfstatusitem-bar").length),t(".wfstatusitem-progressbar .wfstatusitem-bar").css({"height":(i-250)/e}),t(".wfstatusitem-step-cards").css({"top":t(".wfstatusitem-focus-arrow")[0].offsetTop-38.5}),t(".wfstatus-progress-view").css({"opacity":"1"});var n=t(".wfstatusitem-focus-arrow")[0].offsetTop-30,o=n/16+11.85;t(".wfstatus-stepcard-list").css({"height":"calc(100vh - "+o+"rem)"})},"removeFocusIcons":function(){this.stepcardsListView&&this.stepcardsListView.destroy(),this.ui.nodeIcon.removeClass("wfstatusitem-focus-icon"),this.ui.nodeLabel.removeClass("wfstatusitem-focus-arrow")},"showArrow":function(e,t){e&&t&&(e.addClass("wfstatusitem-focus-icon"),t.addClass("wfstatusitem-focus-arrow"))}})}),csui.define("workflow/models/wfstatus/tabpanel.model",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone"],function(e,t,i){"use strict";var n=i.Model.extend({"constructor":function(e,t){i.Model.prototype.constructor.apply(this,arguments)}});return i.Collection.extend({"model":n,"constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments)}})}),csui.define("workflow/widgets/wfstatus/impl/wfstatusitem.tabpanel.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/contexts/factories/node","csui/controls/tab.panel/tab.panel.view","csui/controls/tab.panel/tab.links.ext.view","csui/controls/tab.panel/tab.links.ext.scroll.mixin"],function(e,t,i,n,o,s,l,a,r){"use strict";var c=l.extend({"contentView":function(e){return e.get("viewToRender")},"contentViewOptions":function(e){return e.get("viewToRenderOptions")},"constructor":function(t){e.defaults(t,{"tabType":"binf-nav-pills","delayTabContent":!1,"toolbar":!0,"TabLinkCollectionViewClass":a}),l.prototype.constructor.apply(this,arguments)},"render":function(){return l.prototype.render.apply(this),this._initializeToolbars(),this._listenToTabEvent(),setTimeout(e.bind(this._enableToolbarState,this),500),this}});return e.extend(c.prototype,r),c}),csui.define("hbs!workflow/widgets/wfstatus/impl/wfstatusitem.details",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){return" wfstatusitem-action-show "},"3":function(e,t,i,n,o){return" wfstatusitem-action-hide"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<div class='wfstatusitem-details "+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"permAction"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.program(3,o,0),"loc":{"start":{"line":1,"column":33},"end":{"line":1,"column":117}}}))?s:"")+'\'>\r\n\r\n  <div class="wfstatusitem-details-rec">\r\n    <div class="wfstatusitem-details-field wfstatusitem-details-label">'+e.escapeExpression((l=null!=(l=a(i,"NameLabel")||(null!=t?a(t,"NameLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"NameLabel","hash":{},"loc":{"start":{"line":4,"column":71},"end":{"line":4,"column":84}}}):l))+'</div>\r\n    <div class="wfstatusitem-details-field wfstatusitem-details-value"\r\n         title="'+e.escapeExpression((l=null!=(l=a(i,"wfName")||(null!=t?a(t,"wfName"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"wfName","hash":{},"loc":{"start":{"line":6,"column":16},"end":{"line":6,"column":26}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"wfName")||(null!=t?a(t,"wfName"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"wfName","hash":{},"loc":{"start":{"line":6,"column":28},"end":{"line":6,"column":38}}}):l))+'</div>\r\n  </div>\r\n\r\n  <div class="wfstatusitem-details-rec">\r\n    <div class="wfstatusitem-details-field wfstatusitem-details-label">'+e.escapeExpression((l=null!=(l=a(i,"dueDateLabel")||(null!=t?a(t,"dueDateLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"dueDateLabel","hash":{},"loc":{"start":{"line":10,"column":71},"end":{"line":10,"column":87}}}):l))+'</div>\r\n    <div class="wfstatusitem-details-field wfstatusitem-details-value"\r\n         title="'+e.escapeExpression((l=null!=(l=a(i,"dueDate")||(null!=t?a(t,"dueDate"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"dueDate","hash":{},"loc":{"start":{"line":12,"column":16},"end":{"line":12,"column":27}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"dueDate")||(null!=t?a(t,"dueDate"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"dueDate","hash":{},"loc":{"start":{"line":12,"column":29},"end":{"line":12,"column":40}}}):l))+'</div>\r\n  </div>\r\n\r\n  <div class="wfstatusitem-details-rec">\r\n    <div class="wfstatusitem-details-field wfstatusitem-details-label">'+e.escapeExpression((l=null!=(l=a(i,"statusLabel")||(null!=t?a(t,"statusLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"statusLabel","hash":{},"loc":{"start":{"line":16,"column":71},"end":{"line":16,"column":86}}}):l))+'</div>\r\n    <div class="wfstatusitem-details-field wfstatusitem-details-value"\r\n         title="'+e.escapeExpression((l=null!=(l=a(i,"status")||(null!=t?a(t,"status"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"status","hash":{},"loc":{"start":{"line":18,"column":16},"end":{"line":18,"column":26}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"status")||(null!=t?a(t,"status"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"status","hash":{},"loc":{"start":{"line":18,"column":28},"end":{"line":18,"column":38}}}):l))+'</div>\r\n  </div>\r\n\r\n  <div class="wfstatusitem-details-rec">\r\n    <div class="wfstatusitem-details-field wfstatusitem-details-label">'+e.escapeExpression((l=null!=(l=a(i,"initiatorLabel")||(null!=t?a(t,"initiatorLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"initiatorLabel","hash":{},"loc":{"start":{"line":22,"column":71},"end":{"line":22,"column":89}}}):l))+'</div>\r\n    <div class="wfstatusitem-details-field wfstatusitem-details-value" title="'+e.escapeExpression((l=null!=(l=a(i,"initiator")||(null!=t?a(t,"initiator"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"initiator","hash":{},"loc":{"start":{"line":23,"column":78},"end":{"line":23,"column":91}}}):l))+'">\r\n      <span class="wfstatusitem-mini-profile-avatar">\r\n         <span class="wfstatus-mini-profile-pic">\r\n             <div class="image_user_placeholder wfstatusitem-userprofile-default-avatar binf-hidden"\r\n                  title="'+e.escapeExpression((l=null!=(l=a(i,"initiator")||(null!=t?a(t,"initiator"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"initiator","hash":{},"loc":{"start":{"line":27,"column":25},"end":{"line":27,"column":38}}}):l))+'"></div>\r\n             <img id="wfstatusitem-mini-profile-pic-'+e.escapeExpression((l=null!=(l=a(i,"userId")||(null!=t?a(t,"userId"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"userId","hash":{},"loc":{"start":{"line":28,"column":52},"end":{"line":28,"column":62}}}):l))+'" class="wfstatusitem-userprofile-img\r\n             binf-img-circle-show binf-hidden">\r\n             <span class="wfstatusitem-profile-textname">'+e.escapeExpression((l=null!=(l=a(i,"initiator")||(null!=t?a(t,"initiator"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"initiator","hash":{},"loc":{"start":{"line":30,"column":57},"end":{"line":30,"column":70}}}):l))+'</span>\r\n         </span>\r\n      </span>\r\n    </div>\r\n  </div>\r\n\r\n  <div class="wfstatusitem-details-rec">\r\n    <div class="wfstatusitem-details-field wfstatusitem-details-label">'+e.escapeExpression((l=null!=(l=a(i,"startedLabel")||(null!=t?a(t,"startedLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"startedLabel","hash":{},"loc":{"start":{"line":37,"column":71},"end":{"line":37,"column":87}}}):l))+'</div>\r\n    <div class="wfstatusitem-details-field wfstatusitem-details-value"\r\n         title="'+e.escapeExpression((l=null!=(l=a(i,"startDate")||(null!=t?a(t,"startDate"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"startDate","hash":{},"loc":{"start":{"line":39,"column":16},"end":{"line":39,"column":29}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"startDate")||(null!=t?a(t,"startDate"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"startDate","hash":{},"loc":{"start":{"line":39,"column":31},"end":{"line":39,"column":44}}}):l))+'</div>\r\n  </div>\r\n  <div class="wfstatusitem-details-rec">\r\n    <div class="wfstatusitem-details-field wfstatusitem-details-label">'+e.escapeExpression((l=null!=(l=a(i,"workflowIDLabel")||(null!=t?a(t,"workflowIDLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"workflowIDLabel","hash":{},"loc":{"start":{"line":42,"column":71},"end":{"line":42,"column":90}}}):l))+'</div>\r\n    <div class="wfstatusitem-details-field wfstatusitem-details-value"\r\n         title="'+e.escapeExpression((l=null!=(l=a(i,"workflowID")||(null!=t?a(t,"workflowID"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"workflowID","hash":{},"loc":{"start":{"line":44,"column":16},"end":{"line":44,"column":30}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"workflowID")||(null!=t?a(t,"workflowID"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"workflowID","hash":{},"loc":{"start":{"line":44,"column":32},"end":{"line":44,"column":46}}}):l))+"</div>\r\n  </div>\r\n</div>\r\n"}});return i.registerPartial("workflow_widgets_wfstatus_impl_wfstatusitem.details",n),n}),csui.define("workflow/widgets/wfstatus/impl/wfstatusitem.details.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/url","csui/utils/user.avatar.color","workflow/models/wfstatus/usercard.model","hbs!workflow/widgets/wfstatus/impl/wfstatusitem.details","i18n!workflow/widgets/wfstatus/impl/nls/lang"],function(e,t,i,n,o,s,l,a,r){"use strict";return n.LayoutView.extend({"template":a,"ui":{"userIcon":".wfstatusitem-userprofile-img","defaultUserIcon":".wfstatusitem-userprofile-default-avatar"},"constructor":function(i){n.LayoutView.prototype.constructor.call(this,arguments),this.model=i.model,this.details=i.model.get("details"),this.photoUrl=null;var o=this;this.details.userId&&new l({"userId":this.details.userId,"connector":this.model.connector}).fetch().done(function(i){var n=e("workflow/utils/workitem.util"),l=i.results.data.properties,a=t("#wfstatusitem-mini-profile-pic-"+l.id);if(null===l.photo_url){var r=o.ui.defaultUserIcon;r.text(l.initials),r.attr("style","background: "+s.getUserAvatarColor(l)),r.removeClass("binf-hidden")}else o.model.set("photo_url",l.photo_url),n.showProfilePic(o.model).done(function(e){var t=URL.createObjectURL(e);o.ui.userIcon.removeClass("binf-hidden"),a.attr("src",t)}).fail(function(){o.ui.userIcon.addClass("binf-hidden")})})},"templateHelpers":function(){var e=this.details,t=this.model.get("hasPermision");return{"NameLabel":r.NameLabel,"dueDateLabel":r.workflowDueDateLabel,"statusLabel":r.statusLabel,"initiatorLabel":r.initiatorLabel,"startedLabel":r.startedLabel,"workflowIDLabel":r.workflowIDLabel,"wfName":e.wf_name,"startDate":e.date_initiated,"dueDate":e.due_date,"status":e.status_key,"initiator":e.initiator,"userId":e.userId,"workflowID":e.work_workID,"permAction":t}}})}),csui.define("hbs!workflow/widgets/wfstatus/impl/wfstatusitem.attachments",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){return"  wfstatusitem-action-show "},"3":function(e,t,i,n,o){return"  wfstatusitem-action-hide "},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<div class='wfstatusitem-attachments "+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"permAction"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.program(3,o,0),"loc":{"start":{"line":1,"column":37},"end":{"line":1,"column":124}}}))?s:"")+"'></div>"}});return i.registerPartial("workflow_widgets_wfstatus_impl_wfstatusitem.attachments",n),n}),csui.define("workflow/widgets/wfstatus/impl/wfstatusitem.attachments.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/models/nodechildren","csui/controls/globalmessage/globalmessage","csui/utils/contexts/factories/node","csui/controls/progressblocker/blocker","csui/controls/tile/behaviors/perfect.scrolling.behavior","workflow/widgets/workitem/workitem.attachments/impl/workitem.attachmentlist.view","i18n!workflow/widgets/wfstatus/impl/nls/lang","i18n!workflow/widgets/workitem/workitem.attachments/impl/nls/lang","hbs!workflow/widgets/wfstatus/impl/wfstatusitem.attachments","css!workflow/widgets/wfstatus/impl/wfstatus.progress"],function(e,t,i,n,o,s,l,a,r,c,u,d){"use strict";return i.LayoutView.extend({"template":d,"ui":{"wfAttachments":".wfstatusitem-attachments"},"regions":{"attachmentsRegion":".wfstatusitem-attachments"},"constructor":function(e){this.options=e||{},i.LayoutView.prototype.constructor.call(this,e),this.model=e.model?e.model:{}},"templateHelpers":function(){return{"permAction":this.model.get("hasPermision")}},"behaviors":{"ScrollingInstructions":{"behaviorClass":a,"contentParent":".wfstatusitem-attachments","suppressScrollX":!0}},"onRender":function(){l.imbue(this),this.blockActions(),this.model.set("isWFStatusItemAttachment",!0),this.renderAttachments()},"renderAttachments":function(){var i=this.model.get("attachments"),l=this.options.context.getModel(s,{"attributes":{"id":i.attachment_folder_id}});this.attachmentCollection=new n(void 0,{"node":l,"includeActions":!1,"delayRestCommands":!0,"expand":["node"],"commands":["default","open"]}),this.attachmentCollection.fetch().done(t.bind(function(){if(this.attachmentCollection.length>0){var i=this.attachmentCollection.length;e("li").has('a[title="Attachments"]').append("<span class='cs-tablink-text'>"+i+"</span>"),this.attachments=new r({"context":this.options.context,"collection":this.attachmentCollection,"view":this}),this.attachments.wfstatus=!0,this.attachments.render(),this.attachmentCollection.delayedActions.fetch().done(t.bind(function(){this.attachmentsRegion.show(this.attachments)},this))}},this)).fail(t.bind(function(){o.showMessage("error",u.ErrorMessageLoadAttachments)},this)).always(t.bind(function(){this.unblockActions()},this))}})}),csui.define("workflow/models/wfstatus/wfstatusinfo.model",["csui/lib/jquery","csui/lib/backbone","csui/lib/underscore","csui/utils/url","csui/models/node/node.model"],function(e,t,i,n,o){"use strict";return t.Model.extend({"constructor":function(e,i){t.Model.prototype.constructor.apply(this,arguments),i&&i.connector&&i.connector.assignTo(this)},"url":function(){var e=this.connector.connection.url.replace("/v1","/v2"),t=n.combine(e,"workflows/status");return t+="/processes/"+this.get("process_id")},"parse":function(e){return e.results},"stopWorkflow":function(t){var i=this.connector.connection.url.replace("/v1","/v2"),o=n.combine(i,"workflows","actions"),s=new FormData,l={"process_id":t.process_id,"subprocess_id":t.subprocess_id,"action":t.action},a=e.Deferred();s.append("body",JSON.stringify(l));var r={"type":"POST","url":o,"data":s,"contentType":!1,"processData":!1};return this.connector&&this.connector.extendAjaxOptions(r),e.ajax(r).done(function(e){a.resolve(e)}).fail(function(e){var t="";e.responseText&&(t=JSON.parse(e.responseText)),a.reject(t)}),a},"deleteWorkflow":function(t){var i=this,o=i.connector,s=o.connection.url.replace("/v1","/v2"),l=n.combine(s,"processes",t),a=e.Deferred(),r={"type":"DELETE","url":l,"contentType":!1,"processData":!1};return o&&o.extendAjaxOptions(r),e.ajax(r).done(function(e){a.resolve(e)}).fail(function(e){var t="";e.responseText&&(t=JSON.parse(e.responseText)),a.reject(t)}),a},"reset":function(e){this.clear(e),i.isUndefined(this.wfStatusInfo)||this.wfStatusInfo.reset()},"isFetchable":function(){return!0}})}),csui.define("workflow/models/wfstatus/wfstatusinfo.model.factory",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","workflow/models/wfstatus/wfstatusinfo.model"],function(e,t,i,n,o,s){"use strict";return n.extend({"propertyPrefix":"wfstatusinfo","constructor":function(e,t){n.prototype.constructor.apply(this,arguments);var i=e.getObject(o,t);this.context=e,this.property=new s(t,{"connector":i})},"isFetchable":function(){return this.property.isFetchable()},"fetch":function(e){return this.property.fetch(e)}})}),csui.define("workflow/utils/wfstatus.extension.controller",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/log"],function(e,t,i,n){"use strict";function o(e){this.context=e.context}return e.extend(o.prototype,{"initialize":function(){},"validate":function(e,t){return!1},"execute":function(e){var i=t.Deferred();return i.resolve(),i.promise()},"executeAction":function(e){var i=t.Deferred();return i.resolve(),i.promise()},"customizeFooter":function(e){var i=t.Deferred();return i.resolve(),i.promise()}}),o.extend=i.Model.extend,o.ExtensionPoints={"AddSidebar":1},o}),csui.define("hbs!workflow/widgets/wfstatus/impl/wfstatus.progress",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="cs-dialog binf-modal-footer binf-col-md-3 binf-col-sm-3 binf-hidden-xs ">\r\n    <button class="binf-btn binf-btn-primary wfstatusitem-'+e.escapeExpression((s=null!=(s=l(i,"wfstatusAction")||(null!=t?l(t,"wfstatusAction"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"wfstatusAction","hash":{},"loc":{"start":{"line":6,"column":58},"end":{"line":6,"column":76}}}):s))+'-btn"\r\n            title="'+e.escapeExpression((s=null!=(s=l(i,"wfstatusActionLabel")||(null!=t?l(t,"wfstatusActionLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"wfstatusActionLabel","hash":{},"loc":{"start":{"line":7,"column":19},"end":{"line":7,"column":42}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"wfstatusActionLabel")||(null!=t?l(t,"wfstatusActionLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"wfstatusActionLabel","hash":{},"loc":{"start":{"line":7,"column":44},"end":{"line":7,"column":67}}}):s))+"</button>\r\n  </div>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="wfstatusitem-progress-panel">\r\n  <div class="wfstatusitem-body binf-col-md-9 binf-col-sm-9 binf-col-xs-12"></div>\r\n  <div class="wfstatusitem-tabpanel binf-col-md-3 binf-col-sm-3 binf-hidden-xs"></div>\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"permAction"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":4,"column":2},"end":{"line":9,"column":9}}}))?s:"")+"</div>"}});return i.registerPartial("workflow_widgets_wfstatus_impl_wfstatus.progress",n),n}),csui.define("workflow/widgets/wfstatus/impl/wfstatus.progress.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/dialogs/modal.alert/modal.alert","csui/controls/globalmessage/globalmessage","csui/controls/progressblocker/blocker","workflow/widgets/wfstatus/impl/wfstatusitem.body.view","workflow/models/wfstatus/tabpanel.model","workflow/widgets/wfstatus/impl/wfstatusitem.tabpanel.view","workflow/widgets/wfstatus/impl/wfstatusitem.details.view","workflow/widgets/wfstatus/impl/wfstatusitem.attachments.view","workflow/models/wfstatus/wfstatusinfo.model.factory","workflow/utils/wfstatus.extension.controller","hbs!workflow/widgets/wfstatus/impl/wfstatus.progress","i18n!workflow/widgets/wfstatus/impl/nls/lang","csui-ext!workflow/widgets/wfstatus/impl/wfstatus.progress.view","css!workflow/widgets/wfstatus/impl/wfstatus.progress"],function(e,t,i,n,o,s,l,a,r,c,u,d,p,m,h,f,w,g){"use strict";return o.LayoutView.extend({"className":"wfstatus-progress-view","template":f,"regions":{"body":".wfstatusitem-body","tabPanel":".wfstatusitem-tabpanel"},"events":{"click .wfstatusitem-body, .wfstatusitem-tabpanel":"destroyUserCardPopovers","click .wfstatusitem-stop-btn":"stopWorkflow","click .wfstatusitem-delete-btn":"deleteWorkflow"},"constructor":function(n){var s=e("workflow/utils/workitem.util"),a=n.model,r=a.get("process_id")?a.get("process_id"):0,u=a.get("subprocess_id")?a.get("subprocess_id"):0,f=a.get("task_id")?a.get("task_id"):0,b=n.context.getModel(m);this.utils=s,b.set({"process_id":r,"subprocess_id":u,"task_id":f}),this.dataFetched=!1;var v=g;n.viewExtensions&&(v=n.viewExtensions),this.extensions=i.chain(v).flatten(!0).map(function(e){return new e(n)}).value(),b.fetch().done(i.bind(function(){this.dataFetched=!0;var e=b.get("wf_details"),n=e.initiator.firstName+" "+e.initiator.lastName,o=e.initiator.loginName,a=e.due_date,r=e.date_initiated,u=e.stopped_date,m=s.formatStatus({"dueDate":a,"status":e.status}),f=e.work_workID,g={"wf_name":e.wf_name,"due_date":a?s.dateConversion(a):"","status_key":m.status,"initiator":" "===n?o:n,"date_initiated":r?s.dateConversion(r):"","userId":e.initiator.userId,"end_date":a,"start_date":r,"work_workID":f,"stoppedDate":u,"wfStatusKey":e.status},v=b.get("permissions");b.set("details",g),this.model=b,this.viewOptions={"model":this.model,"context":this.options.context,"cellView":this.options.cellView},this.tabpanelCollection=new c([{"title":w.details,"viewToRender":d,"viewToRenderOptions":this.viewOptions,"id":i.uniqueId("wfstatusitem-tab")}]),v&&v.SeeDetail&&!i.isEmpty(this.model.get("attachments"))&&this.tabpanelCollection.add({"title":w.attachments,"viewToRender":p,"viewToRenderOptions":this.viewOptions,"id":i.uniqueId("wfstatusitem-tab")});var k=this.model.get("data_packages"),y=[];i.each(k,function(e){var n=t.Deferred();y.push(n.promise());var o=i.find(this.extensions,function(t){return t.validate(e.TYPE,e.SUBTYPE)});o?o.execute({"extensionPoint":h.ExtensionPoints.AddSidebar,"model":this.model,"data":e.data,"parentView":this}).done(i.bind(function(t){t&&(t.type=e.type,t.sub_type=e.sub_type,t.viewToRender&&this.tabpanelCollection.add(i.extend(t,{"id":i.uniqueId("workflow-tab")}))),n.resolve()},this)).fail(i.bind(function(e){var t=w.ErrorMessageLoadExtension;e&&e.errorMsg&&e.errorMsg.length>0&&(t=e.errorMsg),l.showMessage("error",t),n.resolve()},this)):n.resolve()},this),this.render()},this)),o.LayoutView.prototype.constructor.apply(this,arguments)},"templateHelpers":function(){if(this.model.get("details")){var e,t,i,n=this.model,o=n.get("details").wfStatusKey,s=this.model.get("permissions");return!o||"stopped"!==o&&"completed"!==o?s.Stop&&(e="stop",t=w.stopActionLabel):s.Delete&&(e="delete",t=w.deleteActionLabel),i=!!e,this.model.set({"hasPermision":i,"hasReassignAction":s.ChangeAttr},{"silent":!0}),{"wfstatusAction":e,"wfstatusActionLabel":t,"permAction":i}}},"onRender":function(){this.dataFetched&&(this._renderBody(),this._renderTabPanel()),a.imbue(this)},"destroyUserCardPopovers":function(i){if(t(".wfstatus-popover").length>0){e("workflow/utils/workitem.util").unbindPopover()}},"stopWorkflow":function(){var e=this,t={"centerVertically":!0,"buttons":s.buttons.OkCancel};s.confirmQuestion(w.workflowStopDialogMessage,w.workflowStopDialogTitle,t).always(function(t){t&&(e.blockActions(),e._acceptStopWorkflow())})},"_acceptStopWorkflow":function(){var e=this,t={"process_id":this.model.get("process_id"),"subprocess_id":this.model.get("process_id"),"action":"stop"};this.model.stopWorkflow(t).done(function(t){var i=t.results;e._updateProgressPanel(i),l.showMessage("success",w.stoppedWorkflowMessage)}).fail(function(e){var t;t=e.errorDetail?e.errorDetail:e.error,s.showError(t)}).always(i.bind(function(){this.unblockActions()},this))},"_updateProgressPanel":function(e){var t=e.wf_details,n=this.utils.formatStatus({"status":t.status});this.model.set({"attachments":e.attachments,"step_list":e.step_list,"wf_details":t}),i.extend(this.model.get("details"),{"status_key":n.status,"workflowStopped":!0,"stoppedDate":t.stopped_date,"wfStatusKey":t.status}),this.render()},"updateWfstatusViews":function(e){var t,i,n=this,o=n.options.cellView.model,s=o.collection.wfstatus;t=s||n.wfstatusModel,t.fetch().done(function(e){n.utils.progressDialog.trigger("destroy",function(){i=n.options.cellView.options.tableView.options.originatingView.options.extendedView,i.render()})})},"deleteWorkflow":function(e){var t=this,i={"centerVertically":!0,"buttons":s.buttons.OkCancel};s.confirmQuestion(w.deleteWorkflowDialogMessage,w.deleteWorkflowDialogTitle,i).always(function(e){e&&(t.blockActions(),t._onDeleteWorkflow())})},"_onDeleteWorkflow":function(){var e=this,t=e.model;t.deleteWorkflow(t.get("process_id")).done(function(t){e.updateWfstatusViews(),l.showMessage("success",w.deletedWorkflowMessage)}).fail(function(t){var i;i=t.errorDetail&&"ErrCode_Accept_Task"===t.errorDetail?w.MemberAcceptErrorDescription:t.error,s.showWarning(i,w.MemberAcceptErrorTitle).always(function(){e._leaveWorkitemPerspective()})}).always(function(){e.unblockActions()})},"onDomRefresh":function(){if(t(".wfstatusitem-bar").length>0&&t(".wfstatus-progress-view")[0].offsetHeight>0){var e,i=this.model.get("step_list"),n=i&&i.current?i.current.length:0,o=i&&i.stopped?i.stopped.length:0,s=i&&i.completed?i.completed.length:0,l="current";0===n&&0===o?(e=2,l="completed"):0!==o?(l="stopped",e=0===s?2:3):e=0===s?3:4,this.body.currentView.onClickStep(l),this.body.currentView.adjustStepCardPosition(e)}},"_renderBody":function(){this.body.show(new r(this.viewOptions))},"_renderTabPanel":function(){if(this.tabpanelCollection.models.length>0){var e=new u({"collection":this.tabpanelCollection});this.tabPanel.show(e)}},"onBeforeDestroy":function(){t(window).off("resize.app"),this.model.reset(),e("workflow/utils/workitem.util").unbindPopover()}})}),csui.define("workflow/utils/workitem.util",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url","csui/utils/log","csui/utils/commands/open.node.perspective","csui/models/nodes","csui/utils/commandhelper","csui/utils/contexts/factories/node","csui/controls/dialog/dialog.view","workflow/widgets/wfstatus/impl/wfstatus.progress.view","workflow/controls/popover/popover.view","i18n!workflow/widgets/wfstatus/impl/nls/lang"],function(e,t,i,n,o,s,l,a,r,c,u,d,p){"use strict";return{"constants":{"WFSTATUS_ONTIME":"ontime","WFSTATUS_COMPLETED":"completed","WFSTATUS_LATE":"workflowlate","WFSTATUS_STOPPED":"stopped","URI_DELIMITER":":","AT_SIGN_SYMBOL":"@","URI_PREFIX":"sip"},"dateConversion":function(e,t){var i,n=new Date(e);switch(t){case"Month DD":i=p.months[n.getMonth()]+" "+n.getDate();break;default:i=p.months[n.getMonth()]+" "+n.getDate()+", "+n.getFullYear()}return i},"getAssignee":function(e){var t=e.assignees,i="",n="";return t&&t.length>1?(n=(t[0].firstName+" "+t[0].lastName).trim(),
""!==n?i=e.isWfstatusAssigneeColumn||e.isReassign?n:p.multipleUserText+" ("+t.length+")":e.assignedto&&(i=e.isWfstatusAssigneeColumn||e.isReassign?e.assignedto.groupName:p.multipleUserText+" ("+t.length+")")):1===t.length&&(e.assignedto&&""!==e.assignedto.groupName?(n=(t[0].firstName+" "+t[0].lastName).trim(),i=""!==n?n:e.assignedto.groupName):(i=(t[0].firstName+" "+t[0].lastName).trim(),i=""===i?t[0].loginName:i)),i},"displayWfstatusItemProgresspanel":function(e){this.unbindPopover(),this.progressDialog=new c,this.progressDialog.options.title=e.model.get("wf_name"),this.progressDialog.options.iconRight="wfstatusitem-no-icon-right",this.progressDialog.options.iconLeft="title-icon mime_workflow_status",this.progressDialog.options.className="wfstatus-progress-view-dialog",this.progressDialog.options.actionIconLeft="arrow_back wfstatus-progress-view-dialog-back",this.progressDialog.options.largeSize=!0,this.progressDialog.options.view=new u(e),this.progressDialog.show();var i=this;this.progressDialog.$el.find(".binf-modal-content").addClass("wfstatus-model-content"),this.progressDialog.listenTo(this.progressDialog,"destroy",function(e){e&&e()}),t(".wfstatus-progress-view-dialog-back").attr("tabindex","0").on("click",function(){var t=i.progressDialog.options.view,n=t.model.get("details");n&&n.workflowStopped?(e.progressDialog=i.progressDialog,t.updateWfstatusViews(e)):(t.destroy(),i.progressDialog.remove())}),t(window).off("resize.app"),t(".wfstatusitem-no-icon-right").hide()},"unbindPopover":function(e){e&&t(e.delegateTarget).css("overflow",""),t("[id*=wfstatus-popover-mask]").remove();var i=t(".wfstatus-popover").length,n=e&&e.cardViewOptions.stepCardsListView?e.cardViewOptions.stepCardsListView.getOption("listViewMulCurrentSteps"):void 0,o=!1;i>=1?1!==i&&n?(o=!0,t("[id*=wfstatus-popover-pointer]").eq(1).remove(),t("[id*=wfstatus-popover]").eq(2).remove()):n||(o=!1,t("[id*=wfstatus-popover]").remove()):(o=!1,t("[id*=wfstatus-popover]").remove()),o&&d.UnbindPopoverEvents()},"formatStatus":function(e){var t,i,n,o=e.status,s=e.dueDate,l="wfstatus-"+o+"-icon",a=new Date(Date.now());return o===this.constants.WFSTATUS_ONTIME?(n=s?new Date(s):"",t=""!==n?this.getDateDifference(n,a):void 0,i=0===t?p.dueLabel+" "+p.todayLabel:1===t?p.dueInLabel+" "+t+" "+p.day:t<=5?p.dueInLabel+" "+t+" "+p.days:p.onTime.toLowerCase()):o===this.constants.WFSTATUS_COMPLETED?i=p.completed.toLowerCase():o===this.constants.WFSTATUS_LATE?(n=s?new Date(s):"",t=""!==n?this.getDateDifference(a,n):void 0,i=1===t?t+" "+p.day+" "+p.lateFilterLabel.toLowerCase():t>1&&t<=5?t+" "+p.days+" "+p.lateFilterLabel.toLowerCase():p.late.toLowerCase()):o===this.constants.WFSTATUS_STOPPED&&(i=p.stopped.toLowerCase()),{"status":i,"styleclass":l}},"getDateDifference":function(e,t){var i;return e&&t&&(i=e.getTime()-t.getTime(),i=Math.round(i/864e5)),i},"showProfilePic":function(e){var i=t.Deferred();if(e.get("photo_url")){var o=e.get("photo_url"),s=o.substring(6),l=n.combine(e.connector.connection.url,s),a=e.connector.extendAjaxOptions({"url":l,"method":"GET","dataType":"binary"});t.ajax(a).done(function(e){i.resolve(e)}).fail(function(e){i.reject(e)})}return i.promise()},"getChatURI":function(e){return(e.uriPrefix?e.uriPrefix:this.constants.URI_PREFIX)+this.constants.URI_DELIMITER+e.tguser+this.constants.AT_SIGN_SYMBOL+e.domain},"getWorkflowtype":function(e){var t=!0,i=!0,n="Both";return e&&(t=e.filterInitiated,i=e.filterManaged),t&&i?n="Both":t?n="Initiated":i&&(n="Managed"),n}}}),csui.define("hbs!workflow/widgets/workitem/workitem/impl/header",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"showIcon"):t,{"name":"if","hash":{},"fn":e.program(2,o,0),"inverse":e.noop,"loc":{"start":{"line":2,"column":2},"end":{"line":16,"column":9}}}))?s:"")+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"multiMaps"):t,{"name":"if","hash":{},"fn":e.program(10,o,0),"inverse":e.program(13,o,0),"loc":{"start":{"line":17,"column":2},"end":{"line":43,"column":9}}}))?s:"")+"\r\n  </div>\r\n\r\n\r\n"},"2":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"iconLeft"):t,{"name":"if","hash":{},"fn":e.program(3,o,0),"inverse":e.program(5,o,0),"loc":{"start":{"line":3,"column":4},"end":{"line":15,"column":11}}}))?s:""},"3":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <span class="tile-type-icon cs-icon-left '+e.escapeExpression((s=null!=(s=l(i,"iconLeft")||(null!=t?l(t,"iconLeft"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"iconLeft","hash":{},"loc":{"start":{"line":4,"column":47},"end":{"line":4,"column":59}}}):s))+'"></span>\r\n      <div class="tile-title">\r\n'},"5":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"imageLeftUrl"):t,{"name":"if","hash":{},"fn":e.program(6,o,0),"inverse":e.program(8,o,0),"loc":{"start":{"line":7,"column":6},"end":{"line":14,"column":13}}}))?s:""},"6":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'          <div class="tile-type-image '+e.escapeExpression((s=null!=(s=l(i,"imageLeftClass")||(null!=t?l(t,"imageLeftClass"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"imageLeftClass","hash":{},"loc":{"start":{"line":8,"column":38},"end":{"line":8,"column":56}}}):s))+'">\r\n            <img src="'+e.escapeExpression((s=null!=(s=l(i,"imageLeftUrl")||(null!=t?l(t,"imageLeftUrl"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"imageLeftUrl","hash":{},"loc":{"start":{"line":9,"column":22},"end":{"line":9,"column":38}}}):s))+'" aria-hidden="true">\r\n          </div>\r\n        <div class="tile-title">\r\n'},"8":function(e,t,i,n,o){return'        <div class="tile-title cs-text-only">\r\n'},"10":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <div class="cs-formfield cs-selectfield binf-dropdown">\r\n        <div class="cs-field-write">\r\n          <div class="cs-field-write-inner cs-drop-down">\r\n            <button id="select-workflow-type" title="'+e.escapeExpression((l=null!=(l=a(i,"MultipleMapsSelectPlaceholder")||(null!=t?a(t,"MultipleMapsSelectPlaceholder"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"MultipleMapsSelectPlaceholder","hash":{},"loc":{"start":{"line":21,"column":53},"end":{"line":21,"column":86}}}):l))+'"\r\n                    type="button" class="binf-btn binf-btn-default binf-dropdown-toggle\r\n                    '+e.escapeExpression((l=null!=(l=a(i,"shadowClass")||(null!=t?a(t,"shadowClass"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"shadowClass","hash":{},"loc":{"start":{"line":23,"column":20},"end":{"line":23,"column":35}}}):l))+'" data-binf-toggle="dropdown" aria-haspopup="true"\r\n                    aria-expanded="false">\r\n              <span class="cs-label select-workflow-label">'+e.escapeExpression((l=null!=(l=a(i,"MultipleMapsSelectPlaceholder")||(null!=t?a(t,"MultipleMapsSelectPlaceholder"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"MultipleMapsSelectPlaceholder","hash":{},"loc":{"start":{"line":25,"column":59},"end":{"line":25,"column":92}}}):l))+'</span>\r\n              <span class="cs-icon icon-caret-down"></span>\r\n            </button>\r\n            <ul class="binf-dropdown-menu ps-container" role="menu"\r\n                aria-label="'+e.escapeExpression((l=null!=(l=a(i,"MultipleMapsSelectPlaceholder")||(null!=t?a(t,"MultipleMapsSelectPlaceholder"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"MultipleMapsSelectPlaceholder","hash":{},"loc":{"start":{"line":29,"column":28},"end":{"line":29,"column":61}}}):l))+'">\r\n'+(null!=(s=a(i,"each").call(null!=t?t:e.nullContext||{},null!=t?a(t,"maps"):t,{"name":"each","hash":{},"fn":e.program(11,o,0),"inverse":e.noop,"loc":{"start":{"line":30,"column":14},"end":{"line":36,"column":23}}}))?s:"")+"            </ul>\r\n          </div>\r\n        </div>\r\n      </div>\r\n"},"11":function(e,t,i,n,o){var s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                <li><a role="menuitem" class="cs-menu-option" href="#" title="'+e.escapeExpression(e.lambda(null!=t?s(t,"Name"):t,t))+'" data-wfid="'+e.escapeExpression(e.lambda(null!=t?s(t,"DataID"):t,t))+'" tabindex="-1" data-cstabindex="-1" >\r\n              <span class="cs-label" data-wfid="'+e.escapeExpression(e.lambda(null!=t?s(t,"DataID"):t,t))+'">'+e.escapeExpression(e.lambda(null!=t?s(t,"Name"):t,t))+"</span>\r\n                </a>\r\n                </li>\r\n"},"13":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <h2 title="'+e.escapeExpression((s=null!=(s=l(i,"title")||(null!=t?l(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":42,"column":17},"end":{"line":42,"column":26}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"title")||(null!=t?l(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":42,"column":28},"end":{"line":42,"column":37}}}):s))+"</h2>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"expandedHeader"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":0},"end":{"line":48,"column":7}}}))?s:""}});return i.registerPartial("workflow_widgets_workitem_workitem_impl_header",n),n}),csui.define("css!workflow/widgets/workitem/workitem/impl/workitem",[],function(){}),csui.define("workflow/widgets/workitem/workitem/impl/header.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/utils/contexts/factories/node","csui/models/nodes","csui/utils/commandhelper","csui/dialogs/modal.alert/modal.alert","csui/controls/globalmessage/globalmessage","workflow/models/workflow/workflow.model","workflow/commands/initiate.workflow/initiate.workflow","hbs!workflow/widgets/workitem/workitem/impl/header","i18n!workflow/widgets/workitem/workitem/impl/nls/lang","i18n!csui/pages/start/impl/nls/lang","css!workflow/widgets/workitem/workitem/impl/workitem"],function(e,t,i,n,o,s,l,a,r,c,u,d,p,m){"use strict";return i.ItemView.extend({"template":d,"behaviors":{"TabableRegion":{"behaviorClass":n,"initialActivationWeight":100}},"ui":{"titleWorkflow":".tile-title>h2"},"events":{"keydown":"onKeyInView","click .cs-menu-option":"onMapSelectionChanged"},"templateHelpers":function(){for(var t=this.options.maps||[],i="",n=0;n<t.length;n++){var o=t[n].Name.split(":");this.options.maps[n].Name=o[o.length-1]}var s=p.MultipleMapsSelectPlaceholder;return this.model&&this.model.attributes.isDocDraft&&(s=this.model.attributes.title),i=!0===this.options.multiMaps?s:this.options.title,document.title=e.str.sformat(p.WorkflowStepTitle,i),{"iconLeft":this.options.iconLeft,"imageLeftUrl":this.options.imageLeftUrl,"imageLeftClass":this.options.imageLeftClass,"title":this.options.title,"expandedHeader":!0,"multiMaps":this.options.multiMaps,"maps":this.options.maps,"MultipleMapsSelectPlaceholder":s,"shadowClass":"","showIcon":!0}},"constructor":function(e){i.View.prototype.constructor.apply(this,arguments)},"isTabable":function(){return!0},"currentlyFocusedElement":function(){var e=this.$("#select-workflow-type");return e.length>0?t(e[0]):this.ui.titleWorkflow},"onSetFocus":function(){this.ui.titleWorkflow.trigger("focus")},"onDomRefresh":function(){var e=this.$("#select-workflow-type");e.length>0?e[0].focus():this.triggerMethod("setFocus")},"onKeyInView":function(e){32===e.keyCode&&t(e.target).trigger("click")},"onMapSelectionChanged":function(e){var t=this;if(e.preventDefault(),this.model&&this.model.attributes.isDocDraft){var i={};i.buttons=a.buttons.OkCancel;a.confirmWarning(p.ChangeWorkflowTypeMessage,p.ChangeWorkflowTypeTitle,i).then(function(){t.mapSelected(e)})}else this.mapSelected(e)},"mapSelected":function(t){var i=parseInt(t.target.getAttribute("data-wfid"));i&&(this.propertiesCommand=new u,this.mapModel=this.options.context.getModel(o,{"attributes":{"id":i}}),this.mapModel.fetch().done(e.bind(function(e){var t=this.options.model,i={};i.context=this.options.context,i.nodes=new s([this.mapModel]),i.isDoc=!0,i.doc_id=t.get("doc_id"),i.parent_id=t.get("parent_id"),i.docNames=t.get("doc_names"),i.mapsList=t.get("mapsList"),i.originatingView=this.options.originatingView;var n=this.model.get("url_org");n&&n.length>0?i.url_org=n:i.url_org="";var o=t.defaults,a=this.mapModel.actions.get("initiateworkflow"),r=!!a&&JSON.parse(a.get("body"));t.reset({"silent":!0}),o.isAttachmentCentric=r.smartViewAttachmentsView,t.set(o,{"silent":!0});var c=this.propertiesCommand.execute(i);l.handleExecutionResults(c,{"command":this.propertiesCommand,"suppressSuccessMessage":i.suppressSuccessMessage})},this)).fail(e.bind(function(e){r.showMessage("error",e.responseJSON.error)},this)))}})}),csui.define("workflow/widgets/workitem/workitem/impl/footer.view",["csui/lib/marionette"],function(e){"use strict";var t=e.ItemView.extend({"tagName":"button","className":"binf-btn","template":!1,"triggers":{"click":"click"},"constructor":function(t){e.View.prototype.constructor.apply(this,arguments)},"onRender":function(){var e=this.$el,t=this.model.attributes;e.text(t.label),"standard-Review"===t.id&&e.addClass(t.default?"binf-btn-primary":"binf-btn-default-review"),e.addClass(t.default?"binf-btn-primary":"binf-btn-default"),t.toolTip&&e.attr("title",t.toolTip),t.separate&&e.addClass("cs-separate"),this.updateButton(t)},"updateButton":function(e){var t=this.$el;e||(e={}),void 0!==e.hidden&&(e.hidden?t.addClass("binf-hidden"):t.removeClass("binf-hidden")),void 0!==e.disabled&&t.prop("disabled",e.disabled)}});return e.CollectionView.extend({"childView":t,"constructor":function(t){e.CollectionView.prototype.constructor.apply(this,arguments)},"onDomRefresh":function(){this.children.each(function(e){e.trigger("dom:refresh")})},"getButtons":function(){return this.children.toArray()},"updateButton":function(e,i){var n=this.collection.get(e);n?this.children.findByModel(n).updateButton(i):t.updateButton(this.$('[data-cs-id="'+e+'"]'),i)}})}),csui.define("hbs!workflow/widgets/message/impl/message",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="message-head">\r\n  <div class="message-subject">\r\n    <div class="subject-pre">'+e.escapeExpression((s=null!=(s=l(i,"subjectPre")||(null!=t?l(t,"subjectPre"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"subjectPre","hash":{},"loc":{"start":{"line":3,"column":29},"end":{"line":3,"column":43}}}):s))+'</div>\r\n    <div class="subject-sender">'+e.escapeExpression((s=null!=(s=l(i,"sender")||(null!=t?l(t,"sender"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"sender","hash":{},"loc":{"start":{"line":4,"column":32},"end":{"line":4,"column":42}}}):s))+'</div>\r\n    <div class="subject-post">'+e.escapeExpression((s=null!=(s=l(i,"subjectPost")||(null!=t?l(t,"subjectPost"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"subjectPost","hash":{},"loc":{"start":{"line":5,"column":30},"end":{"line":5,"column":45}}}):s))+'</div>\r\n  </div>\r\n  <div class="message-toggle">\r\n    <div hidden id='+e.escapeExpression((s=null!=(s=l(i,"ariaDescribedById")||(null!=t?l(t,"ariaDescribedById"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"ariaDescribedById","hash":{},"loc":{"start":{"line":8,"column":19},"end":{"line":8,"column":40}}}):s))+">"+e.escapeExpression((s=null!=(s=l(i,"subjectAria")||(null!=t?l(t,"subjectAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"subjectAria","hash":{},"loc":{"start":{"line":8,"column":41},"end":{"line":8,"column":56}}}):s))+'</div>\r\n    <a class="toggle-button" role="button" title="'+e.escapeExpression((s=null!=(s=l(i,"seeLess")||(null!=t?l(t,"seeLess"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"seeLess","hash":{},"loc":{"start":{"line":9,"column":50},"end":{"line":9,"column":61}}}):s))+'" data-binf-toggle="collapse"\r\n       href=".message-body" aria-describedby='+e.escapeExpression((s=null!=(s=l(i,"ariaDescribedById")||(null!=t?l(t,"ariaDescribedById"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"ariaDescribedById","hash":{},"loc":{"start":{"line":10,"column":45},"end":{"line":10,"column":66}}}):s))+'\r\n           aria-label="'+e.escapeExpression((s=null!=(s=l(i,"seeLessMessages")||(null!=t?l(t,"seeLessMessages"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"seeLessMessages","hash":{},"loc":{"start":{"line":11,"column":23},"end":{"line":11,"column":42}}}):s))+'">\r\n      <span class="csui-button-icon icon-expandArrowUp"></span>\r\n    </a>\r\n  </div>\r\n</div>\r\n<div class="message-body binf-collapse binf-in">\r\n  <div class="message-text">'+e.escapeExpression((s=null!=(s=l(i,"messageText")||(null!=t?l(t,"messageText"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"messageText","hash":{},"loc":{"start":{"line":17,"column":28},"end":{"line":17,"column":43}}}):s))+"</div>\r\n</div>"}});return i.registerPartial("workflow_widgets_message_impl_message",n),n}),csui.define("workflow/widgets/message/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/widgets/message/impl/nls/root/lang",{"delegateMessage":"Message from {0} who forwarded the workflow step to a new approver.","delegateMessageNoComment":"{0} forwarded the workflow step to a new approver without a message.","reassignMessage":"Message from {0} who reassigned the workflow step.","reassignMessageNoComment":"{0} reassigned the workflow step without a message.","reviewMessage":"Message from {0} who sent you a workflow step for review. Please add a comment and reply.","reviewMessageNoComment":"{0} sent you a workflow step for review. Please add a comment and reply.","reviewReturnMessage":"Message from {0} who reviewed your workflow step.","reviewReturnMessageNoComment":"{0} reviewed your workflow step without a message.","seeLess":"See less","seeMore":"See more","seeLessMessages":"See less messages","seeMoreMessages":"See more messages","anonymousUserName":"Anonymous User"}),csui.define("css!workflow/widgets/message/impl/message",[],function(){}),csui.define("workflow/widgets/message/message.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/models/member","hbs!workflow/widgets/message/impl/message","i18n!workflow/widgets/message/impl/nls/lang","css!workflow/widgets/message/impl/message"],function(e,t,i,n,o,s,l){"use strict";var a={"message":function(e,t){var i=e;switch(e){case"delegate":i=t?l.delegateMessage:l.delegateMessageNoComment;break;case"reassign":i=t?l.reassignMessage:l.reassignMessageNoComment;break;case"review":i=t?l.reviewMessage:l.reviewMessageNoComment;break;case"review_return":i=t?l.reviewReturnMessage:l.reviewReturnMessageNoComment}return i}};return i.ItemView.extend({"className":"workflow-message","template":s,"templateHelpers":function(){return{"subjectPre":this.subjectPre,"subjectPost":this.subjectPost,"sender":this.sender,"subjectAria":this.subjectPre+this.sender+this.subjectPost+this.messageText,"ariaDescribedById":e.uniqueId("id_"),"messageText":this.messageText,"seeMore":l.seeMore,"seeLess":l.seeLess,"seeMoreMessages":l.seeMoreMessages,"seeLessMessages":l.seeLessMessages}},"ui":{"toggleButton":".toggle-button","toggleIcon":".toggle-button > span","messageBody":".message-body"},"events":{"click @ui.toggleButton":"onClickToggle"},"behaviors":{"TabableRegion":{"behaviorClass":n}},"constructor":function(t){if(e.isUndefined(t)||e.isUndefined(t.model))throw new Error("Message model is missing!");var n=t.model,s=t.connector;this.messageText=n.get("text");var r=n.get("subject");if(!e.isUndefined(r)){r=a.message(r,this.messageText);2===r.split("{0}").length?(this.subjectPre=r.split("{0}")[0],this.subjectPost=r.split("{0}")[1]):(this.subjectPre=null,this.subjectPost=r)}var c=n.get("sender");if(e.isNumber(c)){var u=this;new o({"id":c},{"connector":s}).fetch().done(function(e,t){"success"===t&&(u.sender=e.data.display_name,u.render())})}else e.isString(c)?this.sender=c:this.sender=l.anonymousUserName;i.ItemView.prototype.constructor.call(this,t)},"onClickToggle":function(e){this.ui.messageBody.hasClass("binf-in")?(this.ui.toggleIcon.removeClass("icon-expandArrowUp"),this.ui.toggleIcon.addClass("icon-expandArrowDown"),this.ui.toggleButton&&this.ui.toggleButton.hasClass("toggle-button csui-acc-focusable-active")&&(this.ui.toggleButton[0].title=l.seeMore,this.ui.toggleButton.attr("aria-label",l.seeMoreMessages))):(this.ui.toggleIcon.removeClass("icon-expandArrowDown"),this.ui.toggleIcon.addClass("icon-expandArrowUp"),this.ui.toggleButton&&this.ui.toggleButton.hasClass("toggle-button csui-acc-focusable-active")&&(this.ui.toggleButton[0].title=l.seeLess,this.ui.toggleButton.attr("aria-label",l.seeLessMessages)))},"currentlyFocusedElement":function(){return t(this.ui.toggleButton)}})}),csui.define("hbs!workflow/widgets/workitem/workitem.properties/impl/workitem.instructions",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class=" workitem-instructions-scrolling">\r\n    <div class="workitem-extended-view-mode workitem-see-less-content\r\n      workitem-see-less-instruction">\r\n      <div id="'+e.escapeExpression((l=null!=(l=a(i,"id_instructions")||(null!=t?a(t,"id_instructions"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"id_instructions","hash":{},"loc":{"start":{"line":5,"column":15},"end":{"line":5,"column":34}}}):l))+'"\r\n           class="workitem-instructions-text csui-acc-focusable-active ">'+(null!=(s=e.lambda(null!=(s=null!=t?a(t,"model"):t)?a(s,"instructions"):s,t))?s:"")+'</div>\r\n      <a href="javascript:void(0);" title="'+e.escapeExpression((l=null!=(l=a(i,"seeLess")||(null!=t?a(t,"seeLess"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"seeLess","hash":{},"loc":{"start":{"line":7,"column":43},"end":{"line":7,"column":54}}}):l))+'" role="button" aria-label="'+e.escapeExpression((l=null!=(l=a(i,"seeLessInstructions")||(null!=t?a(t,"seeLessInstructions"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"seeLessInstructions","hash":{},"loc":{"start":{"line":7,"column":82},"end":{"line":7,"column":105}}}):l))+'"\r\n         aria-describedby="'+e.escapeExpression((l=null!=(l=a(i,"id_instructions")||(null!=t?a(t,"id_instructions"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"id_instructions","hash":{},"loc":{"start":{"line":8,"column":27},"end":{"line":8,"column":46}}}):l))+'" class="instruction-see-less\r\n         workitem-see-less-instruction">\r\n      <span class="csui-button-icon icon-expandArrowUp"></span></a>\r\n      <a href="javascript:void(0);" title="'+e.escapeExpression((l=null!=(l=a(i,"seeMore")||(null!=t?a(t,"seeMore"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"seeMore","hash":{},"loc":{"start":{"line":11,"column":43},"end":{"line":11,"column":54}}}):l))+'" role="button"\r\n         aria-describedby="'+e.escapeExpression((l=null!=(l=a(i,"id_instructions")||(null!=t?a(t,"id_instructions"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"id_instructions","hash":{},"loc":{"start":{"line":12,"column":27},"end":{"line":12,"column":46}}}):l))+'" aria-label="'+e.escapeExpression((l=null!=(l=a(i,"seeMoreInstructions")||(null!=t?a(t,"seeMoreInstructions"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"seeMoreInstructions","hash":{},"loc":{"start":{"line":12,"column":60},"end":{"line":12,"column":83}}}):l))+'"\r\n         class="instruction-see-more workitem-see-more-instruction workitem-hide-element">\r\n      <span class="csui-button-icon icon-expandArrowDown"></span></a>\r\n    </div>\r\n  </div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"model"):t)?l(s,"instructions"):s,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":0},"end":{"line":17,"column":7}}}))?s:""}});return i.registerPartial("workflow_widgets_workitem_workitem.properties_impl_workitem.instructions",n),n}),csui.define("workflow/widgets/workitem/workitem.properties/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/widgets/workitem/workitem.properties/impl/nls/root/lang",{"FormValidationErrorMessage":"Required fields must be filled","HideValidationErrorMessageIconTooltip":"Hide validation error","SeeMore":"See more","SeeLess":"See less","SeeMoreInstructions":"See more instructions","SeeLessInstructions":"See less instructions","multiMapSelectMessage":"Select the workflow you want to initiate from the drop-down list"}),csui.define("css!workflow/widgets/workitem/workitem.properties/impl/workitem.instructions",[],function(){}),csui.define("workflow/widgets/workitem/workitem.properties/impl/workitem.instructions.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/log","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!workflow/widgets/workitem/workitem.properties/impl/workitem.instructions","i18n!workflow/widgets/workitem/workitem.properties/impl/nls/lang","css!workflow/widgets/workitem/workitem.properties/impl/workitem.instructions"],function(e,t,i,n,o,s,l,a){"use strict";var r=i.LayoutView.extend({"className":"workflow-workitem-properties-instructions","ui":{"instructions":".workitem-instructions-text","InstructionElement":".workitem-extended-view-mode","seeLessIcon":"a.workitem-see-less-instruction","seeMoreIcon":"a.workitem-see-more-instruction"},"events":{"keydown":"onKeyDown","click @ui.seeMoreIcon":"showMoreContent","click @ui.seeLessIcon":"showLessContent","keydown @ui.seeMoreIcon":"onKeyDownShowMoreContent","keydown @ui.seeLessIcon":"onKeyDownShowLessContent"},"template":l,"constructor":function(e){i.LayoutView.prototype.constructor.call(this,e),this.propagateEventsToRegions()},"behaviors":{"TabableRegion":{"behaviorClass":s}},"currentlyFocusedElement":function(){if(this.model.get("instructions"))return t(".workitem-instructions a");t(".cs-form.cs-form-create").first().addClass("workitem-with-empty-instructions"),t(".cs-form.cs-form-update").first().addClass("workitem-with-empty-instructions")},"contentTypeElement":".workitem-extended-view-mode","showMoreContent":function(e){if(""===window.getSelection().toString()){var i=t(this.$el.find(".instruction-see-less")[0]),n=t(this.$el.find(".instruction-see-more")[0]),o=this.ui.InstructionElement[0];t(i).removeAttr("style"),t(i).show(),t(n).hide(),this.ui.seeLessIcon.trigger("focus"),t(o).removeClass("workitem-see-more-content"),t(o).removeClass("workitem-see-more-instruction"),t(o).addClass("workitem-see-less-instruction")}},"showLessContent":function(e){if(""===window.getSelection().toString()){var i=t(this.$el.find(".instruction-see-less")[0]),n=t(this.$el.find(".instruction-see-more")[0]),o=this.ui.InstructionElement[0];t(i).hide(),t(n).removeAttr("style"),t(n).show(),this.ui.seeMoreIcon.trigger("focus"),t(o).addClass("workitem-see-more-content"),t(o).addClass("workitem-see-more-instruction"),t(o).removeClass("workitem-see-less-instruction")}},"onKeyDownShowMoreContent":function(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.showMoreContent(e))},"onKeyDownShowLessContent":function(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.showLessContent(e))},"onKeyDown":function(e){var t=!1,i=0;switch(e.keyCode){case 38:i=-30,t=!0;break;case 40:i=30,t=!0}if(t){e.preventDefault(),e.stopPropagation();var n=this.$el.find(".workitem-instructions-scrolling");n.scrollTop(n.scrollTop()+i)}},"templateHelpers":function(){return{"seeMore":a.SeeMore,"seeLess":a.SeeLess,"seeMoreInstructions":a.SeeMoreInstructions,"seeLessInstructions":a.SeeLessInstructions,"model":this.model.toJSON(),"id_instructions":e.uniqueId("id_")}}});return e.extend(r.prototype,o),r}),csui.define("hbs!workflow/widgets/workitem/workitem.properties/impl/workitem.properties",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="workitem-multimap-select-message"></div>\r\n<div class="workitem-message"></div>\r\n<div class="workitem-instructions"></div>\r\n<div class="workitem-forms"></div>\r\n<div class="workitem-extension"></div>\r\n\r\n'}});return i.registerPartial("workflow_widgets_workitem_workitem.properties_impl_workitem.properties",n),n}),csui.define("css!workflow/widgets/workitem/workitem.properties/impl/workitem.properties",[],function(){}),csui.define("workflow/controls/form/fields/alpaca/alpcsuirealfield",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca.lite","csui/models/form","csui/controls/form/fields/textfield.view","csui/utils/base"],function(e,t,i,n,o,s,l,a,r){"use strict";return s.Fields.CsuiRealField=s.Fields.NumberField.extend({"constructor":function(e,t,i,n,o,s,l){this.base(e,t,i,n,o,s,l)},"getFieldType":function(){return"text"},"postRender":function(e){this.base(e),this.showField()},"showField":function(){var e=this.id;this.options.id="lbl"+t.uniqueId(e);var s,l=i(this.field[0]).find("label");l&&1===l.length&&(s=l.attr("for")+"Label",l.attr("id",s)),this.fieldView=new a({"model":new n.Model({"data":this.data,"options":this.options,"schema":this.schema,"id":e}),"id":t.uniqueId(e),"alpacaField":this,"labelId":s,"value":this.data,"readonly":!0,"dataId":this.name,"path":this.path,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema}});var r=i("<div>").addClass("alpaca-control");this.getControlEl().replaceWith(r),this.region=new o.Region({"el":r}),this.region.show(this.fieldView)},"getValue":function(){var e=i(this.control).val();return null===e||""===e?null:Number(e)},
"setValueAndValidate":function(e,t){this.setValue(e);var i=!0;return t&&(i=this.validate(),this.refreshValidationState(!1)),i},"focus":function(){this.fieldView.setFocus()},"handleValidate":function(){var e=this.base();if(!e){var t=this.validation;if(""!==this.fieldView.ui.writeField.val())return t.notOptional.status=!0,t.notOptional.message="",e;for(var i in t)!1===t[i].status&&"notOptional"!==i&&(t[i].status=!0,t[i].message="")}return e},"destroy":function(){this.base(),this.region&&this.region.destroy()}}),s.registerFieldClass("number",s.Fields.CsuiRealField,"bootstrap-csui"),s.registerFieldClass("number",s.Fields.CsuiRealField,"bootstrap-edit-horizontal"),i.alpaca.Fields.CsuiRealField}),csui.define("workflow/controls/breadcrumbs/impl/breadcrumb/breadcrumb.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/controls/breadcrumbs/impl/breadcrumb/breadcrumb.view","csui/behaviors/default.action/default.action.behavior","i18n!csui/controls/breadcrumbs/impl/breadcrumb/impl/nls/lang"],function(e,t,i,n,o,s){"use strict";return n.extend({"templateHelpers":function(){var t=this,i=e.map(this.model.get("subcrumbs"),function(i){return e.extend(i.toJSON(),{"url":t.getAncestorUrl(i)})});return{"inactive":this.model.get("inactive"),"hasSubCrumbs":i.length>0,"subcrumbs":i,"url":this.getAncestorUrl(this.model),"subcrumbTooltip":s.subcrumbTooltip}},"getAncestorUrl":function(e){return e.get("id")>0&&e.connector&&o.getDefaultActionNodeUrl(e)}})}),csui.define("workflow/controls/breadcrumbs/breadcrumbs.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/commands","csui/utils/defaultactionitems","csui/controls/breadcrumbs/breadcrumbs.view","csui/models/node/node.model","csui/behaviors/default.action/default.action.behavior","workflow/controls/breadcrumbs/impl/breadcrumb/breadcrumb.view"],function(e,t,i,n,o,s,l,a,r){"use strict";return s.extend({"childView":r,"behaviors":{"DefaultAction":{"behaviorClass":a}},"onClickAncestor":function(e,t){var i=this,s={"node":t},a=new l({"id":t.get("id")},{"connector":t.connector,"autoreset":!0,"commands":o.getAllCommandSignatures(n)});a.fetch().done(function(){i.defaultActionController.hasAction(a)?i.triggerMethod("execute:defaultAction",a):(i.trigger("before:defaultAction",s),s.cancel||i._nextNode.set("id",t.get("id")),i.$el.trigger("setCurrentTabFocus"))})}})}),csui.define("hbs!workflow/controls/form/impl/fields/itempicker/itempicker",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'placeholder="'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"options"):t)?l(s,"placeholder"):s,t))+'"'},"3":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'aria-labelledby="'+e.escapeExpression((s=null!=(s=l(i,"idBtnLabel")||(null!=t?l(t,"idBtnLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"idBtnLabel","hash":{},"loc":{"start":{"line":6,"column":43},"end":{"line":6,"column":57}}}):s))+'" '},"5":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return' aria-label="'+e.escapeExpression((s=null!=(s=l(i,"multiFieldLabel")||(null!=t?l(t,"multiFieldLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"multiFieldLabel","hash":{},"loc":{"start":{"line":7,"column":44},"end":{"line":7,"column":63}}}):s))+'"'},"7":function(e,t,i,n,o){return' class="btn-container\r\n        inline-clear-itempicker-button" '},"9":function(e,t,i,n,o){return'  class="btn-container\r\n        inline-clear-itempicker-button binf-hidden" '},"11":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <div class="icon-container">\r\n        <div class="csui-icon-edit inline-edit-icon edit-cancel" title="'+e.escapeExpression((s=null!=(s=l(i,"cancel")||(null!=t?l(t,"cancel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"cancel","hash":{},"loc":{"start":{"line":23,"column":72},"end":{"line":23,"column":82}}}):s))+'"></div>\r\n      </div>\r\n'},"13":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <button class="btn-container inline-edit-more-button" title="'+e.escapeExpression((s=null!=(s=l(i,"toggleTitle")||(null!=t?l(t,"toggleTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"toggleTitle","hash":{},"loc":{"start":{"line":33,"column":67},"end":{"line":33,"column":82}}}):s))+'"\r\n        aria-label="'+e.escapeExpression((s=null!=(s=l(i,"toggleTitle")||(null!=t?l(t,"toggleTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"toggleTitle","hash":{},"loc":{"start":{"line":34,"column":20},"end":{"line":34,"column":35}}}):s))+'" aria-expanded="false">\r\n        <span class="inline-edit-more-icon icon-toolbar-more"></span>\r\n      </button>\r\n'},"15":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"      <a "+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"schema"):t)?l(s,"readonly"):s,{"name":"if","hash":{},"fn":e.program(16,o,0),"inverse":e.noop,"loc":{"start":{"line":40,"column":9},"end":{"line":40,"column":61}}}))?s:"")+' href="'+e.escapeExpression(e.lambda(null!=(s=null!=(s=null!=t?l(t,"options"):t)?l(s,"item"):s)?l(s,"url"):s,t))+'"\r\n         class="item-reference-link '+e.escapeExpression(e.lambda(null!=(s=null!=(s=null!=t?l(t,"options"):t)?l(s,"item"):s)?l(s,"disabledClass"):s,t))+'"\r\n         title="'+e.escapeExpression(e.lambda(null!=(s=null!=(s=null!=t?l(t,"options"):t)?l(s,"item"):s)?l(s,"anchorTitle"):s,t))+'"\r\n        '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"multiFieldLabel"):t,{"name":"if","hash":{},"fn":e.program(18,o,0),"inverse":e.program(20,o,0),"loc":{"start":{"line":43,"column":8},"end":{"line":44,"column":83}}}))?s:"")+">"+e.escapeExpression(e.lambda(null!=(s=null!=(s=null!=t?l(t,"options"):t)?l(s,"item"):s)?l(s,"itemName"):s,t))+"\r\n      </a>\r\n"},"16":function(e,t,i,n,o){return' aria-disabled="true" '},"18":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return' aria-label="'+e.escapeExpression((l=null!=(l=a(i,"readModeMultiFieldAria")||(null!=t?a(t,"readModeMultiFieldAria"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"readModeMultiFieldAria","hash":{},"loc":{"start":{"line":43,"column":44},"end":{"line":43,"column":70}}}):l))+" "+e.escapeExpression(e.lambda(null!=(s=null!=t?a(t,"options"):t)?a(s,"anchorTitleShort"):s,t))+'"\r\n        '},"20":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return' aria-label="'+e.escapeExpression((l=null!=(l=a(i,"readModeAria")||(null!=t?a(t,"readModeAria"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"readModeAria","hash":{},"loc":{"start":{"line":44,"column":29},"end":{"line":44,"column":45}}}):l))+" "+e.escapeExpression(e.lambda(null!=(s=null!=t?a(t,"options"):t)?a(s,"anchorTitleShort"):s,t))+'" '},"22":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=(s=null!=t?l(t,"options"):t)?l(s,"item"):s)?l(s,"errorCase"):s,{"name":"if","hash":{},"fn":e.program(23,o,0),"inverse":e.program(30,o,0),"loc":{"start":{"line":48,"column":8},"end":{"line":66,"column":15}}}))?s:""},"23":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"        <button "+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"schema"):t)?l(s,"readonly"):s,{"name":"if","hash":{},"fn":e.program(16,o,0),"inverse":e.noop,"loc":{"start":{"line":49,"column":16},"end":{"line":49,"column":68}}}))?s:"")+' class="itempicker item-reference-link"\r\n          '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"multiFieldLabel"):t,{"name":"if","hash":{},"fn":e.program(24,o,0),"inverse":e.program(26,o,0),"loc":{"start":{"line":50,"column":10},"end":{"line":51,"column":56}}}))?s:"")+"\r\n          "+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"options"):t)?l(s,"buttonDisabled"):s,{"name":"if","hash":{},"fn":e.program(28,o,0),"inverse":e.noop,"loc":{"start":{"line":52,"column":10},"end":{"line":52,"column":55}}}))?s:"")+'>\r\n          <span class="placeholder error-placeholder" title="'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"options"):t)?l(s,"placeholder"):s,t))+'">\r\n              '+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"options"):t)?l(s,"placeholder"):s,t))+"\r\n          </span>\r\n        </button>\r\n"},"24":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return' aria-label="'+e.escapeExpression((s=null!=(s=l(i,"readModeMultiFieldAria")||(null!=t?l(t,"readModeMultiFieldAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"readModeMultiFieldAria","hash":{},"loc":{"start":{"line":50,"column":46},"end":{"line":50,"column":72}}}):s))+'"\r\n          '},"26":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return' aria-label="'+e.escapeExpression((s=null!=(s=l(i,"readModeAria")||(null!=t?l(t,"readModeAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"readModeAria","hash":{},"loc":{"start":{"line":51,"column":31},"end":{"line":51,"column":47}}}):s))+'" '},"28":function(e,t,i,n,o){return"disabled"},"30":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"        <button "+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"schema"):t)?l(s,"readonly"):s,{"name":"if","hash":{},"fn":e.program(16,o,0),"inverse":e.noop,"loc":{"start":{"line":58,"column":16},"end":{"line":58,"column":68}}}))?s:"")+' class="itempicker item-reference-link"\r\n          '+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"multiFieldLabel"):t,{"name":"if","hash":{},"fn":e.program(24,o,0),"inverse":e.program(26,o,0),"loc":{"start":{"line":59,"column":10},"end":{"line":60,"column":56}}}))?s:"")+"\r\n          "+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"options"):t)?l(s,"buttonDisabled"):s,{"name":"if","hash":{},"fn":e.program(28,o,0),"inverse":e.noop,"loc":{"start":{"line":61,"column":10},"end":{"line":61,"column":55}}}))?s:"")+'>\r\n          <span class="placeholder" title="'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"options"):t)?l(s,"placeholder"):s,t))+'">\r\n            '+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"options"):t)?l(s,"placeholder"):s,t))+"\r\n          </span>\r\n        </button>\r\n"},"32":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return" "+e.escapeExpression(e.lambda(null!=(s=null!=(s=null!=t?l(t,"options"):t)?l(s,"item"):s)?l(s,"errorMsg"):s,t))+" "},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="cs-field-write">\r\n  <div class="cs-field-write-inner">\r\n    <div hidden id="'+e.escapeExpression((l=null!=(l=a(i,"ariaDescribedById")||(null!=t?a(t,"ariaDescribedById"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"ariaDescribedById","hash":{},"loc":{"start":{"line":3,"column":20},"end":{"line":3,"column":41}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"fieldWriteDescribedByAria")||(null!=t?a(t,"fieldWriteDescribedByAria"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"fieldWriteDescribedByAria","hash":{},"loc":{"start":{"line":3,"column":43},"end":{"line":3,"column":72}}}):l))+'</div>\r\n    <input type="'+e.escapeExpression((l=null!=(l=a(i,"inputType")||(null!=t?a(t,"inputType"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"inputType","hash":{},"loc":{"start":{"line":4,"column":17},"end":{"line":4,"column":30}}}):l))+'" id="'+e.escapeExpression((l=null!=(l=a(i,"id")||(null!=t?a(t,"id"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":4,"column":36},"end":{"line":4,"column":42}}}):l))+'" role="button" aria-describedby="'+e.escapeExpression((l=null!=(l=a(i,"ariaDescribedById")||(null!=t?a(t,"ariaDescribedById"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"ariaDescribedById","hash":{},"loc":{"start":{"line":4,"column":76},"end":{"line":4,"column":97}}}):l))+'"\r\n        '+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?a(t,"options"):t)?a(s,"placeholder"):s,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":79}}}))?s:"")+"\r\n        "+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"idBtnLabel"):t,{"name":"if","hash":{},"fn":e.program(3,o,0),"inverse":e.noop,"loc":{"start":{"line":6,"column":8},"end":{"line":6,"column":66}}}))?s:"")+"\r\n        "+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"multiFieldLabel"):t,{"name":"if","hash":{},"fn":e.program(5,o,0),"inverse":e.noop,"loc":{"start":{"line":7,"column":8},"end":{"line":7,"column":71}}}))?s:"")+'\r\n        value="'+(null!=(s=e.lambda(null!=(s=null!=(s=null!=t?a(t,"options"):t)?a(s,"item"):s)?a(s,"itemName"):s,t))?s:"")+'" title="'+(null!=(s=e.lambda(null!=(s=null!=(s=null!=t?a(t,"options"):t)?a(s,"item"):s)?a(s,"anchorTitle"):s,t))?s:"")+'" />\r\n\r\n        <button '+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=(s=null!=t?a(t,"options"):t)?a(s,"item"):s)?a(s,"itemName"):s,{"name":"if","hash":{},"fn":e.program(7,o,0),"inverse":e.program(9,o,0),"loc":{"start":{"line":10,"column":16},"end":{"line":12,"column":59}}}))?s:"")+' title="'+e.escapeExpression((l=null!=(l=a(i,"remove")||(null!=t?a(t,"remove"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"remove","hash":{},"loc":{"start":{"line":12,"column":67},"end":{"line":12,"column":77}}}):l))+'" tabindex="0"\r\n                data-cstabindex="0" aria-label="'+e.escapeExpression((l=null!=(l=a(i,"remove")||(null!=t?a(t,"remove"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"remove","hash":{},"loc":{"start":{"line":13,"column":48},"end":{"line":13,"column":58}}}):l))+'">\r\n          <span class="inline-clear-itempicker formfield_clear" ></span>\r\n        </button>\r\n\r\n      <button class="binf-btn binf-btn-primary invoke-picker" tabindex="0" data-cstabindex="0"\r\n              title="'+e.escapeExpression((l=null!=(l=a(i,"browse")||(null!=t?a(t,"browse"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"browse","hash":{},"loc":{"start":{"line":18,"column":21},"end":{"line":18,"column":31}}}):l))+'">\r\n        '+e.escapeExpression((l=null!=(l=a(i,"browse")||(null!=t?a(t,"browse"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"browse","hash":{},"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":18}}}):l))+"\r\n      </button>\r\n"+(null!=(s=(a(i,"xif")||t&&a(t,"xif")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},"this.mode !== 'writeonly'",{"name":"xif","hash":{},"fn":e.program(11,o,0),"inverse":e.noop,"loc":{"start":{"line":21,"column":4},"end":{"line":25,"column":12}}}))?s:"")+'\r\n  </div>\r\n</div>\r\n\r\n<div class="cs-field-read">\r\n  <div class="cs-field-read-inner">\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=(s=null!=t?a(t,"options"):t)?a(s,"item"):s)?a(s,"anchorTitle"):s,{"name":"if","hash":{},"fn":e.program(13,o,0),"inverse":e.noop,"loc":{"start":{"line":32,"column":4},"end":{"line":37,"column":11}}}))?s:"")+'    <div class="btn-container">\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=(s=null!=t?a(t,"options"):t)?a(s,"item"):s)?a(s,"anchorTitle"):s,{"name":"if","hash":{},"fn":e.program(15,o,0),"inverse":e.noop,"loc":{"start":{"line":39,"column":4},"end":{"line":46,"column":11}}}))?s:"")+(null!=(s=a(i,"unless").call(null!=t?t:e.nullContext||{},null!=(s=null!=(s=null!=t?a(t,"options"):t)?a(s,"item"):s)?a(s,"anchorTitle"):s,{"name":"unless","hash":{},"fn":e.program(22,o,0),"inverse":e.noop,"loc":{"start":{"line":47,"column":4},"end":{"line":67,"column":15}}}))?s:"")+'    </div>\r\n    <div class="icon-container">\r\n      <div class="csui-icon-edit inline-edit-icon icon-edit" title="'+e.escapeExpression((l=null!=(l=a(i,"edit")||(null!=t?a(t,"edit"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"edit","hash":{},"loc":{"start":{"line":70,"column":68},"end":{"line":70,"column":76}}}):l))+'"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class="breadcrumb-inner id-'+e.escapeExpression(e.lambda(null!=(s=null!=(s=null!=t?a(t,"options"):t)?a(s,"item"):s)?a(s,"nodeId"):s,t))+' binf-hidden"></div>\r\n<div class="item-reference-error-msg"> '+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=(s=null!=t?a(t,"options"):t)?a(s,"item"):s)?a(s,"errorCase"):s,{"name":"if","hash":{},"fn":e.program(32,o,0),"inverse":e.noop,"loc":{"start":{"line":76,"column":39},"end":{"line":76,"column":103}}}))?s:"")+" </div>\r\n"}});return i.registerPartial("workflow_controls_form_impl_fields_itempicker_itempicker",n),n}),csui.define("workflow/controls/form/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/controls/form/impl/nls/root/lang",{"alpacaPlaceholderItemReferencePicker":"Add a Content Server item","browse":"Browse","nodePickerDialogTitle":"Select {0}","originalNodeUnavailable":"Referenced item can not be accessed anymore","originalNodeUnavailableTooltip":"The original node is unavailable or you do not have permission to access it.","remove":"Remove","cancel":"Cancel","edit":"Edit","toggleTitle":"{0}:Toggle breadcrumb","fieldEditAria":"{0}:{1}, Press Enter or F2 to Edit","fieldWriteDescribedByAria":"Press Space to Open Select Dialog"}),csui.define("css!workflow/controls/form/impl/fields/itempicker/itempicker",[],function(){}),csui.define("workflow/controls/form/fields/itempickerfield.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/models/node/node.model","csui/utils/contexts/factories/node","csui/controls/form/fields/nodepickerfield.view","csui/behaviors/default.action/default.action.behavior","csui/dialogs/node.picker/node.picker","i18n!csui/controls/form/impl/nls/lang","workflow/controls/breadcrumbs/breadcrumbs.view","hbs!workflow/controls/form/impl/fields/itempicker/itempicker","i18n!workflow/controls/form/impl/nls/lang","css!workflow/controls/form/impl/fields/itempicker/itempicker"],function(e,t,i,n,o,s,l,a,r,c,u,d,p){"use strict";return l.extend({"template":d,"templateHelpers":function(){var t="",i=c.noValue,n="",o="",s=!1,l="readonly"===this.mode,a="",r="",u=!1;if(s=this.options.alpacaField&&this.options.alpacaField.isRequired(),a=s?c.requiredField:"",this.ancestors.pluck("name").length>0){var d=this.ancestors.pluck("name");i=d[d.length-1]}return this.node.get("nodeError")&&(i=p.originalNodeUnavailable),this.alpacaField&&this.alpacaField.options&&this.alpacaField.options.isMultiFieldItem&&(t=this.alpacaField.parent&&this.alpacaField.parent.options?this.alpacaField.parent.options.label:"",u=this.alpacaField.options.isMultiFieldItem),u?(o=l?c.fieldReadOnlyAria.replace("{0}",t).replace("{1}",i)+a:p.fieldEditAria.replace("{0}",t).replace("{1}",i)+a,r=p.toggleTitle.replace("{0}",t)):this.model.get("options")&&this.model.get("options").label&&(n=l?c.fieldReadOnlyAria.replace("{0}",this.model.get("options").label).replace("{1}",i)+a:p.fieldEditAria.replace("{0}",this.model.get("options").label).replace("{1}",i)+a,r=p.toggleTitle.replace("{0}",this.model.get("options").label)),{"inputType":"text","idBtnLabel":this.options.labelId,"ariaDescribedById":e.uniqueId("id_"),"fieldWriteDescribedByAria":p.fieldWriteDescribedByAria,"readModeAria":n,"readModeMultiFieldAria":o,"multiFieldLabel":t,"browse":p.browse,"remove":p.remove,"cancel":p.cancel,"toggleTitle":r,"edit":p.edit}},"ui":{"readArea":".cs-field-read","readField":".cs-field-read .item-reference-link","writeArea":".cs-field-write","writeField":".cs-field-write input","writeButton":".cs-field-write button","anchor":".cs-field-read a","more":".inline-edit-more-button","buttonMore":".inline-edit-more-button","breadCrumbs":".breadcrumb-inner","clear":".inline-clear-itempicker-button","errMsg":".item-reference-error-msg","writeBrowseButton":".cs-field-write .invoke-picker","cancelIcon":".edit-cancel","browseButton":".invoke-picker","placeHolder":"span.placeholder","placeHolderButton":"button.itempicker"},"events":{"focusout @ui.writeButton":"onFocusOutBtn","focusin @ui.anchor":"onFocusInAnchor","focusin @ui.writeField":"onFocusInWriteField","mousedown @ui.writeField":"onClickWriteField","keydown @ui.writeField":"onKeydownWriteField","keydown @ui.writeArea":"onKeydownWriteArea","click @ui.browseButton":"onClickBrowse","keydown @ui.browseButton":"onKeydownBrowse","click @ui.anchor":"onClickButton","keydown @ui.anchor":"onKeydownButton","click @ui.more":"onClickMore","keydown @ui.buttonMore":"onKeydownMore","click @ui.clear":"clearFieldvalue","keydown @ui.clear":"clearFieldvalueKeydown","mousedown @ui.writeBrowseButton, @ui.clear ":"onMouseDownWriteElements","click @ui.cancelIcon":"onCancelClicked","click @ui.placeHolder":"onClickPlaceHolder","keypress @ui.placeHolderButton":"onKeypressPlaceHolder","keydown @ui.placeHolderButton":"onKeydownPlaceHolder"},"onFocusOutBtn":function(t){setTimeout(e.bind(function(){return this.$el.find(".cs-field-write").find(document.activeElement).length?(t.preventDefault(),t.stopPropagation(),!1):(this.ui.writeField.trigger("blur"),!0)},this),50)},"onFocusInWriteField":function(e){this.changedKey=!1},"onClickPlaceHolder":function(e){e.preventDefault(),e.stopPropagation()},"onKeydownPlaceHolder":function(e){32!==e.keyCode||this.alpacaField.options.isMultiFieldItem||(e.preventDefault(),e.stopPropagation())},"onKeypressPlaceHolder":function(e){13!==e.keyCode&&32!==e.keyCode||this.alpacaField.options.isMultiFieldItem||(e.preventDefault(),e.stopPropagation(),13===e.keyCode&&this.getStatesBehavior().isStateRead()&&(e.preventDefault(),e.stopPropagation(),this.getEditableBehavior().setViewStateWriteAndEnterEditMode()))},"onKeyPress":function(e){},"allowEditOnEnter":function(){return!0},"onMouseDownWriteElements":function(e){this._isReadyToSave=!1},"onKeydownButton":function(e){var t=this.options.formView;32===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.onClickButton(e)),13!==e.keyCode||this.alpacaField.options.isMultiFieldItem||this.getStatesBehavior().isStateRead()&&(e.preventDefault(),e.stopPropagation(),this.getEditableBehavior().setViewStateWriteAndEnterEditMode()),13===e.keyCode&&this.alpacaField.options.isMultiFieldItem&&"create"===t.mode&&this.getStatesBehavior().isStateRead()&&(e.preventDefault(),e.stopPropagation())},"onKeydownWriteField":function(e){13===e.keyCode||113===e.keyCode?this.changedKey=!0:27===e.keyCode?this.onCancelClicked(e):32===e.keyCode?(e.preventDefault(),e.stopPropagation(),this.onClickWriteField(e)):9!==e.keyCode&&(e.preventDefault(),e.stopPropagation())},"onKeydownWriteArea":function(e){113===e.keyCode&&(this.changedKey=!0),27===e.keyCode&&this.onCancelClicked(e)},"onKeydownBrowse":function(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.onClickBrowse(e))},"onClickBrowse":function(e){this._isReadyToSave=!0,e.preventDefault(),this.$el.find("#"+this.model.get("id")).trigger("focus"),this._showNodePicker()},"clearFieldvalueKeydown":function(e){13===e.keyCode&&this.clearFieldvalue(e)},"clearFieldvalue":function(e){this._isReadyToSave=!0,this.ui.writeField.val(""),this.clearField=!0,this.newNode=void 0,this.editVal="",this.ui.clear.addClass("binf-hidden"),e.preventDefault(),e.stopPropagation(),this.ui.writeField.trigger("focus")},"onClickButton":function(e){e.preventDefault();var t=this.options.formView;"create"!==t.mode&&this.node.get("id")&&this.triggerMethod("execute:defaultAction",this.node),"create"===t.mode&&this.node.get("id")&&this.getStatesBehavior().isStateRead()&&this.triggerMethod("execute:defaultAction",this.node)},"setStateRead":function(e,t){return this.fieldsave?(this.fieldsave=void 0,this.$el.parents(".binf-form-group.alpaca-field")&&this.$el.parents(".binf-form-group.alpaca-field").find(".alpaca-message")&&this.$el.parents(".binf-form-group.alpaca-field").find(".alpaca-message").val(""),this.$el.hasClass("cs-formfield-invalid")&&this.$el.removeClass("cs-formfield-invalid"),this._updateNodesInRead()):this.alpacaField.options.isMultiFieldItem&&this._updateNodesInRead(),this.browseBtn=void 0,this.ui.writeArea.addClass("binf-hidden"),this.ui.readArea.removeClass("binf-hidden"),!0},"_updateNodesInRead":function(){this.newNode&&(this.node.set(this.newNode.attributes),this.newNode=void 0,this.clearField=void 0),this.clearField&&(this.clearField=void 0,this.alpacaField.options.isMultiFieldItem||this.setValue(null,!0),this.node.clear(),this.ancestors._reset(),this._renderNode())},"setStateWrite":function(e,t){return this.breadcrumbsView&&this.breadcrumbsView.rendered&&(this.ui.breadCrumbs.addClass("binf-hidden"),this.ui.more.attr("aria-expanded","false")),this.ui.readArea.addClass("binf-hidden"),this.ui.writeArea.removeClass("binf-hidden"),this.browseBtn?t&&this.ui.writeField.trigger("focus"):(this.browseBtn=!0,this.ui.browseButton.trigger("focus")),!0},"onKeydownMore":function(e){13!==e.keyCode&&27!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this.processBreadcrumbsView())},"processBreadcrumbsView":function(){this.breadcrumbsView?this.breadcrumbsView.rendered?this.hideBreadcrumb():this.showBreadcrumb():this.createBreadcrumb()},"createBreadcrumb":function(){var t=this.ancestors,i=new u({"context":this.options.context,"collection":t,"node":t.node});t.unbind("sync"),i.listenTo(this.model,"change",e.bind(function(e){this.ancestors.fetch(),this.breadcrumbsView=void 0},this)),t.isFetchable()&&t.fetch().done(e.bind(function(e){i.completeCollection=t,this.breadcrumbsView=i,new n.Region({"el":".breadcrumb-inner.id-"+this.id}).show(this.breadcrumbsView),this.showBreadcrumb()},this))},"showBreadcrumb":function(){this.ui.breadCrumbs.removeClass("binf-hidden"),this.ui.more.attr("aria-expanded","true"),this.breadcrumbsView.rendered=!0,this.breadcrumbsView.synchronizeCollections()},"hideBreadcrumb":function(){this.ui.breadCrumbs.addClass("binf-hidden"),this.ui.more.attr("aria-expanded","false"),this.breadcrumbsView.rendered=!1},"onClickMore":function(e){e.preventDefault(),this.processBreadcrumbsView()},"_onWindowResize":function(){this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(e.bind(function(){this._isReadyToSave=!1;var e={};e.url=a.getDefaultActionNodeUrl(this.node),e.enabled=this.defaultActionController.hasAction(this.node),e.anchorTitle=this.ancestors.pluck("name").join(" > "),e.anchorShortTitle=this._prepareFieldText();var t=this.ancestors.pluck("name");e.anchorName=t[t.length-1],this._renderField(e),this.getStatesBehavior().setStateRead(!1,!0),this._isReadyToSave=!0},this),200)},"_renderNode":function(){var e={};e.url=a.getDefaultActionNodeUrl(this.node),e.enabled=this.defaultActionController.hasAction(this.node),e.anchorTitle=this.ancestors.pluck("name").join(" > "),e.anchorShortTitle=this._prepareFieldText();var t=this.ancestors.pluck("name");e.anchorName=t[t.length-1],this.node.unset("nodeError"),this._renderField(e),this.$el.width()>0&&t.length>0&&"readonly"!==this.mode&&this.changedKey&&this.ui.readField.trigger("focus")},"_renderField":function(t){var i,n;this.node.get("nodeError")?(i=!0,n=p.originalNodeUnavailable,t.url="#",t.enabled=!1,t.anchorName="",t.anchorShortTitle="",t.anchorTitle=""):i=!1,this.model.attributes.options.item={},e.extend(this.model.attributes.options.item,{"url":t.url,"buttonDisabled":!t.enabled,"disabledClass":t.enabled?"":"binf-disabled","anchorTitle":t.anchorTitle,"itemName":t.anchorName,"anchorTitleShort":t.anchorShortTitle,"nodeId":t.id?t.id:this.id,"errorCase":i,"errorMsg":n}),this.render()},"_getNodePicker":function(){var i,n,s,l=this.model.get("options")||{},a=this.model.get("schema")||{},c=l.label||a.title,u=t("#attachmentFolderId").val();if(u)var d=parseInt(u);if(this.model.get("multiFiedsItem")){var m=this.model.get("typeControl");m?(i=m.parameters.select_types,n=m.parameters.parent||this.node.parent&&this.node.parent.attributes||void 0):(i=l.select_types,n=d||void 0)}else i=l.type_control.parameters.select_types,n=l.type_control.parameters.parent||this.node.parent&&this.node.parent.attributes||void 0;return n||(n=d),s=new o({"id":d},{"connector":this.connector}),this.nodePicker=new r({"connector":this.connector,"dialogTitle":e.str.sformat(p.nodePickerDialogTitle,c),"selectableTypes":i,"globalSearch":!0,"context":this.options.context,"startLocations":["enterprise.volume","current.location","personal.volume","favorites","recent.containers","category.volume","perspective.assets.volume","search.location","default.location","recman/dialogs/node.picker/start.locations/classifications.volume","workflow/dialogs/node.picker/start.locations/workitem.attachments"],"initialContainer":{"id":n&&n.id||n,"attachmentContainer":s},"initialSelection":[this.node]}),this.nodePicker},"_showNodePicker":function(){if(this._isReadyToSave){this._isReadyToSave=!1;var e=this._getNodePicker(),t=this.ui.writeField,i=this;e.show().done(function(e){var n=e.nodes[0],o=n.get("id");i.getStatesBehavior().isWriteOnly()||i.getStatesBehavior().isStateWrite()?i.editVal=o:i.getStatesBehavior().setStateRead(!1,!0),i.model.get("multiFiedsItem")?i.$el.find("#"+i.model.get("id")).val(n.get("name")):t.val(n.get("name")),i.newNode=n,i.ui.clear.removeClass("binf-hidden"),i.clearField=void 0,i.ui.errMsg.addClass("binf-hidden")}).always(function(){t.trigger("focus"),i._isReadyToSave=!0})}},"trySetValue":function(){var e=this.getEditValue(),t=this.getValue(),i=!0,n=this.isReadyToSave(),o=null===t&&""===e;return!n||e===t&&o||(i=this.setValue(e,!0),this.fieldsave=!0),i},"onCancelClicked":function(){var e=this.node.get("name"),t=!!e,i=this.ui.clear;this.editVal=this.oldVal,this.clearField=void 0,this.newNode=void 0,this.ui.writeField.val(e),t?i.removeClass("binf-hidden"):i.addClass("binf-hidden")},"_renderError":function(){this.node.set("nodeError",!0);var e={};this._renderField(e)}})}),csui.define("workflow/controls/form/fields/alpaca/alpcsuiitemreferencefield",["module","require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca.lite","csui/models/node/node.model","workflow/controls/form/fields/itempickerfield.view","i18n!workflow/controls/form/impl/nls/lang"],function(e,t,i,n,o,s,l,a,r,c){"use strict";return l.Fields.CsuiItemReferenceField=l.Fields.IntegerField.extend({"constructor":function(e,t,i,n,o,s,l){this.base(e,t,i,n,o,s,l),
this.on("showNodePickerDialog",this.actionTriggerShowNodePickerDialog)},"getFieldType":function(){return"item_reference_picker"},"postRender":function(e){this.base(e),this.showField()},"showField":function(){var e,t=this.id;this.options.id="lbl"+i.uniqueId(t);var l,a=n(this.field[0]).find("label");if(a&&1===a.length&&(l=a.attr("for")+"Label",a.attr("id",l)),this.options.isMultiFieldItem){var u=this.name,d=parseInt(u.substr(u.length-1));e=this.options.type_control[Object.keys(this.options.type_control)[d]],delete this.options.item}this.options.placeholder=c.alpacaPlaceholderItemReferencePicker,this.options.customField=!0,this.fieldView=new r({"context":this.connector.config.context,"formView":this.connector.config.formView,"model":new o.Model({"data":this.data?this.data:null,"options":this.options,"schema":this.schema,"typeControl":e,"multiFiedsItem":this.options.isMultiFieldItem,"id":t}),"id":i.uniqueId(t),"alpacaField":this,"labelId":l,"value":this.data,"readonly":!0,"dataId":this.name,"path":this.path,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema}});var p=n("<div>").addClass("alpaca-control");this.getControlEl().replaceWith(p),this.region=new s.Region({"el":p}),this.region.show(this.fieldView)},"setValueAndValidate":function(e,t){this.setValue(e);var i=!0;return t&&(i=this.validate(),this.refreshValidationState(!1)),i},"focus":function(){this.fieldView.$el.focus()},"destroy":function(){this.base(),this.region&&this.region.destroy()}}),l.registerFieldClass("item_reference_picker",l.Fields.CsuiItemReferenceField,"bootstrap-csui"),l.registerFieldClass("item_reference_picker",l.Fields.CsuiItemReferenceField,"bootstrap-edit-horizontal"),n.alpaca.Fields.ItemPickerField}),csui.define("workflow/widgets/workitem/workitem.properties/workitem.properties.view",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/lib/jquery","csui/utils/log","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/controls/form/form.view","csui/controls/globalmessage/globalmessage","workflow/widgets/message/message.view","workflow/widgets/workitem/workitem.properties/impl/workitem.instructions.view","workflow/utils/workitem.extension.controller","hbs!workflow/widgets/workitem/workitem.properties/impl/workitem.properties","i18n!workflow/widgets/workitem/workitem/impl/nls/lang","i18n!workflow/widgets/workitem/workitem.properties/impl/nls/lang","css!workflow/widgets/workitem/workitem.properties/impl/workitem.properties","workflow/controls/form/fields/alpaca/alpcsuirealfield","workflow/controls/form/fields/alpaca/alpcsuiitemreferencefield"],function(e,t,i,n,o,s,l,a,r,c,u,d,p,m,h){"use strict";var f=i.CollectionView.extend({"childView":a,"tagName":"div","className":"workflow-workitem-form cs-formview-wrapper","saveFormDeferred":[],"childViewOptions":function(t,i){var n=t.get("Columns"),o=n>1?"doubelCol":"singleCol";return e.extend({"layoutMode":o},this.options)},"onShow":function(){var t=this,i=[];this.options.node.set("saveFormsList",i,{"silent":!0}),this.saveFormDeferred=[],this.options.mode&&e.each(this.children._views,function(e){"create"===t.options.mode?(t.listenTo(e,"change:field",t.refreshSameDefFields),t.listenTo(e,"change:field",t.enableStartButton),t.options.node&&!0===t.options.node.get("isAttachmentCentric")&&t.listenTo(e,"change:field",t.updateWorkItemFormCollection),t.listenTo(e,"render:form",t.onRenderedForm)):(t.listenTo(e,"change:field",t._saveField),t.listenTo(e,"render:form",t.onRenderedForm))})},"_addValidationErrorElement":function(){var t=this.children._views;t[Object.keys(t)[0]].$el.before('<div class="metadata-validation-error"></div>'),this.validationErrorElem=n(this.$el.find(".metadata-validation-error")[0]),this.validationErrorElem.append('<button class="icon notification_error cs-close-error-icon" title="'+h.HideValidationErrorMessageIconTooltip+'" aria-label="'+h.HideValidationErrorMessageIconTooltip+'" ></button>'),this.validationErrorElem.append('<span class="validation-error-message">'+h.FormValidationErrorMessage+"</span>"),this.validationErrorElem.hide();var i=n(this.$el.find(".metadata-validation-error .cs-close-error-icon")[0]);i&&i.on("click",e.bind(function(e){e.preventDefault(),e.stopPropagation(),this._hideValidationError()},this))},"_validateForm":function(){var t,i=!0;return e.each(this.children._views,function(e){e.form&&(e.form.refreshValidationState(!0),t=e.form.isValid(!0),i=i&&t)}),i},"_saveForms":function(){var t=0,i=this.options.node;this.saveFormDeferred.push([]),e.each(this.children._views,e.bind(function(o){var s=o.form.getValue();if(e.keys(s).length){var l={"action":"formUpdate","values":s},a=n.Deferred(),c=i.get("saveFormsList");c.push(a.promise()),i.set("saveFormsList",c,{"silent":!0}),t++,this.saveFormDeferred.push([]),e.each(this.saveFormDeferred[t-1],e.bind(function(e){this.saveFormDeferred[t].push(e)},this)),this.saveFormDeferred[t].push(a),n.when.apply(n,this.saveFormDeferred[t-1]).done(e.bind(function(){o._blockActions(),o.model._saveChanges(l,o).done(e.bind(function(){a.resolve()},this)).fail(e.bind(function(e){r.showMessage("error",e.message),o.trigger("forms:error"),a.reject()},this)).always(e.bind(function(){o._unblockActions()},this))},this))}},this))},"onRenderedForm":function(){this.triggerMethod("rendered:formsView")},"_showValidationError":function(){void 0===this.validationErrorElem&&this._addValidationErrorElement(),this.$el.find(".alpaca-message-notOptional").length>0?this.validationErrorElem&&this.validationErrorElem.show():this.validationErrorElem&&this.validationErrorElem.hide()},"_hideValidationError":function(){this.validationErrorElem&&this.validationErrorElem.hide()},"_clearValidationError":function(){this.validationErrorElem&&(this.validationErrorElem.remove(),delete this.validationErrorElem)},"_saveField":function(t){this._showValidationError();var i=this.saveFormDeferred.length,o=t.view,s=this.children._views,l=o.form.getValue();if(e.keys(s).length>1&&e.each(s,function(t){if(o.cid!==t.cid){var i=t.form.getValue(),n=e.keys(i);if(n.length)for(var s=0;s<n.length;s++){var a=n[s];e.has(l,a)||(l[a]=i[a])}}}),this.args=t,this.values=l,this.name=t.parentField?t.parentField.name:t.name,e.keys(l).length&&o._validate(l)){var a={"action":"formUpdate","values":l};o._blockActions();var c=n.Deferred(),u=this.options.node.get("saveFormsList");u=e.filter(u,function(e){return"rejected"!==e.state()}),u.push(c.promise()),this.options.node.set("saveFormsList",u,{"silent":!0}),0===i&&(this.saveFormDeferred.push([]),i++),this.saveFormDeferred.push([]),this.saveFormDeferred[i-1]=e.filter(this.saveFormDeferred[i-1],function(e){return"rejected"!==e.state()}),e.each(this.saveFormDeferred[i-1],e.bind(function(e){this.saveFormDeferred[i].push(e)},this)),this.saveFormDeferred[i].push(c),n.when.apply(n,this.saveFormDeferred[i-1]).done(e.bind(function(){t.model._saveChanges(a,o).done(e.bind(function(){o.model.attributes.data[this.name]=this.values[this.name];this.checkSameDefField(this.args,!1),o.trigger("forms:sync");var e=n.Event("tab:content:field:changed");o.$el.trigger(e),c.resolve()},this)).fail(e.bind(function(e){r.showMessage("error",e.message),o.trigger("forms:error"),c.reject()},this)).always(e.bind(function(){o._unblockActions()},this))},this))}},"refreshSameDefFields":function(e){var t=!e.draftProcess||e.draftProcess;this.checkSameDefField(e,t)},"enableStartButton":function(e){if(!1===this.options.node.get("comments_on")&&(this.options.node.get("isDraft")||this.options.node.get("isNewDraft")||this.options.node.get("isDocDraft"))&&this.options.workitemView&&this.options.workitemView.footerView){var t=this.options.workitemView.footerView,i=t.collection.where({"label":"Start"}),n=t.children.findByModel(i[0]);if(n.el&&!0===n.el.disabled){var o={"validate":!1};this.options.node.trigger("form:isValid",o),o.validate&&(n.el.disabled=!1)}}},"updateWorkItemFormCollection":function(t){var i=t.view,n=this,o={};o.values=t.view.form.getValue(),o.name=t.parentField?t.parentField.name:t.name,o.currentfieldValue=o.values[o.name],e.each(n.options.node.forms.models,function(e){e===i.model&&o.name in e.attributes.data&&e.attributes.data[o.name]!==o.currentfieldValue&&(e.attributes.data[o.name]=o.currentfieldValue)})},"parseSection":function(t,i){var n=this.children._indexByModel[t.cid],o=this.children._views[n].form?this.children._views[n].form.childrenByPropertyId[i.name]:"",s=this.children._views[n];if(o)if("array"===o.type){var l=o.children.length,a=i.currentfieldValue.length,r=0;if(l!==a){if(this.stopListening(s,"change:field"),l>a)for(r=a;r<l;r++)o.removeItem(0,function(){});else if(l<a)for(r=l;r<a;r++){var c=o.children[0].options,u=o.children[0].schema;o.addItem(1,u,c,"",function(){})}"create"===this.options.mode?(this.listenTo(s,"change:field",this.refreshSameDefFields),this.options.node&&!0===this.options.node.get("isAttachmentCentric")&&this.listenTo(s,"change:field",this.updateWorkItemFormCollection)):this.listenTo(s,"change:field",this._saveField)}i.draftprocess||o._showItemsInReadMode(),e.each(o.children,function(e,t){e.data!==i.currentfieldValue[t]&&(e.setValueAndValidate(i.currentfieldValue[t],!0),e.refresh())})}else o.setValueAndValidate(i.currentfieldValue,!0),o.refresh()},"checkSameDefField":function(t,i){var n=t.view,o=this,s={};s.values=t.view.form.getValue(),s.name=t.parentField?t.parentField.name:t.name,s.draftprocess=i,s.currentfieldValue=s.values[s.name],e.each(n.collection.models,function(e){if(e!==n.model&&s.name in e.attributes.data&&e.attributes.data[s.name]!==s.currentfieldValue)e.attributes.data[s.name]=s.currentfieldValue,o.parseSection(e,s);else if(e===n.model&&t.changePerformer){var i=o.children._indexByModel[e.cid],l=o.children._views[i].form?o.children._views[i].form.childrenByPropertyId[s.name]:"";l&&(l.setValueAndValidate(s.currentfieldValue,!0),l.refresh())}})}}),w=i.LayoutView.extend({"className":"workflow-workitem-properties","template":p,"constructor":function(e){e||(e={}),this.context=e.context,this.parentView=e.parentView,this.extensions=e.extensions,i.LayoutView.prototype.constructor.call(this,e),this.propagateEventsToRegions()},"regions":{"message":".workitem-message","instructions":".workitem-instructions","forms":".workitem-forms","extension":".workitem-extension"},"ui":{"selectMultiMap":".workitem-multimap-select-message"},"behaviors":{"ScrollingProperties":{"behaviorClass":l,"suppressScrollX":!0,"scrollYMarginOffset":15}},"onRender":function(){if(this.model){var i=this.model.get("mapsList");!0===this.model.get("isDoc")&&i&&1!==i.length&&(this.ui.selectMultiMap.text(h.multiMapSelectMessage),this.ui.selectMultiMap.css("display","block"));var n=this.model.get("message");this.model.attributes.id=this.model.get("process_id"),n&&this.message.show(new c({"connector":this.model.connector,"model":new t.Model({"subject":n.type,"sender":n.performer,"text":n.text})})),this.instructions.show(new u({"context":this.context,"model":this.model}));var s=new f({"context":this.options.context,"collection":this.model.forms,"node":this.model,"mode":this.model.get("isDraft")||this.model.get("isDocDraft")||i&&1===i.length?"create":"update","workitemView":this.parentView.options.parentView});this.listenTo(s,"rendered:formsView",this.onRenderedFormsView),this.forms.show(s),this.listenTo(this.model,"form:saveForms",function(){s._saveForms()}),this.listenTo(this.model,"form:isValid",function(e){s._validateForm()?(e.validate=!0,s._clearValidationError()):s._showValidationError()});var l=this.model.get("data_packages");e.each(l,function(t){var i=e.find(this.extensions,function(e){return e.validate(t.type,t.sub_type)});i&&i.execute({"extensionPoint":d.ExtensionPoints.AddForm,"model":this.model,"data":t.data,"parentView":this}).done(e.bind(function(e){e&&(e.type=t.type,e.sub_type=t.sub_type,e.viewToShow&&this.extension.show(e.viewToShow))},this)).fail(e.bind(function(e){var t=m.ErrorMessageLoadExtension;e&&e.errorMsg&&e.errorMsg.length>0&&(t=e.errorMsg),r.showMessage("error",t)},this))},this)}else o.warn("Form view cannot displayed without data")},"onRenderedFormsView":function(){this.triggerMethod("dom:refresh")}});return e.extend(w.prototype,s),w}),csui.define("hbs!workflow/widgets/workitem/workitem.body/impl/workitem.body",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="workitem-body-row binf-row">\r\n  <div class="workitem-properties"></div>\r\n</div>\r\n\r\n'}});return i.registerPartial("workflow_widgets_workitem_workitem.body_impl_workitem.body",n),n}),csui.define("workflow/widgets/workitem/workitem.body/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/widgets/workitem/workitem.body/impl/nls/root/lang",{"NoModelWarning":"Form view cannot displayed without data"}),csui.define("css!workflow/widgets/workitem/workitem.body/impl/workitem.body",[],function(){}),csui.define("workflow/widgets/workitem/workitem.body/workitem.body.view",["csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/progressblocker/blocker","csui/controls/globalmessage/globalmessage","workflow/widgets/workitem/workitem.properties/workitem.properties.view","workflow/widgets/workitem/workitem.attachments/workitem.attachments.view","hbs!workflow/widgets/workitem/workitem.body/impl/workitem.body","i18n!workflow/widgets/workitem/workitem.body/impl/nls/lang","css!workflow/widgets/workitem/workitem.body/impl/workitem.body"],function(e,t,i,n,o,s,l,a,r,c){"use strict";var u=t.LayoutView.extend({"className":"workflow-workitem-body","template":r,"constructor":function(e){e||(e={}),this.context=e.context,this.parentView=e.parentView,this.extensions=e.extensions,e.originatingView&&e.originatingView.options&&!0===e.originatingView.options.isAttachmentCentric&&(this.parentView=e.originatingView.options.parentView,e.attachmentModel=e.model,delete e.model,e.model=e.originatingView.options.parentView.model),t.LayoutView.prototype.constructor.call(this,e),this.propagateEventsToRegions(),this.options.blockingParentView?o.delegate(this,this.options.blockingParentView):o.imbue(this)},"regions":{"properties":".workitem-properties"},"onRender":function(){this.model?this.properties.show(new l({"context":this.context,"model":this.model,"extensions":this.extensions,"parentView":this})):i.warn(c.NoModelWarning)}},{"enabled":function(e){var t=!1;return!(!(t=e.node&&e.node.get("shortcutNode")?e.node.get("shortcutNode").get("showWfPropertyMenuItem"):e.node.get("showWfPropertyMenuItem"))||!0!==t)&&(delete e.node.attributes.showWfPropertyMenuItem,!0)}});return e.extend(u.prototype,n),u}),csui.define("workflow/widgets/workitem/workitem.tabPanel/workitem.tabPanel.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/utils/contexts/factories/node","csui/controls/tab.panel/tab.panel.view","csui/controls/tab.panel/tab.links.ext.view","csui/controls/tab.panel/tab.links.ext.scroll.mixin"],function(e,t,i,n,o,s,l,a,r){"use strict";var c=l.extend({"contentView":function(e){return e.get("viewToRender")},"contentViewOptions":function(e){return e.get("viewToRenderOptions")},"constructor":function(t){e.defaults(t,{"tabType":"binf-nav-pills","delayTabContent":!1,"toolbar":!0,"TabLinkCollectionViewClass":a}),l.prototype.constructor.apply(this,arguments)},"render":function(){return l.prototype.render.apply(this),this._initializeToolbars(),this._listenToTabEvent(),setTimeout(e.bind(this._enableToolbarState,this),500),this}});return e.extend(c.prototype,r),c}),csui.define("workflow/widgets/workitem/workitem.attachmentcentric/impl/workitem.attachmentcentric.list.behavior",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette"],function(e,t,i,n){"use strict";return n.Behavior.extend({"constructor":function(t,i){n.Behavior.prototype.constructor.apply(this,arguments),e.extend(i,{"onBeforeShow":function(){this._showChildViews()},"onBeforeDestroy":function(){this.mdv&&this.mdv.internal&&this.mdv.destroy(),this.mdn&&this.mdn.destroy()},"_showChildViews":function(){this.navigationRegion.show(this.mdn),this.collection.length>0&&this.contentRegion.show(this.mdv)}})}})}),csui.define("hbs!workflow/widgets/workitem/workitem.attachmentcentric/impl/empty.attachmentcentric",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="workitem-no-attachments-view-header">\r\n  <div class="workitem-no-attachments-view-header-wrapper">\r\n    <div class="cs-tab-links binf-dropdown tile-nav">\r\n      <span class="dropdown-label"></span>\r\n      <button id="" type="button" class="binf-btn binf-btn-default binf-dropdown-toggle csui-acc-focusable-active" data-binf-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\r\n        <span class="workflow-label cs-label">'+e.escapeExpression((s=null!=(s=l(i,"propertylabel")||(null!=t?l(t,"propertylabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"propertylabel","hash":{},"loc":{"start":{"line":6,"column":46},"end":{"line":6,"column":63}}}):s))+'</span>\r\n        <span class="cs-icon icon-caret-down"></span>\r\n      </button>\r\n    <ul class="binf-dropdown-menu" role="menu" aria-labelledby="">\r\n      <li id="workflow-tab" data-workflow-tab="properties" role="none" class="binf-active">\r\n        <a role="menuitem" href="#" data-binf-toggle="tab" tabindex="-1" class="dropdown-link">\r\n        <span class="cs-label">'+e.escapeExpression((s=null!=(s=l(i,"propertylabel")||(null!=t?l(t,"propertylabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"propertylabel","hash":{},"loc":{"start":{"line":12,"column":31},"end":{"line":12,"column":48}}}):s))+'</span>\r\n        </a>\r\n      </li>\r\n      <li id="workflow-properties-tab" data-workflow-tab="wfproperties" role="none" >\r\n        <a role="menuitem" href="#" data-binf-toggle="tab" tabindex="-1" class="dropdown-link">\r\n        <span class="cs-label">'+e.escapeExpression((s=null!=(s=l(i,"wfpropertylabel")||(null!=t?l(t,"wfpropertylabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"wfpropertylabel","hash":{},"loc":{"start":{"line":17,"column":31},"end":{"line":17,"column":50}}}):s))+'</span>\r\n        </a>\r\n      </li>\r\n    </ul>\r\n    </div>\r\n  </div>\r\n</div>\r\n<div class="workitem-no-attachments-view-body">\r\n  <div class = "properties show-content">\r\n    <div class="workitem-no-attachments-view-content workitem-no-attachments-view-icon">\r\n      <p class="workitem-no-attachments-result-message" title="'+e.escapeExpression((s=null!=(s=l(i,"message")||(null!=t?l(t,"message"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"message","hash":{},"loc":{"start":{"line":27,"column":63},"end":{"line":27,"column":74}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"message")||(null!=t?l(t,"message"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"message","hash":{},"loc":{"start":{"line":27,"column":76},"end":{"line":27,"column":87}}}):s))+'</p>\r\n    </div>\r\n  </div>\r\n  <div class="workflow-attributes hide-content">...</div>\r\n</div>'}});return i.registerPartial("workflow_widgets_workitem_workitem.attachmentcentric_impl_empty.attachmentcentric",n),n}),csui.define("css!workflow/widgets/workitem/workitem.attachmentcentric/impl/empty.attachmentcentric",[],function(){}),csui.define("workflow/widgets/workitem/workitem.attachmentcentric/impl/empty.attachmentcentric.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","workflow/widgets/workitem/workitem.body/workitem.body.view","hbs!workflow/widgets/workitem/workitem.attachmentcentric/impl/empty.attachmentcentric","i18n!workflow/widgets/workitem/workitem/impl/nls/lang","css!workflow/widgets/workitem/workitem.attachmentcentric/impl/empty.attachmentcentric"],function(e,t,i,n,o,s){"use strict";return i.LayoutView.extend({"template":o,"className":"workitem-no-attachment-view","regions":{"wfattributes":".workflow-attributes"},"templateHelpers":function(){return{"message":s.NoAttachmentsMessage,"propertylabel":s.PropertyLabel,"wfpropertylabel":s.wfPropertyLabel}},"events":{"click .dropdown-link":"onDropDownLinkClick"},"constructor":function(e){i.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this,"show:workflowAttributes:tab:content",function(){this.showWfPropertyContent()})},"onRender":function(){this.options.model=this.options.parentView.model;var e=this.bodyView=new n(this.options);this.wfattributes&&this.wfattributes.show(e)},"onDropDownLinkClick":function(e){var t=e.target&&e.target.textContent;t===s.PropertyLabel?this.showPropertyContent():t===s.wfPropertyLabel&&this.showWfPropertyContent()},"showPropertyContent":function(){var e=this.$el.find(".properties"),t=this.$el.find(".workflow-attributes"),i=this.$el.find("#workflow-tab"),n=this.$el.find("#workflow-properties-tab"),o=this.$el.find("button .workflow-label");e.removeClass("hide-content"),e.addClass("show-content"),t.addClass("hide-content"),t.removeClass("show-content"),n.removeClass("binf-active"),i.addClass("binf-active"),1===o.length&&(o[0].innerText=s.PropertyLabel)},"showWfPropertyContent":function(){var e=this.$el.find(".properties"),t=this.$el.find(".workflow-attributes"),i=this.$el.find("#workflow-tab"),n=this.$el.find("#workflow-properties-tab"),o=this.$el.find("button .workflow-label");t.removeClass("hide-content"),t.addClass("show-content"),e.addClass("hide-content"),e.removeClass("show-content"),n.addClass("binf-active"),i.removeClass("binf-active"),1===o.length&&(o[0].innerText=s.wfPropertyLabel)}})}),csui.define("hbs!workflow/widgets/workitem/workitem.attachmentcentric/impl/workitem.attachmentcentric",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="metadata-wrapper binf-col-md-12">\r\n  <div class="metadata-navigation">\r\n    <div class="metadata-sidebar workitem-tabpanel binf-col-md-4 binf-col-sm-4">\r\n\t\r\n    <div class="workitem-tabpanel-header"></div>\r\n    <div class="workitem-tabpanel-content"></div>\r\n \r\n  </div>\r\n    <div class="metadata-content"></div>\r\n  </div>\r\n</div>\r\n'}});return i.registerPartial("workflow_widgets_workitem_workitem.attachmentcentric_impl_workitem.attachmentcentric",n),n}),csui.define("workflow/widgets/workitem/workitem.attachmentcentric/workitem.attachmentcentric.view",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/lib/jquery","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/widgets/metadata/metadata.view","csui/widgets/metadata/impl/metadatanavigation/metadatanavigation.view","workflow/widgets/workitem/workitem.attachmentcentric/impl/workitem.attachmentcentric.list.behavior","workflow/widgets/workitem/workitem.tabPanel/workitem.tabPanel.view","csui/controls/progressblocker/blocker","csui/utils/contexts/factories/metadata.factory","csui/utils/contexts/factories/next.node","csui/models/nodeversions","workflow/widgets/workitem/workitem.attachmentcentric/impl/empty.attachmentcentric.view","hbs!workflow/widgets/workitem/workitem.attachmentcentric/impl/workitem.attachmentcentric"],function(e,t,i,n,o,s,l,a,r,c,u,d,p,m,h){"use strict";return l.extend({"template":h,"behaviors":{"TabableRegionBehavior":{"behaviorClass":o,"initialActivationWeight":100},"MetadataNavigationListBehavior":{"behaviorClass":a}},"constructor":function(t){t||(t={}),c.imbue(this),i.LayoutView.prototype.constructor.apply(this,arguments),this.enableViewState=!0,!1===t.enableViewState&&(this.enableViewState=!1),this.context=t.context,this.collection=t.collection,this.container=t.container,this.containerCollection=t.containerCollection,this.originatingView=t.originatingView;var n=this._getInitiallySelectedModel();this.mdv=this.options.data&&this.options.data.contentView?this.options.data.contentView:new s({"model":n,"container":this.container,"containerCollection":this.containerCollection,"collection":this.collection,"context":this.context,"originatingView":this,"metadataNavigationView":this,"enableViewState":this.enableViewState}),this.options.data&&this.options.data.contentView||(this.mdv.internal=!0),this._subscribeToMetadataViewEvents(n),this.mdn=new r({"collection":this.options.tabPanelCollection});var o=this.mdn.activeTab.get("tabIndex"),l=this.mdn.collection.at(o);l.get("viewToRenderOptions").attachmentcentricview=this,l.get("viewToRenderOptions").attachmentCollection=this.collection,!this.options.originatingView||e.isFunction(this.options.originatingView.cascadeDestroy)&&!this.options.originatingView.cascadeDestroy()||this.listenTo(this.options.originatingView,"before:destroy",function(){this._closeMetadata()}),this.propagateEventsToRegions(),this.options.parentView&&this.listenTo(this.options.parentView,"show:workflowAttributes",function(){this.emptyAttachmentCentricView.trigger("show:workflowAttributes:tab:content")})},"onRender":function(){},"_moveToNextItemAfterDeleteOrMove":function(){},"_currentIndex":function(){},"_emptyView":function(){this.contentRegion.empty();var e=this.options.parentView.$el.find(".workitem-bravaview"),t=this.options.parentView.$el.find(".workitem-row-middle-section");e.length>0&&e.parent().length>0&&t.length>0&&(e.parent().hide(),t.addClass("fullexpand"));var i=this.emptyAttachmentCentricView=new m(this.options);this.contentRegion.show(i)},"_showNode":function(e){if(this.mdv&&this.mdv.internal&&this.mdv.destroy(),e.set("showWfPropertyMenuItem",!0),this.mdv=new s({"model":e,"container":this.container,"containerCollection":this.containerCollection,"collection":this.collection,"context":this.context,"originatingView":this,"metadataNavigationView":this,"enableViewState":this.enableViewState}),this.mdv.internal=!0,this.selectedProperty=void 0,this._subscribeToMetadataViewEvents(e),this.collection.length>0||e&&Object.keys(e.attributes).length>0&&e.collection.length>0)this.contentRegion.show(this.mdv),this.listenTo(this.mdv.metadataTabView,"before:activate:tab",this._toggleBravaView);else{var t=this.emptyAttachmentCentricView=new m(this.options);this.contentRegion.show(t)}},"_toggleBravaView":function(e,t,i){var n=this.options.parentView.$el.find(".workitem-bravaview"),o=this.options.parentView.$el.find(".workitem-row-middle-section");n.length>0&&n.parent().length>0&&o.length>0&&("workflow-properties"===i.model.get("name")?(n.parent().hide(),o.addClass("fullexpand")):(n.parent().show(),o.removeClass("fullexpand")))}})}),csui.define("hbs!workflow/widgets/workitem/workitem/impl/workitem",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="workitem-row-middle-section">\r\n<div class="workitem-row binf-row">\r\n  <div class="workitem-view-left binf-col-md-8 binf-col-sm-8 binf-col-xs-12">\r\n    <div class="workitem-header">"></div>\r\n    <div class="workitem-body"></div>\r\n  </div>\r\n  <aside role="complementary">\r\n  <div class="workitem-tabpanel binf-col-md-4 binf-col-sm-4">\r\n    <div class="workitem-tabpanel-header"></div>\r\n    <div class="workitem-tabpanel-content"></div>\r\n  </div>\r\n  </aside>\r\n</div>\r\n<footer role="contentinfo">\r\n<div class="workitem-footer cs-dialog binf-modal-footer"></div>\r\n</footer>\r\n</div>\r\n<aside role="complementary">\r\n<div class="workitem-bravaview binf-col-md-4 binf-col-sm-4">\r\n  </div>\r\n</aside>\r\n\r\n\r\n'}});return i.registerPartial("workflow_widgets_workitem_workitem_impl_workitem",n),n}),csui.define("hbs!workflow/widgets/workitem/workitem/impl/workitem.nopackages",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="workitem-header"></div>\r\n<div class="workitem-body"></div>\r\n<div class="workitem-footer cs-dialog binf-modal-footer"></div>\r\n\r\n'}});return i.registerPartial("workflow_widgets_workitem_workitem_impl_workitem.nopackages",n),n}),csui.define("hbs!workflow/widgets/workitem/workitem/impl/workitem.fullview",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="workitem-extension-fullview"></div>\r\n\r\n'}});return i.registerPartial("workflow_widgets_workitem_workitem_impl_workitem.fullview",n),n}),csui.define("workflow/widgets/workitem/workitem/workitem.view",["require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/dialogs/modal.alert/modal.alert","csui/controls/globalmessage/globalmessage","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/tab.panel/tab.panel.view","csui/controls/tab.panel/tab.links.ext.view","csui/models/member","csui/utils/contexts/factories/user","csui/utils/contexts/factories/application.scope.factory","csui/models/node/node.model","csui/utils/contexts/factories/node","csui/utils/commands/open.node.perspective","csui/models/nodes","csui/models/nodechildren","csui/models/node.children2/node.children2","csui/utils/commandhelper","csui/controls/progressblocker/blocker","csui/utils/commands/sign.out","workflow/commands/open.workitem/open.workitem","workflow/widgets/workitem/workitem.activities/workitem.activities.controller","workflow/widgets/workitem/workitem.attachments/workitem.attachments.controller","workflow/utils/workitem.extension.controller","workflow/utils/workitem.util","workflow/models/workitem/workitem.model.factory","workflow/dialogs/action.dialog/action.dialog","workflow/dialogs/action.dialog/action.dialog.model","workflow/widgets/workitem/workitem/impl/header.view","workflow/widgets/workitem/workitem/impl/footer.view","workflow/widgets/workitem/workitem.body/workitem.body.view","workflow/widgets/workitem/workitem.tabPanel/workitem.tabPanel.view","workflow/widgets/workitem/workitem.attachments/workitem.attachments.view","workflow/widgets/workitem/workitem.attachmentcentric/workitem.attachmentcentric.view","i18n!workflow/widgets/workitem/workitem/impl/nls/lang","hbs!workflow/widgets/workitem/workitem/impl/workitem","hbs!workflow/widgets/workitem/workitem/impl/workitem.nopackages","hbs!workflow/widgets/workitem/workitem/impl/workitem.fullview","csui-ext!workflow/widgets/workitem/workitem.view","css!workflow/widgets/workitem/workitem/impl/workitem"],function(e,t,i,n,o,s,l,a,r,c,u,d,p,m,h,f,w,g,b,v,k,y,x,C,_,D,M,T,A,P,L,I,E,S,V,O,F,N,R,B,j){"use strict";var U=n.Collection.extend({"comparator":function(e){return e.get("position")}}),W=o.LayoutView.extend({"className":"workitem-view","template":N,"regions":{"header":".workitem-header","body":".workitem-body","tabPanel":".workitem-tabpanel-content","bravaView":".workitem-bravaview","footer":".workitem-footer","fullview":".workitem-extension-fullview"},"ui":{"tabPanelHeader":".workitem-tabpanel-header","tabPanelContent":".workitem-tabpanel-content"},"_isSending":!1,"actionDialog":void 0,"constructor":function(e){this.tabPanelCollection=new U,e.model=e.model?e.model:e.context.getModel(T),this.user=e.context.getModel(d),this._addUrlParametersSupport(e.context),o.LayoutView.prototype.constructor.call(this,e),this.propagateEventsToRegions(),this.options.blockingParentView?k.delegate(this,this.options.blockingParentView):k.imbue(this),this.blockActions(),this.listenTo(this.model,"change",this.onModelChange),this.listenTo(this.model,"error",this.onModelError);var i=j;e.viewExtensions&&(i=e.viewExtensions),
this.extensions=t.chain(i).flatten(!0).map(function(t){return new t(e)}).value()},"tabNextRegion":function(){this.trigger("changed:focus")},"onModelError":function(e,i){var n=i.responseJSON&&(i.responseJSON.error?i.responseJSON.error:"");s.showWarning(n,F.ErrorTitleLoadWorkitem).always(t.bind(function(){this._leaveWorkitemPerspective()},this)),this.unblockActions()},"onModelChange":function(){var e=[];e.push(this.getTabPanelCollection()),e.push(this.getFullViewExtension()),i.when.apply(i,e).done(t.bind(function(e){if(!this.model.get("isDoc")&&!this.model.get("isDocDraft")||!0===this.model.get("datafetched")){this.replyPerformer=void 0;var i=this,n=this.model.get("reply_performer_id");if(n&&0!==n){var o=new u({"id":n},{"connector":this.model.connector});o.fetch().done(function(e,t){"success"===t&&(i.replyPerformer=o)})}if((this.model.get("isDoc")||this.model.get("isDocDraft"))&&!this.model.get("docModels")&&this.model.get("doc_id")){var s=this.model.get("doc_id").split(","),a=[],r=this,c={};t.each(s,function(e){r.options.context.getModel(h,{"attributes":{"id":parseInt(e)}},{"silent":!0}).fetch().done(t.bind(function(t){var i,n=r.model.get("workflowType"),o=t.name||t.results.data.properties.name,s=t.id||t.results.data.properties.id;i="101_1"===n?new m({"name":o,"original_id":s},{"connector":r.model.connector}):new m({"type":1,"type_name":"Shortcut","container":!1,"name":o,"original_id":s,"original_id_expand":t},{"connector":r.model.connector}),a.push(i),r.model.set({"docModels":a},{"silent":!0}),c[e]=o},r)).always(t.bind(function(e){s.length===r.model.get("docModels").length&&(this.model.set("doc_names",c,{"silent":!0}),this.render())},r)).fail(t.bind(function(e){l.showMessage("error",e.responseJSON.error)},r))})}else this.render()}},this))},"extensionsExecuteAction":function(e,n,o){var s,l=[];t.each(this.extensions,function(a){var r=i.Deferred();l.push(r.promise()),a.executeAction({"action":e,"options":n,"model":o}).done(t.bind(function(e){t.isUndefined(e)||(s=e,e.scope&&"custom"===e.scope&&(n.userPickerOptions=s)),r.resolve()},this)).fail(t.bind(function(e){r.reject()},this))});var a=i.Deferred();return i.when.apply(i,l).done(t.bind(function(){a.resolve(s)},this)).fail(t.bind(function(e){a.reject()},this)),a.promise()},"getTabPanelCollection":function(){this.tabPanelCollection.reset();var e=new U,n=this.model.get("data_packages");void 0!==n&&n.push({"type":C.prototype.type,"sub_type":C.prototype.sub_type,"data":{}});var o=[];t.each(n,function(n){var s=i.Deferred();o.push(s.promise());var a=t.find(this.extensions,function(e){return e.validate(n.type,n.sub_type)});a?a.execute({"extensionPoint":D.ExtensionPoints.AddSidebar,"model":this.model,"data":n.data,"parentView":this}).done(t.bind(function(i){i&&(i.type=n.type,i.sub_type=n.sub_type,i.viewToRender&&e.add(t.extend(i,{"id":t.uniqueId("workflow-tab")}))),s.resolve()},this)).fail(t.bind(function(e){var t=F.ErrorMessageLoadExtension;e&&e.errorMsg&&e.errorMsg.length>0&&(t=e.errorMsg),l.showMessage("error",t),s.resolve()},this)):s.resolve()},this);var s=i.Deferred();return i.when.apply(i,o).done(t.bind(function(){this.tabPanelCollection=e,s.resolve()},this)),s.promise()},"getFullViewExtension":function(){var e=[];this.fullViewExtension=void 0;var n=this.model.get("data_packages");t.each(n,function(n){var o=t.find(this.extensions,function(e){return e.validate(n.type,n.sub_type)});if(o){var s=i.Deferred();e.push(s.promise()),o.execute({"extensionPoint":D.ExtensionPoints.FullView,"model":this.model,"data":n.data,"parentView":this}).done(t.bind(function(e){e&&(e.type=n.type,e.sub_type=n.sub_type,e.viewToShow&&(this.extensionsFullView=e.viewToShow)),s.resolve()},this)).fail(t.bind(function(e){var t=F.ErrorMessageLoadExtension;e&&e.errorMsg&&e.errorMsg.length>0&&(t=e.errorMsg),l.showMessage("error",t),s.resolve()},this))}},this);var o=i.Deferred();return i.when.apply(i,e).done(function(){o.resolve()}),o.promise()},"onBeforeRender":function(){var e=[];this.model.set("saveFormsList",e,{"silent":!0}),void 0!==this.extensionsFullView?this.template=B:0===this.tabPanelCollection.models.length?this.template=R:this.template=N},"onRender":function(){if((!this.model.get("isDoc")&&!this.model.get("isDocDraft")||!0===this.model.get("datafetched"))&&!(this._isSending||!0!==this.model.get("datafetchedfromfactory")&&!0!==this.model.get("isDoc")))if(this.unblockActions(),this.isAttachmentCentric=this.model.get("isAttachmentCentric"),void 0!==this.extensionsFullView)this.fullview.show(this.extensionsFullView);else if(this.isAttachmentCentric){var e;!0!==this.model.get("attachments_on")?this.$el.addClass("workitem-attachment-centric").css({"flex-direction":"column"}):this.$el.addClass("workitem-attachment-centric");var i=this.model.get("data_packages");if(t.each(i,function(t){1===t.type&&1===t.sub_type&&(e=t.data)}),e){var n=this.options.context.getModel(h,{"attributes":{"id":e.attachment_folder_id}});this.attachmentCollection=new b(void 0,t.defaults({"autoreset":!0,"includeActions":!1,"delayRestCommands":!0,"fields":{"properties":[],"versions.element(0)":["owner_id"]},"expand":{"properties":["node","original_id"]},"commands":["openshortlink","download","properties","rename","delete","default","addcategory","open","edit","addversion","copy","move"]},{"node":n}));var o=this;this.attachmentCollection.fetch().done(t.bind(function(){if(o.attachmentCollection.length>=0){var e=new O({"container":n,"collection":o.attachmentCollection,"context":o.options.context,"tabPanelCollection":o.tabPanelCollection,"enableViewState":!1,"parentView":o,"isAttachmentCentric":o.isAttachmentCentric,"extensions":o.extensions});e.mdn.on("load:item",function(e){o._loadBrava(e.model)}),e.mdn.on("clear:item",function(){o.bravaView.empty()}),o.body.show(e),o._loadBrava(e.collection.at(0)),o.attachmentNavigationView=e}if(0===o.attachmentCollection.length){var t=o.$el.find(".workitem-bravaview"),i=o.$el.find(".workitem-row-middle-section"),s=!(o.model.get("isDocDraft")&&o.model.get("docModels")&&o.model.get("docModels").length>0);t.length>0&&t.parent().length>0&&i.length>0&&s&&(t.parent().hide(),i.addClass("fullexpand"))}}))}this._renderHeader(),this._renderFooter()}else this._renderHeader(),this._renderBody(),this._renderTabPanel(),this._renderFooter(),this.model.attributes.member_accept&&this._confirmMemberAccept()},"_loadBrava":function(e){e&&this.options.context&&csui.require(["csui/controls/doc.preview/doc.preview.view"],t.bind(function(t){this.documentPreviewView=new t({"model":1===e.get("type")&&e.original?e.original:e,"originatingView":this.attachmentNavigationView,"context":this.options.context,"skipDestroyUponCollectionRequest":!0}),this.bravaView.show(this.documentPreviewView),this.listenTo(this.documentPreviewView,"error:doc:preview",this._errorCallback)},this))},"_errorCallback":function(e){this.bravaView.empty(),this.documentPreviewView&&this.documentPreviewView.remove()},"_renderHeader":function(){var e={"iconLeft":"csui-icon-group title-icon assignment-workflow","title":this.model.title()};(this.model.get("isDoc")||this.model.get("isDocDraft"))&&this.model.get("mapsList")&&this.model.get("mapsList").length>1&&(e.multiMaps=!0,e.context=this.options.context,e.maps=this.model.get("mapsList"),e.model=this.model,e.originatingView=this);var t=this.headerView=new L(e);this.header.show(t)},"_renderBody":function(){this.options.parentView=this,this.options.extensions=this.extensions;var e=this.bodyView=new E(this.options);this.body.show(e)},"_renderTabPanel":function(){var e=this.model.get("mapsList");if(this.model.get("isDoc")&&this.model.get("datafetched")&&e&&1!==e.length){if(this.viewToShow=new V({"context":this.options.context,"view":this}),this.viewToShow.render(),this.viewToShow&&(this.tabPanel.show(this.viewToShow),this.ui.tabPanelHeader.addClass("workitem-doc-initiate"),this.ui.tabPanelContent.addClass("workitem-doc-initiate"),this.viewToShow.attachments))var t=this,n=setInterval(function(){i(".workitem-attachments").length>0&&(clearInterval(n),t.viewToShow.unblockActions(),t.viewToShow.list.show(t.viewToShow.attachments))},500)}else if(this.tabPanelCollection.models.length>0){var o=new S({"collection":this.tabPanelCollection});this.tabPanel.show(o)}},"_renderFooter":function(){var e=[],i={};if(this.model.actions&&this.model.customActions||!0===this.model.get("isDoc")){if(this.model.actions&&this.model.customActions){var o=this.model.actions.models,s=this.model.customActions.models;t.each(o,function(t){i={"label":t.get("label"),"toolTip":t.get("label"),"id":t.get("id")},e.push(i)}),t.each(s,function(t){i={"label":t.get("label"),"toolTip":t.get("label"),"id":t.get("id"),"default":!0},e.push(i)})}var l=this.model.get("mapsList");!0===this.model.get("isDoc")&&l&&1!==l.length&&(i={"label":F.StartButtonLabel,"disabled":!0,"default":!0},e.push(i)),i=this.model.get("isDraft")||this.model.get("isDocDraft")||this.model.get("isDoc")?{"label":F.CancelButtonLabel,"toolTip":F.CancelButtonLabel,"close":!0}:{"label":F.CloseButtonLabel,"toolTip":F.CloseButtonLabel,"close":!0},e.push(i);var a;this.extensionsFooterView(e,this.model).done(t.bind(function(t){a=t&&"custom"===t.scope?t.view:new I({"collection":new n.Collection(e)}),this.listenTo(a,"childview:click",this.onClickButton),this.footerView=a,this.footer.show(a)},this))}},"extensionsFooterView":function(e,n){var o,s=[];t.each(this.extensions,function(l){var a=i.Deferred();s.push(a.promise()),l.customizeFooter({"buttons":e,"model":n}).done(t.bind(function(e){t.isUndefined(e)||(o=e),a.resolve()},this)).fail(t.bind(function(e){a.reject()},this))});var l=i.Deferred();return i.when.apply(i,s).done(t.bind(function(){l.resolve(o)},this)).fail(t.bind(function(e){l.reject()},this)),l.promise()},"_confirmMemberAccept":function(){var e=this;s.confirmQuestion(F.MemberAcceptDialogMessage,F.MemberAcceptDialogTitle,{"centerVertically":!1,"buttons":{"showYes":!0,"labelYes":F.MemberAcceptAcceptButtonLabel,"showNo":!0,"labelNo":F.MemberAcceptCloseButtonLabel}}).always(function(t){t?(e._acceptWorkitem(),e.headerView.triggerMethod("setFocus")):e._rejectWorkitem()})},"_acceptWorkitem":function(){var e=this;this.model.sendMemberAcceptAction().done(function(){e._updateWorkitemPerformer(),l.showMessage("success",F.MemberAcceptedMessage)}).fail(function(t){var i;i=t.errorDetail&&"ErrCode_Accept_Task"===t.errorDetail?F.MemberAcceptErrorDescription:t.error,s.showWarning(i,F.MemberAcceptErrorTitle).always(function(){e._leaveWorkitemPerspective()})})},"_rejectWorkitem":function(){this._leaveWorkitemPerspective()},"_updateWorkitemPerformer":function(){var e=[],i=this.options.parentView.bodyView.properties.currentView,n=i.forms.currentView;if(n&&n.children){var o=n.children._views;if(t.each(o,function(i){var n=i.model,o=n.attributes.data;t.has(o,"WorkflowForm_Performer")&&e.push(i)}),e.length>0){var s={},l=this.options.parentView.user.get("id"),a={"name":"WorkflowForm_Performer","path":"/WorkflowForm_Performer","value":l},r={};s.view=e[0],s.model=e[0].model,s.changePerformer=!0,s.draftProcess=!1,t.extend(s,{"name":"WorkflowForm_Performer","path":"/WorkflowForm_Performer","value":l,"targetField":a}),s.view.form&&s.view.form.data&&(r=s.view.form.data),r[a.name]=s.value,s.view.form.setValue(r),n.refreshSameDefFields(s,s.draftProcess)}var c=i.getChildView("extension");c&&c.triggerMethod("change:performer")}},"getTemplate":function(){return this.model.get("isDoc")&&this.model.get("docModels")?N:this.template},"onClickButton":function(e){var n=e.model;if(n.get("close"))this._leaveWorkitemPerspective();else{var o={"validate":!1};!0===this.isAttachmentCentric&&this.attachmentCollection.length>0?(this.isInitialwfPropertyShown=!0,0===this.$el.find(".workflow-workitem-body").length?this.isFormValidatedAganistRequireFields()?this._ExecuteAction(n.get("id"),e):(this.showWfPropertiesmetadataDropDownView(),this.isInitialwfPropertyShown=!1,this.ActionButtonView=e,this.listenTo(this.attachmentNavigationView.mdv.metadataTabView,"activate:tab",function(e,t,i){"workflow-properties"===i.model.get("name")&&!1===this.isInitialwfPropertyShown&&(this.model.trigger("form:isValid",o),this.isInitialwfPropertyShown=!0,o.validate&&this._ExecuteAction(this.ActionButtonView.model.get("id"),this.ActionButtonView))})):this.model.trigger("form:isValid",o),this.$el.find(".workflow-workitem-body").length>=1&&!0===this.isInitialwfPropertyShown&&!0===this.isAttachmentCentric&&this.$el.find(".workflow-workitem-body").is(":hidden")&&this.showWfPropertiesmetadataDropDownView()):(this.model.trigger("form:isValid",o),!1===o.validate&&this.trigger("show:workflowAttributes")),o.validate&&((this.model.get("isDraft")||this.model.get("isDocDraft")||this.model.get("isDoc"))&&this.model.trigger("form:saveForms"),e.el.disabled=!0,this.blockActions(),i.when.apply(i,this.model.get("saveFormsList")).done(t.bind(function(){this._ExecuteAction(n.get("id"),e)},this)).fail(t.bind(function(t){e.el.disabled=!1},this)).always(t.bind(function(e){this.unblockActions()},this)))}},"_ExecuteAction":function(e,i){var o=this.model.actions.get(e);t.isUndefined(o)&&(o=this.model.customActions.get(e));var l={};switch(o.get("key")){case"Delegate":l={"requireAssignee":!0,"assignee":this.user};break;case"Review":l={"requireAssignee":!0,"assignee":this.user,"assigneeOptions":!0,"durationOption":!0,"texts":{"assigneeLabel":F.AssigneePickerLabelSendTo,"commentLabel":F.CommentTextFieldLabelInstructions,"commentPlaceholder":F.CommentTextFieldPlaceholderInstructions,"submitLabel":F.SubmitLabelSend}};break;case"Reply":l={"readonlyAssignee":!0,"assignee":this.replyPerformer,"texts":{"assigneeLabel":F.AssigneePickerLabelTo,"commentLabel":F.CommentTextFieldLabelReply,"commentPlaceholder":F.CommentTextFieldPlaceholderReply,"submitLabel":F.SubmitLabelSend}}}this.extensionsExecuteAction(o,l,this.model).done(t.bind(function(e){if(e&&"custom"===e.scope){var a=new n.Model(e.data);this._sendOnWorkitem(a)}else if(void 0!==this.tabPanelCollection&&this.tabPanelCollection.length>0){var r=t.filter(this.tabPanelCollection.models,function(e){if(1===e.get("type")&&1===e.get("sub_type"))return!0});if(r.length>0){var c=new g(void 0,{"node":r[0].get("viewToRenderOptions").model,"fields":{"properties":["id","reserved","name"]}});c.fetch().done(t.bind(function(e){var n=t.filter(e.data,function(e){return e.reserved}),a=this;if(n.length>0){var r={};r.buttons=s.buttons.OkCancel;var c="";t.each(n,function(e){c=c+" "+e.name});var u=t.str.sformat(F.ReserveDocumentMessageText,c);s.confirmWarning(u,F.ReserveDocumentMessageTitle,r).then(function(){a._sendOnWorkitem_check(o,l,i)})}else a._sendOnWorkitem_check(o,l,i)},this))}else this._sendOnWorkitem_check(o,l,i)}else this._sendOnWorkitem_check(o,l,i)},this)).fail(t.bind(function(e){i.el.disabled=!1},this))},"_sendOnWorkitem_check":function(e,i,n){var o=new P(t.extend({"title":t.str.sformat(F.DialogModelTitle,e.get("label"),this.model.get("title")),"requireComment":this.model.get("comments_on"),"authentication":this.model.get("authentication"),"currentUser":this.user.get("display_name"),"action":e},i));o.get("requireComment")||o.get("requireAssignee")||o.get("authentication")?(this.actionDialog=new A({"context":this.options.context,"model":o,"callback":t.bind(this._sendOnWorkitem,this)}),this.listenTo(this.actionDialog,"destroy",t.bind(function(){this.$el.trigger("focus")},n)),this.actionDialog.$el.on("shown.binf.modal",function(){n.el.disabled=!1}),this.actionDialog.show()):this._sendOnWorkitem(o)},"_getRespError":function(e){var t="";return e&&e.responseJSON&&e.responseJSON.error?t=e.responseJSON.error:e&&e.responseText&&(t=e.responseText),t},"_getRespErrorDetail":function(e){var t="";return e&&e.responseJSON&&e.responseJSON.errorDetail&&(t=e.responseJSON.errorDetail),t},"_navigateToDocParentNode":function(){var e=new f,t=this.options.context.getModel(h,{"attributes":{"id":this.model.get("parent_id")}}),i={};i.context=this.options.context,i.nodes=new w([t]);var n=e.execute(i);v.handleExecutionResults(n,{"command":this.nodesCommand,"suppressSuccessMessage":i.suppressSuccessMessage})},"_signOut":function(){var e=new y,t={};t.context=this.options.context;var i=e.execute(t);v.handleExecutionResults(i,{"command":this.signOutCommand,"suppressSuccessMessage":t.suppressSuccessMessage})},"_sendOnWorkitem":function(e,i){this._isSending=!0;var n=e.get("action"),o=e.get("comment");t.isUndefined(o)||0===o.length||this.model.set("comment",o,{"silent":!0});var a=e.get("assignee");t.isUndefined(a)||this.model.set("assignee",a.get("id"),{"silent":!0});var r=e.get("assigneeOption");t.isUndefined(r)||this.model.set("assigneeOption",r,{"silent":!0});var c=e.get("authentication_info");t.isUndefined(c)||this.model.set("authentication_info",c,{"silent":!0});var u=e.get("duration");t.isUndefined(u)?this.model.set("duration","",{"silent":!0}):this.model.set("duration",u,{"silent":!0});var d=e.get("duration_unit");t.isUndefined(d)||this.model.set("duration_unit",d,{"silent":!0}),this.model.sendAction(n).done(t.bind(function(e){e&&e.custom_message?l.showMessage("success",e.custom_message):this.model.get("isDraft")||this.model.get("isDocDraft")||this.model.get("isDoc")?l.showMessage("success",F.SuccessInitiateMessage):l.showMessage("success",F.SuccessSendOnMessage);var i="";if(i=this.model.get("url_org"),e&&e.WRID&&e.WorkID&&(this.model.set({"webReportId":e.WRID,"WorkId":e.WorkID},{"silent":!0}),this._navigateToWebreport(this.model)),e&&e.auto_display)if(!0===e.auto_display.workflow_open_in_smart_ui)this.model.reset({"silent":!0}),this._isSending=!1,this.model.set({"process_id":e.auto_display.process_id,"subprocess_id":e.auto_display.subprocess_id,"task_id":e.auto_display.task_id,"url_org":i});else{var n=x.extend({"openInNewTab":!1,"getUrlQueryParameters":function(e,t){return{"func":"work.EditTask","workid":e.get("process_id"),"subworkid":e.get("subprocess_id"),"taskid":e.get("task_id"),"nexturl":e.get("url_org")}}}),o=new n;this.model.set({"process_id":e.auto_display.process_id,"subprocess_id":e.auto_display.subprocess_id,"task_id":e.auto_display.task_id,"url_org":i},{"silent":!0});var s=this.model;o._navigateTo(s)}else this._leaveWorkitemPerspective();t.isUndefined(this.actionDialog)||this.actionDialog.destroy()},this)).fail(t.bind(function(e){var i=this._getRespError(e),o=this._getRespErrorDetail(e),l=t.str.sformat(F.ActionFailMessageTitle,n.get("label")),a=t.str.sformat(F.ActionFailMessage,n.get("label"),i);t.isUndefined(this.actionDialog)||"662306821"!==o?(t.isUndefined(this.actionDialog)||this.actionDialog.destroy(),s.showError(a,l).always(t.bind(function(){"662306841"===o&&this._signOut()},this))):this.actionDialog.model.set("authentication_error",i),this._isSending=!1},this))},"_navigateToWebreport":function(e){(new(x.extend({"openInNewTab":!0,"getUrlQueryParameters":function(e,t){return{"func":"ll","objAction":"RunReport","objId":e.get("webReportId"),"WorkId":e.get("WorkId"),"nexturl":e.get("url_org")}}})))._navigateTo(e)},"_leaveWorkitemPerspective":function(){var e=this.options.context.viewStateModel,t=this.model.get("url_org");t&&t.length>0&&t.indexOf("?func")>=0?window.open(t,"_self"):e.get("lastRouter")?(e.set("disableLastRouterOnChange",!0),e.restoreLastRouter()):this.options.context.getModel(p).set("id","")},"showWfPropertiesmetadataDropDownView":function(){var e=this.attachmentNavigationView.mdv.metadataTabView.tabLinks,t=e&&e.collection.filter(function(e){return"workflow-properties"===e.get("name")});if(t&&t.length>0){var i=t[0],n=e.children._indexByModel[i.cid],o=e.children._views[n],s=i.collection.indexOf(i);if(o){o.$el.hasClass("binf-active")||(o.triggerMethod("clear:active:tab"),o.ui.link.binf_tab("show")),o._parent.options.activeTab&&o._parent.options.activeTab.set("tabIndex",s),o.triggerMethod("click:link"),o._parent.$el.removeClass("binf-open");o._parent.$el.find("button.binf-dropdown-toggle").attr("aria-expanded","false")}}},"isFormValidatedAganistRequireFields":function(){var e=0,t=!0;if(this.model.forms&&this.model.forms.models)for(;!t&&e<this.model.forms.models.length;e++){for(var i=Object.keys(this.model.forms.models[e].attributes.schema.properties),n=0,o=!0;!o&&n<i.length;n++)this.model.forms.models[e].attributes.schema.properties[i[n]].required&&(o=o&&!!this.model.forms.models[e].attributes.data[i[n]]);t=t&&o}return t},"getDefaultUrlParameters":function(){return["attachmentsview"]},"_addUrlParametersSupport":function(e){var t=e&&e.viewStateModel;this.enableViewState=t&&t.addUrlParameters(this.getDefaultUrlParameters(),e)}});return t.extend(W.prototype,a),W}),csui.define("workflow/models/wfstatus/wfstatus.table.model",["csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/fetchable/fetchable.mixin","csui/models/fetchable","csui/models/mixins/v2.additional.resources/v2.additional.resources.mixin","csui/models/mixins/v2.fields/v2.fields.mixin","csui/models/mixins/v2.expandable/v2.expandable.mixin","csui/models/mixins/v2.commandable/v2.commandable.mixin","csui/models/browsable/v2.response.mixin","csui/models/browsable/browsable.mixin","csui/models/nodechildrencolumn","csui/models/nodechildrencolumns","csui/models/node/node.model","workflow/utils/workitem.util","i18n!csui/models/widget/nls/lang","csui/utils/deepClone/deepClone"],function(e,t,i,n,o,s,l,a,r,c,u,d,p,m,h,f,w){"use strict";var g=p.extend({"constructor":function(e,t){p.prototype.constructor.call(this,e,t)}}),b=m.extend({"model":g,"getColumnModels":function(t,i){var n=m.prototype.getColumnModels.call(this,t,i);return e.each(n,function(e){["status_key","due_date","wf_name","date_initiated"].indexOf(e.column_key)>=0&&(e.sort=!0)}),n},"getV2Columns":function(t){var i=t.results&&t.results[0]&&t.results[0].definitions&&t.results[0].definitions.wfstatus||{},n=e.keys(i);return this.getColumnModels(n,i)}}),v=h.extend({"parse":function(e,t){if(e.data&&e.data.wfstatus){var i={},n=0;i.assignees=e.data.wfstatus.assignee,i.isWfstatusAssigneeColumn=!0,1===i.assignees.length&&(n=i.assignees[0].userId),e.data.wfstatus.assignedto&&(e.data.wfstatus.assignedto.assignees=i.assignees),i.assignedto=e.data.wfstatus.assignedto,e.data.wfstatus.userId=n,e.data.wfstatus.assignee=f.getAssignee(i),e.data.properties=e.data.wfstatus,e.data.permissions=e.permissions}return h.prototype.parse.call(this,e,t)}}),k=t.Collection.extend(e.extend({},s(t.Collection),{"model":v,"constructor":function(i,n){t.Collection.prototype.constructor.apply(this,arguments),n&&(this.options=e.pick(n,["connector","autoreset","includeResources","fields","expand","commands","status","retention","wfstatusfilter","filterWorkflowtype","filterWorkflows","selectionType","isFilterVisible","statusListCount","chatSettings","referenceid"])),this.makeConnectable(n).makeFetchable(n).makeAdditionalResourcesV2Mixin(n).makeFieldsV2(n).makeExpandableV2(n).makeCommandableV2(n).makeBrowsable(n),this.columns=new b},"clone":function(){var e=new this.constructor(this.models,this.options);return this.columns&&e.columns.reset(this.columns.toJSON()),e.actualSkipCount=this.actualSkipCount,e.wfstatus=this.model,e.totalCount=this.totalCount,e.filteredCount=this.filteredCount,e},"url":function(){var t=this.connector.connection.url.replace("/v1","/v2"),n=i.combine(t,"/workflows/status"),o=this.options.filterWorkflowtype,s=this.options.retention,l=this.options.selectionType,a=this.options.wfstatusfilter,r=this.options.referenceid,c=this.options.status,u=this.filters,d=this.orderBy;return o||(o=f.getWorkflowtype(this.options.filterWorkflows)),n+="?selectionType="+l,a&&""!==a?n+="&wfstatusfilter="+a:(n+="&wfretention="+s,n+="&kind="+o),r&&(n+="&nodeid="+r),u&&u.wf_name&&(n+="&search_name="+u.wf_name),e.each(c,function(e){""!==e&&(n+="&wstatus="+e)}),d&&(n+="&sort="+d),n},"parse":function(e,t){return this.parseBrowsedState(e,t),this.columns&&this.columns.resetColumnsV2(e,this.options),this.parseBrowsedItems(e,t)},"getResourceScope":function(){return e.deepClone({"fields":this.fields,"expand":this.expand,"includeResources":this._additionalResources,"commands":this.commands})},"fetchdata":function(e){return e&&(this.options=e),this.Fetchable.fetch.apply(this,arguments)},"setResourceScope":function(e){this.excludeResources(),e.includeResources&&this.includeResources(e.includeResources),this.resetFields(),e.fields&&this.setFields(e.fields),this.resetExpand(),e.expand&&this.setExpand(e.expand),this.resetCommands(),e.commands&&this.setCommands(e.commands)}})),y=k.prototype._compareValues;return k.prototype._compareValues=function(e,t,i){if(e.indexOf("date")>=0){if(null===t)return 1;if(null===i)return-1}return y.apply(this,arguments)},d.mixin(k.prototype),u.mixin(k.prototype),n.mixin(k.prototype),o.mixin(k.prototype),l.mixin(k.prototype),a.mixin(k.prototype),r.mixin(k.prototype),c.mixin(k.prototype),k}),csui.define("workflow/models/wfstatus/wfstatus.collection.factory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","workflow/models/wfstatus/wfstatus.table.model","csui/utils/deepClone/deepClone"],function(e,t,i,n,o,s){"use strict";return n.extend({"propertyPrefix":"wfstatus-list","constructor":function l(a,r){n.prototype.constructor.apply(this,arguments);var c=this.options.wfstatus||{};if(!(c instanceof i.Collection)){var u=a.getObject(o,r),d=e.config();c=new s(c.models,t.extend({"connector":u},this.options,d.options,l.getDefaultResourceScope(),{"autoreset":!0}))}this.property=c},"fetch":function(e){return this.property.fetch(e)},"isFetchable":function(){return!window.csui||!window.csui.mobile||!this.property.fetched}},{"getDefaultResourceScope":function(){return t.deepClone({"fields":{"wfstatus":[]},"includeResources":["metadata"]})}})}),csui.define("hbs!workflow/controls/visualdata/impl/wfdonut",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="wf-status-visual-data-container"></div>'}});return i.registerPartial("workflow_controls_visualdata_impl_wfdonut",n),n}),csui.define("css!workflow/controls/visualdata/impl/wfdonut",[],function(){}),csui.define("workflow/controls/visualdata/visual.data.donut.view",["csui/lib/underscore","csui/lib/marionette","csui/lib/jquery","csui/lib/d3","hbs!workflow/controls/visualdata/impl/wfdonut","css!workflow/controls/visualdata/impl/wfdonut"],function(e,t,i,n,o){"use strict";return t.ItemView.extend({"className":"wf-status-donut-piechart","template":o,"rootElementType":"svg","defaults":{"marginTop":10,"marginTopp":60,"marginRight":0,"marginBottom":0,"marginLeft":20,"groupAfter":0},"ui":{"dataVisContainer":".wf-status-visual-data-container"},"onDestroy":function(){i(window).off("resize.app",this.render),i(".wfstatus-donut-chart-tooltip.toolTip").remove()},"constructor":function(e){this.options=e,this.parentEle=this.options.parent.$el,t.ItemView.prototype.constructor.call(this,e),i(window).on("resize.app",this.render)},"onRender":function(){function t(t){if(0===t)return 0;var i=0;return e.each(m,function(e){t>0&&0!==e.count&&i++,t--}),i}function o(t){var i=0;return e.each(t,function(e){0!==e.count&&i++}),i}function s(e,t){var n=0,o=document.createElement("span");return o.innerText=e.data.count,o.style.visibility="hidden",i("body")[0].appendChild(o),n=i(o).width(),i("body")[0].removeChild(o),n}var l;this.uniqueID=e.uniqueId("vis_");var a=this.width()>0?this.width():i(this.$el).width()-this.marginLeft()-this.marginRight(),r=this.height()>0?this.height():i(this.$el).height()-this.marginTop()-this.marginBottom();this.visElement=n.select(this.ui.dataVisContainer[0]).append(this.rootElementType).attr("id",this.uniqueID).attr("focusable",!1).attr("width",a+this.marginLeft()+this.marginRight()).attr("height",r-this.marginTopp()),this.visElement.append("g").attr("transform","translate("+this.marginLeft()+",-40)").attr("class","vis-wrapper"),this.visElement.select(".vis-wrapper").append("g").attr("class","pie-chart").attr("transform","translate("+this.width()/4+","+this.height()/2+")"),this.visElement.select(".vis-wrapper").append("g").attr("class","pie-legend-container").attr("transform","translate("+(this.width()/3*2-30-30)+","+this.height()/2+")"),l=i(".wfstatus-donut-chart-tooltip.toolTip").length<1?n.select("body").append("div").attr("class","wfstatus-donut-chart-tooltip toolTip"):n.select(".wfstatus-donut-chart-tooltip");var c=this,u=c.visElement,d=["#f3794e","#09bcef","#ff3333","#8cc53e"],p=n.scaleOrdinal(d),m=this.options.dataset,h=Math.min(a/4,r/3)+10;a=this.width()-this.marginLeft()-this.marginRight(),r=this.width()-this.marginTop()-this.marginBottom();var f=n.arc().innerRadius(h/1.35).outerRadius(h),w=n.pie().sort(null).value(function(e){return e.count});u.select(".pie-chart").selectAll(".arc").data(w(m)).enter().append("g").attr("class","arc").style("cursor","pointer").append("path").attr("d",f).attr("tabindex",function(e,t){return e.data.count?0:-1}).attr("focusable",function(e,t){return!!e.data.count}).attr("fill-opacity",.9).style("fill",function(e,t){return p(t)}).on("keyup",function(e){9===n.event.keyCode&&u.select(".pie-chart").selectAll(".arc").filter(function(t,i){return t.data.status===e.data.status}).attr("stroke","#ffffff").attr("stroke-opacity","0.7").transition().duration(0).attr("stroke-width",1)}).on("focusout",function(e){u.select(".pie-chart").selectAll(".arc").filter(function(t,i){return t.data.status===e.data.status}).attr("stroke","none")}).on("keydown",function(e){13===n.event.keyCode&&(n.event.data={"status":e.data.status},c.options.parent.triggerMethod("click:segment",n.event))}).on("mouseover",function(e){return l.text(e.data.count+" "+c.options.statusArray[e.data.status]),l.style("visibility","visible")}).on("mousemove",function(e){l.text(e.data.count+" "+c.options.statusArray[e.data.status]);var t=n.mouse(n.select("body").node());return l.style("top",t[1]-25+"px").style("left",t[0]-10+"px")}).on("mouseout",function(e){return l.text(e.data.count+" "+c.options.statusArray[e.data.status]),l.style("visibility","hidden")}).on("click",function(e){n.event.data={"status":e.data.status},c.options.parent.triggerMethod("click:segment",n.event)});var g=u.select(".pie-chart").append("g").attr("class","pie-total-container").style("cursor","pointer");g.append("text").attr("tabindex","0").attr("class","total-count").attr("transform","translate(0,-11)").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("fill","#cccccc").text(this.totalCount(m)).on("focusout",function(e){g.attr("stroke","none")}).on("keydown",function(e){13===n.event.keyCode&&c.options.parent.triggerMethod("click:segment",n.event)}).on("keyup",function(e){9===n.event.keyCode&&g.attr("stroke","#ffffff").attr("stroke-opacity","0.7").transition().duration(0).attr("stroke-width",1)}),g.append("text").attr("class","total-text").attr("transform","translate(0,31)").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("fill","#cccccc").text(c.options.totalLabel);var b=function(){var e,t=m.length||1;return e=2*r/t/2,e=e<14?14:e,e=e>24?24:e}()+12,v=u.select(".pie-legend-container");v.style("font-size",b/2+"px");var k=v.selectAll(".pie-legend").data(w(m)).enter().append("g").attr("class","pie-legend").on("mouseover",function(e){u.select(".pie-chart").selectAll(".arc").filter(function(t,i){return t.data.status===e.data.status}).attr("stroke","red").transition().duration(1e3).attr("stroke-width",2)}).on("mouseout",function(e){u.select(".pie-chart").selectAll(".arc").filter(function(t,i){return t.data.status===e.data.status}).attr("stroke","none")}).on("click",function(e){n.event.data={"status":e.data.status},c.options.parent.triggerMethod("click:segment",n.event)});k.append("text").attr("class","pie-legend-text wf-legend-text").attr("tabindex",function(e,t){return e.data.count?0:-1}).attr("focusable",function(e,t){return!!e.data.count}).on("keydown",function(e){13===n.event.keyCode&&(n.event.data={"status":e.data.status},c.options.parent.triggerMethod("click:segment",n.event))
}).attr("dy","1.2em").attr("transform",function(e,i){var n=b*o(m)/2-10;return"translate("+(s(e,i)+b+24)+","+(t(i)*b-n)+")"}).attr("fill","#cccccc").text(function(e,t){return e.data.count?c.options.statusArray[e.data.status]:""}).on("keyup",function(e){9===n.event.keyCode&&k.filter(function(t,i){return t.data.status===e.data.status}).attr("stroke","#ffffff").attr("stroke-opacity","0.7").transition().duration(0).attr("stroke-width",1)}).on("focusout",function(e){k.filter(function(t,i){return t.data.status===e.data.status}).attr("stroke","none")}),k.append("text").attr("class","pie-legend-text wf-legend-count").attr("dy","1.2em").attr("transform",function(e,i){var n=b*o(m)/2;return"translate(36,"+(t(i)*b-n)+")"}).text(function(e,t){return e.data.count?e.data.count:""}).attr("fill",function(e,t){return p(t)}),k.style("cursor","pointer")},"marginTop":function(){return this.defaults.marginTop},"marginBottom":function(){return this.defaults.marginBottom},"marginLeft":function(){return this.defaults.marginLeft},"marginRight":function(){return this.defaults.marginRight},"marginTopp":function(){return this.defaults.marginTopp},"width":function(){return this.parentEle.width()-this.marginLeft()-this.marginRight()},"height":function(){return this.parentEle.height()-this.marginTop()-this.marginBottom()},"totalCount":function(t){var i=0;return e.each(t,function(e){i+=e.count}),i}})}),csui.define("workflow/controls/behaviors/wfstatus.infinite.scrolling.behavior",["csui/lib/jquery","csui/controls/tile/behaviors/infinite.scrolling.behavior"],function(e,t){"use strict";return t.extend({"_checkScrollPosition":function(){var t=e(this.options.contentParent),i=t.height(),n=t[0].scrollHeight;t.scrollTop()+30>=n-i&&e("#footerview").trigger("click")}})}),csui.define("workflow/controls/infinite.table/infinite.table.view",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/moment","csui/lib/backbone","csui/lib/marionette","csui/controls/table/table.view","csui/utils/commands","csui/utils/defaultactionitems","workflow/controls/behaviors/wfstatus.infinite.scrolling.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/lib/perfect-scrollbar"],function(e,t,i,n,o,s,l,a,r,c,u){"use strict";return l.extend({"constructor":function e(t){e.__super__.constructor.apply(this,arguments)},"behaviors":{"PerfectScrolling":{"behaviorClass":u,"contentParent":"tbody","suppressScrollX":!0},"InfiniteScrolling":{"behaviorClass":c,"contentParent":"tbody","content":"tbody>tr:visible","fetchMoreItemsThreshold":10}}})}),csui.define("workflow/widgets/wfstatus/wfstatus.columns",["csui/lib/backbone"],function(e){"use strict";var t=e.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0}}),i=e.Collection.extend({"model":t,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new i(this.map(function(e){return e.attributes}))}});return new i([{"key":"status_key","sequence":10},{"key":"due_date","sequence":20},{"key":"wf_name","sequence":30},{"key":"step_name","sequence":40},{"key":"assignee","sequence":50},{"key":"date_initiated","sequence":60}])}),csui.define("workflow/models/wfstatus/wfstatus.column.factory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","workflow/models/wfstatus/wfstatus.collection.factory"],function(e,t,i,n,o){"use strict";return n.extend({"propertyPrefix":"wfstatus_columns","constructor":function(e,t){n.prototype.constructor.apply(this,arguments);var s=this.options.columns||{};if(!(s instanceof i.Collection)){s=e.getCollection(o,t).columns}this.property=s}})}),csui.define("hbs!workflow/widgets/wfstatus/impl/wfstatuslist",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="wfstatus-table">\r\n  <div id="tableview"></div>\r\n  <div id="footerview"></div>\r\n</div>\r\n'}});return i.registerPartial("workflow_widgets_wfstatus_impl_wfstatuslist",n),n}),csui.define("css!workflow/widgets/wfstatus/impl/wfstatus",[],function(){}),csui.define("workflow/widgets/wfstatus/impl/wfstatus.list.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","csui/controls/table/rows/description/description.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/widgets/nodestable/nodestable.view","csui/controls/toolbar/delayed.toolbar.view","csui/controls/toolbar/toolbar.view","csui/controls/tableactionbar/tableactionbar.view","workflow/controls/infinite.table/infinite.table.view","workflow/widgets/wfstatus/wfstatus.columns","workflow/models/wfstatus/wfstatus.column.factory","workflow/models/wfstatus/wfstatus.collection.factory","workflow/controls/stepcards/stepcards.list.view","workflow/controls/usercards/usercards.list.view","workflow/controls/popover/popover.view","workflow/utils/workitem.util","hbs!workflow/widgets/wfstatus/impl/wfstatuslist","i18n!workflow/widgets/wfstatus/impl/nls/lang","css!workflow/widgets/wfstatus/impl/wfstatus"],function(e,t,i,n,o,s,l,a,r,c,u,d,p,m,h,f,w,g,b,v,k,y){"use strict";var x=r.extend({"template":k,"className":"","regions":{"tableRegion":"#tableview","footerRegion":"#footerview"},"events":{"click #footerview":"fetchMoreItems","click #tableview":"performStatusItemAction"},"constructor":function(e){e.separateDescription=!1,r.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"initialize":function(){this.collection=this.options.collection||this.context.getCollection(f),this.columns=this.collection.columns||this.context.getCollection(h),i.defaults(this.options,{"orderBy":"status_key desc","tableColumns":m}),this.setTableView(),this.options.collection&&(this.collection.fetched=!1),this.collection.page=1},"fetchMoreItems":function(){this.collection.fetched=!1;var e=this.collection.page;this.collection.length===this.options.pageSize*e&&(this.collection.page=e+1,this.onRender(this.collection.page))},"setTableView":function(){this.tableView=new p({"context":this.options.context,"connector":this.connector,"collection":this.collection,"columns":this.columns,"tableColumns":this.options.tableColumns,"pageSize":this.options.pageSize,"originatingView":this,"columnsWithSearch":["wf_name"],"orderBy":this.options.orderBy,"filterBy":this.options.filterBy,"nameEdit":!1,"selectRows":"None","selectColumn":!1,"favoritesTableOptions":this.favoritesTableOptions,"actionItems":this.defaultActionController.actionItems,"commands":this.defaultActionController.commands,"blockingParentView":this,"tableTexts":{"zeroRecords":y.emptyListText},"alternativeHeader":{"viewClass":this.collection.delayedActions?c:u,"options":{"toolbarItems":this.options.toolbarItems,"toolbarItemsMask":this.options.toolbarItemsMasks.toolbars.tableHeaderToolbar,"toolbarCommandController":this.commandController}},"inlineBar":{"viewClass":d,"options":i.extend({"collection":this.options.toolbarItems.inlineActionbar,"toolItemsMask":this.options.toolbarItemsMasks.toolbars.inlineActionbar,"delayedActions":this.collection.delayedActions,"container":this.collection.node,"containerCollection":this.collection,"commandExecutionOptions":{"nameAttribute":"wf_name"}},this.options.toolbarItems.inlineActionbar.options,{"inlineBarStyle":this.options.inlineActionBarStyle,"forceInlineBarOnClick":this.options.forceInlineActionBarOnClick,"showInlineBarOnHover":this.options.showInlineActionBarOnHover})}}),this.listenTo(this,"render",function(){this.tableRegion.show(this.tableView)}),this.listenTo(this.tableView,"clicked:cell",this.performStatusItemAction),this.listenTo(this.tableView,"dom:refresh",this.handleDomRefresh)},"handleDomRefresh":function(){var e,t,i,n,o=!1;if(this.collection&&this.collection.length>0){e=this.collection.page,t=this.options.pageSize,i=this.collection.length;for(var s=1;s<=e;s++)if(i<=s*t&&i>(s-1)*t){o=!0,n=s;break}this.collection.page=o?n:1}this.listenTo(this.footerRegion,"click",this.fetchMoreItems)},"onDestroy":function(){this.options.collection&&this.collection.setResourceScope(this._originalScope),r.prototype.onDestroy.call(this)},"onRender":function(e){if(this.options.collection&&!this.collection.fetched){this._originalScope=this.collection.getResourceScope(),this.collection.setResourceScope(f.getDefaultResourceScope());var t={},n=this;if(t.reload=!0,(this.collection.options.status.length>0||!0===this.collection.options.isFilterVisible)&&this.$el.find(".wfstatus-table").addClass("wfstatus-filter-width"),e>1){t.data="page="+e,t.remove=!1,t.reset=!1,t.reload=!1,t.retention=this.collection.options.retention,t.selectionType=this.collection.options.selectionType,t.wfstatusfilter=this.collection.options.wfstatusfilter,t.status=this.collection.options.status;var o=this.collection.options.filterWorkflowtype;o||(o=v.getWorkflowtype(this.collection.options.filterWorkflows)),t.filterWorkflowtype=o,this.collection.fetchdata(i.extend({"remove":!1},t)).then(function(){var e=n.collection.page;n.collection.length===n.options.pageSize*(e-1)&&(n.collection.page=e-1)})}else this.collection.fetch(t)}this.tableRegion.show(this.tableView),this.listenTo(this.collection,"reset",this.unbindPopover)},"unbindPopover":function(){v.unbindPopover()},"performStatusItemAction":function(e){var n,o,s,l=!(!e||!e.target||"tbody"!==e.target.tagName.toLowerCase()),a=e.model,r=window.event,c=!1,u=!1;if(a&&r&&r.target&&(s=t(r.target).closest("td").find(".wfstatus-assignee-name"),s&&s.length>0?c=!0:(s=t(r.target).closest("td").find(".wfstatus-currentstep"))&&s.length>0&&(u=!0)),l)return void this.unbindPopover();if(a&&(n=a.get("data").permissions,o=n&&n.ChangeAttr,a.set("hasReassignAction",o,{"silent":!0})),u&&a.get("parallel_steps").length>1||c&&0!==a.get("assignee").length)if(c&&a.get("assignee")===y.systemUserText)this.unbindPopover();else{var d=t(s).closest("td"),p=e.cellView.options.context,m={"model":a,"context":p,"originatingView":e.cellView,"wfData":i.pick(e.model.attributes,"process_id","subprocess_id","task_id","userId","comments_on")};u&&a.get("parallel_steps").length>1?(m.listViewMulCurrentSteps=!0,m.cellView=e.cellView,m.popoverCardsListView=new w(m)):c&&0!==a.get("assignee").length&&(m.wfData.updateCurrentStepAssignee=!0,m.popoverCardsListView=new g(m));var h={"delegateTarget":d,"cardViewOptions":m};b.ShowPopOver(h),t(d).hasClass("csui-acc-focusable-active")||(t(d).addClass("csui-acc-focusable-active"),t(d).attr("tabindex",0),t(d).trigger("focus"))}else if(e.model&&e.cellView){var f={"model":e.model,"cellView":e.cellView,"context":e.cellView.options.context};v.displayWfstatusItemProgresspanel(f)}}});return i.extend(x.prototype,a),x}),csui.define("hbs!workflow/widgets/wfstatus/impl/wfstatus.extended",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="wfstatus-filter-view">\r\n\r\n  <div class="wfstatus-panel-heading" title="'+e.escapeExpression((s=null!=(s=l(i,"headerFilterTitle")||(null!=t?l(t,"headerFilterTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"headerFilterTitle","hash":{},"loc":{"start":{"line":3,"column":45},"end":{"line":3,"column":66}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"headerFilterTitle")||(null!=t?l(t,"headerFilterTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"headerFilterTitle","hash":{},"loc":{"start":{"line":3,"column":68},"end":{"line":3,"column":89}}}):s))+'\r\n  </div>\r\n  <div class="binf-wfstatus-heading" title="'+e.escapeExpression((s=null!=(s=l(i,"headerFilterLabel")||(null!=t?l(t,"headerFilterLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"headerFilterLabel","hash":{},"loc":{"start":{"line":5,"column":44},"end":{"line":5,"column":65}}}):s))+'">\r\n    '+e.escapeExpression((s=null!=(s=l(i,"headerFilterLabel")||(null!=t?l(t,"headerFilterLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"headerFilterLabel","hash":{},"loc":{"start":{"line":6,"column":4},"end":{"line":6,"column":25}}}):s))+'\r\n  </div>\r\n\r\n  <div class="wfstatus-header csui-selected-checkbox csui-checkbox-primary">\r\n    <input id="selectAll" type="checkbox" class="All" tabindex="-1"\r\n      '+e.escapeExpression((s=null!=(s=l(i,"checkedAll")||(null!=t?l(t,"checkedAll"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"checkedAll","hash":{},"loc":{"start":{"line":11,"column":6},"end":{"line":11,"column":20}}}):s))+">"+e.escapeExpression((s=null!=(s=l(i,"allFilterLabel")||(null!=t?l(t,"allFilterLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"allFilterLabel","hash":{},"loc":{"start":{"line":11,"column":21},"end":{"line":11,"column":39}}}):s))+'</input>\r\n    <span class="wfstatus-allcount">'+e.escapeExpression((s=null!=(s=l(i,"allWFStatusCount")||(null!=t?l(t,"allWFStatusCount"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"allWFStatusCount","hash":{},"loc":{"start":{"line":12,"column":36},"end":{"line":12,"column":56}}}):s))+'</span>\r\n  </div>\r\n\r\n  <div class="wfstatus-body">\r\n    <div class="csui-selected-checkbox csui-checkbox-primary">\r\n      <input id="wfstatus-late" type="checkbox" class="wfstatus-late" tabindex="-1"\r\n        '+e.escapeExpression((s=null!=(s=l(i,"checkedLate")||(null!=t?l(t,"checkedLate"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"checkedLate","hash":{},"loc":{"start":{"line":18,"column":8},"end":{"line":18,"column":23}}}):s))+">"+e.escapeExpression((s=null!=(s=l(i,"lateFilterLabel")||(null!=t?l(t,"lateFilterLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"lateFilterLabel","hash":{},"loc":{"start":{"line":18,"column":24},"end":{"line":18,"column":43}}}):s))+'</input>\r\n      <span class="wfstatus-latecount">'+e.escapeExpression((s=null!=(s=l(i,"lateCount")||(null!=t?l(t,"lateCount"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"lateCount","hash":{},"loc":{"start":{"line":19,"column":39},"end":{"line":19,"column":52}}}):s))+'</span>\r\n    </div>\r\n\r\n    <div class="csui-selected-checkbox csui-checkbox-primary">\r\n      <input id="wfstatus-ontime" type="checkbox" class="wfstatus-ontime" tabindex="-1"\r\n        '+e.escapeExpression((s=null!=(s=l(i,"checkedOnTime")||(null!=t?l(t,"checkedOnTime"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"checkedOnTime","hash":{},"loc":{"start":{"line":24,"column":8},"end":{"line":24,"column":25}}}):s))+">"+e.escapeExpression((s=null!=(s=l(i,"ontimeFilterLabel")||(null!=t?l(t,"ontimeFilterLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"ontimeFilterLabel","hash":{},"loc":{"start":{"line":24,"column":26},"end":{"line":24,"column":47}}}):s))+'</input>\r\n      <span class="wfstatus-ontimecount">'+e.escapeExpression((s=null!=(s=l(i,"ontimeCount")||(null!=t?l(t,"ontimeCount"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"ontimeCount","hash":{},"loc":{"start":{"line":25,"column":41},"end":{"line":25,"column":56}}}):s))+'</span>\r\n    </div>\r\n      <div class="csui-selected-checkbox csui-checkbox-primary">\r\n      <input id="wfstatus-stopped" type="checkbox" class="wfstatus-stopped" tabindex="-1"\r\n        '+e.escapeExpression((s=null!=(s=l(i,"checkedStopped")||(null!=t?l(t,"checkedStopped"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"checkedStopped","hash":{},"loc":{"start":{"line":29,"column":8},"end":{"line":29,"column":26}}}):s))+">"+e.escapeExpression((s=null!=(s=l(i,"stoppedFilterLabel")||(null!=t?l(t,"stoppedFilterLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"stoppedFilterLabel","hash":{},"loc":{"start":{"line":29,"column":27},"end":{"line":29,"column":49}}}):s))+'</input>\r\n      <span class="wfstatus-stoppedcount">'+e.escapeExpression((s=null!=(s=l(i,"stoppedCount")||(null!=t?l(t,"stoppedCount"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"stoppedCount","hash":{},"loc":{"start":{"line":30,"column":42},"end":{"line":30,"column":58}}}):s))+'</span>\r\n    </div>\r\n    <div class="csui-selected-checkbox csui-checkbox-primary">\r\n      <input id="wfstatus-completed" type="checkbox" class="wfstatus-completed" tabindex="-1"\r\n        '+e.escapeExpression((s=null!=(s=l(i,"checkedCompleted")||(null!=t?l(t,"checkedCompleted"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"checkedCompleted","hash":{},"loc":{"start":{"line":34,"column":8},"end":{"line":34,"column":28}}}):s))+">"+e.escapeExpression((s=null!=(s=l(i,"completedFilterLabel")||(null!=t?l(t,"completedFilterLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"completedFilterLabel","hash":{},"loc":{"start":{"line":34,"column":29},"end":{"line":34,"column":53}}}):s))+'</input>\r\n      <span class="wfstatus-completedcount">'+e.escapeExpression((s=null!=(s=l(i,"completedCount")||(null!=t?l(t,"completedCount"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"completedCount","hash":{},"loc":{"start":{"line":35,"column":44},"end":{"line":35,"column":62}}}):s))+'</span>\r\n    </div>\r\n\r\n  </div>\r\n</div></div>\r\n\r\n<div class="wfstatus-list-view"></div>\r\n\r\n'}});return i.registerPartial("workflow_widgets_wfstatus_impl_wfstatus.extended",n),n}),csui.define("workflow/widgets/wfstatus/impl/wfstatus.extended.view",["csui/lib/marionette","csui/lib/underscore","csui/lib/jquery","csui/controls/table/table.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","workflow/models/wfstatus/wfstatus.collection.factory","workflow/widgets/wfstatus/impl/wfstatus.list.view","workflow/utils/workitem.util","hbs!workflow/widgets/wfstatus/impl/wfstatus.extended","i18n!workflow/widgets/wfstatus/impl/nls/lang"],function(e,t,i,n,o,s,l,a,r,c){"use strict";var u=e.LayoutView.extend({"className":"wfstatus-extended-view","template":r,"events":{"click #selectAll":"toggleCheckBoxAll","click #wfstatus-late ,#wfstatus-ontime ,#wfstatus-completed ,#wfstatus-stopped":"toggleCheckBoxSelection"},"regions":{"filterRegion":".wfstatus-filter-view","listRegion":".wfstatus-list-view"},"templateHelpers":function(){var e="",i="",n="",o="",l="",a=this.options.context.getCollection(s),r=a.options.status,u=a.model.get("data"),d=0,p=0,m=0,h=0;if(t.isArray(u)&&u.length>0)d=u[0].count,p=u[1].count,h=u[2].count,m=u[3].count;else switch(u.status){case"workflowlate":d=1;break;case"ontime":p=1;break;case"stopped":h=1;break;case"completed":m=1}return r&&r.length>0?t.each(r,function(e){"ontime"===e?n="checked":"workflowlate"===e?i="checked":"completed"===e?o="checked":"stopped"===e&&(l="checked")}):(e="checked",n="checked",i="checked",o="checked",l="checked"),{"completedFilterLabel":c.completedFilterLabel,"stoppedFilterLabel":c.stoppedFilterLabel,"lateFilterLabel":c.lateFilterLabel,"ontimeFilterLabel":c.ontimeFilterLabel,"headerFilterTitle":c.headerFilterTitle,"headerFilterLabel":c.headerFilterLabel,"allFilterLabel":c.allFilterLabel,"allWFStatusCount":a.model.get("count"),"lateCount":d,"ontimeCount":p,"stoppedCount":h,"completedCount":m,"checkedAll":e,"checkedLate":i,"checkedOnTime":n,"checkedCompleted":o,"checkedStopped":l}},"constructor":function(t){this.options=t,e.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this,"click:actionIcon",this.onClickFilter),this.listenTo(this,"destroy",this.destroyUserCardPopovers),this.propagateEventsToRegions()},"onRender":function(){var e=this;setTimeout(function(){e.listRegion.show(new l({"context":e.options.context,"collection":e.collection,"extendedView":e}))},1),this.collection.options.status.length>0&&this.$el.find(".wfstatus-filter-view").addClass("wfstatus-show-filter-view")},"onClickFilter":function(){a.unbindPopover(),0===this.$el.find(".wfstatus-show-filter-view").length?(this.$el.find(".wfstatus-table").addClass("wfstatus-filter-width"),this.$el.find(".wfstatus-filter-view").addClass("wfstatus-show-filter-view")):(this.$el.find(".wfstatus-table").removeClass("wfstatus-filter-width"),this.$el.find(".wfstatus-filter-view").removeClass("wfstatus-show-filter-view")),i(window).trigger("resize.tableview",n.onTableWinResize)},"toggleCheckBoxAll":function(e){a.unbindPopover(),1===this.$el.find("[id='selectAll']:checked").length?i(".csui-selected-checkbox input:not(:checked)").each(function(){i(this).prop("checked",!0).trigger("change")}):i(".csui-selected-checkbox input:checked").each(function(){i(this).prop("checked",!1).trigger("change")}),this.collection.options.isFilterVisible=!0,this.getStatusList(e)},"toggleCheckBoxSelection":function(e){a.unbindPopover();var t=[];i(".wfstatus-body .csui-selected-checkbox input:not(:checked)").length>0?(i(".wfstatus-body .csui-selected-checkbox input:checked").each(function(){var e=this.id;"wfstatus-late"===e?t.push("workflowlate"):"wfstatus-ontime"===e?t.push("ontime"):"wfstatus-completed"===e?t.push("completed"):"wfstatus-stopped"===e&&t.push("stopped")}),e.data=t,i("#selectAll").prop("checked",!1).trigger("change")):4===i(".wfstatus-body .csui-selected-checkbox input:checked").length&&i("#selectAll").prop("checked",!0).trigger("change"),this.collection.options.isFilterVisible=!0,this.getStatusList(e)},"getStatusList":function(e){this.collection.options.status=e.data?e.data:[],e.stopPropagation(),this.onRender()},"destroyUserCardPopovers":function(){a.unbindPopover()}});return t.extend(u.prototype,o),u}),csui.define("hbs!workflow/widgets/wfstatus/impl/wfstatus",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="wfstatus-empty-list"> '+e.escapeExpression((s=null!=(s=l(i,"emptyListText")||(null!=t?l(t,"emptyListText"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"emptyListText","hash":{},"loc":{"start":{"line":14,"column":38},"end":{"line":14,"column":55}}}):s))+"</div>\r\n"},"3":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="wfstatus-single">\r\n      <div class="wfstatus-single-details">\r\n\r\n        \x3c!-- 1 total --\x3e\r\n        <div class="wfstatus-status-info">\r\n            <span class="wfstatus-count '+e.escapeExpression(e.lambda(null!=(s=null!=(s=null!=t?a(t,"model"):t)?a(s,"data"):s)?a(s,"status"):s,t))+'"\r\n                  title="'+e.escapeExpression(e.lambda(null!=(s=null!=t?a(t,"model"):t)?a(s,"count"):s,t))+'">'+e.escapeExpression(e.lambda(null!=(s=null!=t?a(t,"model"):t)?a(s,"count"):s,t))+'</span>\r\n          <span class=" wfstatus-msg">'+e.escapeExpression((l=null!=(l=a(i,"totalMsg")||(null!=t?a(t,"totalMsg"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"totalMsg","hash":{},"loc":{"start":{"line":25,"column":38},"end":{"line":25,"column":50}}}):l))+'</span>\r\n          <span class="wfstatus-'+e.escapeExpression(e.lambda(null!=(s=null!=(s=null!=t?a(t,"model"):t)?a(s,"data"):s)?a(s,"status"):s,t))+'-icon"></span>\r\n          <span class="wfstatus-info" title="'+e.escapeExpression((l=null!=(l=a(i,"statusInfo")||(null!=t?a(t,"statusInfo"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"statusInfo","hash":{},"loc":{"start":{"line":27,"column":45},"end":{"line":27,"column":59}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"statusInfo")||(null!=t?a(t,"statusInfo"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"statusInfo","hash":{},"loc":{"start":{"line":27,"column":61},"end":{"line":27,"column":75}}}):l))+"</span>\r\n\r\n        </div>\r\n\r\n        \x3c!-- status and due date --\x3e\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"dueDate"):t,{"name":"if","hash":{},"fn":e.program(4,o,0),"inverse":e.noop,"loc":{"start":{"line":32,"column":8},"end":{"line":38,"column":15}}}))?s:"")+'        \x3c!-- Workflow name --\x3e\r\n        <div class="wfstatus-wfname-details">\r\n          <div class="wfstatus-wfname-label">'+e.escapeExpression((l=null!=(l=a(i,"wfNameLabel")||(null!=t?a(t,"wfNameLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"wfNameLabel","hash":{},"loc":{"start":{"line":41,"column":45},"end":{"line":41,"column":60}}}):l))+'</div>\r\n          <div class="wfstatus-workflow-name"\r\n               title="'+e.escapeExpression(e.lambda(null!=(s=null!=(s=null!=t?a(t,"model"):t)?a(s,"data"):s)?a(s,"wfname"):s,t))+'">'+e.escapeExpression(e.lambda(null!=(s=null!=(s=null!=t?a(t,"model"):t)?a(s,"data"):s)?a(s,"wfname"):s,t))+"</div>\r\n        </div>\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=(s=null!=t?a(t,"model"):t)?a(s,"data"):s)?a(s,"stepname"):s,{"name":"if","hash":{},"fn":e.program(6,o,0),"inverse":e.noop,"loc":{"start":{"line":45,"column":8},"end":{"line":53,"column":15}}}))?s:"")+'        <div class="wfstatus-assignee-startdate">\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"assignee"):t,{"name":"if","hash":{},"fn":e.program(8,o,0),"inverse":e.noop,"loc":{"start":{"line":55,"column":10},"end":{"line":60,"column":17}}}))?s:"")+"\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"startDate"):t,{"name":"if","hash":{},"fn":e.program(10,o,0),"inverse":e.noop,"loc":{"start":{"line":62,"column":10},"end":{"line":67,"column":17}}}))?s:"")+"        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n"},"4":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'          <div class="wfstatus-detail">\r\n            <span class="wfstatus-duedate-label">'+e.escapeExpression((s=null!=(s=l(i,"dueDateLabel")||(null!=t?l(t,"dueDateLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"dueDateLabel","hash":{},"loc":{"start":{"line":34,"column":49},"end":{"line":34,"column":65}}}):s))+'</span>\r\n\r\n            <div class="wfstatus-duedate" title="'+e.escapeExpression((s=null!=(s=l(i,"dueDate")||(null!=t?l(t,"dueDate"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"dueDate","hash":{},"loc":{"start":{"line":36,"column":49},"end":{"line":36,"column":60}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"dueDate")||(null!=t?l(t,"dueDate"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"dueDate","hash":{},"loc":{"start":{"line":36,"column":62},"end":{"line":36,"column":73}}}):s))+"</div>\r\n          </div>\r\n"},"6":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'          \x3c!-- Step name --\x3e\r\n          <div class="wfstatus-currentstep-details">\r\n            <span class="wfstatus-currentstep-label">'+e.escapeExpression((l=null!=(l=a(i,"currentStepNameLabel")||(null!=t?a(t,"currentStepNameLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"currentStepNameLabel","hash":{},"loc":{"start":{"line":48,"column":53},"end":{"line":48,"column":77}}}):l))+'</span>\r\n\r\n            <div class="wfstatus-step-name"\r\n                 title="'+e.escapeExpression(e.lambda(null!=(s=null!=(s=null!=t?a(t,"model"):t)?a(s,"data"):s)?a(s,"stepname"):s,t))+'">'+e.escapeExpression(e.lambda(null!=(s=null!=(s=null!=t?a(t,"model"):t)?a(s,"data"):s)?a(s,"stepname"):s,t))+"</div>\r\n          </div>\r\n"},"8":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'            <div class="wfstatus-assignee-details">\r\n              <div class="wfstatus-assignee-label">'+e.escapeExpression((s=null!=(s=l(i,"assignedToLabel")||(null!=t?l(t,"assignedToLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"assignedToLabel","hash":{},"loc":{"start":{"line":57,"column":51},"end":{"line":57,"column":70}}}):s))+'</div>\r\n              <div class="wfstatus-assignee" title="'+e.escapeExpression((s=null!=(s=l(i,"assignee")||(null!=t?l(t,"assignee"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"assignee","hash":{},"loc":{"start":{"line":58,"column":52},"end":{"line":58,"column":64}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"assignee")||(null!=t?l(t,"assignee"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"assignee","hash":{},"loc":{"start":{"line":58,"column":66},"end":{"line":58,"column":78}}}):s))+"</div>\r\n            </div>\r\n"},"10":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'            <div class="wfstatus-startdate-details">\r\n              <div class="wfstatus-startdate-label">'+e.escapeExpression((s=null!=(s=l(i,"startDateLabel")||(null!=t?l(t,"startDateLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"startDateLabel","hash":{},"loc":{"start":{"line":64,"column":52},"end":{"line":64,"column":70}}}):s))+'</div>\r\n              <div class="wfstatus-start-date" title="'+e.escapeExpression((s=null!=(s=l(i,"startDate")||(null!=t?l(t,"startDate"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"startDate","hash":{},"loc":{"start":{"line":65,"column":54},"end":{"line":65,"column":67}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"startDate")||(null!=t?l(t,"startDate"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"startDate","hash":{},"loc":{"start":{"line":65,"column":69},"end":{"line":65,"column":82}}}):s))+"</div>\r\n            </div>\r\n"},"12":function(e,t,i,n,o){return'    <div class="wfstatus-donut-chart"></div>\r\n'},"14":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <div class="tile-footer">\r\n      <div id="cs-more" class="tile-expand" title="'+e.escapeExpression((l=null!=(l=a(i,"expandLabel")||(null!=t?a(t,"expandLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"expandLabel","hash":{},"loc":{"start":{"line":80,"column":51},"end":{"line":80,"column":66}}}):l))+'" aria-label="'+e.escapeExpression((l=null!=(l=a(i,"expandLabel")||(null!=t?a(t,"expandLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"expandLabel","hash":{},"loc":{"start":{"line":80,"column":80},"end":{"line":80,"column":95}}}):l))+" "+e.escapeExpression((l=null!=(l=a(i,"dialogTitle")||(null!=t?a(t,"dialogTitle"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"dialogTitle","hash":{},"loc":{"start":{"line":80,"column":96},"end":{"line":80,"column":111}}
}):l))+' Widget" role="button" tabindex="0">\r\n        <div class="wfstatus-expand-icon cs-icon-container cs-open-perspective-button" role="button">\r\n           '+(null!=(s=(a(i,"icon-v2")||t&&a(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"states":"true","iconName":"csui_action_expand32"},"loc":{"start":{"line":82,"column":11},"end":{"line":82,"column":70}}}))?s:"")+"\r\n        </div>\r\n      </div>\r\n    </div>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="tile-header" tabindex="0">\r\n  <div class="tile-type-icon">\r\n    <span class="icon title-icon mime_workflow_status" aria-hidden="true"></span>\r\n  </div>\r\n  <div class="tile-title">\r\n    <h2 class="csui-heading">'+e.escapeExpression((l=null!=(l=a(i,"dialogTitle")||(null!=t?a(t,"dialogTitle"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"dialogTitle","hash":{},"loc":{"start":{"line":6,"column":29},"end":{"line":6,"column":44}}}):l))+'</h2>\r\n  </div>\r\n</div>\r\n\r\n<div class="tile-content">\r\n<div class="wfstatus-scrolling">\r\n  <div class="cs-emptylist-placeholder"></div>\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"emptyTextRequired"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":13,"column":2},"end":{"line":15,"column":9}}}))?s:"")+"\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"isSingleStatus"):t,{"name":"if","hash":{},"fn":e.program(3,o,0),"inverse":e.noop,"loc":{"start":{"line":17,"column":2},"end":{"line":72,"column":9}}}))?s:"")+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"donutChart"):t,{"name":"if","hash":{},"fn":e.program(12,o,0),"inverse":e.noop,"loc":{"start":{"line":73,"column":2},"end":{"line":75,"column":9}}}))?s:"")+"\r\n\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"showExpand"):t,{"name":"if","hash":{},"fn":e.program(14,o,0),"inverse":e.noop,"loc":{"start":{"line":78,"column":2},"end":{"line":86,"column":9}}}))?s:"")+"</div></div>"}});return i.registerPartial("workflow_widgets_wfstatus_impl_wfstatus",n),n}),csui.define("workflow/widgets/wfstatus/wfstatus.view",["csui/lib/marionette","csui/lib/backbone","csui/lib/underscore","csui/lib/jquery","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/node","csui/behaviors/expanding/expanding.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","workflow/models/wfstatus/wfstatus.collection.factory","workflow/models/wfstatus/wfstatus.model.factory","workflow/controls/visualdata/visual.data.donut.view","workflow/widgets/wfstatus/impl/wfstatus.extended.view","workflow/utils/workitem.util","hbs!workflow/widgets/wfstatus/impl/wfstatus","i18n!workflow/widgets/wfstatus/impl/nls/lang","css!workflow/widgets/wfstatus/impl/wfstatus"],function(e,t,i,n,o,s,l,a,r,c,u,d,p,m,h){"use strict";return e.LayoutView.extend({"className":"cs-list tile content-tile csui-acc-tab-region wf-wfstatus","widgetTitle":h.dialogTitle,"template":m,"regions":{"donut":".wfstatus-donut-chart"},"templateHelpers":function(){var e=this.model.get("count"),t=1===e;if(t){var i,n=this.model.get("data"),o=n.status,s=n.dateinitiated?p.dateConversion(n.dateinitiated):"",l=n.duedate?p.dateConversion(n.duedate):"",a=n.assignee,r="",c={};c.assignees=a,c.assignedto=n.assignedto,r=p.getAssignee(c),o===p.constants.WFSTATUS_ONTIME?i=h.onTime:o===p.constants.WFSTATUS_COMPLETED?i=h.completed:o===p.constants.WFSTATUS_LATE?i=h.late:o===p.constants.WFSTATUS_STOPPED&&(i=h.stopped)}return{"dialogTitle":this.widgetTitle,"totalMsg":h.totalMsg,"emptyListText":h.emptyListText,"expandLabel":h.expandLabel,"dueDateLabel":h.stepDueDateLabel,"currentStepNameLabel":h.currentStepNameLabel,"assignedToLabel":h.assignedToLabel,"startDateLabel":h.startDateLabel,"emptyTextRequired":0===e,"isSingleStatus":t,"statusInfo":i,"donutChart":e>1,"showExpand":e>0,"model":this.model.toJSON(),"startDate":s,"dueDate":l,"wfNameLabel":h.wfNameLabel,"assignee":r}},"behaviors":{"ScrollingInstructions":{"behaviorClass":a,"contentParent":".wfstatus-scrolling","suppressScrollX":!0,"scrollYMarginOffset":16},"ExpandableList":{"behaviorClass":l,"expandedView":d,"orderBy":"status_key desc","actionTitleBarIcon":"icon-toolbarFilter tile-filter-icon","dialogTitle":function(){return this.widgetTitle},"dialogTitleIconRight":"icon-tileCollapse","dialogClassName":"wfstatus"}},"constructor":function(t){t.unique=i.uniqueId(),t.data=t.data||{},t.data.unique=i.uniqueId(),t.data.selectionType=100,t.model=t.context.getModel(c,t.data),t.model.get("widgetTitle")&&i.str.trim(t.model.get("widgetTitle")).length>0&&(this.widgetTitle=t.model.get("widgetTitle")),e.LayoutView.prototype.constructor.call(this,t),this.node=t.context.getObject(s),this.listenTo(this.node,"change:id",this.onNodeChange),this.onNodeChange(),this.listenTo(this.model,"change",this.onModelChange),this.listenTo(this,"click:segment",this.getExpandStatusList),t=t.data?i.extend(t,t.data):t,delete t.data,t.detached=!0,t.unique=i.uniqueId(),this.completeCollection=this.options.context.getCollection(r,t),t.detached=!0,t.internal=!1},"onNodeChange":function(){var e=this.model.get("reference");if(e&&""!==e)if("custom"===e){var t=parseInt(this.model.get("referenceid"));this.model.set({"referenceid":isNaN(t)?void 0:t},{"silent":!0})}else this.model.set({"referenceid":this.node.get("id")},{"silent":!0});else this.model.set({"referenceid":void 0},{"silent":!0});this.model.fetch()},"events":{"click #cs-more,.tile-expand,.pie-total-container,.tile-header":"getExpandStatusList"},"getExpandStatusList":function(e){if(this.model.get("count")>0){var t=[];if(e.data){var i="late"===e.data.status?"workflowlate":e.data.status;t.push(i)}this.completeCollection.model=this.model,this.completeCollection.options.retention=this.model.get("retention"),this.completeCollection.options.selectionType=this.model.get("selectionType"),this.completeCollection.options.wfstatusfilter=this.model.get("wfstatusfilter"),this.completeCollection.options.referenceid=this.model.get("referenceid"),this.completeCollection.options.status=t,this.completeCollection.options.chatSettings=this.model.get("chatSettings");var n=this.model.get("filterWorkflowtype");n||(n=p.getWorkflowtype(this.model.get("filterWorkflows"))),this.completeCollection.options.filterWorkflowtype=n,e.preventDefault(),e.stopPropagation(),this.triggerMethod("expand")}},"isSearchOpen":function(){return!1},"onModelChange":function(){this.render()},"onKeyDown":function(e){var t=e.keyCode,i=n(e.target),o=!0;return 13===t&&(i.hasClass("tile-header")||i.hasClass("tile-expand"))&&(e.preventDefault(),e.stopPropagation(),this.getExpandStatusList(e),o=!1),o},"onRender":function(){if(this.$el.on("keydown",i.bind(this.onKeyDown,this)),this._isRendered&&this._isShown&&this.model.get("count")>0&&(this.collection=new t.Collection(this.model.get("data")),this.model.get("count")>1))var e=this,o=setInterval(function(){if(n(".wf-wfstatus").length>0){var t={},i={"ontime":h.onTime,"late":h.late,"completed":h.completed,"stopped":h.stopped};t.dataset=e.model.get("data"),t.statusArray=i,t.totalLabel=h.totalMsg,t.parent=e;var s=new u(t);e.donut.show(s),clearInterval(o)}},500)},"onDestroy":function(){n(".wfstatus-progress-view-dialog-back").trigger("click")}})}),csui.define("workflow/widgets/wfmonitor/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/widgets/wfmonitor/impl/nls/root/lang",{"dialogTitle":"Workflow Monitoring"}),csui.define("workflow/widgets/wfmonitor/wfmonitor.view",["workflow/widgets/wfstatus/wfstatus.view","i18n!workflow/widgets/wfmonitor/impl/nls/root/lang"],function(e,t){"use strict";return e.extend({"widgetTitle":t.dialogTitle,"constructor":function(t){e.prototype.constructor.call(this,t)}})}),csui.define("workflow/controls/table/cells/status.cell",["csui/lib/jquery","csui/controls/table/cells/cell/cell.view","csui/controls/table/cells/cell.registry","workflow/utils/workitem.util","i18n!workflow/widgets/wfstatus/impl/nls/lang"],function(e,t,i,n,o){"use strict";var s=t.extend({"renderValue":function(){var e=n.formatStatus({"dueDate":this.model.get("due_date"),"status":this.model.get("status_key")});this.$el.html('<div class="wfstatus-status"><span class="wfstatus-status-icon-col '+e.styleclass+'"></span><span class="wfstatus-status-col-value">'+e.status+"</span></div>")}});return i.registerByColumnKey("status_key",s),s}),csui.define("workflow/controls/table/cells/date.cell",["csui/controls/table/cells/cell/cell.view","csui/controls/table/cells/cell.registry","workflow/utils/workitem.util"],function(e,t,i){"use strict";var n=e.extend({"renderValue":function(){var e=this.getValueText(),t=e?i.dateConversion(e):"";this.$el.text(t)}});return t.registerByColumnKey("due_date",n),t.registerByColumnKey("date_initiated",n),n}),csui.define("hbs!workflow/controls/table/cells/impl/assignee",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'(\r\n    <span class="wfstatus-assignee-count">'+e.escapeExpression((s=null!=(s=l(i,"assigneeCount")||(null!=t?l(t,"assigneeCount"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"assigneeCount","hash":{},"loc":{"start":{"line":4,"column":42},"end":{"line":4,"column":59}}}):s))+"</span>)\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="wfstatus-assignee">\r\n  <div class="wfstatus-assignee-name" title="'+e.escapeExpression((l=null!=(l=a(i,"assigneeName")||(null!=t?a(t,"assigneeName"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"assigneeName","hash":{},"loc":{"start":{"line":2,"column":45},"end":{"line":2,"column":61}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"assigneeName")||(null!=t?a(t,"assigneeName"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"assigneeName","hash":{},"loc":{"start":{"line":2,"column":63},"end":{"line":2,"column":79}}}):l))+"</div>\r\n  "+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"assigneeCount"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":3,"column":2},"end":{"line":5,"column":9}}}))?s:"")+"</div>"}});return i.registerPartial("workflow_controls_table_cells_impl_assignee",n),n}),csui.define("css!workflow/controls/table/cells/impl/assignee",[],function(){}),csui.define("workflow/controls/table/cells/assignee.cell",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/table/cells/cell.registry","csui/controls/table/cells/templated/templated.view","workflow/controls/usercards/usercards.list.view","workflow/models/wfstatus/usercard.model","workflow/utils/workitem.util","hbs!workflow/controls/table/cells/impl/assignee","i18n!workflow/widgets/wfstatus/impl/nls/lang","css!workflow/controls/table/cells/impl/assignee"],function(e,t,i,n,o,s,l,a,r,c,u){"use strict";var d=s.extend({"template":c,"renderValue":function(){var e=this.getValueData(),t=e?this.template(e):"";this.$el.html(t)},"getValueData":function(){var e=this.model,t=this.options.column,i=t.name,n=e.get(i),o=e.get("assignee_count"),s=e.get("status_key"),l=e.get("assignedto");return n=n.toString(),e.get("steps_count")>0?s&&o>0&&s!==r.constants.WFSTATUS_COMPLETED?(o=l&&l.groupName===n?o:o-1)>1&&(n=u.multipleUserText):o=0:s!==r.constants.WFSTATUS_COMPLETED&&s!==r.constants.WFSTATUS_STOPPED&&(n=u.systemUserText),{"assigneeName":n,"assigneeCount":o}}});return o.registerByColumnKey("assignee",d),d}),csui.define("hbs!workflow/controls/table/cells/impl/currentstep",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"1":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'+\r\n    <span class="wfstatus-remaining-step-count">'+e.escapeExpression((s=null!=(s=l(i,"remainingStepCount")||(null!=t?l(t,"remainingStepCount"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"remainingStepCount","hash":{},"loc":{"start":{"line":4,"column":48},"end":{"line":4,"column":70}}}):s))+"</span>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="wfstatus-currentstep">\r\n  <div class="wfstatus-currentstep-name" title="'+e.escapeExpression((l=null!=(l=a(i,"currentStepName")||(null!=t?a(t,"currentStepName"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"currentStepName","hash":{},"loc":{"start":{"line":2,"column":48},"end":{"line":2,"column":67}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"currentStepName")||(null!=t?a(t,"currentStepName"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"currentStepName","hash":{},"loc":{"start":{"line":2,"column":69},"end":{"line":2,"column":88}}}):l))+"</div>\r\n  "+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"remainingStepCount"):t,{"name":"if","hash":{},"fn":e.program(1,o,0),"inverse":e.noop,"loc":{"start":{"line":3,"column":2},"end":{"line":5,"column":9}}}))?s:"")+"</div>"}});return i.registerPartial("workflow_controls_table_cells_impl_currentstep",n),n}),csui.define("css!workflow/controls/table/cells/impl/currentstep",[],function(){}),csui.define("workflow/controls/table/cells/currentstep.cell",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/controls/table/cells/cell.registry","csui/controls/table/cells/templated/templated.view","workflow/utils/workitem.util","hbs!workflow/controls/table/cells/impl/currentstep","i18n!workflow/widgets/wfstatus/impl/nls/lang","css!workflow/controls/table/cells/impl/currentstep"],function(e,t,i,n,o,s,l,a,r){"use strict";var c=s.extend({"template":a,"renderValue":function(){var e=this.getValueData(),t=e?this.template(e):"";this.$el.html(t)},"getValueData":function(){var e,t=this.model,i=this.options.column,n=i.name,o=t.get(n),s=t.get("status_key");return null==o&&(o=""),s&&s!==l.constants.WFSTATUS_COMPLETED&&s!==l.constants.WFSTATUS_STOPPED&&(t.get("steps_count")>0?e=t.get("steps_count")-1:o=r.backgroundStepText),o=o.toString(),{"currentStepName":o,"remainingStepCount":e}}});return o.registerByColumnKey("step_name",c),c}),csui.define("workflow/models/proxyuser/proxy.user.form.model",["csui/lib/jquery","csui/lib/underscore","csui/utils/url","csui/models/form","csui/controls/globalmessage/globalmessage","csui/lib/moment","csui/models/mixins/resource/resource.mixin"],function(e,t,i,n,o,s,l){"use strict";var a=n.extend({"constructor":function(e,t){n.prototype.constructor.apply(this,arguments),this.makeResource(t)},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})},"url":function(){var e=this.options.connector.connection.url.replace("/v1","/v2");return i.combine(e,"wfproxyuser",this.get("userId"))},"parse":function(e){var t=e.results.forms,i=!!t&&t[0];return this.set("isFormToDisplay",e.results.isFormToDisplay),i},"saveProxyUser":function(e){e.connector.makeAjaxCall(e).fail(t.bind(function(e){this.trigger("reset"),o.showMessage("error",e.responseJSON.error)},this))}});return l.mixin(a.prototype),a}),csui.define("hbs!workflow/controls/proxyuser/impl/proxy.user.form",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="binf-row">\r\n  <div class="wf-proxy-user-form binf-col-md-12 binf-col-sm-12\r\n  binf-col-lg-12\r\n  binf-col-xs-12">\r\n    <div class="cs-form-singlecolumn wf-proxy-user-column">\r\n      <div id="wf-proxy-user" class="wf-proxy-user"></div>\r\n    </div>\r\n  </div>\r\n</div>'}});return i.registerPartial("workflow_controls_proxyuser_impl_proxy.user.form",n),n}),csui.define("workflow/controls/proxyuser/proxy.user.form.view",["csui/lib/underscore","csui/controls/form/form.view","csui/utils/url","csui/utils/contexts/factories/user","hbs!workflow/controls/proxyuser/impl/proxy.user.form"],function(e,t,i,n,o){"use strict";return t.extend({"className":"cs-form wf-proxy-user-view-form","formTemplate":o,"constructor":function(e){t.prototype.constructor.call(this,e),this.listenTo(this,"change:field",this._saveField)},"_getLayout":function(){return{"parent":"bootstrap-csui","layout":{"template":this.getOption("formTemplate").call(this,{"data":this.alpaca.data,"mode":this.mode}),"bindings":this._getBindings()}}},"_getBindings":function(){return{"id":"wf-proxy-user"}},"_saveField":function(e){var t=new FormData,o=e.value?e.value:0,s=e.fieldView.curVal.display_name,l=this.model.connector,a=this.options.context.getModel(n);if("id"===e.name){t.append("body",JSON.stringify({"proxy_id":o,"proxy_name":s,"user_id":a.get("id")}));var r=l.connection.url.replace("/v1","/v2"),c=i.combine(r,"wfproxyuser"),u={"itemview":this,"url":c,"type":"POST","data":t,"connector":l}}this.model.saveProxyUser(u)}})}),csui.define("workflow/controls/proxyuser/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/controls/proxyuser/impl/nls/root/lang",{"NoProxyUser":"To view proxy of the other users is not allowed.","ProxiesTabDisplayName":"Proxies"}),csui.define("hbs!workflow/controls/proxyuser/impl/proxy.user.empty",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="wf-proxy-user-info">\r\n  <div class="wf-proxy-user-empty-message" title="'+e.escapeExpression((s=null!=(s=l(i,"NoProxyUser")||(null!=t?l(t,"NoProxyUser"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"NoProxyUser","hash":{},"loc":{"start":{"line":2,"column":50},"end":{"line":2,"column":65}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"NoProxyUser")||(null!=t?l(t,"NoProxyUser"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"NoProxyUser","hash":{},"loc":{"start":{"line":2,"column":67},"end":{"line":2,"column":82}}}):s))+"</div>\r\n</div>"}});return i.registerPartial("workflow_controls_proxyuser_impl_proxy.user.empty",n),n}),csui.define("css!workflow/controls/proxyuser/impl/proxyuser",[],function(){}),csui.define("workflow/controls/proxyuser/proxy.user.empty.view",["csui/lib/underscore","csui/lib/marionette","i18n!workflow/controls/proxyuser/impl/nls/lang","hbs!workflow/controls/proxyuser/impl/proxy.user.empty","css!workflow/controls/proxyuser/impl/proxyuser"],function(e,t,i,n){"use strict";return t.ItemView.extend({"template":n,"className":"wf-proxy-user-empty","templateHelpers":function(){return{"NoProxyUser":i.NoProxyUser}},"constructor":function(){t.ItemView.prototype.constructor.apply(this,arguments)}})}),csui.define("hbs!workflow/controls/proxyuser/impl/proxy.user.tab",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var n=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,n,o){return'<div class="wf-proxy-user-view">\r\n  <div class="wf-proxy-user-content"></div>\r\n</div>'}});return i.registerPartial("workflow_controls_proxyuser_impl_proxy.user.tab",n),n}),csui.define("workflow/controls/proxyuser/proxy.user.tab.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/handlebars","csui/lib/marionette","csui/controls/tile/behaviors/perfect.scrolling.behavior","workflow/models/proxyuser/proxy.user.form.model","workflow/controls/proxyuser/proxy.user.form.view","workflow/controls/proxyuser/proxy.user.empty.view","hbs!workflow/controls/proxyuser/impl/proxy.user.tab","css!workflow/controls/proxyuser/impl/proxyuser"],function(e,t,i,n,o,s,l,a,r,c){"use strict";return o.LayoutView.extend({"className":"wf-proxy-user-tab-view","template":c,"behaviors":{"PerfectScrolling":{"behaviorClass":s,"suppressScrollX":!0,"contentParent":".wf-proxy-user-form-view","scrollYMarginOffset":15}},"regions":{"wfProxyUserContent":".wf-proxy-user-content"},"constructor":function(e){e=e||{},o.LayoutView.prototype.constructor.call(this,e);var t=new l({"userId":this.options.userwidgetmodel.attributes.id},{"connector":this.options.connector,"parentView":this}),i=this;t.fetch().done(function(){i.formView=new a({"context":i.options.context,"orginatingView":i,"model":t}),i.render()})},"onRender":function(){if(this.formView){var e=!(!this.formView||!this.formView.model.get("isFormToDisplay"))&&this.formView;e&&this.wfProxyUserContent.show(e)}}})}),csui.define("workflow/controls/proxyuser/proxy.user.tab.extension",["csui/lib/underscore","csui-ext!workflow/controls/proxyuser/proxy.user.tab.extension","workflow/controls/proxyuser/proxy.user.tab.view","workflow/models/proxyuser/proxy.user.form.model","i18n!workflow/controls/proxyuser/impl/nls/lang"],function(e,t,i,n,o){"use strict";var s,l={"tabName":"proxyTab","tabDisplayName":o.ProxiesTabDisplayName,"tabContentView":i,"showTab":function(e,t){var i,o=!1;return e.get("id")===t.connector.authenticator.userId&&(i=new n({"userId":t.connector.authenticator.userId},{"connector":t.connector,"parentView":this}),i.fetch({"async":!1}).done(function(){o=i.get("isFormToDisplay")})),o}},a=[];return t&&(a=e.flatten(t,!0),s=e.find(a,function(e){return e.isEgovProxyTab})),s||a.push(l),a}),csui.define("workflow/dialogs/node.picker/start.locations/workitem.attachments/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/dialogs/node.picker/start.locations/workitem.attachments/impl/nls/root/lang",{"labelAttachments":"Workflow Attachments"}),csui.define("workflow/dialogs/node.picker/start.locations/workitem.attachments/workitem.attachments.factory",["csui/lib/underscore","csui/lib/jquery","csui/dialogs/node.picker/start.locations/location.base.factory","csui/models/node.children2/node.children2","csui/utils/commands","i18n!workflow/dialogs/node.picker/start.locations/workitem.attachments/impl/nls/lang"],function(e,t,i,n,o,s){"use strict";function l(e,i){var n=t.Deferred();return e&&e.isFetchable()&&!e.isFetchableDirectly()?e.fetch().then(function(){n.resolve()},function(){i.set({"invalid":!0}),i.collection.remove(i),n.reject()}):n.resolve(),n.promise()}return i.extend({"updateLocationModel":function(e){var t=this.options.container.get("attachmentContainer");return e.set({"name":s.labelAttachments,"icon":"icon mime_workflow_map","invalid":!(t&&t.isFetchable())}),l(t,e)},"getLocationParameters":function(){var e=this.options.container.get("attachmentContainer"),t=new n(void 0,{"node":e,"autoreset":!0,"expand":{"properties":["original_id","parent_id"]},"fields":{"properties":[]},"commands":"default,open"});return e.set("unselectable",!1),{"container":e,"collection":t,"locationName":s.labelAttachments}}})}),csui.define("workflow/perspective/context/plugins/workflow.perspective.context.plugin",["csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/application.scope.factory","workflow/models/workitem/workitem.model.factory","csui/utils/contexts/perspective/perspective.context.plugin"],function(e,t,i,n,o){"use strict";return o.extend({"constructor":function(e){o.prototype.constructor.apply(this,arguments),this.applicationScope=this.context.getModel(i),this.workItem=this.context.getModel(n,{"permanent":!0}).on("change:process_id",this._fetchWorkflowPerspective,this).on("change:doc_id",this._fetchWorkflowPerspective,this)},"_fetchWorkflowPerspective":function(){var e=this.workItem.get("process_id"),t=this.workItem.get("doc_id");if((!e||!t)&&(e||t||"workflow"===this.applicationScope.id)&&!this.loadingPerspective){this.applicationScope.set("id","workflow");this.context.loadPerspective("json!workflow/perspective/context/plugins/impl/perspectives/workflow.json")}}})}),csui.define("json!workflow/perspective/context/plugins/impl/perspectives/workflow.json",{"type":"grid","options":{"rows":[{"columns":[{"sizes":{"md":12},"heights":{"xs":"full"},"widget":{"type":"workflow/widgets/workitem/workitem","options":{}}}]}]}}),csui.define("workflow/widgets/metadata/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/widgets/metadata/impl/nls/root/lang",{"workflowPropertiesLabel":"Workflow Properties"}),csui.define("workflow/widgets/metadata/metadata.panel",["workflow/widgets/workitem/workitem.body/workitem.body.view","i18n!workflow/widgets/metadata/impl/nls/lang"],function(e,t){"use strict";return{"title":t.workflowPropertiesLabel,"sequence":100,"name":"workflow-properties","contentView":e}}),csui.define("json!workflow/widgets/wfstatus/wfstatus.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{title}}","description":"{{description}}","kind":"tile","schema":{"type":"object","required":!1,"properties":{"widgetTitle":{"title":"{{workflowtrackingwidgetTitle}}","description":"{{workflowtrackingwidgetTitleDescription}}","default":"{{title}}","type":"string"},"retention":{"title":"{{displayCompletedWorkflows}}","description":"{{displayCompletedWorkflowsDescription}}","default":30,"type":"integer"},"filterWorkflowtype":{"title":"{{workflowTypeTitle}}","description":"{{workflowTypeDescription}}","type":"string","enum":["Managed","Initiated","Both"],"default":"Both"},"reference":{"title":"{{referenceTitle}}","description":"{{referenceDescription}}","type":"string","enum":["","parent","custom"],"default":""},"referenceid":{"title":"{{referenceidTitle}}","description":"{{referenceidDescription}}","type":"integer"}}},"options":{"fields":{"widgetTitle":{"type":"text"},"retention":{"type":"number"},"filterWorkflowtype":{"type":"select","optionLabels":["{{workflowTypeManaged}}","{{workflowTypeInitiated}}","{{workflowTypeBoth}}"]},"reference":{"type":"select","optionLabels":["{{referenceNone}}","{{referenceParent}}","{{referenceCustom}}"]},"referenceid":{"type":"otcs_node_picker","type_control":{"parameters":{"select_types":[]}}}}}}),csui.define("json!workflow/widgets/wfmonitor/wfmonitor.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{title}}","description":"{{description}}","kind":"tile","schema":{"type":"object","required":!1,"properties":{"widgetTitle":{"title":"{{workflowmonitorwidgetTitle}}","description":"{{workflowmonitorwidgetTitleDescription}}","readonly":!1,"required":!0,"default":"{{title}}","type":"string"},"wfstatusfilter":{"title":"{{workflowStatusTitle}}","description":"{{workflowStatusDescription}}","required":!0,"type":"integer"}}},"options":{"fields":{"widgetTitle":{"type":"text"},"wfstatusfilter":{"type":"otcs_node_picker","type_control":{"parameters":{"select_types":[190]}}}}}}),csui.define("workflow/widgets/wfstatus/impl/nls/wfstatus.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/widgets/wfstatus/impl/nls/root/wfstatus.manifest",{"title":"Workflow Tracking","description":"Shows the status of workflows for the current user.","displayCompletedWorkflows":"Days Completed Workflows Display","displayCompletedWorkflowsDescription":"Number of days completed workflows display","workflowTypeTitle":"Workflow Type","workflowTypeDescription":"Select the Workflow Types to display","workflowTypeBoth":"Both","workflowTypeInitiated":"Initiated","workflowTypeManaged":"Managed","workflowStatusTitle":"Workflow Status","workflowStatusDescription":"Workflow Status Selection","workflowtrackingwidgetTitle":"Title","workflowtrackingwidgetTitleDescription":"Workflow Tracking Widget Title","referenceTitle":"Reference","referenceDescription":"Display only workflows related to the referenced item. Specify a custom reference, when you selected 'Custom' as reference","referenceNone":"None","referenceParent":"Parent","referenceCustom":"Custom","referenceidTitle":"Custom Reference","referenceidDescription":"Display only workflows for the custom reference. This setting takes effect if you selected 'Custom' for the reference property."}),csui.define("workflow/widgets/wfmonitor/impl/nls/wfmonitor.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("workflow/widgets/wfmonitor/impl/nls/root/wfmonitor.manifest",{"title":"Workflow Monitoring","description":"Shows the status of workflows selected via a filter (which is configured in Classic UI).","workflowStatusTitle":"Workflow Status Filter","workflowStatusDescription":"Expression created in Classic UI to showcase the status of specific Workflows","workflowmonitorwidgetTitle":"Title","workflowmonitorwidgetTitleDescription":"Workflow Monitoring Widget Title"}),csui.define("bundles/workflow-all",["workflow/toolbars/workflow.nodestable.toolbaritems","workflow/toolbars/workflow.expanded.widget.toolbaritems","workflow/toolbars/workflow.search.toolbaritems","workflow/toolbars/workflow.workspaceheader.toolbaritems","workflow/widgets/workitem/workitem/workitem.view","workflow/widgets/wfstatus/wfstatus.view","workflow/widgets/wfmonitor/wfmonitor.view","workflow/controls/table/cells/status.cell","workflow/controls/table/cells/date.cell","workflow/controls/table/cells/assignee.cell","workflow/controls/table/cells/currentstep.cell","workflow/controls/proxyuser/proxy.user.tab.extension","workflow/dialogs/node.picker/start.locations/workitem.attachments/workitem.attachments.factory","workflow/perspective/context/plugins/workflow.perspective.context.plugin","json!workflow/perspective/context/plugins/impl/perspectives/workflow.json","workflow/widgets/metadata/metadata.panel","json!workflow/widgets/wfstatus/wfstatus.manifest.json","json!workflow/widgets/wfmonitor/wfmonitor.manifest.json","i18n!workflow/widgets/wfstatus/impl/nls/wfstatus.manifest","i18n!workflow/widgets/wfmonitor/impl/nls/wfmonitor.manifest"],{}),csui.require(["require","css"],function(e,t){"use strict";t.styleLoad(e,"workflow/bundles/workflow-all",!0)});
//# sourceMappingURL=workflow-all.js.map