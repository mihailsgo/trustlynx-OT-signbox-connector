csui.define("css!conws/utils/icons/icons",[],function(){}),csui.define("conws/utils/icons/icons",["css!conws/utils/icons/icons"],function(e){return[{"equals":{"type":864},"className":"csui-icon conws-mime_workspace"},{"equals":{"type":848},"className":"csui-icon conws-mime_workspace","iconName":"conws_mime_workspace","withColorSchemaIconName":"conws_colorschema_mime_workspace"},{"equals":{"type":854},"className":"csui-icon conws-mime_related_workspace","iconName":"conws_mime_related_workspace"},{"equals":{"type":20541},"className":"csui-icon conws-doctemplates_volume"}]}),csui.define("conws/utils/icons/conws.icons.v2",[],function(){return{"conws_mime_workspace":'<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 32 32" class="csui-icon-v2 csui-icon-v2__conws_mime_workspace"><g/><g/><g/><g/><g><g><g><path fill="#4A5962" d="M14.672,11.609h5.782V4.525c0-1.72-1.407-3.127-3.127-3.127H4.589c-1.72,0-3.127,1.407-3.127,3.127 v12.739c0,1.72,1.407,3.127,3.127,3.127h6.957v-5.655C11.546,13.016,12.953,11.609,14.672,11.609z"/><path fill="#FFFFFF" d="M17.328,1.399c1.72,0,3.127,1.407,3.127,3.127v7.084h-5.782c-1.72,0-3.127,1.407-3.127,3.127v5.655H4.589 c-1.72,0-3.127-1.407-3.127-3.127V4.525c0-1.72,1.407-3.127,3.127-3.127H17.328 M17.328,0.399H4.589 c-2.275,0-4.127,1.851-4.127,4.127v12.739c0,2.275,1.851,4.127,4.127,4.127h6.957h1v-1v-5.655c0-1.173,0.954-2.127,2.127-2.127 h5.782h1v-1V4.525C21.454,2.25,19.603,0.399,17.328,0.399L17.328,0.399z"/></g><g><path fill="#7B9AB0" d="M27.411,11.609h-6.957v5.655c0,1.72-1.407,3.127-3.127,3.127h-5.782v7.084 c0,1.72,1.407,3.127,3.127,3.127h12.739c1.72,0,3.127-1.407,3.127-3.127V14.736C30.538,13.016,29.131,11.609,27.411,11.609z"/><path fill="#FFFFFF" d="M27.411,11.609c1.72,0,3.127,1.407,3.127,3.127v12.739c0,1.72-1.407,3.127-3.127,3.127H14.672 c-1.72,0-3.127-1.407-3.127-3.127v-7.084h5.782c1.72,0,3.127-1.407,3.127-3.127v-5.655H27.411 M27.411,10.609h-6.957h-1v1v5.655 c0,1.173-0.954,2.127-2.127,2.127h-5.782h-1v1v7.084c0,2.275,1.851,4.127,4.127,4.127h12.739c2.275,0,4.127-1.851,4.127-4.127 V14.736C31.538,12.46,29.687,10.609,27.411,10.609L27.411,10.609z"/></g><g><path fill="#627783" d="M20.454,17.264v-5.655h-5.782c-1.72,0-3.127,1.407-3.127,3.127v5.655h5.782 C19.047,20.391,20.454,18.984,20.454,17.264z"/><path fill="#FFFFFF" d="M20.454,11.609v5.655c0,1.72-1.407,3.127-3.127,3.127h-5.782v-5.655c0-1.72,1.407-3.127,3.127-3.127 H20.454 M21.454,10.609h-1h-5.782c-2.275,0-4.127,1.851-4.127,4.127v5.655v1h1h5.782c2.276,0,4.127-1.851,4.127-4.127v-5.655 V10.609L21.454,10.609z"/></g></g></g><g/></svg>',"conws_mime_related_workspace":'<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 32 32" class="csui-icon-v2 csui-icon-v2__conws_mime_related_workspace"><g><g><g><path fill="#B36601" d="M1.5,27.5v-21c0-1.1,0.9-2,2.1-2h8.2c0.5,0,0.9,0.2,1.3,0.5l3.8,3.2c0.3,0.2,0.4,0.3,0.6,0.3h10.9c1.1,0,2.1,0.9,2.1,2v17H1.5z"/></g><g><g><path fill="#FFFFFF" d="M11.8,5c0.4,0,0.7,0.1,1,0.4l3.7,3.2C16.8,8.8,17.1,9,17.4,9h10.9c0.8,0,1.7,0.7,1.7,1.5V27H2V6.5C2,5.7,2.7,5,3.6,5H11.8 M11.8,4H3.6C2.1,4,1,5.1,1,6.5V27v1h1H30h1v-1V10.5C31,9.1,29.9,8,28.4,8H17.6c0,0-0.1,0-0.3-0.2l-3.7-3.2l0,0l0,0C13,4.2,12.4,4,11.8,4L11.8,4z"/></g></g></g></g><g><path fill="#E3992E" d="M28,11H4c-0.6,0-1,0.4-1,1v14l26-13v-1C29,11.5,28.6,11,28,11z"/></g><g><polygon fill="#DD8100" points="29,26 29,13 3.1,26"/></g><g><g><g><path fill="#B36601" d="M9,17.9v-3.9c0-0.6,0.4-1.1,1.1-1.1h3.9c0.6,0,1.1,0.4,1.1,1.1v3.9c0,0.6-0.4,1.1-1.1,1.1h-3.9C9.4,19,9,18.5,9,17.9z"/></g></g></g><g><g><g><path fill="#B36601" d="M16,17.9v-3.9c0-0.6,0.4-1.1,1.1-1.1h3.9c0.6,0,1.1,0.4,1.1,1.1v3.9c0,0.6-0.4,1.1-1.1,1.1h-3.9C16.4,19,16,18.5,16,17.9z"/></g></g></g><g><g><g><path fill="#B36601" d="M9,24.9v-3.9c0-0.6,0.4-1.1,1.1-1.1h3.9c0.6,0,1.1,0.4,1.1,1.1v3.9c0,0.6-0.4,1.1-1.1,1.1h-3.9C9.4,26,9,25.5,9,24.9z"/></g></g></g><g><g><g><path fill="#B36601" d="M16,24.9v-3.9c0-0.6,0.4-1.1,1.1-1.1h3.9c0.6,0,1.1,0.4,1.1,1.1v3.9c0,0.6-0.4,1.1-1.1,1.1h-3.9C16.4,26,16,25.5,16,24.9z"/></g></g></g><g><g><g><path fill="#FFFFFF" d="M9,16.9v-3.9c0-0.6,0.4-1.1,1.1-1.1h3.9c0.6,0,1.1,0.4,1.1,1.1v3.9c0,0.6-0.4,1.1-1.1,1.1h-3.9C9.4,18,9,17.5,9,16.9z"/></g></g></g><g><g><g><path fill="#FFFFFF" d="M16,16.9v-3.9c0-0.6,0.4-1.1,1.1-1.1h3.9c0.6,0,1.1,0.4,1.1,1.1v3.9c0,0.6-0.4,1.1-1.1,1.1h-3.9C16.4,18,16,17.5,16,16.9z"/></g></g></g><g><g><g><path fill="#FFFFFF" d="M9,23.9v-3.9c0-0.6,0.4-1.1,1.1-1.1h3.9c0.6,0,1.1,0.4,1.1,1.1v3.9c0,0.6-0.4,1.1-1.1,1.1h-3.9C9.4,25,9,24.5,9,23.9z"/></g></g></g><g><g><g><path fill="#FFFFFF" d="M16,23.9v-3.9c0-0.6,0.4-1.1,1.1-1.1h3.9c0.6,0,1.1,0.4,1.1,1.1v3.9c0,0.6-0.4,1.1-1.1,1.1h-3.9C16.4,25,16,24.5,16,23.9z"/></g></g></g></svg>',"conws_action_navigate_up":'<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 32 32" class="csui-icon-v2 csui-icon-v2__conws_action_navigate_up"><circle cx="16" cy="16" r="14" fill="#FFFFFF" class="csui-icon-v2-state"/><circle cx="16" cy="16" r="15.5" fill="none" stroke="#2E3D98" class="csui-icon-v2-focus"/><g><g><path d="M21.8,22.6c0,0.1,0,0.2-0.1,0.3c0,0.1-0.1,0.2-0.2,0.3c-0.1,0.1-0.2,0.1-0.3,0.2c-0.1,0-0.2,0.1-0.3,0.1h-3.4 c-1,0-1.9-0.4-2.6-1.1c-0.7-0.7-1.1-1.6-1.1-2.6v-8.4l-2.2,2.2c-0.1,0.1-0.2,0.1-0.3,0.2c-0.1,0-0.2,0.1-0.3,0.1 c-0.1,0-0.2,0-0.3-0.1c-0.1,0-0.2-0.1-0.3-0.2c-0.2-0.2-0.2-0.4-0.2-0.6s0.1-0.4,0.2-0.6L14,8.7c0.2-0.2,0.4-0.2,0.6-0.2 c0.2,0,0.4,0.1,0.6,0.2l3.6,3.6c0.1,0.1,0.1,0.2,0.2,0.3c0,0.1,0.1,0.2,0.1,0.3s0,0.2-0.1,0.3c0,0.1-0.1,0.2-0.2,0.3 c-0.1,0.1-0.2,0.1-0.3,0.2c-0.1,0-0.2,0.1-0.3,0.1c-0.1,0-0.2,0-0.3-0.1c-0.1,0-0.2-0.1-0.3-0.2l-2.1-2.1v8.3c0,0.3,0,0.5,0.1,0.8 c0.1,0.2,0.2,0.5,0.4,0.7c0.2,0.2,0.4,0.3,0.7,0.4c0.2,0.1,0.5,0.2,0.8,0.1h3.4c0.2,0,0.4,0.1,0.6,0.3 C21.7,22.2,21.8,22.4,21.8,22.6z" fill="#333333" class="csui-icon-v2-metaphor0"/></g></g></svg>',"conws_action_quick_link32":'<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 32 32" class="csui-icon-v2 csui-icon-v2__conws_action_quick_link32"><circle cx="16" cy="16" r="14" fill="#FFFFFF" class="csui-icon-v2-state"/><circle cx="16" cy="16" r="15.5" fill="none" stroke="#2E3D98" class="csui-icon-v2-focus"/><g><path d="M16,25.375c-5.17,0-9.375-4.205-9.375-9.375S10.83,6.625,16,6.625S25.375,10.83,25.375,16 S21.17,25.375,16,25.375z" fill="#333333" opacity="0.5" class="csui-icon-v2-metaphor0"/><path d="M16,6C10.477,6,6,10.477,6,16s4.477,10,10,10s10-4.478,10-10S21.523,6,16,6z M16,24.75 c-2.188,0-4.186-0.812-5.721-2.145l8.846-8.846v5.991c0,0.345,0.28,0.625,0.625,0.625s0.625-0.28,0.625-0.625v-8.125H12.25 c-0.345,0-0.625,0.28-0.625,0.625s0.28,0.625,0.625,0.625h5.991l-8.846,8.846C8.062,20.186,7.25,18.188,7.25,16 c0-4.825,3.925-8.75,8.75-8.75s8.75,3.925,8.75,8.75S20.825,24.75,16,24.75z" fill="#F7F7F7" class="csui-icon-v2-metaphor1"/></g></svg>',"conws_colorschema_mime_workspace":'<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 16 16" class="csui-icon-v2 csui-icon-v2__conws_colorschema_mime_workspace"><path d="M13.5,6H10v2.5C10,9.328,9.328,10,8.5,10H6v3.5C6,14.328,6.672,15,7.5,15h6 c0.828,0,1.5-0.672,1.5-1.5v-6C15,6.672,14.328,6,13.5,6z" fill="#98A8B2" class="csui-icon-v2-colorFirst"/><path d="M6,7.5V10H2.5C1.672,10,1,9.328,1,8.5v-6C1,1.672,1.672,1,2.5,1h6C9.328,1,10,1.672,10,2.5V6 H7.5C6.672,6,6,6.672,6,7.5z M10,8.5V6H7.5C6.672,6,6,6.672,6,7.5V10h2.5C9.328,10,10,9.328,10,8.5z" fill="#758B98" class="csui-icon-v2-colorThird"/><path d="M13.5,5H11V2.5C11,1.122,9.878,0,8.5,0h-6C1.122,0,0,1.122,0,2.5v6C0,9.878,1.122,11,2.5,11H5 v2.5C5,14.878,6.122,16,7.5,16h6c1.378,0,2.5-1.122,2.5-2.5v-6C16,6.122,14.878,5,13.5,5z M2.5,10C1.672,10,1,9.328,1,8.5v-6 C1,1.672,1.672,1,2.5,1h6C9.328,1,10,1.672,10,2.5V5H7.5C6.122,5,5,6.122,5,7.5V10H2.5z M10,6v2.5C10,9.328,9.328,10,8.5,10H6V7.5 C6,6.672,6.672,6,7.5,6H10z M15,13.5c0,0.828-0.672,1.5-1.5,1.5h-6C6.672,15,6,14.328,6,13.5V11h2.5C9.878,11,11,9.878,11,8.5V6h2.5 C14.328,6,15,6.672,15,7.5V13.5z" fill="#FFFFFF" class="csui-icon-v2-colorSecond"/></svg>',"conws_action_backv2":'<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 32 32" class="csui-icon-v2 csui-icon-v2__conws_action_backv2"><circle cx="16" cy="16" r="14" fill="#FFFFFF" class="csui-icon-v2-state"/><path d="M23.973,14.79H10.987l6.146-5.588l-1.364-1.433L6.973,15.77l8.796,7.999l1.364-1.433l-6.15-5.59 h12.99c0.553,0,1-0.438,1-0.978C24.973,15.228,24.526,14.79,23.973,14.79z" fill="#5264BE" class="csui-icon-v2-metaphor0"/></svg>'}}),csui.define("conws/models/workspacetypes/workspacetype.model",["require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/url"],function(e,t,i,o,n){"use strict";return o.Model.extend({"nameAttribute":"wksp_type_name","imageAttribute":"wksp_type_icon","constructor":function(e,i){o.Model.prototype.constructor.apply(this,arguments),this.options=t.pick(i,"context")},"parse":function(e){this.fetched=!0;var i=e&&e.data||{},o=t.extend(i.properties||{},i.wksp_info||{});return o.id=o.wksp_type_id,o.display_name=o.wksp_type_name,o.type=864,o},"ensureFetched":function(e){return this.fetched?(e&&e.success&&e.success(this),i.Deferred().resolve(this,{},e).promise()):this.fetch(e)},"fetch":function(e){function o(){e&&e.error&&e.error(this),s.reject()}function n(e,t,i){var n=e.get(this.get("id"));n?(this.set(n.attributes),this.fetched=!0,i&&i.success&&i.success(this),t.resolve(this,{},i)):o.call(this,t,i)}var s=i.Deferred();return csui.require(["conws/models/workspacetypes/workspacetypes.factory"],t.bind(function(i){var l=this.options.context.getModel(i);l.fetched?n.call(this,l,s,e):l.fetch(e).then(t.bind(function(){n.call(this,l,s,e)},this),t.bind(function(){o.call(this,s,e)},this))},this),t.bind(function(){o.call(this,s,e)},this)),s.promise()}})}),csui.define("conws/models/workspacetypes/workspacetypes.model",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/models/browsable/client-side.mixin","csui/utils/url","conws/models/workspacetypes/workspacetype.model"],function(e,t,i,o,n,s){"use strict";var l=i.Collection.extend({"model":s,"constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments),this.makeClientSideBrowsable(t),t&&t.connector&&t.connector.assignTo(this)},"url":function(){var e=this.connector.getConnectionUrl().getApiBase("v2");return n.combine(e,"businessworkspacetypes")},"parse":function(e){return this.fetched=!0,e.results},"isFetchable":function(){return!0}});return o.mixin(l.prototype),l}),csui.define("conws/models/workspacetypes/workspacetypes.factory",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","conws/models/workspacetypes/workspacetypes.model","csui/utils/commands"],function(e,t,i,o,n,s,l,a){"use strict";return n.extend({"propertyPrefix":"workspacetypes","constructor":function(e,t){n.prototype.constructor.apply(this,arguments);var o=e.getObject(s,t);this.context=e,t=i.extend(t||{},{"connector":o}),this.property=new l(void 0,t)},"isFetchable":function(){return this.property.isFetchable()},"fetch":function(e){return this.property.fetch(e)}})}),csui.define("conws/controls/inlineforms/conwstemplate/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/controls/inlineforms/conwstemplate/impl/nls/root/lang",{"NamePlaceholder":"Enter name","WSTypePlaceholder":"Select Workspace Type"}),csui.define("conws/controls/inlineforms/conwstemplate/conws.inlineform.schemas",["csui/lib/jquery","conws/models/workspacetypes/workspacetypes.factory","i18n!conws/controls/inlineforms/conwstemplate/impl/nls/lang"],function(e,t,i){return[{"equals":{"type":848},"addableCommandInfo":{"signature":"AddCONWSTemplate","group":"conws"},"form":{"fields":{"name":{"type":"text","required":!0,"namePlaceholder":i.NamePlaceholder,"multilingual":!0},"reference_type":{"type":"select","required":!0,"hideInEditMode":!0,"namePlaceholder":i.WSTypePlaceholder,"getData":function(i){var o=e.Deferred(),n=i.context.getModel(t),s=function(e){var t=[];return e.forEach(function(e){t.push({"value":e.get("id"),"displayName":e.get("wksp_type_name"),"selected":!1})}),t};return n.fetched?o.resolve(s(n)):n.fetch().done(function(e){o.resolve(s(e))}),o.promise()}}}}}]}),csui.define("conws/controls/form/fields/referencefield.states.behavior",["csui/controls/form/fields/base/csformfield.states.behavior"],function(e){return e.extend({"constructor":function(t,i){e.apply(this,arguments)},"isReadOnly":function(){return!0}})}),csui.define("hbs!conws/controls/form/impl/fields/reference/reference",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"hasValue"):t,{"name":"if","hash":{},"fn":e.program(2,n,0),"inverse":e.program(4,n,0),"loc":{"start":{"line":3,"column":1},"end":{"line":18,"column":8}}}))?s:""},"2":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\t\t\t <div class="btn-container reference-field-data">\r\n\t\t\t\t<button aria-labelledby="'+e.escapeExpression((s=null!=(s=l(i,"idBtnLabel")||(null!=t?l(t,"idBtnLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"idBtnLabel","hash":{},"loc":{"start":{"line":5,"column":29},"end":{"line":5,"column":43}}}):s))+" "+e.escapeExpression((s=null!=(s=l(i,"refDataId")||(null!=t?l(t,"refDataId"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"refDataId","hash":{},"loc":{"start":{"line":5,"column":44},"end":{"line":5,"column":57}}}):s))+'" title="'+e.escapeExpression((s=null!=(s=l(i,"data")||(null!=t?l(t,"data"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"data","hash":{},"loc":{"start":{"line":5,"column":66},"end":{"line":5,"column":74}}}):s))+'">\r\n\t\t\t\t\t<span id="'+e.escapeExpression((s=null!=(s=l(i,"refDataId")||(null!=t?l(t,"refDataId"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"refDataId","hash":{},"loc":{"start":{"line":6,"column":15},"end":{"line":6,"column":28}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"data")||(null!=t?l(t,"data"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"data","hash":{},"loc":{"start":{"line":6,"column":30},"end":{"line":6,"column":38}}}):s))+"</span>\r\n\t\t\t\t</button>\r\n\t\t\t </div>\r\n"},"4":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\t\t<div class="reference-field-generate '+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"generateReference"):t,{"name":"if","hash":{},"fn":e.noop,"inverse":e.program(5,n,0),"loc":{"start":{"line":10,"column":39},"end":{"line":10,"column":88}}}))?s:"")+'">\r\n\t\t\t<button id="'+e.escapeExpression((l=null!=(l=a(i,"id")||(null!=t?a(t,"id"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":11,"column":15},"end":{"line":11,"column":21}}}):l))+'" aria-label="'+e.escapeExpression((l=null!=(l=a(i,"btnDesc")||(null!=t?a(t,"btnDesc"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"btnDesc","hash":{},"loc":{"start":{"line":11,"column":35},"end":{"line":11,"column":46}}}):l))+'" class="binf-btn binf-btn-primary reference-generate-number '+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"generateReference"):t,{"name":"if","hash":{},"fn":e.noop,"inverse":e.program(7,n,0),"loc":{"start":{"line":11,"column":107},"end":{"line":11,"column":175}}}))?s:"")+'" \r\n\t\t\t\t\ttitle="'+e.escapeExpression((l=null!=(l=a(i,"genRefNumber")||(null!=t?a(t,"genRefNumber"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"genRefNumber","hash":{},"loc":{"start":{"line":12,"column":12},"end":{"line":12,"column":28}}}):l))+'" '+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"generateReference"):t,{"name":"if","hash":{},"fn":e.noop,"inverse":e.program(9,n,0),"loc":{"start":{"line":12,"column":30},"end":{"line":12,"column":84}}}))?s:"")+">"+e.escapeExpression((l=null!=(l=a(i,"genRefNumber")||(null!=t?a(t,"genRefNumber"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"genRefNumber","hash":{},"loc":{"start":{"line":12,"column":85},"end":{"line":12,"column":101}}}):l))+'\r\n\t\t\t</button>\r\n\t\t</div>\r\n\t\t<div class="reference-field-generate-read">\r\n\t\t\t<div class="reference-field-generate-text">'+e.escapeExpression((l=null!=(l=a(i,"depInlineText")||(null!=t?a(t,"depInlineText"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"depInlineText","hash":{},"loc":{"start":{"line":16,"column":46},"end":{"line":16,"column":63}}}):l))+" </div>\r\n\t\t</div>\r\n"},"5":function(e,t,i,o,n){return" cursor-disabled "},"7":function(e,t,i,o,n){return" reference-generate-number-disabled "},"9":function(e,t,i,o,n){return' aria-disabled="true" '},"11":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'   <div class="cs-field-read">\r\n        <div class="cs-field-read-inner">\r\n            <div class="btn-container">\r\n\t\t\t\t<button aria-labelledby="'+e.escapeExpression((l=null!=(l=a(i,"idBtnLabel")||(null!=t?a(t,"idBtnLabel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"idBtnLabel","hash":{},"loc":{"start":{"line":23,"column":29},"end":{"line":23,"column":43}}}):l))+" "+e.escapeExpression((l=null!=(l=a(i,"refDataId")||(null!=t?a(t,"refDataId"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"refDataId","hash":{},"loc":{"start":{"line":23,"column":44},"end":{"line":23,"column":57}}}):l))+'" title="'+e.escapeExpression((l=null!=(l=a(i,"data")||(null!=t?a(t,"data"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"data","hash":{},"loc":{"start":{"line":23,"column":66},"end":{"line":23,"column":74}}}):l))+'">\r\n\t\t\t\t\t<span id="'+e.escapeExpression((l=null!=(l=a(i,"refDataId")||(null!=t?a(t,"refDataId"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"refDataId","hash":{},"loc":{"start":{"line":24,"column":15},"end":{"line":24,"column":28}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"data")||(null!=t?a(t,"data"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"data","hash":{},"loc":{"start":{"line":24,"column":30},"end":{"line":24,"column":38}}}):l))+"</span>\r\n\t\t\t\t</button>\r\n            </div>\r\n        </div>\r\n    </div>   \r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"readOnly"):t,{"name":"if","hash":{},"fn":e.noop,"inverse":e.program(12,n,0),"loc":{"start":{"line":29,"column":4},"end":{"line":40,"column":11}}}))?s:"")},"12":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"canRegenerateReference"):t,{"name":"if","hash":{},"fn":e.program(13,n,0),"inverse":e.noop,"loc":{"start":{"line":30,"column":2},"end":{"line":39,"column":9}}}))?s:""},"13":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\t\t\t<div class="reference-field-generate-read">\r\n\t\t\t\t<button id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":32,"column":16},"end":{"line":32,"column":22}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"btnDesc")||(null!=t?l(t,"btnDesc"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"btnDesc","hash":{},"loc":{"start":{"line":32,"column":36},"end":{"line":32,"column":47}}}):s))+'" class="binf-btn binf-btn-primary reference-generate-number"\r\n\t\t\t\t\t\ttitle="'+e.escapeExpression((s=null!=(s=l(i,"reGenRefNumber")||(null!=t?l(t,"reGenRefNumber"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"reGenRefNumber","hash":{},"loc":{"start":{"line":33,"column":13},"end":{"line":33,"column":31}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"reGenRefNumber")||(null!=t?l(t,"reGenRefNumber"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"reGenRefNumber","hash":{},"loc":{"start":{"line":33,"column":33},"end":{"line":33,"column":51}}}):s))+'\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t\t<div class="reference-field-generate-read">\r\n\t\t\t\t<div class="reference-field-generate-text">'+e.escapeExpression((s=null!=(s=l(i,"depInlineText")||(null!=t?l(t,"depInlineText"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"depInlineText","hash":{},"loc":{"start":{"line":37,"column":47},"end":{"line":37,"column":64}}}):s))+" </div>\r\n\t\t\t</div>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="reference-field">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"create"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.program(11,n,0),"loc":{"start":{"line":2,"column":2},"end":{"line":41,"column":9}}}))?s:"")+"</div>\r\n\r\n"}});return i.registerPartial("conws_controls_form_impl_fields_reference_reference",o),o}),csui.define("conws/controls/form/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/controls/form/impl/nls/root/lang",{"genRefNumber":"Generate reference","reGenRefNumber":"Re-generate reference","depFieldsText":"Value can be generated automatically and depends on","rmClassificationText":"RM Classification","rmClassificationNameText":"Following RM classification will be used in reference generation:","independentFieldsText":"Value can be generated automatically","alpacaPlaceholderOTCustomColumnPicker":"Select column","alpacaPlaceholderOTWorkspacePicker":"Select workspace","alpacaPlaceholderOTWorkspaceTypePicker":"Select type","titleWorkspaceSearchIcon":"Show available workspaces","titleWorkspaceTypeSearchIcon":"Show available workspace types","serverResponseEmptyErrMsg":"Server response is empty"}),csui.define("css!conws/controls/form/impl/fields/reference/reference",[],function(){}),csui.define("conws/controls/form/fields/reference.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/controls/form/fields/base/csformfield.view","csui/utils/url","csui/controls/form/fields/base/csformfield.editable.behavior","csui/dialogs/modal.alert/modal.alert","csui/controls/form/pub.sub","conws/controls/form/fields/referencefield.states.behavior","hbs!conws/controls/form/impl/fields/reference/reference","i18n!conws/controls/form/impl/nls/lang","css!conws/controls/form/impl/fields/reference/reference"],function(e,t,i,o,n,s,l,a,r,c,d,u){"use strict";return n.extend({"constructor":function(t){n.apply(this,arguments),this.create="create"===this.options.mode,this.catId=this.options.dataId.split("_")[0],this.formView=this.options.alpacaField.connector.config.formView,this.node=this.formView.node?this.formView.node:this.formView.model.node,this.connector=this.node.connector,this.generatereference=!1,this.regenerateReference=!1,this.parentsAttrDataChanged=!1,this.parentattrIds=[],this.parentsattrData=[],this.canRegenerateReference=this.alpacaField.schema.canRegenerateReference,this.isInDocTemplateVolTree=this.alpacaField.schema.isInDocTemplateVolTree,this.rmClassificationUsed=this.alpacaField.schema.rmClassificationUsed,this.rmClassificationsAttached=!0,this.alpacaField.schema.oldReferenceAttributeID&&(this.oldReferenceAttributeID=this.alpacaField.schema.oldReferenceAttributeID),this.create&&this.listenTo(this.formView,"invalid:field",this.invalidFieldChange);var i;this.hasValue=null!==this.alpacaField.data&&void 0!==this.alpacaField.data&&""!==this.alpacaField.data,this.alpacaField.schema.depattrlist&&e.each(this.options.alpaca.schema.depattrlist,function(e){this.parentattrIds.push(e),i={"id":e,"data":this.getAttrData(e)},this.parentsattrData.push(i),this.create&&this.listenTo(r,e+"dependentattrchanged",this.parentChange)},this),this.parentattrIds.length>0?this.checkReadyForGenerateReference():this.hasValue||(this.generatereference=!0),this.create&&this.rmClassificationUsed&&this.formView.model.collection&&(this.listenTo(this.formView.model.collection,"add",this.rmClassificationChange),this.listenTo(this.formView.model.collection,"remove",this.rmClassificationChange),this.formView.model.collection.get("recordsDetails")||(this.rmClassificationsAttached=!1,this.generatereference=!1,this.regenerateReference=!1)),!1===this.create&&(this.regenerateReference=!0),this.idBtnLabel=this.options.labelId?this.options.labelId:"",this.refDataId=e.uniqueId("referenceData"),this.depFieldsText=this.getDependencyInlineText(),this.btnDesc=this.alpacaField.options.label+", "+(this.hasValue?u.reGenRefNumber:u.genRefNumber)+", "+(this.canRegenerateReference?this.depFieldsText:"")},"className":"cs-formfield cs-referencefield","template":d,"templateHelpers":function(){return{"create":this.create,"generateReference":this.generatereference,"data":this.curVal,"hasValue":this.hasValue,"readOnly":this.alpacaField.schema.readonly,"depInlineText":this.depFieldsText,"id":this.model&&this.model.get("id")?this.model.get("id"):e.uniqueId("button"),"genRefNumber":u.genRefNumber,"reGenRefNumber":u.reGenRefNumber,"canRegenerateReference":this.canRegenerateReference,"idBtnLabel":this.idBtnLabel,"refDataId":this.refDataId,"btnDesc":this.btnDesc}},"behaviors":{"FormFieldEditable":{"behaviorClass":l},"FormFieldStates":{"behaviorClass":c}},"events":{"click button.reference-generate-number":"generateReferenceNumber"},"onRender":function(){if(this.isInDocTemplateVolTree){var e=this.$el.find("button.reference-generate-number");e.addClass("reference-generate-number-disabled").attr("aria-disabled","true"),e.parent("div").addClass("cursor-disabled")}},"getDependencyInlineText":function(){var e,t="",i="";return this.rmClassificationUsed&&this.rmClassificationsAttached&&this.formView.model.collection&&(this.formView.model.collection.get("recordsDetails").options.className?i=this.formView.model.collection.get("recordsDetails").options.className:this.formView.model.collection.get("recordsDetails").get("data")&&(e=this.formView.model.collection.get("recordsDetails").get("data"),e.name?i=this.formView.model.collection.get("recordsDetails").get("data").name:e.inherited_rmclassification_name&&(i=e.inherited_rmclassification_name[0]))),this.parentattrIds.length>0?(t=u.depFieldsText+" "+this.alpacaField.schema.depattrtext,this.rmClassificationUsed&&(t=t+", "+u.rmClassificationText,this.rmClassificationsAttached&&(t=t+". "+u.rmClassificationNameText+" "+i))):this.rmClassificationUsed?(t=u.depFieldsText+" "+u.rmClassificationText,this.rmClassificationsAttached&&(t=t+". "+u.rmClassificationNameText+" "+i)):t=u.independentFieldsText,t},"generateReferenceNumber":function(e){if("true"===this.$el.find("button.reference-generate-number").attr("aria-disabled"))return e.preventDefault();var t,i=this.node.connector,o=this.getV2Url(i.connection.url),n=this,l=n.node.get("name"),r=this.getFormData();t=s.combine(o,"refnumbers");var c={"type":"POST","url":t,"data":r,"success":function(e,t,i){if(e.results)if(e.results.errMsg)a.showError(e.results.errMsg);else{if(n.regenerateReference&&n.oldReferenceAttributeID){var o=n.getAttrElement(n.oldReferenceAttributeID);void 0!==o&&(o.setValue(n.curVal),o.refresh())}if(n.options.alpacaField.setValue(e.results.referenceNumber),n.hasValue=!0,n.curVal=n.options.alpacaField.getValue(),n.generatereference=!1,!1===n.create&&(n.regenerateReference=!0),n.parentsAttrDataChanged=!1,n.create)n.render(n.$el.find(".reference-field-data button").length>0)&&n.$el.find(".reference-field-data button").focus();else{var s=n.$el.find(".reference-field .btn-container button");s.find("span").text(n.curVal),s.attr("title",n.curVal),s.focus()}var r=e.results.nodeName;n.create||848!==n.node.get("type")||(n.formView.options.metadataView?n.formView.options.metadataView.metadataHeaderView.metadataItemNameView.model.set("name",r):n.formView.options.node.set("name",r)),r&&l&&l!==r&&n.formView.options.context&&n.formView.options.context.trigger("current:folder:changed",{"attributes":{"id":n.node.get("id"),"name":r}})}else a.showError(u.serverResponseEmptyErrMsg)},"error":function(e,t,i){var o=e.responseJSON?e.responseJSON.errorDetail?e.responseJSON.errorDetail:e.responseJSON.error:u.defaultErrorGenerateNumber;a.showError(o)}};i.extendAjaxOptions(c),i.makeAjaxCall(c)},"getV2Url":function(e){return new s(e).getApiBase("v2")},"invalidFieldChange":function(t){var i=document.getElementById(t.target.id).closest(".alpaca-container-item").getAttribute("data-alpaca-container-item-name"),o=this;e.each(this.options.alpaca.schema.depattrlist,function(t){t===i&&e.each(o.parentsattrData,function(e){e.id===i&&(e.data=null)})});var n=this.generatereference;this.checkReadyForGenerateReference(),this.create?this.regenerateReference=!1:this.hasValue?this.generatereference=!1:this.generatereference=!0,n!==this.generatereference&&(this.generatereference?this.isInDocTemplateVolTree||this.$el.find("button.reference-generate-number").removeClass("reference-generate-number-disabled").attr("aria-disabled","false"):(this.$el.find(".reference-field-generate").addClass("cursor-disabled"),this.$el.find("button.reference-generate-number").addClass("reference-generate-number-disabled").attr("aria-disabled","true")))},"parentChange":function(e){var t,i=e,o=this.generatereference;i!==this&&(this.insertParentAttrData(e),this.checkReadyForGenerateReference(),this.create?this.regenerateReference=!1:this.hasValue?this.generatereference=!1:this.generatereference=!0,t=this.generatereference,o!==t&&(this.generatereference?this.isInDocTemplateVolTree||this.$el.find("button.reference-generate-number").removeClass("reference-generate-number-disabled").attr("aria-disabled","false"):(this.$el.find(".reference-field-generate").addClass("cursor-disabled"),this.$el.find("button.reference-generate-number").addClass("reference-generate-number-disabled").attr("aria-disabled","true"))))},"rmClassificationChange":function(){var e,t=this.generatereference;this.formView.model.collection&&this.formView.model.collection.get("recordsDetails")?(this.rmClassificationsAttached=!0,this.create?this.generatereference=!0:this.regenerateReference=!0):(this.rmClassificationsAttached=!1,this.generatereference=!1,this.regenerateReference=!1),this.checkReadyForGenerateReference();var i=this.getDependencyInlineText(),o=this.alpacaField.options.label+", "+(this.hasValue?u.reGenRefNumber:u.genRefNumber)+", "+(this.canRegenerateReference?i:"");this.$el.find(".reference-field .reference-field-generate-read .reference-field-generate-text").text(i),this.$el.find("button.reference-generate-number").attr("aria-label",o),e=this.generatereference,t!==e&&(this.generatereference?this.isInDocTemplateVolTree||(this.$el.find(".reference-field-generate").removeClass("cursor-disabled"),this.$el.find("button.reference-generate-number").removeClass("reference-generate-number-disabled").attr("aria-disabled","false")):(this.$el.find(".reference-field-generate").addClass("cursor-disabled"),this.$el.find("button.reference-generate-number").addClass("reference-generate-number-disabled").attr("aria-disabled","true")))},"checkReadyForGenerateReference":function(){var t=0
;e.each(this.parentsattrData,function(e){void 0!==e.data&&null!==e.data&&""!==e.data&&t++}),t===this.parentsattrData.length?this.create&&this.hasValue?(this.generatereference=!1,this.regenerateReference=!1):this.rmClassificationsAttached?this.create?(this.generatereference=!0,this.regenerateReference=!1):this.parentsAttrDataChanged?this.regenerateReference=!0:this.generatereference=!0:(this.generatereference=!1,this.regenerateReference=!1):(this.generatereference=!1,this.regenerateReference=!1)},"insertParentAttrData":function(t){var i=this,o=t.curVal;e.each(i.parentsattrData,function(e){e.id===t.options.dataId&&("object"==typeof t.curVal&&(o=t.curVal.id),String(e.data)!==o&&(e.data=o,i.generatereference=!0,i.regenerateReference=!0,i.parentsAttrDataChanged=!0))})},"getAttrData":function(e){var t,i,o,n,s=e.split("_"),l=s[0],a=0;if(s.length>3)if(6===s.length){if(o=s[0]+"_"+s[1],i=this.formView.alpaca.data[o],n=e.replace(o+"_",""),void 0!==i)t=i[n];else if(this.formView.metadataview.formViewList.length>1)for(a=0;a<this.formView.metadataview.formViewList.length;a++)if(void 0!==this.formView.metadataview.formViewList[a].alpaca.data[n]){t=this.formView.metadataview.formViewList[a].alpaca.data[n];break}}else 7===s.length?s[2]===l?(o=s[0]+"_"+s[1],i=this.formView.alpaca.data[o],n=s[2]+"_"+s[3]+"_"+s[4]+"_"+s[5],t=i[n][0]):(o=s[0]+"_"+s[1],i=this.formView.alpaca.data[o][0],n=s[3]+"_"+s[4]+"_"+s[5]+"_"+s[6],t=i[n]):(o=s[0]+"_"+s[1],i=this.formView.alpaca.data[o][0],n=s[3]+"_"+s[4]+"_"+s[5]+"_"+s[6],t=i[n][0]);else{if(e=s[0]+"_"+s[1],void 0===(t=this.formView.alpaca.data[e])&&this.formView.metadataview.formViewList.length>1)for(a=0;a<this.formView.metadataview.formViewList.length;a++)if(void 0!==this.formView.metadataview.formViewList[a].alpaca.data[e]){t=this.formView.metadataview.formViewList[a].alpaca.data[e];break}3===s.length&&(t=t[0])}return t},"getAttrElement":function(e){var t,i,o,n=e.split("_"),s=n[0],l=0;if(n.length>3)if(6===n.length){if(i=n[0]+"_"+n[1],t=this.formView.$el.alpaca().childrenByPropertyId[i],o=e.replace(i+"_",""),void 0!==t)t=t.childrenByPropertyId[o];else if(this.formView.metadataview.formViewList.length>1)for(l=0;l<this.formView.metadataview.formViewList.length;l++)if(void 0!==this.formView.metadataview.formViewList[l].$el.alpaca().childrenByPropertyId[o]){t=this.formView.metadataview.formViewList[l].$el.alpaca().childrenByPropertyId[o];break}}else 7===n.length?n[2]===s?(i=n[0]+"_"+n[1],t=this.formView.$el.alpaca().childrenByPropertyId[i],o=n[2]+"_"+n[3]+"_"+n[4]+"_"+n[5],t=t.childrenByPropertyId[o].children[0]):(i=n[0]+"_"+n[1],t=this.formView.$el.alpaca().childrenByPropertyId[i].children[0],o=n[3]+"_"+n[4]+"_"+n[5]+"_"+n[6],t=t.childrenByPropertyId[o]):(i=n[0]+"_"+n[1],t=this.formView.$el.alpaca().childrenByPropertyId[i].children[0],o=n[3]+"_"+n[4]+"_"+n[5]+"_"+n[6],t=t.childrenByPropertyId[o].children[0]);else{if(e=n[0]+"_"+n[1],void 0===(t=this.formView.$el.alpaca().childrenByPropertyId[e])&&this.formView.metadataview.formViewList.length>1)for(l=0;l<this.formView.metadataview.formViewList.length;l++)if(void 0!==this.formView.metadataview.formViewList[l].$el.alpaca().childrenByPropertyId[e]){t=this.formView.metadataview.formViewList[l].$el.alpaca().childrenByPropertyId[e];break}3===n.length&&(t=t.children[0])}return t},"allowEditOnClickReadArea":function(){return!1},"getFormData":function(){var t,i={},o=this.create,n=this.node.attributes.id,s=this.node.attributes.parent_id,l=this.catId,a="",r="",c=0,d=this.options.alpaca.schema.cacheId;if(void 0!==o&&(i.create=o),!o)return void 0!==n&&(i.node_id=n),i;if(void 0!==d&&(i.cache_id=d),void 0!==s&&("object"==typeof s&&(s=s.id),i.parent_id=s),void 0!==l&&(i.category_id=l),this.formView.model.collection.get("recordsDetails")&&(t=this.formView.model.collection.get("recordsDetails").get("data"),t.rmclassification_id&&0!==t.rmclassification_id[0]?i.rm_class_ids=t.rmclassification_id[0]:t.inherited_rmclassification_id&&(i.rm_class_ids=t.inherited_rmclassification_id[0])),this.parentattrIds.length>0){var u=this.parentsattrData.length;e.each(this.parentsattrData,function(e){c++,c!==u?(a=a+"'"+e.id+"',",r=r+"'"+e.data+"',"):(a=a+"'"+e.id+"'",r=r+"'"+e.data+"'")}),void 0!==r&&void 0!==a&&(i.attribute_keys=a.toString(),i.attribute_values=r.toString())}return i}})}),csui.define("conws/controls/form/fields/alpaca/referencefield",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/alpaca/js/alpaca.lite","csui/models/form","conws/controls/form/fields/reference.view","csui/utils/base"],function(e,t,i,o,n,s,l,a,r){return s.Fields.ReferenceField=s.Fields.TextField.extend({"constructor":function(e,t,i,o,n,s,l){this.base(e,t,i,o,n,s,l)},"getFieldType":function(){return"reference"},"postRender":function(e){this.base(e),this.showField()},"showField":function(){var e=this.id;this.options.id="lbl"+t.uniqueId(e);var s,l=i(this.field[0]).find("label");l&&1===l.length&&(s=l.attr("for")+"Label",l.attr("id",s)),this.fieldView=new a({"model":new o.Model({"data":this.data,"options":this.options,"schema":this.schema,"id":e}),"id":t.uniqueId(e),"alpacaField":this,"labelId":s,"value":this.data,"readonly":!0,"mode":this.options.mode,"dataId":this.name,"path":this.path,"alpaca":{"data":this.data,"options":this.options,"schema":this.schema}});var r=i("<div>").addClass("alpaca-control");this.getControlEl().replaceWith(r),this.region=new n.Region({"el":r}),this.region.show(this.fieldView)},"focus":function(){this.fieldView.setFocus()},"destroy":function(){this.base(),this.region&&this.region.destroy()},"onShow":function(){i(".alpaca-field-reference label").click(function(e){return e.preventDefault(),e.stopPropagation(),!1})}}),s.registerFieldClass("reference",s.Fields.ReferenceField,"bootstrap-csui"),i.alpaca.Fields.ReferenceField}),csui.define("conws/models/pickers/pickerinfo.model",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/mixins/resource/resource.mixin"],function(e,t,i,o,n){var s=i.Model.extend({"constructor":function(e,t){t||(t={}),i.Model.prototype.constructor.call(this,e,t),this.options=t,this.makeResource(t)}});return n.mixin(s.prototype),t.extend(s.prototype,{"url":function(){var e=this.get("config_id"),t=this.get("object_id"),i=this.get("picker_type"),n=this.connector.getConnectionUrl().getApiBase("v2"),s=o.combine(n,"pickers",i),l={};void 0===this.options.forward&&(this.options.forward=void 0!==t||void 0===e),this.options.forward?l.object_id=t:l.config_id=e;var a=o.combineQueryString(l);return o.appendQuery(s,a)},"parse":function(e){return e&&e.results&&e.results.data},"toString":function(){return"pickerinfo:"+this.get("picker_type")+this.get("config_id")+","+this.get("object_id")}}),s}),csui.define("conws/models/pickers/pickerinfo.factory",["csui/lib/underscore","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","conws/models/pickers/pickerinfo.model"],function(e,t,i,o){return t.extend({"propertyPrefix":"pickerInfo","constructor":function n(s,l){t.prototype.constructor.apply(this,arguments);var a=l.pickerInfo.connector||s.getObject(i,l);if(l.model){var r=void 0!==l.forward?l.forward:l.model.options.forward;this.property=new o(l.model.attributes,{"connector":a,"forward":r}),this.property.fetched=l.model.fetched}else this.property=new o(l.attributes,{"connector":a,"forward":l.forward}),this.listenToOnce(this.property,"sync",function(){this.property.options.forward?s.getModel(n,{"forward":!1,"attributes":e.extend(e.omit(l.attributes,"object_id"),{"config_id":this.property.get("config_id")}),"model":this.property}):s.getModel(n,{"forward":!0,"attributes":e.extend(e.omit(l.attributes,"config_id"),{"object_id":this.property.get("object_id")}),"model":this.property})})},"fetch":function(e){return this.property.fetch(e)}})}),csui.define("css!conws/controls/customcolumnpicker/impl/customcolumnpicker",[],function(){}),csui.define("conws/controls/form/fields/customcolumnpickerfield.view",["csui/lib/jquery","csui/lib/underscore","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","csui/models/node/node.model","csui/controls/form/fields/nodepickerfield.view","conws/models/pickers/pickerinfo.factory","css!conws/controls/customcolumnpicker/impl/customcolumnpicker"],function(e,t,i,o,n,s,l){"use strict";var a=i.extend({"propertyPrefix":"lastColumnNode","constructor":function(e,t){i.prototype.constructor.apply(this,arguments);var s=e.getObject(o,t);this.property=new n(void 0,{"connector":s})}});return s.extend({"constructor":function(t){e.extend(!0,t.model.get("options"),{"type_control":{"parameters":{"select_types":[902],"globalSearch":!1}}}),s.apply(this,arguments),this.lastColumnNode=this.options.context.getModel(a,{"permanent":!0,"detached":!0})},"mapFieldValueToNodeId":function(t){if(t){var i=/{([^:}]+)(:([^}]+))?}/g,o=i.exec(t),n=o&&o[1],s=this.options.context.getModel(l,{"attributes":{"config_id":n,"picker_type":"otconws_customcolumn"}});return s.ensureFetched().then(function(){return e.Deferred().resolve(s.get("object_id")).promise()},function(){return e.Deferred().resolve().promise()})}return e.Deferred().resolve().promise()},"mapNodeIdToFieldValue":function(t){var i=this;if(t){var o=this.options.context.getModel(l,{"attributes":{"object_id":t,"picker_type":"otconws_customcolumn"}}),n=e.Deferred();return o.ensureFetched().then(function(){n.resolve("{"+o.get("config_id")+"}").then(function(){i.node&&i.node.get("parent_id")&&(i.lastColumnNode.clear({"silent":!0}),i.lastColumnNode.set(i.node.attributes,{"silent":!0}))})},function(){n.resolve()}),n.promise()}return e.Deferred().resolve().promise()},"_getNodePicker":function(){var t=!!this.model.get("data"),i=!t&&this.lastColumnNode?this.lastColumnNode.get("parent_id"):void 0;return e.extend(!0,this.model.get("options"),{"type_control":{"parameters":{"parent":i,"startLocation":t||i?"csui/dialogs/node.picker/start.locations/current.location":"conws/dialogs/node.picker/start.locations/facets.volume","startLocations":["csui/dialogs/node.picker/start.locations/current.location","conws/dialogs/node.picker/start.locations/facets.volume"]}}}),s.prototype._getNodePicker.apply(this,arguments)}})}),csui.define("conws/controls/form/fields/alpaca/alpcustomcolumnpickerfield",["csui/lib/underscore","csui/lib/jquery","csui/lib/alpaca/js/alpaca.lite","csui/controls/form/fields/alpaca/alpcsuipickerfield.mixin","conws/controls/form/fields/customcolumnpickerfield.view","i18n!conws/controls/form/impl/nls/lang"],function(e,t,i,o,n,s){var l=o.mixin({"constructor":function(t,i,o,l,a,r,c){o=e.extend(o||{},{"placeholder":s.alpacaPlaceholderOTCustomColumnPicker,"alpacaFieldType":"otconws_customcolumn","PickerFieldView":n}),this.base(t,i,o,l,a,r,c),this.makeAlpCsuiPickerField(t,i,o,l,a,r,c)}});return i.Fields.ConwsCustColPickerField=i.Fields.TextField.extend(l),i.registerFieldClass("otconws_customcolumn",i.Fields.ConwsCustColPickerField,"bootstrap-csui"),i.registerFieldClass("otconws_customcolumn",i.Fields.ConwsCustColPickerField,"bootstrap-edit-horizontal"),t.alpaca.Fields.ConwsCustColPickerField}),csui.define("conws/models/workspacetypes/workspacetype.factory",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","conws/models/workspacetypes/workspacetype.model","csui/utils/commands"],function(e,t,i,o,n,s,l,a){"use strict";return n.extend({"propertyPrefix":"workspacetype","constructor":function(e,t){n.prototype.constructor.apply(this,arguments);var o=e.getObject(s,t);this.context=e,t=i.extend(t||{},{"connector":o,"context":e}),this.property=new l(t&&t.attributes,t)}})}),csui.define("css!conws/controls/typeaheadpicker/impl/typeaheadpicker",[],function(){}),csui.define("conws/controls/form/fields/alpaca/alpworkspacetypefield",["csui/lib/underscore","csui/lib/jquery","csui/lib/alpaca/js/alpaca.lite","csui/controls/form/fields/alpaca/alptypeaheadfield.mixin","csui/utils/contexts/factories/connector","conws/models/workspacetypes/workspacetypes.model","conws/models/workspacetypes/workspacetype.factory","csui/controls/form/fields/typeaheadfield.view","i18n!conws/controls/form/impl/nls/lang","css!conws/controls/typeaheadpicker/impl/typeaheadpicker"],function(e,t,i,o,n,s,l,a,r){var c=o.mixin({"constructor":function(e,i,o,a,c,d,u){o=t.extend(!0,o||{},{"alpacaFieldType":"otconws_workspacetype_id","css":{"customImage":"wksp-type-custom-image","defaultIcon":"csui-icon csui-nodesprites"},"lang":{"alpacaPlaceholder":r.alpacaPlaceholderOTWorkspaceTypePicker},"pickerOptions":{"collection":new s(void 0,{"connector":d.config.context.getObject(n)}),"css":{},"titleSearchIcon":r.titleWorkspaceTypeSearchIcon,"itemOptions":{"css":{"customImage":"csui-icon wksp-type-custom-image","defaultIcon":"csui-icon csui-nodesprites"}},"showAllOnClickIcon":!0,"typeaheadOptions":{"minLength":0}}}),o.ItemModelFactory=l,this.base(e,i,o,a,c,d,u),this.makeAlpTypeaheadField()}});return i.Fields.ConwsWorkspaceTypeField=i.Fields.TextField.extend(c),i.registerFieldClass("otconws_workspacetype_id",i.Fields.ConwsWorkspaceTypeField,"bootstrap-csui"),i.registerFieldClass("otconws_workspacetype_id",i.Fields.ConwsWorkspaceTypeField,"bootstrap-edit-horizontal"),t.alpaca.Fields.ConwsWorkspaceTypeField}),csui.define("conws/controls/form/impl/fields/workspacefield/lqlsearch.util",[],function(){"use strict";function e(e,t,i,o){return o&&(t=t.replace(o,"")),t=t.replace(/[\\\]]/g,"\\$&"),i&&(t+=i),e?"["+t+"]":"[^"+t+"]"}function t(e){if(a.exec(e))throw new Error("middle phrase contains delimiters.");return e}function i(e){return e.replace(new RegExp(f,"g"),"\\$&").replace(/\*$/,"$& ")}function o(e){return e.replace(/[*?\s]+/g," ").replace(new RegExp(g,"g"),"\\$&")}function n(e,n,s){var l={};if(n&&s)if(a.exec(e)){var r=e.replace(d,"");r&&(0===r.replace(a,"").length?r="":a.exec(r[r.length-1])||(r+=" "),l.left=i(r));var u=e.replace(c,"");u&&(0===u.replace(a,"").length?u="":a.exec(u[0])||(u+=" "),l.right=i(u))}else l.middle=t(e);else if(n&&!s)l.left=i(e);else if(!n&&s)l.right=i(e);else{var p=e.replace(a,"").replace(a,"");a.exec(p)?l.right=l.left=i(e):l.words=o(e).replace(/^\s+$/,"")}return l}var s="\"\u201c\u201d'\u2018\u2019\xb4`.*+?^${}()|[]\\\xb0!\xb2\xa7\xb3%&/=@\u20ac~#><\xb5;,:-",l=e(!0,s,"\\s"),a=new RegExp(l+"+"),r=e(!1,s,"\\s"),c=new RegExp("^"+r+"+"),d=new RegExp(r+"+$"),u=e(!1,s,"\\s"),p=e(!1,s,"\\s",/</g),m=new RegExp("^"+u),h=new RegExp(p+"$"),g=(e(!0,".*+?^${}()|[]\\"),e(!0,"\"\u201c\u201d'\u2018\u2019\xb4`")),f=e(!0,".*+?^${}()|[]\\\"\u201c\u201d'\u2018\u2019\xb4`");return{"makePhrasesForContainsSearch":function(e){return n(e,m.exec(e||""),h.exec(e||""))},"makePhrasesForStartsWithSearch":function(e){var t=m.exec(e||""),i=h.exec(e||"");return e=t?" "+e:e,n(e,!1,i)},"makeLQLFromPhrases":function(e,t){var i=[];return t.middle&&i.push(e+" *"+t.middle+"*"),t.words&&i.push(e+' "'+t.words+'"'),t.left&&i.push(e+' QLLEFT-TRUNCATION "'+t.left+'"'),t.right&&i.push(e+' QLRIGHT-TRUNCATION "'+t.right+'"'),i.join(" & ")},"getSignificanceForPhrases":function(e){var t=0;return e&&(e.words&&(t+=e.words.trim().replace(/\s+/g," ").length+2),e.middle&&(t+=e.middle.length),e.left&&(t+=e.left.trim().replace(/\s+/g," ").length+1),e.right&&(t+=e.right.trim().replace(/\s+/g," ").length+1)),t}}}),csui.define("conws/controls/form/fields/workspacefield.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/utils/log","csui/utils/contexts/factories/connector","csui/models/widget/search.results/search.results.model","csui/controls/form/fields/base/csformfield.view","csui/controls/form/fields/typeaheadfield.view.mixin","conws/controls/form/impl/fields/workspacefield/lqlsearch.util","conws/utils/workspaces/workspace.model","i18n!conws/controls/form/impl/nls/lang","css!conws/controls/typeaheadpicker/impl/typeaheadpicker"],function(e,t,i,o,n,s,l,a,r,c,d,u){function p(e,t){e.options.query.listenTo(e,"filter:change",function(){var i,o,n,s=t.model&&t.model.get("options"),l=s&&s.type_control&&s.type_control.parameters,a=l&&l.workspace_types,r=e.filters&&e.filters.name;if(i=a&&a.length>0?'[QLREGION "XECMWkspLinkRefTypeID"] IN ('+a.toString()+")":'[QLREGION "OTSubType"] 848',r){var d=l&&l.search_type||"contains";if("contains"===d)o=c.makePhrasesForContainsSearch(r);else{if("startsWith"!==d)throw new Error("workspacefield ("+t.dataId+"): invalid search_type '"+d+"'");o=c.makePhrasesForStartsWithSearch(r)}o&&(n=c.makeLQLFromPhrases('[QLREGION "OTName"]',o)),i=n?i+" AND "+n:i}i+=' AND [QLREGION "XECMWkspDocTemplateID"] > 0';var u=c.getSignificanceForPhrases(o);m.debug("WkspField search {0}, {1}, '{2}'",u,h,i)&&console.log(m.last),e.options.query.set({"queryable":u>=h,"where":i})})}var m=new n(e.id),h=3,g=l.extend({"model":d,"constructor":function(e,t){i.extend(t,{"skip":0,"top":t.top,"orderBy":"OTName asc","query":new o.Model({"select":["OTName","OTSubType"]})}),l.prototype.constructor.apply(this,arguments)},"fetch":function(){return this.options&&this.options.query&&this.options.query.get("queryable")?l.prototype.fetch.apply(this,arguments):(this.reset(),i.Deferred().reject().promise())}}),f=a.extend({"constructor":function(e){var t=e.model&&e.model.get("options"),o=t&&t.type_control&&t.type_control.parameters,n=o&&o.page_size||7,l=new g(void 0,{"connector":e.context.getObject(s),"top":n});p(l,e),e=i.extend(!0,e,{"css":{"customImage":"wksp-type-custom-image","defaultIcon":"csui-icon csui-nodesprites"},"lang":{"alpacaPlaceholder":u.alpacaPlaceholderOTWorkspacePicker},"pickerOptions":{"collection":l,"titleSearchIcon":u.titleWorkspaceSearchIcon,"itemOptions":{"css":{"customImage":"csui-icon wksp-type-custom-image","defaultIcon":"csui-icon csui-nodesprites"}},"enableInfiniteScrolling":!0,"fetchMoreItemsThreshold":85,"showAllOnClickIcon":!1,"items":n,"typeaheadOptions":{"minLength":h}}}),a.apply(this,arguments),this.makeTypeaheadFieldView(e)}});return r.mixin(f.prototype),f}),csui.define("conws/controls/form/fields/alpaca/alpworkspacefield",["module","csui/lib/underscore","csui/lib/jquery","csui/utils/log","csui/lib/alpaca/js/alpaca.lite","csui/controls/form/fields/alpaca/alptypeaheadfield.mixin","csui/utils/contexts/factories/factory","csui/utils/contexts/factories/connector","csui/utils/commands","csui/utils/defaultactionitems","conws/utils/workspaces/workspace.model","conws/controls/form/fields/workspacefield.view"],function(e,t,i,o,n,s,l,a,r,c,d,u){"use strict";var p=(new o(e.id),l.extend({"propertyPrefix":"wkspFieldNode","constructor":function(e,i){l.prototype.constructor.apply(this,arguments);var o=this.options.wkspFieldNode||{},n=this.context.getObject(a,i),s=new d(o.attributes,t.extend({"connector":n,"autofetch":!0,"commands":c.getAllCommandSignatures(r)},o.options));this.property=s}})),m=s.mixin({"constructor":function(e,t,o,n,s,l,a){o=i.extend(!0,o||{},{"alpacaFieldType":"otconws_workspace_id"}),o.ItemModelFactory=p,o.TypeaheadFieldView=u,this.base(e,t,o,n,s,l,a),this.makeAlpTypeaheadField()}});return n.Fields.ConwsWorkspaceField=n.Fields.TextField.extend(m),n.registerFieldClass("otconws_workspace_id",n.Fields.ConwsWorkspaceField,"bootstrap-csui"),n.registerFieldClass("otconws_workspace_id",n.Fields.ConwsWorkspaceField,"bootstrap-edit-horizontal"),i.alpaca.Fields.ConwsWorkspaceField}),csui.define("hbs!conws/controls/description/impl/description",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <span class="description '+e.escapeExpression((l=null!=(l=a(i,"truncate_fade_class")||(null!=t?a(t,"truncate_fade_class"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"truncate_fade_class","hash":{},"loc":{"start":{"line":2,"column":27},"end":{"line":2,"column":50}}}):l))+'"\r\n        title="'+e.escapeExpression((l=null!=(l=a(i,"complete_description")||(null!=t?a(t,"complete_description"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"complete_description","hash":{},"loc":{"start":{"line":3,"column":15},"end":{"line":3,"column":39}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"current_description")||(null!=t?a(t,"current_description"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"current_description","hash":{},"loc":{"start":{"line":3,"column":41},"end":{"line":3,"column":64}}}):l))+"</span>\r\n"+(null!=(s=a(i,"unless").call(null!=t?t:e.nullContext||{},null!=t?a(t,"show_expandedView"):t,{"name":"unless","hash":{},"fn":e.program(2,n,0),"inverse":e.noop,"loc":{"start":{"line":4,"column":2},"end":{"line":11,"column":13}}}))?s:"")},"2":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="description-caret-div">\r\n    <span class="description-readmore icon-expandArrowDownWhite" role="button" aria-expanded="false" title="'+e.escapeExpression((s=null!=(s=l(i,"showmore_tooltip")||(null!=t?l(t,"showmore_tooltip"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"showmore_tooltip","hash":{},"loc":{"start":{"line":6,"column":108},"end":{"line":6,"column":128}}}):s))+'"\r\n          aria-label="'+e.escapeExpression((s=null!=(s=l(i,"showmore_aria")||(null!=t?l(t,"showmore_aria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"showmore_aria","hash":{},"loc":{"start":{"line":7,"column":22},"end":{"line":7,"column":39}}}):s))+'" tabindex="0"></span>\r\n    <span class="description-showless icon-expandArrowUpWhite" role="button" aria-expanded="true" title="'+e.escapeExpression((s=null!=(s=l(i,"showless_tooltip")||(null!=t?l(t,"showless_tooltip"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"showless_tooltip","hash":{},"loc":{"start":{"line":8,"column":105},"end":{"line":8,"column":125}}}):s))+'"\r\n          aria-label="'+e.escapeExpression((s=null!=(s=l(i,"showless_aria")||(null!=t?l(t,"showless_aria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"showless_aria","hash":{},"loc":{"start":{"line":9,"column":22},"end":{"line":9,"column":39}}}):s))+'" tabindex="0"></span>\r\n  </div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"current_description"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":0},"end":{"line":12,"column":7}}}))?s:""}});return i.registerPartial("conws_controls_description_impl_description",o),o}),csui.define("conws/controls/description/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/controls/description/impl/nls/root/lang",{"showmore":"Show more","showmoreAria":"Show more description","showless":"Show less","showlessAria":"Show less description"}),csui.define("css!conws/controls/description/impl/description",[],function(){}),csui.define("conws/controls/description/description.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","hbs!conws/controls/description/impl/description","i18n!conws/controls/description/impl/nls/lang","css!conws/controls/description/impl/description"],function(e,t,i,o,n,s,l,a){var r=0;return i.ItemView.extend({"className":"conws-description","template":l,"initialize":function(){this.shortDescMode=!0,this.has_more_desc=!1,this.hideShowLess=!1,this.collapsedHeightIsOneLine=!1},"templateHelpers":function(){return{"complete_description":this.options.complete_desc,"current_description":this.options.complete_desc,"more_description":this.has_more_desc&&!this.hideShowLess,"showmore_tooltip":a.showmore,"showmore_aria":a.showmoreAria,"showless_tooltip":a.showless,"showless_aria":a.showlessAria,"show_expandedView":this.expandDescription}},"ui":{"description":".description","readMore":".description-readmore","showLess":".description-showless","caretDiv":".description-caret-div"},"events":{"keydown @ui.readMore":"readMoreClicked","keydown @ui.showLess":"showLessClicked","click @ui.readMore":"readMoreClicked","click @ui.showLess":"showLessClicked"},"behaviors":{"TabableRegion":{"behaviorClass":n},"PerfectScrolling":{"behaviorClass":s,"contentParent":".description","suppressScrollX":!0,"scrollYMarginOffset":15}},"constructor":function(e){this.options=e||{},this.expandDescription=void 0===e.expandDescription||e.expandDescription,i.ItemView.prototype.constructor.apply(this,arguments),this.hideShowLess=!1,this.listenTo(this,"dom:refresh",this._truncateIfNecessary),this.listenTo(this.options.view,"dom:refresh",function(){this.triggerMethod("dom:refresh")})},"currentlyFocusedElement":function(){return this.has_more_desc?this.shortDescMode?this.ui.readMore:this.ui.showLess:t()},"onDestroy":function(){r=0,this.renderTimer&&clearTimeout(this.renderTimer)},"_setTimer":function(){this.renderTimer&&clearTimeout(this.renderTimer),this.renderTimer=setTimeout(e.bind(function(){this._truncateIfNecessary()},this),200)},"onRender":function(){this._setTimer()},"_updateDescriptionAndCaret":function(){this._enableCaretState(),this.shortDescMode&&this.has_more_desc?this.$el.addClass("conws-description-collapsed"):this.$el.removeClass("conws-description-collapsed")},"_truncateIfNecessary":function(){if(this.ui.description&&"object"==typeof this.ui.description){var e,t=this.getActualHeight();t&&0!==t&&(r<t&&(r=t),this.$el.removeClass("description-height-threeline description-height-twoline"),!0===this.expandDescription?(this.$el.addClass("description-expanded-view"),e=this.getMaxHeight(),r===e?this.$el.addClass("description-height-oneline"):r>2*e?this.$el.addClass("description-height-threeline"):this.$el.addClass("description-height-twoline")):(this.$el.removeClass("description-expanded-view"),e=this.getMaxHeight(),t>e&&(this.has_more_desc=!0),this._enableCaretState(),this.$el.addClass("description-height-oneline")))}},"getActualHeight":function(){return this.ui.description.height()},"getMaxHeight":function(){return parseFloat(this.ui.description.css("line-height"))},"readMoreClicked":function(e){if(e&&(13===e.keyCode||32===e.keyCode||"click"===e.type)){e.preventDefault(),e.stopPropagation(),this.shortDescMode=!1,this._truncateIfNecessary(),this.$el.removeClass("description-height-oneline");var t=this.getMaxHeight();r>2*t?this.$el.addClass("description-height-threeline"):this.$el.addClass("description-height-twoline"),r>2*t?this.ui.caretDiv.addClass("description-height-threeline"):this.ui.caretDiv.addClass("description-height-twoline"),this.ui.showLess.focus(),this.trigger("show:more:description")}},"showLessClicked":function(e){!e||13!==e.keyCode&&32!==e.keyCode&&"click"!==e.type||(e.preventDefault(),e.stopPropagation(),this.$el.find(".description").scrollTop(0),this.shortDescMode=!0,this._truncateIfNecessary(),this.$el.removeClass("description-height-threeline description-height-twoline"),this.ui.caretDiv.removeClass("description-height-threeline description-height-twoline"),this.ui.readMore.focus(),this.trigger("show:less:description"))},"_enableCaretState":function(){this.has_more_desc?(this.ui.readMore.toggleClass("caret-hide",!this.shortDescMode),this.ui.showLess.toggleClass("caret-hide",!!this.shortDescMode)):(this.ui.readMore.addClass("caret-hide"),this.ui.showLess.addClass("caret-hide"))}})}),csui.define("hbs!conws/controls/lazyactions/impl/lazy.loading.template",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){return'<li role="menuitem" class="csui-loading-parent-wrapper binf-disabled csui-disbaled">\r\n  <span class="csui-loading-dots-wrapper">\r\n    <span class="csui-loading-dot"></span>\r\n    <span class="csui-loading-dot"></span>\r\n    <span class="csui-loading-dot"></span>\r\n  </span>\r\n</li>'}});return i.registerPartial("conws_controls_lazyactions_impl_lazy.loading.template",o),o}),csui.define("conws/controls/lazyactions/lazyToolbar.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/models/nodes","csui/controls/toolbar/toolitems.filtered.model","csui/utils/commands","csui/controls/toolbar/delayed.toolbar.view","csui/controls/toolbar/toolbar.command.controller","hbs!conws/controls/lazyactions/impl/lazy.loading.template"],function(e,t,i,o,n,s,l,a,r,c){"use strict";return a.extend({"constructor":function(e){e=e||{};var t=e.node;if(!e.nodes){var i=new n(t);i.connector=t.connector,e.nodes=i}this.connector=e.connector||e.nodes.connector||t.connector,e.status||(e.status={"context":e.context,"nodes":e.nodes,"container":e.container,"originatingView":e.originatingView}),this.status=e.status,this.commandController=e.commandController||new r({"commands":e.commands||l}),e.collection||(e.collection=new s(e.toolbarItems,{"status":this.status,"commands":this.commandController.commands,"delayedActions":t.delayedActions,"mask":e.toolbarItemsMask})),this.collection=e.collection,a.prototype.constructor.apply(this,arguments),this.listenTo(this,"delayed:toolbar:refresh",this._refreshLazyToolbar),this.listenTo(this,"childview:toolitem:action",this._toolbarItemClicked)},"events":{"show.binf.dropdown":"onBeforeShowDropDown"},"onBeforeShowDropDown":function(e){var i,s,l,a=[];this.lazyActionsRetrieved||(this.$el.find(".csui-more-dropdown-menu").append(c),i=this.status.nodes instanceof n?this.status.nodes:this.status.nodes instanceof o.Collection?new n(this.status.nodes.models):t.isArray(this.status.nodes)?new n(this.status.nodes):new n,i.connector||(i.connector=this.connector),i.each(function(e){s=s&&e.get("csuiLazyActionsRetrieved"),l=l&&e.isLocallyCreated,a=a.length?a:e.nonPromotedActionCommands}),i.nonPromotedActionCommands=a,i.lazyActionsRetrieved=s,s||l||!a.length||(i.lazyActionsRetrieved=this.lazyActionsRetrieved,this._renderLazyActions(i)),this.lazyActionsRetrieved=!0)},"_onDomRefresh":function(){},"_refreshLazyToolbar":function(){a.prototype._onDomRefresh.call(this)},"_toolbarItemClicked":function(e,t){this.commandController.toolitemClicked(t.toolItem,this.options)}})}),csui.define("conws/controls/selectedmetadataform/selectedmetadataform.view",["csui/lib/underscore","csui/lib/jquery","csui/utils/base","csui/utils/url","csui/controls/form/form.view","csui/controls/globalmessage/globalmessage"],function(e,t,i,o,n,s){function l(e,i){for(var o;i.length;){if(t(i).is(e))return o?">"+o:"";var n=i[0],s=n.localName;if(!s)break;s=s.toLowerCase();var l=i.parent();s+=":nth-child("+(l.children().index(n)+1)+")",o=s+(o?">"+o:""),i=l}return e?void 0:o}function a(e){var t,i=e.$el.find(":focus");if(i.length){for(var o=i;o&&o.length&&!o.attr("data-alpaca-field-id");)o=o.parent();o.length&&(t=l(e.$el,o))}return{"focused":i,"focusPath":t,"scrolltop":e.$el.parent().parent().scrollTop()}}function r(e,t){(t.scrolltop>=0&&e.$el.parent().parent().scrollTop(t.scrolltop),!e.$el.find(":focus").is(t.focused)&&t.focusPath)&&e.$el.find(t.focusPath).find(".alpaca-control .cs-field-read button").trigger("click")}function c(e,t){this.count=e,this.fct=t,this.callback=function(){this.count>0&&(this.count=this.count-1,0===this.count&&this.fct.call())}}function d(t,i){var o=new c(t,function(){setTimeout(i,0)});return e.bind(o.callback,o)}function u(t,i){var o;if(t.children&&t.children.length&&i&&i.length)if(i.length>t.children.length)for(o=t.children.length;o<i.length;o++){var n=i[o],s=e.extend({},t.children[0].options),l=e.extend({},t.children[0].schema);t.addItem(o,l,s,n,function(){})}else if(i.length<t.children.length)for(o=t.children.length-1;o>=i.length;o--)t.removeItem(o,function(){})}function p(e,t,i,o){
for(var n=[],s=0;s<e.length;s++){var l=e[s];l.propertyId&&t.hasOwnProperty(l.propertyId)&&i.hasOwnProperty(l.propertyId)?(o?l.path===i:l.path!==i[l.propertyId])&&n.push(l):l.children&&(n=n.concat(p(l.children,t,i,o)))}return n}function m(e,t,i,o,n){var s=p(e.form.children,i,o,n);if(s.length){var l=d(s.length,function(){r(e,t)});s.forEach(function(e){u(e,i[e.propertyId]),e.setValue(i[e.propertyId]),e.refresh(l)})}}return n.extend({"constructor":function(e){n.prototype.constructor.call(this,e),this.node=this.options.node,this.listenTo(this,"change:field",function(e){this._saveField(e)})},"_saveField":function(e){if(this._hasDependentFields(e)){var t={},i=this._getTopMostTKLParentField(e.fieldView);this._getDependencyFields(i,t),this._saveChanges(t,e.value)}else{var o=this.form.getControlByPath("/"===e.path[0]?e.path.substring(1):e.path);this._saveChanges(o.propertyId,e.value,o.path,!0)}},"_hasDependentFields":function(arguments){var e;return e=arguments.fieldView&&arguments.fieldView.type&&"array"===arguments.fieldView.type?arguments.fieldView.children[0]:arguments,void 0!==e.fieldView&&(void 0!==e.fieldView.isTKLField&&(!!e.fieldView.isTKLField&&!!(e.fieldView.children&&e.fieldView.children.length>0||e.fieldView.parentViews&&e.fieldView.parentViews.length>0)))},"_getDependencyFields":function(e,t){var i,o,n;if(e.type&&"array"===e.type?(i=e.children&&e.children[0].fieldView,o=e.propertyId,n=e.path):e.alpacaField&&(i=e,o=e.alpacaField.propertyId,n=e.alpacaField.path),i&&i.alpacaField&&o&&!t.hasOwnProperty(o)&&(t[o]=n,i.children&&i.children.length>0))for(var s=0;s<i.children.length;s++)this._getDependencyFields(i.children[s],t)},"_getTopMostTKLParentField":function(e){var t;if(e.type&&"array"===e.type?t=e.children&&e.children[0].fieldView:e.alpacaField&&(t=e),!(t&&t.parentViews&&t.parentViews.length>0))return e;for(var i=0;i<t.parentViews.length;i++)return this._getTopMostTKLParentField(t.parentViews[i])},"_saveChanges":function(n,l,r,c){var d,u,p,h,g,f={},w={},v={},b={},y=this.getValues(),k=this.metadataview&&this.metadataview.formViewList;if(k&&k.length>0)for(var x=0;x<k.length;x++)d=k[x],y=Object.assign(y,d.getValues());if("object"==typeof n?b=n:b[n]=r,e.each(b,function(t,i){u=y,g=i,r=t,p="/"===r[0]?r.substring(1):r,h=p.split("/");for(var o=0;o<h.length-1;o++)u&&(u=u[h[o]]);if(u&&e.each(u,function(e,t){var i=t.substring(0,g.length),o=t.substring(g.length+1);(t===g||i&&o&&g===i&&!isNaN(o))&&(f[t]=e,w[t]=e,v[t]=r)},w),0===Object.keys(w).length&&g&&(f[g]=l,w[g]=l),g.search("x")>0){var n,s={};s[g]=w[g],delete w[g],delete f[g],n=g.substring(0,g.indexOf("x")-1),w[n]=[s],f[n]=[s]}}),!this.node)throw new Error("Missing node to save the categories to.");if(this._validate(f)){var C=a(this);return this._blockActions(),this.node.connector.makeAjaxCall(this.node.connector.extendAjaxOptions({"type":"PUT","url":o.combine(this.node.urlBase(),"categories",g.split("_")[0]),"data":w,"async":c})).done(e.bind(function(){this.model.updateData(f),m(this,C,f,v,!1),this.trigger("forms:sync");var e=t.Event("tab:content:field:changed");this.$el.trigger(e)},this)).fail(e.bind(function(e){var t=this.model.restoreData(f);m(this,C,t,v,!0);var o=new i.Error(e);s.showMessage("error",o.message),this.trigger("forms:error")},this)).always(e.bind(function(){this._unblockActions()},this))}return t.Deferred().reject().promise()}})}),csui.define("conws/utils/commands/permissions/permissions.util",["csui/utils/url"],function(e){"use strict";return{"getUrl":function(t){var i=t.nodeId,o=t.connector.getConnectionUrl().getApiBase("v2");if(o=e.combine(o,"businessworkspaces",i,"roles"),t.action){var n;if("delete"===t.action||"editperms"===t.action)n=t.get("right_id"),o=e.combine(o,n);else if("fetch"===t.action||"update"===t.action){n=t.get("right_id");var s=e.combineQueryString({"fields":"members"});o=e.combine(o,n),o=o+"?"+s}}return o},"isWorkspaceRole":function(e){var t=e.get("right_id_expand");return t?!!t.type&&848===t.type:!!e.get("type")&&848===e.get("type")},"isLeaderRole":function(e,t){var i=this.isInheritedRole(e,t),o=t.get("right_id_expand");return o?!i&&!!o.id&&!!o.leader_id&&o.id===o.leader_id:!i&&!!t.get("id")&&!!t.get("leader_id")&&t.get("id")===t.get("leader_id")},"isInheritedRole":function(e,t){var i=t.get("right_id_expand");return i?!!i.node_id&&!!e&&!!e.get("id")&&i.node_id!==e.get("id"):!!t.get("node_id")&&!!e&&!!e.get("id")&&t.get("node_id")!==e.get("id")},"isWorkspace":function(e){return!!e&&!!e.get("type")&&848===e.get("type")}}}),csui.define("hbs!conws/controls/table/cells/role/impl/role",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){return" binf-disabled"},"3":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"unless").call(null!=t?t:e.nullContext||{},null!=t?l(t,"addOwnerOrGroup"):t,{"name":"unless","hash":{},"fn":e.program(4,n,0),"inverse":e.noop,"loc":{"start":{"line":11,"column":2},"end":{"line":13,"column":13}}}))?s:""},"4":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="'+e.escapeExpression((s=null!=(s=l(i,"inlineToolBarPlaceholderClass")||(null!=t?l(t,"inlineToolBarPlaceholderClass"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"inlineToolBarPlaceholderClass","hash":{},"loc":{"start":{"line":12,"column":14},"end":{"line":12,"column":47}}}):s))+' binf-hidden"></div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="csui-user-container">\r\n  <div class="csui-profileimg binf-pull-left">\r\n    <span class="csui-icon-paceholder csui-icon conws-mime_roles" title="'+e.escapeExpression((l=null!=(l=a(i,"roleAccessTitle")||(null!=t?a(t,"roleAccessTitle"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"roleAccessTitle","hash":{},"loc":{"start":{"line":3,"column":73},"end":{"line":3,"column":92}}}):l))+'" aria-label="'+e.escapeExpression((l=null!=(l=a(i,"roleAria")||(null!=t?a(t,"roleAria"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"roleAria","hash":{},"loc":{"start":{"line":3,"column":106},"end":{"line":3,"column":118}}}):l))+'"></span>\r\n  </div>\r\n  <div class="member-info csui-fadeout'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"disabled"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.noop,"loc":{"start":{"line":5,"column":38},"end":{"line":5,"column":75}}}))?s:"")+' ">\r\n    <div class="">\r\n      <span class="csui-user-display-name csui-role" title="'+e.escapeExpression((l=null!=(l=a(i,"name")||(null!=t?a(t,"name"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":7,"column":60},"end":{"line":7,"column":68}}}):l))+'"  aria-label="'+e.escapeExpression((l=null!=(l=a(i,"roleAria")||(null!=t?a(t,"roleAria"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"roleAria","hash":{},"loc":{"start":{"line":7,"column":83},"end":{"line":7,"column":95}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"name")||(null!=t?a(t,"name"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":7,"column":97},"end":{"line":7,"column":105}}}):l))+"</span>\r\n    </div>\r\n  </div>\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"includeInlineToolBarPlaceholder"):t,{"name":"if","hash":{},"fn":e.program(3,n,0),"inverse":e.noop,"loc":{"start":{"line":10,"column":2},"end":{"line":14,"column":9}}}))?s:"")+"</div>"}});return i.registerPartial("conws_controls_table_cells_role_impl_role",o),o}),csui.define("conws/controls/table/cells/role/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/controls/table/cells/role/impl/nls/root/lang",{"roleAria":"Role {0}","roleAccessTitle":"Role access"}),csui.define("css!conws/controls/table/cells/role/impl/role",[],function(){}),csui.define("conws/controls/table/cells/role/role.view",["csui/lib/underscore","csui/controls/table/cells/user/user.view","csui/controls/table/cells/cell.registry","csui/models/member","conws/utils/commands/permissions/permissions.util","hbs!conws/controls/table/cells/role/impl/role","i18n!conws/controls/table/cells/role/impl/nls/lang","css!conws/controls/table/cells/role/impl/role"],function(e,t,i,o,n,s,l){var a=t.extend({"renderValue":function(){var e=this.getValueData(),t=this.getTemplate(),i=e?t(e):"";this.$el.html(i)},"getTemplate":function(){return this.isWorkspaceRole&&this.isWorkspaceRole?s:this.template},"getValueData":function(){return e.extend(a.__super__.getValueData.apply(this,arguments),{"isWorkspaceRole":this.isWorkspaceRole,"roleAria":e.str.sformat(l.roleAria,this.getDisplayName()),"roleAccessTitle":l.roleAccessTitle})},"constructor":function e(t){if(e.__super__.constructor.apply(this,arguments),this.model&&this.model.collection&&(this.isWorkspaceRole=n.isWorkspaceRole(this.model),this.model.collection.extraMemberModels||(this.model.collection.extraMemberModels=[]),this.isWorkspaceRole)){if(!this.model.collection.extraMemberModels.some(function(e){return e.get("id")===this.model.get("right_id_expand").id},this)){var i=new o(this.model.get("right_id_expand"));i.nodeModel=this.options.nodeModel,this.model.collection.extraMemberModels.push(i)}}}});return i.registerByColumnKey("right_id",a),a}),csui.define("conws/controls/table/cells/permission/role.permission.level.view",["csui/lib/jquery","csui/lib/underscore","csui/controls/table/cells/permission/permission.level.view","csui/utils/commands","csui/controls/table/cells/cell.registry","conws/utils/commands/permissions/permissions.util"],function(e,t,i,o,n,s){"use strict";var l=i.extend({"constructor":function t(i){t.__super__.constructor.apply(this,arguments),this.$=e},"onClickPermissionLevel":function(e){var t,i=s.isWorkspaceRole(this.options.model);[0,1,848].indexOf(this.options.model.get("right_id_expand")&&this.options.model.get("right_id_expand").type)<0&&"custom"===this.options.model.get("type")?this._handlePermissionLevelFocus({"cellView":this}):(t=i?o.get("EditRolePermission"):o.get("EditPermission"),this._handlePermissionLevelClicked({"cellView":this,"command":t}),this.trigger("cell:content:clicked",this))}});return n.registerByColumnKey("permissions",l),l}),csui.define("conws/controls/userpicker/nls/role.lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/controls/userpicker/nls/root/role.lang",{"roleViewGroupTitle":"Business Workspace Role","roleViewLeaderTitle":"Leader Role","inheritedrole":"Inherited Role"}),csui.define("hbs!conws/controls/userpicker/role",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="member-info'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"disabled"):t,{"name":"if","hash":{},"fn":e.program(2,n,0),"inverse":e.noop,"loc":{"start":{"line":2,"column":23},"end":{"line":2,"column":60}}}))?s:"")+' binf-pull-left">\r\n  <span class="name binf-pull-left" title="'+e.escapeExpression((l=null!=(l=a(i,"name")||(null!=t?a(t,"name"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":3,"column":43},"end":{"line":3,"column":51}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"name")||(null!=t?a(t,"name"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":3,"column":53},"end":{"line":3,"column":61}}}):l))+"</span>\r\n</div>\r\n"},"2":function(e,t,i,o,n){return" binf-disabled"},"4":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="member-picture'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"disabled"):t,{"name":"if","hash":{},"fn":e.program(2,n,0),"inverse":e.noop,"loc":{"start":{"line":6,"column":26},"end":{"line":6,"column":63}}}))?s:"")+' binf-pull-left">\r\n  <span class="csui-icon conws-mime_roles"></span>\r\n</div>\r\n<div class="member-info'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"disabled"):t,{"name":"if","hash":{},"fn":e.program(2,n,0),"inverse":e.noop,"loc":{"start":{"line":9,"column":23},"end":{"line":9,"column":60}}}))?s:"")+' binf-pull-left">\r\n  <span class="name binf-pull-left" title="'+e.escapeExpression((l=null!=(l=a(i,"name")||(null!=t?a(t,"name"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":10,"column":43},"end":{"line":10,"column":51}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"name")||(null!=t?a(t,"name"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":10,"column":53},"end":{"line":10,"column":61}}}):l))+'</span>\r\n  <span class="group-title binf-pull-left" title="'+e.escapeExpression((l=null!=(l=a(i,"role-title")||(null!=t?a(t,"role-title"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"role-title","hash":{},"loc":{"start":{"line":11,"column":50},"end":{"line":11,"column":64}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"role-title")||(null!=t?a(t,"role-title"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"role-title","hash":{},"loc":{"start":{"line":11,"column":66},"end":{"line":11,"column":80}}}):l))+"</span>\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"isWorkspace"):t,{"name":"if","hash":{},"fn":e.program(5,n,0),"inverse":e.noop,"loc":{"start":{"line":12,"column":2},"end":{"line":22,"column":9}}}))?s:"")+"</div>\r\n"},"5":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"leader"):t,{"name":"if","hash":{},"fn":e.program(6,n,0),"inverse":e.noop,"loc":{"start":{"line":13,"column":2},"end":{"line":15,"column":9}}}))?s:"")+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"isInheritedRole"):t,{"name":"if","hash":{},"fn":e.program(8,n,0),"inverse":e.noop,"loc":{"start":{"line":16,"column":2},"end":{"line":18,"column":9}}}))?s:"")+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"disabled"):t,{"name":"if","hash":{},"fn":e.program(10,n,0),"inverse":e.noop,"loc":{"start":{"line":19,"column":2},"end":{"line":21,"column":9}}}))?s:"")},"6":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <span class="leader-title binf-pull-left" title="'+e.escapeExpression((s=null!=(s=l(i,"leader-title")||(null!=t?l(t,"leader-title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"leader-title","hash":{},"loc":{"start":{"line":14,"column":51},"end":{"line":14,"column":67}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"leader-title")||(null!=t?l(t,"leader-title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"leader-title","hash":{},"loc":{"start":{"line":14,"column":69},"end":{"line":14,"column":85}}}):s))+"</span>\r\n"},"8":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <span class="leader-title binf-pull-left" title="'+e.escapeExpression((s=null!=(s=l(i,"isInheritedRole-title")||(null!=t?l(t,"isInheritedRole-title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"isInheritedRole-title","hash":{},"loc":{"start":{"line":17,"column":51},"end":{"line":17,"column":76}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"isInheritedRole-title")||(null!=t?l(t,"isInheritedRole-title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"isInheritedRole-title","hash":{},"loc":{"start":{"line":17,"column":78},"end":{"line":17,"column":103}}}):s))+"</span>\r\n"},"10":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <span class="message binf-pull-left">'+e.escapeExpression((s=null!=(s=l(i,"disabled-message")||(null!=t?l(t,"disabled-message"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"disabled-message","hash":{},"loc":{"start":{"line":20,"column":39},"end":{"line":20,"column":59}}}):s))+"</span>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"lightWeight"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.program(4,n,0),"loc":{"start":{"line":1,"column":0},"end":{"line":24,"column":7}}}))?s:""}});return i.registerPartial("conws_controls_userpicker_role",o),o}),csui.define("conws/controls/userpicker/role.view",["csui/utils/base","csui/controls/userpicker/roles/group.view","conws/utils/commands/permissions/permissions.util","i18n!conws/controls/userpicker/nls/role.lang","hbs!conws/controls/userpicker/role"],function(e,t,i,o,n){return t.extend({"template":n,"templateHelpers":function(){return{"name":e.formatMemberName(this.model),"role-title":o.roleViewGroupTitle,"isWorkspace":this.isWorkspace,"leader":this.isLeaderRole,"leader-title":o.roleViewLeaderTitle,"isInheritedRole":this.isInheritedRole,"isInheritedRole-title":o.inheritedrole,"disabled":this.model.get("disabled"),"disabled-message":this.options.disabledMessage,"lightWeight":!!this.options.lightWeight}},"constructor":function(e){t.prototype.constructor.call(this,e),this.model&&this.model.nodeModel&&(this.isWorkspace=i.isWorkspace(this.model.nodeModel),this.isWorkspaceRole=i.isWorkspaceRole(this.model),this.isLeaderRole=i.isLeaderRole(this.model.nodeModel,this.model),this.isInheritedRole=i.isInheritedRole(this.model.nodeModel,this.model))}})}),csui.define("conws/controls/userpicker/conws.roles",["conws/controls/userpicker/role.view"],function(e){"use strict";return[{"type":848,"viewClass":e}]}),csui.define("conws/dialogs/addoreditrole/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/dialogs/addoreditrole/impl/nls/root/lang",{"dialogTitle":"View role membership","missingConnector":"Missing connector information!","AddRole":"Add role","EditRole":"Edit role","doneButtonLabel":"Save","nextButtonLabel":"Next","cancelButtonLabel":"Cancel","RoleStepName":"Role","PermissionsStepName":"Permissions","ParticipantsStepName":"Participants","RoleName":"Role name","RoleNamePlaceholder":"Enter name","RoleDesc":"Role Description","RoleDescPlaceholder":"Add Description","TeamLead":"Team Lead","SubItemsInherit":"Apply to sub-items","backButtonTooltip":"Go back","backButtonAria":"Go back","selectPermissionLevel":"Select permission level","simplePermissionSelection":"Simple Permission Selection","rolePartcipantsWithNoparticipantsMessage":"No participants have been added.","participantsTitle":"Participants","addParticipantTitle":"Add Participant","roleParticipantsUserPickerPlaceholder":"Add participants","roleParticipantsDisabledMemberMessage":"Is already a participant.","roleParticipantsSearchAria":"Search for participants"}),csui.define("conws/controls/wizard/step/impl/footer.view",["csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/wizard/step/footer.view","i18n"],function(e,t,i,o){var n=e.ItemView.extend({"tagName":"button","className":"binf-btn","template":!1,"triggers":{"click":"click"},"behaviors":{"TabableRegion":{"behaviorClass":t}},"constructor":function(t){e.View.prototype.constructor.apply(this,arguments)},"isTabable":function(){return this.$el.is(":not(:disabled)")&&this.$el.is(":not(:hidden)")},"currentlyFocusedElement":function(){return-1===this.$el.prop("tabindex")&&this.$el.prop("tabindex",0),this.$el},"onRender":function(){var e=this.$el,t=this.model.attributes;void 0===t.isButton?(e.text(t.label),e.addClass("binf-btn"),e.addClass(t.default?"binf-btn-primary cs-add-button":"binf-btn-default"),t.toolTip&&e.attr("title",t.toolTip),t.separate&&e.addClass("cs-separate")):(e.addClass("arrow_back button_image"),t.toolTip&&e.attr({"title":t.toolTip,"aria-label":t.toolTip,"role":"link"}),"next"===t.id&&(o&&o.settings.rtl?e.addClass("button_image_next_rtl"):e.addClass("button_image_next"))),this.updateButton(t)},"updateButton":function(e){var t=this.$el;e||(e={}),void 0!==e.hidden&&(e.hidden?t.addClass("binf-hidden"):t.removeClass("binf-hidden")),void 0!==e.disabled&&t.prop("disabled",e.disabled)}});return i.extend({"childView":n,"constructor":function(e){i.prototype.constructor.apply(this,arguments)}})}),csui.define("conws/controls/wizard/step/wizard.step.view",["module","csui/lib/underscore","csui/lib/backbone","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/wizard/step/wizard.step.view","conws/controls/wizard/step/impl/footer.view","csui/utils/log","i18n!csui/controls/wizard/impl/nls/lang"],function(e,t,i,o,n,s,l,a){l=l(e.id);var r=n.extend({"constructor":function(){n.prototype.constructor.apply(this,arguments),this.listenTo(this,"set:initial:focus",this.setViewInitialFocus)},"setViewInitialFocus":function(){this.options.view.trigger("set:initial:focus")},"_renderFooter":function(){var e=this.footerView=this.options.footerView;if(e)this.ui.footer.removeClass("binf-hidden"),this.footer.show(e);else{var o=[];this.options.isFirstStep||o.push({"id":"previous","label":this.options.previousButtonLabel||a.back,"toolTip":this.options.previousButtonLabel||a.back,"default":!1,"disabled":!1,"isButton":!1,"separate":this.options.seperatePrevious||!1,"click":t.bind(this.onClickPreviousButton,this)});var n={"id":"next","label":this.options.nextButtonLabel||a.next,"toolTip":this.options.nextButtonLabel||a.next,"default":!0,"disabled":void 0===this.options.disableNext||this.options.disableNext,"separate":this.options.seperateNext||!1,"isButton":!1,"click":t.bind(this.onClickNextButton,this)},l={"id":"done","label":this.options.doneButtonLabel||a.done,"toolTip":this.options.doneButtonLabel||a.done,"default":!0,"disabled":void 0===this.options.disableDone||this.options.disableDone,"separate":this.options.seperateDone||!0,"click":t.bind(this.onClickDoneButton,this)};this.options.nextButton&&this.options.doneButton?(o.push(n),o.push(l)):this.options.nextButton?o.push(n):this.options.doneButton&&o.push(l),o.push({"id":"cancel","label":a.cancel,"toolTip":a.cancel,"separate":this.options.seperateCancel||!0,"close":!0});var r=this.options.buttons||o;r.length&&this.ui.footer.removeClass("binf-hidden"),e=this.footerView=new s({"collection":new i.Collection(r),"wizardView":this,"el":this.ui.footer[0]}),this.listenTo(e,"childview:click",this.onClickButton),e.render(),this.footer.attachView(e)}}});return t.extend(r.prototype,o),r}),csui.define("css!conws/controls/wizard/impl/wizard",[],function(){}),csui.define("conws/controls/wizard/wizard.view",["csui/lib/underscore","csui/controls/wizard/wizard.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","conws/controls/wizard/step/wizard.step.view","css!conws/controls/wizard/impl/wizard"],function(e,t,i,o){var n=t.extend({"constructor":function(e){e||(e={}),t.prototype.constructor.apply(this,arguments)},"getCurrentView":function(){if(this.currentStep<this.stepViews.length)return this.stepViews[this.currentStep];var t=this.currentStep,i=new o(e.extend(this.options.steps[t],{"wizard":this,"isFirstStep":this.isFirstStep(),"isLastStep":this.isLastStep()}));return this.stepViews.push(i),this.listenTo(i,"next:clicked",this.nextStep).listenTo(i,"previous:clicked",this.prevStep).listenTo(i,"done:clicked",this.save).listenTo(i,"close:wizard",this.closeWizard),i},"showCurrentView":function(){this.currentView.$el.removeClass("binf-hidden"),this.currentView.triggerMethod("set:initial:focus")}});return e.extend(n.prototype,i),n}),csui.define("conws/dialogs/addoreditrole/impl/tabbable.form.view",["csui/lib/jquery","csui/controls/form/form.view","csui/behaviors/keyboard.navigation/tabable.region.behavior"],function(e,t,i){return t.extend({"behaviors":{"TabablesBehavior":{"behaviorClass":i,"recursiveNavigation":!0,"containTabFocus":!0}},"events":{"keydown":"onKeyInView"},"isTabable":function(){return this.$("*[tabindex]").length>0},"currentlyFocusedElement":function(t){var i=!!this.$form&&this.$form.find(".alpaca-readonly button"),o=this.$("*[tabindex]:visible");return o.length&&(o.prop("tabindex",0),i.length&&i.attr("tabindex",-1)),this.tabableElements=o,e(o[0])},"onKeyInView":function(e){var t=this.tabableElements.length;if(t>0&&9===e.keyCode)if(e.shiftKey){var i=this.tabableElements.index(e.target),o=--i;o>=0&&this._setFocus(e,o)}else{var i=this.tabableElements.index(e.target),o=++i;o<t&&this._setFocus(e,o)}},"_setFocus":function(e,t){this.tabableElements.eq(t).focus(),e.stopPropagation(),e.preventDefault()}})}),csui.define("hbs!conws/dialogs/addoreditrole/impl/roleheader/impl/roleheader.view",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="dashed-border"></div>\r\n<div class="conws-addoreditrole-wizardstep-header">\r\n    <span class="conws-addoreditrole-wizardstep1">'+e.escapeExpression((s=null!=(s=l(i,"Step1")||(null!=t?l(t,"Step1"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"Step1","hash":{},"loc":{"start":{"line":3,"column":50},"end":{"line":3,"column":59}}}):s))+'</span>\r\n    <span class="conws-addoreditrole-wizardstep2">'+e.escapeExpression((s=null!=(s=l(i,"Step2")||(null!=t?l(t,"Step2"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"Step2","hash":{},"loc":{"start":{"line":4,"column":50},"end":{"line":4,"column":59}}}):s))+'</span>\r\n    <span class="conws-addoreditrole-wizardstep3">'+e.escapeExpression((s=null!=(s=l(i,"Step3")||(null!=t?l(t,"Step3"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"Step3","hash":{},"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":59}}}):s))+"</span>\r\n</div>"}});return i.registerPartial("conws_dialogs_addoreditrole_impl_roleheader_impl_roleheader.view",o),o}),csui.define("css!conws/dialogs/addoreditrole/impl/roleheader/impl/roleheader.view",[],function(){}),csui.define("conws/dialogs/addoreditrole/impl/roleheader/roleheader.view",["csui/lib/underscore","csui/lib/marionette","i18n!conws/dialogs/addoreditrole/impl/nls/lang","hbs!conws/dialogs/addoreditrole/impl/roleheader/impl/roleheader.view","css!conws/dialogs/addoreditrole/impl/roleheader/impl/roleheader.view"],function(e,t,i,o){return t.LayoutView.extend({"template":o,"regions":{"StepHeaderRegion":".conws-addoreditrole-wizardstep-header"},"templateHelpers":{"Step1":i.RoleStepName,"Step2":i.PermissionsStepName,"Step3":i.ParticipantsStepName},"constructor":function(i){i||(i={}),this.context=i.context,this.connector=i.connector,i.currentStep&&(this.listenTo(this,"render",this._updateClasses),e.bind(this._updateClasses,i)),t.LayoutView.prototype.constructor.apply(this,arguments)},"_updateClasses":function(e){switch(e.options.currentStep){case"step1":this.$el.find(".conws-addoreditrole-wizardstep1").addClass("conws-addoreditrole-wizardstep-header-active");break;case"step2":this.$el.find(".conws-addoreditrole-wizardstep2").addClass("conws-addoreditrole-wizardstep-header-active");break;case"step3":this.$el.find(".conws-addoreditrole-wizardstep3").addClass("conws-addoreditrole-wizardstep-header-active")}}})}),csui.define("hbs!conws/dialogs/addoreditrole/impl/roledetails/impl/roledetails",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){return'<div class="conws-addoreditrole-roledetails">\r\n    <div class="conws-addoreditrole-roledetails-header">\r\n    </div>\r\n    <div class="conws-addoreditrole-roledetails-body">\r\n        <div class="conws-addoreditrole-roledetails-left">\r\n        </div>\r\n        <div class="conws-addoreditrole-roledetails-right">\r\n        </div>\r\n    </div>\r\n</div>'}});return i.registerPartial("conws_dialogs_addoreditrole_impl_roledetails_impl_roledetails",o),o}),csui.define("css!conws/dialogs/addoreditrole/impl/roledetails/impl/roledetails",[],function(){}),csui.define("conws/dialogs/addoreditrole/impl/roledetails/roledetails.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/models/form","conws/dialogs/addoreditrole/impl/tabbable.form.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","conws/dialogs/addoreditrole/impl/roleheader/roleheader.view","csui/behaviors/keyboard.navigation/tabable.region.behavior","i18n!conws/dialogs/addoreditrole/impl/nls/lang","hbs!conws/dialogs/addoreditrole/impl/roledetails/impl/roledetails","css!conws/dialogs/addoreditrole/impl/roledetails/impl/roledetails"],function(e,t,i,o,n,s,l,a,r,c){var d=i.LayoutView.extend({"template":c,"regions":{"HeaderRegion":".conws-addoreditrole-roledetails-header","LeftRegion":".conws-addoreditrole-roledetails-left","RightRegion":".conws-addoreditrole-roledetails-right"},"templateHelpers":{},"triggers":{"keyup input":{"event":"required:field:changed","preventDefault":!1,"stopPropagation":!1}},"_createHeaderControl":function(){return new l({"headerViewoptions":this.options,"currentStep":"step1"})},"constructor":function(e){e||(e={}),this.context=e.context,this.connector=e.connector,i.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this,"set:initial:focus",this.onSetInitialFocus),this.propagateEventsToRegions()},"onRender":function(){var e={"data":{"role_name":this.options.addrole?"":this.options.name,"role_description":this.options.addrole?"":this.options.description},"options":{"fields":{"role_name":{"hidden":!1,"hideInitValidationError":!0,"label":r.RoleName,"placeholder":r.RoleNamePlaceholder,"readonly":!1,"type":"text"},"role_description":{"hidden":!1,"hideInitValidationError":!0,"label":r.RoleDesc,"placeholder":r.RoleDescPlaceholder,"readonly":!1,"type":"textarea"}},"label":""},"schema":{"properties":{"role_name":{"maxLength":42,"readonly":!1,"required":!0,"title":r.RoleName,"type":"string"},"role_description":{"readonly":!1,"required":!1,"title":r.RoleDesc,"type":"string","maxLength":450}},"type":"object"}},t=this.options.addrole?!!this.options.isFirstRole:this.options.team_lead,i={"data":{"team_lead":t},"options":{"fields":{"team_lead":{"hidden":!1,"hideInitValidationError":!0,"label":r.TeamLead,"readonly":!!t,"type":"checkbox"}},"label":""},"schema":{"properties":{"team_lead":{"readonly":!!t,"required":!1,"title":r.TeamLead,"type":"boolean"}},"type":"object"}},s=new n({"mode":"create","model":new o(e)}),l=new n({"mode":"create","model":new o(i)});this.HeaderRegion.show(this._createHeaderControl()),this.LeftRegion.show(s),this.RightRegion.show(l)},"onAfterShow":function(){this.onSetInitialFocus()},"onSetInitialFocus":function(){this.LeftRegion.currentView.$el.find("[data-alpaca-container-item-name='role_name'] input[type='text']").focus()}});return e.extend(d.prototype,s),d}),
csui.define("conws/dialogs/addoreditrole/impl/rolepermissions/impl/rolepermissions.title.view",["csui/lib/handlebars","csui/lib/marionette"],function(e,t){return TitleView=t.ItemView.extend({"template":e.compile("{{title}}"),"templateHelpers":function(){return{"title":this.model.get("title")}},"constructor":function(e){t.View.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change",this.render)}}),TitleView}),csui.define("hbs!conws/dialogs/addoreditrole/impl/rolepermissions/impl/rolepermissions",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){return'<div class="conws-addoreditrole-rolepermissions">\r\n    <div class="conws-addoreditrole-rolepermissions-header"></div>\r\n    <div class="conws-addoreditrole-rolepermissions-picker-header">\r\n        <div class="conws-addoreditrole-rolepermissions-left">\r\n            <div class="conws-addoreditrole-rolepermissions-back"></div>\r\n            <div class="conws-addoreditrole-rolepermissions-title"></div>\r\n        </div>\r\n        <div class="conws-addoreditrole-rolepermissions-right">\r\n        </div>\r\n    </div>\r\n    <div class="conws-addoreditrole-rolepermissions-picker"></div>\r\n</div>'}});return i.registerPartial("conws_dialogs_addoreditrole_impl_rolepermissions_impl_rolepermissions",o),o}),csui.define("css!conws/dialogs/addoreditrole/impl/rolepermissions/impl/rolepermissions",[],function(){}),csui.define("conws/dialogs/addoreditrole/impl/rolepermissions/rolepermissions.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/models/form","csui/behaviors/keyboard.navigation/tabable.region.behavior","conws/dialogs/addoreditrole/impl/tabbable.form.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/widgets/permissions/edit/permission.level.selector/permission.level.selector.view","csui/widgets/permissions/edit/permission.attributes/permission.attributes.view","csui/models/permission/nodepermission.model","conws/dialogs/addoreditrole/impl/roleheader/roleheader.view","conws/dialogs/addoreditrole/impl/rolepermissions/impl/rolepermissions.title.view","i18n!conws/dialogs/addoreditrole/impl/nls/lang","hbs!conws/dialogs/addoreditrole/impl/rolepermissions/impl/rolepermissions","i18n","css!conws/dialogs/addoreditrole/impl/rolepermissions/impl/rolepermissions"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h,g){var f=o.ItemView.extend({"template":!1,"tagName":"div","className":"conws-addoreditrole-rolepermissions-backbtn icon circular arrow_back cs-go-back binf-hidden","attributes":{"title":m.backButtonTooltip,"aria-label":m.backButtonAria,"role":"link"},"constructor":function(e){o.View.prototype.constructor.apply(this,arguments)},"behaviors":{"TabableRegion":{"behaviorClass":s}},"currentlyFocusedElement":function(){return this.$el}}),w=o.LayoutView.extend({"template":h,"regions":{"HeaderRegion":".conws-addoreditrole-rolepermissions-header","PickerRegion":".conws-addoreditrole-rolepermissions-picker","TitleRegion":".conws-addoreditrole-rolepermissions-title","RightRegion":".conws-addoreditrole-rolepermissions-right","BackButtonRegion":".conws-addoreditrole-rolepermissions-back"},"templateHelpers":{"title":m.selectPermissionLevel,"backButtonTooltip":m.backButtonTooltip,"backButtonAria":m.backButtonAria},"events":{"click .conws-addoreditrole-rolepermissions-back":"onBackSelection","keydown .conws-addoreditrole-rolepermissions-back":"onBackKeySelection"},"_createHeaderControl":function(){return new u({"headerViewoptions":this.options,"currentStep":"step2"})},"constructor":function(e){e||(e={}),this.context=e.context,this.connector=e.connector,o.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this,"set:initial:focus",this.onSetInitialFocus),this.propagateEventsToRegions()},"onRender":function(){var e={"data":{"subitems_inherit":!0},"options":{"fields":{"subitems_inherit":{"hidden":!1,"hideInitValidationError":!0,"label":m.SubItemsInherit,"readonly":!1,"type":"checkbox"}},"label":""},"schema":{"properties":{"subitems_inherit":{"readonly":!1,"required":!1,"title":m.SubItemsInherit,"type":"boolean"}},"type":"object"}},t=new r({"selected":this.options.addrole?1:this.options.model.getPermissionLevel(),"isContainer":this.options.isContainer,"nodeModel":this.options.nodeModel,"permissionModel":this.options.model}),o=new l({"model":new n(e),"mode":"create"});this.titleView=new p({"model":new i.Model({"title":m.selectPermissionLevel})}),this.options.addrole||(this.lastSelectedPermLevel=this.options.model.getPermissionLevel(),this.options.model.getPermissionLevel()===d.PERMISSION_LEVEL_CUSTOM&&(this.lastSelectedCustomPermissions=this.options.model.get("permissions"))),t.on("permission:level:selected",this.onPermissionLevelSelection,this),this.HeaderRegion.show(this._createHeaderControl()),this.PickerRegion.show(t),this.RightRegion.show(o),this.TitleRegion.show(this.titleView),this.BackButtonRegion.show(new f)},"onPermissionLevelSelection":function(){var e=this.PickerRegion.currentView;if(e&&e.selected===d.PERMISSION_LEVEL_CUSTOM){var t=new c({"permissions":this.lastSelectedCustomPermissions?this.lastSelectedCustomPermissions:[],"readonly":!1,"showButtons":!1,"node":this.options.nodeModel});this.titleView.model.set("title",m.simplePermissionSelection),this.$el.find(".conws-addoreditrole-rolepermissions-backbtn").removeClass("binf-hidden").focus(),this.BackButtonRegion.currentView.trigger("dom:refresh"),this.PickerRegion.show(t),this.isCustom=!0,t.trigger("adjust:splitbar:separator")}else this.lastSelectedPermLevel=e.selected},"onBackSelection":function(){this.lastSelectedCustomPermissions=this.PickerRegion.currentView.getSelectedPermissions(),this.titleView.model.set("title",m.selectPermissionLevel),this.$el.find(".conws-addoreditrole-rolepermissions-backbtn").addClass("binf-hidden"),this.BackButtonRegion.currentView.trigger("dom:refresh");var e=new r({"selected":this.lastSelectedPermLevel?this.lastSelectedPermLevel:1,"isContainer":this.options.isContainer,"nodeModel":this.options.nodeModel});this.PickerRegion.show(e),e.on("permission:level:selected",this.onPermissionLevelSelection,this),this.PickerRegion.currentView.$el.find("li[data-optionid='"+d.PERMISSION_LEVEL_NONE+"'] a").focus()},"onBackKeySelection":function(e){13===e.keyCode&&this.onBackSelection()},"onAfterShow":function(){this.onSetInitialFocus()},"onSetInitialFocus":function(){this.RightRegion.currentView.$el.find("[data-alpaca-container-item-name='subitems_inherit'] input[type='checkbox']").focus()}});return e.extend(w.prototype,a),w}),csui.define("hbs!conws/widgets/team/impl/controls/avatar/impl/avatar",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="participant-picture">\r\n  <span class="csui-icon binf-img-circle" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"display_name")||(null!=t?l(t,"display_name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"display_name","hash":{},"loc":{"start":{"line":2,"column":54},"end":{"line":2,"column":70}}}):s))+'"></span>\r\n  <img class="csui-icon binf-img-circle" alt="'+e.escapeExpression((s=null!=(s=l(i,"display_name")||(null!=t?l(t,"display_name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"display_name","hash":{},"loc":{"start":{"line":3,"column":46},"end":{"line":3,"column":62}}}):s))+'">\r\n</div>'}});return i.registerPartial("conws_widgets_team_impl_controls_avatar_impl_avatar",o),o}),csui.define("css!conws/widgets/team/impl/controls/avatar/impl/avatar",[],function(){}),csui.define("conws/widgets/team/impl/controls/avatar/avatar.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/url","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/controls/avatar/impl/avatar","css!conws/widgets/team/impl/controls/avatar/impl/avatar"],function(e,t,i,o,n,s){return i.LayoutView.extend({"template":s,"templateHelpers":function(){return{"type":this.model.getMemberType()}},"ui":{"profileImage":".participant-picture > img","profileImageDefault":".participant-picture > span"},"constructor":function(e){e||(e={}),i.LayoutView.prototype.constructor.apply(this,arguments)},"onRender":function(){this._displayProfileImage()},"_displayProfileImage":function(){var t=this._getUserPhotoUrl();if(this.ui.profileImage.addClass("esoc-userprofile-img-"+this.model.get("id")),t){var i=this.model.connector.extendAjaxOptions({"url":t,"dataType":"binary"});this._releasePhotoUrl(),this.model.connector.makeAjaxCall(i).always(e.bind(function(e,t,i){200===i.status?(this.photoUrl=URL.createObjectURL(e),this.ui.profileImage.attr("src",this.photoUrl),this.ui.profileImageDefault.remove()):(this.ui.profileImage.remove(),this.ui.profileImageDefault.addClass(this._getPlaceholderImageClass()))},this))}else this.ui.profileImage.remove(),this.ui.profileImageDefault.addClass(this._getPlaceholderImageClass())},"_getUserPhotoUrl":function(){var t=this.model.connector.connection,i=new o(t.url).getCgiScript(),n=this.model.get("id"),s=this.model.get("photo_id");if(s){var l=e.str.sformat("api/v1/members/{0}/photo?v={1}",n,s);return o.combine(i,l)}},"_getPlaceholderImageClass":function(){return"user"===this.model.getMemberType()?"conws-avatar-user-placeholder":"group"===this.model.getMemberType()?"conws-avatar-group-placeholder":"conws-avatar-role-placeholder"},"_releasePhotoUrl":function(){this.photoUrl&&URL.revokeObjectURL(this.photoUrl)}})}),csui.define("hbs!conws/dialogs/addoreditrole/impl/roleparticipants/impl/participant.listitem",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){return'<div class="participant-content binf-pull-left"></div>\r\n<div class="participant-delete binf-pull-right"></div>'}});return i.registerPartial("conws_dialogs_addoreditrole_impl_roleparticipants_impl_participant.listitem",o),o}),csui.define("hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.details",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="participant-picture binf-pull-left"></div>\r\n<div class="participant-info binf-pull-left">\r\n  <span class="name binf-pull-left" title="'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":3,"column":43},"end":{"line":3,"column":51}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":3,"column":53},"end":{"line":3,"column":61}}}):s))+'</span>\r\n  <span class="email binf-pull-left" title="'+e.escapeExpression((s=null!=(s=l(i,"email")||(null!=t?l(t,"email"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"email","hash":{},"loc":{"start":{"line":4,"column":44},"end":{"line":4,"column":53}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"email")||(null!=t?l(t,"email"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"email","hash":{},"loc":{"start":{"line":4,"column":55},"end":{"line":4,"column":64}}}):s))+'</span>\r\n  <span class="title binf-pull-left" title="'+e.escapeExpression((s=null!=(s=l(i,"title")||(null!=t?l(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":5,"column":44},"end":{"line":5,"column":53}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"title")||(null!=t?l(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":5,"column":55},"end":{"line":5,"column":64}}}):s))+'</span>\r\n  <span class="department binf-pull-left" title="'+e.escapeExpression((s=null!=(s=l(i,"department")||(null!=t?l(t,"department"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"department","hash":{},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":63}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"department")||(null!=t?l(t,"department"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"department","hash":{},"loc":{"start":{"line":6,"column":65},"end":{"line":6,"column":79}}}):s))+'</span>\r\n  <span class="office binf-pull-left" title="'+e.escapeExpression((s=null!=(s=l(i,"office")||(null!=t?l(t,"office"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"office","hash":{},"loc":{"start":{"line":7,"column":45},"end":{"line":7,"column":55}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"office")||(null!=t?l(t,"office"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"office","hash":{},"loc":{"start":{"line":7,"column":57},"end":{"line":7,"column":67}}}):s))+"</span>\r\n</div>\r\n"}});return i.registerPartial("conws_widgets_team_impl_dialogs_addparticipants_impl_participant.listitem.details",o),o}),csui.define("hbs!conws/dialogs/addoreditrole/impl/roleparticipants/impl/participant.listitem.delete",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<span class="remove csui-icon conws-icon-cross" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":1,"column":57},"end":{"line":1,"column":63}}}):s))+'" title="'+e.escapeExpression((s=null!=(s=l(i,"removeParticipant")||(null!=t?l(t,"removeParticipant"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"removeParticipant","hash":{},"loc":{"start":{"line":1,"column":72},"end":{"line":1,"column":93}}}):s))+'"\r\n    aria-label="'+e.escapeExpression((s=null!=(s=l(i,"removeParticipantAria")||(null!=t?l(t,"removeParticipantAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"removeParticipantAria","hash":{},"loc":{"start":{"line":2,"column":16},"end":{"line":2,"column":41}}}):s))+'"></span>'}});return i.registerPartial("conws_dialogs_addoreditrole_impl_roleparticipants_impl_participant.listitem.delete",o),o}),csui.define("css!conws/dialogs/addoreditrole/impl/roleparticipants/impl/participant.listitem",[],function(){}),csui.define("conws/dialogs/addoreditrole/impl/roleparticipants/impl/participant.listitem.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/utils/contexts/factories/user","esoc/widgets/userwidget/userwidget","conws/widgets/team/impl/controls/avatar/avatar.view","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/dialogs/addoreditrole/impl/roleparticipants/impl/participant.listitem","hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.details","hbs!conws/dialogs/addoreditrole/impl/roleparticipants/impl/participant.listitem.delete","css!conws/dialogs/addoreditrole/impl/roleparticipants/impl/participant.listitem"],function(e,t,i,o,n,s,l,a,r,c,d,u){var p=i.ItemView.extend({"template":d,"templateHelpers":function(){return{"type":this.model.getMemberType(),"name":this.model.displayName(),"email":this.model.displayEmail(),"title":this.model.displayTitle(),"department":this.model.displayDepartment(),"office":this.model.displayOffice()}},"ui":{"personalizedImage":".csui-icon-user","defaultImage":".csui-icon-paceholder"},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.apply(this,arguments)},"initialize":function(){this.avatar=new a({"model":this.model})},"onRender":function(){if(void 0!==this.model.get("type")&&0===this.model.get("type")){var e=this.model.collection.context.getModel(s),t={"connector":this.model.connector,"model":this.model,"userid":this.model.get("id"),"context":this.model.collection.context,"showUserProfileLink":!0,"showMiniProfile":!0,"loggedUserId":e.get("id"),"placeholder":this.$el.find(".participant-picture"),"showUserWidgetFor":"profilepic"};l.getUser(t)}else this.$(".participant-picture").append(this.avatar.render().$el)}}),m=i.ItemView.extend({"template":u,"templateHelpers":function(){return{"removeParticipant":r.addParticipantsRemove,"removeParticipantAria":e.str.sformat(r.removeParticipantAria,this.model.displayName())}},"events":{"click .remove":"onRemoveOnClick","keydown .remove":"onRemoveOnKeyDown"},"behaviors":{"TabableRegion":{"behaviorClass":o}},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.apply(this,arguments)},"onRemoveOnClick":function(e){e.preventDefault(),e.stopPropagation(),this.model.collection.remove(this.model)},"onRemoveOnKeyDown":function(e){13!==e.keyCode&&32!==e.keyCode&&46!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this.model.collection.remove(this.model))},"currentlyFocusedElement":function(){return this.$(".remove")}}),h=i.LayoutView.extend({"template":c,"tagName":"li","className":"binf-list-group-item conws-participant","regions":{"content":".participant-content","delete":".participant-delete"},"constructor":function(e){e||(e={}),i.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"remove",this.onParticipantRemove),this.propagateEventsToRegions()},"onRender":function(){this.content.show(new p({"model":this.model})),this.delete.show(new m({"model":this.model}))},"onParticipantRemove":function(){this._parent.selectedIndex=this._index}});return e.extend(h.prototype,n),h}),csui.define("hbs!conws/dialogs/addoreditrole/impl/roleparticipants/impl/empty.roleparticipants",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="conws-addoreditrole-emptyroleparticipants">\r\n    <div class="conws-addoreditrole-emptyroleparticipants conws-empty_team"></div>\r\n    <div class="conws-addoreditrole-emptyroleparticipants-msg">\r\n        <p>'+e.escapeExpression((s=null!=(s=l(i,"message")||(null!=t?l(t,"message"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"message","hash":{},"loc":{"start":{"line":4,"column":11},"end":{"line":4,"column":22}}}):s))+"</p>\r\n    </div>\r\n</div>"}});return i.registerPartial("conws_dialogs_addoreditrole_impl_roleparticipants_impl_empty.roleparticipants",o),o}),csui.define("css!conws/dialogs/addoreditrole/impl/roleparticipants/impl/empty.roleparticipants",[],function(){}),csui.define("conws/dialogs/addoreditrole/impl/roleparticipants/impl/empty.roleparticipants.view",["csui/lib/underscore","csui/lib/marionette","i18n!conws/dialogs/addoreditrole/impl/nls/lang","hbs!conws/dialogs/addoreditrole/impl/roleparticipants/impl/empty.roleparticipants","css!conws/dialogs/addoreditrole/impl/roleparticipants/impl/empty.roleparticipants"],function(e,t,i,o){return t.LayoutView.extend({"template":o,"templateHelpers":{"message":i.rolePartcipantsWithNoparticipantsMessage},"constructor":function(e){e||(e={}),this.context=e.context,this.connector=e.connector,t.LayoutView.prototype.constructor.apply(this,arguments)}})}),csui.define("hbs!conws/dialogs/addoreditrole/impl/roleparticipants/impl/roleparticipants",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="conws-addoreditrole-roleparticipants">\r\n  <div class="conws-addoreditrole-roleparticipants-header"></div>\r\n  <div class="conws-addoreditrole-roleparticipants-body">\r\n    <div class="conws-addoreditrole-roleparticipants-left">\r\n      <div class="conws-addoreditrole-roleparticipants-userpicker-title">\r\n        '+e.escapeExpression((s=null!=(s=l(i,"title")||(null!=t?l(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":6,"column":8},"end":{"line":6,"column":17}}}):s))+'\r\n      </div>\r\n    </div>\r\n    <div class="conws-addoreditrole-roleparticipants-right">\r\n      <div class="conws-addoreditrole-roleparticipants-search">\r\n        <div class="conws-addoreditrole-roleparticipants-userpicker">\r\n          \x3c!-- user picker region --\x3e\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="conws-addoreditrole-roleparticipants-members-body">\r\n    <div class="conws-addoreditrole-roleparticipants-members">\r\n    </div>\r\n  </div>\r\n</div>'}});return i.registerPartial("conws_dialogs_addoreditrole_impl_roleparticipants_impl_roleparticipants",o),o}),csui.define("css!conws/dialogs/addoreditrole/impl/roleparticipants/impl/roleparticipants",[],function(){}),csui.define("conws/dialogs/addoreditrole/impl/roleparticipants/roleparticipants.view",["csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/controls/tile/behaviors/perfect.scrolling.behavior","conws/widgets/team/impl/participant.model","conws/dialogs/addoreditrole/impl/roleparticipants/impl/participant.listitem.view","conws/dialogs/addoreditrole/impl/roleheader/roleheader.view","conws/dialogs/addoreditrole/impl/roleparticipants/impl/empty.roleparticipants.view","csui/controls/userpicker/userpicker.view","i18n!conws/dialogs/addoreditrole/impl/nls/lang","hbs!conws/dialogs/addoreditrole/impl/roleparticipants/impl/roleparticipants","css!conws/dialogs/addoreditrole/impl/roleparticipants/impl/roleparticipants"],function(e,t,i,o,n,s,l,a,r,c,d,u,p){var m=i.CollectionView.extend({"tagName":"ul","className":"binf-list-group","childView":a,"constructor":function(e){i.CollectionView.call(this,e)},"onRemoveChild":function(e){this.moveTabIndex(e)},"moveTabIndex":function(e){var t=this.children&&this.children.length;if(t){var i=this.selectedIndex;if(void 0!==i){i===t&&(i-=1);var o=this.collection.at(i);if(o){var n=this.children.findByModel(o);n&&n.$el.find(".participant-delete .conws-icon-cross").focus()}}}}}),h=i.LayoutView.extend({"template":p,"regions":{"HeaderRegion":".conws-addoreditrole-roleparticipants-header","userPickerRegion":".conws-addoreditrole-roleparticipants-userpicker","participantsRegion":".conws-addoreditrole-roleparticipants-members"},"behaviors":{"PerfectScrolling":{"behaviorClass":s,"contentParent":".conws-addoreditrole-roleparticipants-members","suppressScrollX":!0}},"templateHelpers":{"title":u.participantsTitle},"_createHeaderControl":function(){return new r({"headerViewoptions":this.options,"currentStep":"step3"})},"_createEmptyRoleParticipantsView":function(){return new c({"options":this.options})},"_createParticipantsListCollectionView":function(){return new m({"context":this.context,"collection":e.extend(new t.Collection,{"context":this.context,"node":this.options.nodeModel,"comparator":function(e,t){return o.localeCompareString(e.get("display_name"),t.get("display_name"))}})})},"constructor":function(e){e||(e={}),this.context=e.context,this.connector=e.connector,i.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this,"set:initial:focus",this.onSetInitialFocus),this.propagateEventsToRegions()},"onRender":function(){var t=new d({"context":this.context,"limit":20,"clearOnSelect":!0,"placeholder":u.roleParticipantsUserPickerPlaceholder,"disabledMessage":u.roleParticipantsDisabledMemberMessage,"onRetrieveMembers":e.bind(this.retrieveMembersCallback,this),"prettyScrolling":!0,"initialActivationWeight":100});this.HeaderRegion.show(this._createHeaderControl()),this.userPickerRegion.show(t),t.$(".cs-search-icon").attr("aria-label",u.roleParticipantsSearchAria),this.listenTo(t,"item:change",this.onUserItemChanged);var i=this._createParticipantsListCollectionView();!this.options.addrole&&this.options.model&&e.each(this.options.model.get("members"),function(e){var t=new l(e,{"connector":this.connector,"collection":this.participants});i.collection.add(t)},this),this.participants=i.collection,this.participantView=i,this.listenTo(this.participants,"reset add change",this.onParticipantsChanged),this.listenTo(this.participants,"remove",this.onParticipantsRemove),0===i.collection.length?this.participantsRegion.show(this._createEmptyRoleParticipantsView()):(this.participantsRegion.show(i),this.participantsRegion.$el.addClass("conws-addoreditrole-roleparticipants-members-exist"))},"onAfterShow":function(){e.each(this.participantView.children._views,function(e){e.delete&&e.delete.currentView&&e.delete.currentView.trigger("dom:refresh")},this),this.onSetInitialFocus()},"onSetInitialFocus":function(){this.userPickerRegion.currentView.$el.find("[class='csui-control-userpicker'] input[type='text']").focus()},"onUserItemChanged":function(t){if(!t.item.get("disabled")){var i=e.extend(t.item.attributes,{"display_name":t.item.get("name_formatted")}),o=new l(i,{"connector":this.connector,"collection":this.participants});if(0===this.participants.length){this.participantsRegion.$el.addClass("conws-addoreditrole-roleparticipants-members-exist");var n=this._createParticipantsListCollectionView();n.collection=this.participants,n.collection.add(o),this.participantsRegion.show(n),this.listenTo(n.collection,"reset add change",this.onParticipantsChanged),this.listenTo(n.collection,"remove",this.onParticipantsRemove),this.trigger("update:scrollbar")}else this.participants.add(o)}},"retrieveMembersCallback":function(e){var t=this;e.collection.each(function(e){var i=!1;t.participants.findWhere({"id":e.get("id")})&&(i=!0),e.set("disabled",i)})},"onParticipantsRemove":function(){this.onParticipantsChanged(),this.participants&&0===this.participants.length&&(this.userPickerRegion.currentView.currentlyFocusedElement().focus(),this.participantsRegion.$el.removeClass("conws-addoreditrole-roleparticipants-members-exist"),this.participantsRegion.show(this._createEmptyRoleParticipantsView()))},"onParticipantsChanged":function(){this.trigger("update:scrollbar")}});return e.extend(h.prototype,n),h}),csui.define("conws/dialogs/addoreditrole/addoreditrole.wizard",["csui/lib/underscore","csui/lib/jquery","csui/utils/contexts/factories/connector","i18n!conws/dialogs/addoreditrole/impl/nls/lang","csui/utils/log","csui/controls/progressblocker/blocker","csui/models/permission/nodepermission.model","conws/controls/wizard/wizard.view","conws/dialogs/addoreditrole/impl/roledetails/roledetails.view","conws/dialogs/addoreditrole/impl/rolepermissions/rolepermissions.view","conws/dialogs/addoreditrole/impl/roleparticipants/roleparticipants.view"],function(e,t,i,o,n,s,l,a,r,c,d){"use strict";function u(t){if(t||(t={}),this.options=e.defaults(t,p),this.options.connector||(this.options.connector=this._getConnector(this.options)),!this.options.connector){var i=o.missingConnector;throw n.error(i)&&console.error(i),new Error(i)}}var p={"initialSelection":[],"dialogTitle":o.dialogTitle};return e.extend(u.prototype,{"show":function(){return this._showWizard(),this._deferred=t.Deferred(),this._deferred.promise()},"_showWizard":function(){this._steps=this._createWizardSteps(),this._wizard=new a({"steps":this._steps}),s.imbue(this._wizard),this._wizard.show(this._wizard.options),this._wizard.on("save:result",this.onClickFinishButton,this),this._wizard.on("closing:wizard",this.onClickCancelButton,this)},"_RoleDetailsView":function(){var e=new r({"addrole":this.options.addrole,"teamLead":!0,"isFirstRole":this.options.isFirstRole});return!this.options.addrole&&this.options.model&&this.options.model.get("right_id_expand")&&(e.options.name=this.options.model.get("right_id_expand").name,e.options.description=this.options.model.get("right_id_expand").description,e.options.team_lead=this.options.model.get("right_id_expand").team_lead),e.on("required:field:changed",function(){e.LeftRegion.currentView.$el.find("div[data-alpaca-container-item-name='role_name']").find("input[type='text']").val().length?(this._wizard.currentView.updateButton("next",{"disabled":!1}),this._wizard.currentView.updateButton("done",{"disabled":!1})):(this._wizard.currentView.updateButton("next",{"disabled":!0}),this._wizard.currentView.updateButton("done",{"disabled":!0}))},this),e},"_RolePermissionsView":function(){return new c({"addrole":this.options.addrole,"model":this.options.model,"isContainer":!this.options.nodeModel||this.options.nodeModel.get("container"),"nodeModel":this.options.nodeModel})},"_RoleParticipantsView":function(){return new d(this.options)},"dialogClassName":function(){var e="target-browse";return this.options&&this.options.userClassName&&(e=e+" "+this.options.userClassName),e},"_createWizardSteps":function(){var t,i,n,s=this.options,l=e.uniqueId("permissionLevel");return t={"title":s.dialogTitle,"view":this._RoleDetailsView(),"className":this.dialogClassName()+" csui-permissions-level conws-addoreditrole-dialog","nextButton":!0,"disableNext":!!this.options.addrole,"doneButtonLabel":o.doneButtonLabel,"disableDone":!!this.options.addrole,"doneButton":!0,"largeSize":!0,"attributes":{"aria-labelledby":"rolePickerHeader"}},i={"title":s.dialogTitle,"nextButtonLabel":o.nextButtonLabel,"nextButton":!0,"disableNext":!1,"doneButtonLabel":o.doneButtonLabel,"disableDone":!1,"doneButton":!0,"largeSize":!0,"view":this._RolePermissionsView(),"className":this.dialogClassName()+" csui-permissions-level conws-addoreditrole-dialog","attributes":{"aria-labelledby":"rolePickerHeader","aria-describedby":l}},n={"title":s.dialogTitle,"doneButtonLabel":o.doneButtonLabel,"disableDone":!1,"doneButton":!0,"largeSize":!0,"view":this._RoleParticipantsView(),"className":this.dialogClassName()+" csui-permissions-level conws-addoreditrole-dialog","attributes":{"aria-labelledby":"rolePickerHeader"}},[t,i,n]},"onHideDialog":function(){this._deferred&&(this._result?this._deferred.resolve(this._result):"pending"===this._deferred.state()&&this._deferred.reject({"cancelled":!0}))},"onClickCancelButton":function(){this.onHideDialog()},"onClickFinishButton":function(){var t,i,o,n,s,a,r;if(this){var c=this.getRoleDetailsView(),d=this.getPermissionsView();c.LeftRegion&&c.LeftRegion.currentView&&(t=c.LeftRegion.currentView.getValues().role_name,i=c.LeftRegion.currentView.getValues().role_description),o=c.RightRegion&&c.RightRegion.currentView&&c.RightRegion.currentView.getValues().team_lead,d.PickerRegion&&d.PickerRegion.currentView&&(n=d.PickerRegion.currentView.getSelectedPermissions(),null===n&&d.lastSelectedPermLevel&&d.lastSelectedPermLevel===l.PERMISSION_LEVEL_CUSTOM&&(n=d.lastSelectedCustomPermissions),a=!(!this.options.nodeModel||!this.options.nodeModel.get("container")),d.RightRegion&&d.RightRegion.currentView&&(s=0,a&&(s=d.RightRegion.currentView.getValues().subitems_inherit?2:0))),this.getParticipantsView().participants&&(r=[],e.each(this.getParticipantsView().participants.models,function(e){r.push(e.get("id"))})),this._result={"role_name":t,"role_description":i,"team_lead":o,"permissions":n,"apply_to":s,"participants":r},this._wizard.destroy(),
this.onHideDialog()}else this._wizard.currentView.updateButton("next",{"disabled":!0})},"_getConnector":function(t){var o;if(t.context)o=t.context.getObject(i);else if(t.initialSelection||t.initialContainer){var n=t.initialSelection,s=n?e.isArray(n)?n:n.models:void 0,l=t.initialContainer||s[0];o=l&&l.connector}return o},"getRoleDetailsView":function(){return this._steps[0].view},"getPermissionsView":function(){return this._steps[1].view},"getParticipantsView":function(){return this._steps[2].view}}),u}),csui.define("conws/dialogs/applyrolepermissions/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/dialogs/applyrolepermissions/impl/nls/root/lang",{"applyRolePermissionHeaderTitle":"Apply permissions","deleteRolePermissionHeaderTitle":"Delete {0}","removeRolePermissionHeaderTitle":"Remove {0}","SubItemsInherit":"Apply to sub-items","applyToItem":"Permissions will be applied to all items in {0}.","deleteToItem":"{0} will be deleted and permissions will be removed from all items in {1}","removeToItem":"Permissions will be removed from all items in {0}"}),csui.define("hbs!conws/dialogs/applyrolepermissions/impl/apply.role.permissions",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){return'<div class="conws-apply-role-permission-content">\r\n  <span class="conws-apply-role-permission-message"></span>\r\n</div>\r\n<div class="conws-apply-role-permission-switch">\r\n</div>'}});return i.registerPartial("conws_dialogs_applyrolepermissions_impl_apply.role.permissions",o),o}),csui.define("css!conws/dialogs/applyrolepermissions/impl/apply.role.permissions",[],function(){}),csui.define("conws/dialogs/applyrolepermissions/apply.role.permissions.view",["csui/lib/underscore","csui/lib/marionette","csui/models/form","conws/dialogs/addoreditrole/impl/tabbable.form.view","i18n!conws/dialogs/applyrolepermissions/impl/nls/lang","hbs!conws/dialogs/applyrolepermissions/impl/apply.role.permissions","css!conws/dialogs/applyrolepermissions/impl/apply.role.permissions"],function(e,t,i,o,n,s){return ApplyRolePermissionsView=t.LayoutView.extend({"template":s,"ui":{"applyRolePermissionMsg":".conws-apply-role-permission-message"},"regions":{"ContentRegion":".conws-apply-role-permission-switch"},"templateHelpers":function(){return{"title":this.model.get("title")}},"constructor":function(e){t.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change",this.render)},"onRender":function(){var t="";if(this.options.removePermission)if(this.options.permissionModel&&void 0!==this.options.permissionModel.isRoleDelete&&!this.options.permissionModel.isRoleDelete)t=e.str.sformat(n.removeToItem,this.options.model.get("name"));else{var s=this.options.permissionModel.get("right_id_expand")&&this.options.permissionModel.get("right_id_expand").name_formatted;t=e.str.sformat(n.deleteToItem,s,this.options.model.get("name"))}else t=e.str.sformat(n.applyToItem,this.options.model.get("name"));this.ui.applyRolePermissionMsg.html(t);var l={"data":{"subitems_inherit":!0},"options":{"fields":{"subitems_inherit":{"hidden":!1,"hideInitValidationError":!0,"label":n.SubItemsInherit,"readonly":!1,"type":"checkbox"}},"label":""},"schema":{"properties":{"subitems_inherit":{"readonly":!1,"required":!1,"title":n.SubItemsInherit,"type":"boolean"}},"type":"object"}},a=new o({"model":new i(l),"mode":"create"});this.options.removePermission?this.options.permissionModel&&void 0!==this.options.permissionModel.isRoleDelete&&!this.options.permissionModel.isRoleDelete&&this.ContentRegion.show(a):this.ContentRegion.show(a)}}),ApplyRolePermissionsView}),csui.define("hbs!conws/dialogs/regen.reference/impl/regen.reference",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="conws-regen-ref-dialog-header-content">\r\n  <span class="icon icon-notification-information"></span>\r\n  <span class="title-text conws-regen-ref-header-title" title="'+e.escapeExpression((s=null!=(s=l(i,"title")||(null!=t?l(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":3,"column":63},"end":{"line":3,"column":72}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"title")||(null!=t?l(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":3,"column":86},"end":{"line":3,"column":95}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"title")||(null!=t?l(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":3,"column":97},"end":{"line":3,"column":106}}}):s))+'</span>\r\n</div>\r\n\r\n<div class="conws-regen-ref-dialog-content">\r\n  <span class="conws-regen-ref-dialog-message" title="'+e.escapeExpression((s=null!=(s=l(i,"regenRefDlgMsg")||(null!=t?l(t,"regenRefDlgMsg"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"regenRefDlgMsg","hash":{},"loc":{"start":{"line":7,"column":54},"end":{"line":7,"column":72}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"regenRefDlgMsg")||(null!=t?l(t,"regenRefDlgMsg"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"regenRefDlgMsg","hash":{},"loc":{"start":{"line":7,"column":86},"end":{"line":7,"column":104}}}):s))+'" >\r\n    '+e.escapeExpression((s=null!=(s=l(i,"regenRefDlgMsg")||(null!=t?l(t,"regenRefDlgMsg"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"regenRefDlgMsg","hash":{},"loc":{"start":{"line":8,"column":4},"end":{"line":8,"column":22}}}):s))+'\r\n  </span>\r\n</div>\r\n\r\n<div class="conws-regen-ref-dialog-boolean-container">\r\n  <div class="conws-regen-ref-dialog-boolean">\r\n    <div class="conws-regen-ref-dialog-boolean-label" id="regenRefLabel" title="'+e.escapeExpression((s=null!=(s=l(i,"regenRefDlgInutLabel")||(null!=t?l(t,"regenRefDlgInutLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"regenRefDlgInutLabel","hash":{},"loc":{"start":{"line":14,"column":80},"end":{"line":14,"column":104}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"regenRefDlgInutLabel")||(null!=t?l(t,"regenRefDlgInutLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"regenRefDlgInutLabel","hash":{},"loc":{"start":{"line":14,"column":118},"end":{"line":14,"column":142}}}):s))+'">\r\n      '+e.escapeExpression((s=null!=(s=l(i,"regenRefDlgInutLabel")||(null!=t?l(t,"regenRefDlgInutLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"regenRefDlgInutLabel","hash":{},"loc":{"start":{"line":15,"column":6},"end":{"line":15,"column":30}}}):s))+'\r\n    </div>\r\n    <div class="conws-regen-ref-dialog-boolean-input"></div>\r\n  </div>\r\n</div>'}});return i.registerPartial("conws_dialogs_regen.reference_impl_regen.reference",o),o}),csui.define("conws/dialogs/regen.reference/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/dialogs/regen.reference/impl/nls/root/lang",{"regenReferenceTitle":"Re-generate the Reference Number","regenReferenceDlgMsg":"Enable this option to generate a new Reference Number for the items that you move to a new location.","regenReferenceDlgInutLabel":"Move with Reference regeneration"}),csui.define("css!conws/dialogs/regen.reference/impl/regen.reference",[],function(){}),csui.define("conws/dialogs/regen.reference/regen.reference.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","hbs!conws/dialogs/regen.reference/impl/regen.reference","i18n!conws/dialogs/regen.reference/impl/nls/lang","css!conws/dialogs/regen.reference/impl/regen.reference"],function(e,t,i,o,n,s,l){"use strict";return o.ItemView.extend({"template":s,"templateHelpers":function(){return{"title":l.regenReferenceTitle,"regenRefDlgMsg":l.regenReferenceDlgMsg,"regenRefDlgInutLabel":l.regenReferenceDlgInutLabel}},"behaviors":{"TabableRegionBehavior":{"behaviorClass":n}},"constructor":function(e){e=e||{},e.model=e.model||e.node,o.ItemView.prototype.constructor.apply(this,arguments),this.model=new i.Model({"ref_regen":!1})},"currentlyFocusedElement":function(e){return this.regenSwitchView?this.regenSwitchView.$el.find(":input"):void 0},"onRender":function(){var e=this;csui.require(["csui/controls/form/fields/booleanfield.view"],function(t){e.regenSwitchView=new t({"mode":"writeonly","model":new i.Model({"data":e.model.get("ref_regen")}),"labelId":"regenRefLabel"}),e.regenSwitchView.render(),e.regenSwitchView.on("field:changed",function(t){e.model.set({"ref_regen":t.fieldvalue},{"silent":!0})}),e.$(".conws-regen-ref-dialog-boolean-input").append(e.regenSwitchView.$el)})}})}),csui.define("conws/dialogs/applyrolepermissions/impl/header/apply.role.permissions.header.view",["csui/lib/underscore","csui/widgets/permissions/edit/apply.permission/header/apply.permission.header.view","i18n!conws/dialogs/applyrolepermissions/impl/nls/lang"],function(e,t,i){"use strict";return t.extend({"templateHelpers":function(){var t="";if(this.options.removePermission&&this.options.permissionModel){var o=this.options.permissionModel.get("right_id_expand")&&this.options.permissionModel.get("right_id_expand").name_formatted;t=this.options.permissionModel.isRoleDelete?e.str.sformat(i.deleteRolePermissionHeaderTitle,o):e.str.sformat(i.removeRolePermissionHeaderTitle,o)}else t=i.applyRolePermissionHeaderTitle;return{"title":t}},"constructor":function(e){e||(e={}),t.prototype.constructor.apply(this,arguments)}})}),csui.define("conws/dialogs/node.picker/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/dialogs/node.picker/impl/nls/root/lang",{"labelFacetsVolume":"Facets volume"}),csui.define("conws/dialogs/node.picker/start.locations/facets.volume/facets.volume.factory",["csui/lib/underscore","csui/dialogs/node.picker/start.locations/node.base.factory","i18n!conws/dialogs/node.picker/impl/nls/lang","css!conws/utils/icons/icons"],function(e,t,i){"use strict";return t.extend({"constructor":function(o){o=e.defaults({"node":{"id":"volume","type":901},"icon":"facets_volume","unselectable":!1,"defaultName":i.labelFacetsVolume},o),t.prototype.constructor.call(this,o)},"updateLocationModel":function(e){return t.prototype.updateLocationModel.apply(this,arguments)}})}),csui.define("conws/utils/commands/nls/commands.lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/utils/commands/nls/root/commands.lang",{"CommandNameEmail":"Send e-mail","CommandNameExport":"Download","CommandNameAddParticipant":"Add participants","CommandNameExportParticipants":"Download list of participants","CommandNamePrintParticipants":"Print list of participants","CommandNameShowRoles":"Show roles","CommandNameRemoveParticipant":"Remove from team","CommandNameAddRole":"Add role","CommandNameEditRole":"Edit role","CommandNamePrintRoles":"Print list of roles","CommandNameExportRoles":"Download list of roles","CommandNameShowDetails":"Show details","CommandNameDeleteRole":"Delete","CommandNameAddConnectedWorkspace":"Add business workspace","RemoveParticipantTitleSingle":"Remove participant","RemoveParticipantTitleMultiple":"Remove participants","RemoveParticipantMessage":"Removing participants from the team will also remove them from their roles.","RemoveParticipantErrorMessageDefault":"Cannot remove one or more participants.","DeleteRoleTitleSingle":"Delete role","DeleteRoleTitleMultiple":"Delete roles","DeleteRoleMessageNoParticipantsAffected":"When you delete this role, no participant will be removed from the team: The role is empty or all participants of this role are members of other team roles.","DeleteRoleMessageParticipantsAffectedSingle":"When you delete this role, 1 participant will be removed from the team.","DeleteRoleMessageParticipantsAffectedMultiple":"When you delete this role, {0} participants will be removed from the team.","ErrorLoadingAddItemMenu":"Cannot load workspace types to the Add menu.","AddConwsMetadataDialogTitle":"Create {0}","BusinessWorkspace":"business workspace","AddConwsMetadataDialogAddButtonTitle":"Save","BusinessWorkspaceTypeName":"Business Workspace","BusinessWorkspaceSuccessfullyCreated":"{0} was successfully created.","nameIsGeneratedAutomatically":"Workspace name is generated automatically.","errorGettingCreateForm":"Error getting form for workspace creation.","CommandNameAddCONWSTemplate":"Add business workspace template","ErrorAddingSubfolderToNodesTable":"Failed to add subfolder to the nodestable","ServerCommandNameDeleteRelatedItem":"Remove related item","CommandNameDeleteRelatedItem":"Remove relationships","CommandVerbDeleteRelatedItem":"remove","DeleteRelatedItemsNoneMessage":"No relationship removed.","DeleteOneRelatedItemSuccessMessage":"One relationship successfully removed.","DeleteSomeRelatedItemsSuccessMessage":"{0} relationships successfully removed.","DeleteManyRelatedItemsSuccessMessage":"{0} relationships successfully removed.","DeleteOneRelatedItemConfirmMessage":"Do you want to remove the relationship to '{1}'?","DeleteSomeRelatedItemsConfirmMessage":"Do you want to remove {0} relationships?","DeleteManyRelatedItemsConfirmMessage":"Do you want to remove {0} relationships?","CommandNameAddRelatedItem":"Add relationships","CommandVerbAddRelatedItem":"add","AddRelatedItemsNoneMessage":"No relationship added.","AddOneRelatedItemSuccessMessage":"One relationship successfully added.","AddSomeRelatedItemsSuccessMessage":"{0} relationships successfully added.","AddManyRelatedItemsSuccessMessage":"{0} relationships successfully added.","AddRoleSuccess":"{0} added successfully","EditRoleSuccess":"{0} updated successfully","BusinessWorkspaceRole":"Business Workspace Role","DeletePermissionCommandForSubItems":"Remove role","ToolbarItemEditRolePermission":"Edit role permissions","DeleteRoleCommandSuccessMessage":"{0} was deleted successfully","DeleteRoleCommandFailMessage":"Failed to delete {0}.","CommandNameNavigateUp":"Click to go up. Hold to open menu.","apply":"Apply","CommandMessageOpen":"Open business workspace","CommandNameCreateConnectedWorkspace":"Create business workspace","CreateBusinessWorkspace":"Create business workspace","AvailableBWSTemplate":"Available business workspace templates","sidePanelNextButton":"Next","sidePanelCreateButton":"Create","sidePanelTitle":"Create {0}","failedToCreateItem":"Failed to create the new item.","noResults":"No results found","noWSTypes":"There are no valid workspace types configured."}),csui.define("conws/utils/commands/tabletoolbar.extension",["csui/lib/jquery","csui/lib/underscore","csui/utils/url","csui/controls/globalmessage/globalmessage","csui/controls/toolbar/toolitem.model","i18n!conws/utils/commands/nls/commands.lang","csui/utils/base"],function(e,t,i,o,n,s,l){function a(){}return t.extend(a.prototype,{"_addMenuItems":function(e,t){var i=[];t.forEach(function(e){e.templates.length>0&&e.templates.forEach(function(t){var o=848===t.subType?s.BusinessWorkspaceTypeName:"",l=new n({"signature":"AddConnectedWorkspace","name":t.name,"type":t.subType,"group":"conws","commandData":{"wsType":e,"subType":t.subType,"subTypeName":o,"template":t}});i.push(l)})}),i.length>0&&(i.sort(function(e,t){var i=e.get("name"),o=t.get("name");return l.localeCompareString(i,o,{"usage":"sort"})}),i.forEach(function(t){e.push(t)}))},"OnUpdateToolbar":function(n){var l=n.async(),a=n.container,r=n.toolbarItems,c=t.find(r,function(e){if(848===e.attributes.type)return e});c&&(c.set("signature","AddCONWSTemplate"),c.set("group","conws"));var d=e.Deferred(),u=i.combine(a.urlBase(),"businessworkspacetypes"),p=a.connector.extendAjaxOptions({"type":"GET","url":u}),m=this;a.connector.makeAjaxCall(p).done(function(e,t,i){e&&e.businessworkspacetypes&&e.businessworkspacetypes.length>0&&m._addMenuItems(r,e.businessworkspacetypes),d.resolve.apply(d,arguments),l()}).fail(function(e,t,i){var n=[];if("error"!==t&&n.push(t),e.responseText){var a=JSON.parse(e.responseText);a&&a.error&&n.push(a.error)}i&&n.push(i);var r=n.length>0?n.join("\r\n"):void 0;o.showMessage("error",s.ErrorLoadingAddItemMenu,r),d.reject.apply(d,arguments),l()})}}),function(e){var t=new a;e.on("before:updateAddToolbar",function(){t.OnUpdateToolbar.apply(t,arguments)})}}),csui.define("conws/utils/commands/navigate/impl/flyout.toolitem.view",["module","csui/lib/jquery","csui/lib/underscore","csui/utils/log","csui/lib/hammer","csui/controls/toolbar/flyout.toolitem.view"],function(e,t,i,o,n,s){"use strict";var l=new o(e.id);return s.extend({"constructor":function(e){this.options=e=e||{},this.options.longPress&&(this.events={"click":"_stopEvent","click @ui.link":"activeSubmenu","keydown":"onKeyDown"},this.listenTo(this,"toolitem:action",this._closeDropDown)),s.prototype.constructor.call(this,e)},"_stopEvent":function(e){l.debug("event stopped {0}",e.type)&&console.log(l.last),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},"activeSubmenu":function(e){this.options.longPress&&this._stopEvent(e),s.prototype.activeSubmenu.call(this,e)},"onRender":function(){s.prototype.onRender.apply(this,arguments),this.options.longPress&&this._assignTouchControl(),this.$el.on("focusout",i.bind(function(e){e.relatedTarget&&this.el.contains(e.relatedTarget)||this._closeDropDown()},this))},"onKeyDown":function(e){if(this.options.longPress&&this._isOnPrimaryItem(e)&&(13===e.keyCode||32===e.keyCode))return this._handleClick(e),this._stopEvent(e),!1},"onKeyInView":function(e){if(!1===this.onKeyDown(e))return!1;s.prototype.onKeyInView.apply(this,arguments)},"_assignTouchControl":function(){this.hammer&&this.hammer.destroy(),this.hammer=new n.Manager(this.el);var e=new n.Tap,t=new n.Press({"time":500});this.hammer.add([e,t]),this.hammer.on("tap",i.bind(this._onTap,this)),this.hammer.on("press",i.bind(this._onPress,this))},"_isOnPrimaryItem":function(e){if(this.el===e.target||this.el.contains(e.target)){var t=this.$(".binf-dropdown-menu")[0];if(t!==e.target&&!t.contains(e.target))return!0}},"_onTap":function(e){l.debug("hammer tap")&&console.log(l.last),this._isOnPrimaryItem(e)&&this._handleClick(t.Event("click"))},"_onPress":function(e){l.debug("hammer press")&&console.log(l.last),this._isOnPrimaryItem(e)&&this._toggleDropDown()},"_closeDropDown":function(){this.$el.hasClass("binf-open")&&this._toggleDropDown()},"_toggleDropDown":function(){this.$el.data("binf.dropdown.submenu").toggle(t.Event("click",{"which":1,"currentTarget":this.el,"target":this.el}))}})}),csui.define("conws/utils/commands/navigate/navigateup",["require","module","csui/lib/jquery","csui/lib/underscore","csui/utils/log","csui/models/command","conws/utils/navigate/navigate.util","conws/utils/contexts/perspective/plugins/node/impl/conws.main.node.extra.data","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,o,n,s,l,a,r){"use strict";var c=new n(t.id),d=t.config();return s.extend({"defaults":{"signature":"ConwsNavigateUp","name":r.CommandNameNavigateUp},"enabled":function(e,t){var i=!1;if(!1!==d.enabled&&l.checkWorkspaceNavigation(e,t).navigateUp&&l.checkWorkspaceHierarchy(e.context).level>0&&e.context.hasModel("node")){var o=e.context.getModel("node");a.getBwsInfo(o,"up")&&(i=l.checkNavigationExtension(e,t).navigation)}return i},"execute":function(e,t){var o=i.Deferred();return e&&(e.suppressSuccessMessage=!0),csui.require(["csui/utils/contexts/factories/next.node","csui/utils/contexts/factories/node"],function(t,i){var n,s=e&&e.context,l=s&&s.getModel(t),a=e.toolItem&&e.toolItem.get("commandData");n=a&&a.nodeid?a.nodeid:s.getModel(i).get("parent_id"),n&&l?(c.debug("navigate to target id {0}",n)&&console.log(c.last),s.viewStateModel&&s.viewStateModel.set("conwsNavigate","gotoLocation"),l.set("id",n),o.resolve(n)):o.resolve()},function(e){o.reject(e)}),o.promise()}})}),csui.define("css!conws/utils/commands/navigate/impl/navigate",[],function(){}),csui.define("conws/utils/commands/navigate/impl/navigateup.arrow.view",["module","csui/lib/underscore","csui/lib/marionette","csui/utils/log","csui/models/commands","csui/controls/toolbar/toolbar.command.controller","csui/controls/toolbar/toolitems.filtered.model","csui/controls/toolbar/toolitems.factory","conws/utils/commands/navigate/impl/flyout.toolitem.view","conws/utils/navigate/navigate.util","conws/utils/commands/navigate/navigateup","i18n!conws/utils/commands/nls/commands.lang","css!conws/utils/commands/navigate/impl/navigate"],function(e,t,i,o,n,s,l,a,r,c,d,u){"use strict";var p=new o(e.id),m=d.extend({"enabled":function(e,t){return!0}});return i.ItemView.extend({"template":!1,"tagName":"ul","className":"csui-toolbar binf-nav binf-nav-pills csui-align-left","constructor":function(){i.ItemView.prototype.constructor.apply(this,arguments),this.options.status.context&&this.options.status.context.hasObject("workspaceContext")&&(this.options.status.context.hasCollection("ancestors")||this.options.status.context.getFactory("ancestors").fetch(),this.listenTo(this.options.status.context.getCollection("ancestors"),"reset sync error",this._reRender))},"_reRender":function(){if(this.toolItemView){var e=this._getAncestorsData();t.isEqual(this.ancestorsData||0,e||0)||this.render()}},"onRender":function(){p.debug("navigateup arrow onrender start")&&console.log(p.last);var e=new m,t=[{"signature":e.get("signature"),"name":u.CommandNameNavigateUp,"toolItemAria":u.CommandNameNavigateUp,"iconName":"conws_action_navigate_up","menuWithMoreOptions":!0,"flyout":"CwsUpFlyout"}];this.ancestorsData=this._getAncestorsData(),void 0===this.ancestorsData?t.push({"signature":e.get("signature"),"name":"...","commandData":{"nodeid":0},"flyout":"CwsUpFlyout"}):this.ancestorsData.forEach(function(i){t.push({"signature":e.get("signature"),"name":i.name,"commandData":{"nodeid":i.id},"flyout":"CwsUpFlyout"})});var i=new a({"main":t}),o=new n([e]),c=new s({"commands":o}),d=new l(i,{"status":this.options.status,"commands":o,"delayedActions":this.options.status.collection&&this.options.status.collection.delayedActions,"mask":void 0}),h={"longPress":!0,"blockingParentView":this.options.blockingParentView,"command":o.at(0),"model":d.at(0),"noMenuRoles":!0,"originatingView":this.options.originatingView,"toolbarCommandController":c,"toolbarItemsMask":void 0,"useIconsForDarkBackground":!1};this.toolItemView=new r(h),this.listenTo(this.toolItemView,"toolitem:action",this._toolItemAction),this.listenTo(this.toolItemView,"childview:toolitem:action",this._toolItemChildAction),this.toolItemView.render(),this.toolItemView.makeFocusable(),this.$el.empty(),this.$el.append(this.toolItemView.$el),p.debug("navigateup arrow onrender done")&&console.log(p.last)},"_getAncestorsData":function(){var e=[],t=this.options.status;if(t.context&&t.context.hasCollection("ancestors")){var i=c.checkWorkspaceHierarchy(t.context).wkspid;if(i){var o=t.context.getCollection("ancestors");if(!o.error)if(o.fetched&&o.length&&o.at(-1).get("id")===o.node.get("id"))for(var n=o.length-2;n>=0;n--){var s=o.at(n);if(e.unshift({"name":s.get("name"),"id":s.get("id")}),s.get("id")===i)break}else e=void 0}}return e},"_toolItemAction":function(e){var t=e.toolItem.get("commandData");t&&t.nodeid||this._toolItemViewAction(this.toolItemView,e)},"_toolItemChildAction":function(e,t){var i=t.toolItem.get("commandData");i&&i.nodeid&&this._toolItemViewAction(e,t)},"_toolItemViewAction":function(e,t){var i={"context":this.options.status.context,"nodes":this.options.status.nodes,"container":this.options.status.container,"collection":this.options.status.collection,"originatingView":this.options.status.originatingView,"toolItemView":e};this.options.toolbarCommandController.toolitemClicked(t.toolItem,i)}})}),csui.define("conws/utils/commands/navigate/toolbaritems",["conws/utils/commands/navigate/impl/navigateup.arrow.view","i18n!conws/utils/commands/nls/commands.lang"],function(e,t){return{"navigationToolbar":[{"signature":"ConwsNavigateUp","name":t.CommandNameNavigateUp,"toolItemAria":t.CommandNameNavigateUp,"iconName":"conws_action_navigate_up","customView":!0,"viewClass":e,"group":"main"}]}}),csui.define("conws/utils/commands/permissions/permissions.dropdown.menu.items.extension",["i18n!conws/utils/commands/nls/commands.lang"],function(e){"use strict";return{"dropdownMenuList":[{"signature":"AddOrEditRole","name":e.CommandNameAddRole}]}}),csui.define("conws/utils/commands/permissions/permissions.list.toolbaritems.extension",["i18n!conws/utils/commands/nls/commands.lang"],function(e){"use strict";return{"inlineToolbar":[{"signature":"AddOrEditRole","name":e.CommandNameEditRole,"iconName":"csui_action_view_column32"},{"signature":"DeleteRole","name":e.DeleteRoleTitleSingle,"iconName":"csui_action_delete32"},{"signature":"EditRolePermission","name":e.ToolbarItemEditRolePermission,"iconName":"csui_action_edit32"}]}}),csui.define("conws/controls/treebrowse/workspace.navigation.tree.plugin",["module","csui/lib/underscore","csui/utils/log","conws/utils/navigate/navigate.util"],function(e,t,i,o){"use strict";var n=(new i(e.id),e.config());return{"enabled":function(e,t){var i=!1;return!1!==n.enabled&&o.checkWorkspaceNavigation(e,t).treeView&&o.checkWorkspaceHierarchy(e.context).level>=0&&(i=o.checkNavigationExtension(e,t).navigation),i},"data":function(e,t){var i={};return o.checkWorkspaceHierarchy(e.context).level>=0&&(i.rootNodes=[o.getWorkspaceModel(e.context)]),i}}}),csui.define("conws/controls/navigation.header/conws.add.navigation.header.controls",[],function(){return{"id":"conws/widgets/navigation.header/controls/create.workspace/create.workspace.view","sequence":150,"parentClassName":"conws-create-workspace"}}),csui.define("conws/utils/commands/addbwsfromsidepanel",["module","require","csui/lib/jquery","csui/lib/underscore","csui/utils/commandhelper","csui/models/command","csui/dialogs/modal.alert/modal.alert","csui/utils/log","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,o,n,s,l,a,r){"use strict";var c,d=e.config(),u={"enabled":function(){return d}};return s.extend({"defaults":{"signature":"AddBWSFromSidePanel","name":r.CommandNameCreateConnectedWorkspace,"scope":"single"},"enabled":function(){return u.enabled()},"visible":function(){return c},"execute":function(e){var t=i.Deferred(),s=e.context;return csui.require(["csui/lib/backbone","csui/utils/contexts/factories/connector","csui/controls/side.panel/side.panel.view","csui/widgets/metadata/metadata.action.one.item.properties.view","csui/utils/commands","csui/models/nodes","csui/models/node/node.model","csui/controls/list/emptylist.view","doctemplates/dialogs/instance.from.template/select.template.view","conws/models/workspacecreateforms","conws/models/metadata.controller","csui/controls/globalmessage/globalmessage","csui/behaviors/default.action/default.action.behavior","csui/utils/contexts/factories/next.node","conws/models/addbwsfromsidepanel/addbwsfromsidepanel.model.factory"],function(i,d,u,p,m,h,g,f,w,v,b,y,k,x,C){function _(t){var i=o.str.sformat(r.BusinessWorkspaceSuccessfullyCreated,t.get("name")),n={"context":e.context,"nextNodeModelFactory":x,"link_url":k.getDefaultActionNodeUrl(t),"link_label":r.CommandMessageOpen,"targetFolder":t};y.showMessage("success_with_link",i,void 0,n)}function T(t){e.context.getModel(x).set("id",t.get("id"))}function S(e,t,i){var o=t.at(0);if(!e.get("id")){var n=o.get("data");if(n){var s=n.name,l=n.parent_id;a.debug("name fetched and used: {0}",s)&&console.log(a.last),e.set("name",s),e.set("parent_id",l);var c=new g({"id":l});i.metadataPropertiesView.options.container=c}else a.debug("name set to empty.")&&console.log(a.last),e.set("name","")}var d=i&&i.metadataHeaderView,u=d&&d.metadataItemNameView;if(u){var p=o.get("schema"),m=!!(p&&p.properties&&p.properties.name&&p.properties.name.readonly),h=m?r.nameIsGeneratedAutomatically:void 0;u.setPlaceHolder(h),m&&i&&i.metadataPropertiesView&&i.metadataPropertiesView.once("render:forms",function(){this.options.metadataView.metadataHeaderView.metadataItemNameView.$el.find("span.title").removeAttr("role");var e=this.currentlyFocusedElement();e&&e.trigger("focus")})}}var R,V,M,I,P,E={},N=s.getObject(d),D=new b(void 0,void 0),A=[],O=[],F=s&&s.getCollection(C,{"detached":!0,"permanent":!0,"connector":N});F.fetch().then(function(){if((R=F.models[0].attributes)&&R.results&&R.results.length>0){R=R.results,R.forEach(function(e){if(void 0!==e.data&&void 0!==e.data.properties){var t=[],i=e.data.wksp_info&&e.data.wksp_info.wksp_type_icon;t={"wksp_type_id":e.data.properties.wksp_type_id,"wksp_type_name":e.data.properties.wksp_type_name,"rm_enabled":e.data.properties.rm_enabled},void 0!==e.data.properties.templates&&e.data.properties.templates.length>0&&e.data.properties.templates.forEach(function(e){var o={"id":e.id,"name":e.name,"type":e.subtype,"wksp_type":t,"type_name":r.BusinessWorkspaceTypeName,"image_url":i};A.push(o)})}}),A.length&&(A=o.sortBy(A,function(e){return e.name.toLowerCase()}));var d=e.data||{},b=d.groupName||r.AvailableBWSTemplate,y=d.title||r.CreateBusinessWorkspace,k=d.subtitle||"",x=d.size,C=d.resize;O[0]={"id":1,"name":b,"templates":A},V=new w({"context":s,"templatesGroup":O});var B=new g({"type":848},{"connector":N});e.nodes=new h([B]);var L=n.getAtLeastOneNode(e),j=L.length>0?L.models[0]:null;M=new v(void 0,{"node":B,"type":848,"wsType":0}),I=new p({"model":j,"connector":N,"container":e.container||void 0,"context":s,"commands":m,"action":"create","formCollection":M});var W=new u({"slides":[{"title":y,"subTitle":k,"content":V,"footer":{"buttons":[{"label":r.sidePanelNextButton,"type":"next","id":"continue-btn","disabled":!1,"className":"binf-btn binf-btn-primary"}]}},{"title":r.CreateBusinessWorkspace,"content":I,"footer":{"buttons":[{"className":"binf-btn binf-btn-primary"}]}}],"sidePanelClassName":"template-in-sidepanel","layout":{"size":x,"resize":C}});if(V.listenTo(V,"template:selected",function(e){E=e||{},W.trigger("update:button","continue-btn",{"disabled":!1})}),V.listenTo(V,"template:unselected",function(){W.trigger("update:button","continue-btn",{"disabled":!0})}),V.listenTo(V,"templates:rendered",function(){W.ui.header&&W.ui.header.find(".csui-sidepanel-close").trigger("focus")}),I.listenTo(I,"update:button",o.bind(function(e){W.slides[1].footer.buttons[0].label=r.sidePanelCreateButton,W.slides[1].footer.buttons[0].type="action",W.slides[1].footer.buttons[0].id="create-btn",W.trigger("update:button","create-btn",e)},this)),W.listenTo(I,"button:click",function(e){if("create-btn"===e.id){if(I.validate()){var i=I.getValues();I.metadataPropertiesView.blockActions(),D.createItem(j,i).done(o.bind(function(){I.metadataPropertiesView.unblockActions(),t.resolve({"name":i.name}),W.hide(),j.attributes.direct_open?T(j):_(j)},this)).fail(o.bind(function(e){I.metadataPropertiesView.unblockActions();var t=r.failedToCreateItem;e&&(e.responseJSON&&e.responseJSON.error?t=e.responseJSON.error:e.responseText&&(t=e.responseText),l.showError(t))},this))}}}),W.listenTo(I,"button:click",function(e){"back"===e.type&&(I.model.newCategories=new i.Collection)}),W.listenTo(V,"button:click",function(e){if("continue-btn"===e.id&&P!==E){P=E,I.metadataPropertiesView.$el&&(I.metadataPropertiesView.$el.hide(),I.metadataPropertiesView.once("render:forms",function(){I.metadataPropertiesView.$el.show()}));var t={"sidePanel":W,"metadataAddItemPropView":I.metadataPropertiesView,"metadataController":D};delete M.bo_type_id,delete M.bo_id,M.options.metadataAddItemController=t,M.options.wsType=E.wksp_type.wksp_type_id,I.metadataPropertiesView.allForms.formCollection=M,M.on("sync",function(){S(B,M,I)}),M.on("error",function(e){W.trigger("update:button","create-btn",{
"disabled":!0});var t=e&&e.error.message||r.errorGettingCreateForm;a.error("Fetching the create forms failed: {0}",t)&&console.error(a.last),l.showError(t),P=void 0,delete e._events.error}),M.options.template=E,D.options.template=E,W.slides[1].title=o.str.sformat(r.sidePanelTitle,E.name||r.BusinessWorkspace);var i=848===E.type?r.BusinessWorkspaceTypeName:"";B.set({"name":E.name,"type_name":i,"rm_enabled":E.wksp_type.rm_enabled}),I.firstFocusCalled=void 0,I.metadataPropertiesView.allForms.fetch()}}),W.listenTo(W,"after:show",function(){V.trigger("dom:refresh"),W.trigger("update:button","continue-btn",{"disabled":!0})}),W.listenTo(W,"before:show",function(){c=!0}),W.listenTo(W,"before:hide",function(){c=!1,t.resolve()}),0===A.length){var $=new f({"text":r.noResults});W.slides[0].content=$}W.show();e.originatingView.$el.append(W.$el)}},function(e){t.reject(e)})},function(e){t.reject(e)}),t.promise()}})}),csui.define("conws/widgets/navigation.header/controls/create.workspace/impl/nls/localized.strings",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/navigation.header/controls/create.workspace/impl/nls/root/localized.strings",{"CreateWorkspaceIconTitle":"Create Business Workspace","createWorkspaceTitleAria":"Create Business Workspace"}),csui.define("hbs!conws/widgets/navigation.header/controls/create.workspace/impl/create.workspace",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="csui-icons">\r\n  <div class="conws-create-workspace-icon-container" title="'+e.escapeExpression((s=null!=(s=l(i,"title")||(null!=t?l(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":2,"column":60},"end":{"line":2,"column":69}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"createWorkspaceTitleAria")||(null!=t?l(t,"createWorkspaceTitleAria"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"createWorkspaceTitleAria","hash":{},"loc":{"start":{"line":2,"column":83},"end":{"line":2,"column":111}}}):s))+'" role="button" aria-haspopup="true" aria-expanded="false">\r\n    <span class="conws-icon-create-workspace create-workspace_header_icon"></span>\r\n  </div>\r\n</div>\r\n<div class="conws-create-workspace-view-container"></div>'}});return i.registerPartial("conws_widgets_navigation.header_controls_create.workspace_impl_create.workspace",o),o}),csui.define("css!conws/widgets/navigation.header/controls/create.workspace/impl/create.workspace",[],function(){}),csui.define("conws/widgets/navigation.header/controls/create.workspace/create.workspace.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","conws/utils/commands/addbwsfromsidepanel","csui/behaviors/keyboard.navigation/tabable.region.behavior","i18n!conws/widgets/navigation.header/controls/create.workspace/impl/nls/localized.strings","hbs!conws/widgets/navigation.header/controls/create.workspace/impl/create.workspace","css!conws/widgets/navigation.header/controls/create.workspace/impl/create.workspace"],function(e,t,i,o,n,s,l){"use strict";return i.LayoutView.extend({"className":"conws-create-workspace-view","template":l,"templateHelpers":function(){return{"title":s.CreateWorkspaceIconTitle,"createWorkspaceTitleAria":s.createWorkspaceTitleAria}},"regions":{"CreateWorkspaceViewContainerRegion":".conws-create-workspace-view-container"},"ui":{"createBWSIcon":".create-workspace_header_icon","createBWSIconContainer":".conws-create-workspace-icon-container","createWorkspaceViewContainer":".conws-create-workspace-view-container"},"events":{"click @ui.createBWSIcon":"CreateBWSHeaderIconClicked","keydown":"onKeyInView"},"behaviors":{"TabableRegionBehavior":{"behaviorClass":n}},"currentlyFocusedElement":".conws-create-workspace-icon-container","constructor":function(e){i.LayoutView.call(this,e),this.buttonEnabled=!0,this.context=e.context,this.addworkspaceCommand=new o,this.config=this.addworkspaceCommand.enabled()},"onRender":function(){this.config.enabled?this.$el.removeClass("binf-hidden"):e(".conws-create-workspace").addClass("binf-hidden")},"_showQuickWSCreationSidePanel":function(){this.buttonEnabled=!1,this.options&&this.options.parentView&&this.options.parentView.trigger("header:control:clicked"),this.addworkspaceCommand.execute({"context":this.context,"originatingView":this,"data":{"size":"medium","resize":!1}}).always(t.bind(function(){this.buttonEnabled=!0},this))},"CreateBWSHeaderIconClicked":function(){!0===this.buttonEnabled&&this._showQuickWSCreationSidePanel()},"onKeyInView":function(e){switch(e.keyCode){case 13:case 32:!this.addworkspaceCommand.visible()&&this.ui.createBWSIconContainer.is(":focus")&&!0===this.buttonEnabled&&this._showQuickWSCreationSidePanel()}}})}),csui.define("conws/controls/breadcrumbspanel/breadcrumbspanel.extension",["module","csui/utils/log","conws/utils/commands/navigate/navigable","conws/utils/navigate/navigate.util"],function(e,t,i,o){"use strict";function n(e){var t=e&&e.perspective,i=t&&t.get("options");return!!(i&&i.header&&i.header.widget)}var s=new t(e.id);return{"hideBreadcrumbs":function(e){var t=!1;if(i.wantsBackToPrevious()){var l=e&&e.context;n(l)&&o.checkWorkspaceHierarchy(l).wkspid&&(t=!0)}return s.debug("breadcrumbspanel.extension hideBreadcrumbs: {0}",t)&&console.log(s.last),t}}}),csui.define("conws/utils/context.help/context.help.ids",["conws/utils/navigate/navigate.util"],function(e){"use strict";return[{"sequence":50,"decides":function(t){return"node"===t.context.getModel("applicationScope").id&&e.checkWorkspaceHierarchy(t.context).level>=0},"contextHelpId":function(e){return"ugd-cws"}}]}),csui.define("conws/widgets/header/impl/headertoolbaritems.masks",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,t,i,o){"use strict";function n(e){var n;this.toolbars=t.reduce(s,function(t,s){(n=t[s])||(n=new o);var l=new i(n,{"normalize":!1}),a=e[s];return a&&l.extendMask(a),l.storeMask(),t[s]=l,t},{})}var s=["rightToolbar","delayedActionsToolbar"];return n.toolbars=s,n}),csui.define("conws/utils/commands/addconws",["require","csui/lib/jquery","csui/lib/underscore","csui/utils/base","csui/utils/log","csui/models/command","csui/models/node/node.model","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,o,n,s,l,a){function r(e,t,i){var o=t.at(0);if(!e.get("id")){var s=o.get("data");if(s){var l=s.name;n.debug("name fetched and used: {0}",l)&&console.log(n.last),e.set("name",l)}else n.debug("name set to empty.")&&console.log(n.last),e.set("name","")}var r=i.metadataAddItemPropView,c=r&&r.metadataHeaderView,d=c&&c.metadataItemNameView;if(d){var u=o.get("schema"),p=!!(u&&u.properties&&u.properties.name&&u.properties.name.readonly),m=p?a.nameIsGeneratedAutomatically:void 0;d.setPlaceHolder(m),p&&r&&r.metadataPropertiesView&&r.metadataPropertiesView.once("render:forms",function(){this.options.metadataView.metadataHeaderView.metadataItemNameView.$el.find("span.title").removeAttr("role");var e=this.currentlyFocusedElement();e&&e.trigger("focus")})}}return s.extend({"defaults":{"signature":"AddConnectedWorkspace","name":a.CommandNameAddConnectedWorkspace,"verb":"create","doneVerb":"created","scope":"single"},"enabled":function(e){return!0},"execute":function(e,s){var c=t.Deferred(),d=e.data||{},u=e.container||{},p=d.wsType||{},m=d.template||{},h=d.subType,g=d.subTypeName,f=new l({"type":h,"type_name":g,"container":!0,"name":"","parent_id":u.attributes.id,"rm_enabled":p.rm_enabled,"sub_folder_id":0},{"connector":e.container.connector});return e.suppressSuccessMessage=!0,csui.require(["csui/models/nodes","csui/widgets/metadata/metadata.add.item.controller","csui/dialogs/modal.alert/modal.alert","csui/controls/globalmessage/globalmessage","conws/models/workspacecreateforms","conws/models/metadata.controller","csui/behaviors/default.action/default.action.behavior","csui/utils/contexts/factories/next.node"],function(t,d,u,g,w,v,b,y){function k(){var e=V.dialog;e&&e.$el&&(e.$el.addClass("conws-initializing"),S.off(null,k))}function x(){var e=V.dialog;e&&e.$el&&(e.$el.removeClass("conws-initializing"),S.off(null,x))}function C(){var t=i.str.sformat(a.BusinessWorkspaceSuccessfullyCreated,f.get("name")),o={"context":e.context,"nextNodeModelFactory":y,"link_url":b.getDefaultActionNodeUrl(f),"link_label":a.CommandMessageOpen,"targetFolder":f};g.showMessage("success_with_link",t,void 0,o)}function _(){var t=!1;if(e.collection.forEach(function(e){e.get("id")===f.get("id")&&(e.set(f.attributes),t=!0)}),!t){var i=e.collection.node.get("id"),o=f.get("parent_id"),n=f.get("sub_folder_id");if(i===o||i===-o)e.collection.add(f,{"at":0});else if(i!==n&&0!==n){var s=new l({"id":n},{"connector":e.container.connector,"collection":e.collection});s.fetch({"success":function(){s.get("parent_id")===i&&void 0===e.collection.findWhere({"id":s.get("id")})&&(s.isLocallyCreated=!0,e.collection.add(s,{"at":0})),C()},"error":function(e){u.showError(a.ErrorAddingSubfolderToNodesTable),C()}})}else C()}}function T(){e.context.viewStateModel.set("conwsNavigate","browseView"),e.context.getModel(y).set("id",f.get("id"))}e.nodes=new t([f]),s=i.extend({"formCollection":s.formCollection||new w(void 0,{"node":e.container,"type":h,"wsType":p,"template":m}),"metadataController":s.metadataController||new v(void 0,{"type":h,"wsType":p,"template":m,"collection":e.collection})},s),s.dialogTitle=i.str.sformat(a.AddConwsMetadataDialogTitle,m.name||a.BusinessWorkspace),s.addButtonTitle=a.AddConwsMetadataDialogAddButtonTitle;var S=s.formCollection,R=S.options||(S.options={}),V=R.metadataAddItemController||(R.metadataAddItemController=new d);S.on("request",function(){var e=V.dialog;e&&e.$el&&e.$el.addClass("conws-add-workspace")}),S.once("request",k),S.once("sync",x),S.once("error",x),S.on("sync",function(){r(f,S,V)}),S.on("error",function(e,t,i){var s=t&&new o.Error(t).message||a.errorGettingCreateForm;n.error("Fetching the create forms failed: {0}",s)&&console.error(n.last),u.showError(s)}),V.displayForm(e,s).then(function(){f.isLocallyCreated=!0,f.attributes.direct_open?T():_(),c.resolve.apply(c,arguments)}).fail(function(e){e instanceof Error?c.reject(e):c.reject()}),e.metadataAddItemController=V},function(e){c.reject(e)}),c.promise()}})}),csui.define("conws/utils/commands/addconwstemplate",["require","csui/lib/jquery","csui/lib/underscore","csui/utils/base","csui/utils/log","csui/models/command","csui/models/node/node.model","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,o,n,s,l,a){return s.extend({"defaults":{"signature":"AddCONWSTemplate","name":a.CommandNameAddCONWSTemplate,"scope":"single"},"enabled":function(e){var t=e.data&&e.data.addableTypes&&e.data.addableTypes.node,i=t&&t.get("data"),o=i&&i.doctemplates_info,n=i&&i.bwsinfo;return!(!o||!n||n.id)&&o.isInDocTemplateVolTree},"execute":function(e,i){var o=t.Deferred(),n=i.addableType,s=i.addableTypeName,a=new l({"type":n,"type_name":s,"container":!0,"name":"","parent_id":e.container.attributes.id,"is_doctemplate":!0},{"connector":e.container.connector});return e.forwardToTable=!0,o.resolve(a),o.promise()}})}),csui.define("conws/utils/commands/move",["csui/lib/jquery","csui/lib/underscore","csui/utils/commands/move","csui/utils/url","csui/dialogs/modal.alert/modal.alert","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,o,n,s){var l=i.extend({"getExternalBodyParams":function(t,i){var l=e.Deferred(),a=this;return csui.require(["csui/controls/dialog/dialog.view","conws/dialogs/regen.reference/regen.reference.view"],function(e,r){var c=new o(t.connection.url).getApiBase("v2"),d={};d.nodeId_list=i;var u=o.combine(c+"canregenerateref"),p={"type":"POST","url":u,"data":d,"success":function(t,i,o){if(t.results.canRegenReference){a._view=new r;var n=new e({"headerView":"","view":a._view,"className":"conws-regen-ref-boolean-dialog","buttons":[{"label":s.apply,"default":!0,"close":!0}]});n.listenTo(n,"destroy",function(){a.externalBodyParams=a._view.model.toJSON(),l.resolve(a.externalBodyParams)}),n.show()}else l.resolve({"ref_regen":!1})},"error":function(e,t,i){var o=e.responseJSON?e.responseJSON.errorDetail?e.responseJSON.errorDetail:e.responseJSON.error:s.defaultErrorGenerateNumber;n.showError(o)}};t.extendAjaxOptions(p),t.makeAjaxCall(p)},function(e){console.log("Error while loading Dialog modules ",e)}),l.promise()}});return i.prototype=l.prototype,i}),csui.define("conws/utils/commands/delete",["csui/lib/jquery","csui/lib/underscore","csui/utils/commands/delete"],function(e,t,i,o){var n=i.prototype.enabled,s=i.extend({"enabled":function(e){return(void 0===e.container||854!==e.container.get("type"))&&n.call(this,e)}});return i.prototype=s.prototype,i}),csui.define("conws/utils/commands/permissions/addoreditrole",["require","csui/lib/underscore","csui/lib/jquery","csui/utils/base","csui/models/command","conws/utils/commands/permissions/permissions.util","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,o,n,s,l){"use strict";var a;return n.extend({"defaults":{"signature":"AddOrEditRole","name":l.CommandNameAddRole},"enabled":function(e){var t=e.nodeModel||e.originatingView&&e.originatingView.model;return!!s.isWorkspace(t)&&(!!e.nodeModel||!(e.nodeModel||!e.model||!s.isWorkspaceRole(e.model)||s.isInheritedRole(t,e.model)))},"execute":function(e,n){var r=this,c=i.Deferred();e.context||n&&n.context;return e.addrole=!!e.nodeModel,e.suppressSuccessMessage=!0,csui.require(["csui/models/permission/nodepermission.model","csui/controls/globalmessage/globalmessage"],function(d){if(a=arguments[1],!e.addrole&&e.model){e.model.action="fetch",e.model.nodeId=e.originatingView&&e.originatingView.model&&e.originatingView.model.get("id");var u=s.getUrl(e.model);e.model.fetch({"url":u}).done(function(){e.model.get("results")&&e.model.get("results").data&&e.model.get("results").data.members&&e.model.get("results").data.properties&&(e.model.set("members",e.model.get("results").data.members),e.model.get("right_id_expand").name=e.model.get("results").data.properties.name,e.model.get("right_id_expand").description=e.model.get("results").data.properties.description,e.model.get("right_id_expand").team_lead=e.model.get("results").data.properties.leader),e.model.unset("links"),e.model.unset("results"),e.model.unset("addEmptyAttribute"),r._selectAddOrEditRoleOptions(e,n).done(function(n){var l={"name":n.role_name,"description":n.role_description,"leader":n.team_lead};n.permissions&&(l.permissions=n.permissions,l.apply_to=n.apply_to,l.include_sub_types=n.apply_to>0?[204,207,215,298,3030202]:[]),n.participants&&(l.members=n.participants),e.model.action="update",u=s.getUrl(e.model),e.model.save(l,{"url":u,"patch":!0,"wait":!0,"silent":!0}).done(function(){var o=e.model.get("right_id_expand");if(o.name!==n.role_name){var l=t.find(e.model.collection.extraMemberModels,{"id":e.model.get("right_id")});l&&(l.set("name",n.role_name),l.set("name_formatted",n.role_name))}if(o.name=n.role_name,o.name_formatted=n.role_name,o.description=n.role_description,o.team_lead=n.team_lead,n.team_lead){var d=e.nodeModel||e.originatingView&&e.originatingView.model;i.each(e.model.collection.models,function(e,t){s.isWorkspaceRole(t)&&!s.isInheritedRole(d,t)&&(t.get("right_id_expand").leader_id=o.id)}),o.leader_id=o.id,i.each(e.model.collection.extraMemberModels,function(e,t){s.isWorkspaceRole(t)&&!s.isInheritedRole(d,t)&&t.set("leader_id",o.id)})}n.permissions&&n.apply_to&&(o.permissions=n.permissions,e.model.set("permissions",n.permissions),o.apply_to=n.apply_to),n.participants&&n.participants.length>0&&(o.members=n.participants,e.model.set("members",n.participants)),e.model.set({"right_id_expand":o,"type":"custom"},{"silent":!0}),a.showMessage("success",r._getMessageWithRoleName(e.model)),e.originatingView&&e.originatingView.unblockActions&&e.originatingView.unblockActions(),e.originatingView&&e.originatingView.permissionsContentView&&e.originatingView.permissionsContentView.permissionsListView&&e.originatingView.permissionsContentView.permissionsListView.trigger("update:table",e.model),c.resolve(e.model)}).fail(function(t){var i=new o.Error(t);e.originatingView&&e.originatingView.unblockActions&&e.originatingView.unblockActions(),a.showMessage("error",i),c.reject(e.model,i)})}).fail(function(e){c.reject(e)})}).fail(function(e){c.reject(e)})}else e.isWorkspaceRoleExists=e.permissionCollection.models.some(function(t){return s.isWorkspaceRole(t)&&!s.isInheritedRole(e.nodeModel,t)},this),r._selectAddOrEditRoleOptions(e,n).done(function(n){var u=void 0!==n.apply_to?n.apply_to:2,p={"name":n.role_name,"description":n.role_description,"leader":n.team_lead,"members":n.participants,"permissions":void 0!==n.permissions?n.permissions:d.getReadPermissions(),"apply_to":u,"include_sub_types":u>0?[204,207,215,298,3030202]:[]},m=new d(p,e);m.unset("addEmptyAttribute"),m.action="create",m.nodeId=e.nodeId,e.originatingView&&e.originatingView.blockActions&&e.originatingView.blockActions();var h=s.getUrl(m);m.save(p,{"url":h,"silent":!0,"wait":!0}).done(function(o){var d,u=o.results&&o.results.data&&o.results.data.properties,p=u&&u.id,h=u&&u.leader,g=e.nodeModel||e.originatingView&&e.originatingView.model;if(h)i.each(e.permissionCollection.models,function(e,t){s.isWorkspaceRole(t)&&!s.isInheritedRole(g,t)&&(t.get("right_id_expand").leader_id=p)}),i.each(e.permissionCollection.extraMemberModels,function(e,t){s.isWorkspaceRole(t)&&!s.isInheritedRole(g,t)&&t.set("leader_id",p)});else{var f=t.filter(e.permissionCollection.models,function(e){return s.isWorkspaceRole(e)&&s.isLeaderRole(g,e)});d=f.length&&f[0].get("right_id_expand").leader_id}m.set({"right_id_expand":{"id":p,"initials":n.role_name[0],"leader_id":h?p:d,"name":n.role_name,"name_formatted":n.role_name,"type":848,"node_id":e.nodeId,"type_name":l.BusinessWorkspaceRole},"type":"custom","right_id":p},{"silent":!0}),a.showMessage("success",r._getMessageWithRoleName(m)),e.originatingView&&e.originatingView.unblockActions&&e.originatingView.unblockActions(),c.resolve(m)}).fail(function(t){var i=new o.Error(t);e.originatingView&&e.originatingView.unblockActions&&e.originatingView.unblockActions(),a.showMessage("error",i),c.reject(m,i)})}).fail(function(e){c.reject(e)})},function(e){c.reject(e)}),c.promise()},"_selectAddOrEditRoleOptions":function(e,t){var o=i.Deferred();return csui.require(["conws/dialogs/addoreditrole/addoreditrole.wizard"],function(t){new t({"command":"addoreditrole","context":e.context,"connector":e.connector,"dialogClass":"cs-permission-role-picker","displayName":e.addrole?l.CommandNameAddRole:l.CommandNameEditRole,"dialogTitle":e.addrole?l.CommandNameAddRole:l.CommandNameEditRole,"addrole":e.addrole,"nodeModel":e.addrole?e.nodeModel:e.originatingView.model,"model":e.model,"addButtonLabel":l.AddButtonLabel,"availablePermissions":e.addrole?e.permissionCollection.availablePermissions:e.originatingView.collection,"applyTo":e.applyTo,"isFirstRole":!e.isWorkspaceRoleExists}).show().done(function(){o.resolve.apply(o,arguments)}).fail(function(e){o.reject.apply(o,arguments)})},function(e){o.reject(e)}),o.promise()},"_getMessageWithRoleName":function(e){var i;return e.get("right_id_expand")&&(i=o.formatMemberName(e.get("right_id_expand"))),e.action&&"update"===e.action?t.str.sformat(l.EditRoleSuccess,i):t.str.sformat(l.AddRoleSuccess,i)}})}),csui.define("conws/utils/workspaces/busyindicator",[],function(){"use strict";function e(e,t){this.on_fct=e,this.off_fct=t}function t(t,i){if(t.busyIndicator)t.busyIndicator[i]();else{var o=t.originatingView;o&&o.blockActions&&o.unblockActions&&(t.busyIndicator=new e(function(){o.blockActions()},function(){o.unblockActions()}),t.busyIndicator[i]())}}return e.on=function(e){t(e,"on")},e.off=function(e){t(e,"off")},e.prototype.on=function(){this.busy||(this.busy=!0,this.on_fct())},e.prototype.off=function(){this.busy&&(this.busy=!1,this.off_fct())},e}),csui.define("conws/utils/commands/addrelateditem",["require","csui/lib/underscore","csui/lib/jquery","i18n!conws/utils/commands/nls/commands.lang","csui/models/action","csui/models/command","conws/utils/workspaces/busyindicator"],function(e,t,i,o,n,s,l){"use strict";function a(e){var t,i=e.collection&&e.collection.workspace;return i&&i.actions&&(t=i.actions.get?i.actions.get("add-relitem"):i.actions["add-relitem"]),t}return s.extend({"defaults":{"signature":"AddRelation","command_key":["add-relitem"],"scope":"multiple","name":o.CommandNameAddRelatedItem,"verb":o.CommandVerbAddRelatedItem,"successMessages":{"formatForNone":o.AddRelatedItemsNoneMessage,"formatForOne":o.AddOneRelatedItemSuccessMessage,"formatForTwo":o.AddSomeRelatedItemsSuccessMessage,"formatForFive":o.AddManyRelatedItemsSuccessMessage}},"enabled":function(e){var t=!1;return e.data&&e.data.submit?e.nodes&&e.nodes.length&&(t=!!a(e)):t=!!a(e),t},"execute":function(e,t){return e.suppressSuccessMessage=!0,e.data&&e.data.submit?this.submitNodes(e,t):this.openSearch(e,t)},"submitNodes":function(e,t){var o=this,n=i.Deferred();return e.suppressSuccessMessage=!0,l.on(e),n.always(function(){l.off(e)}),csui.require(["csui/lib/underscore","csui/utils/base","csui/utils/url","csui/controls/globalmessage/globalmessage"],function(t,i,s,l){var r=function(e){var i,o,n,l=e.nodes,r=[],c=a(e);if(l&&c&&l.each(function(e){i=e.connector,o=e.get("name");var n=c.href||c.get("href"),l=n.match(/^\/?api\/v([0-9\.])+\/([^?#]+)/i),a=t.extend(s.urlParams(n),{"rel_bw_id":e.get("id"),"rel_type":e.get("rel_type")}),d={"apiCall":l&&l.length>=3?l[2]:n,"params":{"fRequestArgs":a,"fVersionNumber":l&&l.length>=2?parseInt(l[1]):2,"fParamTicket":"","fParamMethod":c.method||c.get("method"),"fCallName":n}};r.push(d)}),i){var d=i.getConnectionUrl(),u=d.getCgiScript(),p=s.combine(u,"/api/v1/csui/batch"),m=new FormData;m.append("body",JSON.stringify({"exitOnError":!0,"calls":r})),n={"url":p,"method":"POST","data":m,"contentType":!1,"processData":!1}}return{"connector":i,"name":o,"data":n,"count":r.length}}(e);r.count?r.connector.makeAjaxCall(r.data).done(function(t){var s=i.formatMessage(t.calls.length,o.get("successMessages"),r.name);n.resolve(e.nodes),l.showMessage("success",s),e.originatingView&&e.originatingView.trigger("cmd:success",o.get("signature"),e.nodes)}).fail(function(t){var i=t.responseJSON?t.responseJSON.error:t.statusText,s=new Error(i);s.suppressFailMessage=!0,n.reject(s),l.showMessage("error",i),e.originatingView&&e.originatingView.trigger("cmd:failure",o.get("signature"),s)}):n.resolve()},n.reject),n.promise()},"openSearch":function(e,s){var l=this,r=i.Deferred();return e.suppressSuccessMessage=!0,a(e)?csui.require(["conws/widgets/relatedworkspaces/addrelatedworkspaces.search"],function(i){var s=new i({"title":l.get("name"),"signature":l.get("signature"),"status":e});e.originatingView.on("destroy",function(){s.destroy()});var a;s.searchView.on("go:back",function(){s.destroy(),a?(a.suppressFailMessage=!0,r.reject(a)):r.resolve()}),s.searchView.on("cmd:success",function(e,i){e===l.get("signature")&&(a=void 0,s.close(),s.destroy(),i.each(function(e){var i=e.get("rel_source"),s=e.get("id"),l=e.get("rel_type"),a=t.str.sformat("/api/v2/businessworkspaces/{0}/relateditems/{1}?rel_type={2}",i,s,l),r=new n({"body":"","content_type":"","form_href":"","href":a,"method":"DELETE","name":o.ServerCommandNameDeleteRelatedItem,"signature":"deleterelateditem"},{"connector":e.connector});e.actions.add(r)}),r.resolve(i.models))}),s.searchView.on("cmd:failure",function(e,t){e===l.get("signature")&&(a=t)}),s.show()},r.reject):r.resolve(),r.promise()}})}),csui.define("conws/utils/commands/deleterelateditem",["require","csui/lib/jquery","i18n!conws/utils/commands/nls/commands.lang","csui/models/command","conws/utils/workspaces/busyindicator"],function(e,t,i,o,n){"use strict";return o.extend({"defaults":{"signature":"RemoveRelation","command_key":["deleterelateditem"],"scope":"multiple","name":i.CommandNameDeleteRelatedItem,"verb":i.CommandVerbDeleteRelatedItem,"confirmMessages":{"formatForOne":i.DeleteOneRelatedItemConfirmMessage,"formatForTwo":i.DeleteSomeRelatedItemsConfirmMessage,"formatForFive":i.DeleteManyRelatedItemsConfirmMessage},"successMessages":{"formatForNone":i.DeleteRelatedItemsNoneMessage,"formatForOne":i.DeleteOneRelatedItemSuccessMessage,"formatForTwo":i.DeleteSomeRelatedItemsSuccessMessage,"formatForFive":i.DeleteManyRelatedItemsSuccessMessage}},"enabled":function(e){if(e.nodes&&e.nodes.length){return!e.nodes.find(function(e){if(!e.actions||!e.actions.get("deleterelateditem"))return e})}return!1},"execute":function(e,i){var o=this,s=t.Deferred();return e.suppressSuccessMessage=!0,n.on(e),s.always(function(){n.off(e)}),csui.require(["csui/lib/underscore","csui/utils/base","csui/utils/url","csui/dialogs/modal.alert/modal.alert","csui/controls/globalmessage/globalmessage"],function(t,i,l,a,r){var c=function(e){var t,i,o,n=e.nodes,s=[];if(n&&n.each(function(e){var o=e.actions.get("deleterelateditem");if(o){t=e.connector,i=e.get("name");var n=o.get("href"),a=n.match(/^\/?api\/v([0-9\.])+\/([^?#]+)/i),r={"apiCall":a&&a.length>=3?a[2]:n,"params":{"fRequestArgs":l.urlParams(n),"fVersionNumber":a&&a.length>=2?parseInt(a[1]):2,"fParamTicket":"","fParamMethod":o.get("method"),"fCallName":n}};s.push(r)}}),t){var a=t.getConnectionUrl(),r=a.getCgiScript(),c=l.combine(r,"/api/v1/csui/batch"),d=new FormData;d.append("body",JSON.stringify({"exitOnError":!0,"calls":s})),o={"url":c,"method":"POST","data":d,"contentType":!1,"processData":!1}}return{"connector":t,"name":i,"data":o,"count":s.length}}(e);if(c.count){n.off(e);var d=i.formatMessage(c.count,o.get("confirmMessages"),c.name);a.confirmQuestion(d,o.get("name")).done(function(){n.on(e),c.connector.makeAjaxCall(c.data).done(function(e){var t=i.formatMessage(e.calls.length,o.get("successMessages"),c.name);s.resolve(e.calls),r.showMessage("success",t)}).fail(function(e){var t=e.responseJSON?e.responseJSON.error:e.statusText,i=new Error(t);i.suppressFailMessage=!0,s.reject(i),r.showMessage("error",t)})}).fail(function(){s.resolve()})}else s.resolve()},s.reject),s.promise()}})}),csui.define("conws/utils/commands/permissions/deleterole",["require","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/commands/permissions/delete.permission","csui/utils/command.error","csui/controls/globalmessage/globalmessage","conws/utils/commands/permissions/permissions.util","i18n!conws/utils/commands/nls/commands.lang","i18n!csui/utils/commands/nls/localized.strings"],function(e,t,i,o,n,s,l,a,r,c){"use strict";return n.extend({"defaults":{"signature":"DeleteRole","name":r.CommandNameDeleteRole,"scope":"single"},"enabled":function(e){var t=e.model,i=a.isWorkspaceRole(t),o=t&&t.get("type"),n=e.nodeModel||e.originatingView&&e.originatingView.model,s=a.isWorkspace(n),l=a.isInheritedRole(n,t),c=a.isLeaderRole(n,t),d=!c;if(c){var u=e.originatingView&&e.originatingView.collection&&e.originatingView.collection.extraMemberModels;d=u&&1===u.length}var p=o&&"custom"===o&&i&&d&&n.actions&&!!n.actions.get({"signature":"editpermissions"});return(!s&&i||s&&l)&&e.toolItem.set("name",r.DeletePermissionCommandForSubItems),p},"execute":function(e,i){var o=t.Deferred(),n=this;return i||(i={}),e.suppressFailMessage=!0,e.suppressSuccessMessage=!0,csui.require(["csui/controls/globalmessage/globalmessage","conws/dialogs/applyrolepermissions/apply.role.permissions.view","conws/dialogs/applyrolepermissions/impl/header/apply.role.permissions.header.view","csui/controls/progressblocker/blocker","csui/controls/dialog/dialog.view","csui/utils/permissions/permissions.precheck"],function(t,s,r,c,d,u){l=t;var p=e.model,m=e.nodeModel||e.originatingView&&e.originatingView.model,h=a.isWorkspace(m),g=a.isWorkspaceRole(p),f=a.isInheritedRole(m,p);p.isRoleDelete=!(!h||!g||f),e.originatingView&&e.originatingView.model&&e.originatingView.model.get("container")?(i.removePermission=!0,n._executeDeletePermission(e,i,r,s,c,d,u).then(o.resolve,o.reject)):n._deletePermission(e,i).then(o.resolve,o.reject)},o.reject),o.promise()},"_performActions":function(e,o){var n,d=this,u=t.Deferred(),p=e.dialog?e.dialog.options.view.options.permissionModel:e.model,m=p.get("type"),h=p.collection,g=this._getMessageWithUserDisplayName(c.DeletePermissionCommandFailMessage,p);if(h&&h.options&&h.options.node&&h.options.node.actions.get({"signature":"editpermissions"})){p.nodeId=h.options&&h.options.node&&h.options.node.get("id");var f,w=h.options&&h.options.node&&h.options.node.get("container");h.options&&h.options.node&&h.options.node.get("permissions_model");e.dialog&&!p.isRoleDelete&&(p.apply_to=w&&e.dialog.options.view.ContentRegion.currentView.getValues().subitems_inherit?2:0,p.include_sub_types=p.apply_to>0?[204,207,215,298,3030202]:[]),f=p.url(),p.isRoleDelete&&(p.action="delete",f=a.getUrl(p),g=this._getMessageWithUserDisplayName(r.DeleteRoleCommandFailMessage,p)),d.originatingView&&d.originatingView.blockActions&&(d.destroyDialog(e),d.originatingView.blockActions());var v=p.destroy({"url":f,"wait":!0}).done(function(e){p.set("results",e.results),d.originatingView&&d.originatingView.trigger("permission:changed",d),d.originatingView&&d.originatingView.unblockActions&&d.originatingView.unblockActions();var t=p.get("right_id_expand");t&&t.id&&d.originatingView&&d.originatingView.collection&&d.originatingView.collection.extraMemberModels&&(d.originatingView.collection.extraMemberModels=i.reject(d.originatingView.collection.extraMemberModels,function(e){return e.id===t.id})),n=p.isRoleDelete?d._getMessageWithUserDisplayName(r.DeleteRoleCommandSuccessMessage,p):d._getMessageWithUserDisplayName(p.get("results")&&p.get("results").success>0?c.DeletePermissionCommandSuccessMessageWithCount:c.DeletePermissionCommandSuccessMessage,p),l.showMessage("success",n),"owner"!==m&&"group"!==m||h.processForEmptyOwner&&h.processForEmptyOwner(),u.resolve(p)}).fail(function(e){var t=e?new s(e,p):e;d.handleFailure(t,g),u.reject(p,t),e||v.abort()}).always(function(){d.originatingView&&d.originatingView.unblockActions&&d.originatingView.unblockActions()});return u.promise()}return d.destroyDialog(e),u.reject(new s(g,{"errorDetails":c.undefinedCollection}))},"handleFailure":function(e,t){var i,n=o.Model.extend({"defaults":{"name":"","state":"pending","commandName":"ViewPermission"}}),s=o.Collection.extend({"model":n}),a=new s;i=new n({"name":e,"mime_type":"","state":"rejected"}),a.add(i),l.showPermissionApplyingProgress(a,{"oneFileFailure":t})}})}),csui.define("conws/utils/commands/permissions/edit.role.permissions",["require","csui/lib/underscore","csui/lib/jquery","csui/utils/base","csui/models/command","csui/utils/command.error","csui/utils/commands/permissions/permission.util","conws/utils/commands/permissions/permissions.util","i18n!csui/utils/commands/nls/localized.strings"],function(e,t,i,o,n,s,l,a,r){"use strict";return n.extend({"defaults":{"signature":"EditRolePermission","command_key":["editpermissions","Edit Permissions"]},"enabled":function(e){var t=e.model,i=t&&t.get("type"),o=e.nodeModel||e.originatingView&&e.originatingView.model;return i&&"custom"===i&&a.isWorkspaceRole(t)&&o.actions&&!!o.actions.get({"signature":"editpermissions"})},"execute":function(e,t){var o=this,n=i.Deferred(),c=e.model,d=c.collection,u=e.targetView;o.targetView=u,e.suppressFailMessage=!0,e.suppressSuccessMessage=!0;var p=this._getMessageWithUserDisplayName(r.EditPermissionCommandFailMessage,c),m=d&&d.options&&d.options.node&&d.options.node.actions.get({"signature":"editpermissions"});return d&&m?(c.nodeId=d.options&&d.options.node&&d.options.node.get("id"),csui.require(["conws/utils/commands/permissions/edit.role.permission.helper","csui/utils/contexts/factories/user","csui/controls/globalmessage/globalmessage","csui/utils/permissions/permissions.precheck"],function(t,i,r,d){
var u=e.originatingView.context.getModel(i);o.loginUserId=u.get("id"),o.editRolePermissionHelper=new t({"permissionModel":c,"popoverPlacement":"left","popoverAtBodyElement":!e.originatingView||!e.originatingView.options.isExpandedView,"popoverTargetElement":e.targetView.permissions.$el,"readonly":!1,"originatingView":e.originatingView,"applyTo":e.applyTo}),o.editRolePermissionHelper._showSelectPermissionLevelPopover(),o.editRolePermissionHelper.listenTo(o.editRolePermissionHelper,"permissions:selected",function(t){var i,u={"permissions":t.permissions,"apply_to":t.apply_to,"include_sub_types":t.apply_to>0?d.includeSubTypes():[]},p=o.targetView&&o.targetView.options&&o.targetView.options.nodeModel||o.targetView&&o.targetView.permissions&&o.targetView.permissions.options&&o.targetView.permissions.options.nodeModel;t.right_id&&(u.right_id=t.right_id),a.isWorkspace(p)&&a.isWorkspaceRole(c)&&(c.action="editperms",i=a.getUrl(c)),c.save(u,{"url":i,"patch":!0,"wait":!0,"silent":!0}).done(function(t){c.set(u,{"silent":!0}),e.originatingView.trigger("permission:changed",e),o.editRolePermissionHelper.destroy(),o.editRolePermissionHelper.unblockActions(),n.resolve(),"simple"!==e.originatingView.model.get("permissions_model")&&l.generateSuccessMessage(t,r)}).fail(function(e){var t=e?new s(e,c):e;r.showMessage("error",t),n.reject(c,t)})}),o.editRolePermissionHelper.listenTo(o.editRolePermissionHelper,"closed:permission:level:popover",function(){n.reject(c)})}),n.promise()):n.reject(new s(p,{"errorDetails":r.undefinedCollection}))},"_getMessageWithUserDisplayName":function(e,i){var n;return i.get("right_id_expand")?n=o.formatMemberName(i.get("right_id_expand")):"public"===i.get("type")&&(n=r.publicAccess),t.str.sformat(e,n)}})}),csui.define("conws/utils/commands/permissions/edit.role.permission.helper",["csui/lib/underscore","csui/controls/dialog/dialog.view","csui/models/permission/nodepermission.model","csui/widgets/permissions/edit/edit.permission.helper","conws/dialogs/applyrolepermissions/apply.role.permissions.view","csui/widgets/permissions/edit/apply.permission/header/apply.permission.header.view","csui/controls/progressblocker/blocker","i18n!csui/widgets/permissions/impl/nls/lang"],function(e,t,i,o,n,s,l,a){"use strict";return o.extend({"constructor":function(e){o.prototype.constructor.apply(this,arguments)},"showApplyPermissionDialog":function(){var i=new s;this._view=new n({"context":this.options.context||this.options.originatingView.context,"model":this.options.nodeModel||this.options.originatingView.model,"applyTo":this.options.applyTo,"permissionModel":this.options.permissionModel});var o=new t({"headerView":i,"view":this._view,"className":"csui-permissions-apply-dialog","midSize":!0,"buttons":[{"id":"apply","label":a.applyButtonLabel,"toolTip":a.applyButtonLabel,"default":!0,"click":e.bind(this.onClickApplyButton,this)},{"label":a.cancelButtonLabel,"toolTip":a.cancelButtonLabel,"close":!0}]});return o.listenTo(o,"hide",e.bind(this.onHideDialog,this)),l.imbue(o),o},"onClickApplyButton":function(e){var t=e.dialog.options.view.model.get("container"),i=e.dialog.options.view.options.permissionModel&&e.dialog.options.view.options.permissionModel.get("right_id"),o=t&&e.dialog.options.view.ContentRegion.currentView.getValues().subitems_inherit?2:0,n=o>0?[204,207,215,298,3030202]:[];this.triggerMethod("permissions:selected",{"permissions":this.permissions,"apply_to":o,"right_id":i,"include_sub_types":n});this._applyDialog.destroy(),this._blockActions()}})}),csui.define("conws/utils/dragndrop/dragndrop.subtypes",[],function(){"use strict";return 848}),csui.define("css!conws/utils/overlay/impl/conwsoverlay",[],function(){}),csui.define("conws/utils/overlay/conwsoverlay",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","css!conws/utils/overlay/impl/conwsoverlay"],function(e,t,i){return i.Controller.extend({"constructor":function(){i.Controller.prototype.constructor.apply(this,arguments)},"_transitionEnd":t.once(function(){var e,t={"transition":"transitionend","WebkitTransition":"webkitTransitionEnd","MozTransition":"transitionend","OTransition":"oTransitionEnd otransitionend"},i=document.createElement("div");for(e in t)if(void 0!==i.style[e])return t[e]}),"_hidePresentationView":function(){this.options.onHidePresentationView&&this.options.onHidePresentationView(this.modalContent),this.modalWrapper.detach(),this.presentationView.$el.detach(),this.presentationView.$el.removeClass("conws-overlay-panel"),this.modalContent.removeClass("conws-overlay-showing")},"_showOtherView":function(){this.modalContent.find(">:not(.conws-overlay-wrapper)").show(),this.options.onShowOtherView&&this.options.onShowOtherView(this.modalContent)},"_hideOtherView":function(){this.options.onHideOtherView&&this.options.onHideOtherView(this.modalContent),this.modalContent.find(">:not(.conws-overlay-wrapper)").hide()},"_showPresentationView":function(){this.modalContent=e(this.options.presentationRoot),this.modalContent.addClass("conws-overlay-beforeshow"),this.presentationView||(this.presentationView=this.options.presentationView,this.presentationView.render()),this.presentationView.$el.addClass("conws-overlay-panel"),this.modalWrapper=e('<div class="conws-overlay-wrapper"></div>'),this.modalContent.append(this.modalWrapper),this.modalWrapper.append(this.presentationView.$el),this.options.onShowPresentationView&&this.options.onShowPresentationView(this.modalContent),this.presentationView.$el.position(),this.presentationView.triggerMethod("dom:refresh");var t=this;this.presentationView.$el.one(this._transitionEnd(),function(){t.modalContent.removeClass("conws-overlay-animating"),t.modalContent.addClass("conws-overlay-showing"),t._hideOtherView()}),this.modalContent.addClass("conws-overlay-animating"),this.modalContent.removeClass("conws-overlay-beforeshow")},"show":function(){this._showPresentationView()},"close":function(){this._showOtherView(),this._hidePresentationView()}})}),csui.define("conws/widgets/relatedworkspaces/impl/relatedworkspaces.searchresult.model",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/models/nodes","csui/models/browsable/browsable.mixin","csui/models/mixins/node.resource/node.resource.mixin","csui/models/mixins/expandable/expandable.mixin","conws/utils/workspaces/impl/workspaces.collection.mixin"],function(e,t,i,o,n,s,l,a,r,c){function d(e){this.set(e)}function u(e,t){this.set(e,t)}var p=e.config();d.prototype.set=function(e){this.sortedColumns=e||{}},u.prototype.set=function(e,t){var i={},o=t||"name asc",n=o.replace(/( asc| desc)$/,""),s=o.slice(n.length+1),l=s?s+"_"+n:n,a=n.charAt(0).toUpperCase()+n.slice(1);e&&e.each(function(e){var t=e.get("column_key"),o=e.get("name");n===t?a=o:e.get("sort")&&(i["asc_"+t]={"name":o},i["desc_"+t]={"name":o})}),s?(i["asc_"+n]={"name":a},i["desc_"+n]={"name":a}):i[n]={"name":a},this.links=i,this.sort=[l]};var m=s.extend({"constructor":function(e,n){this.wherePart=["where_workspace_type_ids","where_rel_type"],s.prototype.constructor.apply(this,arguments),this.options=i.pick(n,"query","connector","node","search","autofetch","autoreset","stateEnabled","workspace","orderBy"),this.workspace=n.workspace,this.selectedSettings="DO",this.searchFacets=new o.Collection,this.searchFacets.filters=[],this.searchFacets.ensureFetched=function(e){return t.Deferred().resolve(this,{},e).promise()},this.searchFacets.getAvailableFacets=function(){return[]},this.searchFacets.clearFilter=function(){},this.makeBrowsable(n),this.makeNodeResource(n),this.makeExpandable(n),this.makeWorkspacesCollection(n),this.completeColumns=new this.columns.constructor(n.columns.toJSON(),{"dataCollectionName":this.dataCollectionName}),this.columns.reset(i.each(n.columns.toJSON(),function(e){delete e.sort,delete e.sort_key})),this.searching=new d(this.columns),this.sorting=new u(this.completeColumns,this.orderBy)}});l.mixin(m.prototype),a.mixin(m.prototype),r.mixin(m.prototype),c.mixin(m.prototype);var h=m.prototype.parse;return i.extend(m.prototype,{"url":function(){var e=this.options.query||{};this._cleanupQuery(e),e=this.mergeUrlPaging(p,e),e=this.mergeUrlSorting(e),this.filters=i.omit(this.options.search.attributes,"query_id","forcePerspectiveChange","dummy"),e=this.mergeUrlFiltering(e);var t=this.options.node.get("id"),o=new n(this.getBaseUrl()).getApiBase("v2"),s=n.combine(o,"businessworkspaces",t,"relateditemspicklist");return e=i.omit(e,function(e,t){return null==e||""===e}),e.global_metadata=void 0,s+"?"+this.queryParamsToString(e)},"parse":function(e,t){this.completeColumns.resetColumns(e,this.options);var o=e.meta_data&&e.meta_data[this.dataCollectionName]||{};i.each(o,function(e){delete e.sort,delete e.sort_key});var n=h.apply(this,arguments);if(this.searching.set(this.columns),this.sorting.set(this.completeColumns,this.orderBy),n){var s=this.options.node.get("id"),l=this.options.query&&this.options.query.where_rel_type;n.forEach(function(e){e.data||(e.data={}),e.data.properties||(e.data.properties={}),e.data.properties.rel_source=s,e.data.properties.rel_type=l,e.data.properties.OTName=e.data.properties.name})}return n},"setPreviousOrder":function(e,t){if(!i.isEqual(this.previousOrderBy,e))return this.previousOrderBy=e,!1!==t&&this.fetch({"skipSort":!1}),!0},"getResourceScope":function(){return{"query":i.deepClone(this.options.query),"node":this.node}},"setResourceScope":function(e){e.query&&(this.options.query=e.query),e.node&&(this.node=e.node)},"isFetchable":function(){return this.options.node.isFetchable()}}),m}),csui.define("conws/widgets/relatedworkspaces/impl/relatedworkspaces.searchform.model",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","conws/utils/workspaces/impl/workspaceutil"],function(e,t,i,o){"use strict";function n(e,t,i,o,n){e.data[t]=i,e.options.fields[t]=o,e.schema.properties[t]=n}function s(e,i){var n,s=o.getFormFieldTemplate(e.attributes);return s&&(n=t.deepClone(s),n.data=i,n.options.label=e.get("name"),n.schema.title=e.get("name")),n}function l(e){var t={"data":{},"options":{"type":"object","fields":{}},"schema":{"type":"object","properties":{}}};return e&&(t.options.label=e,t.schema.title=e),t}var a={"favorite":"true","id":!0,"modify_date":!0,"size":!0,"type":!0};return i.Model.extend({"constructor":function(e,o){o||(o={}),e=t.extend({"data":{},"options":{},"schema":{}},e),i.Model.prototype.constructor.call(this,e,o),this.setFromColumns(o.columns,o.tableColumns),this.listenTo(o.columns,"reset update",function(){this.setFromColumns(o.columns,o.tableColumns)})},"setFromColumns":function(e,i){var o=i&&i.sortBy("sequence").reduce(function(t,i){return t.concat([e.get(i.get("key"))])},[]);o=o?t.compact(o):e.models;var r=l();n(r,"dummy","dummy",{"type":"hidden"},{"type":"string"});var c=this.get("data");o.forEach(function(e){var t=e.get("column_key");if(!a[t]){var i=c&&c.search?c.search[t]:void 0,o=s(e,i);o&&n(r,t,o.data,o.options,o.schema)}});var d=l();n(d,"search",r.data,r.options,r.schema),this.set(d)}})}),csui.define("conws/widgets/relatedworkspaces/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/relatedworkspaces/impl/nls/root/lang",{"dialogTitle":"Related workspaces","searchPlaceholder":"%1","noResultsPlaceholder":"No related workspaces to display.","errorFieldFormatTagUnrecognized":"Invalid format specification for {0}.","searchAria":"Search for related workspaces","expandAria":"Expand the related workspaces widget","ToolbarItemAddRelation":"Add relationships","ToolbarItemAddRelationSubmit":"Add relationships","ToolbarItemRemoveRelation":"Remove relationships","initialSearchLoadMessage":"Search to find business workspaces","expandTableAria":"Content of {0}"}),csui.define("conws/widgets/relatedworkspaces/addrelatedworkspaces.search",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/handlebars","csui/controls/toolbar/toolitems.factory","conws/utils/overlay/conwsoverlay","csui/widgets/search.results/search.results.view","conws/widgets/relatedworkspaces/impl/relatedworkspaces.searchresult.model","conws/widgets/relatedworkspaces/impl/relatedworkspaces.searchform.model","csui/utils/contexts/factories/search.query.factory","i18n!conws/widgets/relatedworkspaces/impl/nls/lang"],function(e,t,i,o,n,s,l,a,r,c,d){"use strict";return i.Controller.extend({"constructor":function(){i.Controller.prototype.constructor.apply(this,arguments);var s=this.options.status,u=e.extend(!0,{},s.collection.options.query);u.where_workspace_type_ids=encodeURIComponent("{"+u.where_workspace_type_id+"}"),u.where_rel_type=u.where_relationtype,delete u.where_workspace_type_id,delete u.where_relationtype;var p=u.fields&&decodeURIComponent(u.fields).replace(/^properties{|}$/g,"").split(",");u.fields=encodeURIComponent("properties{"+t.union(p||[],["description"]).join(",")+"}");var m=new c(s.context).property,h=new a([],{"node":s.collection.node,"query":u,"search":m,"connector":s.collection.connector,"autofetch":!0,"autoreset":!0,"stateEnabled":!0,"columns":s.collection.columns,"workspace":s.collection.workspace,"orderBy":s.collection.orderBy}),g=s.originatingView.tableColumns&&s.originatingView.tableColumns.deepClone(),f=new r({},{"columns":h.columns,"tableColumns":g}),w=new n({"main":[{"signature":this.options.signature,"commandData":{"submit":!0},"name":d.ToolbarItemAddRelationSubmit}]},{"maxItemsShown":1,"dropDownText":d.ToolbarItemMore,"dropDownIconName":"csui_action_more32","addGroupSeparators":!1}),v={"otherToolbar":w,"inlineToolbar":[],"tableHeaderToolbar":w},b=new i.ItemView({"tagName":"div","template":o.compile('<span><h2 class="csui-custom-search-title">{{title}}</h2><span class="headerCount"/></span>')({"title":this.options.title})}),y=new l({"basicSearchResultsView":!0,"enableBackButton":!0,"enableSearchSettings":!1,"showFacetPanel":!1,"context":s.context,"query":m,"collection":h,"customSearchViewModel":f,"toolbarItems":v,"titleView":b,"tableColumns":g,"initialLoadMessage":d.initialSearchLoadMessage});y.on("render",function(){y.$el.addClass("conws-searchview")}),this.searchView=y,this.on("destroy",function(){y.destroy()})},"show":function(){function e(){i=!0}var i;addEventListener("resize",e,{"once":!0}),this.on("destroy",function(){removeEventListener("resize",e)});var o=new s({"onShowOtherView":t.bind(function(){i&&this.options.status.originatingView.triggerMethod("dom:refresh"),removeEventListener("resize",e)},this),"presentationRoot":this.options.status.originatingView.$el.parent(),"presentationView":this.searchView});this.searchView.on("go:back",function(){o.close(),o.destroy()}),this._overlay=o,this._overlay.show()},"close":function(){this._overlay.close()}})}),csui.define("conws/utils/workspaces/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/utils/workspaces/impl/nls/root/lang",{"errorCustomColumnConfigInvalid":"Invalid custom column configuration: {0}.","errorCustomColumnMissingBraces":"Missing curly braces in custom column configuration: {0}.","errorOrderByMustNotBeString":"Configuration 'orderBy' must be an object not a string.","errorOrderByMissingBraces":"Missing curly braces in 'orderBy' configuration.","errorFilteringFailed":"Filtering of result list failed. Please contact your administrator.","noWorkspacesFound":"No workspaces found.","selectedItemActionBarAria":"Action bar of selected items","ToolbarItemCloseExpandedView":"Close expanded view"}),csui.define("css!conws/utils/workspaces/workspaces",[],function(){}),csui.define("hbs!conws/utils/workspaces/error.template",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="conws-workspaces-error content-tile">\r\n  <div class="conws-workspaces-error-icon-div">\r\n    <div class="conws-workspaces-error-icon-parent">\r\n      <div class="conws-workspaces-error-icon notification_error"></div>\r\n    </div>\r\n  </div>\r\n  <div class="conws-workspaces-message">'+e.escapeExpression((s=null!=(s=l(i,"errorMessage")||(null!=t?l(t,"errorMessage"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"errorMessage","hash":{},"loc":{"start":{"line":7,"column":40},"end":{"line":7,"column":56}}}):s))+"</div>\r\n</div>"}});return i.registerPartial("conws_utils_workspaces_error.template",o),o}),csui.define("conws/utils/workspaces/workspaces.view",["csui/lib/marionette","module","csui/lib/underscore","csui/lib/backbone","csui/lib/jquery","csui/utils/base","csui/controls/list/list.view","csui/utils/nodesprites","csui/behaviors/limiting/limiting.behavior","csui/behaviors/expanding/expanding.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/list/behaviors/list.view.keyboard.behavior","csui/controls/tile/behaviors/infinite.scrolling.behavior","csui/controls/icon/icon.view","csui/utils/contexts/factories/node","csui/controls/progressblocker/blocker","csui/controls/node-type.icon/node-type.icon.view","csui/dialogs/modal.alert/modal.alert","i18n!conws/utils/workspaces/impl/nls/lang","css!conws/utils/workspaces/workspaces","hbs!conws/utils/workspaces/error.template"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h,g,f,w,v,b,y){var k=t.config(),x=c.extend({"constructor":function(e,t){e=i.extend({"collapsedView":t},e),c.prototype.constructor.call(this,e,t),this.listenTo(t.options.context,"close:expanded",function(e){e.widgetView===this.expandedView&&this.dialog&&this.dialog.body&&this.dialog.body.currentView===e.widgetView&&this.dialog.destroy()})},"_expandOtherView":function(e){return!1===e&&(this.expandedView.collapsedView=this.view,this.view.expandedView=this.expandedView),c.prototype._expandOtherView.apply(this,arguments)},"_enableExpandingAgain":function(){var e=c.prototype._enableExpandingAgain.apply(this,arguments);return this.expandedView.collapsedView=void 0,this.view.expandedView=void 0,e}});return l.extend({"constructor":function(e){if(void 0===e||!e.context)throw new Error("Context required to create WorkspacesView");e.data||(e.data={}),l.prototype.constructor.apply(this,arguments),this.options.blockingParentView?g.delegate(this,this.options.blockingParentView):g.imbue(this),this.options.data.pageSize=k.defaultPageSize||30,this.configOptionsData=i.clone(e.data),this.lastFilterValue="",this.limit=0,this.listenTo(this.collection,"sync",this._renderWorkspaceTitleIcon),this.listenTo(this.collection,"error",this.handleError);var t=this.getContext().getObject(h,e.context.options);this.listenTo(t,"change:id",this._reset),this.listenTo(this.collection,"request",this.blockActions).listenTo(this.collection,"sync",function(){this.messageOnError=void 0,this.unblockActions.apply(this,arguments)}).listenTo(this.collection,"destroy",this.unblockActions).listenTo(this.collection,"error",function(){this.unblockActions.apply(this,arguments),this.messageOnError&&(w.showError(this.messageOnError),this.messageOnError=void 0)}),this.listenTo(this.collection,"request",this.destroyEmptyView),this.listenTo(this,"go:away",function(){var e=this.expandedView;e&&this.listenTo(e,"destroy",function(){e&&e.changed&&(this.collection.fetch(),e=void 0)})})},"getContext":function(){return this.options.context},"initialize":function(){this.collection=this.completeCollection},"onRender":function(){this._resetInfiniteScrolling(),l.prototype.onRender.call(this)},"onClickHeader":function(e){this.triggerMethod("expand")},"_resetInfiniteScrolling":function(){this.collection.setLimit(0,this.options.data.pageSize,!1)},"templateHelpers":function(){return{"title":this._getTitle(),"imageUrl":this._getTitleIcon().src,"imageClass":"conws-workspacestitleicon","searchPlaceholder":this._getSearchPlaceholder()}},"childEvents":{"click:item":"onClickItem","render":"onRenderItem"},"onClickItem":function(e){this.triggerMethod("execute:defaultAction",e.model)},"className":function(){var e=this.viewClassName,t=this.options.data.workspaceType,o=i.result(l.prototype,"className");return t&&(e=e+" conws-workspacetype-"+t),o&&(e=e+" "+o),e},"_reset":function(){this.collection&&this.collection.resetLimit(),this.ui.searchInput&&""!==this.ui.searchInput.val()&&(this.collection&&this.collection.clearFilter(!1),this.ui.searchInput.val("")),this.ui.searchInput&&this.ui.searchInput.is(":visible")&&this.searchClicked(new CustomEvent(""))},"workspacesCollectionFactory":void 0,"workspacesTableView":void 0,"viewClassName":void 0,"dialogClassName":void 0,"lang":void 0,"behaviors":{"LimitedList":{"behaviorClass":r,"limit":function(){return this.limit},"completeCollection":function(){return this.getContext().getCollection(this.workspacesCollectionFactory,{"attributes":this._getCollectionAttributes(),"options":this._getCollectionOptions()})}},"ExpandableList":{"behaviorClass":x,"expandedView":function(){return this.workspacesTableView},"expandedViewOptions":function(){return this._getExpandedViewOptions()},"dialogTitle":function(){return this._getTitle()},"dialogTitleIconNameRight":"csui_action_minimize32","dialogClassName":function(){return"conwsworkspacestable"+(this.dialogClassName?" "+this.dialogClassName:"")},"titleBarImageUrl":function(){return this._getTitleIcon().src},"titleBarImageClass":function(){return this._getTitleIcon().cssClass||"conws-workspacestitleicon"}},"InfiniteScrolling":{"behaviorClass":p,"contentParent":".tile-content","fetchMoreItemsThreshold":80},"TabableRegion":{"behaviorClass":d},"ListViewKeyboardBehavior":{"behaviorClass":u}},"_getCollectionOptions":function(){return{"query":this._getCollectionUrlQuery()}},"_getExpandedViewOptions":function(){return{"data":i.clone(this.configOptionsData)}},"filterChanged":function(e){e&&"keyup"===e.type&&27===e.keyCode&&this.searchClicked();var t=this.ui.searchInput.val();this.lastFilterValue!==t&&(this.lastFilterValue=t,this.filterTimeout&&clearTimeout(this.filterTimeout),this.filterTimeout=setTimeout(function(e){e.filterTimeout=void 0,e._resetInfiniteScrolling(),e.collection.reset();var i;e._getFilterPropertyName&&(i=e._getFilterPropertyName());var o={};o[i||"name"]=t,e.collection.setFilter(o,{"fetch":!1})&&(e.messageOnError=v.errorFilteringFailed,e.collection.fetch())},1e3,this))},"_getTitleIcon":function(){var e={"src":"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==","cssClass":void 0};return this.collection&&this.collection.titleIcon?e.src=this.collection.titleIcon:this.collection&&null===this.collection.titleIcon&&(e.src=void 0),e},"_renderWorkspaceTitleIcon":function(){var t=this.$el.find(".tile-type-image")[0],i=t&&this.$el.find(".tile-type-image").find("img")[0];if(i){var o=this._getTitleIcon();if(n(i).attr("src")!==o.src&&n(i).attr("src",o.src),void 0===o.src){var s=new m({"iconName":"conws_mime_workspace","size":"large"});new e.Region({"el":t}).show(s),s.$el.addClass("tile-type-icon tile-type-icon-img")}}},"_getTitle":function(){var e=this.lang.dialogTitle;return this.options.data.title&&(e=s.getClosestLocalizedString(this.options.data.title,this.lang.dialogTitle)),e},"_getSearchPlaceholder":function(){return this.lang.searchPlaceholder.replace("%1",this._getTitle())},"_getNoResultsPlaceholder":function(){var e=this.options.data&&this.options.data.collapsedView&&this.options.data.collapsedView.noResultsPlaceholder;return e=e?s.getClosestLocalizedString(e,this.lang.noResultsPlaceholder):this.lang.noResultsPlaceholder},"collectionEvents":{"reset":"onCollectionSync"},"onCollectionSync":function(){this.synced=!0},"isEmpty":function(){return this.synced&&0===this.collection.models.length},"onRenderItem":function(e){e._nodeIconView=new f({"el":e.$(".csui-type-icon").get(0),"node":e.model}),e._nodeIconView.render(),e.$el.attr("role","option")},"handleError":function(){if(this.collection.error&&this.collection.error.message){var e=y.call(this,{"errorMessage":this.collection.error.message});this.$el.find(".conws-workspaces-error").length>0&&this.$el.find("div").remove(".conws-workspaces-error"),this.$el.find(".tile-content").append(e)}}})}),csui.define("hbs!conws/utils/previewpane/impl/previewheader",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <span class="conws-preview-header-typename">'+e.escapeExpression((s=null!=(s=l(i,"typeName")||(null!=t?l(t,"typeName"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"typeName","hash":{},"loc":{"start":{"line":3,"column":48},"end":{"line":3,"column":60}}}):s))+"</span>\r\n"},"3":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <a title="'+e.escapeExpression((l=null!=(l=a(i,"quickLinkTooltip")||(null!=t?a(t,"quickLinkTooltip"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"quickLinkTooltip","hash":{},"loc":{"start":{"line":6,"column":14},"end":{"line":6,"column":34}}}):l))+'"\r\n       href="'+e.escapeExpression((l=null!=(l=a(i,"display_url")||(null!=t?a(t,"display_url"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"display_url","hash":{},"loc":{"start":{"line":7,"column":13},"end":{"line":7,"column":28}}}):l))+'" target="_blank">\r\n      '+(null!=(s=(a(i,"icon-v2")||t&&a(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"size":"normal","states":"true","iconName":"conws_action_quick_link32"},"loc":{"start":{"line":8,"column":6},"end":{"line":8,"column":84}}}))?s:"")+"</a>\r\n"},"5":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <a  tabindex="0" href="#" class="conws-preview-header-title narrow" title="'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":12,"column":77},"end":{"line":12,"column":85}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":12,"column":87},"end":{"line":12,"column":95}}}):s))+"</a>\r\n"},"7":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <a tabindex="0" href="#" class="conws-preview-header-title" title="'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":14,"column":69},"end":{"line":14,"column":77}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":14,"column":79},"end":{"line":14,"column":87}}}):s))+"</a>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<div>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"typeName"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.noop,"loc":{"start":{"line":2,"column":2},"end":{"line":4,"column":9}}}))?s:"")+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"display_url"):t,{"name":"if","hash":{},"fn":e.program(3,n,0),"inverse":e.noop,"loc":{"start":{"line":5,"column":2},"end":{"line":9,"column":9}}}))?s:"")+"</div>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"display_url"):t,{"name":"if","hash":{},"fn":e.program(5,n,0),"inverse":e.program(7,n,0),"loc":{"start":{"line":11,"column":0},"end":{"line":15,"column":7}}}))?s:"")+"\r\n"}});return i.registerPartial("conws_utils_previewpane_impl_previewheader",o),o}),csui.define("conws/utils/previewpane/impl/previewheader.view",["csui/lib/underscore","csui/lib/marionette","csui/lib/numeral","csui/lib/moment","csui/lib/handlebars","csui/behaviors/default.action/default.action.behavior","csui/controls/icons.v2","i18n","hbs!conws/utils/previewpane/impl/previewheader","css!conws/utils/icons/icons"],function(e,t,i,o,n,s,l,a,r){return t.ItemView.extend({"constructor":function(){t.ItemView.apply(this,arguments)},"behaviors":{"DefaultAction":{"behaviorClass":s}},"triggers":{"click .conws-preview-header-title":"click:item"},"className":"preview-header","template":r,"onClickItem":function(){if(this.options.originatingView){var e=this.options.originatingView;e.destroy(),e.options.node&&this.triggerMethod("execute:defaultAction",e.options.node)}}})}),csui.define("hbs!conws/widgets/team/impl/dialogs/modaldialog/impl/modal.dialog.view",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){return'      <div class="conws-modal-dialog dialog-header"></div>\r\n'},"3":function(e,t,i,o,n){return'      <div class="conws-modal-dialog dialog-body"></div>\r\n'},"5":function(e,t,i,o,n){return'      <div class="conws-modal-dialog dialog-footer"></div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="binf-modal-dialog conws-modal-dialog '+e.escapeExpression((l=null!=(l=a(i,"modalClassName")||(null!=t?a(t,"modalClassName"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"modalClassName","hash":{},"loc":{"start":{"line":1,"column":49},"end":{"line":1,"column":67}}}):l))+'">\r\n  <div class="binf-modal-content">\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"existsHeader"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.noop,"loc":{"start":{"line":3,"column":4},"end":{"line":5,"column":11}}}))?s:"")+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"existsBody"):t,{"name":"if","hash":{},"fn":e.program(3,n,0),"inverse":e.noop,"loc":{"start":{"line":6,"column":4},"end":{"line":8,"column":11}}}))?s:"")+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"existsFooter"):t,{"name":"if","hash":{},"fn":e.program(5,n,0),"inverse":e.noop,"loc":{"start":{"line":9,"column":4},"end":{"line":11,"column":11}}}))?s:"")+"  </div>\r\n</div>\r\n"}});return i.registerPartial("conws_widgets_team_impl_dialogs_modaldialog_impl_modal.dialog.view",o),o}),csui.define("css!conws/widgets/team/impl/dialogs/modaldialog/impl/modal.dialog.view",[],function(){}),csui.define("conws/widgets/team/impl/dialogs/modaldialog/modal.dialog.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabables.behavior","hbs!conws/widgets/team/impl/dialogs/modaldialog/impl/modal.dialog.view","css!conws/widgets/team/impl/dialogs/modaldialog/impl/modal.dialog.view"],function(e,t,i,o,n,s){var l=o.Region.extend({"constructor":function(e){o.Region.prototype.constructor.apply(this,arguments)},"attachHtml":function(e){this.el.appendChild(e.el)}}),a=o.LayoutView.extend({"className":"cs-dialog binf-modal binf-fade conws-modal-dialog-parent","attributes":{"tabindex":"-1","role":"dialog","aria-hidden":"true"},"template":s,"templateHelpers":function(){return{"existsHeader":!e.isUndefined(this.options.header),"existsBody":!e.isUndefined(this.options.body),"existsFooter":!e.isUndefined(this.options.footer),"modalClassName":this.options.modalClassName}},"behaviors":{"TabablesBehavior":{"behaviorClass":n,"recursiveNavigation":!0,"containTabFocus":!0}},"ui":{"header":".dialog-header","body":".dialog-body","footer":".dialog-footer"},"regions":{"header":".dialog-header","body":".dialog-body","footer":".dialog-footer"},"events":{"keydown":"onKeyDown","hidden.binf.modal":"onHidden",
"shown.binf.modal":"onShown"},"constructor":function(e){o.LayoutView.prototype.constructor.apply(this,arguments)},"show":function(){var e=t.fn.binf_modal.getDefaultContainer?t.fn.binf_modal.getDefaultContainer():document.body;return new l({"el":e}).show(this),this},"destroy":function(){return this.$el.is(":visible")?this.$el.binf_modal("hide"):a.__super__.destroy.apply(this,arguments),t("body").addClass("binf-modal-open"),this},"kill":function(){return a.__super__.destroy.apply(this,arguments),!0},"onRender":function(){this.options.dialogTxtAria&&this.$el.attr({"aria-label":this.options.dialogTxtAria}),this.options.body&&this.body.show(this.options.body)},"onShow":function(){this.$el.binf_modal({"backdrop":"static","keyboard":!1})},"onKeyDown":function(e){27===e.keyCode&&"filtersearch"!==e.target.id&&this.destroy()},"onHidden":function(){this.destroy()},"onShown":function(){this.options.body&&(this.options.body.triggerMethod("dom:refresh"),this.options.body.triggerMethod("after:show"))}});return a}),csui.define("hbs!conws/widgets/team/impl/controls/rolepicker/impl/role",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<span style="white-space:pre" title="'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":1,"column":37},"end":{"line":1,"column":45}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":1,"column":47},"end":{"line":1,"column":55}}}):s))+"</span>"}});return i.registerPartial("conws_widgets_team_impl_controls_rolepicker_impl_role",o),o}),csui.define("conws/widgets/team/impl/controls/rolepicker/impl/role.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","hbs!conws/widgets/team/impl/controls/rolepicker/impl/role"],function(e,t,i,o){return i.ItemView.extend({"tagName":"span","template":o,"templateHelpers":function(){return{"name":this.model.get("name")}},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.apply(this,arguments)}})}),csui.define("hbs!conws/widgets/team/impl/controls/rolepicker/impl/rolepicker",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="search-input"></div>\r\n<div class="search-clear"></div>\r\n<div class="typeahead cs-search-icon icon-caret-down"\r\n     title="'+e.escapeExpression((s=null!=(s=l(i,"showValues")||(null!=t?l(t,"showValues"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"showValues","hash":{},"loc":{"start":{"line":4,"column":12},"end":{"line":4,"column":26}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"showValues")||(null!=t?l(t,"showValues"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"showValues","hash":{},"loc":{"start":{"line":4,"column":40},"end":{"line":4,"column":54}}}):s))+'">\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_controls_rolepicker_impl_rolepicker",o),o}),csui.define("hbs!conws/widgets/team/impl/controls/rolepicker/impl/rolepicker.clear",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="typeahead cs-search-clear csui-icon formfield_clear" style=""\r\n     title="'+e.escapeExpression((s=null!=(s=l(i,"clearValue")||(null!=t?l(t,"clearValue"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"clearValue","hash":{},"loc":{"start":{"line":2,"column":12},"end":{"line":2,"column":26}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"clearValue")||(null!=t?l(t,"clearValue"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"clearValue","hash":{},"loc":{"start":{"line":2,"column":40},"end":{"line":2,"column":54}}}):s))+'">\r\n</div>'}});return i.registerPartial("conws_widgets_team_impl_controls_rolepicker_impl_rolepicker.clear",o),o}),csui.define("hbs!conws/widgets/team/impl/controls/rolepicker/impl/rolepicker.input",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<input class="typeahead binf-form-control cs-search" type="search" placeholder="'+e.escapeExpression((s=null!=(s=l(i,"placeholder")||(null!=t?l(t,"placeholder"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"placeholder","hash":{},"loc":{"start":{"line":1,"column":80},"end":{"line":1,"column":95}}}):s))+'">\r\n'}});return i.registerPartial("conws_widgets_team_impl_controls_rolepicker_impl_rolepicker.input",o),o}),csui.define("css!conws/widgets/team/impl/controls/rolepicker/impl/rolepicker",[],function(){}),csui.define("conws/widgets/team/impl/controls/rolepicker/rolepicker.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","conws/widgets/team/impl/controls/rolepicker/impl/role.view","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/controls/rolepicker/impl/rolepicker","hbs!conws/widgets/team/impl/controls/rolepicker/impl/rolepicker.clear","hbs!conws/widgets/team/impl/controls/rolepicker/impl/rolepicker.input","css!conws/widgets/team/impl/controls/rolepicker/impl/rolepicker","csui/lib/bootstrap3-typeahead"],function(e,t,i,o,n,s,l,a,r,c,d){var u=i.ItemView.extend({"template":d,"templateHelpers":function(){return{"placeholder":this.options.placeholder}},"ui":{"searchbox":".typeahead.cs-search"},"events":{"keydown @ui.searchbox":"onKeyDown","keyup @ui.searchbox":"onKeyUp","dragstart .typeahead.binf-dropdown-menu li > a":"onDragRole"},"behaviors":{"TabableRegion":{"behaviorClass":n}},"triggers":{"click @ui.searchbox":"click","focus @ui.searchbox":"focus"},"constructor":function(e){e||(e={}),e.delay||(e.delay=200),e.minLength||(e.minLength=0),e.placeholder||(e.placeholder=a.addParticipantsRolePickerPlaceholder),e.roles||(e.roles=[]),e.prettyScrolling||(e.prettyScrolling=!1),void 0===e.showInherited&&(e.showInherited=!0),e.roles.comparator=function(e,t){return o.localeCompareString(e.get("name"),t.get("name"))},e.roles.sort(),this.rolePicked=!0,i.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(e.view,"clearInput",this.clear)},"onRender":function(){this.$("input.typeahead").typeahead({"items":"all","afterSelect":e.bind(this._afterSelect,this),"highlighter":e.bind(this._renderHighlighter,this),"delay":this.options.delay,"displayText":this._retrieveDisplayText,"matcher":this._matcher,"afterHide":e.bind(this._afterHide,this),"nextHighlighter":e.bind(this._nextHighlighter,this),"accessbility":e.bind(this._accessbility,this),"currentHighlighter":e.bind(this._currentHighlighter,this),"sorter":this._sorter,"minLength":this.options.minLength,"source":e.bind(this._source,this),"prettyScrolling":this.options.prettyScrolling,"appendTo":this.$el,"afterShow":e.bind(this._positionContainer,this)}),this.ui.searchbox.append(this.options.$el)},"onClick":function(e){this.ui.searchbox.trigger("focus"),this.ui.searchbox.typeahead("lookup",this.ui.searchbox.val())},"onKeyUp":function(e){0!==this.ui.searchbox.val().length||13!==e.keyCode&&32!==e.keyCode&&46!==e.keyCode?(this.rolePicked=!0,this.options.view.filterLength=this.ui.searchbox.val().length,this.options.view.trigger("updateStyles")):this.rolePicked=!1},"onKeyDown":function(e){9===e.keyCode&&(this.options.view.filterLength=this.ui.searchbox.val().length,this.options.view.trigger("updateStyles"),this.ui.searchbox.typeahead("hide"))},"onDragRole":function(e){return!1},"isTabable":function(){return t(this.ui.searchbox).is(":not(:disabled)")&&t(this.ui.searchbox).is(":not(:hidden)")&&t(this.ui.searchbox).is(":visible")},"clear":function(){this.ui.searchbox.val(""),this.ui.searchbox.trigger("focus"),this.ui.searchbox.typeahead("lookup",this.ui.searchbox.val())},"currentlyFocusedElement":function(){return this.ui.searchbox},"_source":function(e){var t=[];return this.rolePicked&&void 0!==this.options.roles&&(t=this.options.showInherited?this.options.roles.models:this.options.roles.filter(function(e){return!e.get("inherited_from_id")})),t},"_matcher":function(e){return~e.get("name").toLowerCase().indexOf(this.query.toLowerCase())},"_sorter":function(e){return e},"_retrieveDisplayText":function(e){return e.get("name")},"_afterSelect":function(e){this.ui.searchbox.val(""),this.options.view.filterLength=this.ui.searchbox.val().length,this.options.view.trigger("updateStyles"),this.options.view.trigger("item:change",{"item":e})},"_renderHighlighter":function(e){var t=this.options.roles.findWhere({"name":e});return new l({"model":t,"connector":this.options.roles.connector}).render().el},"_positionContainer":function(e){var t=e.$element.closest(".conws-addparticipants-members"),i=e.$scrollContainer;if(t.length&&i){var o=e.$element[0].getBoundingClientRect(),n=o.top-t.offset().top,s=t.height()-(n+o.height),l=e.$menu[0].offsetHeight;if(n>s){var a=l>n?Math.abs(.9*n):l;i.css({"max-height":a+"px","top":-a+"px"})}else{var r=Math.abs(.9*s)+"px";i.css({"max-height":r,"top":o.height+"px"})}}},"_afterHide":function(){},"_currentHighlighter":function(e){},"_nextHighlighter":function(e){},"_accessbility":function(e){}}),p=i.ItemView.extend({"template":c,"templateHelpers":function(){return{"clearValue":a.addParticipantsRolePickerClear}},"ui":{"searchclear":".typeahead.cs-search-clear"},"events":{"click @ui.searchclear":"onClickClear","keyup @ui.searchclear":"onClearKeyUp"},"behaviors":{"TabableRegion":{"behaviorClass":n}},"constructor":function(e){i.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(e.view,"updateStyles",this.updateStyles)},"onClickClear":function(e){this.updateStyles(),this.options.view.trigger("clearInput")},"onClearKeyUp":function(e){13!==e.keyCode&&32!==e.keyCode||(this.updateStyles(),this.options.view.trigger("clearInput"))},"updateStyles":function(){var e=this.options.view.filterLength>0;this.ui.searchclear.css({"display":e?"":"none"}).attr("tabindex",0)},"isTabable":function(){return t(this.ui.searchclear).is(":not(:disabled)")&&t(this.ui.searchclear).is(":not(:hidden)")&&t(this.ui.searchclear).is(":visible")},"currentlyFocusedElement":function(){return this.ui.searchclear}}),m=i.LayoutView.extend({"tagName":"div","className":"conws-control-rolepicker","template":r,"templateHelpers":function(){return{"showValues":a.addParticipantsRolePickerShow}},"ui":{"rolepicker":"div.conws-control-rolepicker","searchicon":".typeahead.cs-search-icon","searchbox":".search-input","searchclear":".search-clear"},"regions":{"searchRegion":"@ui.searchbox","clearRegion":"@ui.searchclear"},"triggers":{"click @ui.searchicon":"click"},"constructor":function(e){e||(e={}),this.filterLength=0,i.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this,"updateFocus",this.updateFocus),this.propagateEventsToRegions()},"onRender":function(){var e=this.searchView;e?this.searchRegion.show(e):(e=this.searchView=new u(t.extend({},this.options,{"view":this})),this.searchRegion.show(e)),this.clearView=new p(t.extend({},this.options,{"view":this})),this.clearRegion.show(this.clearView),this.clearView.updateStyles()},"onClick":function(e){this.updateFocus(),this.searchView.$("input.typeahead").typeahead("lookup",this.ui.searchbox.val())},"updateFocus":function(){this.searchView.currentlyFocusedElement().trigger("focus")}});return e.extend(m.prototype,s),m}),csui.define("conws/widgets/team/impl/behaviors/list.keyboard.behavior",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette"],function(e,t,i,o){"use strict";return o.Behavior.extend({"defaults":{"currentlyFocusedElementSelector":"li:nth-child({0})"},"constructor":function(e,i){o.Behavior.prototype.constructor.apply(this,arguments),t.extend(i,{"selectedIndex":0,"onKeyDown":function(e){var t=this.currentlyFocusedElement();switch(e.keyCode){case 38:this._moveTo(e,this._selectPrevious(),t);break;case 40:this._moveTo(e,this._selectNext(),t)}},"_moveTo":function(e,i,o){e.preventDefault(),e.stopPropagation(),setTimeout(t.bind(function(){o&&o.prop("tabindex","-1"),i.prop("tabindex","0"),i.trigger("focus")},this),50)},"_selectNext":function(){var e=this.model||this.collection;return this.selectedIndex<e.length-1&&this.selectedIndex++,this.currentlyFocusedElement()},"_selectPrevious":function(){return this.selectedIndex>0&&this.selectedIndex--,this.currentlyFocusedElement()},"currentlyFocusedElementSelector":this.options.currentlyFocusedElementSelector,"currentlyFocusedElement":function(){var e=this.model||this.collection;0!==this.selectedIndex&&this.selectedIndex>=e.length&&(this.selectedIndex=e.length-1);var i=this.$(t.str.sformat(this.currentlyFocusedElementSelector,this.selectedIndex+1));return 0!==i.length?this.$(i[0]):null}})}})}),csui.define("hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.roles",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="binf-alert binf-alert-success binf-alert-dismissible">\r\n  <strong title="'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":2,"column":17},"end":{"line":2,"column":25}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":2,"column":27},"end":{"line":2,"column":35}}}):s))+'</strong>\r\n  <div class="remove binf-alert-close binf-close" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":3,"column":59},"end":{"line":3,"column":65}}}):s))+'"\r\n       title="'+e.escapeExpression((s=null!=(s=l(i,"removeRole")||(null!=t?l(t,"removeRole"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"removeRole","hash":{},"loc":{"start":{"line":4,"column":14},"end":{"line":4,"column":28}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"removeRole")||(null!=t?l(t,"removeRole"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"removeRole","hash":{},"loc":{"start":{"line":4,"column":42},"end":{"line":4,"column":56}}}):s))+'"></div>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_dialogs_addparticipants_impl_participant.roles",o),o}),csui.define("css!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.roles",[],function(){}),csui.define("conws/widgets/team/impl/dialogs/addparticipants/impl/participant.roles.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/utils/url","conws/widgets/team/impl/behaviors/list.keyboard.behavior","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.roles","css!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.roles"],function(e,t,i,o,n,s,l,a){var r=i.ItemView.extend({"tagName":"li","template":a,"templateHelpers":function(){return{"removeRole":l.rolesDialogRemoveRole,"name":this.model.get("name"),"id":this.model.get("id")}},"events":{"click .remove":"onRemoveOnClick","keydown .binf-alert":"onRemoveOnKeyDown"},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.apply(this,arguments)},"onRemoveOnClick":function(e){e.preventDefault(),e.stopPropagation(),this.triggerMethod("remove:role",{"model":this.model})},"onRemoveOnKeyDown":function(e){13!==e.keyCode&&32!==e.keyCode&&46!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this.triggerMethod("remove:role",{"model":this.model}))}});return i.CollectionView.extend({"tagName":"ul","childView":r,"events":{"keydown":"onKeyDown"},"behaviors":{"TabableRegion":{"behaviorClass":o},"ListKeyboard":{"behaviorClass":s,"currentlyFocusedElementSelector":"li:nth-child({0}) .binf-alert"}},"constructor":function(e){i.CollectionView.prototype.constructor.apply(this,arguments)},"onAddChild":function(){this.triggerMethod("refresh:tabindexes")},"onRemoveChild":function(){this.triggerMethod("refresh:tabindexes")}})}),csui.define("hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){return'<div class="participant-content binf-pull-left"></div>\r\n<div class="participant-roles binf-pull-left"></div>\r\n<div class="participant-delete binf-pull-right"></div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_dialogs_addparticipants_impl_participant.listitem",o),o}),csui.define("hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.roles",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){return'<div class="participant-roles-list">\r\n  \x3c!-- role items --\x3e\r\n</div>\r\n<div class="conws-participants-rolepicker">\r\n  \x3c!-- roles picker region --\x3e\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_dialogs_addparticipants_impl_participant.listitem.roles",o),o}),csui.define("hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.delete",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<span class="remove csui-icon cs-icon-delete" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":1,"column":55},"end":{"line":1,"column":61}}}):s))+'"\r\n      title="'+e.escapeExpression((s=null!=(s=l(i,"removeParticipant")||(null!=t?l(t,"removeParticipant"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"removeParticipant","hash":{},"loc":{"start":{"line":2,"column":13},"end":{"line":2,"column":34}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"removeParticipant")||(null!=t?l(t,"removeParticipant"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"removeParticipant","hash":{},"loc":{"start":{"line":2,"column":48},"end":{"line":2,"column":69}}}):s))+'"></span>\r\n'}});return i.registerPartial("conws_widgets_team_impl_dialogs_addparticipants_impl_participant.listitem.delete",o),o}),csui.define("css!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem",[],function(){}),csui.define("conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/utils/url","csui/utils/contexts/factories/user","esoc/widgets/userwidget/userwidget","conws/widgets/team/impl/controls/avatar/avatar.view","conws/widgets/team/impl/controls/rolepicker/rolepicker.view","conws/widgets/team/impl/dialogs/addparticipants/impl/participant.roles.view","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem","hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.details","hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.roles","hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.delete","css!conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h,g){var f=i.ItemView.extend({"template":m,"templateHelpers":function(){return{"type":this.model.getMemberType(),"name":this.model.displayName(),"email":this.model.displayEmail(),"title":this.model.displayTitle(),"department":this.model.displayDepartment(),"office":this.model.displayOffice()}},"ui":{"personalizedImage":".csui-icon-user","defaultImage":".csui-icon-paceholder"},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.apply(this,arguments)},"initialize":function(){this.avatar=new r({"model":this.model})},"onRender":function(){if(void 0!==this.model.get("type")&&0===this.model.get("type")){var e=this.model.collection.workspaceContext.getModel(l),t={"connector":this.model.connector,"model":this.model,"userid":this.model.get("id"),"context":this.model.collection.workspaceContext,"showUserProfileLink":!0,"showMiniProfile":!0,"loggedUserId":e.get("id"),"placeholder":this.$el.find(".participant-picture"),"showUserWidgetFor":"profilepic"};a.getUser(t)}else this.$(".participant-picture").append(this.avatar.render().$el)}}),w=i.LayoutView.extend({"regions":{"rolesListRegion":".participant-roles-list","rolePickerRegion":".conws-participants-rolepicker"},"template":h,"constructor":function(e){e||(e={}),i.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"onRender":function(){var e=new d({"collection":this.model.roles});this.rolesListRegion.show(e),this.listenTo(e,"childview:remove:role",this.onRoleItemRemove);var t=new c({"placeholder":u.addParticipantsRolePickerPlaceholderMore,"roles":this.model.collection.roles,"showInherited":!1,"prettyScrolling":!0});this.rolePickerRegion.show(t),this.listenTo(t,"item:change",this.onRoleItemChanged)},"onRoleItemChanged":function(e){this.model.roles.add(e.item)},"onRoleItemRemove":function(e,t){this.model.roles.remove(t.model),0===this.model.roles.length&&this.rolePickerRegion.currentView.trigger("updateFocus")}}),v=i.ItemView.extend({"template":g,"templateHelpers":function(){return{"removeParticipant":u.addParticipantsRemove}},"events":{"click .remove":"onRemoveOnClick","keydown .remove":"onRemoveOnKeyDown"},"behaviors":{"TabableRegion":{"behaviorClass":o}},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.apply(this,arguments)},"onRemoveOnClick":function(e){e.preventDefault(),e.stopPropagation(),this.model.collection.remove(this.model)},"onRemoveOnKeyDown":function(e){13!==e.keyCode&&32!==e.keyCode&&46!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this.model.collection.remove(this.model))},"currentlyFocusedElement":function(){return this.$(".remove")}}),b=i.LayoutView.extend({"template":p,"tagName":"li","className":"binf-list-group-item conws-participant","regions":{"content":".participant-content","roles":".participant-roles","delete":".participant-delete"},"constructor":function(e){e||(e={}),i.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this.model.roles,"reset remove add",this.onParticipantRolesChanged),this.listenTo(this.model,"remove",this.onParticipantRemove),this.propagateEventsToRegions()},"onRender":function(){this.content.show(new f({"model":this.model})),this.roles.show(new w({"model":this.model})),this.delete.show(new v({"model":this.model})),this.applyRolesStyle(),this.applyRolesHeight(!0)},"onParticipantRemove":function(){this._parent.selectedIndex=this._index},"onParticipantRolesChanged":function(t,i,o){this.model.collection.trigger("change",this.model.collection),this.applyRolesStyle();var n=e.isUndefined(o.index);this.applyRolesHeight(n)},"applyRolesStyle":function(){0!==this.model.roles.length?(this.$el.addClass("has-role"),this.$el.removeClass("no-role")):(this.$el.addClass("no-role"),this.$el.removeClass("has-role"))},"applyRolesHeight":function(e){var t=this.$el.outerHeight()-this.$el.height(),i=this.$(".conws-participants-rolepicker .cs-search").outerHeight(),o=this.$(".participant-roles-list").outerHeight(),n=this.model.roles.length;n>1?o=o/(e?n-1:n+1)*n:1===n&&(o=o/(e?n:n+1)*n),this.$el.height(i+o+t/2)}});return e.extend(w.prototype,n),e.extend(b.prototype,n),b}),csui.define("hbs!conws/widgets/team/impl/controls/footer/impl/footer",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){return'<div class="conws-roles-edit-buttons binf-modal-footer">\r\n  <span class="conws-roles-edit-reset-region"></span>\r\n  <span class="conws-roles-edit-save-region"></span>\r\n  <span class="conws-roles-edit-cancel-region"></span>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_controls_footer_impl_footer",o),o}),csui.define("hbs!conws/widgets/team/impl/controls/footer/impl/button",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){return"disabled"},"3":function(e,t,i,o,n){return'data-binf-dismiss="modal"'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<button class="binf-btn binf-btn-default btn-footer '+e.escapeExpression((l=null!=(l=a(i,"css")||(null!=t?a(t,"css"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"css","hash":{},"loc":{"start":{"line":1,"column":52},"end":{"line":1,"column":59}}}):l))+'" '+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"disabled"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":61},"end":{"line":1,"column":93}}}))?s:"")+" "+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"close"):t,{"name":"if","hash":{},"fn":e.program(3,n,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":94},"end":{"line":2,"column":39}}}))?s:"")+" >"+e.escapeExpression((l=null!=(l=a(i,"label")||(null!=t?a(t,"label"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"label","hash":{},"loc":{"start":{"line":2,"column":41},"end":{"line":2,"column":50}}}):l))+"</button>\r\n"}});return i.registerPartial("conws_widgets_team_impl_controls_footer_impl_button",o),o}),csui.define("css!conws/widgets/team/impl/controls/footer/impl/footer",[],function(){}),csui.define("conws/widgets/team/impl/controls/footer/footer.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","hbs!conws/widgets/team/impl/controls/footer/impl/footer","hbs!conws/widgets/team/impl/controls/footer/impl/button","css!conws/widgets/team/impl/controls/footer/impl/footer"],function(e,t,i,o,n,s,l,a){var r=i.ItemView.extend({"tagName":"span","templateHelpers":function(){return{"label":this.model.get("label"),"css":this.model.get("css"),"disabled":this.model.get("disabled"),"close":this.model.get("close")}},"template":a,"ui":{"button":".btn-footer"},"events":{"click @ui.button":"onClick"},"behaviors":{"TabableRegion":{"behaviorClass":n}},"onClick":function(t){var i=this.model.get("click");i&&e.isFunction(i)&&i(t)},"constructor":function(e){i.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change",this.render)},"isTabable":function(){return t(this.ui.button).is(":enabled")},"currentlyFocusedElement":function(){return this.ui.button}}),c=i.LayoutView.extend({"regions":{"resetRegion":".conws-roles-edit-reset-region","submitRegion":".conws-roles-edit-save-region","cancelRegion":".conws-roles-edit-cancel-region"},"template":l,"constructor":function(e){this.buttons=e.collection.models,i.LayoutView.prototype.constructor.apply(this,arguments),this.listenTo(this,"updateButton",this.updateButton),this.propagateEventsToRegions()},"onRender":function(){var t=this;e.each(this.buttons,function(e){"reset"===e.id?(t.resetView=new r({"model":e,"initialActivationWeight":e.get("initialActivationWeight")}),t.resetRegion.show(t.resetView)):"submit"===e.id?(t.submitView=new r({"model":e,"initialActivationWeight":e.get("initialActivationWeight")}),t.submitRegion.show(t.submitView)):"cancel"===e.id&&(t.cancelView=new r({"model":e,"initialActivationWeight":e.get("initialActivationWeight")}),t.cancelRegion.show(t.cancelView))})},"updateButton":function(){var t=this;e.each(t.collection.models,function(e){e.get("disabled")||("submit"===e.id?t.submitView.currentlyFocusedElement().focus():"cancel"===e.id?t.cancelView.currentlyFocusedElement().focus():"reset"===e.id&&t.resetView.currentlyFocusedElement().focus())})}});return e.extend(c.prototype,s),c}),csui.define("hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/addparticipants",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="binf-modal-content">\r\n  <div class="binf-modal-header">\r\n    <h4 class="binf-modal-title">'+e.escapeExpression((s=null!=(s=l(i,"title")||(null!=t?l(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":3,"column":33},"end":{"line":3,"column":42}}}):s))+'</h4>\r\n    <div class="conws-addparticipants-search">\r\n      <div class="conws-addparticipants-userpicker">\r\n        \x3c!-- user picker region --\x3e\r\n      </div>\r\n      <div>\r\n        <div class="conws-addparticipants-rolepicker">\r\n          \x3c!-- roles picker region --\x3e\r\n        </div>\r\n        <div class="conws-addparticipants-rolepicker-help">'+e.escapeExpression((s=null!=(s=l(i,"roles-help")||(null!=t?l(t,"roles-help"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"roles-help","hash":{},"loc":{"start":{"line":12,"column":59},"end":{"line":12,"column":73}}}):s))+'</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <div class="binf-modal-body">\r\n    <div class="conws-addparticipants-members"></div>\r\n  </div>\r\n  <div class="conws-addparticipants-buttons">\r\n    \x3c!-- button bar region --\x3e\r\n  </div>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_dialogs_addparticipants_impl_addparticipants",o),o}),csui.define("css!conws/widgets/team/impl/dialogs/addparticipants/impl/addparticipants",[],function(){}),
csui.define("conws/widgets/team/impl/dialogs/addparticipants/addparticipants.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/utils/contexts/factories/connector","csui/utils/contexts/factories/node","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/dialogs/modal.alert/modal.alert","conws/models/workspacecontext/workspacecontext.factory","conws/widgets/team/impl/participant.model","conws/widgets/team/impl/dialogs/addparticipants/impl/participant.listitem.view","conws/widgets/team/impl/controls/rolepicker/rolepicker.view","conws/widgets/team/impl/controls/footer/footer.view","csui/controls/userpicker/userpicker.view","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/addparticipants/impl/addparticipants","css!conws/widgets/team/impl/dialogs/addparticipants/impl/addparticipants"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h,g,f){var w=o.CollectionView.extend({"tagName":"ul","className":"binf-list-group","childView":u,"constructor":function(e){o.CollectionView.call(this,e),this.listenTo(this,"moveTabIndex",this.moveTabIndex)},"moveTabIndex":function(e){this.children.each(function(t){e.children.length===e.selectedIndex&&(e.selectedIndex=e.children.length-1),t._index===e.selectedIndex&&t.roles.currentView.rolePickerRegion.currentView.trigger("updateFocus")})}}),v=o.LayoutView.extend({"template":f,"regions":{"userPickerRegion":".conws-addparticipants-userpicker","rolePickerRegion":".conws-addparticipants-rolepicker","buttonsRegion":".conws-addparticipants-buttons","participantsRegion":".conws-addparticipants-members"},"templateHelpers":{"title":g.addParticipantsTitle,"roles-help":g.addParticipantsRolesHelp},"constructor":function(e){e||(e={}),this.view=e.view,this.context=e.view.context,this.connector=e.view.context.getObject(s,e.view),e.workspaceContext||(e.workspaceContext=e.view.context.getObject(c)),this.workspaceContext=e.workspaceContext,this.teamRoles=e.view.roleCollection.clone(),this.teamParticipants=e.view.participantCollection,this.listenTo(this.view,"destroy",this.close),this.buttonsModel=void 0,o.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"onRender":function(){var t=new h({"context":this.workspaceContext,"limit":20,"clearOnSelect":!0,"placeholder":g.addParticipantsUserPickerPlaceholder,"disabledMessage":g.addParticipantsDisabledMemberMessage,"onRetrieveMembers":e.bind(this.retrieveMembersCallback,this),"prettyScrolling":!0,"initialActivationWeight":100});this.userPickerRegion.show(t),t.$(".cs-search-icon").attr("aria-label",g.addParticipantsSearchAria),this.listenTo(t,"item:change",this.onUserItemChanged);var o=new p({"roles":this.teamRoles,"showInherited":!1,"prettyScrolling":!0});this.rolePickerRegion.show(o),this.listenTo(o,"item:change",this.onRoleItemChanged);var s=new w({"context":this.options.workspaceContext,"collection":e.extend(new i.Collection,{"workspaceContext":this.workspaceContext,"node":this.workspaceContext.getModel(l),"roles":this.teamRoles,"comparator":function(e,t){return n.localeCompareString(e.get("display_name"),t.get("display_name"))}})});this.participantsRegion.show(s),this.participants=s.collection,this.listenTo(this.participants,"reset add change",this.onParticipantsChanged),this.listenTo(this.participants,"remove",this.onParticipantsRemove),this.buttonModel=new i.Collection([{"id":"reset","label":g.addParticipantsButtonClear,"css":"clear binf-pull-left","click":e.bind(this.onClickClear,this),"disabled":!0,"close":!1},{"id":"submit","label":g.addParticipantsButtonSave,"css":"save","click":e.bind(this.onClickSave,this),"disabled":!0,"close":!0},{"id":"cancel","label":g.addParticipantsButtonCancel,"css":"cancel","disabled":!1,"close":!0}]),this.buttonsRegion.show(new m({"collection":this.buttonModel}))},"onUserItemChanged":function(t){if(!t.item.get("disabled")){var o=e.extend(t.item.attributes,{"display_name":t.item.get("name_formatted")}),s=new d(o,{"connector":this.connector,"collection":this.participants});s.roles=new i.Collection(void 0,{"comparator":function(e,t){return n.localeCompareString(e.get("name"),t.get("name"))}}),this.participants.add(s),this.updateScrollbar()}},"retrieveMembersCallback":function(e){var t=this;e.collection.each(function(e){var i=!1;t.teamParticipants.findWhere({"id":e.get("id")})?i=!0:t.participants.findWhere({"id":e.get("id")})&&(i=!0),e.set("disabled",i)})},"onRoleItemChanged":function(e){this.participants.each(function(t){t.roles.add(e.item)})},"onClickSave":function(){var e=this,t=!1,i=this.participants.length;this.participants.each(function(o){e.teamParticipants.addNewParticipant(o),o.save({"add":o.roles.models},{"success":function(o){0==--i&&e.refreshAfterSave(t)},"error":function(o){t=!0,0==--i&&e.refreshAfterSave(t)}})})},"refreshAfterSave":function(e){function t(){i.teamParticipants.trigger("saved",i.teamParticipants)}var i=this;!0===e&&r.showError(g.addParticipantsErrorMessageDefault),i.teamParticipants.fetch({"success":function(){i.teamParticipants.setNewParticipant()}}).then(t,t)},"onClickClear":function(){this.participants.reset(),this.userPickerRegion.currentView.currentlyFocusedElement().focus(),this.updateScrollbar()},"onParticipantsRemove":function(){this.onParticipantsChanged(),this.participants&&this.participants.length>0?this.participantsRegion.currentView.trigger("moveTabIndex",this.participantsRegion.currentView):this.userPickerRegion.currentView.currentlyFocusedElement().focus(),this.updateScrollbar()},"onParticipantsChanged":function(){var e=0===this.participants.length,t=0===this.participants.length;this.participants.each(function(e){void 0!==e.roles&&0!==e.roles.length||(t=!0)}),this.buttonModel.get("reset").set("disabled",e),this.buttonModel.get("submit").set("disabled",t),this.$el.find(".conws-addparticipants-members").perfectScrollbar({"suppressScrollX":!0,"scrollYMarginOffset":15})},"updateScrollbar":function(){var i=this.$el.find(".conws-addparticipants-members");e.each(i,function(e){t(e).perfectScrollbar("update")})}});return e.extend(v.prototype,a),v}),csui.define("conws/utils/commands/addparticipant",["csui/lib/underscore","csui/models/command","conws/widgets/team/impl/dialogs/modaldialog/modal.dialog.view","conws/widgets/team/impl/dialogs/addparticipants/addparticipants.view","i18n!conws/utils/commands/nls/commands.lang","i18n!conws/widgets/team/impl/nls/team.lang"],function(e,t,i,o,n,s){return t.extend({"defaults":{"signature":"AddParticipant","name":n.CommandNameAddParticipant,"scope":"multiple"},"constructor":function(e){e||(e={}),this.roles=e.roles,t.prototype.constructor.apply(this,arguments)},"enabled":function(t){var i=!1;if(this.roles){i=0!==this.roles.filter(function(t){return t.get("actions").actionEdit&&e.isNull(t.get("inherited_from_id"))}).length}return i},"execute":function(e,t){new i({"dialogTxtAria":s.addParticipantsTitle,"body":new o({"view":e.originatingView}),"modalClassName":"conws-addparticipants"}).show()}})}),csui.define("conws/utils/commands/export",["csui/lib/underscore","csui/models/command","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i){return t.extend({"defaults":{"signature":"Export","name":i.CommandNameExport,"scope":"multiple"},"constructor":function(e){t.prototype.constructor.call(this,arguments)},"enabled":function(e){return!!(e&&e.nodes&&e.nodes.length>0)},"execute":function(e,t){var i=this._export(e.nodes.models);this._download(i,"export.csv")},"_exportHeader":function(){return""},"_exportModel":function(){return""},"_export":function(t){var i=this,o=this._exportHeader()+"\n";return e.each(t,function(e){o+=i._exportModel(e)+"\n"}),o},"_download":function(e,t){var i=new Blob([e],{"type":"text/csv"});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(i,t);else{var o=document.createElement("a");o.download=t,o.innerHTML="Download File","webkitURL"in window?o.href=window.webkitURL.createObjectURL(i):(o.href=window.URL.createObjectURL(i),o.style.display="none",o.onclick=function(e){document.body.removeChild(e.target)},document.body.appendChild(o)),o.trigger("click")}}})}),csui.define("conws/widgets/team/impl/commands/exportparticipants",["csui/lib/underscore","conws/utils/commands/export","i18n!conws/utils/commands/nls/commands.lang","i18n!conws/widgets/team/impl/nls/team.lang"],function(e,t,i,o){return t.extend({"defaults":{"signature":"ExportParticipants","name":i.CommandNameExportParticipants,"scope":"multiple"},"constructor":function(){t.prototype.constructor.call(this,arguments)},"_exportHeader":function(){var e="";return e+='"'+o.participantNameColTitle.replace(/"/g,'""')+'";',e+='"'+o.participantRolesColTitle.replace(/"/g,'""')+'";',e+='"'+o.participantLoginColTitle.replace(/"/g,'""')+'";',e+='"'+o.participantEmailColTitle.replace(/"/g,'""')+'";',e+='"'+o.participantDepartmentColTitle.replace(/"/g,'""')+'";'},"_exportModel":function(e){var t='"';return t+=e.get("display_name")?e.get("display_name").replace(/"/g,'""'):e.get("name").replace(/"/g,'""'),t+='";"'+e.getLeadingRole().replace(/"/g,'""')+" "+e.getRolesIndicator().replace(/"/g,'""'),t+='";"',t+=e.get("name")?e.get("name").replace(/"/g,'""'):"",t+='";"',t+=e.get("business_email")?e.get("business_email").replace(/"/g,'""'):"",t+='";"',t+=e.get("group_name")?e.get("group_name").replace(/"/g,'""'):"",t+='";'}})}),csui.define("conws/utils/commands/showroles",["csui/lib/underscore","csui/models/command","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i){return t.extend({"defaults":{"signature":"ShowRoles","name":i.CommandNameShowRoles,"scope":"single"},"enabled":function(e){return!(!e||!e.nodes||1!==e.nodes.length)},"execute":function(e,t){throw new Error("The '"+this.get("signature")+"' action must be handled by the caller.")}})}),csui.define("conws/utils/commands/removeparticipant",["csui/lib/underscore","csui/dialogs/modal.alert/modal.alert","csui/models/command","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,o){return i.extend({"defaults":{"signature":"RemoveParticipant","name":o.CommandNameRemoveParticipant,"scope":"multiple"},"enabled":function(t){if(t&&t.nodes&&t.nodes.length>0){var i=!0;return e.each(t.nodes.models,function(e){e.canRemove()||(i=!1)}),i}return!1},"execute":function(i,n){var s=1===i.nodes.length?o.RemoveParticipantTitleSingle:o.RemoveParticipantTitleMultiple,l=o.RemoveParticipantMessage,a=this;t.confirmQuestion(l,s).always(function(t){if(t){var o=i.nodes.length,n=!1;e.each(i.nodes.models,function(e){e.save({"add":[],"remove":e.roles.models},{"success":function(e){0==--o&&a._refresh(i,n)},"error":function(e){n=!0,0==--o&&a._refresh(i,n)}})})}})},"_refresh":function(e,i){!0===i&&t.showError(o.RemoveParticipantErrorMessageDefault),e.originatingView.roleCollection.fetch(),e.originatingView.participantCollection.fetch({"success":function(){e.originatingView.participantCollection.setNewParticipant(),e.originatingView.participantCollection.trigger("saved",e.originatingView.participantCollection)}})}})}),csui.define("conws/widgets/team/impl/commands/exportroles",["csui/lib/underscore","conws/utils/commands/export","i18n!conws/utils/commands/nls/commands.lang","i18n!conws/widgets/team/impl/nls/team.lang"],function(e,t,i,o){return t.extend({"defaults":{"signature":"ExportRoles","name":i.CommandNameExportRoles,"scope":"multiple"},"constructor":function(){t.prototype.constructor.call(this,arguments)},"_exportHeader":function(){var e="";return e+='"'+o.rolesNameColTitle.replace(/"/g,'""')+'";',e+='"'+o.rolesParticipantsColTitle.replace(/"/g,'""')+'";'},"_exportModel":function(e){var t="";return t+='"'+e.displayName().replace(/"/g,'""')+'";',t+='"'+e.displayMembers().replace(/"/g,'""')+'";'}})}),csui.define("conws/utils/commands/showdetails",["csui/lib/underscore","csui/models/command","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i){return t.extend({"defaults":{"signature":"ShowDetails","name":i.CommandNameShowDetails,"scope":"single"},"enabled":function(e){return!(!e||!e.nodes||1!==e.nodes.length)},"execute":function(e,t){throw new Error("The '"+this.get("signature")+"' action must be handled by the caller.")}})}),csui.define("conws/utils/commands/deleterole",["csui/lib/underscore","csui/dialogs/modal.alert/modal.alert","csui/models/command","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,o){return i.extend({"defaults":{"signature":"DeleteRoles","name":o.CommandNameDeleteRole,"scope":"multiple"},"enabled":function(t){if(t&&t.nodes&&t.nodes.length>0){var i=!0;return e.each(t.nodes.models,function(e){e.canDelete()||(i=!1),!0===e.get("leader")&&e.collection.length>1&&(i=!1)}),i}return!1},"execute":function(i,n){var s=this._evaluateMembersRemoved(i).length,l=1===i.nodes.length?o.DeleteRoleTitleSingle:o.DeleteRoleTitleMultiple,a=o.DeleteRoleMessageNoParticipantsAffected;1===s?a=o.DeleteRoleMessageParticipantsAffectedSingle:s>1&&(a=o.DeleteRoleMessageParticipantsAffectedMultiple.replace("{0}",s));var r=this;t.confirmQuestion(a,l).always(function(t){t&&e.each(e.clone(i.nodes.models),function(e){e.destroy({"wait":!0,"success":function(){0===i.nodes.length&&r._refreshCollections(i)}})})})},"_evaluateMembersRemoved":function(t){var i=(t.originatingView.participantCollection,t.originatingView.roleCollection),o=[];e.each(t.nodes.models,function(e){e.members.each(function(e){o.push(e.get("id"))})}),o=e.uniq(o);var n=[];return e.each(i.models,function(e){void 0===t.nodes.findWhere({"id":e.get("id")})&&e.members.each(function(e){n.push(e.get("id"))})}),n=e.uniq(n),e.difference(o,n)},"_refreshCollections":function(e){e.originatingView.roleCollection.fetch({"success":function(){e.originatingView.participantCollection.trigger("saved",e.originatingView.participantCollection)}})}})}),csui.define("conws/widgets/team/impl/participants.toolbaritems",["module","csui/controls/toolbar/toolitem.model","csui/controls/toolbar/toolitems.factory","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,o){return{"otherToolbar":new i({"first":[{"signature":"AddParticipant","name":o.CommandNameAddParticipant,"iconName":"csui_action_add32"}],"second":[{"signature":"PrintParticipants","name":o.CommandNamePrintParticipants,"iconName":"csui_action_print32"},{"signature":"ExportParticipants","name":o.CommandNameExportParticipants,"iconName":"csui_action_download32"}],"third":[{"signature":"ShowRoles","name":o.CommandNameShowRoles},{"signature":"RemoveParticipant","name":o.CommandNameRemoveParticipant}]})}}),csui.define("conws/widgets/team/impl/roles.toolbaritems",["module","csui/controls/toolbar/toolitem.model","csui/controls/toolbar/toolitems.factory","i18n!conws/utils/commands/nls/commands.lang"],function(e,t,i,o){return{"otherToolbar":new i({"first":[{"signature":"AddRole","name":o.CommandNameAddRole,"iconName":"csui_action_add32"}],"second":[{"signature":"PrintRoles","name":o.CommandNamePrintRoles,"iconName":"csui_action_print32"},{"signature":"ExportRoles","name":o.CommandNameExportRoles,"iconName":"csui_action_download32"}],"third":[{"signature":"ShowDetails","name":o.CommandNameShowDetails},{"signature":"DeleteRoles","name":o.CommandNameDeleteRole}]})}}),csui.define("hbs!conws/widgets/team/impl/controls/filter/impl/filter",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){return'    <div class="filter-search"></div>\r\n    <div class="filter-clear"></div>\r\n    <div class="filter-icon"></div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="conws-filter-header">\r\n  <h3 class="header-caption">'+e.escapeExpression((l=null!=(l=a(i,"caption")||(null!=t?a(t,"caption"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"caption","hash":{},"loc":{"start":{"line":2,"column":29},"end":{"line":2,"column":40}}}):l))+"</h3>\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"active"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.noop,"loc":{"start":{"line":3,"column":2},"end":{"line":7,"column":9}}}))?s:"")+"</div>\r\n"}});return i.registerPartial("conws_widgets_team_impl_controls_filter_impl_filter",o),o}),csui.define("hbs!conws/widgets/team/impl/controls/filter/impl/filter.search",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<input id="filtersearch" class="search" type="search" placeholder="'+e.escapeExpression((s=null!=(s=l(i,"caption")||(null!=t?l(t,"caption"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"caption","hash":{},"loc":{"start":{"line":1,"column":67},"end":{"line":1,"column":78}}}):s))+'" style="display:none"\r\n       value="'+e.escapeExpression((s=null!=(s=l(i,"filter")||(null!=t?l(t,"filter"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"filter","hash":{},"loc":{"start":{"line":2,"column":14},"end":{"line":2,"column":24}}}):s))+'" title="'+e.escapeExpression((s=null!=(s=l(i,"tooltip")||(null!=t?l(t,"tooltip"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"tooltip","hash":{},"loc":{"start":{"line":2,"column":33},"end":{"line":2,"column":44}}}):s))+'">\r\n'}});return i.registerPartial("conws_widgets_team_impl_controls_filter_impl_filter.search",o),o}),csui.define("hbs!conws/widgets/team/impl/controls/filter/impl/filter.clear",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<span class="sbclearer formfield_clear" title="'+e.escapeExpression((s=null!=(s=l(i,"tooltip")||(null!=t?l(t,"tooltip"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"tooltip","hash":{},"loc":{"start":{"line":1,"column":47},"end":{"line":1,"column":58}}}):s))+'" style="display:none"></span>\r\n'}});return i.registerPartial("conws_widgets_team_impl_controls_filter_impl_filter.clear",o),o}),csui.define("hbs!conws/widgets/team/impl/controls/filter/impl/filter.searchicon",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<span class="icon icon-search" style="display: inline-block" title="'+e.escapeExpression((l=null!=(l=a(i,"tooltip")||(null!=t?a(t,"tooltip"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"tooltip","hash":{},"loc":{"start":{"line":1,"column":68},"end":{"line":1,"column":79}}}):l))+'">'+(null!=(s=(a(i,"icon-v2")||t&&a(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"size":"xsmall","states":"true","iconName":"csui_action_search32"},"loc":{"start":{"line":1,"column":81},"end":{"line":1,"column":154}}}))?s:"")+"</span>\r\n"}});return i.registerPartial("conws_widgets_team_impl_controls_filter_impl_filter.searchicon",o),o}),csui.define("css!conws/widgets/team/impl/controls/filter/impl/filter",[],function(){}),csui.define("conws/widgets/team/impl/controls/filter/filter.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","conws/widgets/team/impl/controls/filter/impl/filter.model","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/controls/filter/impl/filter","hbs!conws/widgets/team/impl/controls/filter/impl/filter.search","hbs!conws/widgets/team/impl/controls/filter/impl/filter.clear","hbs!conws/widgets/team/impl/controls/filter/impl/filter.searchicon","css!conws/widgets/team/impl/controls/filter/impl/filter"],function(e,t,i,o,n,s,l,a,r,c,d){var u=i.ItemView.extend({"template":r,"templateHelpers":function(){return{"caption":this.model.get("caption"),"filter":this.model.get("filter"),"tooltip":e.str.sformat(l.searchPlaceholder,this.model.get("tooltip").toLowerCase())}},"ui":{"search":".search"},"events":{"keyup @ui.search":"onSearchKeyUp"},"behaviors":{"TabableRegion":{"behaviorClass":o}},"constructor":function(e){e.model||(e.model=new s),i.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change:showSearch",this.toggleSearch),this.listenTo(this.model,"change:filter",this.changeFilter)},"onSearchKeyUp":function(e){e.stopPropagation(),27===e.keyCode?(this.model.set("showSearch",!this.model.get("showSearch")),this.triggerMethod("close")):this.model.set("filter",this.ui.search.val())},"toggleSearch":function(){var e=this;e.model.get("showSearch")?e.ui.search.toggle("slide",{"direction":"right"},200,function(){e.ui.search.prop("tabindex","0"),e.trigger("changed:focus",e),e.ui.search.trigger("focus")}):(e.model.set("filter",""),e.ui.search.prop("tabindex","-1"),e.ui.search.toggle("slide",{"direction":"right"},200),this.triggerMethod("close"))},"changeFilter":function(){this.ui.search.val(this.model.get("filter"))},"isTabable":function(){return this.ui.search.is(":not(:disabled)")&&this.ui.search.is(":not(:hidden)")&&this.ui.search.is(":visible")},"currentlyFocusedElement":function(){return this.ui.search}}),p=i.ItemView.extend({"template":c,"templateHelpers":function(){return{"tooltip":l.searchClearIconTooltip}},"ui":{"clear":".sbclearer"},"events":{"click @ui.clear":"onClearClick","keyup @ui.clear":"onClearKeyUp"},"behaviors":{"TabableRegion":{"behaviorClass":o}},"constructor":function(e){i.ItemView.prototype.constructor.apply(this,arguments),this.listenTo(this.model,"change:filter",this.toggleClear)},"toggleClear":function(){var t=this.model.get("filter");e.isString(t)&&0!==t.length?(this.ui.clear.prop("tabindex","0"),this.ui.clear.show()):(this.ui.clear.prop("tabindex","-1"),this.ui.clear.hide())},"onClearClick":function(e){this.model.set("filter",""),this.triggerMethod("clear")},"onClearKeyUp":function(e){13!==e.keyCode&&32!==e.keyCode||(this.model.set("filter",""),this.triggerMethod("clear"))},"isTabable":function(){return this.ui.clear.is(":not(:disabled)")&&this.ui.clear.is(":not(:hidden)")&&this.ui.clear.is(":visible")},"currentlyFocusedElement":function(){return this.ui.clear}}),m=i.ItemView.extend({"template":d,"templateHelpers":function(){return{"tooltip":e.str.sformat(l.searchIconTooltip,this.model.get("tooltip"))}},"ui":{"icon":".icon-search"},"events":{"click @ui.icon":"onSearchIconClick","keydown @ui.icon":"onSearchIconKeyDown"},"behaviors":{"TabableRegion":{"behaviorClass":o}},"constructor":function(e){i.ItemView.prototype.constructor.apply(this,arguments)},"onSearchIconClick":function(e){this.model.set("showSearch",!this.model.get("showSearch"))},"onSearchIconKeyDown":function(e){13!==e.keyCode&&32!==e.keyCode||this.model.set("showSearch",!this.model.get("showSearch"))},"currentlyFocusedElement":function(){return this.ui.icon}}),h=i.LayoutView.extend({"template":a,"templateHelpers":function(){return{"caption":this.model.get("caption"),"active":this.model.get("active")}},"ui":{"label":".searchtext","search":".filter-search","clear":".filter-clear","icon":".filter-icon"},"regions":{"searchRegion":"@ui.search","clearRegion":"@ui.clear","iconRegion":"@ui.icon"},"constructor":function(e){i.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions(),this.listenTo(this.model,"change:active",this.render),this.listenTo(this.model,"change:showSearch",this.toggleLabel),this.listenTo(this,"updateFocus",this.updateFocus)},"onRender":function(){this.model.get("active")&&(this.searchView=new u({"model":this.model}),this.searchRegion.show(this.searchView),this.listenTo(this.searchView,"close",this.focusIcon),this.clearView=new p({"model":this.model}),this.clearRegion.show(this.clearView),this.listenTo(this.clearView,"clear",this.focusSearch),this.iconView=new m({"model":this.model,"initialActivationWeight":this.options.initialActivationWeight}),this.iconRegion.show(this.iconView))},"toggleLabel":function(){this.model.get("showSearch")?this.ui.label.hide():this.ui.label.show()},"updateFocus":function(){this.model.get("showSearch")?(this.searchView.trigger("changed:focus",this.searchView),this.focusSearch()):this.focusIcon()},"focusSearch":function(){this.searchView.currentlyFocusedElement().trigger("focus")},"focusIcon":function(){this.iconView.currentlyFocusedElement().trigger("focus")}});return e.extend(h.prototype,n),h}),csui.define("hbs!conws/widgets/team/impl/dialogs/participants/impl/roles.edit.list.remove",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"    <ul>\r\n"+(null!=(s=l(i,"each").call(null!=t?t:e.nullContext||{},null!=t?l(t,"setRoles"):t,{"name":"each","hash":{},"fn":e.program(2,n,0),"inverse":e.noop,"loc":{"start":{"line":4,"column":6},"end":{"line":19,"column":15}}}))?s:"")+"    </ul>\r\n"},"2":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <li class="conws-roles-remove-item">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"inherited_from_id"):t,{"name":"if","hash":{},"fn":e.program(3,n,0),"inverse":e.program(5,n,0),"loc":{"start":{"line":6,"column":10},"end":{"line":17,"column":17}}}))?s:"")+"        </li>\r\n"},"3":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'            <div class="conws-roles-edit-canedit-setitem-inherit">\r\n              <div class="conws-roles-edit-canedit-name" title="'+e.escapeExpression((l=null!=(l=a(i,"name")||(null!=t?a(t,"name"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":8,"column":64},"end":{"line":8,"column":72}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"name")||(null!=t?a(t,"name"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":8,"column":74},"end":{"line":8,"column":82}}}):l))+'</div>\r\n              <div class="conws-roles-edit-canedit-inherit">'+e.escapeExpression(e.lambda(null!=(s=null!=t?a(t,"captions"):t)?a(s,"RoleInherited"):s,t))+"</div>\r\n            </div>\r\n"},"5":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'            <div class="conws-roles-edit-canedit-setitem conws-roles-edit-itemaction-remove">\r\n              <div class="conws-roles-edit-canedit-name" title="'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":13,"column":64},"end":{"line":13,"column":72}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":13,"column":74},"end":{"line":13,"column":82}}}):s))+'</div>\r\n              <a href="#" class="csui-icon inline-edit-icon binf-close" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":14,"column":81},"end":{"line":14,"column":87}}}):s))+'"\r\n                 title="'+e.escapeExpression((s=null!=(s=l(i,"removeRole")||(null!=t?l(t,"removeRole"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"removeRole","hash":{},"loc":{"start":{"line":15,"column":24},"end":{"line":15,"column":38}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"removeRole")||(null!=t?l(t,"removeRole"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"removeRole","hash":{},"loc":{"start":{"line":15,"column":52},"end":{"line":15,"column":66}}}):s))+'"></a>\r\n            </div>\r\n'},"7":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"removeParticipant"):t,{"name":"if","hash":{},"fn":e.program(8,n,0),"inverse":e.noop,"loc":{"start":{"line":22,"column":4},"end":{"line":32,"column":11}}}))?s:""},"8":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <div class="conws-roles-edit-canedit-empty">\r\n        <span class="csui-icon csui-icon-notification-warning"\r\n              title="'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"captions"):t)?l(s,"RemoveParticipantWarning"):s,t))+'" aria-label="'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"captions"):t)?l(s,"RemoveParticipantWarning"):s,t))+'">\r\n        </span>\r\n        <div class="conws-roles-edit-canedit-empty-text">\r\n          <h2>'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"captions"):t)?l(s,"RemoveParticipant1"):s,t))+"</h2>\r\n          <h4>"+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"captions"):t)?l(s,"RemoveParticipant2"):s,t))+"</h4>\r\n        </div>\r\n      </div>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<div>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"setRoles"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.program(7,n,0),"loc":{"start":{"line":2,"column":2},"end":{"line":33,"column":9}}}))?s:"")+"</div>\r\n"}});return i.registerPartial("conws_widgets_team_impl_dialogs_participants_impl_roles.edit.list.remove",o),o}),csui.define("conws/widgets/team/impl/dialogs/participants/impl/roles.edit.list.remove.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/controls/globalmessage/globalmessage","csui/behaviors/keyboard.navigation/tabable.region.behavior","conws/widgets/team/impl/behaviors/list.keyboard.behavior","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/participants/impl/roles.edit.list.remove"],function(e,t,i,o,n,s,l,a,r){return i.LayoutView.extend({"className":"conws-roles-edit-remove-list","template":r,"filterModel":{},"constructor":function(e){e||(e={}),this.model=e.model,this.filterModel=e.filterModel,this.selectedIndex=0,i.LayoutView.prototype.constructor.apply(this,arguments)},"ui":{"item":".conws-roles-edit-itemaction-remove a","focusedItem":"li"},"events":{"click @ui.item":"itemRemove","click @ui.focusedItem":"itemRemove","keydown":"onKeyDownExt"},"captions":{"RemoveParticipant1":a.rolesDialogRemoveParticipant1,"RemoveParticipant2":a.rolesDialogRemoveParticipant2,"RemoveParticipantWarning":a.rolesDialogRemoveParticipantWarning,"RoleInherited":a.rolesNameColInherited},"behaviors":{"TabableRegion":{"behaviorClass":s},"ListKeyboard":{"behaviorClass":l}},"onKeyDownExt":function(e){var t=this.currentlyFocusedElement();switch(e.keyCode){case 38:this.calculateSelectedIndex(),this._moveTo(e,this._selectPrevious(),t);break;case 40:this.calculateSelectedIndex(),this._moveTo(e,this._selectNext(),t);break;case 13:case 32:case 46:this.currentlyFocusedElement().trigger("click",e)}},"initialize":function(){this.listenTo(this.filterModel,"change",this.render),this.listenTo(this.filterModel,"change:filter",function(){this.selectedIndex=0}),
this.listenTo(this,"updateFocus",this.updateFocus),this.listenTo(this.model,"add change reset remove",this.render)},"templateHelpers":function(){var t={"removeRole":a.rolesDialogRemoveRole,"setRoles":this.model.filterList(this.filterModel.get("filter")).toJSON(),"removeParticipant":0===this.model.length,"captions":this.captions};return t.setRoles=e.each(t.setRoles,function(e){return e.removeRole=t.removeRole,e.captions=t.captions,e}),t},"calculateSelectedIndex":function(){var e=this.filterModel.get("filter");e.length?(this.totalCount=this.model.filterList(e).models.length,0!==this.selectedIndex&&this.selectedIndex===this.totalCount-1&&(this.selectedIndex=this.selectedIndex-1)):this.totalCount=this.model.length},"updateFocus":function(){this.trigger("changed:focus",this),this.currentlyFocusedElement().trigger("focus")},"itemRemove":function(i){var o=t(i.currentTarget),n=o.data("id");e.isUndefined(n)&&o.find(this.ui.item)&&(n=t(i.currentTarget).find(this.ui.item).data("id")),this.calculateSelectedIndex(),this.model.remove(n),i.preventDefault(),i.stopPropagation()}})}),csui.define("hbs!conws/widgets/team/impl/dialogs/participants/impl/roles.edit.list",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'            <li class="conws-roles-edit-item">\r\n              <div>\r\n                <a href="#" class="conws-roles-edit-itemaction-select conws-roles-edit-canedit-selectitem" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":6,"column":116},"end":{"line":6,"column":122}}}):s))+'"><span title="'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":6,"column":137},"end":{"line":6,"column":145}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":6,"column":147},"end":{"line":6,"column":155}}}):s))+"</span></a>\r\n              </div>\r\n            </li>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<div>\r\n    <ul>\r\n"+(null!=(s=l(i,"each").call(null!=t?t:e.nullContext||{},null!=t?l(t,"allRoles"):t,{"name":"each","hash":{},"fn":e.program(1,n,0),"inverse":e.noop,"loc":{"start":{"line":3,"column":8},"end":{"line":9,"column":17}}}))?s:"")+"    </ul>\r\n</div>\r\n"}});return i.registerPartial("conws_widgets_team_impl_dialogs_participants_impl_roles.edit.list",o),o}),csui.define("conws/widgets/team/impl/dialogs/participants/impl/roles.edit.list.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/behaviors/keyboard.navigation/tabable.region.behavior","conws/widgets/team/impl/behaviors/list.keyboard.behavior","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/participants/impl/roles.edit.list"],function(e,t,i,o,n,s,l,a){return i.LayoutView.extend({"className":"conws-roles-edit-list","template":a,"filterModel":{},"constructor":function(e){e||(e={}),this.model=e.model,this.filterModel=e.filterModel,this.selectedIndex=0,i.LayoutView.prototype.constructor.apply(this,arguments)},"ui":{"select":"a.conws-roles-edit-itemaction-select"},"events":{"click @ui.select":"itemSelect","click li":"itemSelect","dragstart @ui.select":"itemDrag","keydown":"onKeyDownExt"},"behaviors":{"TabableRegion":{"behaviorClass":n},"ListKeyboard":{"behaviorClass":s}},"onKeyDownExt":function(e){var t=this.currentlyFocusedElement();switch(e.keyCode){case 38:this.calculateSelectedIndex(),this._moveTo(e,this._selectPrevious(),t);break;case 40:this.calculateSelectedIndex(),this._moveTo(e,this._selectNext(),t);break;case 13:case 32:this.currentlyFocusedElement().trigger("click",e)}},"initialize":function(){this.listenTo(this.filterModel,"change",this.render),this.listenTo(this.filterModel,"change:filter",function(){this.selectedIndex=0}),this.listenTo(this.model,"add change reset remove",this.render),this.listenTo(this,"updateFocus",this.updateFocus)},"templateHelpers":function(){return{"allRoles":this.model.filterList(this.filterModel.get("filter")).toJSON()}},"calculateSelectedIndex":function(){var e=this.filterModel.get("filter");e.length?(this.totalCount=this.model.filterList(e).models.length,0!==this.selectedIndex&&this.selectedIndex===this.totalCount-1&&(this.selectedIndex=this.selectedIndex-1)):this.totalCount=this.model.length},"updateFocus":function(){this.trigger("changed:focus",this),this.currentlyFocusedElement().trigger("focus")},"itemSelect":function(i){var o=t(i.currentTarget),n=o.data("id");e.isUndefined(n)&&o.find(this.ui.select).length>0&&(n=t(i.currentTarget).find(this.ui.select).data("id")),this.calculateSelectedIndex(),this.model.remove(n),i.preventDefault(),i.stopPropagation()},"itemDrag":function(e){return!1}})}),csui.define("hbs!conws/widgets/team/impl/dialogs/participants/impl/roles.readonly.list",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <li class="conws-roles-readonly-item" title="'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":4,"column":51},"end":{"line":4,"column":59}}}):s))+'"><span>'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":4,"column":67},"end":{"line":4,"column":75}}}):s))+"</span></li>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l,a,r=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]},c="<div>\r\n  <ul>\r\n";return l=null!=(l=r(i,"roles")||(null!=t?r(t,"roles"):t))?l:e.hooks.helperMissing,a={"name":"roles","hash":{},"fn":e.program(1,n,0),"inverse":e.noop,"loc":{"start":{"line":3,"column":4},"end":{"line":5,"column":14}}},s="function"==typeof l?l.call(null!=t?t:e.nullContext||{},a):l,r(i,"roles")||(s=e.hooks.blockHelperMissing.call(t,s,a)),null!=s&&(c+=s),c+"  </ul>\r\n</div>\r\n"}});return i.registerPartial("conws_widgets_team_impl_dialogs_participants_impl_roles.readonly.list",o),o}),csui.define("css!conws/widgets/team/impl/cells/roles/impl/roles",[],function(){}),csui.define("conws/widgets/team/impl/dialogs/participants/impl/roles.readonly.list.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/behaviors/keyboard.navigation/tabable.region.behavior","conws/widgets/team/impl/behaviors/list.keyboard.behavior","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/participants/impl/roles.readonly.list","css!conws/widgets/team/impl/cells/roles/impl/roles"],function(e,t,i,o,n,s,l,a){return i.LayoutView.extend({"template":a,"events":{"keydown":"onKeyDown"},"behaviors":{"TabableRegion":{"behaviorClass":n},"ListKeyboard":{"behaviorClass":s}},"constructor":function(e){this.selectedIndex=0,i.LayoutView.prototype.constructor.apply(this,arguments)},"templateHelpers":function(){return{"roles":this.model.toJSON()}}})}),csui.define("hbs!conws/widgets/team/impl/dialogs/participants/impl/roles.edit",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){return'      <div class="conws-roles-edit-canedit">\r\n        <div\r\n            class="conws-roles-edit-canedit-left conws-roles-edit-left conws-roles-edit-canedit-separator">\r\n          <div class="conws-roles-edit-canedit-header">\r\n            <div class="conws-roles-edit-canedit-setroles-region"></div>\r\n          </div>\r\n          <div class="conws-roles-edit-canedit-content">\r\n            <div class="conws-roles-edit-canedit-setroles-list-region"></div>\r\n          </div>\r\n        </div>\r\n        <div class="conws-roles-edit-canedit-right conws-roles-edit-right">\r\n          <div class="conws-roles-edit-canedit-header">\r\n            <div class="conws-roles-edit-canedit-allroles-region"></div>\r\n          </div>\r\n          <div class="conws-roles-edit-canedit-content">\r\n            <div class="conws-roles-edit-canedit-allroles-list-region"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n'},"3":function(e,t,i,o,n){return'      <div class="conws-roles-edit-readonly">\r\n        <div class="conws-roles-readonly-region"></div>\r\n      </div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="binf-modal-content">\r\n  <div class="binf-modal-header">\r\n    <h2 class="binf-modal-title">'+e.escapeExpression((l=null!=(l=a(i,"title")||(null!=t?a(t,"title"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":3,"column":33},"end":{"line":3,"column":42}}}):l))+'</h2>\r\n  </div>\r\n  <div class="binf-modal-body">\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"canEdit"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.program(3,n,0),"loc":{"start":{"line":6,"column":4},"end":{"line":30,"column":11}}}))?s:"")+'  </div>\r\n  <div class="conws-roles-edit-buttons-region"></div>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_dialogs_participants_impl_roles.edit",o),o}),csui.define("css!conws/widgets/team/impl/dialogs/participants/impl/roles.edit",[],function(){}),csui.define("conws/widgets/team/impl/dialogs/participants/roles.edit.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/handlebars","csui/dialogs/modal.alert/modal.alert","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","csui/behaviors/keyboard.navigation/tabable.region.behavior","conws/widgets/team/impl/controls/filter/filter.view","conws/widgets/team/impl/controls/filter/impl/filter.model","conws/widgets/team/impl/dialogs/participants/impl/roles.edit.list.remove.view","conws/widgets/team/impl/dialogs/participants/impl/roles.edit.list.view","conws/widgets/team/impl/dialogs/participants/impl/roles.readonly.list.view","conws/widgets/team/impl/controls/footer/footer.view","conws/widgets/team/impl/roles.model.expanded","conws/widgets/team/impl/participants.model","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/participants/impl/roles.edit","conws/widgets/team/impl/roles.model","css!conws/widgets/team/impl/dialogs/participants/impl/roles.edit","css!conws/widgets/team/impl/cells/roles/impl/roles"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h,g,f,w,v){var b={"Close":f.rolesDialogButtonClose,"Save":f.rolesDialogButtonSave,"Cancel":f.rolesDialogButtonCancel,"Reset":f.rolesDialogButtonReset,"Remove":f.rolesDialogButtonRemove},y=o.LayoutView.extend({"rolesCountForFilter":15,"modified":!1,"availableRoles":new v,"assignedRoles":new v,"filterModel1":void 0,"filterModel2":void 0,"constructor":function(e){e||(e={}),this.teamRoles=e.roleCollection,this.teamParticipants=e.participantCollection,o.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"template":w,"regions":{"assignedRolesHeaderRegion":".conws-roles-edit-canedit-setroles-region","assignedRolesListRegion":".conws-roles-edit-canedit-setroles-list-region","availableRolesHeaderRegion":".conws-roles-edit-canedit-allroles-region","availableRolesListRegion":".conws-roles-edit-canedit-allroles-list-region","readonlyRolesListRegion":".conws-roles-readonly-region","buttonsRegion":".conws-roles-edit-buttons-region"},"ui":{"footer":".conws-roles-edit-buttons-region"},"captions":{"AssignedRoles":f.rolesDialogAssignedRoles,"TooltipAssignedRoles":f.rolesDialogTooltipAssignedRoles,"AvailableRoles":f.rolesDialogAvailableRoles,"TooltipAvailableRoles":f.rolesDialogTooltipAvailableRoles},"initialize":function(){if(!e.isUndefined(this.model)){this.assignedRoles.reset(this.model.roles.models);var t=this.model.collection.availableRoles.clone();t.remove(this.assignedRoles.models);var i=t.filter(function(t){var i=t.get("inherited_from_id");return e.isUndefined(i)||e.isNull(i)});this.availableRoles.reset(i),e.isUndefined(this.filterModel1)||this.filterModel1.set("resetFilter",!0),e.isUndefined(this.filterModel2)||this.filterModel2.set("resetFilter",!0),this.modified=!1,this.setDialogState(),this.listenTo(this.assignedRoles,"remove",this.removeAssignedRole),this.listenTo(this.availableRoles,"remove",this.addAvailableRole)}},"removeAssignedRole":function(e){var t=e;this.availableRoles.add(t),this.modified=!0,this.setDialogState(),0===this.assignedRoles.length?this.filterModel2.get("active")?this.availableRolesHeaderRegion.currentView.trigger("updateFocus"):this.availableRolesListRegion.currentView.trigger("updateFocus"):this.assignedRolesListRegion.currentView.totalCount-1==0&&this.filterModel1.get("active")&&this.assignedRolesHeaderRegion.currentView.trigger("updateFocus")},"addAvailableRole":function(e){var t=e;this.assignedRoles.add(t),this.modified=!0,this.setDialogState(),0===this.availableRoles.length?this.filterModel1.get("active")?this.assignedRolesHeaderRegion.currentView.trigger("updateFocus"):this.assignedRolesListRegion.currentView.trigger("updateFocus"):this.availableRolesListRegion.currentView.totalCount-1==0&&this.filterModel2.get("active")&&this.availableRolesHeaderRegion.currentView.trigger("updateFocus")},"setDialogState":function(){!e.isUndefined(this.filterModel1)&&e.isEmpty(this.filterModel1.get("filter"))&&this.filterModel1.set("active",this.assignedRoles.length>=this.rolesCountForFilter),!e.isUndefined(this.filterModel2)&&e.isEmpty(this.filterModel2.get("filter"))&&this.filterModel2.set("active",this.availableRoles.length>=this.rolesCountForFilter),e.isUndefined(this.editRolesButtons)||(this.editRolesButtons.collection.findWhere({"id":"submit"}).set({"disabled":!this.modified}),this.assignedRoles.length>0?this.editRolesButtons.collection.findWhere({"id":"submit"}).set({"label":b.Save}):this.editRolesButtons.collection.findWhere({"id":"submit"}).set({"label":b.Remove}))},"templateHelpers":function(){var t=f.userRolesDialogTitle;return"group"===this.model.getMemberType()&&(t=f.groupRolesDialogTitle),{"title":e.str.sformat(t,this.model.get("display_name")),"canEdit":this.model.canEdit()}},"updateScrollbar":function(){var i=this.$el.find(".binf-modal-body .conws-roles-edit-readonly");e.each(i,function(e){t(e).perfectScrollbar("update")});var o=this.$el.find(".conws-roles-edit-canedit-content");e.each(o,function(e){t(e).perfectScrollbar("update")})},"onAfterShow":function(){this.$el.find(".binf-modal-body .conws-roles-edit-readonly").perfectScrollbar({"suppressScrollX":!0,"scrollYMarginOffset":15}),this.$el.find(".conws-roles-edit-canedit-content").perfectScrollbar({"suppressScrollX":!0,"scrollYMarginOffset":15}),this.updateScrollbar()},"onRender":function(){this.model.canEdit()?(this.filterModel1=new c({"caption":this.captions.AssignedRoles,"tooltip":this.captions.TooltipAssignedRoles,"active":this.assignedRoles.length>=this.rolesCountForFilter}),this.assignedRolesHeaderRegion.show(new r({"model":this.filterModel1,"initialActivationWeight":this.assignedRoles.length>=this.rolesCountForFilter?100:0})),this.assignedRolesListRegion.show(new d({"model":this.assignedRoles,"filterModel":this.filterModel1,"initialActivationWeight":this.assignedRoles.length>0?100:0})),this.listenTo(this.assignedRolesListRegion.currentView,"dom:refresh",this.updateScrollbar),this.filterModel2=new c({"caption":this.captions.AvailableRoles,"tooltip":this.captions.TooltipAvailableRoles,"active":this.availableRoles.length>=this.rolesCountForFilter}),this.availableRolesHeaderRegion.show(new r({"model":this.filterModel2})),this.availableRolesListRegion.show(new u({"model":this.availableRoles,"filterModel":this.filterModel2})),this.listenTo(this.availableRolesListRegion.currentView,"dom:refresh",this.updateScrollbar)):this.readonlyRolesListRegion.show(new p({"model":this.model.roles,"initialActivationWeight":this.model.roles.length>0?100:0})),this._renderFooter()},"saveClicked":function(){var e=this;new g(void 0,{"connector":e.model.collection.connector,"node":e.model.collection.node,"context":e.model.collection.workspaceContext,"autoreset":!0}).fetch({"success":function(t){var i,o=t.find(function(t){return t.get("id")===e.model.get("id")});if(o&&o.roles.length===e.model.roles.length&&(i=!1,o.roles.each(function(t){var o=t.id;e.model.roles.find(function(e){return e.id===o})||(i=!0)})),!1===i)e.saveRolesForUser();else{var n=f.rolesEditDialogDataNotUptoDateUser;"group"===e.model.getMemberType()&&(n=f.rolesEditDialogDataNotUptoDateGroup),s.showError(n,e.getErrorMessageTitle()).always(function(t){e.refreshAfterSave()})}}})},"saveRolesForUser":function(){var t=this,i=[];this.model.roles.each(function(e){var o=e.id;t.assignedRoles.find(function(e){return e.id===o})||i.push(e)});var o=[];this.assignedRoles.each(function(e){var i=e.id;t.model.roles.find(function(e){return e.id===i})||o.push(e)}),this.model.save({"add":o,"remove":i},{"success":function(e){t.refreshAfterSave()},"error":function(i){var o="";if(i.successAdd.length>0){var n=f.rolesEditDialogSuccessfulAdded;e.each(i.successAdd,function(e){n=n+"\n"+e.role.get("name")}),o=n}if(i.errorAdd.length>0){var l=f.rolesEditDialogNotAdded;e.each(i.errorAdd,function(e){l=l+"\n"+e.role.get("name")}),o.length>0&&(o+="\n"),o+=l}if(i.successRemove.length>0){var a=f.rolesEditDialogSuccessfulRemoved;e.each(i.successRemove,function(e){a=a+"\n"+e.role.get("name")}),o.length>0&&(o+="\n"),o+=a}if(i.errorRemove.length>0){var r=f.rolesEditDialogNotRemoved;e.each(i.errorRemove,function(e){r=r+"\n"+e.role.get("name")}),o.length>0&&(o+="\n"),o+=r}s.showError(o,t.getErrorMessageTitle()).always(function(e){t.refreshAfterSave()})}})},"getErrorMessageTitle":function(){var t=f.rolesEditDialogErrorTitleUser;return"group"===this.model.getMemberType()&&(t=f.rolesEditDialogErrorTitleGroup),e.str.sformat(t,this.model.get("display_name")?this.model.get("display_name"):this.model.get("name"))},"refreshAfterSave":function(){function e(){i.trigger("refetched")}function t(){i.teamParticipants.trigger("saved",i.teamParticipants),i.teamRoles.fetch().then(e,e)}var i=this;this.teamParticipants.fetch({"success":function(){i.teamParticipants.setNewParticipant()}}).then(t,t)},"resetClicked":function(){this.initialize()},"_renderFooter":function(){var t=this.editRolesButtons;if(t)this.ui.footer.removeClass("binf-hidden"),this.buttonsRegion.show(t);else{var o=[];o=this.model.canEdit()?[{"id":"reset","label":b.Reset,"css":"conws-roles-edit-button binf-pull-left conws-roles-edit-button-reset","click":e.bind(this.resetClicked,this)},{"id":"submit","label":b.Save,"css":"conws-roles-edit-button conws-roles-edit-button-save","click":e.bind(this.saveClicked,this),"disabled":!0,"close":!0},{"id":"cancel","label":b.Cancel,"css":"conws-roles-edit-button conws-roles-edit-button-cancel","close":!0}]:[{"id":"cancel","label":b.Close,"css":"conws-roles-edit-button binf-pull-right","close":!0,"initialActivationWeight":100}],t=this.editRolesButtons=new m({"collection":new i.Collection(o)}),this.buttonsRegion.show(t)}}});return e.extend(y.prototype,l),y}),csui.define("hbs!conws/widgets/team/impl/dialogs/role/impl/role.details.member",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <span class="member-name" title="'+e.escapeExpression((s=null!=(s=l(i,"displayName")||(null!=t?l(t,"displayName"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"displayName","hash":{},"loc":{"start":{"line":5,"column":39},"end":{"line":5,"column":54}}}):s))+'"></span>\r\n'},"3":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <span class="member-name" title="'+e.escapeExpression((s=null!=(s=l(i,"displayName")||(null!=t?l(t,"displayName"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"displayName","hash":{},"loc":{"start":{"line":7,"column":39},"end":{"line":7,"column":54}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"displayName")||(null!=t?l(t,"displayName"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"displayName","hash":{},"loc":{"start":{"line":7,"column":56},"end":{"line":7,"column":71}}}):s))+'</span>\r\n      <a class="member-email" href="mailto:'+e.escapeExpression((s=null!=(s=l(i,"email")||(null!=t?l(t,"email"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"email","hash":{},"loc":{"start":{"line":8,"column":43},"end":{"line":8,"column":52}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"email")||(null!=t?l(t,"email"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"email","hash":{},"loc":{"start":{"line":8,"column":54},"end":{"line":8,"column":63}}}):s))+"</a>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div>\r\n  <div class="conws-role-details-avatar"></div>\r\n  <div class="member-details">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"isUser"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.program(3,n,0),"loc":{"start":{"line":4,"column":4},"end":{"line":9,"column":11}}}))?s:"")+"  </div>\r\n</div>"}});return i.registerPartial("conws_widgets_team_impl_dialogs_role_impl_role.details.member",o),o}),csui.define("css!conws/widgets/team/impl/dialogs/role/impl/role.details.member",[],function(){}),csui.define("conws/widgets/team/impl/dialogs/role/impl/role.details.member.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/utils/url","csui/utils/base","csui/utils/contexts/factories/user","conws/widgets/team/impl/controls/avatar/avatar.view","esoc/widgets/userwidget/userwidget","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/role/impl/role.details.member","css!conws/widgets/team/impl/dialogs/role/impl/role.details.member"],function(e,t,i,o,n,s,l,a,r,c,d){return i.ItemView.extend({"template":d,"tagName":"li","className":"conws-role-details-member","region":{"avatar":".conws-role-details-avatar"},"ui":{"userProfileName":".member-name","userProfileImg":".conws-role-details-avatar"},"events":{"keydown":"onKeyDown","touchstart @ui.userProfileName":"onTouchProfileName"},"onKeyDown":function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this.$(".esoc-user-profile-link").trigger("click"))},"onTouchProfileName":function(e){this.$(".esoc-user-profile-link").trigger("click")},"constructor":function(e){e||(e={}),i.ItemView.prototype.constructor.apply(this,arguments)},"initialize":function(){this.avatar=new a({"model":this.model})},"onRender":function(){if(void 0!==this.model.get("type")&&0===this.model.get("type")){var e=this.model.collection.context.getModel(l),i={"connector":this.model.connector,"model":this.model,"userid":this.model.get("id"),"context":this.model.collection.context,"showUserProfileLink":!0,"showMiniProfile":!s.isTouchBrowser(),"loggedUserId":e.get("id")},o=t.extend({"placeholder":this.$el.find(this.ui.userProfileImg),"showUserWidgetFor":"profilepic"},i);r.getUser(o);var n=t.extend({"placeholder":this.$el.find(this.ui.userProfileName)},i);r.getUser(n)}else this.$(".conws-role-details-avatar").append(this.avatar.render().$el)},"templateHelpers":function(){return{"displayName":this.model.displayName(),"email":this.model.displayEmail(),"isUser":0===this.model.get("type")}}})}),csui.define("conws/widgets/team/impl/dialogs/role/impl/role.details.members.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/behaviors/keyboard.navigation/tabable.region.behavior","conws/widgets/team/impl/behaviors/list.keyboard.behavior","conws/widgets/team/impl/dialogs/role/impl/role.details.member.view","i18n!conws/widgets/team/impl/nls/team.lang"],function(e,t,i,o,n,s,l,a){return i.CollectionView.extend({"className":"conws-role-details-members-list","childView":l,"tagName":"ul","events":{"keydown":"onKeyDown"},"behaviors":{"TabableRegion":{"behaviorClass":n},"ListKeyboard":{"behaviorClass":s}},"filterModel":{},"constructor":function(e){e||(e={}),this.collection=e.model,this.filterModel=e.filterModel,i.CollectionView.prototype.constructor.apply(this,arguments)},"initialize":function(){this.listenTo(this.filterModel,"change",this.render),this.listenTo(this.filterModel,"change:filter",function(){this.selectedIndex=0})},"addChild":function(t,o,n){if(!e.isUndefined(this.filterModel)){var s=this.filterModel.get("filter");if(!e.isUndefined(s)&&s.length>0){if(t.displayName().toLowerCase().indexOf(s.toLowerCase())<0)return}}i.CollectionView.prototype.addChild.apply(this,arguments)}})}),csui.define("hbs!conws/widgets/team/impl/dialogs/role/impl/role.details",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                        <div class="conws-role-details-rolename-text">\r\n                            <div class="general-text">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"model"):t)?l(s,"name"):s,t))+"</div>\r\n                        </div>\r\n"},"3":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                        <input type="text" value="'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"model"):t)?l(s,"name"):s,t))+'" />\r\n'},"5":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                        <div class="conws-role-details-roledescription-text">\r\n                            <div class="general-text">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"model"):t)?l(s,"description"):s,t))+"</div>\r\n                        </div>\r\n"},"7":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                        <textarea rows="8">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"model"):t)?l(s,"description"):s,t))+"</textarea>\r\n"},"9":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'                    <div class="conws-role-details-rolepermissions">\r\n                        <h3>'+e.escapeExpression(e.lambda(null!=(s=null!=t?a(t,"captions"):t)?a(s,"Permissions"):s,t))+'</h3>\r\n                        <div class="conws-role-details-permissions">\r\n                            <div class="conws-role-details-teamlead-caption general-text" id="'+e.escapeExpression((l=null!=(l=a(i,"labelId")||(null!=t?a(t,"labelId"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"labelId","hash":{},"loc":{"start":{"line":32,"column":94},"end":{"line":32,"column":105}}}):l))+'">'+e.escapeExpression(e.lambda(null!=(s=null!=t?a(t,"captions"):t)?a(s,"TeamLead"):s,t))+'</div>\r\n                            <div class="conws-role-details-teamlead-switch"></div>\r\n                        </div>\r\n                    </div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="binf-modal-content">\r\n    <div class="binf-modal-header">\r\n        <h2 class="binf-modal-title">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"captions"):t)?l(s,"Title"):s,t))+'</h2>\r\n    </div>\r\n    <div class="binf-modal-body">\r\n        <div class="conws-role-details-canedit">\r\n            <div class="conws-role-details-canedit-left conws-role-details-left conws-role-details-canedit-separator">\r\n                <div class="conws-role-details-rolename">\r\n                    <h3>'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"captions"):t)?l(s,"RoleName"):s,t))+"</h3>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"readonly"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.program(3,n,0),"loc":{"start":{"line":10,"column":20},"end":{"line":16,"column":27}}}))?s:"")+'                </div>\r\n                <div class="conws-role-details-roledescription">\r\n                    <h3>'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"captions"):t)?l(s,"Description"):s,t))+"</h3>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"readonly"):t,{"name":"if","hash":{},"fn":e.program(5,n,0),"inverse":e.program(7,n,0),"loc":{"start":{"line":20,"column":20},"end":{"line":26,"column":27}}}))?s:"")+"                </div>\r\n"+(null!=(s=l(i,"unless").call(null!=t?t:e.nullContext||{},null!=t?l(t,"hideTeamLead"):t,{"name":"unless","hash":{},"fn":e.program(9,n,0),"inverse":e.noop,"loc":{"start":{"line":28,"column":16},"end":{"line":36,"column":27}}}))?s:"")+'            </div>\r\n            <div class="conws-role-details-canedit-right conws-role-details-right">\r\n                <div class="conws-role-details-header">\r\n                    <div class="conws-role-details-participants-region"></div>\r\n                </div>\r\n                <div class="conws-role-details-canedit-content">\r\n                    <div class="conws-role-details-participants-list-region"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="conws-role-details-buttons-region"></div>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_dialogs_role_impl_role.details",o),o}),csui.define("css!conws/widgets/team/impl/dialogs/role/impl/role.details",[],function(){}),csui.define("conws/widgets/team/impl/dialogs/role/role.details.view",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/lib/handlebars","csui/controls/form/fields/booleanfield.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","conws/widgets/team/impl/controls/filter/filter.view","conws/widgets/team/impl/controls/filter/impl/filter.model","conws/widgets/team/impl/controls/footer/footer.view","conws/widgets/team/impl/dialogs/role/impl/role.details.members.view","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/dialogs/role/impl/role.details","css!conws/widgets/team/impl/dialogs/role/impl/role.details"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m){var h=e.config(),g=n.LayoutView.extend({"rolesCountForFilter":15,"filterModel":void 0,"constructor":function(e){e||(e={}),n.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions(),i(window).on("resize",t.bind(this.onWindowResize,this))},"onWindowResize":function(){this.updateScrollbar()},"template":m,"captions":{"Title":p.roleDetailsTitle,"RoleName":p.roleDetailsName,"Participants":p.rolesParticipantsColTitle,"RolesParticipantsColTooltip":p.rolesParticipantsColTooltip,
"Description":p.roleDetailsDescription,"Permissions":p.roleDetailsPermissions,"TeamLead":p.rolesNameColTeamLead,"Read":p.roleDetailsRead,"Write":p.roleDetailsWrite,"Manage":p.roleDetailsManage,"Advanced":p.roleDetailsAdvanced},"regions":{"participantsHeaderRegion":".conws-role-details-participants-region","participantsListRegion":".conws-role-details-participants-list-region","teamLeadSwitch":".conws-role-details-teamlead-switch","buttonsRegion":".conws-role-details-buttons-region"},"templateHelpers":function(){return{"labelId":t.uniqueId("conws-teamlead-"),"hideTeamLead":h.hideTeamLead,"readonly":!0,"captions":this.captions,"model":this.model.toJSON()}},"onAfterShow":function(){this.$el.find(".conws-role-details-canedit-content").perfectScrollbar({"suppressScrollX":!0,"scrollYMarginOffset":15}),this.$el.find(".conws-role-details-canedit-left").perfectScrollbar({"suppressScrollX":!0,"scrollYMarginOffset":5}),this.$el.find(".conws-roles-edit-canedit-content").perfectScrollbar("update"),this.$el.find(".conws-role-details-rolename-text").perfectScrollbar({"scrollXMarginOffset":15,"scrollYMarginOffset":15}),this.$el.find(".conws-role-details-rolename-text").scrollTop(0),this.$el.find(".conws-role-details-rolename-text").scrollLeft(0),this.$el.find(".conws-role-details-rolename-text").perfectScrollbar("update"),this.$el.find(".conws-role-details-roledescription-text").perfectScrollbar({"scrollXMarginOffset":15,"scrollYMarginOffset":15}),this.$el.find(".conws-role-details-roledescription-text").scrollTop(0),this.$el.find(".conws-role-details-roledescription-text").scrollLeft(0),this.$el.find(".conws-role-details-roledescription-text").perfectScrollbar("update")},"onRender":function(){this.filterModel=new c({"caption":this.captions.Participants,"tooltip":this.captions.RolesParticipantsColTooltip,"active":this.model.members.length>=this.rolesCountForFilter}),this.participantsHeaderRegion.show(new r({"model":this.filterModel,"initialActivationWeight":this.model.members.length>=this.rolesCountForFilter?100:0})),this.participantsListRegion.show(new u({"model":this.model.members,"filterModel":this.filterModel,"initialActivationWeight":this.model.members.length>0?100:0})),this.listenTo(this.participantsListRegion.currentView,"dom:refresh",this.updateScrollbar),h.hideTeamLead||this.teamLeadSwitch.show(new l({"model":new o.Model({"data":this.model.get("leader"),"caption":this.captions.TeamLead}),"labelId":this.$(".conws-role-details-teamlead-caption").attr("id"),"mode":"readonly"})),this.buttonsRegion.show(new d({"collection":new o.Collection([{"id":"cancel","label":p.rolesDialogButtonClose,"css":"conws-roles-edit-button pull-right","close":!0}])}))},"updateScrollbar":function(){var e=this.$el.find(".conws-role-details-canedit-content");t.each(e,function(e){i(e).scrollTop(0),i(e).perfectScrollbar("update")});var o=this.$el.find(".conws-role-details-canedit-left");o&&o.length&&(o.scrollTop(0),o.perfectScrollbar("update"))}});return t.extend(g.prototype,a),g}),csui.define("hbs!conws/widgets/team/impl/team.tablinks",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return e.escapeExpression((s=null!=(s=l(i,"tabName")||(null!=t?l(t,"tabName"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"tabName","hash":{},"loc":{"start":{"line":1,"column":0},"end":{"line":1,"column":11}}}):s))+"\r\n"}});return i.registerPartial("conws_widgets_team_impl_team.tablinks",o),o});csui.define("css!conws/widgets/team/impl/team",[],function(){}),csui.define("conws/widgets/team/impl/team.tablinks.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/team.tablinks","css!conws/widgets/team/impl/team"],function(e,t,i,o,n,s){"use strict";return i.LayoutView.extend({"tagName":"a","attributes":{"role":"tab","aria-selected":!1,"data-binf-toggle":"tab"},"template":s,"behaviors":{"TabableRegion":{"behaviorClass":o,"initialActivationWeight":200}},"events":{"keydown":"onKeyDown"},"onKeyDown":function(e){switch(e.keyCode){case 13:case 32:t(e.target).trigger("click")}},"templateHelpers":function(){return{"tabName":"participants"===this.data.attributes.aria?n.rolesParticipantsColTitle:n.participantRolesColTitle}},"initialize":function(){this.listenTo(this,"dom:refresh",this.updateAttributes)},"updateAttributes":function(){this.$el.attr({"href":this.data.attributes.href,"aria-controls":this.data.attributes["aria-controls"]})},"currentlyFocusedElement":function(){return this.$el},"constructor":function(e,t){this.data=t,i.LayoutView.prototype.constructor.call(this,e)}})}),csui.define("hbs!conws/widgets/team/impl/teamtables",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){return'<div class="conws-teamtables">\r\n    <div class="teamtables-tabs">\r\n        \x3c!-- Nav tabs --\x3e\r\n        <ul class="binf-nav binf-nav-tabs binf-pull-right" role="tablist">\r\n          <li role="presentation" id="tabParticipants"></li>\r\n          <li role="presentation" id="tabRoles"></li>\r\n        </ul>\r\n    </div>\r\n    \x3c!-- Tab panes --\x3e\r\n    <div class="teamtables-content">\r\n        <div class="binf-tab-content">\r\n            <div role="tabpanel" class="binf-tab-pane binf-fade" id="participantstab">\r\n                <div id="participantstoolbar"></div>\r\n                <div id="participantsview"></div>\r\n            </div>\r\n            <div role="tabpanel" class="binf-tab-pane binf-fade" id="rolestab">\r\n                <div id="rolestoolbar"></div>\r\n                <div id="rolesview"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_teamtables",o),o}),csui.define("hbs!conws/widgets/team/impl/cells/avatar/impl/avatar",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){return'<span id="status-indicator-inherited" class="status-indicator"></span>\r\n'},"3":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"isNew"):t,{"name":"if","hash":{},"fn":e.program(4,n,0),"inverse":e.noop,"loc":{"start":{"line":4,"column":2},"end":{"line":7,"column":9}}}))?s:""},"4":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'    <span id="status-indicator-new" class="status-indicator"\r\n          title="'+e.escapeExpression((s=null!=(s=l(i,"participantStatus")||(null!=t?l(t,"participantStatus"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"participantStatus","hash":{},"loc":{"start":{"line":6,"column":17},"end":{"line":6,"column":38}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"participantStatus")||(null!=t?l(t,"participantStatus"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"participantStatus","hash":{},"loc":{"start":{"line":6,"column":52},"end":{"line":6,"column":73}}}):s))+'"></span>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"inherited"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.program(3,n,0),"loc":{"start":{"line":1,"column":0},"end":{"line":8,"column":7}}}))?s:"")+'<div class="conws-avatar"></div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_cells_avatar_impl_avatar",o),o}),csui.define("css!conws/widgets/team/impl/cells/avatar/impl/avatar",[],function(){}),csui.define("conws/widgets/team/impl/cells/avatar/avatar.view",["csui/utils/url","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/utils/contexts/factories/user","esoc/widgets/userwidget/userwidget","conws/widgets/team/impl/controls/avatar/avatar.view","conws/widgets/team/impl/participants.columns","conws/widgets/team/impl/roles.columns","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/cells/avatar/impl/avatar","css!conws/widgets/team/impl/cells/avatar/impl/avatar"],function(e,t,i,o,n,s,l,a,r,c){var d=t.extend({"template":c,"events":{"keydown":"onKeyDown"},"onKeyDown":function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this.$(".esoc-user-profile-link").trigger("click"))},"constructor":function(){t.apply(this,arguments),this.listenTo(this.model,"change",this.render)},"initialize":function(){this.avatar=new s({"model":this.model})},"onRender":function(){if(void 0!==this.model.get("type")&&0===this.model.get("type")){var e=this.model.collection.workspaceContext.getModel(o),t={"connector":this.model.connector,"model":this.model,"userid":this.model.get("id"),"context":this.model.collection.workspaceContext,"showUserProfileLink":!0,"showMiniProfile":!0,"loggedUserId":e.get("id"),"placeholder":this.$el.find(".conws-avatar"),"showUserWidgetFor":"profilepic"};n.getUser(t)}else this.$(".conws-avatar").append(this.avatar.render().$el)},"getValueData":function(){return{"participantStatus":r.participantStateNew,"type":this.model.getMemberType(),"inherited":!!this.model.get("inherited_from_id"),"isNew":!!this.model.get("isNew")}}},{"hasFixedWidth":!0,"columnClassName":"team-table-cell-avatar","noTitleInHeader":!0});return i.registerByColumnKey(l.columnNames.avatar,d),i.registerByColumnKey(a.columnNames.avatar,d),d}),csui.define("hbs!conws/widgets/team/impl/cells/name/impl/name",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <span class="csui-name participant-name" title="'+e.escapeExpression((s=null!=(s=l(i,"value")||(null!=t?l(t,"value"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"value","hash":{},"loc":{"start":{"line":2,"column":50},"end":{"line":2,"column":59}}}):s))+'"></span>\r\n'},"3":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <span class="csui-name participant-name" title="'+e.escapeExpression((s=null!=(s=l(i,"value")||(null!=t?l(t,"value"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"value","hash":{},"loc":{"start":{"line":4,"column":50},"end":{"line":4,"column":59}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"formattedValue")||(null!=t?l(t,"formattedValue"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"formattedValue","hash":{},"loc":{"start":{"line":4,"column":61},"end":{"line":4,"column":79}}}):s))+"</span>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"isUser"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.program(3,n,0),"loc":{"start":{"line":1,"column":0},"end":{"line":5,"column":7}}}))?s:""}});return i.registerPartial("conws_widgets_team_impl_cells_name_impl_name",o),o}),csui.define("css!conws/widgets/team/impl/cells/name/impl/name",[],function(){}),csui.define("conws/widgets/team/impl/cells/name/name.view",["csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","csui/utils/contexts/factories/user","conws/widgets/team/impl/participants.columns","esoc/widgets/userwidget/userwidget","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/cells/name/impl/name","css!conws/widgets/team/impl/cells/name/impl/name"],function(e,t,i,o,n,s,l){var a=e.extend({"className":"csui-truncate","template":l,"ui":{"userProfileName":".csui-name"},"events":{"dragstart @ui.userProfileName":"onDrag","keydown":"onKeyDown"},"onKeyDown":function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this.$(".esoc-user-profile-link").trigger("click"))},"onRender":function(){if(void 0!==this.model.get("type")&&0===this.model.get("type")){var e=this.options.context.getModel(i),t={"connector":this.model.connector,"userid":this.model.get("id"),"model":this.model,"context":this.options.context,"placeholder":this.$el.find(this.ui.userProfileName),"showUserProfileLink":!0,"showMiniProfile":!0,"loggedUserId":e.get("id")};n.getUser(t)}},"onDrag":function(e){return!1},"getValueData":function(){var e=this.model.get("display_name");return{"value":e,"formattedValue":e,"isUser":0===this.model.get("type")}}});return t.registerByColumnKey(o.columnNames.name,a),a}),csui.define("hbs!conws/widgets/team/impl/cells/roles/impl/roles",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="conws-roles-btn-div" tabindex="-1">\r\n  <a class="conws-roles-btn" href="#">\r\n    <div class="conws-roles-text">\r\n      <div class="conws-roles-truncatebox">\r\n        <span title="'+e.escapeExpression((s=null!=(s=l(i,"value")||(null!=t?l(t,"value"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"value","hash":{},"loc":{"start":{"line":5,"column":21},"end":{"line":5,"column":30}}}):s))+'" class="conws-roles-text-truncate">'+e.escapeExpression((s=null!=(s=l(i,"value")||(null!=t?l(t,"value"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"value","hash":{},"loc":{"start":{"line":5,"column":66},"end":{"line":5,"column":75}}}):s))+'</span>&nbsp;<span class="conws-roles-count">'+e.escapeExpression((s=null!=(s=l(i,"indicator")||(null!=t?l(t,"indicator"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"indicator","hash":{},"loc":{"start":{"line":5,"column":120},"end":{"line":5,"column":133}}}):s))+'</span>\r\n      </div>\r\n      <div class="role-name-icon-cell">\r\n        <span class="csui-icon conws-icon-roles-edit" title="'+e.escapeExpression((s=null!=(s=l(i,"toolTip")||(null!=t?l(t,"toolTip"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"toolTip","hash":{},"loc":{"start":{"line":8,"column":61},"end":{"line":8,"column":72}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"toolTip")||(null!=t?l(t,"toolTip"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"toolTip","hash":{},"loc":{"start":{"line":8,"column":86},"end":{"line":8,"column":97}}}):s))+'"></span>\r\n      </div>\r\n    </div>\r\n  </a>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_team_impl_cells_roles_impl_roles",o),o}),csui.define("conws/widgets/team/impl/cells/roles/roles.view",["csui/lib/underscore","csui/lib/jquery","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","conws/widgets/team/impl/dialogs/modaldialog/modal.dialog.view","conws/widgets/team/impl/participants.columns","conws/widgets/team/impl/dialogs/participants/roles.edit.view","conws/models/workspacecontext/workspacecontext.factory","conws/widgets/team/impl/participants.model.factory","conws/widgets/team/impl/roles.model.factory","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/cells/roles/impl/roles","css!conws/widgets/team/impl/cells/roles/impl/roles"],function(e,t,i,o,n,s,l,a,r,c,d,u){var p=i.extend({"className":"csui-truncate","template":u,"ui":{"roleEdit":"a.conws-roles-btn"},"events":{"click @ui.roleEdit":"roleEditClicked","dragstart @ui.roleEdit":"roleEditDrag","keydown":"onKeyDown"},"onKeyDown":function(e){switch(e.keyCode){case 13:case 32:t(e.target).find(this.ui.roleEdit).trigger("click")}},"getValueData":function(){return{"value":this.model.getLeadingRole(),"indicator":this.model.getRolesIndicator(),"cannotEdit":!this.model.canEdit(),"toolTip":d.participantRrolesColTooltip}},"roleEditClicked":function(t){this.options.workspaceContext||(this.options.workspaceContext=this.options.context.getObject(a),this.options.workspaceContext.setWorkspaceSpecific(r),this.options.workspaceContext.setWorkspaceSpecific(c)),this.editor=new n({"body":new l({"model":this.model,"roleCollection":this.options.workspaceContext.getCollection(c),"participantCollection":this.options.workspaceContext.getCollection(r)}),"modalClassName":"conws-roles-edit"}),this.editor.show();var i=e.bind(function(){this.options.tableView.$el.find('[conws-participant-row-id="'+this.model.get("id")+'"] .conws-team-table-cell-roles').trigger("click")},this);this.editor.once("destroy",function(){i()}),this.editor.options.body.once("refetched",function(){i()}),t.preventDefault(),t.stopPropagation()},"roleEditDrag":function(e){return!1},"onDestroy":function(){this.editor&&(this.editor=void 0)}},{"columnClassName":"conws-team-table-cell-roles"});return o.registerByColumnKey(s.columnNames.roles,p),p}),csui.define("conws/widgets/team/impl/cells/login/login.view",["csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","conws/widgets/team/impl/participants.columns","i18n!conws/widgets/team/impl/nls/team.lang"],function(e,t,i,o){var n=e.extend({"className":"csui-truncate","getValueData":function(){var e=this.model.displayLogin();return{"value":e,"formattedValue":e}}});return t.registerByColumnKey(i.columnNames.login,n),n}),csui.define("conws/widgets/team/impl/cells/email/email.view",["csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","conws/widgets/team/impl/participants.columns","i18n!conws/widgets/team/impl/nls/team.lang"],function(e,t,i,o){var n=e.extend({"className":"csui-truncate","getValueData":function(){var e=this.model.displayEmail();return{"value":e,"formattedValue":e}}});return t.registerByColumnKey(i.columnNames.email,n),n}),csui.define("conws/widgets/team/impl/cells/department/department.view",["csui/utils/url","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","conws/widgets/team/impl/participants.columns","i18n!conws/widgets/team/impl/nls/team.lang"],function(e,t,i,o,n,s){var l=t.extend({"className":"csui-truncate","constructor":function(){t.apply(this,arguments),this.listenTo(this.model,"change",this.render)},"getValueData":function(){var e=this.model.displayDepartment();return{"value":e,"formattedValue":e}}},{"columnClassName":"team-table-cell-department"});return i.registerByColumnKey(o.columnNames.department,l),l}),csui.define("hbs!conws/widgets/team/impl/cells/rolename/impl/rolename",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <span class="teamlead">'+e.escapeExpression((s=null!=(s=l(i,"leader")||(null!=t?l(t,"leader"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"leader","hash":{},"loc":{"start":{"line":7,"column":31},"end":{"line":7,"column":41}}}):s))+"</span>\r\n"},"3":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <span class="inherited">'+e.escapeExpression((s=null!=(s=l(i,"inherited")||(null!=t?l(t,"inherited"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"inherited","hash":{},"loc":{"start":{"line":10,"column":32},"end":{"line":10,"column":45}}}):s))+"</span>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="role-name-cell" tabindex="-1">\r\n  <a href="#">\r\n    <div class="role-name-box">\r\n      <div class="role-name-name-cell">\r\n      <span class="name" title="'+e.escapeExpression((l=null!=(l=a(i,"formattedValue")||(null!=t?a(t,"formattedValue"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"formattedValue","hash":{},"loc":{"start":{"line":5,"column":32},"end":{"line":5,"column":50}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"formattedValue")||(null!=t?a(t,"formattedValue"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"formattedValue","hash":{},"loc":{"start":{"line":5,"column":52},"end":{"line":5,"column":70}}}):l))+"</span>\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"leader"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.noop,"loc":{"start":{"line":6,"column":6},"end":{"line":8,"column":13}}}))?s:"")+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"inherited"):t,{"name":"if","hash":{},"fn":e.program(3,n,0),"inverse":e.noop,"loc":{"start":{"line":9,"column":6},"end":{"line":11,"column":13}}}))?s:"")+'      </div>\r\n      <div class="role-name-icon-cell">\r\n        <span class="csui-icon conws-icon-roles-details" title="'+e.escapeExpression((l=null!=(l=a(i,"toolTip")||(null!=t?a(t,"toolTip"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"toolTip","hash":{},"loc":{"start":{"line":14,"column":64},"end":{"line":14,"column":75}}}):l))+'" aria-label="'+e.escapeExpression((l=null!=(l=a(i,"toolTip")||(null!=t?a(t,"toolTip"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"toolTip","hash":{},"loc":{"start":{"line":14,"column":89},"end":{"line":14,"column":100}}}):l))+'"></span>\r\n      </div>\r\n    </div>\r\n  </a>\r\n</div>'}});return i.registerPartial("conws_widgets_team_impl_cells_rolename_impl_rolename",o),o}),csui.define("css!conws/widgets/team/impl/cells/rolename/impl/rolename",[],function(){}),csui.define("conws/widgets/team/impl/cells/rolename/rolename.view",["csui/lib/jquery","csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","conws/widgets/team/impl/roles.columns","conws/widgets/team/impl/dialogs/modaldialog/modal.dialog.view","conws/widgets/team/impl/dialogs/role/role.details.view","conws/models/workspacecontext/workspacecontext.factory","conws/widgets/team/impl/participants.model.factory","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/cells/rolename/impl/rolename","css!conws/widgets/team/impl/cells/rolename/impl/rolename"],function(e,t,i,o,n,s,l,a,r,c){var d=t.extend({"className":"csui-truncate","template":c,"ui":{"roleDetails":"a"},"events":{"click @ui.roleDetails":"roleDetailsClicked","dragstart @ui.roleDetails":"roleDetailsDrag","keydown":"onKeyDown"},"onKeyDown":function(t){switch(t.keyCode){case 13:case 32:e(t.target).find(this.ui.roleDetails).trigger("click")}},"getValueData":function(){var e=this.model.displayName();return{"toolTip":r.rolesNameColTooltip,"formattedValue":e,"leader":this.model.get("leader")?r.rolesNameColTeamLead:"","inherited":this.model.get("inherited_from_id")?r.rolesNameColInherited:""}},"roleDetailsClicked":function(e){this.options.workspaceContext||(this.options.workspaceContext=this.options.context.getObject(l),this.options.workspaceContext.setWorkspaceSpecific(a)),this.editor=new n({"body":new s({"model":this.model,"parentCollection":this.options.workspaceContext.getCollection(a)}),"modalClassName":"conws-role-details"}),this.editor.show(),e.preventDefault(),e.stopPropagation()},"roleDetailsDrag":function(e){return!1},"onDestroy":function(){this.editor&&(this.editor=void 0)}},{"hasFixedWidth":!1,"columnClassName":"team-table-cell-rolename"});return i.registerByColumnKey(o.columnNames.name,d),d}),csui.define("hbs!conws/widgets/team/impl/cells/participants/impl/participants",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<span class="'+e.escapeExpression((s=null!=(s=l(i,"valueClass")||(null!=t?l(t,"valueClass"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"valueClass","hash":{},"loc":{"start":{"line":1,"column":13},"end":{"line":1,"column":27}}}):s))+'" title="'+e.escapeExpression((s=null!=(s=l(i,"value")||(null!=t?l(t,"value"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"value","hash":{},"loc":{"start":{"line":1,"column":36},"end":{"line":1,"column":45}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"formattedValue")||(null!=t?l(t,"formattedValue"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"formattedValue","hash":{},"loc":{"start":{"line":1,"column":47},"end":{"line":1,"column":65}}}):s))+"</span>"}});return i.registerPartial("conws_widgets_team_impl_cells_participants_impl_participants",o),o}),csui.define("css!conws/widgets/team/impl/cells/participants/impl/participants",[],function(){}),csui.define("conws/widgets/team/impl/cells/participants/participants.view",["csui/controls/table/cells/templated/templated.view","csui/controls/table/cells/cell.registry","conws/widgets/team/impl/roles.columns","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/cells/participants/impl/participants","css!conws/widgets/team/impl/cells/participants/impl/participants"],function(e,t,i,o,n){var s=e.extend({"className":"csui-truncate","template":n,"getValueData":function(){var e="name",t=this.model.displayMembers();return t||(t=o.rolesParticipantsColNoParticipants,e="name warning"),{"value":t,"formattedValue":t,"valueClass":e}}},{"hasFixedWidth":!1,"columnClassName":"team-table-cell-participants"});return t.registerByColumnKey(i.columnNames.members,s),s}),csui.define("conws/widgets/team/impl/teamtables.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/utils/contexts/factories/connector","csui/utils/commands","conws/utils/commands/addparticipant","conws/widgets/team/impl/commands/exportparticipants","conws/utils/commands/showroles","conws/utils/commands/removeparticipant","conws/widgets/team/impl/commands/exportroles","conws/utils/commands/showdetails","conws/utils/commands/deleterole","csui/dialogs/modal.alert/modal.alert","csui/controls/tabletoolbar/tabletoolbar.view","csui/controls/table/table.view","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","conws/widgets/team/impl/participants.model.factory","conws/widgets/team/impl/participants.columns","conws/widgets/team/impl/participants.toolbaritems","conws/widgets/team/impl/roles.model.factory","conws/widgets/team/impl/roles.columns","conws/models/workspacecontext/workspacecontext.factory","conws/widgets/team/impl/roles.toolbaritems","conws/widgets/team/impl/dialogs/participants/roles.edit.view","conws/widgets/team/impl/dialogs/role/role.details.view","conws/widgets/team/impl/team.tablinks.view","conws/widgets/team/impl/dialogs/modaldialog/modal.dialog.view","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/teamtables","css!conws/widgets/team/impl/team","conws/widgets/team/impl/cells/avatar/avatar.view","conws/widgets/team/impl/cells/name/name.view","conws/widgets/team/impl/cells/roles/roles.view","conws/widgets/team/impl/cells/login/login.view","conws/widgets/team/impl/cells/email/email.view","conws/widgets/team/impl/cells/department/department.view","conws/widgets/team/impl/cells/rolename/rolename.view","conws/widgets/team/impl/cells/participants/participants.view"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h,g,f,w,v,b,y,k,x,C,_,T,S,R,V){var M=i.LayoutView.extend({"template":V,"dirty":!1,"events":{"shown.binf.tab .binf-nav-tabs a":"onShownTab"},"regions":{"tabParticipantsRegion":"#tabParticipants","tabRolesRegion":"#tabRoles","participantsToolbarRegion":"#participantstoolbar","participantsRegion":"#participantsview","rolesToolbarRegion":"#rolestoolbar","rolesRegion":"#rolesview"},"constructor":function(e){if(void 0===e||!e.context)throw new Error("Context is missing in the constructor options");this.context=e.context,t.isUndefined(e.collapsedView)||(this.collapsedView=e.collapsedView),e.workspaceContext||(e.workspaceContext=e.context.getObject(k),e.workspaceContext.setWorkspaceSpecific(f),e.workspaceContext.setWorkspaceSpecific(b)),this.workspaceContext=e.workspaceContext,this.participantCollection=e.workspaceContext.getCollection(f),this.roleCollection=e.workspaceContext.getCollection(b),this.participantCollection.newParticipants=[],t.each(this.participantCollection.where({"isNew":!0}),function(e){e.unset("isNew")}),e.filterBy&&e.filterBy.name.length>0?(this.participantCollection.setFilter({"conws_participantname":e.filterBy.name}),this.roleCollection.setFilter({"conws_rolename":e.filterBy.name})):(this.participantCollection.filters={},this.participantCollection.orderBy=w.columnNames.name+" asc",this.roleCollection.filters={},this.roleCollection.orderBy=y.columnNames.name+" asc"),this.listenTo(this.participantCollection,"saved",this.onParticipantsChanged),this.listenTo(this.roleCollection,"saved",this.onChanged),this.dirty=!1,e.data||(e.data={}),i.LayoutView.prototype.constructor.call(this,arguments),this.propagateEventsToRegions()},"onRender":function(){var e=this;this.tabParticipantsRegion.show(new T(t.defaults({"initialActivationWeight":202},this.options),{"attributes":{"aria":"participants","aria-controls":"participantstab","href":"#participantstab"}})),this.tabRolesRegion.show(new T(t.defaults({"initialActivationWeight":201},this.options),{"attributes":{"aria":"roles","aria-controls":"rolestab","href":"#rolestab"}})),this.participantCollection.fetched&&this.participantCollection.fetch({"reload":!0}),this.roleCollection.fetched&&this.roleCollection.fetch({"reload":!0}),this.participantCollection.once("sync",function(){e.tabParticipantsRegion.currentView.$el.binf_tab("show")}),this.participantCollection.fetch(),this.roleCollection.fetch()},"renderParticipantsAfterFetch":function(){if(!this.participantsToolbarView){var i=n.get(s.prototype.defaults.signature);i?i.roles=this.participantCollection.availableRoles:(n.add(new s({"roles":this.participantCollection.availableRoles})),n.add(new l),n.add(t.extend(new a,{"execute":this.onShowRoles})),n.add(new r)),this.participantsToolbarView=new m({"originatingView":this,"toolbarItems":v,"collection":this.participantCollection})}if(!this.participantsTableView){var c=t.rest(w.getColumnKeys(),1);this.participantsTableView=new h({"context":this.workspaceContext,"connector":this.context.getObject(o),"collection":this.participantCollection,"columns":this.participantCollection.columns,"filterBy":this.participantCollection.filters,"tableColumns":w,"selectColumn":!0,"enableSorting":!0,"orderBy":w.columnNames.name+" asc","nameEdit":!1,"haveDetailsRowExpandCollapseColumn":!0,"columnsWithSearch":c,"tableTexts":{"zeroRecords":R.zeroRecordsOrFilteredParticipants},"tableAria":R.rolesParticipantsTableAria}),this.listenTo(this.participantsTableView,"tableRowSelected",this.updateParticipantsToolItems),this.listenTo(this.participantsTableView,"tableRowUnselected",this.updateParticipantsToolItems),this.listenTo(this.participantsTableView,"tableRowRendered",function(t){e(t.target).attr("conws-participant-row-id",t.node.get("id"))}),t.isUndefined(this.participantsTableView.accFocusedState.body.column)||(this.participantsTableView.accFocusedState.body.column=3)}
this.participantsToolbarRegion.show(this.participantsToolbarView),this.participantsRegion.show(this.participantsTableView)},"renderRolesAfterFetch":function(){if(this.rolesToolbarView||(n.add(new c),n.add(t.extend(new d,{"execute":this.onShowDetails})),n.add(new u),this.rolesToolbarView=new m({"originatingView":this,"toolbarItems":x,"collection":this.roleCollection})),!this.rolesTableView){var e=t.rest(y.getColumnKeys(),1);this.rolesTableView=new h({"context":this.workspaceContext,"connector":this.context.getObject(o),"collection":this.roleCollection,"columns":this.roleCollection.columns,"filterBy":this.roleCollection.filters,"tableColumns":y,"selectColumn":!0,"enableSorting":!0,"orderBy":y.columnNames.name+" asc","nameEdit":!1,"haveDetailsRowExpandCollapseColumn":!0,"columnsWithSearch":e,"tableTexts":{"zeroRecords":R.zeroRecordsOrFilteredRoles},"tableAria":R.participantRolesTableAria}),this.listenTo(this.rolesTableView,"tableRowSelected",this.updateRolesToolItems),this.listenTo(this.rolesTableView,"tableRowUnselected",this.updateRolesToolItems),t.isUndefined(this.rolesTableView.accFocusedState.body.column)||(this.rolesTableView.accFocusedState.body.column=2)}this.rolesToolbarRegion.show(this.rolesToolbarView),this.rolesRegion.show(this.rolesTableView)},"onShowRoles":function(t,i){var o,n=e.Deferred();return this.editor=new S({"body":new C({"model":t.nodes.models[0],"roleCollection":t.originatingView.roleCollection,"participantCollection":t.originatingView.participantCollection}),"modalClassName":"conws-roles-edit"}),o=this.editor.show(),o&&n.resolve(),n.promise()},"onShowDetails":function(t,i){var o,n=e.Deferred();return this.editor=new S({"body":new _({"model":t.nodes.models[0],"roleCollection":t.originatingView.roleCollection,"participantCollection":t.originatingView.participantCollection}),"modalClassName":"conws-role-details"}),o=this.editor.show(),o&&n.resolve(),n.promise()},"updateParticipantsToolItems":function(){this.participantsToolbarView&&this.participantsToolbarView.updateForSelectedChildren(this.participantsTableView.getSelectedChildren())},"participantsTableDomRefresh":function(){this.participantsToolbarView.updateForSelectedChildren(this.participantsTableView.getSelectedChildren()),this.participantsTableView.triggerMethod("dom:refresh",this.participantsTableView)},"updateRolesToolItems":function(){this.rolesToolbarView.updateForSelectedChildren(this.rolesTableView.getSelectedChildren())},"rolesTableDomRefresh":function(){this.rolesToolbarView.updateForSelectedChildren(this.rolesTableView.getSelectedChildren()),this.rolesTableView.triggerMethod("dom:refresh",this.rolesTableView)},"onShownTab":function(e){var t=e.target.hash,i=this.tabParticipantsRegion.$el.find("a.csui-acc-tab-region"),o=this.tabRolesRegion.$el.find("a.csui-acc-tab-region");switch(t){case"#participantstab":i.attr("aria-selected",!0),o.attr("aria-selected",!1),this.renderParticipantsAfterFetch(),this.participantsTableDomRefresh();break;case"#rolestab":i.attr("aria-selected",!1),o.attr("aria-selected",!0),this.renderRolesAfterFetch(),this.rolesTableDomRefresh()}},"onParticipantsChanged":function(){var e=this;this.dirty=!0,e.participantCollection.fetch({"reload":!0,"success":function(){e.participantCollection.setNewParticipant(),e.updateParticipantsToolItems()}}),e.roleCollection.fetch({"reload":!0}),this.updateRolesToolItems()},"onChanged":function(){this.dirty=!0,this.updateParticipantsToolItems(),this.updateRolesToolItems()},"onDestroy":function(){return this.rolesEditor&&(this.rolesEditor.close(),this.rolesEditor=void 0),this.detailsEditor&&(this.detailsEditor.close(),this.detailsEditor=void 0),this.dirty&&!t.isUndefined(this.collapsedView)&&this.collapsedView.triggerMethod("refresh:list"),!0}});return t.extend(M.prototype,g),M}),csui.define("hbs!conws/widgets/team/impl/controls/listitem/impl/listitemteammember",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <span class="cs-name" title="'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":5,"column":37},"end":{"line":5,"column":45}}}):s))+'"></span>\r\n'},"3":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <span class="cs-name" title="'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":7,"column":37},"end":{"line":7,"column":45}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":7,"column":47},"end":{"line":7,"column":55}}}):s))+"</span>\r\n"},"5":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <div class="cs-stage">\r\n            <span class="cs-value" title="'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"stage"):t)?l(s,"value"):s,t))+'">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"stage"):t)?l(s,"value"):s,t))+'</span>\r\n            <span class="cs-label">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"stage"):t)?l(s,"label"):s,t))+"</span>\r\n        </div>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="conws-user-avatar"></div>\r\n<div class="cs-left">\r\n    <div class="cs-title">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"isUser"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.program(3,n,0),"loc":{"start":{"line":4,"column":6},"end":{"line":8,"column":13}}}))?s:"")+"    </div>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"stage"):t)?l(s,"value"):s,{"name":"if","hash":{},"fn":e.program(5,n,0),"inverse":e.noop,"loc":{"start":{"line":10,"column":4},"end":{"line":15,"column":11}}}))?s:"")+"</div>\r\n"}});return i.registerPartial("conws_widgets_team_impl_controls_listitem_impl_listitemteammember",o),o}),csui.define("hbs!conws/widgets/team/impl/controls/listitem/impl/listitemteamrole",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="conws-role-avatar">\r\n  <span class="cs-icon circular cs-icon-add" aria-hidden="true"></span>\r\n</div>\r\n<div class="cs-left">\r\n  <div class="cs-title">\r\n    <span class="cs-name cs-role conws-font-1em-italic-steel-grey" title="'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"stage"):t)?l(s,"value"):s,t))+'">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"stage"):t)?l(s,"value"):s,t))+"</span>\r\n  </div>\r\n</div>\r\n"}});return i.registerPartial("conws_widgets_team_impl_controls_listitem_impl_listitemteamrole",o),o}),csui.define("css!conws/widgets/team/impl/controls/listitem/impl/listitemteammember",[],function(){}),csui.define("conws/widgets/team/impl/controls/listitem/listitemteammember.view",["csui/lib/jquery","csui/utils/url","csui/controls/listitem/listitemstandard.view","csui/utils/contexts/factories/user","conws/widgets/team/impl/controls/avatar/avatar.view","esoc/widgets/userwidget/userwidget","hbs!conws/widgets/team/impl/controls/listitem/impl/listitemteammember","hbs!conws/widgets/team/impl/controls/listitem/impl/listitemteamrole","css!conws/widgets/team/impl/controls/listitem/impl/listitemteammember"],function(e,t,i,o,n,s,l,a){return i.extend({"tagName":"div","className":"conws-item-member "+i.prototype.className,"events":{"keydown":"onKeyDown"},"triggers":{"click":"click:item","click @ui.userAvatar":"click:profile","click @ui.userProfileName":"click:profile"},"ui":{"userProfileName":".cs-name","userAvatar":".conws-user-avatar"},"constructor":function(e){e||(e={}),e.miniProfile=void 0===e.miniProfile,e.context||(e.context=e.model.collection.context),i.apply(this,arguments),this.listenTo(this.model,"change",this.render)},"getTemplate":function(){return"member"===this.model.memberType?l:a},"initialize":function(){this.avatar=new n({"model":this.model})},"onRender":function(){if(void 0!==this.model.get("type")&&0===this.model.get("type")){var t=this.options.context.getModel(o),i={"connector":this.model.connector,"model":this.model,"userid":this.model.get("id"),"context":this.options.context,"showUserProfileLink":!0,"showMiniProfile":this.options.miniProfile,"loggedUserId":t.get("id")},n=e.extend({"placeholder":this.$el.find(this.ui.userAvatar),"showUserWidgetFor":"profilepic"},i);s.getUser(n);var l=e.extend({"placeholder":this.$el.find(this.ui.userProfileName)},i);s.getUser(l)}else this.$el.find(this.ui.userAvatar).append(this.avatar.render().$el)},"onKeyDown":function(e){13!==e.keyCode&&32!==e.keyCode||(this.$("a").trigger("click"),e.preventDefault(),e.stopPropagation())}})}),csui.define("hbs!conws/utils/previewpane/impl/rolemembers.empty",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="conws-preview empty-role-members-view">\r\n    <span>'+e.escapeExpression((s=null!=(s=l(i,"noResultsPlaceholder")||(null!=t?l(t,"noResultsPlaceholder"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"noResultsPlaceholder","hash":{},"loc":{"start":{"line":2,"column":10},"end":{"line":2,"column":34}}}):s))+"</span>\r\n</div>"}});return i.registerPartial("conws_utils_previewpane_impl_rolemembers.empty",o),o}),csui.define("css!conws/utils/previewpane/impl/previewpane",[],function(){}),csui.define("conws/utils/previewpane/impl/rolemembers.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/controls/list/list.view","csui/controls/list/emptylist.view","csui/behaviors/limiting/limiting.behavior","csui/behaviors/expanding/expanding.behavior","conws/widgets/header/impl/header.model.factory","conws/widgets/team/impl/team.model.factory","conws/widgets/team/impl/teamtables.view","csui/utils/nodesprites","conws/widgets/team/impl/controls/listitem/listitemteammember.view","i18n!conws/utils/previewpane/impl/nls/previewpane.lang","hbs!conws/utils/previewpane/impl/rolemembers.empty","css!conws/utils/previewpane/impl/previewpane"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m){i.ItemView.extend({"constructor":function(e){i.ItemView.prototype.constructor.apply(this,arguments)},"template":m});return i.CollectionView.extend({"constructor":function(e){e||(e={}),e.data||(e.data={}),i.CollectionView.prototype.constructor.apply(this,arguments)},"getEmptyView":function(){return n},"emptyViewOptions":function(){return{"templateHelpers":{"text":this.options.noRoleMembersMessage}}},"childView":u,"childViewOptions":function(){return{"templateHelpers":function(){return{"name":this.model.get("display_name"),"email":this.model.get("business_email"),"isUser":0===this.model.get("type"),"stage":{"value":this.model.getLeadingRole(),"label":this.model.getRolesIndicator()}}},"context":this.options.context,"miniProfile":!1}},"childEvents":{"click:profile":"onClickProfile"},"onClickProfile":function(e,t){this.triggerMethod("click:member",t)},"onClickHeader":function(e){this.triggerMethod("expand")}})}),csui.define("conws/widgets/metadata/impl/nls/metadata.lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/metadata/impl/nls/root/metadata.lang",{"defaultMetadataWidgetTitle":"Metadata","noMetadataMessage":"No data to display.","loadingMetadata":"Loading metadata","RelatedWorkspaceType":"Related"}),csui.define("conws/widgets/metadata/impl/forms.metadata.update.model",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/utils/base","csui/models/mixins/node.connectable/node.connectable.mixin","i18n!conws/widgets/metadata/impl/nls/metadata.lang"],function(e,t,i,o,n,s,l){"use strict";function a(e,i){t.each(i,function(t,i){e.hasOwnProperty(i)&&(e[i]=t)})}function r(e,i){var o=[];return t.each(e,function(e){var n=i(e);if(null==n||t.contains(o,n)){if("group"===e.type){var s=r(e.attributes,i);t.each(s,function(e){t.contains(o,e)||o.push(e)})}}else o.push(n)},this),o}var c=i.Model.extend({"constructor":function(e,t){this.node=t.node,i.Model.prototype.constructor.call(this,e,t),this.makeNodeConnectable(t),this.metadataConfig=[],t.metadataConfig&&(this.metadataConfig=t.metadataConfig.metadata||[],this.hideEmptyFields=t.metadataConfig.hideEmptyFields||!1,this.isReadOnly=!!t.metadataConfig.readonly),this.form_models=[],this.categoryIds=r(this.metadataConfig,function(e){if("attribute"===e.type||"category"===e.type)return e.categoryId}),this.workspaceTypeIds=r(this.metadataConfig,function(e){if("relation"===e.type)return e.workspaceTypeId})},"url":function(){var i=this.node.get("id"),n=this.connector.getConnectionUrl().getApiBase("v2"),s={};this.workspaceTypeIds.length>0&&t.extend(s,{"where_rel_wksp_type_ids":"{"+this.workspaceTypeIds.join(",")+"}","fields":"related_items","where_rel_type":"parent"}),this.categoryIds.length>0&&t.extend(s,{"where_category_ids":"{"+this.categoryIds.join(",")+"}"}),s=t.omit(s,function(e){return null===e||void 0===e||""===e});var l="/forms/businessworkspaces/"+i+"/metadata/update",a=t.isEmpty(s)?l:l+"?"+e.param(s);return n=o.combine(n,a)},"fetch":function(){return this.metadataConfig.length>0?i.Model.prototype.fetch.apply(this,arguments):e.Deferred().resolve().promise()},"parse":function(e){this.update(this.metadataConfig,e)},"_getChanges":function(e){var t,i=e.get("data"),o=e.get("schema"),n=e.get("options");for(t in n.fields)!0===n.fields[t].hidden&&"string"===o.properties[t].type&&t in i&&null===i[t]&&(i[t]="");return i},"restoreData":function(e){var i=t.pick(this.oldData,t.keys(e));return i=JSON.parse(JSON.stringify(i)),a(this.get("data"),i),i},"updateData":function(e){a(this.get("data"),e)},"update":function(e,i){var o={},n={"properties":{}},s={"fields":{}},l={"data":o,"properties":n.properties,"fields":s.fields,"title":""};this.form_models.splice(0);var a;t.each(i.forms,function(e){"categories"===e.role_name?t.each(this.categoryIds,function(t){var i=e.options&&e.options.fields,o=e.schema&&e.schema.properties;if(i&&i[t]){var n=i[t].form.attributes.action.split("categories/");if(n.length>1&&(a=parseInt(n[n.length-1])),t===a){var s={"id":a,"data":e.data[a],"schema":o[a],"options":i[a]};this.form_models.push(s)}}},this):"related_items"===e.role_name&&t.each(this.workspaceTypeIds,function(i){var o=e.options&&e.options.fields,n=e.schema&&e.schema.properties;t.each(o,function(t,s){if(t.workspace_type_id+""==i+""){var l={"id":i,"data":e.data&&e.data[s],"schema":n&&n[s],"options":o&&o[s]};this.form_models.push(l)}},this)},this)},this),this._fillModel(e,l),this.set({"data":o,"schema":n,"options":s})},"_fillModel":function(e,i,o){t.each(e,function(e){if("attribute"===e.type)this._createAttribute(e,i,o);else if("category"===e.type)this._createCategory(e,i,o);else if("relation"===e.type)this._createRelation(e,i,o);else if("group"===e.type){var s=e.label,l={},a={"properties":{}},r={"label":n.getClosestLocalizedString(e.label,"Undefined"),"fields":{}},c={"data":l,"properties":a.properties,"fields":r.fields,"title":""};this._fillModel(e.attributes,c,s),t.isEmpty(l)||(i.data[s]=l,i.properties[s]=a,i.fields[s]=r)}},this)},"_createAttribute":function(e,i,o){var n,s=e.categoryId+"_"+e.attributeId;t.each(this.form_models,function(t){if(e.categoryId===t.id){var l;if(e.columnId){var a=t.schema.properties[s].type;"object"===a?(e.attributeType=a,n=s+"_1_"+e.columnId,l={"data":t.data[s],"properties":t.schema.properties[s].properties,"fields":t.options.fields[s].fields},this._createRow(n,e,i,l,o)):"array"===a&&(e.attributeType=a,n=s+"_x_"+e.columnId,l={"data":t.data[s][0],"properties":t.schema.properties[s].items.properties,"fields":t.options.fields[s].fields.item.fields},this._createRow(n,e,i,l,o))}else l={"data":t.data,"properties":t.schema.properties,"fields":t.options.fields},this._createRow(s,e,i,l,o)}},this)},"_createCategory":function(e,i,o){t.each(this.form_models,function(n){if(e.categoryId===n.id){var s={"data":n.data,"properties":n.schema.properties,"fields":n.options.fields};t.each(n.data,function(t,n){this._createRow(n,e,i,s,o)},this)}},this)},"_createRelation":function(e,i,o){t.each(this.form_models,function(n){if(e.workspaceTypeId===n.id){var s={"data":n.data,"properties":n.schema.properties,"fields":n.options.fields};t.each(n.data,function(t,l){s.fields[l].workspace_type_id=n.options.workspace_type_id,this._createRow(l,e,i,s,o)},this)}},this)},"_createRow":function(e,t,i,o,s){var l,a=o.data[e],r=o.properties[e],c=o.fields[e];if(!(this.hideEmptyFields&&this._isEmpty(a)||(i.data[e]=a,i.properties[e]=r,i.fields[e]=c,t.label&&(i.fields[e].label=n.getClosestLocalizedString(t.label,"Undefined")),!0!==this.isReadOnly&&!0!==t.readOnly))){if(i.properties[e].readonly=!0,i.fields[e].readonly=!0,"items"in r)for(l in r.items.properties)r.items.properties[l].readonly=!0;if("properties"in r)for(l in r.properties)r.properties[l].readonly=!0;if("fields"in c)for(l in c.fields)c.fields[l].readonly=!0}},"_isEmpty":function(e){if(null===e||void 0===e||""===e)return!0;var i=t.uniq(t.values(e));if(i.length>0){for(var o=!0,n=0;n<i.length;n++)if(!this._isEmpty(i[n])){o=!1;break}if(o)return!0}return!1}});return s.mixin(c.prototype),c}),csui.define("hbs!conws/utils/previewpane/impl/previewpane",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){return'<div class="binf-panel-heading conws-preview-header">\r\n</div>\r\n\r\n<div class="binf-panel-body">\r\n    <div class="conws-preview-metadata conws-preview-perfect-scroll">\r\n    </div>\r\n\r\n    <hr>\r\n\r\n    <div class="binf-list-group conws-preview-role-members conws-preview-perfect-scroll">\r\n        User Or Role Area\r\n    </div>\r\n</div>\r\n'}});return i.registerPartial("conws_utils_previewpane_impl_previewpane",o),o}),csui.define("conws/utils/previewpane/previewpane.view",["require","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/handlebars","csui/behaviors/widget.container/widget.container.behavior","csui/utils/base","csui/utils/log","csui/utils/url","csui/controls/list/emptylist.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","conws/utils/previewpane/impl/previewheader.model","conws/utils/previewpane/impl/previewheader.view","conws/utils/previewpane/impl/attributes.model","conws/utils/previewpane/impl/role.model","conws/utils/previewpane/impl/rolemembers.view","conws/widgets/metadata/impl/forms.metadata.update.model","conws/controls/selectedmetadataform/selectedmetadataform.view","i18n!conws/utils/previewpane/impl/nls/previewpane.lang","hbs!conws/utils/previewpane/impl/previewpane","css!conws/utils/previewpane/impl/previewpane"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h,g,f,w,v,b,y){var k=o.LayoutView.extend({"className":"conws-preview panel panel-default","template":y,"regions":{"headerRegion":".conws-preview-header","metaDataRegion":".conws-preview-metadata","roleMembersRegion":".conws-preview-role-members"},"triggers":{"change #header-ws-add-icon-file":"add:icon","click  #header-ws-remove-icon":"remove:icon"},"blankImage":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQI12NgYAAAAAMAASDVlMcAAAAASUVORK5CYII=","behaviors":{"PerfectScrolling":{"behaviorClass":d,"contentParent":".conws-preview-perfect-scroll","suppressScrollX":!0}},"constructor":function(e){if(o.LayoutView.prototype.constructor.call(this,e),e||(e={}),this.config=e.config,this.fetched=!1,this.config.roleId||this.config.metadata){this.parent=e.parent,this.config.noMetadataMessage=this._localize("noMetadataMessage"),this.config.noRoleMembersMessage=this._localize("noRoleMembersMessage"),this.config.readonly=!0,this.headerModel=new p(e),this.metaDataModel=new w(void 0,{"node":e.node,"metadataConfig":this.config,"autofetch":!0,"autoreset":!0}),this.roleMemberCollection=new g(null,e);var t=i.fn.binf_modal.getDefaultContainer?i.fn.binf_modal.getDefaultContainer():"body";e.parent.$el.binf_popover({"content":this.$el,"parent":e.parent.$el,"placement":function(){this.$element=this.options.parent;var e="right",t=this.tip();t.detach().css({"top":0,"left":0,"display":"block"}).addClass("binf-"+e).data("binf."+this.type,this),this.options.container?t.appendTo(this.options.container):t.insertAfter(this.$element);var o=this.getPosition(),n=this.options.container?i(this.options.container):this.$element.parent(),s=this.getPosition(n),l=t[0].offsetWidth;if(o.right+l<s.width||o.left-l>0)e=o.right+l>s.width?"left":o.left-l<s.left?"right":e;else{var a=i(this.$element[0]).find(".conws-previewpane-default-position");a.length>0&&(this.$element.removeAttr("aria-describedby"),this.$element=a,this.$element.attr("aria-describedby",t.attr("id")))}return"right"!==e&&t.removeClass("binf-right").addClass("binf-"+e),e},"trigger":"manual","container":t,"html":!0});var n=this.parent.$el.data("binf.popover"),s=n.tip();s.addClass("conws-previewpane-popover"),s.on("mouseenter",this,i.proxy(function(){!0===this.config.debug&&a.info("Preview "+this.options.node.get("id")+": Mouseenter popover")&&console.log(a.last),this.show()},this)),s.on("mouseleave",this,i.proxy(function(){!0===this.config.debug&&a.info("Preview "+this.options.node.get("id")+": Mouseleave popover")&&console.log(a.last),this.delayedHide()},this)),this.propagateEventsToRegions()}},"onBeforeDestroy":function(e){(this.config.roleId||this.config.metadata)&&this.parent.$el.binf_popover("destroy")},"show":function(){if(this.config.roleId||this.config.metadata){var e=this;if(!0===this.config.debug&&a.info("Preview "+this.options.node.get("id")+": Preparing show")&&console.log(a.last),this.hideTimeout&&(clearTimeout(this.hideTimeout),!0===this.config.debug&&a.info("Preview "+this.options.node.get("id")+": Cleared hide timeout")&&console.log(a.last),this.hideTimeout=null),this.$el.is(":visible"))return void(!0===this.config.debug&&a.info("Preview "+this.options.node.get("id")+": Already visible")&&console.log(a.last));this.showCancelled=!1,this.$el.hide(),this.render();var o=i.Deferred();this.headerView&&this.headerView.destroy(),this.roleView&&this.roleView.destroy(),this.metaDataView&&this.metaDataView.destroy(),this.headerView=new m({"model":this.headerModel,"originatingView":this,"context":this.options.context}),this.roleView=new f({"collection":this.roleMemberCollection,"noRoleMembersMessage":this.config.noRoleMembersMessage,"context":this.options.context}),this.listenTo(this.roleView,"click:member",this.hide),this.metaDataView=new v({"model":this.metaDataModel,"context":this.options.context}),this.metaDataView.on("render:form",function(){e._attachUserFieldHandlers(this),o.resolve()}),this.config.metadata||o.resolve();var n;this.fetched?this.config.metadata&&(this.metaDataModel.trigger("change"),n=[i.Deferred().resolve(),i.Deferred().resolve(),i.Deferred().resolve(),o]):n=[this.headerModel.fetch(),this.metaDataModel.fetch(),this.roleMemberCollection.fetch(),o],i.when.apply(this,n).done(t.bind(function(){if(this.fetched=!0,this.showCancelled)!0===this.config.debug&&a.info("Preview "+this.options.node.get("id")+": Show was cancelled -> skipped")&&console.log(a.last);else{i(".conws-previewpane-popover").each(function(e,t){var o=i(t).attr("id");i("[aria-describedby^='"+o+"']").binf_popover("hide")}),!0===this.config.debug&&a.info("Preview "+this.options.node.get("id")+": Showing")&&console.log(a.last);var e=!1;t.isEmpty(this.metaDataModel.attributes.data)&&(this.metaDataView=new c({"text":this.config.noMetadataMessage}),e=!0),this.headerRegion.show(this.headerView,{"render":!0}),this.metaDataRegion.show(this.metaDataView,{"render":e}),this.roleMembersRegion.show(this.roleView,{"render":!0}),this.$el.show(),this.options.parent.$el.binf_popover("show"),!0===this.config.debug&&(a.info("Viewport height: "+i(window).height())&&console.log(a.last),a.info("document height: "+i(document).height())&&console.log(a.last),a.info("body     height: "+i("body").height())&&console.log(a.last),a.info("popover  height: "+this.$el.height())&&console.log(a.last),a.info("metadata height: "+this.$el.find(".conws-preview-metadata").height())&&console.log(a.last),a.info("role     height: "+this.$el.find(".conws-preview-role-members").height())&&console.log(a.last)),this.triggerMethod("dom:refresh")}},this))}},"hide":function(){!0===this.config.debug&&a.info("Preview "+this.options.node.get("id")+": Going to hide")&&console.log(a.last),this.config&&!this.config.debugNoHide?(!0===this.config.debug&&a.info("Preview "+this.options.node.get("id")+": Hidden")&&console.log(a.last),this.options.parent.$el.binf_popover("hide"),this.hideTimeout=null):!0===this.config.debug&&a.info("Preview "+this.options.node.get("id")+": Leaving visible")&&console.log(a.last),this.showCancelled=!0,this.hideTimeout=null},"delayedHide":function(){!0===this.config.debug&&a.info("Preview "+this.options.node.get("id")+": Setting hide timeout")&&console.log(a.last),this.hideTimeout=window.setTimeout(i.proxy(this.hide,this),200)},"_localize":function(e){var t=b[e];return this.config[e]&&(t=l.getClosestLocalizedString(this.config[e],t)),t},"_attachUserFieldHandlers":function(e){var o=function(e){return a.info("User field mouseover")&&console.log(a.last),e.stopPropagation(),!1},n=e.$el.find(".cs-userfield .cs-field-read");t.each(n,function(e){e.addEventListener("mouseover",o,!0)}),o=i.proxy(this.hide,this),e.$el.find(".cs-userfield .cs-field-read-inner").on("click",o)}});return t.extend(k.prototype,u),k}),csui.define("hbs!conws/widgets/relatedworkspaces/impl/relateditem",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'            <span class="conws-value">\r\n              <span class="conws-previewpane-default-position">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"title"):t)?l(s,"value"):s,t))+"</span>\r\n            </span>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"title"):t)?l(s,"label"):s,{"name":"if","hash":{},"fn":e.program(2,n,0),"inverse":e.noop,"loc":{"start":{"line":10,"column":12},"end":{"line":13,"column":19}}}))?s:"")},"2":function(e,t,i,o,n){return'              \x3c!-- add element to get proper distance to value --\x3e\r\n              <div class="conws-spacer"></div>\r\n'},"4":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'            <span class="conws-label">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"title"):t)?l(s,"label"):s,t))+"</span>\r\n"},"6":function(e,t,i,o,n){return'            \x3c!-- add element to get proper distance to description --\x3e\r\n            <div class="conws-description-spacer"></div>\r\n'},"8":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'          <div class="conws-right">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"topRight"):t)?l(s,"value"):s,{"name":"if","hash":{},"fn":e.program(9,n,0),"inverse":e.noop,"loc":{"start":{"line":26,"column":12},"end":{"line":32,"column":19}}}))?s:"")+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"topRight"):t)?l(s,"label"):s,{"name":"if","hash":{},"fn":e.program(12,n,0),"inverse":e.noop,"loc":{"start":{"line":33,"column":12},"end":{"line":35,"column":19}}}))?s:"")+"          </div>\r\n"},"9":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'              <span class="conws-value">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"topRight"):t)?l(s,"value"):s,t))+"</span>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"topRight"):t)?l(s,"label"):s,{"name":"if","hash":{},"fn":e.program(10,n,0),"inverse":e.noop,"loc":{"start":{"line":28,"column":14},"end":{"line":31,"column":21}}}))?s:"")},"10":function(e,t,i,o,n){return'                \x3c!-- add element to get proper distance to value --\x3e\r\n                <div class="conws-spacer"></div>\r\n'},"12":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'              <span class="conws-label">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"topRight"):t)?l(s,"label"):s,t))+"</span>\r\n"},"14":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'          <div class="conws-body">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"description"):t)?l(s,"value"):s,t))+"</div>\r\n"},"16":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'          <div class="conws-left">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"bottomLeft"):t)?l(s,"label"):s,{"name":"if","hash":{},"fn":e.program(17,n,0),"inverse":e.noop,"loc":{"start":{"line":49,"column":12},"end":{"line":55,"column":19}}}))?s:"")+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"bottomLeft"):t)?l(s,"value"):s,{"name":"if","hash":{},"fn":e.program(19,n,0),"inverse":e.noop,"loc":{"start":{"line":56,"column":12},"end":{"line":58,"column":19}}}))?s:"")+"          </div>\r\n"},"17":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'              <span class="conws-label">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"bottomLeft"):t)?l(s,"label"):s,t))+"</span>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"bottomLeft"):t)?l(s,"value"):s,{"name":"if","hash":{},"fn":e.program(10,n,0),"inverse":e.noop,"loc":{"start":{"line":51,"column":14},"end":{"line":54,"column":21}}}))?s:"")},"19":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'              <span class="conws-value">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"bottomLeft"):t)?l(s,"value"):s,t))+"</span>\r\n"},"21":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'          <div class="conws-right">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"bottomRight"):t)?l(s,"label"):s,{"name":"if","hash":{},"fn":e.program(22,n,0),"inverse":e.noop,"loc":{"start":{"line":63,"column":12},"end":{"line":69,"column":19}}}))?s:"")+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"bottomRight"):t)?l(s,"value"):s,{"name":"if","hash":{},"fn":e.program(24,n,0),"inverse":e.noop,"loc":{"start":{"line":70,"column":12},"end":{"line":72,"column":19}}}))?s:"")+"          </div>\r\n"},"22":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'              <span class="conws-label">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"bottomRight"):t)?l(s,"label"):s,t))+"</span>\r\n"+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?l(t,"bottomRight"):t)?l(s,"value"):s,{
"name":"if","hash":{},"fn":e.program(10,n,0),"inverse":e.noop,"loc":{"start":{"line":65,"column":14},"end":{"line":68,"column":21}}}))?s:"")},"24":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'              <span class="conws-value">'+e.escapeExpression(e.lambda(null!=(s=null!=t?l(t,"bottomRight"):t)?l(s,"value"):s,t))+"</span>\r\n"},"26":function(e,t,i,o,n){return'  <div class="conws-relateditem-divider"></div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="conws-relateditem-action-area">\r\n  <a class="conws-nostyle" href="'+e.escapeExpression((l=null!=(l=a(i,"defaultActionUrl")||(null!=t?a(t,"defaultActionUrl"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"defaultActionUrl","hash":{},"loc":{"start":{"line":2,"column":33},"end":{"line":2,"column":53}}}):l))+'">\r\n    <div class="conws-relateditem-border">\r\n      <div class="conws-relateditem-top '+e.escapeExpression((l=null!=(l=a(i,"inactive")||(null!=t?a(t,"inactive"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"inactive","hash":{},"loc":{"start":{"line":4,"column":40},"end":{"line":4,"column":52}}}):l))+'">\r\n        <div class="conws-title conws-left '+e.escapeExpression((l=null!=(l=a(i,"inactive")||(null!=t?a(t,"inactive"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"inactive","hash":{},"loc":{"start":{"line":5,"column":43},"end":{"line":5,"column":55}}}):l))+'">\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?a(t,"title"):t)?a(s,"value"):s,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.noop,"loc":{"start":{"line":6,"column":10},"end":{"line":14,"column":17}}}))?s:"")+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?a(t,"title"):t)?a(s,"label"):s,{"name":"if","hash":{},"fn":e.program(4,n,0),"inverse":e.noop,"loc":{"start":{"line":15,"column":10},"end":{"line":17,"column":17}}}))?s:"")+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?a(t,"description"):t)?a(s,"value"):s,{"name":"if","hash":{},"fn":e.program(6,n,0),"inverse":e.noop,"loc":{"start":{"line":18,"column":10},"end":{"line":21,"column":17}}}))?s:"")+"        </div>\r\n\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"topRight"):t,{"name":"if","hash":{},"fn":e.program(8,n,0),"inverse":e.noop,"loc":{"start":{"line":24,"column":8},"end":{"line":37,"column":15}}}))?s:"")+'      </div>\r\n\r\n      <div class="conws-relateditem-center '+e.escapeExpression((l=null!=(l=a(i,"inactive")||(null!=t?a(t,"inactive"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"inactive","hash":{},"loc":{"start":{"line":40,"column":43},"end":{"line":40,"column":55}}}):l))+'">\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=(s=null!=t?a(t,"description"):t)?a(s,"value"):s,{"name":"if","hash":{},"fn":e.program(14,n,0),"inverse":e.noop,"loc":{"start":{"line":41,"column":8},"end":{"line":43,"column":15}}}))?s:"")+'      </div>\r\n\r\n      <div class="conws-relateditem-bottom '+e.escapeExpression((l=null!=(l=a(i,"inactive")||(null!=t?a(t,"inactive"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"inactive","hash":{},"loc":{"start":{"line":46,"column":43},"end":{"line":46,"column":55}}}):l))+'">\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"bottomLeft"):t,{"name":"if","hash":{},"fn":e.program(16,n,0),"inverse":e.noop,"loc":{"start":{"line":47,"column":8},"end":{"line":60,"column":15}}}))?s:"")+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"bottomRight"):t,{"name":"if","hash":{},"fn":e.program(21,n,0),"inverse":e.noop,"loc":{"start":{"line":61,"column":8},"end":{"line":74,"column":15}}}))?s:"")+"      </div>\r\n    </div>\r\n  </a>\r\n</div>\r\n\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"notLastItem"):t,{"name":"if","hash":{},"fn":e.program(26,n,0),"inverse":e.noop,"loc":{"start":{"line":80,"column":0},"end":{"line":82,"column":7}}}))?s:"")}});return i.registerPartial("conws_widgets_relatedworkspaces_impl_relateditem",o),o}),csui.define("css!conws/widgets/relatedworkspaces/impl/relateditem",[],function(){}),csui.define("conws/widgets/relatedworkspaces/impl/relateditem.view",["module","csui/lib/underscore","csui/lib/marionette","csui/lib/jquery","conws/utils/previewpane/previewpane.view","csui/behaviors/default.action/default.action.behavior","csui/utils/base","csui/lib/numeral","i18n!conws/widgets/relatedworkspaces/impl/nls/lang","hbs!conws/widgets/relatedworkspaces/impl/relateditem","css!conws/widgets/relatedworkspaces/impl/relateditem"],function(e,t,i,o,n,s,l,a,r,c){return i.ItemView.extend({"behaviors":{"DefaultAction":{"behaviorClass":s}},"constructor":function(){i.ItemView.prototype.constructor.apply(this,arguments)},"triggers":{"click .conws-relateditem-border":"click:item"},"events":{"mouseenter":"showPreviewPane","mouseleave":"hidePreviewPane"},"onClickItem":function(){this.destroyPreviewPane(),this.triggerMethod("execute:defaultAction",this.model)},"onBeforeDestroy":function(e){this.destroyPreviewPane()},"showPreviewPane":function(){this.options&&this.options.data&&this.options.data.preview&&(this.options.data.preview.roleId||this.options.data.preview.metadata)&&(this.previewPane||(this.previewPane=new n({"parent":this,"context":this.options.context,"config":this.options.data&&this.options.data.preview,"node":this.model})),this.previewPane.show())},"hidePreviewPane":function(){this.previewPane&&this.previewPane.delayedHide()},"destroyPreviewPane":function(){this.previewPane&&(this.previewPane.destroy(),delete this.previewPane)},"className":"conws-relateditem-object clearfix","template":c,"serializeData":function(){var e=this._getObject(this.options.data||{}),t={};return e.title&&(t.title=e.title),e.description&&(t.description=e.description),e.topRight&&(t.topRight=e.topRight),e.bottomLeft&&(t.bottomLeft=e.bottomLeft),e.bottomRight&&(t.bottomRight=e.bottomRight),t.title||(t.title={"value":this.model.get("name")}),t.name||(t.name=this.model.get("name")),t.id||(t.id=this.model.get("id")),t.defaultActionUrl=s.getDefaultActionNodeUrl(this.model),this.model.get("id")!==this.model.collection.models[this.model.collection.models.length-1].get("id")&&(t.notLastItem=!0),t.inactive=this.defaultActionController.hasAction(this.model)?"":"inactive",t},"templateHelpers":function(e){return e},"_getObject":function(e){return t.reduce(e,function(e,t,i){if("object"!=typeof t)t=this.self._getValue(t);else if("object"==typeof t)if("value"===i||"label"===i){var o=l.getClosestLocalizedString(t);t=this.self._getValue(o)}else t=this.self._getObject(t);return e[i]=t,e},{},{"self":this})},"_getValue":function(e){for(var t,i,o,n,s,l=/{([^:}]+)(:([^}]+))?}/g,a=e;t=l.exec(e);)o=t[0],i=t[1],s=t[3],this.model.collection.columns.models&&(n=this._formatPlaceholder(i,s,this.model.attributes,this.model.collection.columns.models)),a=a.replace(o,n);return a},"_formatPlaceholder":function(e,i,o,n){var s,r,c,d=e;switch(r=t.find(n,function(t){return t.get("column_key")===e}),c=r&&r.get("type")||void 0,e=o[e+"_expand"]?e+"_expand":e,s=o[e]||"",c){case-7:s=l.formatDate(s);break;case 5:s=o[e+"_formatted"],null!==s&&void 0!==s||(s="");break;case 14:s=-1===e.indexOf("_expand",this.length-"_expand".length)||"User"!==o[e].type_name&&"Group"!==o[e].type_name?o[d+"_formatted"]:l.formatMemberName(s);default:"currency"===i&&(s=a(s).format()),"object"==typeof s&&(s=o[d]||"")}return s}})}),csui.define("conws/utils/workspaces/close.expanded.view",["require","csui/lib/jquery","csui/utils/base","csui/lib/underscore","csui/utils/commandhelper","csui/models/command"],function(e,t,i,o,n,s){"use strict";return s.extend({"defaults":{"signature":"CloseExpandedView","scope":"single"},"enabled":function(e,t){return!0},"execute":function(e,t){}})}),csui.define("conws/widgets/relatedworkspaces/commands",["csui/models/commands","csui/utils/commands","conws/utils/workspaces/close.expanded.view"],function(e,t,i){return new e([new i].concat(t.models))}),csui.define("conws/widgets/relatedworkspaces/toolbaritems",["csui/lib/underscore","i18n!conws/utils/workspaces/impl/nls/lang","i18n!conws/widgets/relatedworkspaces/impl/nls/lang","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui/widgets/favorites/favorite.star.view","csui-ext!conws/widgets/relatedworkspaces/toolbaritems"],function(e,t,i,o,n,s,l){"use strict";var a={"addToolbar":new o({"main":[{"signature":"AddRelation","name":i.ToolbarItemAddRelation,"iconName":"csui_action_add32"}]},{"maxItemsShown":2,"dropDownIconName":"csui_action_more32","dropDownText":"...","addTrailingDivider":!1}),"tableHeaderToolbar":new o({"main":[{"signature":"RemoveRelation","name":i.ToolbarItemRemoveRelation}]},{"maxItemsShown":15,"dropDownIconName":"csui_action_more32","dropDownText":"...","addGroupSeparators":!1,"lazyActions":!0}),"rightToolbar":new o({"main":[{"signature":"CloseExpandedView","name":t.ToolbarItemCloseExpandedView,"iconName":"csui_action_minimize32"}]},{"hAlign":"right","maxItemsShown":5,"dropDownIconName":"csui_action_more32","dropDownText":"...","addTrailingDivider":!1})};return l&&e.each(l,function(t){e.each(t,function(t,i){var o=a[i];if(o||"otherToolbar"!==i||(o=a.tableHeaderToolbar),!o)throw new Error("Invalid target toolbar: "+i);e.each(t,function(e){e=new n(e),o.addItem(e)})})}),a}),csui.define("conws/widgets/relatedworkspaces/toolbaritems.masks",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,t,i,o){"use strict";function n(){var n=e.config(),l=new o;this.toolbars=t.reduce(s,function(e,o){var s=new i(l,{"normalize":!1});return t.each(n,function(e,t){(e=e[o])&&s.extendMask(e)}),s.storeMask(),e[o]=s,e},{})}var s=["filterToolbar","leftToolbar","tableHeaderToolbar","inlineActionbar","rightToolbar"];return n.toolbars=s,n}),csui.define("conws/widgets/relatedworkspaces/headermenuitems",["csui/lib/underscore","i18n!csui/controls/tabletoolbar/impl/nls/localized.strings","csui/controls/toolbar/toolitems.factory","csui/controls/toolbar/toolitem.model","csui-ext!conws/widgets/relatedworkspaces/headermenuitems"],function(e,t,i,o,n){var s={"headerMenuToolbar":new i({"other":[]},{"maxItemsShown":0,"dropDownIcon":"icon icon-expandArrowDown"})};return n&&e.each(n,function(t){e.each(t,function(t,i){var n=s[i];if(!n)throw new Error("Invalid target toolbar: "+i);e.each(t,function(e){e=new o(e),n.addItem(e)})})}),s}),csui.define("conws/widgets/relatedworkspaces/headermenuitems.masks",["module","csui/lib/underscore","csui/controls/toolbar/toolitems.mask","csui/utils/toolitem.masks/global.toolitems.mask"],function(e,t,i,o){"use strict";return i.extend({"constructor":function(){var n=e.config(),s=new o;i.prototype.constructor.call(this,s,{"normalize":!1}),t.each(n,function(e,t){this.extendMask(e)},this),this.storeMask()}})}),csui.define("hbs!conws/utils/workspaces/workspacestable",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){return'<div class="conws-alternating-toolbars">\r\n  <div class="conws-table-tabletoolbar"></div>\r\n  <div class="conws-table-rowselection-toolbar"></div>\r\n</div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"showAlternatingToolbar"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.noop,"loc":{"start":{"line":1,"column":0},"end":{"line":6,"column":7}}}))?s:"")+'<div class="conws-workspacestable">\r\n  <div id="tableview"></div>\r\n  <div id="paginationview"></div>\r\n</div>\r\n'}});return i.registerPartial("conws_utils_workspaces_workspacestable",o),o}),csui.define("conws/utils/workspaces/workspaces.columns",["csui/lib/backbone"],function(e){var t=e.Model.extend({"idAttribute":"key","defaults":{"key":null,"sequence":0}}),i=e.Collection.extend({"model":t,"comparator":"sequence","getColumnKeys":function(){return this.pluck("key")},"deepClone":function(){return new i(this.map(function(e){return e.attributes}))}});return new i([{"key":"type","sequence":10},{"key":"name","sequence":20},{"key":"size","sequence":30},{"key":"modify_date","sequence":40},{"key":"favorite","sequence":910,"noTitleInHeader":!0,"permanentColumn":!0}])}),csui.define("css!conws/utils/workspaces/workspacestable",[],function(){}),csui.define("conws/utils/workspaces/workspacestable.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","i18n!conws/utils/workspaces/impl/nls/lang","hbs!conws/utils/workspaces/workspacestable","csui/behaviors/default.action/default.action.behavior","csui/utils/contexts/factories/connector","csui/models/node/node.model","csui/controls/table/table.view","csui/controls/tabletoolbar/tabletoolbar.view","csui/controls/table.rowselection.toolbar/table.rowselection.toolbar.view","csui/utils/commands","csui/controls/toolbar/toolbar.command.controller","csui/controls/pagination/nodespagination.view","conws/utils/workspaces/workspaces.columns","csui/dialogs/modal.alert/modal.alert","csui/utils/accessibility","csui/utils/base","csui/controls/progressblocker/blocker","conws/utils/workspaces/busyindicator","csui/lib/jquery.redraw","css!conws/utils/workspaces/workspacestable","css!conws/utils/workspaces/workspaces","csui/controls/toolbar/toolbar.view"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h,g,f,w,v,b,y,k,x){var C=e.config(),_={"sortColumn":"{name}","sortOrder":"asc"},T=b.isAccessibleTable();return n.LayoutView.extend({"className":function(){var e="conws-workspaces-table";return T&&(e+=" csui-no-animation"),e},"template":a,"ui":{"toolbarContainer":".conws-alternating-toolbars"},"regions":{"tableToolbarRegion":".conws-table-tabletoolbar","tableRowSelectionToolbarRegion":".conws-table-rowselection-toolbar","tableRegion":"#tableview","paginationRegion":"#paginationview"},"behaviors":{"DefaultAction":{"behaviorClass":r}},"constructor":function(e){if(void 0===e||!e.context)throw new Error("Context required to create WorkspacesTableView");if(!e.collection)throw new Error("Collection required to create WorkspacesTableView");if(e.data||(e.data={}),this.context=e.context,this.collection=e.collection,n.LayoutView.prototype.constructor.apply(this,arguments),i.defaults(this.options.data,{"pageSize":C.defaultPageSize||20,"orderBy":{}}),i.defaults(this.options.data.orderBy,_),this.options&&this.options.data&&this.options.data.expandedView&&this.options.data.expandedView.orderBy)if(i.isString(this.options.data.expandedView.orderBy))s.error(l.errorOrderByMustNotBeString)&&console.log(s.last),v.showError(l.errorOrderByMustNotBeString);else if(this.options.data.expandedView.orderBy.sortColumn){var o=/{([^:}]+)(:([^}]+))?}/g,a=o.exec(this.options.data.expandedView.orderBy.sortColumn);a||(s.error(l.errorOrderByMissingBraces)&&console.log(s.last),v.showError(l.errorOrderByMissingBraces))}this.onWinRefresh=i.bind(this.windowRefresh,this),t(window).on("resize.app",this.onWinRefresh),this.options.blockingParentView?k.delegate(this,this.options.blockingParentView):k.imbue(this),this.listenTo(this,"after:show",this.windowRefresh),this.listenTo(this.collection,"request",this.blockActions).listenTo(this.collection,"sync",this.unblockActions).listenTo(this.collection,"destroy",this.unblockActions).listenTo(this.collection,"error",function(e,t,i){this.unblockActions.apply(this,arguments),t&&v.showError(new y.Error(t).message)}).listenTo(this.collection,"sync",function(){if(this.collection.selectActions){var e=!(!this.options.showSelectColumn||!this.collection.existsSelectable);this.tableView&&this.tableView.options&&this.tableView.options.selectColumn!==e&&(this.tableView.options.selectColumn=e,this.collection.columns.trigger("reset",this.collection.columns))}})},"initialize":function(){if(n.LayoutView.prototype.initialize.apply(this,arguments),this.options.hasTableRowSelection){i.defaults(this.options,{"showCondensedHeaderToggle":!0,"showSelectColumn":!0,"showSelectionCounter":!0}),this.commands=this.options.commands||h,this.commandController=this.options.commandController||new g({"commands":this.commands}),this.listenTo(this.commandController,"before:execute:command",this._beforeExecuteCommand),this.listenTo(this.commandController,"after:execute:command",this._toolbarActionTriggered),this.listenTo(this,"dom:refresh",this._refreshTableToolbar),this.initAllSelection();var e=this.commands,t=i.compact(this.options.toolbarItems.tableHeaderToolbar.collection.map(function(t){return e.get(t.get("signature"))}));this.collection.selectActions=i.flatten(i.map(t,function(e){return e.get("command_key")}))}},"onDestroy":function(){t(window).off("resize.app",this.onWinRefresh)},"_refreshTableToolbar":function(){this.tableToolbarView&&this.tableToolbarView.rightToolbarView&&this.tableToolbarView.rightToolbarView.collection.refilter()},"templateHelpers":function(e){return e=e||{},e.showAlternatingToolbar=!!this.options.hasTableRowSelection,e},"doRender":function(e){i.extend(e.options.query,this._getCollectionUrlQuery()),e.setLimit(0,this.options.data.pageSize,!1);var t=this;e.once("sync",function(){t.renderAfterFetch(t,e)}).fetch(),this.options.hasTableRowSelection&&(this._setToolBar(),this._setTableRowSelectionToolbar({"toolItemFactory":this.options.toolbarItems.tableHeaderToolbar,"toolbarItemsMask":this.options.toolbarItemsMasks.toolbars.tableHeaderToolbar,"showCondensedHeaderToggle":this.options.showCondensedHeaderToggle,"showSelectionCounter":this.options.showSelectionCounter}),this._setTableRowSelectionToolbarEventListeners(),this.tableToolbarRegion.show(this.tableToolbarView),this.tableRowSelectionToolbarRegion&&(this._tableRowSelectionToolbarView&&this.tableRowSelectionToolbarRegion.show(this._tableRowSelectionToolbarView),this.tableRowSelectionToolbarRegion.$el.find("ul").attr("aria-label",l.selectedItemActionBarAria)))},"renderAfterFetch":function(e,t){var o=e.collection.columns,n=e.context.getObject(c),s=[];i.each(o.models,function(e){!0===e.get("sort")&&-1===e.get("type")&&s.push(e.get("column_key"))});var a=w.clone();a.add(this._getCustomColumns(!0)),this.tableColumns=a,this.tableView=new u({"context":this.options.context,"connector":n,"collection":t,"columns":o,"tableAria":this.options.tableAria||"","tableColumns":a,"columnsWithSearch":s,"selectColumn":!(!this.options.showSelectColumn||!this.collection.existsSelectable),"showSelectionCounter":!!this.options.showSelectionCounter,"allSelectedNodes":this.allSelectedNodes,"pageSize":this.options.data.pageSize,"orderBy":this.collection.orderBy,"nameEdit":!1,"actionItems":this.defaultActionController.actionItems,"commands":this.defaultActionController.commands,"tableTexts":{"zeroRecords":l.noWorkspacesFound}}),this.options.hasTableRowSelection&&this._setTableViewEvents(),this.tableView.enableEmptyViewText(),this.listenTo(this.tableView,"execute:defaultAction",function(e){this.triggerMethod("execute:defaultAction",e)}),this.listenTo(this.tableView,"render",function(){this.tableView.triggerMethod("refresh:tabindexes")}),e.paginationView=new f({"collection":t,"pageSize":e.options.data.pageSize}),i.isUndefined(e.tableView.accFocusedState.body.column)||(e.tableView.accFocusedState.body.column=1),e.tableRegion.show(e.tableView),e.paginationRegion.show(e.paginationView)},"_beforeExecuteCommand":function(e){var t=this;switch((e.command&&e.command.get("showBusy")||e.status.toolItem&&e.status.toolItem.get("showBusy"))&&(e.status.busyIndicator=new x(function(){t.blockActions()},function(){t.unblockActions()}),e.status.busyIndicator.on()),e.commandSignature){case"CloseExpandedView":this.context.trigger("close:expanded",{"widgetView":this})}},"_toolbarActionTriggered":function(e){e.status.busyIndicator&&e.status.busyIndicator.off()},"initAllSelection":function(){this.allSelectedNodes=this.getCollectionWithSpecificModelId(),this.listenTo(this.allSelectedNodes,"remove",this.removeItemToAllSelectedItems).listenTo(this.allSelectedNodes,"add",this.addItemToAllSelectedItems).listenTo(this.allSelectedNodes,"reset",this.resetAllSelectedItems)},"findNodeFromCollection":function(e,t){return e.get(t)||e.findWhere({"id":t.get("id")})},"getCollectionWithSpecificModelId":function(){var e=o.Collection.extend({"modelId":function(e){return e.id}}),t=new e;return this.collection&&this.collection.modelId&&(t.modelId=this.collection.modelId),t},"removeItemToAllSelectedItems":function(e){var t=this.findNodeFromCollection(this.collection,e);t?t.set("csuiIsSelected",!1):e.set("csuiIsSelected",!1)},"addItemToAllSelectedItems":function(e){var t=this.findNodeFromCollection(this.collection,e);t?t.set("csuiIsSelected",!0):e.set("csuiIsSelected",!0)},"resetAllSelectedItems":function(){var e=this.allSelectedNodes;this.collection.each(i.bind(function(t){var i=e.get(t);t.set("csuiIsSelected",void 0!==i)},this))},"_setTableViewEvents":function(){return this.listenTo(this.tableView,"tableRowSelected",function(e){if(this.tableView.cancelAnyExistingInlineForm.call(this.tableView),this.options.showSelectColumn&&this.allSelectedNodes){var t=e.nodes,o=[];i.each(t,function(e){this.allSelectedNodes.get(e)||void 0===e.get("id")||o.push(e)},this),this.allSelectedNodes.reset(o.concat(this.allSelectedNodes.models))}}),this.listenTo(this.tableView,"tableRowUnselected",function(e){if(this.options.showSelectColumn&&this.allSelectedNodes){var t=e.nodes;i.each(t,function(e){this.allSelectedNodes.remove(e,{"silent":!0})},this),this.allSelectedNodes.reset(i.clone(this.allSelectedNodes.models))}}),!0},"_setTableRowSelectionToolbarEventListeners":function(){this.listenTo(this.allSelectedNodes,"reset update",function(){this._tableRowSelectionToolbarView.isDestroyed||this.tableRowSelectionToolbarRegion.show(this._tableRowSelectionToolbarView),this._onSelectionUpdateCssClasses(this.allSelectedNodes.length)})},"_setToolBar":function(){var e=new d({"type":this.collection.node.get("type"),"type_name":this.collection.node.get("type_name"),"parent_id":this.collection.node.get("parent_id"),"image_url":this.collection.titleIcon,"name":this.options.title},{"connector":this.collection.connector});return this.tableToolbarView=new p({"context":this.options.context,"toolbarItems":this.options.toolbarItems,"toolbarItemsMasks":this.options.toolbarItemsMasks,"headermenuItems":this.options.headermenuItems,"headermenuItemsMask":this.options.headermenuItemsMask,"creationToolItemsMask":this.options.creationToolItemsMask,"container":e,"collection":this.collection,"originatingView":this,"blockingParentView":this.options.blockingParentView||this,"addableTypes":this.addableTypes,"toolbarCommandController":this.commandController}),this.tableToolbarView.captionView.nameView.readonly=!0,this.listenTo(this.collection,"sync",function(){this.collection.titleIcon!==e.get("image_url")&&e.set("image_url",this.collection.titleIcon)}),!0},"_setTableRowSelectionToolbar":function(e){this._tableRowSelectionToolbarView=new m({"toolItemFactory":e.toolItemFactory,"toolbarItemsMask":e.toolbarItemsMask,"toolbarCommandController":this.commandController,"showCondensedHeaderToggle":e.showCondensedHeaderToggle,"showSelectionCounter":e.showSelectionCounter,"commands":this.defaultActionController.commands,"selectedChildren":this.allSelectedNodes,"container":this.collection.node,"context":this.context,"originatingView":this,"collection":this.collection,"scrollableParent":".csui-table-tableview .csui-nodetable"});var t=this._tableRowSelectionToolbarView;this.listenTo(t,"toggle:condensed:header",function(){if(this.$el&&this.$el.hasClass("conws-table-rowselection-toolbar-visible")){var e=!this.$el.hasClass("csui-show-header");this.$el.addClass("csui-transitioning"),this.tableToolbarRegion.$el.one("transitionend",function(){this.$el.removeClass("csui-transitioning"),e||this.tableToolbarRegion.$el.addClass("binf-hidden")}.bind(this)),e&&(this.tableToolbarRegion.$el.removeClass("binf-hidden"),this.tableToolbarRegion.currentView.trigger(this.tableToolbarRegion.currentView,"dom:refresh")),this.$el&&this.$el.toggleClass("csui-show-header"),t.trigger("toolbar:activity",!0,e)}})},"_triggerToolbarActivityEvent":function(e,t){this._tableRowSelectionToolbarView.trigger("toolbar:activity",e,t)},"_onSelectionUpdateCssClasses":function(e){function t(e){o.$el.removeClass("csui-transitioning"),o._triggerToolbarActivityEvent(o._tableRowSelectionToolbarVisible,e),o._tableRowSelectionToolbarVisible?e||o.tableToolbarRegion.$el.addClass("binf-hidden"):o.tableRowSelectionToolbarRegion.$el.addClass("binf-hidden")}var i,o=this,n=this.tableRowSelectionToolbarRegion.$el;T?e>0?this._tableRowSelectionToolbarVisible||(this._tableRowSelectionToolbarVisible=!0,this.$el.addClass("csui-transitioning"),n.removeClass("binf-hidden"),this.$el.addClass("conws-table-rowselection-toolbar-visible"),i=this.$el&&this.$el.hasClass("csui-show-header"),t(i)):this._tableRowSelectionToolbarVisible&&(this._tableRowSelectionToolbarVisible=!1,this.$el.addClass("csui-transitioning"),this.$el&&this.$el.removeClass("csui-show-header"),this.tableToolbarRegion.$el.removeClass("binf-hidden"),this.tableToolbarRegion.currentView.trigger(this.tableToolbarRegion.currentView,"dom:refresh"),this.$el.removeClass("conws-table-rowselection-toolbar-visible"),t(!1)):e>0?this._tableRowSelectionToolbarVisible||(this.$el.addClass("csui-transitioning"),this._tableRowSelectionToolbarVisible=!0,i=this.$el&&this.$el.hasClass("csui-show-header"),n.removeClass("binf-hidden").redraw().one("transitionend",function(){t(i)}.bind(this)),this.$el.addClass("conws-table-rowselection-toolbar-visible")):this._tableRowSelectionToolbarVisible&&(this._tableRowSelectionToolbarVisible=!1,this.$el.addClass("csui-transitioning"),this.$el&&this.$el.removeClass("csui-show-header"),this.tableToolbarRegion.$el.removeClass("binf-hidden").redraw(),this.tableToolbarRegion.currentView.trigger(this.tableToolbarRegion.currentView,"dom:refresh"),n.one("transitionend",function(){t(!1)}.bind(this)),this.$el.removeClass("conws-table-rowselection-toolbar-visible"))},"_getCustomColumns":function(e){var t=[],o=[];if(this.options&&this.options.data&&this.options.data.expandedView&&this.options.data.expandedView.customColumns){var n=!1,a=500;if(this.options.data.expandedView.customColumns.forEach(function(r){var c=/{([^:}]+)(:([^}]+))?}/g,d=c.exec(r.key);d?t.push(i.defaults({"key":d[1],"sequence":a++},r)):e&&(r.key&&r.key.indexOf("{")>=0?(n=!0,s.error(l.errorCustomColumnConfigInvalid,r.key)&&console.log(s.last)):s.error(l.errorCustomColumnMissingBraces,r.key)&&console.log(s.last),o.push(r.key))}),e&&o.length>0){var r=n?l.errorCustomColumnConfigInvalid:l.errorCustomColumnMissingBraces;v.showError(i.str.sformat(r,o.join(", ")))}}return t},"_getCustomColumnKeys":function(){var e=this._getCustomColumns();return e.length>0?t.map(e,function(e,t){return e.key}):[]},"_getCoreColumnKeys":function(){var e=w.models;return e.length>0?t.map(e,function(e,t){return e.get("key")}):[]},"getColumnsToFetch":function(){var e=this._getCustomColumnKeys(),o=this._getCoreColumnKeys(),n=["id","type","type_name","container"];return i.each(o,function(i){t.inArray(i,e)<0&&e.push(i)}),i.each(n,function(i){t.inArray(i,e)<0&&e.push(i)}),e.toString()},"windowRefresh":function(){this.paginationView&&this.paginationView.triggerMethod("dom:refresh")},"onDomRefresh":function(){i.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.trigger("dom:refresh")})},"onShow":function(){i.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.trigger("show")})},"onAfterShow":function(){i.each(this.regionManager._regions,function(e){e.currentView&&e.currentView.triggerMethod("after:show")})}})}),csui.define("css!conws/widgets/relatedworkspaces/impl/relatedworkspacestable",[],function(){}),csui.define("conws/widgets/relatedworkspaces/impl/relatedworkspacestable.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","conws/models/workspacecontext/workspacecontext.factory","conws/widgets/header/impl/header.model.factory","conws/widgets/relatedworkspaces/commands","conws/widgets/relatedworkspaces/toolbaritems","conws/widgets/relatedworkspaces/toolbaritems.masks","conws/widgets/relatedworkspaces/headermenuitems","conws/widgets/relatedworkspaces/headermenuitems.masks","conws/utils/workspaces/impl/workspaceutil","conws/utils/workspaces/workspacestable.view","i18n!conws/widgets/relatedworkspaces/impl/nls/lang","css!conws/widgets/relatedworkspaces/impl/relatedworkspacestable"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h,g){return h.extend({"constructor":function(e){e.workspaceContext||(e.workspaceContext=e.context.getObject(l),e.workspaceContext.setWorkspaceSpecific(a)),h.prototype.constructor.apply(this,arguments),this.collection.workspace=e.workspaceContext.getModel(a),this.collection.workspace.fetch(),this.listenTo(this.collection.workspace,"sync",function(){this.tableToolbarView&&this.tableToolbarView.addToolbarView&&this.tableToolbarView.addToolbarView.collection.refilter()})},"initialize":function(){this.options.commands=r,this.options.hasTableRowSelection=!0,this.options.toolbarItems=c,this.options.toolbarItemsMasks=new d,this.options.headermenuItems=u,this.options.headermenuItemsMasks=new p,h.prototype.initialize.apply(this,arguments)},"onRender":function(){var e=this.collection;i.isUndefined(this.collection.options.relatedWorkspaces.attributes.sortExpanded)?e.orderBy=m.orderByAsString(this.options.data.orderBy):e.orderBy=this.collection.options.relatedWorkspaces.attributes.sortExpanded,this.options.tableAria="",i.isUndefined(e.options.attributes.title)||(this.options.tableAria=i.str.sformat(g.expandTableAria,e.options.attributes.title)),this.doRender(e)},"_getCollectionUrlQuery":function(){var e={"where_relationtype":this.options.data.relationType};return e.fields=encodeURIComponent("properties{"+this.getColumnsToFetch()+"}"),e.action="properties-properties",e.expand_users="true",e},"_beforeExecuteCommand":function(e){h.prototype._beforeExecuteCommand.apply(this,arguments)},"_toolbarActionTriggered":function(e){if(h.prototype._toolbarActionTriggered.apply(this,arguments),e&&!e.cancelled){var t,i=this;switch(e.commandSignature){case"AddRelation":if(i.changed=!0,(t=e.newNodes)&&t.length>0){t.forEach(function(e){e.isLocallyCreated=!0,e.attributes&&delete e.attributes.csuiIsSelected,e.collection=i.collection,e.selectable=!0}),this.collection.totalCount=this.collection.totalCount+t.length,t.length>this.collection.topCount?t=t.slice(0,this.collection.topCount):t.length<this.collection.topCount&&(t=t.concat(this.collection.slice(0,this.collection.topCount-t.length))),this.collection.updateSelectableState(t);var o=!(!this.options.showSelectColumn||!this.collection.existsSelectable);this.tableView&&this.tableView.options&&this.tableView.options.selectColumn!==o?(this.tableView.options.selectColumn=o,this.collection.reset(t,{"silent":!0}),this.collection.columns.trigger("reset",this.collection.columns),this.tableView.resetScrollToTop(),this.paginationView&&this.paginationView.collectionChange()):(this.collection.reset(t),this.tableView&&this.tableView.resetScrollToTop())}break;case"RemoveRelation":this.changed=!0,this.collection.fetch().then(function(){i.collection.totalCount<=i.collection.skipCount&&i.collection.totalCount>0&&i.collection.totalCount<=i.collection.topCount&&(i.collection.skipCount=0,i.collection.fetch())}),this.allSelectedNodes.reset([])}}}})}),
csui.define("conws/widgets/relatedworkspaces/relatedworkspaces.view",["csui/lib/marionette","module","csui/lib/underscore","csui/lib/backbone","csui/lib/jquery","csui/utils/log","conws/models/workspacecontext/workspacecontext.factory","conws/utils/workspaces/workspaces.view","conws/widgets/relatedworkspaces/impl/relateditem.view","conws/widgets/relatedworkspaces/impl/relatedworkspaces.factory","conws/widgets/relatedworkspaces/impl/relatedworkspacestable.view","csui/dialogs/modal.alert/modal.alert","csui/utils/base","conws/utils/workspaces/impl/workspaceutil","i18n!conws/utils/workspaces/impl/nls/lang","i18n!conws/widgets/relatedworkspaces/impl/nls/lang","css!conws/utils/icons/icons","hbs!conws/widgets/relatedworkspaces/impl/relateditem","css!conws/widgets/relatedworkspaces/impl/relateditem"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h,g){return a.extend({"constructor":function(e){if(this.viewClassName="conws-relatedworkspaces",e.workspaceContext||(e.workspaceContext=e.context.getObject(l),e.workspaceContext.setWorkspaceSpecific(c)),a.prototype.constructor.apply(this,arguments),this.limit=-1,this.options&&this.options.data&&this.options.data.collapsedView&&this.options.data.collapsedView.orderBy)if(i.isString(this.options.data.collapsedView.orderBy))s.error(h.errorOrderByMustNotBeString)&&console.log(s.last),u.showError(h.errorOrderByMustNotBeString);else if(this.options.data.collapsedView.orderBy.sortColumn){var t=/{([^:}]+)(:([^}]+))?}/g,o=t.exec(this.options.data.collapsedView.orderBy.sortColumn);o||(s.error(h.errorOrderByMissingBraces)&&console.log(s.last),u.showError(h.errorOrderByMissingBraces))}if(this.options&&this.options.data&&this.options.data.collapsedView){var n=[],r=this;["title","description","topRight","bottomLeft","bottomRight"].forEach(function(e){r.options.data.collapsedView[e]&&r.options.data.collapsedView[e].format&&n.push(e)}),n.length>0&&u.showError(i.str.sformat(g.errorFieldFormatTagUnrecognized,n.join(", ")))}},"getContext":function(){return this.options.workspaceContext},"childView":r,"childViewOptions":function(){return{"context":this.options.context,"checkDefaultAction":!0,"data":this.options.data.collapsedView}},"emptyViewOptions":{"templateHelpers":function(){return{"text":this._parent._getNoResultsPlaceholder()}}},"workspacesCollectionFactory":c,"workspacesTableView":d,"dialogClassName":"relatedworkspaces","lang":g,"_getExpandedViewOptions":function(){return i.extend(a.prototype._getExpandedViewOptions.apply(this,arguments),{"title":this._getTitle()})},"_getCollectionAttributes":function(){return{"workspaceTypeId":this.options.data.workspaceTypeId,"relationType":this.options.data.relationType,"sortExpanded":this.options.data.expandedView&&m.orderByAsString(this.options.data.expandedView.orderBy)||void 0,"sortCollapsed":this.options.data.collapsedView&&m.orderByAsString(this.options.data.collapsedView.orderBy)||this._getDefaultSortOrder()||void 0,"title":p.getClosestLocalizedString(this.options.data.title,g.dialogTitle)}},"_getDefaultSortOrder":function(){return this._getFilterPropertyName()?this._getFilterPropertyName()+" asc":void 0},"_getCollectionUrlQuery":function(){var e=this.options,t={},o=this._getPropertiesToFetch(e.data.collapsedView),n=["id","container","name","type","type_name"];n=i.union(n,o),t.fields=encodeURIComponent("properties{"+n.join(",")+"}"),t.action="properties-properties",t.where_workspace_type_id=e.data.workspaceTypeId,t.where_relationtype=e.data.relationType;var s;return e.data.collapsedView&&(s=m.orderByAsString(e.data.collapsedView.orderBy)),s||(s=this._getDefaultSortOrder()),s&&(t.sort=s),t.expand_users="true",t},"_getFirstPlaceholder":function(e){for(var t,i,o=/{([^:}]+)(:([^}]+))?}/g;t=o.exec(e);)if(t[0],t[1]){i=t;break}return i},"_getFilterPropertyName":function(){var e;if(this.options&&this.options.data&&this.options.data.collapsedView&&this.options.data.collapsedView.title&&this.options.data.collapsedView.title.value){var t=this._getFirstPlaceholder(this.options.data.collapsedView.title.value);t&&(e=t[1])}return e},"_getConfiguredProperties":function(e){var t,i={},o=/{([^:}]+)(:([^}]+))?}/g,s=function(e){if("object"!=typeof e)for(;t=o.exec(e);)i[t[1]]="";else n.each(e,function(e,t){s(t)})};return s(e),i},"_getPropertiesToFetch":function(e){var t=this._getConfiguredProperties(e);return Object.keys(t)},"getElementByIndex":function(e){if(isNaN(e)||e<0)return null;var t=this.$(i.str.sformat(".conws-relateditem-object:nth-child({0}) .conws-relateditem-border",e+1));return this.$(t[0])},"templateHelpers":function(){return i.extend(a.prototype.templateHelpers.apply(this,arguments),{"searchAria":g.searchAria,"expandAria":g.expandAria})}})}),csui.define("csui/utils/high.contrast/detector",[],function(){"use strict";function e(){var e=document.createElement("div"),i=e.style;i.backgroundColor="rgb(127, 127, 127)",i.borderWidth="1px",i.borderStyle="solid",i.borderTopColor="#ff0000",i.borderRightColor="#00ffff",i.position="absolute",i.left="-9999px",i.width=e.style.height="2px";var o=document.body;o.appendChild(e),i=window.getComputedStyle(e);var n=i.backgroundColor;t="rgb(127, 127, 127)"===n?0:"rgb(255, 255, 255)"===n?2:1,o.removeChild(e);var s=t?"add":"remove",l="csui-highcontrast-light-on-dark";2===t&&(l="csui-highcontrast-dark-on-light"),document.documentElement.classList[s]("csui-highcontrast"),document.documentElement.classList[s](l)}var t;return{"load":function(i,o,n,s){function l(){if("complete"===document.readyState)return void 0===t&&e(),n(t),!0}s.isBuild?n(null):l()||document.addEventListener("readystatechange",l)}}}),csui.define("hbs!conws/widgets/header/impl/navitem",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<a class="conws-header-navlink" href="'+e.escapeExpression((s=null!=(s=l(i,"backToPreviousLink")||(null!=t?l(t,"backToPreviousLink"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"backToPreviousLink","hash":{},"loc":{"start":{"line":1,"column":38},"end":{"line":1,"column":60}}}):s))+'" title="'+e.escapeExpression((s=null!=(s=l(i,"backToPreviousTitle")||(null!=t?l(t,"backToPreviousTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"backToPreviousTitle","hash":{},"loc":{"start":{"line":1,"column":69},"end":{"line":1,"column":92}}}):s))+'">\r\n  <div class="conws-header-navicon"></div>\r\n  <div class="conws-header-navtext">'+e.escapeExpression((s=null!=(s=l(i,"backToPreviousTitle")||(null!=t?l(t,"backToPreviousTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"backToPreviousTitle","hash":{},"loc":{"start":{"line":3,"column":36},"end":{"line":3,"column":59}}}):s))+"</div>\r\n</a>\r\n"}});return i.registerPartial("conws_widgets_header_impl_navitem",o),o}),csui.define("conws/widgets/header/impl/nls/header.lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/header/impl/nls/root/header.lang",{"changeIconDialogTitle":"Change picture","changeIconDialogMessage":"For best results, use square images. Use JPEG, PNG or GIF formats not larger than %1.","changeIconDialogBtnReset":"Reset","changeIconDialogBtnResetTitle":"Reset to configured icon","changeIconDialogBtnUpload":"Change","changeIconDialogBtnUploadTitle":"Change to individual icon","changeIconDialogBtnCancel":"Cancel","changeIconDialogBtnCancelTitle":"Cancel","changeIconDialogDefaultError":"The image cannot be changed due to a server error.","chooseInpFileTitle":"Choose file","iconMessage":"Business Workspace Edit Icon","CollapsePageOverlay":"Close"}),csui.define("hbs!conws/widgets/header/impl/editicon",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <p class="reset" title="'+e.escapeExpression((s=null!=(s=l(i,"resetTitle")||(null!=t?l(t,"resetTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"resetTitle","hash":{},"loc":{"start":{"line":7,"column":32},"end":{"line":7,"column":46}}}):s))+'"><a href="#">'+e.escapeExpression((s=null!=(s=l(i,"reset")||(null!=t?l(t,"reset"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"reset","hash":{},"loc":{"start":{"line":7,"column":60},"end":{"line":7,"column":69}}}):s))+"</a></p>\r\n"},"3":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <button type="button" class="binf-btn binf-btn-primary upload"\r\n                title="'+e.escapeExpression((s=null!=(s=l(i,"uploadTitle")||(null!=t?l(t,"uploadTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"uploadTitle","hash":{},"loc":{"start":{"line":13,"column":23},"end":{"line":13,"column":38}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"upload")||(null!=t?l(t,"upload"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"upload","hash":{},"loc":{"start":{"line":13,"column":40},"end":{"line":13,"column":50}}}):s))+"</button>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"<div class=\"conws-popover\">\r\n  <div class='title'>"+e.escapeExpression((l=null!=(l=a(i,"title")||(null!=t?a(t,"title"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":2,"column":21},"end":{"line":2,"column":30}}}):l))+"</div>\r\n  <div class='message'>"+e.escapeExpression((l=null!=(l=a(i,"message")||(null!=t?a(t,"message"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"message","hash":{},"loc":{"start":{"line":3,"column":23},"end":{"line":3,"column":34}}}):l))+'</div>\r\n  <div class="buttons">\r\n    <div class="buttons binf-left">\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"resetButton"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.noop,"loc":{"start":{"line":6,"column":6},"end":{"line":8,"column":13}}}))?s:"")+'    </div>\r\n    <div class="buttons binf-right">\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"uploadButton"):t,{"name":"if","hash":{},"fn":e.program(3,n,0),"inverse":e.noop,"loc":{"start":{"line":11,"column":6},"end":{"line":14,"column":13}}}))?s:"")+'      <button type="button" class="binf-btn binf-btn-default cancel"\r\n              title="'+e.escapeExpression((l=null!=(l=a(i,"cancelTitle")||(null!=t?a(t,"cancelTitle"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"cancelTitle","hash":{},"loc":{"start":{"line":16,"column":21},"end":{"line":16,"column":36}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"cancel")||(null!=t?a(t,"cancel"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"cancel","hash":{},"loc":{"start":{"line":16,"column":38},"end":{"line":16,"column":48}}}):l))+"</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n"}});return i.registerPartial("conws_widgets_header_impl_editicon",o),o}),csui.define("css!conws/widgets/header/impl/editicon",[],function(){}),csui.define("conws/widgets/header/impl/editicon.view",["require","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","i18n!conws/widgets/header/impl/nls/header.lang","hbs!conws/widgets/header/impl/editicon","css!conws/widgets/header/impl/editicon"],function(e,t,i,o,n,s){return o.ItemView.extend({"classname":"conws-popover","template":s,"triggers":{"click .reset > a":"click:reset","click .upload":"click:upload","click .cancel":"click:cancel"},"events":{"keydown":"onKeyDown"},"constructor":function(e){e||(e={}),e.title=e.title||n.changeIconDialogTitle,e.message=e.message||n.changeIconDialogMessage,e.resetButton=void 0===e.resetButton||e.resetButton,e.uploadButton=void 0===e.uploadButton||e.uploadButton,this.tabableElements=[],(t.isFunction(e.resetButton)&&e.resetButton()||!0===e.resetButton)&&this.tabableElements.push(".reset > a"),this.tabableElements.push(".upload",".cancel");var s=this;i(".conws-header-edit").on("shown.binf.popover",function(){s._currentlyFocusedElement=s.tabableElements[0],s.$el.find(s._currentlyFocusedElement).focus(),i(".conws-header-edit").off("shown.binf.popover")}),o.ItemView.prototype.constructor.call(this,e)},"templateHelpers":function(){return{"title":this.options.title,"message":this.options.message,"resetButton":this.options.resetButton,"reset":n.changeIconDialogBtnReset,"resetTitle":n.changeIconDialogBtnResetTitle,"uploadButton":this.options.uploadButton,"upload":n.changeIconDialogBtnUpload,"uploadTitle":n.changeIconDialogBtnUploadTitle,"cancel":n.changeIconDialogBtnCancel,"cancelTitle":n.changeIconDialogBtnCancelTitle}},"_focusNextElement":function(e){var i=t.indexOf(this.tabableElements,this._currentlyFocusedElement);e?--i<0&&(i=this.tabableElements.length-1):++i===this.tabableElements.length&&(i=0);var o=this.tabableElements[i],n=this.$el.find(o);return 1===n.length&&n.is(":visible")&&(this._currentlyFocusedElement=o,n.focus()),!0},"onKeyDown":function(e){switch(e.keyCode){case 9:this._focusNextElement(e.shiftKey)&&(e.preventDefault(),e.stopPropagation());break;case 27:e.preventDefault(),e.stopPropagation(),i(".cancel").trigger("click")}},"onClick":function(e){"function"==typeof this.options.callback&&this.options.callback(e)},"onClickReset":function(e){this.onClick("reset")},"onClickUpload":function(e){this.onClick("upload")},"onClickCancel":function(e){this.onClick("cancel")}})}),csui.define("hbs!conws/widgets/header/impl/headertoolbar",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){return'      <div class="conws-rightToolbar" ></div>   \r\n      <div class="conws-delayedActionsToolbar"></div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="conws-tabletoolbar tile-nav" aria-label="Table menubar" role="menu">\r\n   \r\n   <div class="conws-header-status-indicators-section">\r\n      <div class="conws-header-status-indicators">        \r\n      </div>\r\n      <div class="conws-header-status-toolbar-divider"></div>\r\n   </div>\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"hasToolbarView"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.noop,"loc":{"start":{"line":8,"column":3},"end":{"line":11,"column":10}}}))?s:"")+'      <div class="conws-header-collapse"></div>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_header_impl_headertoolbar",o),o}),csui.define("hbs!conws/widgets/header/impl/collapse/collapse",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="conws-collapse" role="button" tabindex="0" title="'+e.escapeExpression((l=null!=(l=a(i,"title")||(null!=t?a(t,"title"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":1,"column":62},"end":{"line":1,"column":71}}}):l))+'">\r\n    '+(null!=(s=(a(i,"icon-v2")||t&&a(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"states":"true","theme":null!=t?a(t,"iconTheme"):t,"iconName":"csui_action_minimize32"},"loc":{"start":{"line":2,"column":4},"end":{"line":2,"column":81}}}))?s:"")+"\r\n</div>"}});return i.registerPartial("conws_widgets_header_impl_collapse_collapse",o),o}),csui.define("css!conws/widgets/header/impl/collapse/collapse",[],function(){}),csui.define("conws/widgets/header/impl/collapse/collapse.page.overlay",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/controls/icons.v2","csui/utils/high.contrast/detector!","hbs!conws/widgets/header/impl/collapse/collapse","i18n!conws/widgets/header/impl/nls/header.lang","css!conws/widgets/header/impl/collapse/collapse"],function(e,t,i,o,n,s,l){"use strict";return i.ItemView.extend({"className":"conws-collapse","template":s,"events":{"keydown":"onKeyInView","click":"_executeCollapse"},"constructor":function(e){this.options=e||{},this.options.title=l.CollapsePageOverlay,this.options.icon="icon",this._useIconsForDarkBackground=2!==n,i.ItemView.prototype.constructor.apply(this,arguments)},"templateHelpers":function(){return{"title":this.options.title,"icon":this.options.icon,"iconTheme":this._useIconsForDarkBackground?"dark":""}},"onKeyInView":function(t){e(t.target);13!==t.keyCode&&32!==t.keyCode||this._executeCollapse(t)},"_executeCollapse":function(e){this.options.perspective&&this.options.perspective.trigger("close:workspace:dialog")}})}),csui.define("css!conws/widgets/header/impl/headertoolbar",[],function(){}),csui.define("conws/widgets/header/impl/headertoolbar.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","hbs!conws/widgets/header/impl/headertoolbar","conws/controls/lazyactions/lazyToolbar.view","csui/controls/toolbar/toolbar.view","csui/controls/toolbar/toolitems.filtered.model","csui/utils/commands","csui/controls/toolbar/toolbar.command.controller","csui/models/nodes","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","conws/widgets/header/impl/collapse/collapse.page.overlay","css!conws/widgets/header/impl/headertoolbar"],function(e,t,i,o,n,s,l,a,r,c,d,u,p){"use strict";var m=o.LayoutView.extend({"template":n,"regions":{"statusIndicatorsRegion":".conws-header-status-indicators","dividerRegion":".conws-header-status-toolbar-divider","toolbarRegion":".conws-rightToolbar","delayedActionsToolbarRegion":".conws-delayedActionsToolbar","collapseRegion":".conws-header-collapse"},"ui":{"toolbarRegion":".conws-rightToolbar","delayedActionsToolbarRegion":".conws-delayedActionsToolbar","statusIndicatorsRegion":".conws-header-status-indicators","dividerRegion":".conws-header-status-toolbar-divider","collapseRegion":".conws-header-collapse"},"templateHelpers":function(){return{"hasToolbarView":!this.options.hideToolbar}},"constructor":function(e){e||(e={}),o.LayoutView.prototype.constructor.apply(this,arguments),this.propagateEventsToRegions()},"initialize":function(e){if(!e.hideToolbar){var t=e.toolbarItems,i=e.toolbarItemsMasks,o=e.node;new d(o).connector=o.connector,this.commandController=new c({"commands":e.commands||r}),this.commonToolbarOptions={"originatingView":e.originatingView,"context":e.context,"toolbarCommandController":this.commandController,"container":e.container,"useIconsForDarkBackground":e.useIconsForDarkBackground};var n=t?t.rightToolbar:void 0,s=i?i.toolbars.rightToolbar:void 0;this._righttoolbarView=this._setToolbarView(o,n,s,t.rightToolbar.options);var l=t?t.delayedActionsToolbar:void 0,a=i?i.toolbars.delayedActionsToolbar:void 0;this._delayedActionsToolbarView=this._setToolbarView(o,l,a,t.delayedActionsToolbar.options)}if(e.statusIndicatorsView&&e.statusIndicatorsViewOptions&&(this._statusIndicatorsView=new e.statusIndicatorsView(e.statusIndicatorsViewOptions)),e.enableCollapse){var u;e.context.perspective&&(u={"perspective":e.context.perspective}),this._collapseView=new p(u)}e.originatingView&&this.listenTo(e.originatingView,"adjust:toolbar",this.adjustToolbar),this.listenTo(this,"dom:refresh",this._DomRefresh),this.listenTo(this,"status:indicator:available",this.showDivider),this._delayedActionsToolbarView&&this.listenTo(this._delayedActionsToolbarView,"render",this._DomRefresh)},"onRender":function(){this.delegateEvents(),this._statusIndicatorsView&&this.statusIndicatorsRegion.show(this._statusIndicatorsView),this._righttoolbarView&&this.toolbarRegion.show(this._righttoolbarView),this._delayedActionsToolbarView&&this.delayedActionsToolbarRegion.show(this._delayedActionsToolbarView),this._collapseView&&this.collapseRegion.show(this._collapseView),this._showDivider&&this.ui.dividerRegion.addClass("divider-show")},"_setToolbarView":function(e,i,o,n){var l=new d([e]);l.connector=e.connector;var r=t.extend(this.commonToolbarOptions,{"nodes":l}),c=new a(i,{"status":r,"commands":this.commandController.commands,"delayedActions":e.delayedActions,"mask":o});return new s(t.extend({"collection":c},this.commonToolbarOptions,n))},"showDivider":function(){!this._collapseView&&this.options.hideToolbar||(this._showDivider=!0,this.ui.dividerRegion.addClass("divider-show"))},"onDestroy":function(){this._statusIndicatorsView&&this._statusIndicatorsView.destroy(),this._righttoolbarView&&this._righttoolbarView.destroy(),this._delayedActionsToolbarView&&this._delayedActionsToolbarView.destroy(),this._collapseView&&this._collapseView.destroy()},"_DomRefresh":function(){this._righttoolbarView&&this._righttoolbarView.triggerMethod("dom:refresh"),this._delayedActionsToolbarView&&this._delayedActionsToolbarView.triggerMethod("delayed:toolbar:refresh")},"adjustToolbar":function(){arguments&&arguments.length>0&&arguments[0].tabIndex,0===this.$el.find(".binf-dropdown").length&&this._DomRefresh()}});return t.extend(m.prototype,u),m}),csui.define("hbs!conws/widgets/header/impl/icon",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="conws-header-edit" tabindex="0" role="button" data-binf-toggle="popover"\r\n    aria-label="'+e.escapeExpression((l=null!=(l=a(i,"iconMsg")||(null!=t?a(t,"iconMsg"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"iconMsg","hash":{},"loc":{"start":{"line":3,"column":16},"end":{"line":3,"column":27}}}):l))+'">\r\n    <div class="header-image">\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"iconCustomized"):t,{"name":"if","hash":{},"fn":e.program(2,n,0),"inverse":e.program(4,n,0),"loc":{"start":{"line":5,"column":6},"end":{"line":9,"column":13}}}))?s:"")+'    </div>\r\n    <div class="header-editor">\r\n      <span> '+(null!=(s=(a(i,"icon-v2")||t&&a(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"on":"true","iconName":"csui_action_edit32"},"loc":{"start":{"line":12,"column":13},"end":{"line":12,"column":66}}}))?s:"")+'</span>\r\n    </div>\r\n  </div>\r\n  <input class="conws-header-icon-file" title="'+e.escapeExpression((l=null!=(l=a(i,"chooseInpFileTitle")||(null!=t?a(t,"chooseInpFileTitle"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"chooseInpFileTitle","hash":{},"loc":{"start":{"line":15,"column":47},"end":{"line":15,"column":69}}}):l))+'" type="file"\r\n  accept="'+e.escapeExpression((l=null!=(l=a(i,"iconFileTypes")||(null!=t?a(t,"iconFileTypes"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"iconFileTypes","hash":{},"loc":{"start":{"line":16,"column":10},"end":{"line":16,"column":27}}}):l))+'" style="display:none">\r\n'},"2":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <img src="'+e.escapeExpression((s=null!=(s=l(i,"iconData")||(null!=t?l(t,"iconData"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"iconData","hash":{},"loc":{"start":{"line":6,"column":18},"end":{"line":6,"column":30}}}):s))+'" alt="'+e.escapeExpression((s=null!=(s=l(i,"type")||(null!=t?l(t,"type"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"type","hash":{},"loc":{"start":{"line":6,"column":37},"end":{"line":6,"column":45}}}):s))+'">\r\n'},"4":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"        "+(null!=(s=(l(i,"icon-v2")||t&&l(t,"icon-v2")||e.hooks.helperMissing).call(null!=t?t:e.nullContext||{},{"name":"icon-v2","hash":{"size":"contain","iconName":"conws_mime_workspace"},"loc":{"start":{"line":8,"column":8},"end":{"line":8,"column":68}}}))?s:"")+"\r\n"},"6":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'  <div class="header-image">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"iconCustomized"):t,{"name":"if","hash":{},"fn":e.program(2,n,0),"inverse":e.program(4,n,0),"loc":{"start":{"line":19,"column":6},"end":{"line":23,"column":13}}}))?s:"")+"    </div>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"canChange"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.program(6,n,0),"loc":{"start":{"line":1,"column":0},"end":{"line":25,"column":7}}}))?s:""}});return i.registerPartial("conws_widgets_header_impl_icon",o),o}),csui.define("conws/widgets/header/impl/icon.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/base","csui/dialogs/modal.alert/modal.alert","csui/utils/nodesprites","csui/controls/icons.v2","csui/controls/icon/icon.view","conws/widgets/header/impl/header.icon.model","conws/widgets/header/impl/editicon.view","i18n!conws/widgets/header/impl/nls/header.lang","hbs!conws/widgets/header/impl/icon"],function(e,t,i,o,n,s,l,a,r,c,d,u){return i.ItemView.extend({"className":"conws-workspace-icon-view","template":u,"triggers":{"change .conws-header-icon-file":"set:icon"},"blankImage":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQI12NgYAAAAAMAASDVlMcAAAAASUVORK5CYII=","defaultIconFileTypes":"image/gif, image/x-png, image/jpeg, image/pjpeg, image/png, image/svg+xml","defaultIconFileSize":1048576,"templateHelpers":function(){return{"canChange":this.model.hasAction("upload-icon")||this.model.hasAction("update-icon")||this.model.hasAction("delete-icon"),"iconData":this.getImageInfo().iconContent,"iconCustomized":"none"!==this.getImageInfo().iconLocation,"iconFileTypes":this.options.data.iconFileTypes,"chooseInpFileTitle":this.options.data.chooseInpFileTitle,"iconMsg":d.iconMessage,"type":this.options.type}},"constructor":function(t){this.options=t||{},t.data.iconFileTypes||(t.data.iconFileTypes=this.defaultIconFileTypes),t.data.iconFileSize||(t.data.iconFileSize=this.defaultIconFileSize),t.data.chooseInpFileTitle||(t.data.chooseInpFileTitle=d.chooseInpFileTitle),i.ItemView.prototype.constructor.apply(this,arguments),this.iconModel=new r({"id":this.model.get("id")},{"connector":this.model.connector,"icon":this.model.icon}),this.listenTo(this.model,"change:id",function(){this.iconModel.set({"id":this.model.get("id"),"icon":void 0})}),this.listenTo(this.iconModel,"icon:change",e.bind(function(){this.model.icon=this.iconModel.icon,this.render()},this))},"isTabable":function(){return 0===t(".cs-tabbed-perspective.cs-collapse").length},"onRender":function(){var t=this;this.$(".conws-header-edit").binf_popover({"container":".conws-header-wrapper","animation":!0,"html":!0,"content":e.bind(this.renderPopover,this)}),this.options.parentView.$el.on("mouseleave",function(){t.$(".conws-header-edit").binf_popover("hide")})},"renderPopover":function(){var t=this.getImageInfo(),i=this;return new c({"message":d.changeIconDialogMessage.replace("%1",o.getReadableFileSizeString(i.options.data.iconFileSize)),"resetButton":function(){return"node"===t.iconLocation&&i.model.hasAction("delete-icon")},"uploadButton":function(){return"type"!==t.iconLocation&&i.model.hasAction("upload-icon")||"node"!==t.iconLocation&&i.model.hasAction("update-icon")},"callback":e.bind(this.onClickPopover,this)}).render().el},"onSetIcon":function(e){var i=t(".conws-header-icon-file")[0].files;"node"===this.getImageInfo().iconLocation?this.iconModel.update(i).fail(function(e){var t=new o.RequestErrorMessage(e).message||d.changeIconDialogDefaultError;n.showError(t)}):this.iconModel.add(i).fail(function(e){var t=new o.RequestErrorMessage(e).message||d.changeIconDialogDefaultError;n.showError(t)})},"onClickPopover":function(e){t(".conws-header-edit").binf_popover("hide"),"reset"===e?this.iconModel.remove().fail(function(e){var t=new o.RequestErrorMessage(e).message||d.changeIconDialogDefaultError;n.showError(t)}):"upload"===e&&this.$(".conws-header-icon-file").trigger("click"),this.$el.find(".conws-header-edit").trigger("focus")},"getImageInfo":function(){var e=this.iconModel.icon;return e&&"none"!==e.location?{"iconContent":e.content,"iconLocation":e.location}:{"iconContent":this.blankImage,"iconLocation":"none"}}})}),csui.define("hbs!conws/widgets/header/impl/header",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){return"-childview"},"3":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'      <div class="conws-header-metadata-container">\r\n'+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"hasWorkspaceType"):t,{"name":"if","hash":{},"fn":e.program(4,n,0),"inverse":e.noop,"loc":{"start":{"line":16,"column":8},"end":{"line":20,"column":15}}}))?s:"")+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"hasDescription"):t,{"name":"if","hash":{},"fn":e.program(6,n,0),"inverse":e.noop,"loc":{"start":{"line":21,"column":8},"end":{"line":25,"column":15}}}))?s:"")+(null!=(s=l(i,"if").call(null!=t?t:e.nullContext||{},null!=t?l(t,"hasMetadataExtension"):t,{"name":"if","hash":{},"fn":e.program(9,n,0),"inverse":e.noop,"loc":{"start":{"line":26,"column":8},"end":{"line":28,"column":15}}}))?s:"")+"      </div>\r\n"},"4":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'          <div class="conws-header-type">\r\n            <p title="'+e.escapeExpression((s=null!=(s=l(i,"type")||(null!=t?l(t,"type"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"type","hash":{},"loc":{"start":{"line":18,"column":22},"end":{"line":18,"column":30}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"type")||(null!=t?l(t,"type"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"type","hash":{},"loc":{"start":{"line":18,"column":32},"end":{"line":18,"column":40}}}):s))+"</p>\r\n          </div>\r\n"},"6":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return null!=(s=l(i,"unless").call(null!=t?t:e.nullContext||{},null!=t?l(t,"isDescriptionEmpty"):t,{"name":"unless","hash":{},"fn":e.program(7,n,0),"inverse":e.noop,"loc":{"start":{"line":22,"column":10},"end":{"line":24,"column":21}}}))?s:""},"7":function(e,t,i,o,n){return'            <div class="conws-header-desc"></div>\r\n'},"9":function(e,t,i,o,n){return'          <div class="conws-header-metadata-extension"></div>\r\n'},"11":function(e,t,i,o,n){return'    <div class="conws-header-childView-container">\r\n      <div id="conws-header-childview"></div>\r\n    </div>\r\n'},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="conws-header-wrapper">\r\n  <div class="conws-header-metadata'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"hasChildView"):t,{"name":"if","hash":{},"fn":e.program(1,n,0),"inverse":e.noop,"loc":{"start":{"line":2,"column":35},"end":{"line":2,"column":72
}}}))?s:"")+'">\r\n    <div class="conws-header-image"></div>\r\n    <div class="conws-header-title-section">\r\n      <div class="conws-header-title">\r\n        <h1 title="'+e.escapeExpression((l=null!=(l=a(i,"title")||(null!=t?a(t,"title"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":6,"column":19},"end":{"line":6,"column":28}}}):l))+'">'+e.escapeExpression((l=null!=(l=a(i,"title")||(null!=t?a(t,"title"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":6,"column":30},"end":{"line":6,"column":39}}}):l))+'</h1>\r\n\r\n        <div class="conws-header-child-displayUrl"></div>\r\n      </div>\r\n\r\n       <div class="conws-header-toolbar"></div>\r\n      \r\n    </div>\r\n'+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"hasMetadata"):t,{"name":"if","hash":{},"fn":e.program(3,n,0),"inverse":e.noop,"loc":{"start":{"line":14,"column":4},"end":{"line":30,"column":11}}}))?s:"")+"  </div>\r\n\r\n"+(null!=(s=a(i,"if").call(null!=t?t:e.nullContext||{},null!=t?a(t,"hasChildView"):t,{"name":"if","hash":{},"fn":e.program(11,n,0),"inverse":e.noop,"loc":{"start":{"line":33,"column":2},"end":{"line":37,"column":9}}}))?s:"")+"</div>\r\n"}});return i.registerPartial("conws_widgets_header_impl_header",o),o}),csui.define("hbs!conws/widgets/header/impl/error.template",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="conws-header-error content-tile">\r\n  <div class="conws-header-error-icon-div">\r\n    <div class="conws-header-error-icon-parent">\r\n      <div class="conws-header-error-icon notification_error"></div>\r\n    </div>\r\n  </div>\r\n  <div class="conws-header-message">'+e.escapeExpression((s=null!=(s=l(i,"errorMessage")||(null!=t?l(t,"errorMessage"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"errorMessage","hash":{},"loc":{"start":{"line":7,"column":36},"end":{"line":7,"column":52}}}):s))+"</div>\r\n</div>"}});return i.registerPartial("conws_widgets_header_impl_error.template",o),o}),csui.define("css!conws/widgets/header/impl/header",[],function(){}),csui.define("conws/widgets/header/header.view",["module","require","csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/base","csui/utils/log","csui/utils/url","csui/utils/nodesprites","csui/dialogs/modal.alert/modal.alert","csui/controls/progressblocker/blocker","csui/utils/high.contrast/detector!","csui/utils/node.links/node.links","hbs!conws/widgets/header/impl/navitem","esoc/widgets/activityfeedwidget/activityfeedfactory","esoc/widgets/activityfeedwidget/activityfeedcontent","csui-ext!conws/utils/commands/navigate/workspace","conws/utils/navigate/navigate.util","conws/utils/commands/back.to.previous.location","conws/models/workspacecontext/workspacecontext.factory","conws/widgets/header/impl/editicon.view","conws/widgets/header/impl/header.model.factory","conws/widgets/header/impl/header.icon.model","conws/widgets/header/impl/headertoolbaritems","conws/widgets/header/impl/headertoolbaritems.masks","conws/models/favorite.model","conws/controls/description/description.view","conws/widgets/header/impl/headertoolbar.view","conws/widgets/header/impl/icon.view","csui/controls/icon/icon.view","i18n!conws/widgets/header/impl/nls/header.lang","csui/utils/contexts/factories/node","hbs!conws/widgets/header/impl/header","hbs!conws/widgets/header/impl/error.template","css!conws/widgets/header/impl/header"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h,g,f,w,v,b,y,k,x,C,_,T,S,R,V,M,I,P,E,N,D){"use strict";function A(){this.backToPrevious.done=!0,W.execute({"context":this.options.context,"data":{"index":this.backToPrevious.index}})}function O(){return"Landing"!==this.backToPrevious.router&&this.backToPrevious.index>=0}var F,B={"activityfeedwidget":"esoc/widgets/activityfeedwidget"},L=e.config(),j=new a(e.id);F=2!==p;var W=new b,$=s.ItemView.extend({"template":h,"className":"conws-header-navitem","constructor":function(){s.ItemView.prototype.constructor.apply(this,arguments)},"onRender":function(){var e=this.$(".conws-header-navicon"),t=new I({"iconName":"conws_action_backv2","states":"true","size":"normal","theme":F?"dark":""});t.render(),t.$el.addClass(e[0].className),e.replaceWith(t.el)}}),q=s.CollectionView.extend({"className":"conws-header-navbar","childView":$,"events":{"click .conws-header-navlink":"clickLink"},"clickLink":function(e){this.trigger("click:link",e)},"constructor":function(){s.CollectionView.prototype.constructor.apply(this,arguments)}}),H=["hideToolbar","hideToolbarExtension","hideActivityFeed","hideDescription","hideWorkspaceType","hasMetadataExtension","toolbarBlacklist","extensionToolbarBlacklist","enableCollapse"];return s.LayoutView.extend({"className":"conws-header","template":N,"templateHelpers":function(){return{"title":this.resolveProperty("title"),"type":this.resolveProperty("type"),"description":this.resolveProperty("description"),"hasChildView":this.hasChildView(),"hasDescription":!this.options.hideDescription,"isDescriptionEmpty":this.hasEmptyDescription(),"hasWorkspaceType":!this.options.hideWorkspaceType,"hasMetadataExtension":this.options.hasMetadataExtension,"hasMetadata":!this.options.hideDescription||!this.options.hideWorkspaceType||this.options.hasMetadataExtension}},"regions":{"childViewRegion":"#conws-header-childview","toolBarRegion":".conws-header-toolbar","descriptionRegion":".conws-header-desc","iconViewRegion":".conws-header-image"},"events":{"keydown":"onKeyDown"},"onClickLink":function(e){e.preventDefault(),e.stopPropagation(),A.call(this)},"isTabable":function(){return 0===o(".cs-tabbed-perspective.cs-collapse").length},"currentlyFocusedElement":function(){return this.$el.find(".conws-header-edit")},"onKeyDown":function(e){13!==e.keyCode&&32!==e.keyCode||(o(e.target).hasClass("conws-header-edit")?(e.preventDefault(),e.stopPropagation(),0===o(".cs-collapse").length&&o(e.target).binf_popover("show")):o(e.target).hasClass("conws-header-navlink")&&(e.preventDefault(),e.stopPropagation(),A.call(this)))},"constructor":function(e){if(e||(e={}),!e.context)throw new Error("Context is missing in the constructor options");if(e.hideToolbar=e.hideToolbar?!!e.hideToolbar:!!L.hideToolbar,e.hideToolbarExtension=e.hideToolbarExtension?!!e.hideToolbarExtension:!!L.hideToolbarExtension,e.hideActivityFeed=e.hideActivityFeed?!!e.hideActivityFeed:!!L.hideActivityFeed,e.hideDescription=e.hideDescription?!!e.hideDescription:!!L.hideDescription,e.hideWorkspaceType=e.hideWorkspaceType?!!e.hideWorkspaceType:!!L.hideWorkspaceType,e.hasMetadataExtension=e.hasMetadataExtension?!!e.hasMetadataExtension:!!L.hasMetadataExtension,e.toolbarBlacklist=e.toolbarBlacklist?e.toolbarBlacklist:L.toolbarBlacklist,e.extensionToolbarBlacklist=e.extensionToolbarBlacklist?e.extensionToolbarBlacklist:L.extensionToolbarBlacklist,e.expandDescription=!0,e.enableCollapse=void 0===e.enableCollapse?!!L.enableCollapse:!!e.enableCollapse,w)for(var t=0;t<w.length;t++){var n=w[t];if(n.checkHeaderViewOptions){var l=n.checkHeaderViewOptions({"context":e.context},i.pick(e,H));if(l){i.extend(e,i.pick(l,H));break}}}if(e.workspaceContext||(e.workspaceContext=e.context.getObject(y),e.workspaceContext.setWorkspaceSpecific(x),e.workspaceContext.setWorkspaceSpecific(g)),e.model=e.workspaceContext.getModel(x),e.data.widget&&e.data.widget.type&&"activityfeed"===e.data.widget.type&&(e.data.widget.type=B.activityfeedwidget,e.data.widget.options||(e.data.widget.options={})),(Array.isArray(e.toolbarBlacklist)&&e.toolbarBlacklist.length>0||Array.isArray(e.delayedToolbarBlacklist)&&e.delayedToolbarBlacklist.length>0)&&(e.headerToolbarItemsMask=new T({"rightToolbar":{"blacklist":e.toolbarBlacklist},"delayedActionsToolbar":{"blacklist":e.delayedToolbarBlacklist}})),(Array.isArray(e.extensionToolbarBlacklist)&&e.extensionToolbarBlacklist.length>0||Array.isArray(e.extensionToolbarDelayedActionsBlacklist)&&e.extensionToolbarDelayedActionsBlacklist.length>0)&&(e.headerExtensionToolbarItemsMask=new T({"rightToolbar":{"blacklist":e.extensionToolbarBlacklist},"delayedActionsToolbar":{"blacklist":e.extensionToolbarDelayedActionsBlacklist}})),e.workspaceNode=e.workspaceContext.getModel(E),s.LayoutView.prototype.constructor.call(this,e),o(window).on("resize",i.bind(this.onWindowResize,this)),this.model.fetched=!1,this.listenTo(this.model,"change",i.bind(function(){this.model.fetched=!0,this.render()},this)),this.listenTo(this.model,"error",this.handleError),this.hasChildView()){this.options.data.widget.type===B.activityfeedwidget&&(this._makeActivityWidget(),this.listenTo(this.model.node,"change:id",this._makeActivityWidget))}this.options.workspaceNode.nonPromotedActionCommands=this.getDelayedHeaderViewActions(),this.options.hideToolbarExtension||(this.tabBarRightExtensionView=V,this.tabBarRightExtensionViewOptions={"context":this.options.context,"node":this.options.workspaceNode,"toolbarItems":this.options.headerExtensionToolbaritems||_,"container":this.options.workspaceNode,"originatingView":this,"toolbarItemsMasks":this.options.headerExtensionToolbarItemsMask,"useIconsForDarkBackground":F,"customClass":"conws-header-toolbar-extension conws-header-toolbar"},this.disableExtensionOnOtherTabs=!0),this.listenTo(this,"dom:refresh",this.onDomRefresh),this.listenTo(this,"active:tab",function(){this.triggerMethod("adjust:toolbar"),this.renderWorkspaceIcon(),this.isTabable()?this.currentlyFocusedElement().attr("tabindex","0"):this.currentlyFocusedElement().attr("tabindex","-1")}),this.listenTo(this,"render",this.postCallbackFunction);var a=this.options.context.viewStateModel;this.listenTo(a,"navigate",function(){this.backToPrevious&&this.backToPrevious.done&&this.renderNavigationBar(!0)}),this.listenTo(this.options.context,"change:perspective",function(){this.backToPrevious&&this.backToPrevious.done&&this.backToPrevious&&delete this.backToPrevious.done}),e.blockingParentView?u.delegate(this,e.blockingParentView):u.imbue(this)},"postCallbackFunction":function(){this.headerToolbarView=new V({"context":this.options.context,"node":this.options.workspaceNode,"toolbarItems":this.options.headertoolbaritems?this.options.headertoolbaritems:_,"toolbarItemsMasks":this.options.headerToolbarItemsMask,"container":this.options.workspaceNode,"originatingView":this,"hideToolbar":this.options.hideToolbar,"useIconsForDarkBackground":F,"statusIndicatorsView":this.options.statusIndicatorsView,"statusIndicatorsViewOptions":this.options.statusIndicatorsViewOptions,"enableCollapse":this.options.enableCollapse}),this.toolBarRegion.show(this.headerToolbarView)},"renderWorkspaceIcon":function(){this.iconView=new M(i.defaults(this.options,{"type":this.resolveProperty("type"),"parentView":this})),this.iconViewRegion.show(this.iconView)},"addActivityFeedClass":function(){this.$el.find("#conws-header-childview").find(".esoc-activityfeed-contentwidget").has(".esoc-activityfeed-list-item").length?this.$el.parent().addClass("conws-activityfeed-configured").removeClass("conws-activityfeed-configured-nodata"):this.$el.find("#conws-header-childview").has(".esoc-activityfeed-contentwidget .esoc-empty-activityfeed-message").length?this.$el.parent().addClass("conws-activityfeed-configured-nodata").removeClass("conws-activityfeed-configured"):this.$el.parent().removeClass("conws-activityfeed-configured-nodata").removeClass("conws-activityfeed-configured")},"onDomRefresh":function(){this.addActivityFeedClass(),this._clampTexts(),this.hasChildView()&&this.childViewRegion.currentView&&this.childViewRegion.currentView.triggerMethod("dom:refresh"),this.headerToolbarView.triggerMethod("dom:refresh"),this.descriptionView&&this.descriptionView.ui.readMore.is&&this.descriptionView.ui.showLess.is&&this.descriptionView.ui.readMore.is(":hidden")&&this.descriptionView.ui.showLess.is(":visible")&&(this.descriptionView.ui.showLess.trigger("click"),this.currentlyFocusedElement().trigger("focus")),this.isTabable()?this.currentlyFocusedElement().attr("tabindex","0"):this.currentlyFocusedElement().attr("tabindex","-1")},"onWindowResize":function(){this._clampTexts()},"onDestroy":function(){o(window).off("resize",this.onWindowResize),this._observer&&this._observer.disconnect(),this.iconView&&this.iconView.destroy(),this.headerToolbarView&&this.headerToolbarView.destroy(),this.navigationBar&&this.navigationBar.destroy()},"onShow":function(){var e=this,t=o(".cs-perspective-panel");1===t.length&&(this._observer=new MutationObserver(function(t){t.forEach(function(t){var i=o(t.target);i.hasClass("cs-tabbed-perspective")&&(e.titleClampLines=i.hasClass("cs-collapse")?1:2,e._clampTexts())})}),this._observer.observe(t[0],{"attributes":!0,"attributeFilter":["class"],"subtree":!0}))},"onRender":function(){if(this._parent&&this._parent.$el&&this._parent.$el.parents(".cs-tabbed-perspective").addClass("conws-header-active"),this.renderNavigationBar(),this.model.fetched){this.$el.parent().addClass("conws-header-widget");var e=this;if(this.renderWorkspaceIcon(),this.hasChildView()&&(e.activityFeedContent||this._makeActivityWidget(),e.activityFeedContent)){var t=e.activityFeedContent.contentView.unblockActions();e.childViewRegion.show(t),e.activityFeedContent=void 0}if(!this.options.hideDescription&&!this.hasEmptyDescription()){var i={"view":this,"complete_desc":this.resolveProperty("description"),"expandDescription":this.options.expandDescription};this.descriptionView=new R(i),this.descriptionRegion.show(this.descriptionView),this.$el.parent().addClass("conws-description-available")}}},"renderNavigationBar":function(e){var t,i="#";this.backToPrevious=W.getLinkInfo(this.options.context);var s=O.call(this);if(j.debug("HeaderView backToPrevious: {0} {1}",s,this.backToPrevious.index)&&console.log(j.last),this._parent&&this._parent.$el&&(s?(this._parent.$el.parents(".cs-tabbed-perspective").addClass("conws-backlink-visible"),this._parent.$el.addClass("conws-header-with-link")):(this._parent.$el.parents(".cs-tabbed-perspective").removeClass("conws-backlink-visible"),this._parent.$el.removeClass("conws-header-with-link"))),!this.navigationBar||s&&e||(this.$(".conws-header-navwrap").remove(),this.navigationBar.destroy(),delete this.navigationBar),s){if(t=this.backToPrevious.title,this.backToPrevious.id){var l=new n.Model({"id":this.backToPrevious.id});i=m.getUrl(l,{"connector":this.model.connector})||"#"}if(this.navigationBar)this.navigationBar.$(".conws-header-navlink").attr({"href":i,"title":t}),this.navigationBar.$(".conws-header-navtext").text(t);else{var a=new q({"collection":new n.Collection([{"backToPreviousLink":i,"backToPreviousTitle":t}])});a.render(),this.listenTo(a,"click:link",this.onClickLink),o('<div class="conws-header-navwrap"></div>').append(a.el).insertBefore(this.$(".conws-header-wrapper")),this.navigationBar=a}}},"hasEmptyDescription":function(){return""===this.resolveProperty("description")},"_clampTexts":function(){this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(i.bind(function(){var e=o(".conws-header-title > p");0!==e.length&&(e.text(e.attr("title")),this.clamp(e[0],e.parent().outerHeight()))},this),200)},"_makeActivityWidget":function(){if(this.activityFeedContent=void 0,this.model.node.get("id")){var e=this.options.data&&this.options.data.widget;if(e&&e.type===B.activityfeedwidget){var t=o.extend({},e.options,{"feedsize":10,"feedtype":"all","feedSettings":{"enableComments":!0,"enableFilters":!1},"feedsource":{"source":"pulsefrom","id":this.model.node.get("id")},"hideExpandIcon":!0,"context":this.options.workspaceContext,"headerView":!0});this.activityFeedContent=new f(t),this.listenTo(this.activityFeedContent.contentView.collection,"sync",this.addActivityFeedClass)}}},"configProperty":function(e){return(this.options.data&&this.options.data.workspace&&this.options.data.workspace.properties||{})[e]},"resolveProperty":function(e){var t="";if(this.model.isWorkspaceType()){var o=this.configProperty(e);if("{business_properties.description}"===o&&(o="{description}"),o&&o.length>0){var n=o.match(/{(.*?)}/g);if(n){var s=this;i.each(n,function(e){o=o.replace(e,s.format(s.resolveModelValue(e)).formatted||"")})}t=o}}return t},"resolveModelValue":function(e){var t={"name":e,"value":e,"metadata":void 0};if(0===e.indexOf("{")){var o=this.model.attributes||{},n=this.model.metadata&&this.model.metadata.properties||{},s=e.substring(1,e.length-1).split("."),l=s,a=s.length>1?s[0]:void 0;if("categories"===a){o=this.model.categories||{},n=this.model.metadata&&this.model.metadata.categories||{};var r=s[1].split("_");s=[r[0],s[1]],r.length>2&&(r[2]="x"),l=[r[0],r.join("_")]}else"business_properties"===a&&(o=this.model.business_properties||{},n={},s.splice(0,1));i.find(s,function(e){if(void 0===(o=o[e]))return!0}),i.find(l,function(e){if(void 0===(n=n[e]))return!0}),"categories"===a&&n&&2===n.type&&("user"!==n.persona&&"group"!==n.persona&&"member"!==n.persona||this.model.expandMemberValue({"name":s[1],"value":o,"metadata":n})),t.name=e,t.value=o,t.metadata=n}return t},"format":function(e){switch(e.metadata&&e.metadata.type){case-7:e.formatted=this.formatDate(e.value);break;case 2:switch(e.metadata.persona){case"user":case"group":case"member":var t="{"+e.name.substring(1,e.name.length-1)+"_expand}",i=this.resolveModelValue(t);e.formatted=this.formatMember(i.value);break;default:e.formatted=this.formatValue(e.value)}break;default:e.formatted=this.formatValue(e.value)}return e},"formatDate":function(e){return e=i.isArray(e)?e:[e],i.map(e,function(e){return l.formatDate(e)}).join("; ")},"formatMember":function(e){return e=i.isArray(e)?e:[e],i.map(e,function(e){return e?void 0!==e.display_name?e.display_name:void 0!==e.name_formatted?e.name_formatted:l.formatMemberName(e):""}).join("; ")},"formatValue":function(e){return e=i.isArray(e)?e:[e],e.join("; ")},"hasChildView":function(){return!this.options.hideActivityFeed&&this.options.data&&this.options.data.widget&&this.options.data.widget.type&&"none"!==this.options.data.widget.type},"clamp":function(e,t){function i(r){var c=r.nodeValue.replace(o,"");if(a||(s=n.length?n.shift():"",a=c.split(s)),a.length>1?(l=a.pop(),r.nodeValue=a.join(s)+o):a=null,a){if(e.clientHeight<=t){if(!n.length)return;r.nodeValue=a.join(s)+s+l,a=null}}else if(!o.length)return void(r.nodeValue=o);i(r)}var o="...",n=[".",","," "],s=null,l=null,a=null;e.clientHeight<=t||i(e.lastChild)},"adjustToolbar":function(){this.options.hideToolbar||this.headerToolbarView.triggerMethod("dom:refresh")},"getDelayedHeaderViewActions":function(){var e=this.options.headertoolbaritems&&this.options.headertoolbaritems.delayedActionsToolbar?this.options.headertoolbaritems.delayedActionsToolbar.collection:_.delayedActionsToolbar.collection;return i.chain(e.pluck("signature")).unique().value()},"handleError":function(e,t,i){if(t&&t.responseJSON.error){var o=D.call(this,{"errorMessage":t.responseJSON.error});this.$el.find(".conws-header-error").length>0&&this.$el.find("div").remove(".conws-header-error"),this.$el.append(o),this.$el.find(".conws-header-wrapper").hide()}}})}),csui.define("conws/utils/behaviors/expanding.behavior",["require","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette"],function(e,t,i,o){function n(e,i,o){if(null!=e){var n=e[i];return t.isFunction(n)?e[i].call(o):n}}return o.Behavior.extend({"constructor":function(e,i){o.Behavior.prototype.constructor.apply(this,arguments);var n=t.bind(this._destroyExpandedView,this,!1),s=(t.bind(this._destroyExpandedView,this,!0),i.options&&i.options.context);this.listenTo(this,"before:destroy",n),s&&this.listenTo(s,"request",n).listenTo(s,"request:perspective",n)},"onExpand":function(){if(!this.expanded){this.expanded=!0;var o,s=this,l=this.view.completeCollection?this.view.completeCollection.clone():this.view.collection.clone(),a=this.view.completeCollection&&this.view.options&&this.view.options.filterValue&&this.view.options.filterValue.toLowerCase();this.view.completeCollection&&a&&a.length>0&&(o={"name":a},l.setFilter(o,{"fetch":!1}),this.view.searchClicked());var r=s.getOption("expandedView"),c=r;!0!==t.isString(r)&&(c=r.prototype instanceof i.View?r:r.call(s.view));var d=["csui/controls/dialog/dialog.view"];t.isString(c)&&d.push(c),e(d,function(e){t.isString(c)&&(c=arguments[1]);var i=n(s.options,"expandedViewOptions",s.view);s.expandedView=new c(t.extend({"context":s.view.options.context,"collection":l,"orderBy":n(s.options,"orderBy",s.view),"filterBy":o,"limited":!1},i)),s.dialog=new e({"iconLeft":n(s.options,"titleBarIcon",s.view)||n(s.view.options,"titleBarIcon",s.view),"imageLeftUrl":n(s.options,"titleBarImageUrl",s.view),"imageLeftClass":n(s.options,"titleBarImageClass",s.view),"title":n(s.options,"dialogTitle",s.view),"iconRight":n(s.options,"dialogTitleIconRight",s.view),"className":n(s.options,"dialogClassName",s.view),"headerControl":n(s.options,"headerControl",s.view),"largeSize":!0,"view":s.expandedView}),s.listenTo(s.dialog,"before:hide",s._expandOtherView).listenTo(s.dialog,"destroy",s._enableExpandingAgain),s._expandOtherView(!1),s.dialog.show()},function(e){s.expanded=!1})}},"_destroyExpandedView":function(e){if(this.dialog){var t=e?"kill":"destroy";this.dialog[t](),this.dialog=void 0}},"_expandOtherView":function(e){this.options.collapsedView&&this.options.collapsedView.triggerMethod(!1===e?"go:away":"go:back")},"_enableExpandingAgain":function(){if(this.expanded=!1,this.view.tabableRegionBehavior){var e=this.view.tabableRegionBehavior,t=this.view.ui.tileExpand;e.currentlyFocusedElement&&e.currentlyFocusedElement.prop("tabindex",-1),t&&t.prop("tabindex",0),t.trigger("focus"),e.setInitialTabIndex(),this.view.currentTabPosition=2}}})}),csui.define("hbs!conws/widgets/team/impl/controls/teamheader/impl/teamheader",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="conws-teamheader-content">\r\n  <div class="title primary-title" title="'+e.escapeExpression((s=null!=(s=l(i,"primaryTitle")||(null!=t?l(t,"primaryTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"primaryTitle","hash":{},"loc":{"start":{"line":2,"column":42},"end":{"line":2,"column":58}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"primaryTitle")||(null!=t?l(t,"primaryTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"primaryTitle","hash":{},"loc":{"start":{"line":2,"column":60},"end":{"line":2,"column":76}}}):s))+'</div>\r\n  <div class="title secondary-title" title="'+e.escapeExpression((s=null!=(s=l(i,"secondaryTitle")||(null!=t?l(t,"secondaryTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"secondaryTitle","hash":{},"loc":{"start":{"line":3,"column":44},"end":{"line":3,"column":62}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"secondaryTitle")||(null!=t?l(t,"secondaryTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"secondaryTitle","hash":{},"loc":{"start":{"line":3,"column":64},"end":{"line":3,"column":82}}}):s))+"</div>\r\n</div>"}});return i.registerPartial("conws_widgets_team_impl_controls_teamheader_impl_teamheader",o),o}),csui.define("css!conws/widgets/team/impl/controls/teamheader/impl/teamheader",[],function(){}),csui.define("conws/widgets/team/impl/controls/teamheader/teamheader.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","i18n!conws/widgets/team/impl/nls/team.lang","hbs!conws/widgets/team/impl/controls/teamheader/impl/teamheader","css!conws/widgets/team/impl/controls/teamheader/impl/teamheader"],function(e,t,i,o,n){return i.LayoutView.extend({"className":"conws-teamheader","template":n,"constructor":function(e){i.LayoutView.prototype.constructor.apply(this,arguments),e||(e={})},"templateHelpers":function(){return{"primaryTitle":this.options.primaryTitle,"secondaryTitle":this.options.secondaryTitle}}})}),csui.define("conws/widgets/team/team.view",["csui/lib/underscore","csui/lib/marionette","csui/controls/list/list.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/limiting/limiting.behavior","conws/utils/behaviors/expanding.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/controls/list/behaviors/list.view.keyboard.behavior","csui/behaviors/collection.state/collection.state.behavior","csui/controls/list/list.state.view","conws/models/workspacecontext/workspacecontext.factory","conws/widgets/header/impl/header.model.factory","conws/widgets/team/impl/team.model.factory","conws/widgets/team/impl/teamtables.view","conws/widgets/team/impl/controls/teamheader/teamheader.view","csui/utils/base","csui/utils/nodesprites","csui/utils/contexts/factories/node","csui/controls/progressblocker/blocker","conws/widgets/team/impl/controls/listitem/listitemteammember.view","i18n!conws/widgets/team/impl/nls/team.lang","css!conws/widgets/team/impl/team"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h,g,f,w,v,b,y){return i.extend({"className":"conws-team "+i.prototype.className,"constructor":function(e){e||(e={}),e.data||(e.data={}),void 0===e.data.showTitleIcon&&(e.data.showTitleIcon=!0),void 0===e.data.showWorkspaceIcon&&(e.data.showWorkspaceIcon=!1),e.data.title||(e.data.title=y.dialogTitle),e.workspaceContext||(e.workspaceContext=e.context.getObject(d),e.workspaceContext.setWorkspaceSpecific(u),e.workspaceContext.setWorkspaceSpecific(p)),i.prototype.constructor.apply(this,arguments),this.loadingText=y.loadingListText,v.imbue(this),this.headerModel=e.workspaceContext.getObject(u)},"templateHelpers":function(){return{"searchAria":y.searchAria,"expandAria":y.expandAria,"title":g.getClosestLocalizedString(this.options.data.title,y.dialogTitle),"icon":this.options.data.titleBarIcon||"title-icon title-team","searchPlaceholder":e.str.sformat(y.searchIconTooltip,y.rolesParticipantsColTooltip)}},"childView":b,"childViewOptions":{"templateHelpers":function(){return{"name":this.model.get("display_name"),"email":this.model.get("business_email"),"isUser":0===this.model.get("type"),"stage":{"value":this.model.getLeadingRole(),"label":this.model.getRolesIndicator()}}}},"childEvents":{"click:item":"onClickItem"},"onClickItem":function(e){},"behaviors":{"PerfectScrolling":{"behaviorClass":o,"contentParent":".tile-content","suppressScrollX":!0,"scrollYMarginOffset":15},"LimitedList":{"behaviorClass":n,"completeCollection":function(){return this.options.workspaceContext.getCollection(p)},"filterByProperty":"display_name","limit":0},"ExpandableList":{"behaviorClass":s,"expandedView":m,"expandedViewOptions":function(){return{"collapsedView":this}},"dialogTitle":function(){return this.headerModel.get("name")},"headerControl":function(){return new h({"primaryTitle":this.headerModel.get("name"),"secondaryTitle":this.headerModel.get("workspace_type_name")})},"titleBarIcon":function(){return this.getIconData().titleBarIcon},"titleBarImageUrl":function(){return this.getIconData().titleBarImageUrl},"titleBarImageClass":function(){return this.getIconData().titleBarImageClass},"dialogTitleIconRight":"icon-tileCollapse","dialogClassName":"conws-team"},"TabableRegion":{"behaviorClass":l},"ListViewKeyboardBehavior":{"behaviorClass":a},"CollectionState":{"behaviorClass":r,"collection":function(){return this.completeCollection},"stateView":c,"stateMessages":{"empty":y.noResultsPlaceholder,"loading":y.loadingListText,"failed":y.failedListText}}},"onClickHeader":function(e){this.triggerMethod("expand")},"getIconData":function(){var e={};return this.options.data.showTitleIcon&&(e.titleBarIcon=this.options.data.titleBarIcon||"title-icon mime-team",this.options.data.showWorkspaceIcon&&(this.headerModel.icon&&"none"!==this.headerModel.icon.location?(e.titleBarIcon=void 0,e.titleBarImageUrl=this.headerModel.icon.content):e.titleBarIcon=f.findByNode(this.headerModel).get("className"))),e},"onRefreshList":function(){e.isUndefined(this.completeCollection)||this.completeCollection.fetch()},"getElementByIndex":function(t){if(isNaN(t)||t<0)return null;var i=this.$(e.str.sformat(".conws-item-member:nth-child({0})",t+1));return this.$(i[0])}})}),csui.define("conws/widgets/myworkspaces/impl/myworkspaceslistitem.view",["csui/lib/underscore","csui/lib/jquery","csui/controls/listitem/listitemstandard.view","conws/utils/previewpane/previewpane.view","csui/behaviors/default.action/default.action.behavior"],function(e,t,i,o,n){return i.extend({"constructor":function(e){i.apply(this,arguments),this.options&&this.options.preview&&(this.previewPane=new o({"parent":this,"context":this.options.context,"config":this.options.preview,"node":this.model}))},"behaviors":{"DefaultAction":{"behaviorClass":n}},"onBeforeDestroy":function(e){this.previewPane&&(this.previewPane.destroy(),delete this.previewPane)},"onClickItem":function(){this.triggerMethod("execute:DefaultAction",this.model)}})}),csui.define("conws/widgets/myworkspaces/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/myworkspaces/impl/nls/root/lang",{"dialogTitle":"My workspaces","searchPlaceholder":"%1","noResultsPlaceholder":"No recently accessed workspaces to display.","searchAria":"Search for workspaces","expandAria":"Expand the my workspaces widget","expandTableAria":"Content of {0}"}),csui.define("conws/widgets/myworkspaces/impl/myworkspacestable.view",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/lib/marionette","csui/utils/log","conws/utils/workspaces/impl/workspaceutil","conws/utils/workspaces/workspacestable.view","i18n!conws/widgets/myworkspaces/impl/nls/lang"],function(e,t,i,o,n,s,l,a,r){return a.extend({"constructor":function(e){a.prototype.constructor.apply(this,arguments)},"onRender":function(){var e=this.collection;i.isUndefined(this.collection.options.myworkspaces.attributes.sortExpanded)?e.orderBy=l.orderByAsString(this.options.data.orderBy):e.orderBy=this.collection.options.myworkspaces.attributes.sortExpanded,this.options.tableAria="",i.isUndefined(e.options.attributes.title)||(this.options.tableAria=i.str.sformat(r.expandTableAria,e.options.attributes.title)),this.doRender(e)},"_getCollectionUrlQuery":function(){var e={};return e.fields=encodeURIComponent("properties{"+this.getColumnsToFetch()+"}"),e.action="properties-properties",e.expanded_view="true",e.expand_users="true",e}})}),csui.define("conws/widgets/myworkspaces/myworkspaces.view",["csui/lib/marionette","module","csui/lib/underscore","csui/lib/backbone","csui/lib/jquery","conws/widgets/myworkspaces/impl/myworkspaceslistitem.view","conws/widgets/myworkspaces/impl/myworkspaces.model.factory","conws/widgets/myworkspaces/impl/myworkspacestable.view","i18n!conws/widgets/myworkspaces/impl/nls/lang","csui/utils/base","conws/utils/workspaces/impl/workspaceutil","conws/utils/workspaces/workspaces.view"],function(e,t,i,o,n,s,l,a,r,c,d,u){return u.extend({"constructor":function(e){this.viewClassName="conws-myworkspaces",u.prototype.constructor.apply(this,arguments),this.limit=-1},"childView":s,"childViewOptions":function(){return{"context":this.options.context,"checkDefaultAction":!0,"preview":this.options.data&&this.options.data.collapsedView&&this.options.data.collapsedView.preview,"templateHelpers":function(){return{"name":this.model.get("name"),"enableIcon":!0}}}},"emptyViewOptions":{"templateHelpers":function(){return{"text":this._parent._getNoResultsPlaceholder()}}},"workspacesCollectionFactory":l,"workspacesTableView":a,"dialogClassName":"myworkspaces","lang":r,"_getCollectionAttributes":function(){return{"workspaceTypeId":this.options.data.workspaceTypeId,
"sortExpanded":this.options.data.expandedView&&d.orderByAsString(this.options.data.expandedView.orderBy),"title":c.getClosestLocalizedString(this.options.data.title,r.dialogTitle)}},"_getCollectionUrlQuery":function(){var e=this.options.data,t={};return i.isUndefined(e.workspaceTypeId)||(t.where_workspace_type_id=e.workspaceTypeId),t.fields=encodeURIComponent("properties{id,container,name,type,type_name}"),t.action="properties-properties",t.expanded_view="false",i.isEmpty(t)?void 0:t},"templateHelpers":function(){return i.extend(u.prototype.templateHelpers.apply(this,arguments),{"searchAria":r.searchAria,"expandAria":r.expandAria})}})}),csui.define("conws/widgets/metadata/impl/forms.metadata.update.factory",["csui/utils/contexts/factories/factory","csui/utils/contexts/factories/node","conws/models/categoryforms/categoryforms.model","conws/widgets/metadata/impl/forms.metadata.update.model"],function(e,t,i,o){return e.extend({"propertyPrefix":"forms.metadata.update","constructor":function(i,n){e.prototype.constructor.apply(this,arguments);var s=i.getModel(t);this.property=new o(void 0,{"node":s,"metadataConfig":n[this.propertyPrefix].metadataConfig,"autofetch":!0,"autoreset":!0})},"fetch":function(e){return this.property.fetch(e)}})}),csui.define("hbs!conws/widgets/metadata/impl/metadata",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"1":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'        <div class="tile-header">\r\n\r\n            <div class="tile-type-icon">\r\n                <div class="title-icon '+e.escapeExpression((s=null!=(s=l(i,"icon")||(null!=t?l(t,"icon"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"icon","hash":{},"loc":{"start":{"line":7,"column":39},"end":{"line":7,"column":47}}}):s))+'"></div>\r\n            </div>\r\n\r\n            <div class="tile-title" title="'+e.escapeExpression((s=null!=(s=l(i,"title")||(null!=t?l(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":10,"column":43},"end":{"line":10,"column":52}}}):s))+'">\r\n                <h2 class="csui-heading">'+e.escapeExpression((s=null!=(s=l(i,"title")||(null!=t?l(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":11,"column":41},"end":{"line":11,"column":50}}}):s))+"</h2>\r\n            </div>\r\n\r\n        </div>\r\n"},"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l,a=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="conws-metadata tile content-tile">\r\n\r\n'+(null!=(s=a(i,"unless").call(null!=t?t:e.nullContext||{},null!=t?a(t,"hideHeader"):t,{"name":"unless","hash":{},"fn":e.program(1,n,0),"inverse":e.noop,"loc":{"start":{"line":3,"column":4},"end":{"line":15,"column":15}}}))?s:"")+'\r\n    <div class="tile-content metadata-tile-content csui-normal-scrolling  csui-no-scroll-x">\r\n        <div class="load-container">\r\n            <div class="csui-common-loading-parent-wrapper">\r\n                <div class="csui-loading-3dots">\r\n                    <div class="csui-loading-dots-wrapper">\r\n                        <span class="csui-loading-dot"></span>\r\n                        <span class="csui-loading-dot"></span>\r\n                        <span class="csui-loading-dot"></span>\r\n                    </div>\r\n                    <div class="placeholder" role="alert" aria-live="polite">\r\n                        '+e.escapeExpression((l=null!=(l=a(i,"loadingMetadata")||(null!=t?a(t,"loadingMetadata"):t))?l:e.hooks.helperMissing,"function"==typeof l?l.call(null!=t?t:e.nullContext||{},{"name":"loadingMetadata","hash":{},"loc":{"start":{"line":27,"column":24},"end":{"line":27,"column":43}}}):l))+'\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\t\t<div class="form-metadata">\r\n\t\t</div>\r\n    </div>\r\n\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_metadata_impl_metadata",o),o}),csui.define("css!conws/widgets/metadata/impl/metadata",[],function(){}),csui.define("conws/widgets/metadata/metadata.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/behaviors/keyboard.navigation/tabable.region.behavior","csui/utils/base","csui/utils/log","csui/utils/base","csui/controls/list/emptylist.view","conws/controls/selectedmetadataform/selectedmetadataform.view","conws/models/workspacecontext/workspacecontext.factory","conws/widgets/metadata/impl/forms.metadata.update.factory","i18n!conws/widgets/metadata/impl/nls/metadata.lang","hbs!conws/widgets/metadata/impl/metadata","hbs!conws/utils/workspaces/error.template","csui/controls/mixins/layoutview.events.propagation/layoutview.events.propagation.mixin","css!conws/widgets/metadata/impl/metadata","css!conws/utils/workspaces/workspaces"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h){var g=i.LayoutView.extend({"className":"conws-metadata","template":p,"ui":{"loadContainer":".load-container","headerTitle":".tile-title","tileHeader":".tile-header","tileContent":".tile-content"},"templateHelpers":function(e){return{"hideHeader":this.hideHeader,"title":l.getClosestLocalizedString(this.headerTitle,u.defaultMetadataWidgetTitle),"icon":this.headerIcon,"loadingMetadata":u.loadingMetadata}},"events":{"keydown .form-metadata":"onKeyInView"},"behaviors":{"TabableRegion":{"behaviorClass":o}},"onKeyInView":function(e){var t=document.activeElement,i=this.currentlyFocusedElement(),o=0;if(t.children.length>0&&(t=t.children[0]),9===e.keyCode)if(e.shiftKey){for(o=0;o<i.length;o++)if(t===i[o]){if(t.classList.contains("esoc-user-mini-profile")||t.classList.contains("reference-generate-number")||t.classList.contains("cs-field-read-content")&&t.classList.contains("placeholder")||o-1<0)break;i[o-1].focus();break}}else for(o=0;o<i.length;o++)if(t===i[o]&&o+1<i.length){if(t.classList.contains("esoc-user-mini-profile")||t.classList.contains("reference-generate-number")||t.classList.contains("cs-field-read-content")&&t.classList.contains("placeholder"))break;i[o+1].focus();break}},"currentlyFocusedElement":function(){var e=(!!this.$form&&this.$form.find(".alpaca-readonly button"),this.$("button,*[data-cstabindex],*[tabindex]"));return e=this.remove_Elements(e)},"remove_Elements":function(e){for(var t=["alpaca-array-actionbar-action","typeahead","cs-icon","binf-hidden","csui-icon-edit","csui-bulk-edit","icon-date_picker"],i=0;i<e.length;i++)for(var o=0;o<t.length;o++)e[i].classList.contains(t[o])&&(e.splice(i,1),o=t.length,i-=1);return e},"constructor":function(o){if(o||(o={}),!o.context)throw new Error("Context is missing in the constructor options");e.defaults(o,{"searchTabContentForTabableElements":!0}),this.hideHeader=o.data&&o.data.hideHeader,this.headerTitle=o.data&&o.data.title||u.defaultMetadataWidgetTitle,this.headerIcon=o.data&&o.data.icon||"category1",this.noMetadataMessage=u.noMetadataMessage,o.data&&o.data.noMetadataMessage&&(this.noMetadataMessage=n.getClosestLocalizedString(o.data.noMetadataMessage,this.noMetadataMessage)),o.workspaceContext||(o.workspaceContext=o.context.getObject(c)),o.workspaceContext.setWorkspaceSpecific(d),this.formViewList=[];var s=o.data;if(o.data&&o.data.relatedWorkspaces&&o.data.relatedWorkspaces.workspaceTypes){s=t.extend(!0,{},o.data);var l=e.map(o.data.relatedWorkspaces.workspaceTypes,function(e){return{"workspaceTypeId":e.workspaceTypeId,"type":"relation"}});e.isEmpty(o.data.relatedWorkspaces.relatedGroupName)||(l=[{"attributes":l,"label":o.data.relatedWorkspaces.relatedGroupName,"type":"group"}]),s.metadata?s.metadata=l.concat(s.metadata):s.metadata=l}o.model=o.workspaceContext.getObject(d,{"metadataConfig":s,"unique":!0,"connector":o.connector}),i.LayoutView.prototype.constructor.call(this,o),this.listenTo(o.model,"change",this.render),this.listenTo(o.model,"error",this.handleError),this.propagateEventsToRegions()},"handleError":function(e,t,i){var o=m.call(this,{"errorMessage":t.responseJSON.error});this.$(".form-metadata").empty(),this.$(".conws-workspaces-error").remove(),this.$(".tile-content").append(o),this._hideLoadContainer()},"_hideLoadContainer":function(){this.ui.loadContainer.addClass("binf-hidden")},"onRender":function(){var i=e.uniqueId("dlgTitle");if(this.ui.tileHeader.attr("tabindex",0),this.ui.headerTitle.find(".csui-heading").attr("id",i),this.ui.tileHeader.parent().attr("role","region").attr("aria-labelledby",i),this.ui.tileContent.attr("aria-labelledby",i),this._currentShortcutIndex=0,e.each(this.regions,function(e,t){this.removeRegion(t)},this),this.formViewList.splice(0),delete this.formView,this.model.metadataConfig.length>0&&!e.isEmpty(this.model.attributes.data)){var o=[],n={"data":{},"options":{"fields":{}},"schema":{"properties":{}}};n.data=t.extend({},this.model.attributes.data),n.options.fields=t.extend({},this.model.attributes.options.fields),n.schema.properties=t.extend({},this.model.attributes.schema.properties),e.each(this.model.metadataConfig,function(i,n){if("group"===i.type)o[n]={"data":{},"options":{},"schema":{}},o[n].data=t.extend({},this.model.attributes.data[i.label]),o[n].options=t.extend({},this.model.attributes.options.fields[i.label]),o[n].schema=t.extend({},this.model.attributes.schema.properties[i.label]);else if("category"===i.type)o[n]={"data":{},"options":{"fields":{}},"schema":{"properties":{}}},e.each(this.model.attributes.data,function(e,t){0===t.lastIndexOf(i.categoryId+"_",0)&&(o[n].data[t]=this.model.attributes.data[t],o[n].options.fields[t]=this.model.attributes.options.fields[t],o[n].schema.properties[t]=this.model.attributes.schema.properties[t])},this);else if("relation"===i.type)o[n]={"data":{},"options":{"fields":{}},"schema":{"properties":{}}},e.each(this.model.attributes.data,function(e,t){var s=this.model.attributes.options&&this.model.attributes.options.fields;(s&&s[t]&&s[t].workspace_type_id)+""==i.workspaceTypeId+""&&(o[n].data[t]=this.model.attributes.data[t],o[n].options.fields[t]=this.model.attributes.options.fields[t],o[n].schema.properties[t]=this.model.attributes.schema.properties[t])},this);else if("attribute"===i.type){var s=i.categoryId+"_"+i.attributeId;i.attributeType&&(s="object"===i.attributeType?s+"_1_"+i.columnId:s+"_x_"+i.columnId),o[n]={"data":{},"options":{"fields":{}},"schema":{"properties":{}}},void 0!==this.model.attributes.data[s]&&(o[n].data[s]=this.model.attributes.data[s],o[n].options.fields[s]=this.model.attributes.options.fields[s],o[n].schema.properties[s]=this.model.attributes.schema.properties[s])}},this),e.each(o,function(i,n){if(!(e.isEmpty(i.data)&&e.isEmpty(i.options.fields)&&e.isEmpty(i.schema.properties))){this.model.attributes=o[n];var s=this["formView"+n]=new r({"model":this.model,"context":this.options.context,"node":this.model.node});this.formViewList.push(s),s.metadataview=this;var l="Region"+n;t("<div></div>").addClass("form-metadata"+n).appendTo(this.$(".form-metadata")),this.addRegion(l,".form-metadata"+n),this.regions[l]=t.extend({},this[l]),s.listenTo(s,"render:form",function(){this._hideLoadContainer()}.bind(this)),this[l].show(s)}},this),this.model.attributes=n}0!==this.formViewList.length||0!==this.model.metadataConfig.length&&!this.model.attributes.data||(t("<div></div>").addClass("form-metadata0").appendTo(this.$(".form-metadata")),this.addRegion("Region0",".form-metadata0"),this.regions.Region0=t.extend({},this.Region0),this.formView=new a({"text":this.noMetadataMessage}),this.Region0.show(this.formView),this._hideLoadContainer())}});return e.extend(g.prototype,h),g}),csui.define("hbs!conws/widgets/outlook/impl/wksp/impl/wksp",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\r\n<div class="List-item" >\r\n    <div class="listItemWksp wkspItem"  id="wkspItem" >\r\n        <span class="wksp-expand-icon" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":4,"column":48},"end":{"line":4,"column":54}}}):s))+'"><div id="toggleIcon" tabindex="'+e.escapeExpression((s=null!=(s=l(i,"tabIndex")||(null!=t?l(t,"tabIndex"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"tabIndex","hash":{},"loc":{"start":{"line":4,"column":87},"end":{"line":4,"column":99}}}):s))+'" class="'+e.escapeExpression((s=null!=(s=l(i,"toggleStatus")||(null!=t?l(t,"toggleStatus"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"toggleStatus","hash":{},"loc":{"start":{"line":4,"column":108},"end":{"line":4,"column":124}}}):s))+'" title="'+e.escapeExpression((s=null!=(s=l(i,"typeName")||(null!=t?l(t,"typeName"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"typeName","hash":{},"loc":{"start":{"line":4,"column":133},"end":{"line":4,"column":145}}}):s))+'" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":4,"column":156},"end":{"line":4,"column":162}}}):s))+'"></div></span>\r\n        <span class="wkspItemIcon"><div class="'+e.escapeExpression((s=null!=(s=l(i,"iconClass")||(null!=t?l(t,"iconClass"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"iconClass","hash":{},"loc":{"start":{"line":5,"column":47},"end":{"line":5,"column":60}}}):s))+'" title="'+e.escapeExpression((s=null!=(s=l(i,"typeName")||(null!=t?l(t,"typeName"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"typeName","hash":{},"loc":{"start":{"line":5,"column":69},"end":{"line":5,"column":81}}}):s))+'"></div></span>\r\n        <div class="listItemWkspName wkspItemName"  tabindex="0" id="wkspNameDiv" title="'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":6,"column":89},"end":{"line":6,"column":97}}}):s))+'" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":6,"column":108},"end":{"line":6,"column":114}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":6,"column":116},"end":{"line":6,"column":124}}}):s))+' </div>\r\n        <div class="wkspFolder-actiondiv binf-fade" style="display:none">\r\n            <div id="wkspActionBar" class="wkspFolder-actionbar wkspFolder-actionbar-bubble" >\r\n                <ul class="wksptile-nav wkspnav wksptile-pills">\r\n                    <li class="needsclick wkspActionButton wkspActionSaveButton" id="wkspSaveMenuItem" style="display:none">\r\n                        <div>\r\n                            <a href="javascript:void(0)" id="saveEmailButton" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":12,"column":87},"end":{"line":12,"column":93}}}):s))+'" tabindex="0" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"saveTitle")||(null!=t?l(t,"saveTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"saveTitle","hash":{},"loc":{"start":{"line":12,"column":120},"end":{"line":12,"column":133}}}):s))+'">\r\n                                <div class="wkspIcon '+e.escapeExpression((s=null!=(s=l(i,"actionIcon")||(null!=t?l(t,"actionIcon"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"actionIcon","hash":{},"loc":{"start":{"line":13,"column":53},"end":{"line":13,"column":67}}}):s))+'" data-id="noToggle"></div>\r\n                            </a>\r\n                        </div>\r\n                    </li>\r\n\r\n                    <li class="needsclick wkspActionButton">\r\n                        <div>\r\n                            <a href="'+e.escapeExpression((s=null!=(s=l(i,"linkToWS")||(null!=t?l(t,"linkToWS"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"linkToWS","hash":{},"loc":{"start":{"line":20,"column":37},"end":{"line":20,"column":49}}}):s))+'" id="wkspOpenButton" title="'+e.escapeExpression((s=null!=(s=l(i,"openLinkTitle")||(null!=t?l(t,"openLinkTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"openLinkTitle","hash":{},"loc":{"start":{"line":20,"column":78},"end":{"line":20,"column":95}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"openLinkTitle")||(null!=t?l(t,"openLinkTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"openLinkTitle","hash":{},"loc":{"start":{"line":20,"column":109},"end":{"line":20,"column":126}}}):s))+'" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":20,"column":137},"end":{"line":20,"column":143}}}):s))+'" tabindex="0" target="_blank">\r\n                                <div class="wkspIcon wkspOpenIcon" data-id="noToggle"></div>\r\n                            </a>\r\n                        </div>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div id="subFolders"></div>\r\n</div>'}});return i.registerPartial("conws_widgets_outlook_impl_wksp_impl_wksp",o),o}),csui.define("conws/widgets/outlook/impl/utils/emailservice",["module","csui/lib/jquery","conws/widgets/outlook/impl/utils/utility","i18n!conws/widgets/outlook/impl/nls/lang"],function(e,t,i,o){function n(e){var i=t.Deferred(),o=void 0!==e&&e;try{var n=null,s=window.Office.context.mailbox.userProfile.emailAddress;if(o)n=window.Office.context.mailbox.item;else{n=window.Office.cast.item.toItemRead(window.Office.context.mailbox.item),n.archivableAttachments=[];for(var l=0;l<n.attachments.length;l++){var a=n.attachments[l];a.attachmentType===window.Office.MailboxEnums.AttachmentType.File&&n.archivableAttachments.push(a)}}i.resolve({"currentEmail":n,"currentUser":s})}catch(e){i.reject(e)}return i.promise()}function s(e){if(i.SavingSubmitted)return void(i.EmailChangedAfterSaving=!0);i.EmailChangedAfterSaving=!1;var t=window.Office.context.mailbox.item,o=window.CurrentEmailItem,n=window.pageYOffset;if(o.itemId!==t.itemId){var s=window.Office.cast.item.toItemRead(t);s.archivableAttachments=[];for(var l=0;l<s.attachments.length;l++){var a=s.attachments[l];a.attachmentType===window.Office.MailboxEnums.AttachmentType.File&&s.archivableAttachments.push(a)}window.CurrentEmailItem=s,null!==o&&(i.writeTrace("Email has been switched. New email subject: "+t.subject),window.CurrentEmailItem=window.Office.cast.item.toItemRead(t),i.uiShow(i.PreSaveSection),"standardSections"===i.PreSaveSection&&i.uiShow("customSearchButton"),i.uiHide("savePanel"),-1!==i.ScorllPositionBeforeSaving?(window.scrollTo(0,i.ScorllPositionBeforeSaving),i.ScorllPositionBeforeSaving=-1):window.scrollTo(0,n),null!==i.SuggestedWkspsView&&i.SuggestedWkspsView.refresh())}}function l(e,i){var n=t.Deferred();if(void 0===window.Office.context||void 0===window.Office.context.mailbox||void 0===window.Office.context.mailbox.item||null===window.Office.context.mailbox.item)return n.reject({"message":o.warning_no_outlook_context}),n.promise();var s=window.Office.context.mailbox.item;return s.body.getTypeAsync(function(t){t.status===window.Office.AsyncResultStatus.Failed?n.reject({"message":t.error.message}):t.value===window.Office.MailboxEnums.BodyType.Html?s.body.setSelectedDataAsync(e+':<br><a href="'+i+'">'+i+"</a> ",{"coercionType":window.Office.CoercionType.Html},function(e){e.status===window.Office.AsyncResultStatus.Failed?n.reject({"message":e.error.message}):n.resolve({})}):s.body.setSelectedDataAsync(e+":\n"+i+" ",{"coercionType":window.Office.CoercionType.Text},function(e){e.status===window.Office.AsyncResultStatus.Failed?n.reject({"message":e.error.message}):n.resolved({})})}),n.promise()}return{"constants":{"cs_config_missing":o.config_CS_missing,"retrieve_email_error":o.error_retrieve_email},"getCurrentMailboxItem":n,"emailItemChanged":s,"insertLink":l}}),csui.define("hbs!conws/widgets/outlook/impl/folder/impl/item",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\r\n<div class="List-item">\r\n    <div class="wkspItem listItemFolder" id="wkspFolderItem" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":3,"column":70},"end":{"line":3,"column":76}}}):s))+'">\r\n        <span class="wksp-expand-icon" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":4,"column":48},"end":{"line":4,"column":54}}}):s))+'"><div id="toggleIcon" class="'+e.escapeExpression((s=null!=(s=l(i,"toggleStatus")||(null!=t?l(t,"toggleStatus"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"toggleStatus","hash":{},"loc":{"start":{"line":4,"column":84},"end":{"line":4,"column":100}}}):s))+'" tabindex="'+e.escapeExpression((s=null!=(s=l(i,"tabIndex")||(null!=t?l(t,"tabIndex"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"tabIndex","hash":{},"loc":{"start":{"line":4,"column":112},"end":{"line":4,"column":124}}}):s))+'" title="'+e.escapeExpression((s=null!=(s=l(i,"typeName")||(null!=t?l(t,"typeName"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"typeName","hash":{},"loc":{"start":{"line":4,"column":133},"end":{"line":4,"column":145}}}):s))+'" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":4,"column":156},"end":{"line":4,"column":162}}}):s))+'"></div></span>\r\n        <span class="wkspItemIcon" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":5,"column":44},"end":{"line":5,"column":50}}}):s))+'" title="'+e.escapeExpression((s=null!=(s=l(i,"typeName")||(null!=t?l(t,"typeName"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"typeName","hash":{},"loc":{"start":{"line":5,"column":59},"end":{"line":5,"column":71}}}):s))+'">\r\n            <div class="'+e.escapeExpression((s=null!=(s=l(i,"iconClass")||(null!=t?l(t,"iconClass"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"iconClass","hash":{},"loc":{"start":{"line":6,"column":24},"end":{"line":6,"column":37}}}):s))+'" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":6,"column":48},"end":{"line":6,"column":54}}}):s))+'"></div>\r\n        </span>\r\n        \r\n        <div data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":9,"column":22},"end":{"line":9,"column":28}}}):s))+'" class="wkspItemName"  tabindex="0" id="folderNameDiv" title="'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":9,"column":91},"end":{"line":9,"column":99}}}):s))+'" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":9,"column":110},"end":{"line":9,"column":116}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":9,"column":118},"end":{"line":9,"column":126}}}):s))+' </div>\r\n        <div class="wkspFolder-actiondiv binf-fade" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":10,"column":61},"end":{"line":10,"column":67}}}):s))+'" style="display:none">\r\n            <div id="folderActionBar" class="wkspFolder-actionbar wkspFolder-actionbar-bubble" >\r\n                <ul class="wksptile-nav wkspnav wksptile-pills">\r\n                    \r\n                    <li class="needsclick">\r\n                        <div >\r\n                            <a href="javascript:void(0)" id="saveEmailButton" title="'+e.escapeExpression((s=null!=(s=l(i,"saveTitle")||(null!=t?l(t,"saveTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"saveTitle","hash":{},"loc":{"start":{"line":16,"column":85},"end":{"line":16,"column":98}}}):s))+' " aria-label="'+e.escapeExpression((s=null!=(s=l(i,"saveTitle")||(null!=t?l(t,"saveTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"saveTitle","hash":{},"loc":{"start":{"line":16,"column":113},"end":{"line":16,"column":126}}}):s))+'" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":16,"column":137},"end":{"line":16,"column":143}}}):s))+'" tabindex="0" >\r\n                                <div class="wkspIcon '+e.escapeExpression((s=null!=(s=l(i,"actionIcon")||(null!=t?l(t,"actionIcon"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"actionIcon","hash":{},"loc":{"start":{"line":17,"column":53},"end":{"line":17,"column":67}}}):s))+'" data-id="noToggle"></div>\r\n                            </a>            \r\n                        </div>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div id="subFolders"></div>\r\n</div>'}});return i.registerPartial("conws_widgets_outlook_impl_folder_impl_item",o),o}),csui.define("hbs!conws/widgets/outlook/impl/dialog/impl/logindialog",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\r\n<div class="modal-dialog modal-sm load-container">\r\n    <div class="binf-modal-dialog ">\r\n        <div class="binf-modal-content">\r\n            <div class="binf-modal-header wksp-dialog-header">\r\n                <img src="impl/images/headerbar_content_server.png" title="'+e.escapeExpression((s=null!=(s=l(i,"signInTitle")||(null!=t?l(t,"signInTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"signInTitle","hash":{},"loc":{"start":{"line":6,"column":75},"end":{"line":6,"column":90}}}):s))+'" class="signInImage" />\r\n            </div>\r\n\r\n            <div class="wksp-dialog-body" title="'+e.escapeExpression((s=null!=(s=l(i,"signInTitle")||(null!=t?l(t,"signInTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"signInTitle","hash":{},"loc":{"start":{"line":9,"column":49},"end":{"line":9,"column":64}}}):s))+'">\r\n                <div>'+e.escapeExpression((s=null!=(s=l(i,"signInMessage")||(null!=t?l(t,"signInMessage"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"signInMessage","hash":{},"loc":{"start":{"line":10,"column":21},"end":{"line":10,"column":38}}}):s))+'</div>\r\n                <div class="errorMessage" > </div>\r\n                <div>\r\n                    <label for="userName">'+e.escapeExpression((s=null!=(s=l(i,"usernameLabel")||(null!=t?l(t,"usernameLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"usernameLabel","hash":{},"loc":{"start":{"line":13,"column":42},"end":{"line":13,"column":59}}}):s))+'</label> <input class="wkspInput" id="userName" tabindex="0"/>\r\n                </div>\r\n                <div>\r\n                    <label for="passkey">'+e.escapeExpression((s=null!=(s=l(i,"passkeyLabel")||(null!=t?l(t,"passkeyLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"passkeyLabel","hash":{},"loc":{"start":{"line":16,"column":41},"end":{"line":16,"column":57}}}):s))+'</label> <input class="wkspInput" id="passkey" type="password" tabindex="0" />\r\n                </div>\r\n            </div>\r\n            \r\n            <div class="binf-modal-footer">\r\n                <button type="button" class="binf-btn binf-btn-primary csui-yes csui-default" tabindex="0" >\r\n                    '+e.escapeExpression((s=null!=(s=l(i,"signInButtonTitle")||(null!=t?l(t,"signInButtonTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"signInButtonTitle","hash":{},"loc":{"start":{"line":22,"column":20},"end":{"line":22,"column":41}}}):s))+"\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>"}});return i.registerPartial("conws_widgets_outlook_impl_dialog_impl_logindialog",o),o}),csui.define("conws/widgets/outlook/impl/dialog/authenticator",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/utils/url","conws/widgets/outlook/impl/utils/utility","hbs!conws/widgets/outlook/impl/dialog/impl/logindialog","i18n!conws/widgets/outlook/impl/nls/lang","i18n!csui/pages/start/nls/root/lang","csui/behaviors/keyboard.navigation/tabkey.behavior","csui/lib/binf/js/binf"],function(e,t,i,o,n,s,l,a,r,c,d,u){return o.ItemView.extend({"className":function(){var e="csui-alert binf-modal binf-fade";return this.options.modalClass&&(e+=" "+this.options.modalClass),e},"template":r,"ui":{"errorMessage":".errorMessagae","userName":"#userName","passkey":"#passkey"},"triggers":{"click .csui-yes":"click:yes"},"events":{"shown.binf.modal":"onShown","hide.binf.modal":"onHiding","hidden.binf.modal":"onHidden","keyup":"processKey"},"behaviors":{"TabKeyBehavior":{"behaviorClass":u,"recursiveNavigation":!0}},"constructor":function(e){o.ItemView.prototype.constructor.apply(this,arguments);var t=a.getConnector();this.connector=t;var n=new l(t.connection.url);this.hostName=n.getHost(),this.ticketCookieName="otcsTicket"+this.hostName.replace(/;/g,"_").replace(/=/g,"_").replace(/ /g,"_").replace(/,/g,"_").replace(/-/g,"_"),this._deferred=i.Deferred(),
this.ssoDeferred=i.Deferred(),this.errorMessage="",this.llCookie=null,this.isSSOMessageReceived=!1,this.beingAuthenticated=!1},"templateHelpers":function(){return{"signInButtonTitle":c.signIn_button_Title,"usernameLabel":c.signIn_username,"passkeyLabel":c.signIn_passkey,"signInMessage":t.str.sformat(c.signIn_message,d.ProductName),"signInTitle":c.signIn_title}},"show":function(){var e=this,t=e._deferred.promise();return a.stopGlobalSpinner(),e.beingAuthenticated?(a.writeTrace("Bing authenticated, so skip."),e._deferred.resolve(!1),e.beingAuthenticated=!1):(e.beingAuthenticated=!0,a.modalOpen(),this.render(),this.$el.attr("tabindex",0),this.errorMessage&&this.$(".errorMessage").html(this.errorMessage),this.options.centerVertically&&this.centerVertically(),this.$el.binf_modal("show"),this.triggerMethod("show"),t.close=function(){return e.$el.binf_modal("hide"),t}),t},"centerVertically":function(){var e,t;e=this.$el.clone(),e.css("display","block"),e.appendTo(i.fn.binf_modal.getDefaultContainer()),t=Math.round((e.height()-e.find(".binf-modal-content").height())/2),t=t>0?t:0,e.remove(),this.$el.find(".binf-modal-content").css("margin-top",t)},"onShown":function(){this._deferred.notify({"state":"shown"}),this.$("#userName").focus()},"onHiding":function(){this._deferred.notify({"state":"hiding"})},"onHidden":function(e){a.modalClose(),this.destroy(),this.options.callback&&this.options.callback(this._result),this._result?this._deferred.resolve(this._result):this._deferred.reject(this._result)},"processKey":function(e){13===e.which&&this.onClickYes()},"onClickYes":function(){var e=this,t=e.$("#userName").val().trim(),i=e.$("#passkey").val().trim(),o=e.$(".errorMessage");if(o.html("  "),!t||!i)return void o.html(c.signIn_required);this.connector.connection.credentials={"username":t,"password":i,"domain":""},this.connector.confirmingReload=!1;var n=this.connector.authenticator,s={"type":"POST","data":this.connector.connection.credentials,"contentType":"application/x-www-form-urlencoded"};n.login(s,function(t){a.writeTrace("Authenticated based on username & password."),void 0===e.connector.connection.session&&(e.connector.connection.session=t.session),e.options.context.csUser=s.data.username,a.setPersistentSetting(e.ticketCookieName,t.session.ticket,t.session.expries),e.connector.timeoutProcessed=!1,e._result=!0,e.onHidden()},function(t){e.connector.timeoutProcessed=!1,e.$(".errorMessage").html(a.getErrorMessage(t))})},"_setTabFocus":function(){var e=this.$("*[tabindex=0]"),t=e.length-1,o=event.shiftKey,n=this._getStartIndex(t,o,e);if(t>-1){var l=void 0!==this.activeIndex?this.activeIndex:o?0:t;do{var a=i(e[n]);if(s.isVisibleInWindowViewport(a)){this.activeIndex=n,a.focus();break}n=o?0===n?t:n-1:n===t?0:n+1}while(n!==l)}return!1},"_getStartIndex":function(e,t){var i=0,o=this.activeIndex;return t?(i=e,void 0!==o&&o>0&&(i=this.activeIndex-1)):void 0!==o&&o<e&&(i=o+1),i},"authenticate":function(e){var t,i,o=this,n=o._deferred.promise(),s=o.connector.connection,l=(s.url,function(t,i){var o=void 0===i?a.getPersistentSetting(t.ticketCookieName):i;if(!o||t.connector.timeoutProcessed)return t.show();s.session={"ticket":o};var n=t.verifyAuthentication(t,s);return n.done(function(i){t.connector.authenticator.authenticate(e,function(e){a.setPersistentSetting(t.ticketCookieName,t.connector.authenticator.connection.session.ticket,t.connector.authenticator.connection.session.expries),t.connector.timeoutProcessed=!1,t._result=!0,t._deferred.resolve(t._result)},function(e){return t.show()})}),n.fail(function(e){a.SSOEnabled?t.getSSOTicket(t).then(function(e){if(t.connector.timeoutProcessed=!1,e)return a.writeTrace("Using existing ticket unsuccessful, renew ticket using SSO."),s.session={"ticket":e},t.traceLoginUser(t,s),t.connector.confirmingReload=!1,a.stopGlobalSpinner(),a.setPersistentSetting(t.ticketCookieName,s.session.ticket,s.session.expries),t._result=!0,t._deferred.resolve(t._result),t._deferred.promise();t.show()},function(){t.show()}):t.show()}),t._deferred.promise()});return s.session&&s.session.ticket?(t=s.session.ticket,i="existing connection session"):(t=a.getPersistentSetting(o.ticketCookieName),i="persistent setting"),!o.connector.timeoutProcessed&&t?(a.writeTrace("Trying to authenticate based on "+i),l(o,t)):a.SSOEnabled?(a.writeTrace("Trying SSO authentication"),o.getSSOTicket(o).then(function(e){return o.connector.timeoutProcessed=!1,e?(s.session={"ticket":e},o.traceLoginUser(o,s),o.connector.confirmingReload=!1,a.stopGlobalSpinner(),a.setPersistentSetting(o.ticketCookieName,s.session.ticket,s.session.expries),o._result=!0,o._deferred.resolve(o._result),o._deferred.promise()):l(o)},function(){return l(o)}),n):l(o)},"getSSOTicket":function(e){if(a.getPersistentSetting("sso_error"))e.ssoDeferred.reject();else{setTimeout(function(){a.startGlobalSpinner(!0)},500),e.isSSOMessageReceived=!1;var t=window.ServerOrigin;e.messageListener=a.registerMessageListener(function(i){e.isSSOMessageReceived||(a.writeTrace("Received SSO message from: "+t),e.isSSOMessageReceived=!0,a.detachMessageListener(e.messageListener,t),setTimeout(function(){a.stopGlobalSpinner()},500),e.ssoDeferred.resolve(i.data))},t);var i="&tick="+(new Date).getTime(),o=window.ServerCgiScript+a.SSOLoginURL+i+"#",n=o+encodeURIComponent(document.location.href);a.isSafeURL(n)?(document.getElementById("ssoFrame").src=n,setTimeout(function(){!1===e.isSSOMessageReceived&&(a.writeTrace("SSO timed out."),e.errorMessage="",document.getElementById("ssoFrame").src="",a.detachMessageListener(e.messageListener),e.ssoDeferred.reject())},6e3),a.writeTrace("SSO enabled and token being retrieved.")):(a.writeTrace("Unsafe URL found: "+n),e.ssoDeferred.reject())}return e.ssoDeferred.promise()},"verifyAuthentication":function(e,t){var o=i.Deferred();return i.ajax({"type":"GET","headers":{"otcsticket":t.session.ticket},"url":t.url+"/auth","success":function(t){e.options.context.csUser=t.data.name,a.writeTrace("Logged in as: "+t.data.name),o.resolve({"successful":!0})},"error":function(e){o.reject(e)}}),o.promise()},"traceLoginUser":function(e,t){a.TraceEnabled&&i.ajax({"type":"GET","headers":{"Content-Type":void 0,"otcsticket":t.session.ticket},"url":t.url+"/auth","success":function(t){t&&t.data&&t.data.name?(e.options.context.csUser=t.data.name,a.writeTrace("Logged in as: "+t.data.name)):a.writeTrace("Cannot get login user.")}})}})}),csui.define("hbs!conws/widgets/outlook/impl/dialog/impl/nameresolver",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\r\n<div class="modal-dialog modal-sm load-container">\r\n    <div class="binf-modal-dialog ">\r\n        <div class="binf-modal-content">\r\n            <div class="binf-modal-header question-header">\r\n                <h4 class="binf-modal-title">\r\n                    <span class="icon csui-icon-notification-confirmation-white"></span>\r\n                    <span class="title-text">'+e.escapeExpression((s=null!=(s=l(i,"titleSaveEmail")||(null!=t?l(t,"titleSaveEmail"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"titleSaveEmail","hash":{},"loc":{"start":{"line":8,"column":45},"end":{"line":8,"column":63}}}):s))+'</span>\r\n                </h4>\r\n            </div>\r\n\r\n            <div class="wksp-dialog-body">\r\n                <div>'+e.escapeExpression((s=null!=(s=l(i,"validationMessage")||(null!=t?l(t,"validationMessage"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"validationMessage","hash":{},"loc":{"start":{"line":13,"column":21},"end":{"line":13,"column":42}}}):s))+'</div>\r\n                <div class="errorMessage"> </div>\r\n                <div>\r\n                    <span>'+e.escapeExpression((s=null!=(s=l(i,"uniqueNameLabel")||(null!=t?l(t,"uniqueNameLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"uniqueNameLabel","hash":{},"loc":{"start":{"line":16,"column":26},"end":{"line":16,"column":45}}}):s))+'</span> \r\n                    <textarea class="wkspInput wkspEmailName" id="fileName" tabindex="0"/>\r\n                </div>\r\n\r\n            </div>\r\n            \r\n            <div class="binf-modal-footer">\r\n                <button type="button" class="binf-btn binf-btn-primary csui-yes csui-default" tabindex="0" >\r\n                    '+e.escapeExpression((s=null!=(s=l(i,"titleOk")||(null!=t?l(t,"titleOk"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"titleOk","hash":{},"loc":{"start":{"line":24,"column":20},"end":{"line":24,"column":31}}}):s))+'\r\n                </button>\r\n                <button type="button" class="binf-btn binf-btn-default csui-cancel" tabindex="0"\r\n                        data-binf-dismiss="modal">\r\n                    '+e.escapeExpression((s=null!=(s=l(i,"titleCancel")||(null!=t?l(t,"titleCancel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"titleCancel","hash":{},"loc":{"start":{"line":28,"column":20},"end":{"line":28,"column":35}}}):s))+"\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>"}});return i.registerPartial("conws_widgets_outlook_impl_dialog_impl_nameresolver",o),o}),csui.define("conws/widgets/outlook/impl/dialog/nameresolver",["module","csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/utils/log","csui/utils/base","csui/utils/url","csui/utils/requestauthenticator","conws/widgets/outlook/impl/utils/utility","hbs!conws/widgets/outlook/impl/dialog/impl/nameresolver","i18n!conws/widgets/outlook/impl/nls/lang","csui/behaviors/keyboard.navigation/tabkey.behavior","csui/lib/binf/js/binf"],function(e,t,i,o,n,s,l,a,r,c,d,u){return o.ItemView.extend({"className":function(){var e="csui-alert binf-modal binf-fade";return this.options.modalClass&&(e+=" "+this.options.modalClass),e},"template":c,"ui":{"errorMessage":".errorMessagae","fileName":"#fileName"},"triggers":{"click .csui-yes":"click:yes"},"events":{"shown.binf.modal":"onShown","hide.binf.modal":"onHiding","hidden.binf.modal":"onHidden","keyup":"processKey","keyup #fileName":"emailNameTyping"},"behaviors":{"TabKeyBehavior":{"behaviorClass":u,"recursiveNavigation":!0}},"constructor":function(e){o.ItemView.prototype.constructor.apply(this,arguments),e=this.options,this.connector=e.connector,this._deferred=i.Deferred(),this.folderId=e.folderId,this.proposedName=r.escapeNameToCreate(e.originalName),this.originalName=this.proposedName,this.folderName=e.folderName,this.url=l.combine(this.connector.connection.url,"validation/nodes/names"),this.bodyFormat='{"parent_id":%d,"names":["%s"]}'},"templateHelpers":function(){return{"validationMessage":this.originalName?t.str.sformat(d.validation_name_conflict,this.originalName,this.folderName):d.validation_no_subject,"titleSaveEmail":d.title_save_email,"uniqueNameLabel":d.save_nameNotUnique,"titleOk":d.title_ok,"titleCancel":d.title_cancel}},"show":function(){r.modalOpen(),this.render(),this.$el.attr("tabindex",0),this.options.centerVertically&&this.centerVertically(),this.$el.binf_modal("show"),this.triggerMethod("show"),this.proposedName&&this.$("#fileName").val(this.proposedName),this.templateHelpers();var e=this._deferred.promise(),t=this;return e.close=function(){return t.$el.binf_modal("hide"),e},e},"centerVertically":function(){var e,t;e=this.$el.clone(),e.css("display","block"),e.appendTo(i.fn.binf_modal.getDefaultContainer()),t=Math.round((e.height()-e.find(".binf-modal-content").height())/2),t=t>0?t:0,e.remove(),this.$el.find(".binf-modal-content").css("margin-top",t)},"onShown":function(){this._deferred.notify({"state":"shown"}),this.$("#fileName").focus();var e=this.$("#fileName")[0];e.style.height="1px",e.style.height=e.scrollHeight+"px"},"onHiding":function(){this._deferred.notify({"state":"hiding"})},"onHidden":function(e){r.modalClose(),this.destroy(),this.options.callback&&this.options.callback(this._result),this._result?this._deferred.resolve(this._result):this._deferred.reject(this._result)},"emailNameTyping":function(e){var t=this.$("#fileName");if(0!==t.length){var i=t[0];i.style.height="1px",i.style.height=i.scrollHeight+"px"}},"processKey":function(e){13===e.which&&this.onClickYes()},"onClickNo":function(){this._result=!1},"onClickYes":function(){var e=this,t=r.escapeNameToCreate(e.$("#fileName").val().trim()),i=e.$(".errorMessage");i.text("  "),t?(e.originalName=t,e.proposedName=t,e.validate().done(function(t){t.status&&e.destroy()})):i.text(d.save_enterName)},"_setTabFocus":function(){var e=this.$("*[tabindex=0]"),t=e.length-1,o=event.shiftKey,n=this._getStartIndex(t,o,e);if(t>-1){var l=void 0!==this.activeIndex?this.activeIndex:o?0:t;do{var a=i(e[n]);if(s.isVisibleInWindowViewport(a)){this.activeIndex=n,a.focus();break}n=o?0===n?t:n-1:n===t?0:n+1}while(n!==l)}return!1},"_getStartIndex":function(e,t){var i=0,o=this.activeIndex;return t?(i=e,void 0!==o&&o>0&&(i=this.activeIndex-1)):void 0!==o&&o<e&&(i=o+1),i},"validate":function(e){var t=this._deferred.promise(),i=this,o=i.url;if(i.proposedName){r.startGlobalSpinner();var n=i.verifyName(o,i.proposedName);n.done(function(e){if(e.results&&0===e.results.length)i._result={"success":!0,"name":i.proposedName},i.onHidden(),i._deferred.resolve(i._result);else{var t=i.rename(i.proposedName);i.resolveName(t,function(e){i.proposedName=e,r.stopGlobalSpinner(),i.show(),i.onShown()})}}),n.fail(function(e,t){r.stopGlobalSpinner();var o=t;e&&(o=e.responseJSON&&e.responseJSON.error?e.responseJSON.error:e.responseText?e.responseText:e.statusText?e.statusText:JSON.stringify(e)),i.$(".errorMessage").text(o),i._result={"success":!1,"status":e.status,"errorMessage":o},i._deferred.resolve(i._result)})}else i.show();return t},"verifyName":function(e,o){var n=this,s=n.connector.connection.session.ticket,l=t.str.sprintf(n.bodyFormat,n.folderId,r.escapeNameToVerify(o)+".eml");return i.ajax({"type":"POST","headers":{"Content-Type":"application/x-www-form-urlencoded","OTCSTicket":s},"url":e,"contentType":!1,"data":{"body":l}})},"resolveName":function(e,t){var i=this,o=i.url;i.verifyName(o,e).done(function(o){if(o.results&&0===o.results.length)t(e);else{var n=i.rename(e);i.resolveName(n,t)}})},"rename":function(e){if(!e)return null;var t=e.trim();if(")"===t[t.length-1]){var i=t.lastIndexOf("(");if(i>0&&i<t.length-2){var o=t.substring(i+1,t.length-1),n=parseInt(o,10);if(o===String(n))return n++,t.substring(0,i+1)+n+")"}}return t+" (1)"}})}),csui.define("conws/widgets/outlook/impl/utils/csservice",["csui/lib/underscore","csui/lib/jquery","csui/utils/url","csui/utils/contexts/page/page.context","csui/utils/contexts/factories/connector","csui/dialogs/modal.alert/modal.alert","conws/widgets/outlook/impl/utils/emailservice","conws/widgets/outlook/impl/dialog/authenticator","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/dialog/nameresolver","i18n!conws/widgets/outlook/impl/nls/lang","i18n!csui/utils/impl/nls/lang"],function(e,t,i,o,n,s,l,a,r,c,d,u){function p(i,o,n,s,l){var a=this,c=window.CurrentEmailItem,u=!!n,p="",m="",h="",g=!1,f=void 0===l?"":JSON.stringify(l),w=t.Deferred();if(null!=s&&s.length>0){g=!0;for(var v=0;v<s.length;v++)p+=0===v?'"'+s[v].name+'"':',"'+s[v].name+'"',m+=0===v?'"'+s[v].id+'"':',"'+s[v].id+'"',h+=0===v?'"'+s[v].mimeType+'"':',"'+s[v].mimeType+'"'}p="{"+p+"}",m="{"+m+"}",h="{"+h+"}";var b="";return u&&g?b=d.save_successful_all:u?b=d.save_successful_email:g&&(b=s.length>1?d.save_successful_attachments:d.save_successful_attachment),r.writeTrace("Ready to perform: saving email = "+u+", saving attachment(s) = "+g),void 0===window.Office||void 0===window.Office.context||void 0===window.Office.context.mailbox?(w.reject({"errorMsg":d.warning_no_outlook_context}),r.writeTrace("Could not save email because there is no Outlook context."),w.promise()):(window.Office.context.mailbox.getCallbackTokenAsync(function(s){if("succeeded"===s.status){var l=new Blob(["From: Demo <demo@demo.com>\nTo: Demo <demo@demo.com>\nSubject: Content placeholder email\nDate: 1 Jul 2017"],{"type":"message/rfc822"}),u=new FormData;u.append("parent_id",o),u.append("ewsUrl",window.Office.context.mailbox.ewsUrl),u.append("emailId",c.itemId),u.append("accessToken",s.value),u.append("emailName",n),u.append("file",l),u.append("body",f),g&&(u.append("attachmentNames",p),u.append("attachmentIds",m),u.append("attachmentTypes",h)),r.writeTrace("Calling CS REST to retrieve email content and attachment to save ..."),t.ajax({"type":"POST","headers":{"Content-Type":void 0,"otcsticket":i.connection.session.ticket},"url":r.v1ToV2(i.connection.url)+"businessworkspaces/outlookaddin/email","contentType":!1,"data":u,"processData":!1,"success":function(t){var i=!1,o="";null!=t.results&&t.results.length>0?(i="Success"===t.results[0].resultCode,o=t.results[0].message):o="OutlookAddinRestFailed",i?(w.resolve({"result":b}),r.writeTrace("Saving the email/attachment to Content Server completed.")):(w.reject({"errorMsg":e.str.sformat(d.error_save_email,o)}),r.writeTrace("Saving the email/attachment to Content Server failed with message: "+o))},"error":function(t,i,o){var n=i;t&&(n=t.responseJSON&&t.responseJSON.error?t.responseJSON.error:t.responseText?t.responseText:t.statusText?t.statusText:JSON.stringify(t)),401===t.status?a.reauthenticate(d.warning_session_expired):(w.reject({"errorMsg":e.str.sformat(d.error_save_email,n)}),r.writeTrace("Saving the email to Content Server failed with message: "+n))}})}else w.reject({"errorMsg":d.error_retrieve_token}),r.writeTrace("Retrieving EWS access token failed.")}),w.promise())}function m(i,o){return i?(r.stopGlobalSpinner(),s.confirmQuestion(e.str.sformat(d.info_confirm_saving,o),d.title_save_email,{"buttons":s.buttons.OkCancel})):t.Deferred().resolve(!0)}function h(e){var t=r.getConnector();t.timeoutProcessed||(t.timeoutProcessed=!0,r.stopGlobalSpinner(),s.showWarning(u.AuthenticationFailureDialogText,e,{"buttons":s.buttons.Ok}).always(function(){var e=new o,i=t;e.connector=i;var n=new a({"context":e,"centerVertically":!0});n.authenticate().done(function(e){n.beingAuthenticated=!1})}))}function g(e,i,o){var n=this,s=[],l=t.Deferred(),a=0,c=null!=i?i:null,d=r.getSuggestedWkspFilters(c,o);if(null!=d&&d.rules.length>0)for(a=0;a<d.rules.length;a++){var u=d.rules[a],p=u.filterName.trim();p&&s.push(n.filterWksps(e,u.typeId,u.typeName.trim(),p,u.weight))}var m=r.getSuggestedWkspEmailSearchConfig(c,o);if(null!=m&&m.searchTerm.length>0)for(a=0;a<m.searchTerm.length;a++){var h=m.searchTerm[a];null!=h.region&&null!=h.searchTerm&&s.push(n.searchWksps(e,h.region,h.searchTerm,m.sort,m.weight))}return 0===s.length?setTimeout(function(){l.resolve({"results":[]})}):t.whenAll(s).then(function(e){var t=[],i=[];for(a=0;a<e.length;a++)null!=e[a].error?i.push(e[a].error):Array.prototype.push.apply(t,e[a].results);var n=[];for(a=0;a<t.length;a++){for(var s=t[a].data.properties,c=!1,d=0;d<n.length;d++)if(s.id===n[d].data.properties.id){n[d].data.properties.suggestedWeight+=s.suggestedWeight;var u=new Date(n[d].data.properties.modifyDate),p=new Date(s.modifyDate);p>u&&(n[d].data.properties.modifyDate=p),c=!0;break}c||n.push(t[a])}var m=function(e,t){return e.data.properties.suggestedWeight>t.data.properties.suggestedWeight?-1:e.data.properties.suggestedWeight<t.data.properties.suggestedWeight?1:new Date(e.data.properties.modifyDate)>new Date(t.data.properties.modifyDate)?-1:1};n.sort(m);var h=null!=o.general&&null!=o.general.count?o.general.count:5,g=n.slice(0,h);if(i.length>0)for(var f=0;f<i.length;f++)r.writeTrace("Error reported in retrieving suggested workspace: "+i[f]);var w=[];l.resolve({"results":g,"errors":w})},function(e){l.reject(r.getErrorMessage(e))}),l.promise()}function f(e,o,n,s,l){var a,c=t.Deferred();-999!==o?(r.writeTrace("Suggested Wksp: filter wksps with typeID '"+o+"' and name contains '"+s+"'"),a="where_workspace_type_id="+o+"&where_name=contains_"+encodeURIComponent(s)):(r.writeTrace("Suggested Wksp: filter wksps with type name '"+n+"' and name contains '"+s+"'"),a="where_workspace_type_name="+encodeURIComponent(n)+"&where_name=contains_"+encodeURIComponent(s));var d=i.combine(r.v1ToV2(e.connection.url),"businessworkspaces?expanded_view=true&"+a);return t.ajax({"url":d,"type":"GET","headers":{"OTCSTicket":e.connection.session.ticket},"success":function(e){var t=[];if(null!=e&&null!=e.results&&e.results.length>0)for(var i=0;i<e.results.length;i++){var o=e.results[i].data.properties;t.push({"data":{"properties":{"id":o.id,"name":o.name,"size":o.size,"modifyDate":o.modify_date,"suggestedWeight":l,"type":848,"container":!0}}})}c.resolve({"results":t})},"error":function(e){c.resolve({"error":"Filter: "+r.getErrorMessage(e)})}}),c.promise()}function w(e,o,n,s,l){var a=this,c=t.Deferred();r.writeTrace("Suggested Wksp: search emails with region '"+o+"' contains '"+n+"'");var d="search?where1=%22"+o+"%22:(*"+encodeURIComponent(n)+"*)&limit=50";"relevance"!==s&&(d+="&sort=desc_OTObjectDate");var u=i.combine(r.v1ToV2(e.connection.url),d);return t.ajax({"url":u,"type":"GET","headers":{"OTCSTicket":e.connection.session.ticket},"success":function(i){var o=[],n=[],s=0;if(null!=i&&null!=i.results&&i.results.length>0){for(s=0;s<i.results.length;s++){var d=i.results[s].data.properties;o.push(a.getWkspForEmail(e,d.id,d.modify_date,l))}t.whenAll(o).then(function(e){for(s=0;s<e.length;s++){var t=e[s];null!=t&&n.push(t)}c.resolve({"results":n})},function(e){c.reject(r.getErrorMessage(e))})}else c.resolve({"results":n})},"error":function(e){c.resolve({"error":"Search: "+r.getErrorMessage(e)})}}),c.promise()}function v(e,o,n,s){var l=t.Deferred(),a=i.combine(e.connection.url,"nodes/"+o+"/ancestors");return t.ajax({"url":a,"type":"GET","headers":{"OTCSTicket":e.connection.session.ticket},"success":function(e){var t=null;if(null!=e&&null!=e.ancestors&&e.ancestors.length>=2){for(var i=e.ancestors.length-2;i>=0;i--){var o=e.ancestors[i];if(848===o.type){t={"data":{"properties":{"id":o.id,"name":o.name,"size":1,"modifyDate":n,"suggestedWeight":s,"type":848,"container":!0}}};break}}l.resolve(t)}else l.resolve(null)},"error":function(e){l.reject(r.getErrorMessage(e))}}),l.promise()}function b(o){var n=t.Deferred(),s=i.combine(r.v1ToV2(o.connection.url),"businessworkspaces/outlookaddin/suggestedworkspacesconfig");return t.ajax({"url":s,"type":"GET","headers":{"OTCSTicket":o.connection.session.ticket},"success":function(t){null!=t&&null!=t.results&&"Success"===t.results.resultCode?n.resolve(t.results.config):null==t||null==t.results?n.reject(e.str.sformat(d.error_retrieve_suggestedConfig,"Null Configuration")):n.reject(e.str.sformat(d.error_retrieve_suggestedConfig,t.results.message))},"error":function(e){n.reject(r.getErrorMessage(e))}}),n.promise()}function y(o){var n=t.Deferred(),s=i.combine(r.v1ToV2(o.connection.url),"businessworkspaces/outlookaddin/simplesearchqueries");return t.ajax({"url":s,"type":"GET","headers":{"OTCSTicket":o.connection.session.ticket},"success":function(t){null!=t&&null!=t.results&&"Success"===t.results.resultCode?n.resolve(t.results.menuEntries):null==t||null==t.results?n.reject(e.str.sformat(d.error_retrieve_searchQueries,"Null Configuration")):n.reject(e.str.sformat(d.error_retrieve_searchQueries,t.results.message))},"error":function(e){n.reject(r.getErrorMessage(e))}}),n.promise()}function k(o){var n=t.Deferred(),s=i.combine(r.v1ToV2(o.connection.url),"businessworkspaces/outlookaddin/config");return t.ajax({"url":s,"type":"GET","headers":{"OTCSTicket":o.connection.session.ticket},"success":function(t){null!=t&&null!=t.results&&"Success"===t.results.resultCode?n.resolve(t.results.config):null==t||null==t.results?n.reject(e.str.sformat(d.error_retrieve_config,"Null Configuration")):n.reject(e.str.sformat(d.error_retrieve_config,t.results.message))},"error":function(t){n.reject(e.str.sformat(d.error_retrieve_config,r.getErrorMessage(t)))}}),n.promise()}function x(e,o,n,s){var l=this,a=[],r=[],c=t.Deferred(),d=i.combine(e.connection.url,"validation/nodes/names"),u=e.connection.session.ticket;if(n.checked&&(n.isEmail=!0,a.push(n)),null!=s&&s.length)for(var p=0;p<s.length;p++){var m=s[p].data;m.checked&&(m.isEmail=!1,a.push(m))}var h=t.Deferred().resolve();return t.when.apply(t,t.map(a,function(e,t){return h=h.then(function(){var t=void 0!==e.isEmail&&e.isEmail?e.suggestedName+".eml":e.suggestedName;return l.resolveName(d,u,o,t,e,r)})})).then(function(){c.resolve()},function(e){var t=Array.isArray(e)&&e.length>0?e[0]:e;c.reject(t)}),c.promise()}function C(i,o,n,s){for(var l=[],a=0;a<s.length;a++)l.push(r.escapeNameToVerify(s[a]));var c='"'+l.join('","')+'"',d=e.str.sprintf('{"parent_id":%d,"names":[%s]}',n,c);return t.ajax({"type":"POST","headers":{"Content-Type":"application/x-www-form-urlencoded","OTCSTicket":o},"url":i,"contentType":!1,"data":{"body":d}})}function _(i,o,n,s,l,a){var c,u=this,p=t.Deferred(),m=s,h=!1;if(!Array.isArray(m)&&a.length>0)for(;u.nameExists(a,m);)c=u.prepareNames(m,5,a),m=c[1],h=!0;h||(c=u.prepareNames(m,5,a));var g=u.verifyName(i,o,n,c);return g.done(function(e){if(e.results&&0===e.results.length)l.suggestedName=c[0],l.editable=h||Array.isArray(m),l.hasConflict=h||Array.isArray(m),a.push(c[0]),p.resolve();else if(e.results.length===c.length){var t=u.resolveName(i,o,n,c,l,a);t.done(function(e){p.resolve()}),t.fail(function(e){p.reject(e)})}else{for(var s=0;s<c.length;s++){for(var r=c[s],d=!1,g=0;g<e.results.length;g++){var f=e.results[g].name;if(r.toUpperCase()===f.toUpperCase()){d=!0;break}}if(!d){l.suggestedName=r,l.editable=h||0!==s,l.hasConflict=h||0!==s,a.push(r);break}}p.resolve()}}),g.fail(function(t,i){401===t.status?u.reauthenticate(d.warning_session_expired):p.reject(e.str.sformat(d.error_validate_name,r.getErrorMessage(t)))}),p.promise()}function T(e,t,i){var o=!Array.isArray(e),n=o?e:e[e.length-1],s="",l=n,a=n.lastIndexOf(".");a>=0&&(s=n.substring(a).trim(),l=n.substring(0,a));var r=/.*\((\d+)\)$/g,c=r.exec(l),d=1,u="",p=!1;null!==c&&c.length>1?(d=parseInt(c[1],10),o||d++,p=!0,u=l.substring(0,l.lastIndexOf("("))):u=l,u=u.trim();for(var m=void 0===t||t<1?5:t,h=void 0===i?[]:i,g=[],f=0;f<m;){var w;o&&!p?(w=u+s,o=!1):(w=u+" ("+d+")"+s,d++),this.nameExists(h,w)||(g.push(w),f++)}return g}function S(e,t){if(!Array.isArray(e)||0===e.length)return!1;for(var i=0;i<e.length;i++)if(t.toUpperCase()===e[i].toUpperCase())return!0;return!1}return{"save":p,"confirmSaving":m,"reauthenticate":h,"getSuggestedWksps":g,"filterWksps":f,"searchWksps":w,"getWkspForEmail":v,"getSuggestedWkspConfig":b,"getSimpleSearchQueries":y,"getAddinConfig":k,"resolveNames":x,"resolveName":_,"verifyName":C,"prepareNames":T,"nameExists":S}}),csui.define("hbs!conws/widgets/outlook/impl/dialog/impl/nameControl",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\r\n<td id="checkboxTd" class="emailSaveIconTd hiddenArea">\r\n    <button type="button" id="checkButton" role="checkbox" class="checkbox csui-control csui-checkbox" tabindex="0" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"saveLabel")||(null!=t?l(t,"saveLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"saveLabel","hash":{},"loc":{"start":{"line":3,"column":128},"end":{"line":3,"column":141}}}):s))+'">\r\n        <span class="checkboxIcon" id="checkboxIcon"></span>\r\n    </button>\r\n</td>\r\n<td id="itemIconTd" class="emailSaveIconTd hiddenArea"> \r\n    <span class="wkspItemIcon"><div id="itemIcon" title="'+e.escapeExpression((s=null!=(s=l(i,"typeName")||(null!=t?l(t,"typeName"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"typeName","hash":{},"loc":{"start":{"line":8,"column":57},"end":{"line":8,"column":69}}}):s))+'"></div></span>\r\n</td>\r\n<td class="emailSaveNameTd">\r\n    <div style="" class="wkspInput nameBox textReadonly textNoWrap" id="itemName" tabindex="-1"><span></span></div>\r\n</td>\r\n<td id="editButtonTd" class="emailSaveIconTd hiddenArea">\r\n    <span id="itemEditIcon" class="nameEdit" disabled tabindex="'+e.escapeExpression((s=null!=(s=l(i,"tabIndex")||(null!=t?l(t,"tabIndex"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"tabIndex","hash":{},"loc":{"start":{"line":14,"column":64},"end":{"line":14,"column":76}}}):s))+'"></span>\r\n</td>'}});return i.registerPartial("conws_widgets_outlook_impl_dialog_impl_nameControl",o),o}),csui.define("css!conws/widgets/outlook/impl/conwsoutlook",[],function(){}),csui.define("conws/widgets/outlook/impl/dialog/nameControl.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","csui/utils/contexts/page/page.context","csui/utils/nodesprites","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/utils/csservice","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/dialog/impl/nameControl","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,o,n,s,l,a,r,c){return i.CompositeView.extend({"tagName":"tr","template":c,"ui":{},"events":{"click #saveSelectionBack":"backToPreSave","click #itemEditIcon":"toggleEdit","click #checkButton":"clickCheckbox","keyup #itemName":"nameTyping","blur #itemName":"ensureName","keyup #itemEditIcon":"processKey"},"templateHelpers":function(){return{"iconClass":this.mimeType,"tabIndex":this.checked?"0":"-1","saveLabel":r.save_label}},"initialize":function(e){},"constructor":function(e){i.CompositeView.prototype.constructor.call(this,e);var t=this,o=null!=e.model?e.model.get("data"):e.data;if(null!=o){this.showOriginalName=null!=o.showOriginalName&&o.showOriginalName,this.hasConflict=null!=o.hasConflict&&o.hasConflict;var n="";n=this.showOriginalName&&this.hasConflict?o.name?o.name:r.name_untitled:o.suggestedName?o.suggestedName:o.name?o.name:r.name_untitled,this.name=n,this.showCheckbox=null==o.showCheckbox||o.showCheckbox,this.checkboxDisabled=null!=o.checkboxDisabled&&o.checkboxDisabled,this.checked=null!=o.checked&&o.checked,this.showEditButton=null==o.showEditButton||o.showEditButton,this.editable=!!this.showEditButton&&(null!=o.editable&&o.editable),this.showIcon=null==o.showIcon||o.showIcon,this.mimeType=o.mimeType?o.mimeType:"",this.wrapping=null!=o.wrapping&&o.wrapping,this.focus=this.editable&&null!=o.hasConflict&&o.hasConflict,this.avoidHighlight=null!=o.avoidHighlight&&o.avoidHighlight}t.renderForm()},"processKey":function(e){13!==e.which&&32!==e.which||"itemEditIcon"===e.target.id&&this.toggleEdit(e)},"renderMessage":function(e){var t=this,i=t.$("#saveMsgArea");e?(i.css("display","block"),i.html(e)):i.css("display","none")},"renderForm":function(e,t,i){var o=this;setTimeout(function(){if(o.$("#itemName").text(o.name),o.showCheckbox&&o.$("#checkboxTd").removeClass("hiddenArea"),o.editable&&(o.$("#editButtonTd").removeClass("hiddenArea"),o.switchEditMode(!0,o.focus)),o.checked&&(o.$("#checkboxIcon").addClass("checkboxSelected"),o.$("#itemEditIcon").removeAttr("disabled")),o.checkboxDisabled&&(o.$("#checkboxIcon").removeClass("checkboxSelected"),o.$("#checkboxIcon").addClass("checkboxDisabled")),o.showEditButton&&o.$("#editButtonTd").removeClass("hiddenArea"),o.showIcon){o.$("#itemIconTd").removeClass("hiddenArea");var e="icon "+s.findClassByNode({"mime_type":o.mimeType});o.$("#itemIcon").addClass(e)}if(o.wrapping){var t=o.$("#itemName");t.removeClass("textNoWrap"),t[0].style.height=t[0].scrollHeight+"px"}})},"renderError":function(e,t,i){var o=this,n=e.get("error");n||(n="object"!=typeof t?JSON.parse(t).error:t.responseJSON?t.responseJSON.error:t.error),o.renderMessage(n)},"toggleEdit":function(e){var t=this,i=e.target.classList.contains("editCancelIcon")
;t.switchEditMode(!i,!0),t.avoidHighlight=!1},"switchEditMode":function(e,t){var i=this,o=i.$("#itemName");e?(i.$("#itemEditIcon").addClass("editCancelIcon"),o.removeClass("textReadonly"),o.prop("contenteditable",!0),o.attr("tabindex","0"),o.removeClass("textNoWrap"),setTimeout(function(){o[0].scrollHeight>=30&&(o[0].style.height=o[0].scrollHeight+"px")}),t&&setTimeout(function(){i.highlightName()})):(i.$("#itemEditIcon").removeClass("editCancelIcon"),o.addClass("textReadonly"),o.prop("contenteditable",!1),o.attr("tabindex","-1"),i.wrapping||(o.addClass("textNoWrap"),o[0].style.removeProperty("height")))},"clickCheckbox":function(e){var t=this,i=t.$("#checkboxIcon"),o=t.$("#itemEditIcon");if(!i.hasClass("checkboxDisabled")){var n=i.hasClass("checkboxSelected"),s="-1",l=t.$("#itemName");n?(i.removeClass("checkboxSelected"),o.attr("disabled","disabled"),o.removeClass("editCancelIcon"),l.addClass("textReadonly"),l.prop("contenteditable",!1),t.wrapping||(l.addClass("textNoWrap"),l[0].style.removeProperty("height"))):(i.addClass("checkboxSelected"),o.removeAttr("disabled"),s="0"),o.attr("tabindex",s)}},"nameTyping":function(e){var t=this.$("#itemName");if(0!==t.length&&!t.hasClass("textReadonly")){var i=t[0];i.scrollHeight>=30&&(i.style.height="1px",i.style.height=i.scrollHeight+"px")}},"ensureName":function(e){var t=this;t.$("#itemName").text().trim()||t.$("#itemName").text(r.name_untitled)},"backToPreSave":function(e){l.uiShow(l.PreSaveSection),"standardSections"===l.PreSaveSection&&l.uiShow("customSearchButton"),l.uiHide("saveSelectionPanel"),l.uiHide("savePanel")},"backToStandard":function(e){l.uiShow("standardSections"),l.uiShow("customSearchButton"),l.uiHide("customSearchSection")},"highlightName":function(){var e=this,t=e.$("#itemName")[0];if(!e.avoidHighlight){t.focus();var i;document.selection?(i=document.body.createTextRange(),i.moveToElementText(t),i.select()):window.getSelection&&(i=document.createRange(),i.selectNodeContents(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(i))}}})}),csui.define("conws/widgets/outlook/impl/metadata/impl/metadata.forms.factory",["module","csui/lib/underscore","csui/lib/backbone","csui/utils/contexts/factories/factory","csui/widgets/metadata/metadata.forms","csui/utils/contexts/factories/connector"],function(e,t,i,o,n,s){return o.extend({"propertyPrefix":"createForm","widgetID":"","constructor":function(l,a){a||(a={}),o.prototype.constructor.apply(this,arguments);var r={};if(!(r instanceof i.Collection)){var c=l.getObject(s,a),d=e.config();r=new n(r.models,t.extend({"connector":c,"action":"create","container":a.container,"node":a.node,"autoreset":!0},r.options,d.options))}this.property=r},"fetch":function(e){return this.property.fetch(this.options)}})}),csui.define("hbs!conws/widgets/outlook/impl/metadata/impl/form.item",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="binf-panel-heading outlook-heading hiddenArea" title="'+e.escapeExpression((s=null!=(s=l(i,"title")||(null!=t?l(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":1,"column":66},"end":{"line":1,"column":75}}}):s))+'" id="propertyTitle">\r\n    <span class="headerIcon sectionToggleIcon" id="toggleIcon" tabindex="0" title="'+e.escapeExpression((s=null!=(s=l(i,"title")||(null!=t?l(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":2,"column":83},"end":{"line":2,"column":92}}}):s))+'"></span>\r\n    <span>'+e.escapeExpression((s=null!=(s=l(i,"title")||(null!=t?l(t,"title"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"title","hash":{},"loc":{"start":{"line":3,"column":10},"end":{"line":3,"column":19}}}):s))+'</span>\r\n</div>\r\n<div id="propertyForm" class="metadata-formitems"></div>'}});return i.registerPartial("conws_widgets_outlook_impl_metadata_impl_form.item",o),o}),csui.define("conws/widgets/outlook/impl/metadata/form.item.view",["csui/lib/marionette","csui/lib/underscore","csui/lib/jquery","csui/controls/form/form.view","conws/widgets/outlook/impl/utils/utility","hbs!conws/widgets/outlook/impl/metadata/impl/form.item"],function(e,t,i,o,n,s){return e.ItemView.extend({"tag":"div","className":"customsearch-attr-container","events":{"click #toggleIcon":"clickToggle","keyup #toggleIcon":"processKeyUp"},"templateHelpers":function(){var e=this.model.get("role_name"),t=this.model.get("title"),i=this.model.get("id");return{"title":"categories"===e?t:i,"toggleStatus":this.expended?n.ToggleStatusCollapse:n.ToggleStatusExpand}},"constructor":function(t){t||(t={}),this.options=t,e.ItemView.prototype.constructor.apply(this,arguments),this.model.on("error",this.errorHandle,this),this.options.hideNotRequired=t.hideNotRequired||!1,this.expended=!0},"template":s,"onRender":function(t){var i=new e.Region({"el":this.$el.find(".metadata-formitems")}),n=new o({"context":this.options.context,"model":this.model,"layoutMode":"singleCol","mode":"create","node":this.model.node,"templateId":this.model.attributes.data.templateId});i.show(n),n.hideNotRequired(this.options.hideNotRequired),this.options.hideNotRequired&&!this.options.hasRequiredField?this.$("#propertyTitle").addClass("hiddenArea"):this.$("#propertyTitle").removeClass("hiddenArea"),1===this.options.requiredFormCount&&this.$("#toggleIcon").css("display","none"),this.formView=n},"onRenderForm":function(){this.options.objectView.triggerMethod("render:form")},"switchToHide":function(e){this.formView.hideNotRequired(e),e&&!this.options.hasRequiredField?this.$("#propertyTitle").addClass("hiddenArea"):this.$("#propertyTitle").removeClass("hiddenArea")},"clickToggle":function(e){this.$("#toggleIcon").toggleClass("sectionExpended"),this.expended?(this.$("#propertyForm").addClass("hiddenArea"),this.expended=!1):(this.$("#propertyForm").removeClass("hiddenArea"),this.expended=!0)},"processKeyUp":function(e){13===e.which&&"toggleIcon"===e.target.id&&this.clickToggle(e)}})}),csui.define("hbs!conws/widgets/outlook/impl/metadata/impl/metadata.forms",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="csui-saved-search-form" id="metadata-forms"></div>\r\n<div class="header-right">\r\n    <div class="required-field-switch">\r\n        <span id="requiredFieldsLabelId" class="only-required-fields-label"\r\n              aria-label="'+e.escapeExpression((s=null!=(s=l(i,"requiredFieldsSwitchTitle")||(null!=t?l(t,"requiredFieldsSwitchTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"requiredFieldsSwitchTitle","hash":{},"loc":{"start":{"line":5,"column":26},"end":{"line":5,"column":55}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"requiredFieldsSwitchTitle")||(null!=t?l(t,"requiredFieldsSwitchTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"requiredFieldsSwitchTitle","hash":{},"loc":{"start":{"line":5,"column":57},"end":{"line":5,"column":86}}}):s))+'</span>\r\n              <div id="required-fields-switch" class="required-fields-switch"></div>\r\n    </div>\r\n</div>\r\n\r\n'}});return i.registerPartial("conws_widgets_outlook_impl_metadata_impl_metadata.forms",o),o}),csui.define("conws/widgets/outlook/impl/metadata/metadata.forms.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","csui/lib/jsonpath","csui/controls/tile/behaviors/blocking.behavior","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/utils/contexts/factories/node","csui/utils/contexts/page/page.context","csui/controls/form/fields/booleanfield.view","conws/widgets/outlook/impl/metadata/impl/metadata.forms.factory","conws/widgets/outlook/impl/metadata/form.item.view","conws/widgets/outlook/impl/utils/utility","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/metadata/impl/metadata.forms"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h){return i.LayoutView.extend({"className":"csui-custom-view-search","templateHelpers":function(){return{"requiredFieldsTitle":m.required_fields_title,"requiredFieldsSwitchTitle":m.required_fields_switchLabel}},"behaviors":{"Blocking":{"behaviorClass":s},"PerfectScrolling":{"behaviorClass":l,"contentParent":".csui-saved-search-form","scrollYMarginOffset":15}},"regions":{"requiredSwitchRegion":"#required-fields-switch"},"constructor":function(t){t=t||{},t.data||(t.data={}),this.context=t.context||new r,this.parentView=t.parentView,i.LayoutView.prototype.constructor.apply(this,arguments),t.container=this.context.getModel(a,{"attributes":{"id":t.parentId},"connector":p.getConnector()}),t.node=this.context.getModel(a,{"attributes":{"type":144,"docParentId":t.parentId,"parent_id":t.parentId},"connector":p.getConnector()}),this.model=this.context.getCollection(d,t),this.options.context=this.context,this.listenTo(this.model,"sync",this.renderForms),this.categoryChecked=!1,this.hasRequired=!1,this.requiredFormCount=0,this.requiredFieldSwitchModel=new o.Model({"data":!1}),this.$el.on({"change input":e.bind(this._refreshDOM,this)}),this.model.fetch()},"_refreshDOM":function(){setTimeout(e.bind(function(){this.triggerMethod("dom:refresh")},this),500)},"template":h,"renderForms":function(t){var i=this;if(i.model.length>0){i.checkRequired(i.model.models),i.formViews=[];for(var o,n=0;n<i.model.length;n++){var s=i.model.models[n];"general"!==s.id&&("categories"===s.get("role_name")?i.hasRequired&&(o=new u(e.extend(i.options,{"model":s,"hideNotRequired":!1,"hasRequiredField":s.attributes.hasRequiredField,"requiredFormCount":i.requiredFormCount})),i.formViews.push(o),i.appendView("view"+n,o)):s.attributes.hasRequiredField&&(o=new u(e.extend(i.options,{"model":s,"hideNotRequired":!1,"hasRequiredField":!0,"requiredFormCount":i.requiredFormCount})),i.formViews.push(o),i.appendView("view"+n,o)))}i.hasRequired&&(i.requiredFieldSwitchView=new c({"mode":"writeonly","model":i.requiredFieldSwitchModel,"labelId":"requiredFieldsLabelId"}),i.getRegion("requiredSwitchRegion").show(i.requiredFieldSwitchView),i.listenTo(i.requiredFieldSwitchView,"field:changed",function(e){i.toggleRequiredFields(e.fieldvalue)})),i.parentView.metadataFormRetrieved=!0,i.parentView.model.set("hasRequired",i.hasRequired),i.parentView.processMetadata()}},"checkRequired":function(t){var i=this,o=0;if(!i.categoryChecked){i.categoryChecked=!0;for(var s=0;s<t.length;s++){var l=t[s];if("general"!==l.id){"categories"===l.get("role_name")&&o++,l.attributes.hasRequiredField=!1;var a=n(l.attributes.schema.properties,"$..[?(@.required===true)]");e.isArray(a)&&a.length>0&&(i.hasRequired=!0,l.attributes.hasRequiredField=!0,"categories"!==l.get("role_name")&&i.requiredFormCount++)}}i.hasRequired&&(i.requiredFormCount=i.requiredFormCount+o)}},"toggleRequiredFields":function(t){e.each(this.formViews,function(e){e.switchToHide(t)})},"getValuesToParent":function(t){var i=!0,o={"roles":{"categories":{}}};return e.each(this.formViews,function(e){if(!e.formView.validate())return void(i=!1);var t=e.formView.model.get("role_name");"categories"===t?o.roles.categories[e.formView.model.id]=e.formView.getValues():o.roles[t]=e.formView.getValues()}),i&&(this.parentView.metadataValue=o),i},"appendView":function(e,t){var i=this;i.$el.append('<div id="view'+e+'">'),i.addRegion("view"+e,"#view"+e),i["view"+e].show(t)}})}),csui.define("hbs!conws/widgets/outlook/impl/dialog/impl/saveSection",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div id="saveDisplayArea" class="saveDisplayArea">\r\n    <div id="saveSelectionPanel" class="hiddenArea">\r\n        <div class="binf-panel-heading outlook-heading" >\r\n            <span class="headerIcon backwardIcon" tabindex="0" id="saveSectionBack" title="'+e.escapeExpression((s=null!=(s=l(i,"backLabel")||(null!=t?l(t,"backLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"backLabel","hash":{},"loc":{"start":{"line":4,"column":91},"end":{"line":4,"column":104}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"backLabel")||(null!=t?l(t,"backLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"backLabel","hash":{},"loc":{"start":{"line":4,"column":118},"end":{"line":4,"column":131}}}):s))+'"></span>\r\n            <span id="saveSectionTitle"></span>\r\n        </div>\r\n        <div class="infoMessage">'+e.escapeExpression((s=null!=(s=l(i,"saveInfo")||(null!=t?l(t,"saveInfo"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"saveInfo","hash":{},"loc":{"start":{"line":7,"column":33},"end":{"line":7,"column":45}}}):s))+'</div>\r\n        \r\n        <div id="saveMessageArea" class="hiddenArea warningMessage">\r\n            <span class="headerIcon warningIcon"></span>\r\n            <span id="saveMessage" style="display: table;"></span>\r\n        </div>\r\n        \r\n        <div id="saveEmailDiv" style="padding: 5px 5px 5px 30px;">\r\n            <div style="padding: 5px 0 5px 0">'+e.escapeExpression((s=null!=(s=l(i,"saveEmailText")||(null!=t?l(t,"saveEmailText"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"saveEmailText","hash":{},"loc":{"start":{"line":15,"column":46},"end":{"line":15,"column":63}}}):s))+'</div>\r\n            <table style="width:100%;">\r\n                <tr>\r\n                    <td class="emailSaveNameTd" style="padding: 0;">\r\n                        <table id="emailName" class="emailSaveTable"></table>\r\n                    </td>\r\n                </tr>\r\n            </table>\r\n            \r\n        </div>\r\n        <div id="saveAttachmentDiv" style="padding: 10px 5px 5px 30px;">\r\n            <div style="padding: 5px 0 5px 0">'+e.escapeExpression((s=null!=(s=l(i,"saveAttachmentText")||(null!=t?l(t,"saveAttachmentText"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"saveAttachmentText","hash":{},"loc":{"start":{"line":26,"column":46},"end":{"line":26,"column":68}}}):s))+'</div>\r\n            <table style="width:100%;">\r\n                <tr id="attachmentOptionTr">\r\n                    <td class="emailSaveIconTd">\r\n                        <button type="button" id="saveAttachmentCheckbox" role="checkbox" class="checkbox csui-control csui-checkbox" tabindex="0" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"saveLabel")||(null!=t?l(t,"saveLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"saveLabel","hash":{},"loc":{"start":{"line":30,"column":159},"end":{"line":30,"column":172}}}):s))+'">\r\n                            <span class="checkboxIcon" id="saveAttachmentCheckboxIcon"></span>\r\n                        </button>\r\n                    </td>\r\n                    <td class="emailSaveNameTd"> \r\n                        <span style="padding: 0 0 0 8px;">'+e.escapeExpression((s=null!=(s=l(i,"saveAttachmentOption")||(null!=t?l(t,"saveAttachmentOption"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"saveAttachmentOption","hash":{},"loc":{"start":{"line":35,"column":58},"end":{"line":35,"column":82}}}):s))+'</span>\r\n                    </td>\r\n                </tr>\r\n                <tr>\r\n                    <td colspan="2" class="emailSaveNameTd" style="padding: 10px 3px 5px 0;">\r\n                        <table id="emailAttachment" class="emailSaveTable"></table>\r\n                    </td>\r\n                </tr>\r\n            </table>\r\n        </div>\r\n\r\n    </div>\r\n\r\n    <div id="metadataPanel" class="hiddenArea metadataForm">\r\n        <div class="binf-panel-heading outlook-heading" >\r\n            <span class="headerIcon backwardIcon" tabindex="0" id="metadataFormBack" title="'+e.escapeExpression((s=null!=(s=l(i,"backLabel")||(null!=t?l(t,"backLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"backLabel","hash":{},"loc":{"start":{"line":50,"column":92},"end":{"line":50,"column":105}}}):s))+'" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"backLabel")||(null!=t?l(t,"backLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"backLabel","hash":{},"loc":{"start":{"line":50,"column":119},"end":{"line":50,"column":132}}}):s))+'"></span>\r\n            <span>'+e.escapeExpression((s=null!=(s=l(i,"requiredFieldsTitle")||(null!=t?l(t,"requiredFieldsTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"requiredFieldsTitle","hash":{},"loc":{"start":{"line":51,"column":18},"end":{"line":51,"column":41}}}):s))+'</span>\r\n        </div>\r\n        <div class="infoMessage">'+e.escapeExpression((s=null!=(s=l(i,"saveInfo")||(null!=t?l(t,"saveInfo"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"saveInfo","hash":{},"loc":{"start":{"line":53,"column":33},"end":{"line":53,"column":45}}}):s))+'</div>\r\n        <div id="metadataMessageArea" class="hiddenArea warningMessage">\r\n            <span class="headerIcon warningIcon"></span>\r\n            <span id="metadataMessage" style="display: table;"></span>\r\n        </div>\r\n        <div id="metadataDiv"></div>\r\n    </div>\r\n\r\n    <div id="saveResultPanel" class="hiddenArea">\r\n        <div class="binf-panel-heading outlook-heading" >\r\n            <span id="saveResultTitle"></span>\r\n        </div>    \r\n        <div id="saveResult" style="position:relative; padding: 0 25px 0 25px; line-height: 150%"></div>\r\n    </div>\r\n\r\n    <div class="wkspMessageArea" id="saveMsgArea"></div>\r\n</div>\r\n<div class="saveSectionButton outlook-heading binf-panel-heading" id="saveNextButton" tabindex="0"></div>\r\n\r\n\r\n'}});return i.registerPartial("conws_widgets_outlook_impl_dialog_impl_saveSection",o),o}),csui.define("conws/widgets/outlook/impl/dialog/saveSection.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette3","csui/lib/backbone","csui/utils/contexts/page/page.context","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/utils/csservice","conws/widgets/outlook/impl/utils/emailservice","conws/widgets/outlook/impl/dialog/nameControl.view","conws/widgets/outlook/impl/metadata/metadata.forms.view","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/dialog/impl/saveSection","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,o,n,s,l,a,r,c,d,u){return i.CompositeView.extend({"template":u,"childView":r,"childEvents":{"change:status":"onStatusChange"},"childViewContainer":"#emailAttachment","events":{"click #saveSectionBack":"clickBack","click #saveEmailDiv #checkButton":"clickSaveEmail","click #saveAttachmentCheckbox":"clickSaveAttachment","click #saveAttachmentDiv #checkButton":"clickOneAttachment","click #saveNextButton":"clickNext","keyup #saveSectionBack, #saveNextButton, #metadataFormBack":"processKey","click #metadataFormBack":"clickMetadataBack"},"templateContext":function(){return{"saveEmailText":this.hasAttachment?d.save_email_text:d.save_email_text_noAttachment,"saveAttachmentText":d.save_attachment_text,"saveAttachmentOption":d.save_attachment_option,"saveInfo":t.str.sformat(d.save_email_info,this.folderName),"requiredFieldsTitle":d.required_fields_title,"saveLabel":d.save_label,"backLabel":d.save_button_back}},"initialize":function(e){this.stageCode={"initial":1,"nameChecking":2,"metadata":3,"finished":4},this.model=new o.Model({})},"constructor":function(e){i.CompositeView.prototype.constructor.call(this,e);var t=this;t.connector=e.connector,t.folderId=e.folderId,t.folderName=e.folderName,t.saveStage=t.stageCode.initial,t.saveEmail=!0,t.nothingToSave=!1,t.hasAttachment=null!=e.attachments&&e.attachments.length>0,t.attachments=e.attachments,t.emailTitleInfo={"name":e.proposedEmailName,"showCheckbox":t.hasAttachment,"checkboxDisabled":!1,"editable":!1,"hasConflict":!1,"focus":!1},t.attachmentInfo=[],null!=t.attachments&&t.attachments.forEach(function(e){t.attachmentInfo.push({"data":{"name":e.name,"id":e.id,"mimeType":e.contentType,"attachmentType":e.attachmentType,"checked":!1,"focus":!1,"hasConflict":!1}})}),t.metadataFormView=null,t.metadataFormRetrieved=!1,t.hasRequiredMetadata=!1,t.requiredMetadataResolved=!1,t.metadataValue={},t.previousStage=t.stageCode.initial,t.saveFailed=!1,t.saveMessage="",t.hasAttachment&&(t.collection=new o.Collection(t.attachmentInfo)),t.renderForm()},"processKey":function(e){13!==e.which&&32!==e.which||("saveSectionBack"===e.target.id?this.clickBack(e):"saveNextButton"===e.target.id?this.clickNext(e):"metadataFormBack"===e.target.id&&this.clickMetadataBack(e))},"renderMessage":function(e){var t=this,i=t.$("#saveMsgArea");e?(i.css("display","block"),i.html(e)):i.css("display","none")},"onStatusChange":function(e,t,i){this.render()},"renderForm":function(t,o,n){var l=this;l.renderChildren(),l.saveStage===l.stageCode.initial&&(s.ConflictHighlighted=!1),setTimeout(function(){e("#saveDisplayArea").css("height","calc(100vh - "+(36+s.TraceAreaHeight)+"px)"),e("#saveResult").css("top","calc(40vh - "+(36+s.TraceAreaHeight/2)+"px)");var t=new i.Region({"el":"#emailName"}),o="";if(l.saveStage===l.stageCode.initial)o=l.emailTitleInfo.name;else{var n=l.emailTitleInfo.suggestedName.lastIndexOf(".eml");o=n>0?l.emailTitleInfo.suggestedName.substring(0,n):l.emailTitleInfo.suggestedName}t.show(new r({"data":{"context":l.context,"name":l.emailTitleInfo.name,"suggestedName":o,"showIcon":!1,"showCheckbox":l.hasAttachment,"checkboxDisabled":!l.hasAttachment,"checked":l.saveEmail,"wrapping":!0,"showOriginalName":l.emailTitleInfo.showOriginalName,"hasConflict":l.emailTitleInfo.hasConflict,"editable":l.emailTitleInfo.editable,"focus":l.emailTitleInfo.focus}})),s.uiShow("saveSelectionPanel"),l.$("#saveNextButton").text(d.save_button_next),l.saveStage===l.stageCode.initial?(s.uiHide(s.PreSaveSection),"standardSections"===s.PreSaveSection&&s.uiHide("customSearchButton"),s.uiShow("savePanel"),s.uiShow("saveSelectionPanel"),l.$("#saveSectionTitle").text(d.title_save_email),s.uiHide("metadataPanel"),s.uiHide("saveMessageArea")):l.saveStage===l.stageCode.nameChecking?(l.$("#saveSectionTitle").text(d.save_selection_conflict),s.uiShow("saveMessageArea"),l.$("#saveMessage").html(d.save_selection_conflict_msg)):l.saveStage===l.stageCode.metadata?(l.$("#saveSectionTitle").text(d.required_fields_title),s.uiShow("metadataPanel"),s.uiHide("saveSelectionPanel"),s.uiHide("saveResultPanel")):l.saveStage===l.stageCode.finished&&(s.uiHide("saveSelectionPanel"),s.uiHide("metadataPanel"),s.uiShow("saveResultPanel"),l.$("#saveNextButton").text(d.save_button_close),l.$("#saveResult").text(l.saveMessage),l.$("#saveResultTitle").text(l.saveTitle));for(var a=0,c=0;c<l.attachmentInfo.length;c++){var u=l.attachmentInfo[c].data;if(0===c)a=u.checked?1:0;else if(u.checked&&0===a||!u.checked&&1===a){a=2;break}}l.$("#saveAttachmentCheckboxIcon").removeClass("checkboxSelected checkboxMixed");var p=1===a?"checkboxSelected":2===a?"checkboxMixed":"";l.$("#saveAttachmentCheckboxIcon").addClass(p),l.hasAttachment?1===l.attachments.length&&s.uiHide("attachmentOptionTr"):s.uiHide("saveAttachmentDiv"),l.nothingToSave&&(s.uiShow("saveMessageArea"),l.$("#saveNextButton").addClass("buttonDisabled"),l.$("#saveMessage").html(d.save_noSelection))})},"renderError":function(e,t,i){var o=this,n=e.get("error");n||(n="object"!=typeof t?JSON.parse(t).error:t.responseJSON?t.responseJSON.error:t.error),o.renderMessage(n)},"clickBack":function(t){var i=this;if(i.saveStage===i.stageCode.initial)s.uiShow(s.PreSaveSection),"standardSections"===s.PreSaveSection&&s.uiShow("customSearchButton"),s.uiHide("saveSelectionPanel"),s.uiHide("savePanel"),window.scrollTo(0,s.ScorllPositionBeforeSaving),s.ScorllPositionBeforeSaving=-1;else if(i.saveStage===i.stageCode.nameChecking){i.emailTitleInfo.showOriginalName=!0,i.emailTitleInfo.editable=!1;for(var o=0;o<i.attachmentInfo.length;o++){var n=i.attachmentInfo[o].data;n.showOriginalName=!0,n.editable=!1}i.saveStage=i.stageCode.initial,i.renderForm()}else i.saveStage===i.stageCode.metadata&&(i.saveStage=i.previousStage,i.renderForm());e("#conwsoutlook-body").focus()},"backToStandard":function(e){s.uiShow("standardSections"),s.uiShow("customSearchButton"),s.uiHide("customSearchSection")},"clickMetadataBack":function(e){s.uiShow("saveSelectionPanel"),s.uiHide("metadataPanel"),this.saveStage=this.previousStage,this.$("#saveSectionBack").focus()},"clickSaveAttachment":function(t){var i=this,o=i.$("#saveAttachmentCheckboxIcon"),n=o.hasClass("checkboxSelected");o.removeClass("checkboxMixed"),n?o.removeClass("checkboxSelected"):(o.addClass("checkboxSelected"),i.$("#saveNextButton").hasClass("buttonDisabled")&&(i.$("#saveNextButton").removeClass("buttonDisabled"),s.uiHide("saveMessageArea"))),i.$("#saveAttachmentDiv #checkboxIcon").each(function(t,i){n?e(i).removeClass("checkboxSelected"):e(i).addClass("checkboxSelected")}),i.$("#saveAttachmentDiv #itemEditIcon").each(function(t,i){n?(e(i).attr("disabled","disabled"),e(i).removeClass("editCancelIcon"),e(i).attr("tabindex","-1")):(e(i).removeAttr("disabled"),e(i).attr("tabindex","0"))}),i.$("#saveAttachmentDiv #itemName").each(function(t,i){n&&(e(i).addClass("textReadonly"),e(i).prop("contenteditable",!1),e(i).addClass("textNoWrap"),i.style.removeProperty("height"))})},"clickOneAttachment":function(e){var t=this,i=e.target;"checkButton"===e.target.id&&(i=e.target.querySelector("span"));var o=t.$("#saveAttachmentCheckboxIcon"),n=t.$("#saveAttachmentDiv #checkboxIcon"),l=!!i.classList.contains("checkboxSelected"),a=!1;n.each(function(e,t){if(t!==i&&t.classList.contains("checkboxSelected")!==l)return a=!0,!1}),a?(o.removeClass("checkboxSelected"),o.addClass("checkboxMixed")):(o.removeClass("checkboxMixed"),l?o.addClass("checkboxSelected"):o.removeClass("checkboxSelected")),l&&t.$("#saveNextButton").hasClass("buttonDisabled")&&(t.$("#saveNextButton").removeClass("buttonDisabled"),s.uiHide("saveMessageArea"))},"clickSaveEmail":function(e){var t=this;!t.$("#saveEmailDiv #checkButton").hasClass("checkboxSelected")&&t.$("#saveNextButton").hasClass("buttonDisabled")&&(t.$("#saveNextButton").removeClass("buttonDisabled"),s.uiHide("saveMessageArea"))},"clickNext":function(t){var o=this;if(!o.$("#saveNextButton").hasClass("buttonDisabled")){if(o.saveStage===o.stageCode.initial||o.saveStage===o.stageCode.nameChecking)if(o.previousStage=o.saveStage,o.collectInfo(),o.nothingToSave)o.renderForm();else{s.startGlobalSpinner(),o.saveStage=o.stageCode.nameChecking;var n=l.resolveNames(o.connector,o.folderId,o.emailTitleInfo,o.attachmentInfo);n.done(function(e){var t=!0;o.savingEmailName=o.emailTitleInfo.checked?o.emailTitleInfo.suggestedName:"",o.savingAttachments=[],o.emailTitleInfo.hasConflict&&(t=!1);for(var n=0;n<o.attachmentInfo.length;n++){var l=o.attachmentInfo[n].data;t||(l.avoidHighlight=!0),l.hasConflict&&(t=!1),l.checked&&o.savingAttachments.push({"name":l.suggestedName,"id":l.id,"mimeType":l.mimeType})}if(t){o.saveStage=o.stageCode.metadata;var a=new i.Region({"el":"#metadataDiv"});o.metadataFormRetrieved?o.hasRequiredMetadata?(s.uiHide("saveSelectionPanel"),s.uiShow("metadataPanel"),s.stopGlobalSpinner()):o.processMetadata():(o.metadataFormView=new c({"parentId":o.folderId,"parentView":o}),a.show(o.metadataFormView))}else s.stopGlobalSpinner(),o.renderForm()}),n.fail(function(e){o.saveStage=o.stageCode.finished,o.saveFailed=!0,o.saveMessage=s.getErrorMessage(e),o.saveTitle=d.title_save_error,s.stopGlobalSpinner(),o.renderForm()})}else if(o.saveStage===o.stageCode.metadata){var r=o.metadataFormView.getValuesToParent();r?(s.startGlobalSpinner(),s.uiHide("metadataMessageArea"),o.processSave()):(s.uiShow("metadataMessageArea"),o.$("#metadataMessage").html(d.save_metadate_form_invalid))}else o.saveStage===o.stageCode.finished&&(s.SavingSubmitted=!1,s.EmailChangedAfterSaving?a.emailItemChanged({}):(s.uiShow(s.PreSaveSection),"standardSections"===s.PreSaveSection&&s.uiShow("customSearchButton"),s.uiHide("savePanel"),window.scrollTo(0,s.ScorllPositionBeforeSaving),s.ScorllPositionBeforeSaving=-1));e("#conwsoutlook-body").focus()}},"processMetadata":function(){var e=this;if(e.hasRequiredMetadata=e.model.get("hasRequired")||!1,!e.metadataFormRetrieved&&!e.hasRequiredMetadata)return void(e.metadataFormRetrieved=!0);e.metadataFormRetrieved=!0,e.hasRequiredMetadata?(s.stopGlobalSpinner(),s.uiHide("saveSelectionPanel"),s.uiShow("metadataPanel")):e.processSave()},"processSave":function(){var e=this;e.saveStage=e.stageCode.finished,s.SavingSubmitted=!0;var t=l.save(e.connector,e.folderId,e.savingEmailName,e.savingAttachments,e.metadataValue);t.done(function(t){e.saveFailed=!1,e.saveMessage=t.result,e.saveTitle=d.title_save_success,s.stopGlobalSpinner(),e.renderForm()}),t.fail(function(t){e.saveFailed=!0,e.saveMessage=t.errorMsg,e.saveTitle=d.title_save_error,s.stopGlobalSpinner(),e.renderForm()})},"collectInfo":function(){var e=this;e.nothingToSave=!0,e.emailTitleInfo.suggestedName=s.escapeNameToCreate(e.$("#emailName #itemName").text().trim()),e.emailTitleInfo.showOriginalName=!1,e.saveEmail=e.$("#saveEmailDiv #checkboxIcon").hasClass("checkboxSelected")||e.$("#saveEmailDiv #checkboxIcon").hasClass("checkboxDisabled"),e.emailTitleInfo.checked=e.saveEmail,e.saveEmail?e.nothingToSave=!1:(e.emailTitleInfo.editable=!1,e.emailTitleInfo.hasConflict=!1,e.emailTitleInfo.focus=!1);for(var t=e.$("#saveAttachmentDiv #checkboxIcon"),i=e.$("#saveAttachmentDiv #itemName"),o=0;o<e.attachmentInfo.length;o++){var n=e.attachmentInfo[o].data;n.checked=t.eq(o).hasClass("checkboxSelected"),e.nothingToSave&&n.checked&&(e.nothingToSave=!1),n.suggestedName=s.escapeNameToCreate(i.eq(o).text().trim()),n.editable=!i.eq(o).hasClass("textReadonly"),n.showOriginalName=!1,n.avoidHighlight=!1,n.hasConflict=!1}}})}),csui.define("conws/widgets/outlook/impl/folder/item.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/url","csui/dialogs/modal.alert/modal.alert","csui/utils/nodesprites","conws/widgets/outlook/impl/utils/emailservice","hbs!conws/widgets/outlook/impl/folder/impl/item","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/dialog/saveSection.view","i18n!conws/widgets/outlook/impl/nls/lang","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,o,n,s,l,a,r,c,d,u){return o.LayoutView.extend({"className":"FolderItem","template":r,"templateHelpers":function(){return{"serverOrigin":window.ServerOrigin,"supportFolder":window.ContentServerSupportPath,"iconClass":this.iconClass,"id":this.id,"name":this.name,"typeName":this.typeName,"toggleStatus":this.hasChild?c.ToggleStatusExpand:c.ToggleStatusEmpty,"tabIndex":this.hasChild?"0":"-1","saveTitle":this.isEdit?u.insert_action:u.title_save_email,"actionIcon":this.isEdit?"copyLink":"emailSaveIcon"}},"regions":{"subFolders":"#subFolders"},"ui":{"$actionBar":".wkspFolder-actiondiv","$toggleIcon":"#toggleIcon"},"events":{"click .listItemFolder":"clickFolder","mouseenter #wkspFolderItem":"showActionBar","mouseleave #wkspFolderItem":"hideActionBar","click #saveEmailButton":"saveEmail","focusin #saveEmailButton":"buttonFocused","focusout #saveEmailButton, #folderNameDiv":"buttonFocusOut",
"keyup #toggleIcon, #folderNameDiv, #saveEmailButton":"processKeyUp","keydown #folderNameDiv, #saveEmailButton":"processKeyDown"},"initialize":function(e){this.listenTo(this.model,"change",this.renderToggleIcon)},"constructor":function(e){this.model=e.model,this.name=e.model.get("data").properties.name,this.id=e.model.get("data").properties.id,this.type=e.model.get("data").properties.type,this.typeName=e.model.get("data").properties.type_name,this.hasChild=e.model.get("data").properties.container_size>0,this.isEdit=e.model.get("data").properties.isEdit,this.connector=c.getConnector(),this.accessUrl=n.combine(new n(this.connector.connection.url).getCgiScript(),"app/nodes",this.id),this.folderRetrieved=!1,this.folderExpended=!1,this.iconClass="wkspContentIcon "+this.getIconClass(),o.LayoutView.prototype.constructor.call(this,e)},"clickFolder":function(e){if("saveEmailButton"!==event.target.id&&"moreLink"!==event.target.id){var i=this;if(i.hasChild){var o=t(e.target).data("id");if(o===i.id&&"noToggle"!==o){var n=window.csui?window.csui.require("conws/widgets/outlook/impl/folder/folders.view"):window.require("conws/widgets/outlook/impl/folder/folders.view");if(i.folderRetrieved)i.folderExpended?(i.getRegion("subFolders").$el.hide(),i.folderExpended=!1,i.toggleStatus=c.ToggleStatusExpand):(i.getRegion("subFolders").$el.show(),i.folderExpended=!0,i.toggleStatus=c.ToggleStatusCollapse);else{var s=new n({"connector":i.connector,"id":i.id,"parentNode":i,"pageSize":c.pageSize,"pageNo":1,"isEdit":i.isEdit});i.getRegion("subFolders").show(s)}this.ui.$toggleIcon.attr("class",i.toggleStatus)}}}},"renderToggleIcon":function(){this.hasChild=this.model.get("hasChild");var e=this.ui.$toggleIcon;this.hasChild||(this.toggleStatus=c.ToggleStatusEmpty),e.attr("class",this.toggleStatus);var i=this.toggleStatus===c.ToggleStatusEmpty?"-1":"0";e.attr("tabindex",i),"-1"===i&&t("#conwsoutlook-body").focus()},"showActionBar":function(e){var i=this;if(t(e.currentTarget).data("id")===i.id&&(751===i.type||!c.emailSavingConfig.onlySaveToEmailFolder)){var o=this.ui.$actionBar;o.css("display","block"),setTimeout(function(){o.addClass("binf-in")},300)}},"hideActionBar":function(e){if(0!==this.type||!c.emailSavingConfig.onlySaveToEmailFolder){var t=this.ui.$actionBar;t.css("display","none"),t.removeClass("binf-in")}},"processKeyUp":function(e){t(e.target).data("id")===this.id&&(13!==e.which&&32!==e.which||("toggleIcon"===e.target.id?this.clickFolder(e):"saveEmailButton"===e.target.id&&(this.saveEmail(e),this.hideActionBar(e))),9===e.which&&"folderNameDiv"===e.target.id&&this.showActionBar(e))},"processKeyDown":function(e){t(e.target).data("id")===this.id&&9===e.which&&(e.shiftKey&&"folderNameDiv"===e.target.id||!e.shiftKey&&"saveEmailButton"===e.target.id)&&this.hideActionBar(e)},"buttonFocused":function(e){if("saveEmailButton"===e.target.id){var i=e.target.querySelector("div");null!==i&&(t(i).css("outline","1px dotted grey"),t(i).css("outline-offset","2px"))}},"buttonFocusOut":function(e){if("saveEmailButton"===e.target.id||"folderNameDiv"===e.target.id){var i=this;setTimeout(function(e){var t=document.activeElement.id;"saveEmailButton"!==t&&"folderNameDiv"!==t&&i.hideActionBar(e)},50);var o=e.target.querySelector("div");null!==o&&(t(o).css("outline",""),t(o).css("outline-offset",""))}},"saveEmail":function(e){var i=this;if(t(e.currentTarget).data("id")===i.id){if(i.isEdit)return i.insertLink(event);if(null==window.CurrentEmailItem)return void s.showWarning(u.warning_no_outlook_context);var n=i.id,l=i.name,a=i.connector,r=window.CurrentEmailItem;c.ScorllPositionBeforeSaving=window.pageYOffset;var p=new o.Region({"el":"#savePanel"}),m=new d({"connector":a,"folderId":n,"folderName":l,"proposedEmailName":r.subject,"attachments":r.archivableAttachments});p.show(m),t("#conwsoutlook-body").focus()}},"insertLink":function(e){var t=this,i=a.insertLink(t.name,t.accessUrl);i.fail(function(e){s.showWarning(e.message)}),i.done(function(){})},"getIconClass":function(){var e=this,t=e.model.attributes,i={"type":e.type};null!=t&&null!=t.data&&null!=t.data.properties&&(i=t.data.properties);var o="";try{o="icon "+l.findClassByNode(i)}catch(e){o=751===i.type?"wkspEmailFolderIcon":i.container||0===i.type?"icon csui-icon mime_folder":"icon csui-icon mime_document"}return o}})}),csui.define("hbs!conws/widgets/outlook/impl/folder/impl/folders",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\r\n<div id="folders-list" style="padding-left: 22px"></div>\r\n<div class="listItemFolder"><a href="javascript:;" id="moreLink" class="moreLink" title="'+e.escapeExpression((s=null!=(s=l(i,"showMoreFoldersTitle")||(null!=t?l(t,"showMoreFoldersTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"showMoreFoldersTitle","hash":{},"loc":{"start":{"line":3,"column":89},"end":{"line":3,"column":113}}}):s))+'" data-id="'+e.escapeExpression((s=null!=(s=l(i,"id")||(null!=t?l(t,"id"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"id","hash":{},"loc":{"start":{"line":3,"column":124},"end":{"line":3,"column":130}}}):s))+'"  tabindex="0">'+e.escapeExpression((s=null!=(s=l(i,"showMoreLink")||(null!=t?l(t,"showMoreLink"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"showMoreLink","hash":{},"loc":{"start":{"line":3,"column":146},"end":{"line":3,"column":162}}}):s))+"</a></div>\r\n\r\n\r\n"}});return i.registerPartial("conws_widgets_outlook_impl_folder_impl_folders",o),o}),csui.define("conws/widgets/outlook/impl/folder/folders.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/marionette","csui/lib/backbone","conws/widgets/outlook/impl/folder/impl/folders.model","conws/widgets/outlook/impl/folder/item.view","conws/widgets/outlook/impl/utils/utility","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/folder/impl/folders","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,o,n,s,l,a,r){return i.CompositeView.extend({"className":"folders-conwsoutlook","template":r,"childView":s,"childViewContainer":"#folders-list","templateHelpers":function(){return{"id":this.id,"showMoreLink":a.showMore_link,"showMoreFoldersTitle":a.showMore_folders}},"events":{"click #moreLink":"retrieveNextPage"},"initialize":function(e){},"constructor":function(e){e.model=new n({},e),this.parentNode=e.parentNode,this.id=e.id,this.pageNo=e.pageNo,i.CompositeView.prototype.constructor.call(this,e),this.listenTo(this.model,"sync",this.renderFolders),e.model.fetch()},"retrieveNextPage":function(e){if(t(e.currentTarget).data("id")===this.id){var i=this.model.get("collection"),o=i?i.paging:null;o&&o.links&&o.links.data&&o.links.data.next&&o.links.data.next.href&&(this.model.nextPageUrl=o.links.data.next.href,this.model.fetch())}},"renderFolders":function(e,i,n){var s=this,a=e.get("collection"),r=a?a.paging:null,c=null==r||null==r.links||null==r.links.data||null==r.links.data.previous,d=e.get("results");if(c&&(s.parentNode.folderRetrieved=!0,s.parentNode.toggleStatus=l.ToggleStatusCollapse,s.parentNode.folderExpended=!0,0===d.length?s.parentNode.model.set("hasChild",!1):s.parentNode.model.set("hasChild",!0)),0!==d.length||!c)if(null==s.collection)s.collection=new o.Collection(d),s.render();else{var u=s.collection.length;s.collection.add(new o.Collection(d).toJSON()),s._addItems(s.collection.slice(u),u)}s.$(".moreLink").each(function(){var e=t(this);e.data("id")===s.id&&(r&&r.links&&r.links.data&&r.links.data.next&&r.links.data.next.href?e.css("display","block"):e.css("display","none"))})},"_addItems":function(t,i){var o,n=this;e.each(t,function(e,t){o=n.getChildView(e),n._addChild(e,o,i+t)})},"_addChild":function(e,t,i){return o.Marionette.CompositeView.prototype.addChild.apply(this,arguments)}})}),csui.define("conws/widgets/outlook/impl/wksp/wksp.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/url","csui/dialogs/modal.alert/modal.alert","csui/utils/nodesprites","hbs!conws/widgets/outlook/impl/wksp/impl/wksp","conws/widgets/outlook/impl/folder/folders.view","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/utils/csservice","conws/widgets/outlook/impl/dialog/saveSection.view","conws/widgets/outlook/impl/wksp/impl/wksp.model","conws/widgets/outlook/impl/utils/emailservice","i18n!conws/widgets/outlook/impl/nls/lang"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h){return o.LayoutView.extend({"className":"ListItem","template":a,"templateHelpers":function(){return{"id":this.id,"name":this.name,"iconClass":this.getIconClass(),"typeName":this.typeName,"toggleStatus":this.hasChild&&this.expendable?c.ToggleStatusExpand:c.ToggleStatusEmpty,"openLinkTitle":h.wksp_open_link,"linkToWS":this.accessUrl,"tabIndex":this.hasChild?"0":"-1","saveTitle":this.isEdit?h.insert_action:h.title_save_email,"actionIcon":this.isEdit?"copyLink":"emailSaveIcon"}},"regions":{"subFolders":"#subFolders"},"ui":{"$actionBar":".wkspFolder-actiondiv","$toggleIcon":"#toggleIcon","$saveMenuItem":"#wkspSaveMenuItem","$saveButton":"#saveEmailButton"},"events":{"click .listItemWksp":"clickWksp","mouseenter #wkspItem":"showActionBar","mouseleave #wkspItem":"hideActionBar","click #saveEmailButton":"saveEmail","focusin #saveEmailButton, #wkspOpenButton":"buttonFocused","focusout #saveEmailButton, #wkspOpenButton, #wkspNameDiv":"buttonFocusOut","keyup #toggleIcon, #wkspNameDiv, #saveEmailButton":"processKeyUp","keydown #wkspNameDiv, #wkspOpenButton":"processKeyDown"},"initialize":function(e){this.listenTo(this.model,"change",this.renderToggleIcon)},"constructor":function(e){this.model=e.model;var t=e.model.get("data").properties;this.name=t.name,this.id=t.id,this.typeName=t.type_name,this.type=t.type,this.isEdit=void 0!==t.isEdit&&t.isEdit,this.hasChild=t.container&&t.size>0&&848===t.type,this.connector=c.getConnector(),this.accessUrl=n.combine(new n(this.connector.connection.url).getCgiScript(),"app/nodes",this.id);var i=this.model.get("enableEmailSaving");this.expendable=(void 0===i||i)&&c.emailSavingConfig.allowExpandWorkspace,this.folderRetrieved=!1,this.folderExpended=!1;var s=this;this.isEdit||void 0!==i&&!i?this.isEdit&&setTimeout(function(){var e=s.ui.$saveMenuItem,t=s.ui.$saveButton;e.css("display","inline-block"),t.attr("title",h.insert_action)}):this.updateModelForPreConfigFolder(s),o.LayoutView.prototype.constructor.call(this,e)},"processKeyUp":function(e){t(e.target).data("id")===this.id&&(13===e.which||32===e.which?"toggleIcon"===e.target.id?this.clickWksp(e):"saveEmailButton"===e.target.id&&this.saveEmail(e):9===e.which&&"wkspNameDiv"===e.target.id&&this.showActionBar(e))},"processKeyDown":function(e){9===e.which&&(!e.shiftKey&&"wkspOpenButton"===e.target.id||e.shiftKey&&"wkspNameDiv"===e.target.id)&&this.hideActionBar(e)},"buttonFocused":function(e){if("saveEmailButton"===e.target.id||"wkspOpenButton"===e.target.id){var i=e.target.querySelector("div");null!==i&&(t(i).css("outline","1px dotted grey"),t(i).css("outline-offset","2px"))}},"buttonFocusOut":function(e){var i=this;if(("saveEmailButton"===e.target.id||"wkspOpenButton"===e.target.id||"wkspNameDiv"===e.target.id)&&(setTimeout(function(e){var t=document.activeElement.id;"saveEmailButton"!==t&&"wkspOpenButton"!==t&&"wkspNameDiv"!==t&&i.hideActionBar(e)},50),"wkspNameDiv"!==e.target.id)){var o=e.target.querySelector("div");null!==o&&(t(o).css("outline",""),t(o).css("outline-offset",""))}},"clickWksp":function(e){if("saveEmailButton"!==e.target.id&&"wkspOpenButton"!==e.target.id){var i=this;if(i.expendable&&i.expendable&&i.hasChild){var o=t(e.target).data("id");if(!o||"noToggle"!==o){if(i.folderRetrieved)i.folderExpended?(i.getRegion("subFolders").$el.hide(),i.folderExpended=!1,i.toggleStatus=c.ToggleStatusExpand):(i.getRegion("subFolders").$el.show(),i.folderExpended=!0,i.toggleStatus=c.ToggleStatusCollapse);else{var n=new r({"connector":this.connector,"id":i.id,"parentNode":i,"pageSize":c.pageSize,"pageNo":1,"isEdit":this.isEdit});i.getRegion("subFolders").show(n)}this.ui.$toggleIcon.attr("class",i.toggleStatus)}}}},"saveEmail":function(e){var i=this;if(t(e.currentTarget).data("id")===i.id){if(i.isEdit)return i.insertLink(e);if(null==window.CurrentEmailItem)return void s.showWarning(h.warning_no_outlook_context);var n=i.saveFolderId,l=i.saveFolderName,a=i.connector,r=window.CurrentEmailItem;c.ScorllPositionBeforeSaving=window.pageYOffset;var d=new o.Region({"el":"#savePanel"}),p=new u({"connector":a,"folderId":n,"folderName":l,"proposedEmailName":r.subject,"attachments":r.archivableAttachments});d.show(p),t("#conwsoutlook-body").focus()}},"insertLink":function(e){var t=this,i=m.insertLink(t.name,t.accessUrl);i.fail(function(e){s.showWarning(e.message)}),i.done(function(){})},"keyEnterWksp":function(e){13!==e.keyCode&&27!==e.keyCode||this.$(".listItemWkspName").trigger("click")},"showActionBar":function(){var e=this.ui.$actionBar;e.css("display","block"),setTimeout(function(){e.addClass("binf-in")},300)},"hideActionBar":function(){var e=this.ui.$actionBar;e.css("display","none"),e.removeClass("binf-in")},"renderToggleIcon":function(){this.hasChild=this.model.get("hasChild");var e=this.ui.$toggleIcon;this.hasChild&&this.expendable||(this.toggleStatus=c.ToggleStatusEmpty),e.attr("class",this.toggleStatus);var i=this.toggleStatus===c.ToggleStatusEmpty?"-1":"0";e.attr("tabindex",i),"-1"===i&&t("#conwsoutlook-body").focus()},"updateModelForPreConfigFolder":function(e){if(c.emailSavingConfig.preConfigFolderToSave.enabled){new p({"id":e.id},{"connector":e.connector}).getPreConfigFolder().done(function(t){var i=e.ui.$saveMenuItem,o=e.ui.$saveButton;t.hasPreConfigFolder?(e.saveFolderId=t.folderId,e.saveFolderName=t.folderName,i.css("display","inline-block"),o.attr("title",h.title_save_email_to+t.folderName)):i.css("display","none")})}},"getIconClass":function(){var e=this,t=e.model.attributes,i={"type":e.type};null!=t&&null!=t.data&&null!=t.data.properties&&(i=t.data.properties);var o="";try{o="icon "+l.findClassByNode(i)}catch(e){o="icon csui-icon mime_folder"}return o}})}),csui.define("hbs!conws/widgets/outlook/impl/recentwksps/impl/recentwksps",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\r\n<div class="binf-panel-heading outlook-heading">\r\n    <span class="headerIcon sectionToggleIcon" id="recentToggleIcon" tabindex="0"></span>\r\n    <span >'+e.escapeExpression((s=null!=(s=l(i,"sectionTitle")||(null!=t?l(t,"sectionTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"sectionTitle","hash":{},"loc":{"start":{"line":4,"column":11},"end":{"line":4,"column":27}}}):s))+'</span> <span id="recentCount"></span>\r\n</div>\r\n<div id="recentSection">\r\n    <div id="recent-list" class=""></div>\r\n    <div class="listItemWksp"><a href="javascript:;" id="moreRecentWksp" class="moreLinkWksp" title="'+e.escapeExpression((s=null!=(s=l(i,"showMoreWkspTitle")||(null!=t?l(t,"showMoreWkspTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"showMoreWkspTitle","hash":{},"loc":{"start":{"line":8,"column":101},"end":{"line":8,"column":122}}}):s))+'" tabindex="0">'+e.escapeExpression((s=null!=(s=l(i,"showMoreLink")||(null!=t?l(t,"showMoreLink"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"showMoreLink","hash":{},"loc":{"start":{"line":8,"column":137},"end":{"line":8,"column":153}}}):s))+'</a></div>\r\n    <div class="wkspMessageArea" id="recentWkspMsgArea"></div>\r\n</div>'}});return i.registerPartial("conws_widgets_outlook_impl_recentwksps_impl_recentwksps",o),o}),csui.define("conws/widgets/outlook/impl/recentwksps/recentwksps.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","conws/widgets/outlook/impl/recentwksps/impl/recentwksps.model.factory","conws/widgets/outlook/impl/wksp/wksp.view","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/recentwksps/impl/recentwksps","conws/widgets/outlook/impl/utils/utility","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,o,n,s,l,a,r){return i.CompositeView.extend({"className":"recentWksps-conwsoutlook panel panel-default","template":a,"childView":s,"childViewContainer":"#recent-list","templateHelpers":function(){return{"sectionTitle":l.sectionTitle_recent,"showMoreLink":l.showMore_link,"showMoreWkspTitle":l.showMore_wksp}},"events":{"click #moreRecentWksp":"retrieveNextPage","click #recentToggleIcon":"toggleIconClicked","keyup":"processKey"},"constructor":function(e){e.model=e.context.getModel(n),i.CompositeView.prototype.constructor.call(this,e),this.listenTo(this.model,"change",this.renderWksps),this.listenTo(this.model,"error",this.renderError)},"renderWksps":function(t,i,n){r.stopGlobalSpinner();var s=this,a=t.get("results"),c=t.get("paging"),d=null==c||null==c.actions||c.actions.previous;if(0===a.length&&d)c&&1===c.page&&(s.renderMessage(l.noWksp_recent),e("#recentToggleIcon").trigger("click"));else if(null==s.collection)s.collection=new o.Collection(a),s.render();else{var u=s.collection.length;s.collection.add(new o.Collection(a).toJSON()),s._addItems(s.collection.slice(u),u)}e("#recentCount").html("("+c.total_count+")");var p=s.$("#moreRecentWksp");c&&c.actions&&c.actions.next&&c.actions.next.href?p.css("display","block"):p.css("display","none")},"retrieveNextPage":function(e){var t=this.model.get("paging");t&&t.actions&&t.actions.next&&t.actions.next.href&&(r.startGlobalSpinner(),this.model.nextPageUrl=t.actions.next.href,this.model.fetch())},"_addItems":function(e,i){var o,n=this;t.each(e,function(e,t){o=n.getChildView(e),n._addChild(e,o,i+t)})},"_addChild":function(e,t,i){return o.Marionette.CompositeView.prototype.addChild.apply(this,arguments)},"renderError":function(e,i,o){r.stopGlobalSpinner();var n=this,s=e.get("error");s||(s="object"!=typeof i?JSON.parse(i).error:i.responseJSON?i.responseJSON.error:i.error),n.renderMessage(t.str.sformat(l.error_retrieve_recent,s))},"renderMessage":function(e){var t=this,i=t.$("#recentWkspMsgArea");e?(i.css("display","block"),i.html(e)):i.css("display","none")},"processKey":function(e){13!==e.which&&32!==e.which||"recentToggleIcon"===e.target.id&&this.toggleIconClicked(e)},"toggleIconClicked":function(e){r.collapsibleClicked("recent")}})}),csui.define("hbs!conws/widgets/outlook/impl/favoritewksps/impl/favoritewksps",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="binf-panel-heading outlook-heading">\r\n    <span class="headerIcon sectionToggleIcon" id="favoriteToggleIcon" tabindex="0"></span>\r\n    <span >'+e.escapeExpression((s=null!=(s=l(i,"sectionTitle")||(null!=t?l(t,"sectionTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"sectionTitle","hash":{},"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":27}}}):s))+'</span> <span id="favoriteCount"></span>\r\n</div>\r\n<div id="favoriteSection">\r\n    <div id="favorite-list" class="panel panel-default"></div>\r\n    <div class="listItemWksp"><a href="javascript:;" id="moreFavoriteWksp" class="moreLinkWksp" title="'+e.escapeExpression((s=null!=(s=l(i,"showMoreWkspTitle")||(null!=t?l(t,"showMoreWkspTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"showMoreWkspTitle","hash":{},"loc":{"start":{"line":7,"column":103},"end":{"line":7,"column":124}}}):s))+'" tabindex="0">'+e.escapeExpression((s=null!=(s=l(i,"showMoreLink")||(null!=t?l(t,"showMoreLink"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"showMoreLink","hash":{},"loc":{"start":{"line":7,"column":139},"end":{"line":7,"column":155}}}):s))+'</a></div>\r\n    <div class="wkspMessageArea" id="recentWkspMsgArea"></div>\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_outlook_impl_favoritewksps_impl_favoritewksps",o),o}),csui.define("conws/widgets/outlook/impl/favoritewksps/favoritewksps.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","conws/widgets/outlook/impl/favoritewksps/impl/favoritewksps.model.factory","conws/widgets/outlook/impl/wksp/wksp.view","conws/widgets/outlook/impl/wksp/impl/wksp.model","conws/widgets/outlook/impl/utils/utility","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/favoritewksps/impl/favoritewksps","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,o,n,s,l,a,r,c){return i.CompositeView.extend({"className":"favoriteWksps-conwsoutlook panel panel-default","template":c,"childView":s,"childViewContainer":"#favorite-list","templateHelpers":function(){return{"sectionTitle":r.sectionTitle_favorite,"showMoreLink":r.showMore_link,"showMoreWkspTitle":r.showMore_wksp}},"events":{"click #moreFavoriteWksp":"retrieveNextPage","click #favoriteToggleIcon":"toggleIconClicked","keyup":"processKey"},"initialize":function(e){},"constructor":function(e){e.model=e.context.getModel(n),i.CompositeView.prototype.constructor.call(this,e),this.pageIndex=0,this.pageSize=a.pageSize,this.listenTo(this.model,"change",this.renderWksps),this.listenTo(this.model,"error",this.renderError)},"renderWksps":function(t,i,n){var s=this,l=t.get("results"),a=l.length;if(0===a)s.renderMessage(r.noWksp_favorite),e("#favoriteToggleIcon").trigger("click");else{var c;if(0===s.pageIndex)c=a>s.pageSize?s.pageSize:a,s.collection=new o.Collection(l.slice(0,c)),s.render();else{var d=s.pageIndex*s.pageSize,u=(s.pageIndex+1)*s.pageSize,p=s.collection.length;c=a>u?u:a,s.collection.add(new o.Collection(l.slice(d,c)).toJSON()),s._addItems(s.collection.slice(p),p)}}e("#favoriteCount").html("("+a+")");var m=s.$("#moreFavoriteWksp"),h=(s.pageIndex+1)*s.pageSize<a?"block":"none";m.css("display",h)},"retrieveNextPage":function(e){var t=this;t.pageIndex++,t.renderWksps(t.model)},"_addItems":function(e,i){var o,n=this;t.each(e,function(e,t){o=n.getChildView(e),n._addChild(e,o,i+t)})},"_addChild":function(e,t,i){return o.Marionette.CompositeView.prototype.addChild.apply(this,arguments)},"renderError":function(e,i,o){var n=this,s=e.get("error");s||(s="object"!=typeof i?JSON.parse(i).error:i.responseJSON?i.responseJSON.error:i.error),n.renderMessage(t.str.sformat(r.error_retrieve_favorite,s))},"renderMessage":function(e){var t=this,i=t.$("#recentWkspMsgArea");e?(i.css("display","block"),i.html(e)):i.css("display","none")},"processKey":function(e){13!==e.which&&32!==e.which||"favoriteToggleIcon"===e.target.id&&this.toggleIconClicked(e)},"toggleIconClicked":function(e){a.collapsibleClicked("favorite")}})}),csui.define("hbs!conws/widgets/outlook/impl/searchwksps/impl/searchresult",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\r\n<div id="searchresult-list" ></div>\r\n<div class="listItemWksp"><a href="javascript:;" id="moreSearchWksp" class="moreLinkWksp" title="'+e.escapeExpression((s=null!=(s=l(i,"showMoreWkspTitle")||(null!=t?l(t,"showMoreWkspTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"showMoreWkspTitle","hash":{},"loc":{"start":{"line":3,"column":97},"end":{"line":3,"column":118}}}):s))+'" tabindex="0">'+e.escapeExpression((s=null!=(s=l(i,"showMoreLink")||(null!=t?l(t,"showMoreLink"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"showMoreLink","hash":{},"loc":{"start":{"line":3,"column":133},"end":{"line":3,"column":149}}}):s))+'</a></div>\r\n<div class="wkspMessageArea" id="searchResultMsgArea"></div>\r\n'}});return i.registerPartial("conws_widgets_outlook_impl_searchwksps_impl_searchresult",o),o}),csui.define("conws/widgets/outlook/impl/searchwksps/searchresult.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","conws/widgets/outlook/impl/searchwksps/impl/searchresult.model","conws/widgets/outlook/impl/wksp/wksp.view","conws/widgets/outlook/impl/utils/utility","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/searchwksps/impl/searchresult","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,o,n,s,l,a,r){return i.CompositeView.extend({"className":"wksp-srch-results","template":r,"childView":s,"childViewContainer":"#searchresult-list","templateHelpers":function(){return{"showMoreLink":a.showMore_link,"showMoreWkspTitle":a.showMore_wksp}},"ui":{"srchResultMessage":"#searchResultMsgArea","srchResultList":"#searchresult-list"},"events":{"click #moreSearchWksp":"retrieveNextPage"},"initialize":function(e){},"constructor":function(e){e.model=new n({},e),this.enableEmailSaving=e.enableEmailSaving,this.typeAhead=e.typeAhead,this.wkspName=e.wkspName,this.pageNo=e.pageNo,i.CompositeView.prototype.constructor.call(this,e),this.listenTo(this.model,"change",this.renderWksps),this.listenTo(this.model,"error",this.renderError),e.model.fetch()},"retrieveNextPage":function(e){var t=this.model.get("paging"),i=null;if(t)i=t.actions;else{var o=this.model.get("collection");o&&o.paging&&(t=o.paging)&&(i=t.links)}t&&i&&i.next&&i.next.href&&(l.startGlobalSpinner(),this.model.nextPageUrl=i.next.href,this.model.fetch())},"renderWksps":function(e,i,n){l.stopGlobalSpinner();var s=this,r=e.get("paging"),c=null;if(r)c=r.actions;else{var d=e.get("collection");d&&d.paging&&(r=d.paging)&&(c=r.links)}var u=null==r||null==c||c.previous,p=e.get("results");if(t.each(p,function(e){e.enableEmailSaving=s.enableEmailSaving}),0===p.length&&u)1===s.pageNo&&s.renderMessage(a.noWksp_search);else{if(null==s.collection)s.collection=new o.Collection(p),s.render();else{var m=s.collection.length;s.collection.add(new o.Collection(p).toJSON()),s._addItems(s.collection.slice(m),m)}s.typeAhead&&s.highlight(s,s.wkspName)}var h=s.$("#moreSearchWksp");c&&c.next&&c.next.href?h.css("display","block"):h.css("display","none")},"_addItems":function(e,i){var o,n=this;t.each(e,function(e,t){o=n.getChildView(e),n._addChild(e,o,i+t)})},"_addChild":function(e,t,i){return o.Marionette.CompositeView.prototype.addChild.apply(this,arguments)},"highlight":function(t,i){if(i){var o=i.replace(/^\W+/g,""),n=RegExp(o,"gi");t.$("div.listItemWkspName").each(function(){e(this).html(e(this).html().replace(n,"<u style='font-weight: bold'>$&</u>"))})}},"renderError":function(e,i,o){l.stopGlobalSpinner();var n=this,s=e.get("error");s||(s="object"!=typeof i?JSON.parse(i).error:i.responseJSON?i.responseJSON.error:i.error),n.renderMessage(t.str.sformat(a.error_retrieve_search,s))},"renderMessage":function(e){var t=this;e?(t.ui.srchResultMessage.text(e),t.ui.srchResultMessage.css("display","block"),t.ui.srchResultList.css("display","none")):(t.ui.srchResultMessage.css("display","none"),t.ui.srchResultList.css("display","block"))}})}),csui.define("conws/widgets/outlook/impl/searchwksps/simplesearch.view",["csui/lib/underscore","csui/lib/handlebars","csui/lib/marionette","csui/lib/jquery","csui/widgets/search.custom/search.custom.view","conws/widgets/outlook/impl/utils/utility","i18n!conws/widgets/outlook/impl/nls/lang"],function(e,t,i,o,n,s,l){return n.extend({"constructor":function(e){e||(e={}),n.prototype.constructor.call(this,e),this.context=e.context,this.options=e,this.options.parentView=this,this.contentViewOptions=this.options,s.startGlobalSpinner()},"initialize":function(){e.bindAll(this,"render","afterRender");var t=this;this.render=e.wrap(this.render,function(e){return e(),t.afterRender(),t})},"afterRender":function(){this.verifyForm()},"verifyForm":function(){setTimeout(function e(){if(0===o(".customsearch-attr-container").length)setTimeout(e,100);else{s.stopGlobalSpinner();var t=s.SearchFormBottomPadding+s.TraceAreaHeight+"px";o(".tile-content").css("height","calc(100vh - "+t+")")}},20)}})}),csui.define("hbs!conws/widgets/outlook/impl/searchwksps/impl/wksptype",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<option value="'+e.escapeExpression((s=null!=(s=l(i,"value")||(null!=t?l(t,"value"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"value","hash":{},"loc":{"start":{"line":1,"column":15},"end":{"line":1,"column":24}}}):s))+'">'+e.escapeExpression((s=null!=(s=l(i,"name")||(null!=t?l(t,"name"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"name","hash":{},"loc":{"start":{"line":1,"column":26},"end":{"line":1,"column":34}}}):s))+"</option>"}});return i.registerPartial("conws_widgets_outlook_impl_searchwksps_impl_wksptype",o),o}),csui.define("conws/widgets/outlook/impl/searchwksps/wksptypes.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","hbs!conws/widgets/outlook/impl/searchwksps/impl/wksptype"],function(e,t,i,o,n){return o.LayoutView.extend({"tagName":"option","template":n,"templateHelpers":function(){return{"value":this.id,"name":this.name}},"initialize":function(e){var t=e.model.get("results");this.collection=new i.Collection(t)},"constructor":function(e){this.model=e.model,this.name=e.model.get("data").properties.wksp_type_name,this.id=e.model.get("data").properties.wksp_type_id,o.LayoutView.prototype.constructor.call(this,e)},"onRender":function(){this.$el=this.$el.children(),this.$el.unwrap(),this.setElement(this.$el)}})}),csui.define("conws/widgets/outlook/impl/searchwksps/impl/simplesearchresult.model",["csui/lib/backbone","csui/utils/url","conws/widgets/outlook/impl/utils/utility"],function(e,t,i){return e.Model.extend({"defaults":{"name":"Unnamed"},"constructor":function(t,i){e.Model.prototype.constructor.apply(this,arguments),i&&i.context.connector&&(i.context.connector.assignTo(this),this.pageSize=i.pageSize,this.pageNo=i.pageNo,this.isEdit=i.isEdit,this.nextPageUrl="",this.query=i.query)},"url":function(){var e=i.v1ToV2(this.connector.connection.url),o=this.query.toJSON(),n="",s="";if(this.nextPageUrl){this.pageNo++;var l=/cache_id=\d+/g,a=l.exec(this.nextPageUrl);n=a.length>0?a[0]:""}return s="page="+this.pageNo+"&limit="+this.pageSize,o=t.combineQueryString(o,s,n),t.combine(e,"search?"+o)},"parse":function(e){if(this.isEdit&&e&&e.results&&e.results.length>0)for(var t=e.results.length-1;t>=0;t--)e.results[t].data.properties.isEdit=!0;return e}})}),csui.define("conws/widgets/outlook/impl/searchwksps/simplesearchresult.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","csui/utils/contexts/factories/search.query.factory","csui/utils/contexts/factories/search.results.factory","conws/widgets/outlook/impl/searchwksps/impl/simplesearchresult.model","conws/widgets/outlook/impl/wksp/wksp.view","conws/widgets/outlook/impl/utils/utility","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/searchwksps/impl/searchresult","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,o,n,s,l,a,r,c,d){return i.CompositeView.extend({"className":"wksp-srch-results","template":d,"childView":a,"childViewContainer":"#searchresult-list","templateHelpers":function(){return{"showMoreLink":c.showMore_link,"showMoreWkspTitle":c.showMore_wksp}},"ui":{"srchResultMessage":"#searchResultMsgArea","srchResultList":"#searchresult-list"},"events":{
"click #moreSearchWksp":"retrieveNextPage"},"constructor":function(e){this.enableEmailSaving=e.enableEmailSaving,this.pageNo=e.pageNo,this.pageSize=e.pageSize,this.context=e.context,e.query||(e.query=this.context.getModel(n)),e.model=new l({},e),this.model=e.model,i.CompositeView.prototype.constructor.call(this,e),this.listenTo(this.model,"change",this.renderWksps),this.listenTo(this.model,"error",this.renderError),this.model.fetch()},"retrieveNextPage":function(e){var t=this.model.get("collection"),i=null==t.paging?null:t.paging;i&&i.links&&i.links.next&&i.links.next.href&&(r.startGlobalSpinner(),this.model.nextPageUrl=i.links.next.href,this.model.fetch())},"renderWksps":function(e,i,n){r.stopGlobalSpinner();var s=this,l=e.get("collection"),a=null==l.paging?null:l.paging,d=null==a||null==a.actions||a.actions.previous,u=e.get("results");if(t.each(u,function(e){e.enableEmailSaving=s.enableEmailSaving}),0===u.length&&d)1===s.pageNo&&s.renderMessage(c.noWksp_search);else if(null==s.collection)s.collection=new o.Collection(u),s.render();else{var p=s.collection.length;s.collection.add(new o.Collection(u).toJSON()),s._addItems(s.collection.slice(p),p)}var m=s.$("#moreSearchWksp");a&&a.links&&a.links.next&&a.links.next.href?m.css("display","block"):m.css("display","none")},"_addItems":function(e,i){var o,n=this;t.each(e,function(e,t){o=n.getChildView(e),n._addChild(e,o,i+t)})},"_addChild":function(e,t,i){return o.Marionette.CompositeView.prototype.addChild.apply(this,arguments)},"renderError":function(e,i,o){r.stopGlobalSpinner();var n=this,s=e.get("error");s||(s="object"!=typeof i?JSON.parse(i).error:i.responseJSON?i.responseJSON.error:i.error),n.renderMessage(t.str.sformat(c.error_retrieve_search,s))},"renderMessage":function(e){var t=this;e?(t.ui.srchResultMessage.text(e),t.ui.srchResultMessage.css("display","block"),t.ui.srchResultList.css("display","none")):(t.ui.srchResultMessage.css("display","none"),t.ui.srchResultList.css("display","block"))}})}),csui.define("hbs!conws/widgets/outlook/impl/searchwksps/impl/searchwksps",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\r\n<div class="binf-panel-heading outlook-heading" >'+e.escapeExpression((s=null!=(s=l(i,"sectionTitle")||(null!=t?l(t,"sectionTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"sectionTitle","hash":{},"loc":{"start":{"line":2,"column":49},"end":{"line":2,"column":65}}}):s))+' \r\n    \x3c!--<img src="'+e.escapeExpression((s=null!=(s=l(i,"serverOrigin")||(null!=t?l(t,"serverOrigin"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"serverOrigin","hash":{},"loc":{"start":{"line":3,"column":18},"end":{"line":3,"column":34}}}):s))+"/"+e.escapeExpression((s=null!=(s=l(i,"supportFolder")||(null!=t?l(t,"supportFolder"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"supportFolder","hash":{},"loc":{"start":{"line":3,"column":35},"end":{"line":3,"column":52}}}):s))+'/csui/themes/carbonfiber/image/icons/help_mo.svg" class="wkspHelpIcon" title="'+e.escapeExpression((s=null!=(s=l(i,"helpTooltip")||(null!=t?l(t,"helpTooltip"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"helpTooltip","hash":{},"loc":{"start":{"line":3,"column":130},"end":{"line":3,"column":145}}}):s))+'" />--\x3e\r\n</div>\r\n<div class="wkspSearch">\r\n    <div class="wkspSearchInputName">\r\n        <table class="wkspNameBox">\r\n            <tr>\r\n                <td class="wkspInputWithClear">\r\n                    <input class="wkspInput wkspSearchInput wkspSearchName" id="wkspName" type="search" aria-label="'+e.escapeExpression((s=null!=(s=l(i,"wkspNamePlaceholder")||(null!=t?l(t,"wkspNamePlaceholder"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"wkspNamePlaceholder","hash":{},"loc":{"start":{"line":10,"column":116},"end":{"line":10,"column":139}}}):s))+'" placeholder="'+e.escapeExpression((s=null!=(s=l(i,"wkspNamePlaceholder")||(null!=t?l(t,"wkspNamePlaceholder"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"wkspNamePlaceholder","hash":{},"loc":{"start":{"line":10,"column":154},"end":{"line":10,"column":177}}}):s))+'" />\r\n                    <span class="searchClear wkspIcon" id="searchClearButton" title="'+e.escapeExpression((s=null!=(s=l(i,"searchClearTooltip")||(null!=t?l(t,"searchClearTooltip"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"searchClearTooltip","hash":{},"loc":{"start":{"line":11,"column":85},"end":{"line":11,"column":107}}}):s))+'" tabindex="0"></span>\r\n                </td>\r\n                <td class="wkspSearchButton">\r\n                    <span id="wkspTypeButton" class="wkspIcon searchTypeIcon" title="'+e.escapeExpression((s=null!=(s=l(i,"selectWkspType")||(null!=t?l(t,"selectWkspType"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"selectWkspType","hash":{},"loc":{"start":{"line":14,"column":85},"end":{"line":14,"column":103}}}):s))+'" tabindex="0"></span>\r\n                    <table class="wkspTypeDropdownTable"><tr>\r\n                        <td>\r\n                            <div id="typeDropdown" class="wkspTypeDropdown saveDisplayArea hiddenArea"></div>\r\n                        </td>\r\n                    </tr></table>\r\n                </td>\r\n                <td class="wkspSearchButton">\r\n                    <span id="searchButton" class="wkspIcon searchIcon" title="'+e.escapeExpression((s=null!=(s=l(i,"searchTooltip")||(null!=t?l(t,"searchTooltip"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"searchTooltip","hash":{},"loc":{"start":{"line":22,"column":79},"end":{"line":22,"column":96}}}):s))+'" tabindex="0"></span>\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan="3">\r\n                    <div id="wkspTypeMsg" class="wkspTypeMsg hiddenArea"></div>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>\r\n\r\n<div class="binf-panel-heading outlook-heading hiddenArea" id="searchResultHeading">\r\n    <span class="headerIcon backwardIcon" tabindex="0" id="searchResultBackButton"></span>\r\n    <span >'+e.escapeExpression((s=null!=(s=l(i,"resultTitle")||(null!=t?l(t,"resultTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"resultTitle","hash":{},"loc":{"start":{"line":36,"column":11},"end":{"line":36,"column":26}}}):s))+'</span>\r\n</div> \r\n<div id="search-result"></div>\r\n\r\n<div class="wkspMessageArea" id="searchMsgArea"></div>\r\n\r\n\r\n\r\n'}});return i.registerPartial("conws_widgets_outlook_impl_searchwksps_impl_searchwksps",o),o}),csui.define("conws/widgets/outlook/impl/searchwksps/searchwksps.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","csui/utils/contexts/page/page.context","csui/widgets/search.custom/search.custom.view","csui/utils/contexts/factories/search.query.factory","csui/utils/contexts/factories/next.node","conws/widgets/outlook/impl/searchwksps/impl/searchwksps.model.factory","conws/widgets/outlook/impl/searchwksps/searchresult.view","conws/widgets/outlook/impl/searchwksps/simplesearch.view","conws/widgets/outlook/impl/searchwksps/wksptypes.view","conws/widgets/outlook/impl/searchwksps/simplesearchresult.view","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/utils/csservice","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/searchwksps/impl/searchwksps","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h,g,f){return window.wkspTypeSelected=function(t,i){e("#typeDropdown").addClass("hiddenArea"),-100===t?(e("#wkspTypeMsg").addClass("hiddenArea"),e("#wkspTypeMsg").removeClass("wkspTypeMsgDisplay"),e("#wkspTypeMsg").html("")):(e("#wkspTypeMsg").removeClass("hiddenArea"),e("#wkspTypeMsg").addClass("wkspTypeMsgDisplay"),e("#wkspTypeMsg").html(g.search_selected_wksp_type+": <span style='font-weight: bold' title='"+i+"'>"+i+"</span>")),m.SelectedWkspTypeId=t,m.WkspSearchPerformed&&e("#searchButton").trigger("click")},i.CompositeView.extend({"className":"searchWksps-conwsoutlook panel panel-default","template":f,"ui":{"wkspNameBox":"#wkspName","searchButton":"#searchButton","searchClearButton":"#searchClearButton","searchFormDropdown":"#searchFormDropdown"},"events":{"click #searchButton":"searchWksps","click #searchClearButton":"clearSearch","click #searchResultBackButton":"clearSearch","click #wkspTypeButton":"openWkspTypeSelection","keyup":"processKey","focusin #searchButton":"searchButtonFocused"},"templateHelpers":function(){return{"serverOrigin":window.ServerOrigin,"supportFolder":window.ContentServerSupportPath,"sectionTitle":g.sectionTitle_search,"helpTooltip":g.help_button_tooltip,"searchTooltip":g.search_button_tooltip,"searchClearTooltip":g.search_clear_button_tooltip,"wkspNamePlaceholder":g.search_wkspName_placeholder,"selectWkspType":g.search_select_wksp_type,"resultTitle":g.search_result_title}},"initialize":function(e){},"constructor":function(e){e.model=e.context.getModel(r),this.pageSize=e.pageSize?e.pageSize:m.pageSize,this.enableEmailSaving=e.enableEmailSaving,this.showSearchForm=!!e.showSearchFormSelection&&e.showSearchFormSelection,this.previousFormId=-1,this.isEdit=void 0!==e.context.isEdit&&e.context.isEdit,this.context=e.context,i.CompositeView.prototype.constructor.call(this,e),this.listenTo(this.model,"change",this.renderSearchForm),this.listenTo(this.model,"error",this.renderError)},"renderMessage":function(e){var t=this,i=t.$("#searchMsgArea");e?(i.css("display","block"),i.html(e)):i.css("display","none")},"renderSearchForm":function(e,i,o){var n=this,s=e.get("results");n.render();for(var l="",a=0;a<s.length;a++){var r=s[a],c=r.data.properties.wksp_type_name,d=r.data.properties.wksp_type_id;l+=t.str.sformat("<a href=\"javascript:wkspTypeSelected({0},'{1}');\" title='{1}' style='width:80vw; white-space:nowrap; overflow-x:hidden; text-overflow:ellipsis; display:flow-root list-item;'><div style='display:inline'>{1}</div></a>",d,c)}n.$("#typeDropdown").html(l);var u=document.querySelector("#wkspName"),p=null;u.addEventListener("keyup",function(e){clearTimeout(p),p=setTimeout(function(){u.value.length>=3&&n.searchWksps(e)},1e3)})},"renderError":function(e,t,i){var o=this,n=e.get("error");n||(n="object"!=typeof t?JSON.parse(t).error:t.responseJSON?t.responseJSON.error:t.error),o.renderMessage(n)},"processKey":function(e){13!==e.which&&32!==e.which||("wkspTypeButton"===e.target.id?this.openWkspTypeSelection(e):"searchButton"===e.target.id?this.searchWksps(e):"searchClearButton"!==e.target.id&&"searchResultBackButton"!==e.target.id||this.clearSearch(e))},"searchButtonFocused":function(t){e("#typeDropdown").addClass("hiddenArea")},"searchWksps":function(e){var t=this,o=t.$("#wkspName").val(),n=m.SelectedWkspTypeId,s=t.$("#searchClearButton"),l="";m.uiShow("searchResultHeading"),m.uiHide("nonSearchSections"),s.css("display","block");var a=new i.Region({"el":"#search-result"});if(-100===n&&""===o)l=g.search_noCondition,a.$el.hide();else{l="",a.$el.show();var r="wkspName"===e.target.id,d=new c({"connector":this.model.connector,"wkspTypeId":n,"wkspName":o,"typeAhead":r,"pageSize":this.pageSize,"pageNo":1,"enableEmailSaving":this.enableEmailSaving,"isEdit":this.isEdit});m.WkspSearchPerformed=!0,a.show(d),m.startGlobalSpinner()}this.renderMessage(l)},"clearSearch":function(t){var o=this,n=o.$("#wkspName"),s=o.$("#searchClearButton"),l=new i.Region({"el":"#search-result"});n.val(""),s.css("display","none"),l.$el.hide(),m.uiHide("searchResultHeading"),m.uiShow("nonSearchSections"),m.SelectedWkspTypeId=-100,m.WkspSearchPerformed=!1,m.uiHide("wkspTypeMsg"),e("#wkspTypeMsg").removeClass("wkspTypeMsgDisplay"),e("#wkspTypeMsg").html(""),this.renderMessage(""),e("#conwsoutlook-body").focus()},"searchWkspsTyping":function(e){this.$("#wkspName").val().length>=2&&this.searchWksps(e)},"openWkspTypeSelection":function(){e("#typeDropdown").toggleClass("hiddenArea")}})}),csui.define("hbs!conws/widgets/outlook/impl/suggestedwksps/impl/suggestedwksps",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\r\n<div class="binf-panel-heading outlook-heading">\r\n    \r\n    <span class="headerIcon sectionToggleIcon" id="suggestedToggleIcon" tabindex="0"></span>\r\n    <span >'+e.escapeExpression((s=null!=(s=l(i,"sectionTitle")||(null!=t?l(t,"sectionTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"sectionTitle","hash":{},"loc":{"start":{"line":5,"column":11},"end":{"line":5,"column":27}}}):s))+'</span> <span id="suggestedCount"></span>\r\n    \r\n    <span >\r\n    <div id="suggestedWkspSpinner" class="load-container binf-hidden">\r\n        <div class="outer-border wksp-outer-border">\r\n            <div class="loader wksp-loader"></div>\r\n        </div>\r\n    </div>\r\n    </span>    \r\n</div>\r\n<div id="suggestedSection">\r\n    <div id="suggested-list"></div>\r\n    <div class="wkspMessageArea" id="suggestedWkspMsgArea"></div>\r\n</div>'}});return i.registerPartial("conws_widgets_outlook_impl_suggestedwksps_impl_suggestedwksps",o),o}),csui.define("conws/widgets/outlook/impl/suggestedwksps/suggestedwksps.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","conws/widgets/outlook/impl/wksp/wksp.view","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/suggestedwksps/impl/suggestedwksps","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/utils/csservice","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,o,n,s,l,a,r){return i.CompositeView.extend({"className":"suggestedWksps-conwsoutlook panel panel-default","template":l,"childView":n,"childViewContainer":"#suggested-list","templateHelpers":function(){return{"sectionTitle":s.sectionTitle_suggested}},"events":{"click #suggestedToggleIcon":"toggleIconClicked","keyup":"processKey"},"constructor":function(e){var t=this;if(i.CompositeView.prototype.constructor.call(this,e),t.error=e.error,t.config=e.config,t.connector=e.context.connector,t.isEdit=void 0!==e.context.isEdit&&e.context.isEdit,setTimeout(function(){a.startLocalSpinner("suggestedWkspSpinner"),t.renderMessage(t,s.info_retrieving)}),e.error)setTimeout(function(){a.stopLocalSpinner("suggestedWkspSpinner"),t.renderError(e.error)});else{var o=t.isEdit?window.CurrentEditItem:window.CurrentEmailItem,n=r.getSuggestedWksps(e.context.connector,o,e.config);n.done(function(e){t.renderWksps(e)}),n.fail(function(e){t.renderError(e)})}},"renderWksps":function(i){a.stopLocalSpinner("suggestedWkspSpinner");for(var n=this,l=0;l<i.results.length;l++)i.results[l].data.properties.isEdit=n.isEdit;n.collection=new o.Collection(i.results),n.render();var r="";if(0===n.collection.length&&(r=s.noWksp_suggested,e("#suggestedToggleIcon").trigger("click")),e("#suggestedCount").html("("+n.collection.length+")"),null!=i.errors&&i.errors.length>0){var c=i.errors.join("<br/>");c=t.str.sformat(s.error_retrieve_suggested,c),r=""===r?c:r+"<br/>"+c}""!==r&&n.renderMessage(n,r)},"refresh":function(){var e=this;if(!e.error){a.writeTrace("The suggested workspaces is being refreshed...."),setTimeout(function(){a.startLocalSpinner("suggestedWkspSpinner"),e.renderMessage(e,s.info_retrieving)});var t=r.getSuggestedWksps(e.connector,window.CurrentEmailItem,e.config);t.done(function(t){e.renderWksps(t)}),t.fail(function(t){e.renderError(t)})}},"renderError":function(e){a.stopLocalSpinner("suggestedWkspSpinner");var i=this,o=null!=e.responseJSON?e.responseJSON.error:e;i.renderMessage(i,t.str.sformat(s.error_retrieve_suggested,o))},"renderMessage":function(e,t){var i=e.$("#suggestedWkspMsgArea");t?(i.css("display","block"),i.html(t)):i.css("display","none")},"processKey":function(e){13!==e.which&&32!==e.which||"suggestedToggleIcon"===e.target.id&&this.toggleIconClicked(e)},"toggleIconClicked":function(e){a.collapsibleClicked("suggested")}})}),csui.define("hbs!conws/widgets/outlook/impl/searchwksps/impl/customsearch",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'\r\n<div id="customSearchFormArea">\r\n    <div class="binf-panel-heading outlook-heading" >\r\n        <span class="headerIcon backwardIcon" tabindex="0" id="customSearchBack"></span>\r\n        <span >'+e.escapeExpression((s=null!=(s=l(i,"sectionTitle")||(null!=t?l(t,"sectionTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"sectionTitle","hash":{},"loc":{"start":{"line":5,"column":15},"end":{"line":5,"column":31}}}):s))+'</span>\r\n    </div>    \r\n    <div class="wkspSearch">\r\n\r\n        <div class="wkspSearchForm" id="searchFormListDiv">\r\n            <label class="searchFormLabel" for="searchFormDW">'+e.escapeExpression((s=null!=(s=l(i,"selectSearchForm")||(null!=t?l(t,"selectSearchForm"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"selectSearchForm","hash":{},"loc":{"start":{"line":10,"column":62},"end":{"line":10,"column":82}}}):s))+'</label>\r\n            <select class="wkspInput wkspSearchInput wkspSearchSelect" id="searchFormDW" onmousedown="document.getElementById(\'searchFormDW\').focus();"></select>\r\n        </div>\r\n\r\n        <div id="searchFormDiv"></div>\r\n    </div>\r\n    <div class="wkspMessageArea" id="searchMsgArea"></div>\r\n</div>\r\n\r\n<div id="customSearchResultArea" class="hiddenArea">\r\n    <div class="binf-panel-heading outlook-heading" >\r\n        <span class="headerIcon backwardIcon" tabindex="0" id="customSearchResultBack"></span>\r\n        <span >'+e.escapeExpression((s=null!=(s=l(i,"resultTitle")||(null!=t?l(t,"resultTitle"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"resultTitle","hash":{},"loc":{"start":{"line":22,"column":15},"end":{"line":22,"column":30}}}):s))+'</span>\r\n    </div>    \r\n    <div id="customSearchResult"></div>\r\n</div>\r\n\r\n\r\n'}});return i.registerPartial("conws_widgets_outlook_impl_searchwksps_impl_customsearch",o),o}),csui.define("conws/widgets/outlook/impl/searchwksps/customSearchSection.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","csui/utils/contexts/page/page.context","csui/widgets/search.custom/search.custom.view","csui/utils/contexts/factories/search.query.factory","csui/utils/contexts/factories/next.node","conws/widgets/outlook/impl/searchwksps/impl/searchwksps.model.factory","conws/widgets/outlook/impl/searchwksps/searchresult.view","conws/widgets/outlook/impl/searchwksps/simplesearch.view","conws/widgets/outlook/impl/searchwksps/wksptypes.view","conws/widgets/outlook/impl/searchwksps/simplesearchresult.view","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/utils/csservice","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/searchwksps/impl/customsearch","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h,g,f){return i.CompositeView.extend({"className":"searchWksps-conwsoutlook panel panel-default","template":f,"ui":{"searchFormDW":"#searchFormDW"},"events":{"change #searchFormDW":"searchFormChange","click #customSearchResultBack":"backToSearchForm","click #customSearchBack":"backToStandard","keyup #customSearchBack, #customSearchResultBack":"processKey"},"templateHelpers":function(){return{"serverOrigin":window.ServerOrigin,"supportFolder":window.ContentServerSupportPath,"sectionTitle":g.sectionTitle_customSearch,"selectSearchForm":g.search_select_form,"resultTitle":g.search_result_title}},"initialize":function(e){},"constructor":function(e){this.pageSize=e.pageSize?e.pageSize:m.pageSize,this.enableEmailSaving=e.enableEmailSaving,this.showSearchForm=!!e.showSearchFormSelection&&e.showSearchFormSelection,this.previousFormId=-1,this.queries=e.queries,this.context=e.context,this.isEdit=void 0!==e.context.isEdit&&e.context.isEdit,i.CompositeView.prototype.constructor.call(this,e);var t=this;setTimeout(function(){t.renderSearchForm()})},"renderMessage":function(e){var t=this,i=t.$("#searchMsgArea");e?(i.css("display","block"),i.html(e)):i.css("display","none")},"renderSearchForm":function(e,o,s){var l=this;if(l.render(),null!=l.queries&&0!==l.queries.length){l.$("#searchFormListDiv").css("display","block");for(var a="",r=0;r<l.queries.length;r++){var c=l.queries[r];a+=t.str.sformat("<option value='{0}'>{1}</option>",c[1],c[0])}l.$("#searchFormDW").html(a);var u=new n({"factories":{"connector":l.options.context.connector}});u.connector=l.options.context.connector,u.isEdit=l.isEdit;var p=new i.Region({"el":"#searchFormDiv"});m.writeTrace("Showing custom search view for ID: ."+l.queries[0][1]);var h=new d({"context":u,"savedSearchQueryId":l.queries[0][1]});p.show(h),l.refreshQueryModel(u),u.fetch()}},"renderError":function(e,t,i){var o=this,n=e.get("error");n||(n="object"!=typeof t?JSON.parse(t).error:t.responseJSON?t.responseJSON.error:t.error),o.renderMessage(n)},"processKey":function(e){13!==e.which&&32!==e.which||("customSearchBack"===e.target.id?this.backToStandard(e):"customSearchResultBack"===e.target.id&&this.backToSearchForm(e))},"searchFormChange":function(t){var o=this,s=o.$("#searchFormDW").val();this.renderMessage(""),new i.Region({"el":"#customSearchResult"}).$el.empty();var l=e("#csui-custom-search-form-submit").hasClass("csui-search-form-submit-disabled");if("-1"===s)o.$("#searchFormWkspTypeName").css("display","block"),o.$("#searchFormDiv").css("display","none");else if(o.$("#searchFormWkspTypeName").css("display","none"),o.$("#searchFormDiv").css("display","block"),l||o.previousFormId!==s){m.startGlobalSpinner(),o.previousFormId=s;var a=new n({"factories":{"connector":o.options.context.connector}});a.connector=o.options.context.connector;var r=new i.Region({"el":"#searchFormDiv"});m.writeTrace("Showing custom search view for ID: ."+s);var c=new d({"context":a,"savedSearchQueryId":s});r.show(c),o.refreshQueryModel(a),a.fetch()}},"refreshQueryModel":function(e){var t=this,o=e.getModel(l);history.pushState=function(){},o.on("change",Function.createDelegate(this,function(o){var n=new i.Region({"el":"#customSearchResult"}),s=new p({"context":e,"pageSize":t.pageSize,"pageNo":1,"isEdit":t.isEdit,"enableEmailSaving":t.enableEmailSaving});m.startGlobalSpinner(),m.uiHide("customSearchFormArea"),m.uiShow("customSearchResultArea"),n.show(s)})),e.fetch()},"backToSearchForm":function(t){m.uiShow("customSearchFormArea"),m.uiHide("customSearchResultArea"),e("#conwsoutlook-body").focus()},"backToStandard":function(t){m.uiShow("standardSections"),m.uiShow("customSearchButton"),m.uiHide("customSearchSection"),m.PreSaveSection="standardSections",e("#conwsoutlook-body").focus()}})}),csui.define("hbs!conws/widgets/outlook/impl/conwsoutlook",["module","hbs","nuc/lib/handlebars"],function(e,t,i){var o=i.template({"compiler":[8,">= 4.3.0"],"main":function(e,t,i,o,n){var s,l=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<div class="outlook-container" >\r\n\r\n    <div class="mainPageContent" id="standardSections">\r\n        <div class="outlook-col" id="searchRegion" ></div>\r\n        <div id="nonSearchSections">\r\n            <div class="outlook-col" id="suggestedRegion" ></div>\r\n            <div class="outlook-col" id="favoriteRegion" ></div>\r\n            <div class="outlook-col" id="recentRegion" ></div>\r\n        </div>\r\n    </div>  \r\n\r\n    <div id="customSearchSection" class="hiddenArea"></div>\r\n    <div id="savePanel" class="hiddenArea"></div>\r\n\r\n    <div class="customSearchButton outlook-heading binf-panel-heading hiddenArea" id="customSearchButton">\r\n        <span class="headerIcon forwardIcon" id="customerSearchButtonIcon" tabindex="0"></span>\r\n        <span >'+e.escapeExpression((s=null!=(s=l(i,"customSearchLabel")||(null!=t?l(t,"customSearchLabel"):t))?s:e.hooks.helperMissing,"function"==typeof s?s.call(null!=t?t:e.nullContext||{},{"name":"customSearchLabel","hash":{},"loc":{"start":{"line":17,"column":15},"end":{"line":17,"column":36}}}):s))+'</span>\r\n    </div>\r\n    \r\n    <div id="dialogRegion"></div>\r\n\r\n</div>\r\n'}});return i.registerPartial("conws_widgets_outlook_impl_conwsoutlook",o),o}),csui.define("conws/widgets/outlook/conwsoutlook.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/lib/backbone","csui/utils/contexts/page/page.context","csui/utils/contexts/factories/connector","csui/utils/authenticators/request.authenticator","csui/utils/url","csui/utils/nodesprites","conws/utils/icons/icons","conws/widgets/outlook/impl/recentwksps/recentwksps.view","conws/widgets/outlook/impl/favoritewksps/favoritewksps.view","conws/widgets/outlook/impl/searchwksps/searchwksps.view","conws/widgets/outlook/impl/suggestedwksps/suggestedwksps.view","conws/widgets/outlook/impl/searchwksps/customSearchSection.view","conws/widgets/outlook/impl/dialog/authenticator","conws/widgets/outlook/impl/utils/utility","conws/widgets/outlook/impl/utils/csservice","conws/widgets/outlook/impl/metadata/metadata.forms.view","csui/utils/contexts/factories/node","i18n!conws/widgets/outlook/impl/nls/lang","hbs!conws/widgets/outlook/impl/conwsoutlook","css!conws/widgets/outlook/impl/conwsoutlook"],function(e,t,i,o,n,s,l,a,r,c,d,u,p,m,h,g,f,w,v,b,y,k){return i.LayoutView.extend({"className":"conwsoutlook ","template":k,"regions":{"searchRegion":"#searchRegion","favoriteRegion":"#favoriteRegion","recentRegion":"#recentRegion","suggestedRegion":"#suggestedRegion","customSearchRegion":"#customSearchSection","customViewSearchResultRegion":"#customViewSearchResultRegion","dialogRegion":"#dialogRegion"},"templateHelpers":function(){return{"customSearchLabel":y.search_custom_button_label}},"events":{"click #customSearchButton":"showCustomSearch","keyup":"processKey"},"initialize":function(t){this.context=this.options.context;var i=new l({}),o={"authenticator":i};this.connector=this.context.getObject(s,o),void 0===this.connector.authenticator.login&&(i.connection=this.connector.authenticator.connection,this.connector.authenticator=i),f.setConnector(this.connector);var n=this,d=new a(this.connector.connection.url);this.connector.timeoutProcessed=!1,this.connector.authenticator.on("loggedOut",function(e){if(f.stopGlobalSpinner(),!n.connector.timeoutProcessed){f.writeTrace("Session logged out."),f.disableSimpleSearch(),n.connector.timeoutProcessed=!0;var t=new g({"context":n.context,"centerVertically":!0});t.authenticate().done(function(e){t.beingAuthenticated=!1})}}),window.ServerOrigin=d.getOrigin(),window.ServerCgiScript=d.getCgiScript(),r.add(c);var u=e.when;e.whenAll=function(t){if(e.isArray(t)){var i=new e.Deferred;return u.apply(e,t).done(function(){i.resolve(Array.prototype.slice.call(arguments))}).fail(function(){i.reject(Array.prototype.slice.call(arguments))}),i.promise()}return u.apply(e,arguments)}},"onBeforeShow":function(t){var i=this,o=new g({"context":i.context,"centerVertically":!0});f.startGlobalSpinner(),o.authenticate().done(function(t){if(f.stopGlobalSpinner(),o.beingAuthenticated=!1,t){i.context.connector=f.getConnector();var n=w.getAddinConfig(i.context.connector);n.done(function(t){f.setConfig(t,i.context.csUser),i.getRegion("recentRegion").show(new d({"context":i.context})),i.getRegion("favoriteRegion").show(new u({"context":i.context})),i.getRegion("searchRegion").show(new p({"context":i.context,"enableEmailSaving":!0,"showSearchFormSelection":f.ShowSearchFormSelection}));var o=w.getSuggestedWkspConfig(i.context.connector);if(o.done(function(e){null==e||null==e.general?(f.SuggestedWkspsView=new m({"error":"NoConfiguration"}),i.getRegion("suggestedRegion").show(f.SuggestedWkspsView)):e.general.showSection?(f.SuggestedWkspsView=new m({"context":i.context,"config":e}),i.getRegion("suggestedRegion").show(f.SuggestedWkspsView)):i.getRegion("suggestedRegion").$el.css("display","none")}),o.fail(function(e){f.SuggestedWkspsView=new m({"error":e}),i.getRegion("suggestedRegion").show(f.SuggestedWkspsView)}),t.searchForm.enabled){var n=w.getSimpleSearchQueries(i.context.connector);n.done(function(t){if(null!=t&&0!==t.length){f.uiShow("customSearchButton");var o="calc(100vh - "+(f.SearchButtonHeight+f.TraceAreaHeight)+"px)";if(e("#customSearchButton").css("top",o),i.getRegion("customSearchRegion").show(new h({"context":i.context,"queries":t})),f.TraceAreaHeight>0){var n=document.querySelectorAll('iframe[id^="log4javascript_"]');if(n.length>0){var s=n[0].contentWindow.hide;"function"==typeof s&&(n[0].contentWindow.hide=function(){e("#customSearchButton").css("top","calc(100vh - "+f.SearchButtonHeight+"px)"),e(".tile-content").css("height","calc(100vh - "+f.SearchFormBottomPadding+"px)"),e("#saveDisplayArea").css("height","calc(100vh - 32px"),f.TraceAreaHeight=0,s()})}}}}),n.fail(function(t){e("#topMessage").html(f.getErrorMessage(t))})}i.context.fetch()}),n.fail(function(t){e("#topMessage").html(t)})}}),e("#conwsoutlook-body").focus()},"constructor":function(e){i.LayoutView.prototype.constructor.call(this,e)},"processKey":function(e){13!==e.which&&32!==e.which||"customerSearchButtonIcon"===e.target.id&&this.showCustomSearch(e)},"showCustomSearch":function(){f.uiHide("standardSections"),f.uiHide("customSearchButton"),f.uiShow("customSearchSection"),f.PreSaveSection="customSearchSection",e("#conwsoutlook-body").focus()}})}),csui.define("conws/widgets/configurationvolume/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/configurationvolume/impl/nls/root/lang",{"emptyResultsText":"There are no items to display."}),csui.define("css!conws/widgets/configurationvolume/impl/configurationvolume",[],function(){}),csui.define("conws/widgets/configurationvolume/configurationvolume.view",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/widgets/shortcuts/shortcuts.view","csui/controls/tile/behaviors/perfect.scrolling.behavior","csui/behaviors/keyboard.navigation/tabable.region.behavior","conws/models/configurationvolume/configurationvolume.factory","i18n!conws/widgets/configurationvolume/impl/nls/lang","css!conws/widgets/configurationvolume/impl/configurationvolume"],function(e,t,i,o,n,s,l,a,r){var c=o.View.extend({"className":"conws-empty-configurevolume-container","onShow":function(){this.$el.text(r.emptyResultsText)}}),d=["shade1","shade2","shade3","shade4"];return n.extend({"className":"conws-volumeshortcut-container csui-shortcut-container tile","attributes":{"role":"menu"},"constructor":function(e){e||(e={}),e.data||(e.data={}),e.perspectiveMode=!1,e.model=e.context.getModel(a,{}),n.prototype.constructor.call(this,e)},"emptyView":c,"buildChildView":function(e,t,i){return t===c?o.CollectionView.prototype.buildChildView.call(this,e,t,i):n.prototype.buildChildView.apply(this,arguments)},"modelEvents":{"change":"modelChange"},"childEvents":e.extend(n.prototype.childEvents,{"render":"onChildViewRender"}),"onChildViewRender":function(e){e.$el.addClass("csui-configurationvolume-container")},"currentlyFocusedElement":function(){var e=this.children.findByIndex(this._currentShortcutIndex);return e&&e.$el},"modelChange":function(){
this.collection.set(this.model.get("shortcutItems")),this._currentShortcutIndex=0},"_getShortcutTheme":function(e,t){var i=this.options.data.shortcutTheme?this.options.data.shortcutTheme:"csui-shortcut-theme-grey";if(t>1){var o=d.length;i+="-"+d[o-1-e%o]}return i},"behaviors":{"PerfectScrolling":{"behaviorClass":s,"suppressScrollX":!0,"scrollYMarginOffset":15},"TabableRegion":{"behaviorClass":l}}})}),csui.define("conws/widgets/metadata/general.fields/workspacetype/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/metadata/general.fields/workspacetype/impl/nls/root/lang",{"WorkspacetypeName":"Workspace Type"}),csui.define("conws/widgets/metadata/general.fields/workspacetype/metadata.general.form.field.controller",["csui/lib/underscore","csui/lib/jquery","csui/lib/backbone","csui/lib/marionette","csui/utils/url","csui/controls/form/form.view","i18n!conws/widgets/metadata/general.fields/workspacetype/impl/nls/lang"],function(e,t,i,o,n,s,l){return o.Controller.extend({"constructor":function(e){o.Controller.prototype.constructor.apply(this,arguments)},"getGeneralFormFields":function(){var e=this.options.model||this.options.node;if(848!==e.get("type"))return null;var o=t.Deferred(),n=new i.Model({"data":{"wksp_type_name":e.get("wksp_type_name")},"schema":{"properties":{"wksp_type_name":{"readonly":!0,"required":!1,"title":"","type":"string","hidden":!1}}},"options":{"fields":{"wksp_type_name":{"label":l.WorkspacetypeName,"hidden":!1,"readonly":!0,"hideInitValidationError":!1,"type":"text"}}}});return o.resolve([{"formModel":n,"formView":s}]),o.promise()}})}),csui.define("conws/widgets/metadata/metadata.general.form.fields",["conws/widgets/metadata/general.fields/workspacetype/metadata.general.form.field.controller"],function(e){return[{"controller":e}]}),csui.define("json!conws/widgets/relatedworkspaces/relatedworkspaces.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{widgetTitle}}","description":"{{widgetDescription}}","schema":{"type":"object","required":["workspaceTypeId","relationType"],"properties":{"title":{"type":"object","title":"{{tileTitle}}","description":"{{tileDescription}}"},"workspaceTypeId":{"type":"integer","title":"{{workspacetypeTitle}}","description":"{{workspacetypeDescription}}"},"relationType":{"type":"string","enum":["child","parent"],"title":"{{relationTypeTitle}}","description":"{{relationTypeDescription}}"},"collapsedView":{"type":"object","title":"{{collapsedViewTitle}}","description":"{{collapsedViewDescription}}","properties":{"noResultsPlaceholder":{"type":"object","title":"{{noResultsPlaceholderTitle}}","description":"{{noResultsPlaceholderDescription}}"},"preview":{"type":"object","title":"{{previewPaneTitle}}","description":"{{previewPaneDescription}}","properties":{"typeName":{"type":"object","title":"{{previewTitle}}","description":"{{previewDescription}}"},"noMetadataMessage":{"type":"object","title":"{{noMetadataMessageTitle}}","description":"{{noMetadataMessageDescription}}"},"roleId":{"type":"string","title":"{{roleTitle}}","description":"{{roleDescription}}"},"noRoleMembersMessage":{"type":"object","title":"{{noRoleMembersMessageTitle}}","description":"{{noRoleMembersMessageDesc}}"},"metadata":{"type":"array","title":"{{metadataTitle}}","description":"{{metadataDescription}}","items":{"type":"object","title":"{{CategoryOrAttributeTitle}}","description":"{{CategoryOrAttributeDesc}}"}}}},"orderBy":{"type":"object","title":"{{orderTitle}}","description":"{{orderDescription}}","properties":{"sortColumn":{"type":"string","title":"{{sortColumnTitle}}","description":"{{sortColumnDescription}}"},"sortOrder":{"type":"string","enum":["asc","desc"],"title":"{{sortOrderTitle}}","description":"{{sortOrderDescription}}"}}},"title":{"type":"object","title":"{{relatedWorkspaceTitle}}","description":"{{relatedWorkspaceDesc}}","properties":{"value":{"type":"string","title":"{{valueTitle}}","description":"{{valueDescription}}"}}},"description":{"type":"object","title":"{{descriptionSectionTitle}}","description":"{{descriptionSectionDesc}}","properties":{"value":{"type":"string","title":"{{descriptionValueTitle}}","description":"{{descriptionFieldValue}}"}}},"topRight":{"type":"object","title":"{{topRightSectionTitle}}","description":"{{topRightSectionDescription}}","properties":{"label":{"type":"object","title":"{{topRightLabel}}","description":"{{topRightLabelDesc}}"},"value":{"type":"string","title":"{{topRightValue}}","description":"{{topRightValueDesc}}"}}},"bottomLeft":{"type":"object","title":"{{bottomLeftTitle}}","description":"{{bottomLeftTitleDesc}}","properties":{"label":{"type":"object","title":"{{bottomLeftLabelTitle}}","description":"{{bottomLeftLabelDesc}}"},"value":{"type":"string","title":"{{bottomLeftValue}}","description":"{{bottomLeftValueDesc}}"}}},"bottomRight":{"type":"object","title":"{{bottomRightTitle}}","description":"{{bottomRightTitleDesc}}","properties":{"label":{"type":"object","title":"{{bottomRightLabel}}","description":"{{bottomRightLabelDesc}}"},"value":{"type":"string","title":"{{bottomRightValue}}","description":"{{bottomRightValueDesc}}"}}}}},"expandedView":{"type":"object","title":"{{expandedViewSectionTitle}}","description":"{{expandedViewSectionDesc}}","properties":{"orderBy":{"type":"object","title":"{{expandedViewOrderByTitle}}","description":"{{expandedViewOrderByDesc}}","properties":{"sortColumn":{"type":"string","title":"{{expandedViewSortColumnTitle}}","description":"{{expandedViewSortColumnDesc}}"},"sortOrder":{"type":"string","enum":["asc","desc"],"title":"Sort order","description":"{{expandedViewSortOrderDesc}}"}}},"customColumns":{"type":"array","title":"{{customColumnsSectionTitle}}","description":"{{customColumnsSectionDesc}}","items":{"type":"object","title":"{{customColumnsItemsTitle}}","description":"{{customColumnsItemsDesc}}","properties":{"key":{"type":"string","title":"{{customColumnsPropertiesTitle}}","description":"{{customColumnsPropertiesDesc}}"}}}}}}}},"options":{"fields":{"title":{"type":"otcs_multilingual_string"},"workspaceTypeId":{"type":"otconws_workspacetype_id"},"relationType":{"type":"select","optionLabels":["{{relationTypeOptionLabelChild}}","{{relationTypeOptionLabelParent}}"]},"collapsedView":{"fields":{"noResultsPlaceholder":{"type":"otcs_multilingual_string"},"preview":{"fields":{"typeName":{"type":"otcs_multilingual_string"},"noMetadataMessage":{"type":"otcs_multilingual_string"},"noRoleMembersMessage":{"type":"otcs_multilingual_string"},"metadata":{"fields":{"item":{"type":"otconws_metadata"}}}}},"orderBy":{"fields":{"sortColumn":{"type":"otconws_customcolumn"},"sortOrder":{"type":"select","optionLabels":["{{sortOrderOptionLabelAsc}}","{{sortOrderOptionLabelDesc}}"]}}},"title":{"fields":{"value":{"type":"otconws_customcolumn"}}},"description":{"fields":{"value":{"type":"otconws_customcolumn"}}},"topRight":{"fields":{"label":{"type":"otcs_multilingual_string"},"value":{"type":"otconws_customcolumn"}}},"bottomLeft":{"fields":{"label":{"type":"otcs_multilingual_string"},"value":{"type":"otconws_customcolumn"}}},"bottomRight":{"fields":{"label":{"type":"otcs_multilingual_string"},"value":{"type":"otconws_customcolumn"}}}}},"expandedView":{"fields":{"orderBy":{"fields":{"sortColumn":{"type":"otconws_customcolumn"},"sortOrder":{"type":"select","optionLabels":["{{sortOrderOptionLabelAsc}}","{{sortOrderOptionLabelDesc}}"]}}},"customColumns":{"items":{"fields":{"key":{"type":"otconws_customcolumn"}}}}}}}}}),csui.define("json!conws/widgets/header/header.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{tileTitle}}","description":"{{tileDescription}}","schema":{"type":"object","properties":{"workspace":{"type":"object","title":"{{workspaceTitle}}","description":"{{workspaceDescription}}","properties":{"properties":{"type":"object","title":"Properties","description":"{{workspacePropertiesDesc}}","properties":{"title":{"type":"string","title":"{{businessworkspaceTitle}}","default":"{name}","description":"{{businessworkspaceDesc}}"},"type":{"type":"string","title":"{{workspaceTypeTitle}}","default":"{business_properties.workspace_type_name}","description":"{{workspaceTypeDesc}}"},"description":{"type":"string","title":"{{descriptionSectionTitle}}","default":"{description}","description":"{{descriptionSection}}"}}}}},"widget":{"type":"object","title":"{{widgetTitle}}","description":"{{widgetDescription}}","properties":{"type":{"type":"string","enum":["none","activityfeed"],"title":"{{embedWidgetSectionTitle}}","description":"{{embedWidgetSectionDesc}}"}}}}},"options":{"fields":{"workspace":{"fields":{"properties":{"fields":{"title":{"type":"otconws_metadata_string"},"type":{"type":"otconws_metadata_string"},"description":{"type":"otconws_metadata_string"}}}}},"widget":{"fields":{"type":{"type":"select","optionLabels":["{{embedWidgetOptionLabelNone}}","{{embedWidgetOptionLabelActivityFeed}}"]}}}}}}),csui.define("json!conws/widgets/team/team.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{widgetTitle}}","description":"{{widgetDescription}}","schema":{"type":"object","properties":{"title":{"type":"object","title":"{{tileTitle}}","description":"{{tileDescription}}"}}},"options":{"fields":{"title":{"type":"otcs_multilingual_string"}}}}),csui.define("json!conws/widgets/myworkspaces/myworkspaces.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{tileTitle}}","description":"{{tileDescription}}","schema":{"type":"object","required":["workspaceTypeId"],"properties":{"title":{"type":"object","title":"{{titleSection}}","description":"{{titleDescription}}"},"workspaceTypeId":{"type":"integer","title":"{{WorkspaceTypeTitle}}","description":"{{WorkspaceTypeDesc}}"},"collapsedView":{"type":"object","title":"{{collapsedViewTitle}}","description":"{{collapsedViewDesc}}","properties":{"noResultsPlaceholder":{"type":"object","title":"{{noResultsPlaceholderTitle}}","description":"{{noResultsPlaceholderDesc}}"}}},"expandedView":{"type":"object","title":"{{expandedViewTitle}}","description":"{{expandedViewDesc}}","properties":{"customColumns":{"type":"array","title":"{{customColumnsTitle}}","description":"{{customColumnsDesc}}","items":{"type":"object","description":"{{itemsSectionDesc}}","properties":{"key":{"type":"string","description":"{{keyDescription}}"}}}},"orderBy":{"type":"object","title":"{{orderBySectionTitle}}","description":"{{orderBySectionDesc}}","properties":{"sortColumn":{"type":"string","description":"{{sortColumnSectionDesc}}"},"sortOrder":{"type":"string","default":"asc","enum":["asc","desc"],"title":"{{sortOrderSectionTitle}}","description":"{{sortOrderSectionDesc}}"}}}}}}},"options":{"fields":{"title":{"type":"otcs_multilingual_string"},"workspaceTypeId":{"type":"otconws_workspacetype_id"},"collapsedView":{"fields":{"noResultsPlaceholder":{"type":"otcs_multilingual_string"}}},"expandedView":{"fields":{"customColumns":{"items":{"fields":{"key":{"type":"otconws_customcolumn","type_control":{"parameters":{"dialogTitle":"{{customColumnPickerTitle}}"}}}}}},"orderBy":{"fields":{"sortColumn":{"type":"otconws_customcolumn","type_control":{"parameters":{"dialogTitle":"{{customColumnPickerTitle}}"}}},"sortOrder":{"type":"select","optionLabels":["{{sortOrderOptionLabelAsc}}","{{sortOrderOptionLabelDesc}}"]}}}}}}}}),csui.define("json!conws/widgets/metadata/metadata.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{widgetTitle}}","description":"{{widgetDescription}}","schema":{"type":"object","properties":{"title":{"type":"object","title":"{{tileTitle}}","description":"{{tiledescription}}"},"hideEmptyFields":{"type":"boolean","enum":[!0,!1],"default":!1,"title":"{{hideEmptyFieldsTitle}}","description":"{{hideEmptyFieldsDescription}}"},"relatedWorkspaces":{"type":"object","title":"{{relatedWSSectionTitle}}","description":"{{relatedWSSectionDescription}}","properties":{"relatedGroupName":{"type":"object","title":"{{relatedGroupNameTitle}}","description":"{{relatedGroupNameDescription}}"},"workspaceTypes":{"type":"array","title":"{{metadataTitle}}","description":"{{metadataDescription}}","items":{"type":"object","properties":{"workspaceTypeId":{"title":"{{workspacetypeTitle}}","description":"{{workspacetypeTitleDescription}}","type":"integer"}}}}}},"metadata":{"type":"array","title":"{{metadataSectionTitle}}","description":"{{metadataSectionDescription}}","items":{"type":"object","title":"{{categoryOrAttributeTitle}}","description":"{{categoryOrAttributeDescription}}"}}}},"options":{"fields":{"title":{"type":"otcs_multilingual_string"},"relatedWorkspaces":{"fields":{"relatedGroupName":{"type":"otcs_multilingual_string"},"workspaceTypes":{"items":{"fields":{"workspaceTypeId":{"type":"otconws_workspacetype_id"}}}}}},"metadata":{"fields":{"item":{"type":"otconws_metadata"}}}}}}),csui.define("json!conws/widgets/configurationvolume/configurationvolume.manifest.json",{"$schema":"http://opentext.com/cs/json-schema/draft-04/schema#","title":"{{widgetTitle}}","description":"{{widgetDescription}}","kind":"tile","schema":{"type":"object","properties":{"shortcutTheme":{"title":"{{shortcutThemeTitle}}","description":"{{shortcutThemeDescription}}","type":"string","enum":["csui-shortcut-theme-stone1","csui-shortcut-theme-stone2","csui-shortcut-theme-teal1","csui-shortcut-theme-teal2","csui-shortcut-theme-pink1","csui-shortcut-theme-pink2","csui-shortcut-theme-indigo1","csui-shortcut-theme-indigo2"]}}},"options":{"fields":{"shortcutTheme":{"type":"select","optionLabels":["{{shortcutThemeStone1}}","{{shortcutThemeStone2}}","{{shortcutThemeTeal1}}","{{shortcutThemeTeal2}}","{{shortcutThemePink1}}","{{shortcutThemePink2}}","{{shortcutThemeIndigo1}}","{{shortcutThemeIndigo2}}"]}}}}),csui.define("conws/widgets/configurationvolume/impl/nls/configurationvolume.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/configurationvolume/impl/nls/root/configurationvolume.manifest",{"widgetTitle":"Configuration Volume","widgetDescription":"Tile representing hyperlinks to volumes; it navigates to its page when clicked","shortcutThemeTitle":"Theme","shortcutThemeDescription":"Styling of the volumes","shortcutThemeStone1":"Stone Group 1","shortcutThemeStone2":"Stone Group 2","shortcutThemeTeal1":"Teal Group 1","shortcutThemeTeal2":"Teal Group 2","shortcutThemePink1":"Pink Group 1","shortcutThemePink2":"Pink Group 2","shortcutThemeIndigo1":"Indigo Group 1","shortcutThemeIndigo2":"Indigo Group 2"}),csui.define("conws/widgets/team/impl/nls/team.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/team/impl/nls/root/team.manifest",{"tileTitle":"Title","tileDescription":"Title in collapsed view","widgetTitle":"Team","widgetDescription":"Shows the team members of a business workspace"}),csui.define("conws/widgets/metadata/impl/nls/metadata.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/metadata/impl/nls/root/metadata.manifest",{"tileTitle":"Title","tiledescription":"Title of the Metadata widget","widgetTitle":"Metadata","widgetDescription":"Shows metadata for a business workspace","hideEmptyFieldsTitle":"Hide empty fields","hideEmptyFieldsDescription":"Display only fields with values","metadataSectionTitle":"Metadata","metadataSectionDescription":"Metadata displayed in Metadata widget","categoryOrAttributeTitle":"Category or attribute","categoryOrAttributeDescription":"Category or attribute with metadata","relatedWSSectionTitle":"Related Workspaces","relatedWSSectionDescription":"Links to parent business workspaces","workspacetypeTitle":"Workspace type","workspacetypeTitleDescription":"A single related workspace of this workspace type will be displayed in the widget","relatedGroupNameTitle":"Group Name","relatedGroupNameDescription":"Entering a name will create a group with that name. Workspace types will be added to the group. Clearing the field causes Workspace types to be added normally.","metadataTitle":"Workspace types","metadataDescription":"Workspace type list to show one related workspace of every configured workspace type in this widget"}),csui.define("conws/widgets/relatedworkspaces/impl/nls/relatedworkspaces.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/relatedworkspaces/impl/nls/root/relatedworkspaces.manifest",{"widgetTitle":"Related Workspaces","widgetDescription":"Shows the related business workspaces for a business workspace","tileTitle":"Title","tileDescription":"Title of the Related Workspaces widget","workspacetypeTitle":"Workspace type","workspacetypeDescription":"Workspace type displayed in this widget","relationTypeTitle":"Relation type","relationTypeDescription":"Relation type of the related workspaces","relationTypeOptionLabelChild":"Child","relationTypeOptionLabelParent":"Parent","collapsedViewTitle":"Collapsed view","collapsedViewDescription":"Options for the collapsed view of this widget","noResultsPlaceholderTitle":"Message for empty result","noResultsPlaceholderDescription":"Message if there are no related business workspaces to display","previewPaneTitle":"Preview pane","previewPaneDescription":"Options for the preview pane","previewTitle":"Preview title","previewDescription":"Title of the preview pane","noMetadataMessageTitle":"Message for empty metadata","noMetadataMessageDescription":"Message if there is no metadata to display","roleTitle":"Name of role","roleDescription":"The members of the specified role are displayed in the preview","noRoleMembersMessageTitle":"Message for empty role","noRoleMembersMessageDesc":"Message if there are no role members assigned to the specified role","metadataTitle":"Metadata in preview pane","metadataDescription":"Metadata displayed in preview pane","CategoryOrAttributeTitle":"Category or attribute","CategoryOrAttributeDesc":"Category or attribute with metadata","orderTitle":"Order by","orderDescription":"Sort order of the displayed business workspaces","sortColumnTitle":"Column","sortColumnDescription":"Column to order by","sortOrderTitle":"Sort order","sortOrderDescription":"Sort order to be used","sortOrderOptionLabelAsc":"Ascending","sortOrderOptionLabelDesc":"Descending","relatedWorkspaceTitle":"Related workspace title","relatedWorkspaceDesc":"Title of the related workspace in collapsed view","valueTitle":"Title","valueDescription":"Value for the Title field","descriptionSectionTitle":"Related workspace description","descriptionSectionDesc":"Description of the related workspace in collapsed view","descriptionValueTitle":"Description","descriptionFieldValue":"Value for the description field","topRightSectionTitle":"Top right metadata field","topRightSectionDescription":"Metadata displayed in top right  metadata field in collapsed view","topRightLabel":"Label","topRightLabelDesc":"Label for the metadata field","topRightValue":"Value","topRightValueDesc":"Value for the top right metadata field","bottomLeftTitle":"Bottom left  metadata field","bottomLeftTitleDesc":"Metadata displayed in bottom left  metadata field in collapsed view","bottomLeftLabelTitle":"Label","bottomLeftLabelDesc":"Label for the metadata field","bottomLeftValue":"Value","bottomLeftValueDesc":"Value for the bottom left metadata  metadata field","bottomRightTitle":"Bottom right  metadata field","bottomRightTitleDesc":"Metadata displayed in bottom right  metadata field in collapsed view","bottomRightLabel":"Label","bottomRightLabelDesc":"Label for the metadata field","bottomRightValue":"Value","bottomRightValueDesc":"Value for the bottom right metadata  metadata field","expandedViewSectionTitle":"Expanded view","expandedViewSectionDesc":"Options for the expanded view of this widget","expandedViewOrderByTitle":"Order by","expandedViewOrderByDesc":"Sort order of the displayed business workspaces","expandedViewSortColumnTitle":"Column","expandedViewSortColumnDesc":"Column to order by","expandedViewSortOrderTitle":"Sort order","expandedViewSortOrderDesc":"Sort order to be used","customColumnsSectionTitle":"Custom columns","customColumnsSectionDesc":"Columns displayed in expanded view","customColumnsItemsTitle":"Column description","customColumnsItemsDesc":"Column displayed in expanded view","customColumnsPropertiesTitle":"Column","customColumnsPropertiesDesc":"Name of the custom column"}),csui.define("conws/widgets/header/impl/nls/header.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/header/impl/nls/root/header.manifest",{"tileTitle":"Header","tileDescription":"Header widget for business workspaces","workspaceTitle":"Workspace","workspaceDescription":"Workspace specific options","workspacePropertiesTitle":"Properties","workspacePropertiesDesc":"Configuration properties","businessworkspaceTitle":"Title","businessworkspaceDesc":"Name of the business workspace","workspaceTypeTitle":"Type","workspaceTypeDesc":"Name of the workspace type","descriptionSectionTitle":"Description","descriptionSection":"Description of the business workspace","widgetTitle":"Widget","widgetDescription":"Additional widget that can be embedded in the header widget","embedWidgetSectionTitle":"Embed widget","embedWidgetSectionDesc":"Widget to be embedded in the header widget","embedWidgetOptionLabelNone":"None","embedWidgetOptionLabelActivityFeed":"Activity Feed"}),csui.define("conws/widgets/myworkspaces/impl/nls/myworkspaces.manifest",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/widgets/myworkspaces/impl/nls/root/myworkspaces.manifest",{"tileTitle":"Workspaces","tileDescription":"Shows business workspaces that are relevant in this perspective and role","titleSection":"Title","titleDescription":"Title of the Workspaces widget","WorkspaceTypeTitle":"Workspace type","WorkspaceTypeDesc":"Workspace type displayed in this widget","collapsedViewTitle":"Collapsed view","collapsedViewDesc":"Options for the collapsed view of the widget","noResultsPlaceholderTitle":"Message for empty result","noResultsPlaceholderDesc":"Message if there are no business workspaces to display","expandedViewTitle":"Expanded view","expandedViewDesc":"Options for the expanded view of this widget","orderBySectionTitle":"Sort by","orderBySectionDesc":"Sort order of the displayed business workspaces","sortColumnSectionDesc":"Column to order by","sortOrderSectionTitle":"Direction","sortOrderSectionDesc":"Sort order to be used","sortOrderOptionLabelAsc":"Ascending","sortOrderOptionLabelDesc":"Descending","customColumnsTitle":"Custom columns","customColumnsDesc":"Columns displayed in expanded view","customColumnPickerTitle":"Column","itemsSectionDesc":"Column displayed in expanded view","keyDescription":"Name of the custom column"}),csui.define("conws/utils/usersettings/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("conws/utils/usersettings/impl/nls/root/lang",{"navModeLabel":"Navigation tree","navModeText":"When on, a navigation tree lets you browse a business workspace. When off, a simple up-navigation is available.","navHeader":"Business Workspace","navInvalidAttribute":"Attribute {0} is invalid."}),csui.define("conws/utils/usersettings/impl/usersettings.model",["module","csui/lib/jquery","csui/lib/underscore","csui/lib/backbone","csui/utils/url","csui/utils/log","csui/models/mixins/connectable/connectable.mixin","csui/models/mixins/uploadable/uploadable.mixin","i18n!conws/utils/usersettings/impl/nls/lang"],function(e,t,i,o,n,s,l,a,r){"use strict";var c=new s(e.id),d=o.Model.extend({"constructor":function(e){o.Model.prototype.constructor.apply(this,arguments),this.set({"id":e.userid},{"silent":!0}),this.makeConnectable(e),this.makeUploadable(e)},"validate":function(){if(!0!==this.get("conwsNavigationTreeView")&&!1!==this.get("conwsNavigationTreeView")){var e=i.str.sformat(r.navInvalidAttribute,"conwsNavigationTreeView");return c.debug(e),e}},"url":function(){var e=n.combine(this.connector.getConnectionUrl().getApiBase("v2"),"members/preferences");return e=n.appendQuery(e,"metadata=true&config_name=SmartUI")},"parse":function(e,t){if(Array.isArray(e.results)){var i=e.results[0].data,o=!1;return i&&"SmartUI"===i.config_name?o=i.preferences.conwsNavigationTreeView:c.debug("could not read conwsNavigationTreeView in response, defaulting to 'false'"),{"conwsNavigationTreeView":o}}var n=e.links.data.self;if("PUT"===n.method&&0===n.body.length)return{};c.debug("incomprehensible response of PUT")},"prepare":function(e,t){return{"SmartUI":{"conwsNavigationTreeView":e.conwsNavigationTreeView}}}});return l.mixin(d.prototype),a.mixin(d.prototype),d}),csui.define("conws/utils/usersettings/usersettings.tabs/navigation.field.view",["csui/lib/jquery","csui/lib/underscore","csui/lib/marionette","csui/models/form","csui/models/forms","csui/controls/form/form.view","csui/utils/contexts/page/page.context","csui/controls/progressblocker/blocker","csui/utils/base","csui/dialogs/modal.alert/modal.alert","conws/utils/usersettings/impl/usersettings.model","i18n!conws/utils/usersettings/impl/nls/lang"],function(e,t,i,o,n,s,l,a,r,c,d,u){"use strict";return i.ItemView.extend({"constructor":function(e){this.model=new d(e),i.ItemView.prototype.constructor.apply(this),this.settingsModeChanged=this.model.get("settingsModeChanged")||!1,a.imbue(this),this.model.fetch(),this.listenTo(this.model,"sync",this.onRender).listenTo(this.model,"error",function(e,t,i){this.unblockActions.apply(this,arguments),t&&c.showError(new r.Error(t).message)})},"tagName":"div","template":!1,"getRawFormsData":function(e){return{"forms":[{"data":{"conwsNavigationTreeView":e},"options":{"fields":{"conwsNavigationTreeView":{"hidden":!1,"label":u.navModeLabel,"type":"checkbox","helper":u.navModeText}}},"schema":{"properties":{"conwsNavigationTreeView":{"readonly":!1,"required":!1,"type":"boolean"}},"title":u.navHeader,"type":"object"}}]}},"onRender":function(){var e=this.model.get("conwsNavigationTreeView"),t=new n;t.reset(t.parse(this.getRawFormsData(e)));var a=new o(t.models[0].attributes.forms[0]),r=new i.Region({"el":this.el}),c=new s({"context":new l,"model":a,"mode":"create"});this.listenTo(c,"change:field",function(e){this.settingsModeChanged=!this.settingsModeChanged,this.model.set({"settingsModeChanged":this.settingsModeChanged,"conwsNavigationTreeView":e.value}),this.model.save()},this),this.listenTo(c,"render:form",function(e){this.trigger("childview:rendered")},this),r.show(c)}})}),csui.define("conws/utils/usersettings/usersettings.tabs/core.usersettings.tabs",["conws/utils/usersettings/usersettings.tabs/navigation.field.view"],function(e){return{"sequence":101,"viewClass":e}}),csui.define("bundles/conws-app",["conws/utils/icons/icons","conws/utils/icons/conws.icons.v2","conws/controls/inlineforms/conwstemplate/conws.inlineform.schemas","conws/controls/form/fields/alpaca/referencefield","conws/controls/form/fields/alpaca/alpcustomcolumnpickerfield","conws/controls/form/fields/alpaca/alpworkspacetypefield","conws/controls/form/fields/alpaca/alpworkspacefield","conws/controls/form/fields/customcolumnpickerfield.view","conws/controls/form/fields/reference.view","conws/controls/form/fields/workspacefield.view","conws/controls/description/description.view","conws/controls/lazyactions/lazyToolbar.view","conws/controls/selectedmetadataform/selectedmetadataform.view","conws/controls/table/cells/role/role.view","conws/controls/table/cells/permission/role.permission.level.view","conws/controls/userpicker/role.view","conws/controls/userpicker/conws.roles","conws/dialogs/addoreditrole/addoreditrole.wizard","conws/dialogs/applyrolepermissions/apply.role.permissions.view","conws/dialogs/regen.reference/regen.reference.view","conws/dialogs/applyrolepermissions/impl/header/apply.role.permissions.header.view","conws/dialogs/node.picker/start.locations/facets.volume/facets.volume.factory","conws/utils/commands/tabletoolbar.extension","conws/utils/commands/navigate/toolbaritems","conws/utils/commands/permissions/permissions.dropdown.menu.items.extension","conws/utils/commands/permissions/permissions.list.toolbaritems.extension","conws/controls/treebrowse/workspace.navigation.tree.plugin","conws/controls/navigation.header/conws.add.navigation.header.controls","conws/widgets/navigation.header/controls/create.workspace/create.workspace.view","conws/controls/breadcrumbspanel/breadcrumbspanel.extension","conws/utils/context.help/context.help.ids","conws/widgets/header/impl/headertoolbaritems.masks","conws/utils/commands/addconws","conws/utils/commands/addbwsfromsidepanel","conws/utils/commands/addconwstemplate","conws/utils/commands/navigate/navigateup","conws/utils/commands/move","conws/utils/commands/delete","conws/utils/commands/permissions/addoreditrole","conws/utils/commands/addrelateditem","conws/utils/commands/deleterelateditem","conws/utils/commands/permissions/deleterole","conws/utils/commands/permissions/edit.role.permissions","conws/utils/commands/permissions/edit.role.permission.helper","conws/utils/dragndrop/dragndrop.subtypes","conws/widgets/relatedworkspaces/addrelatedworkspaces.search","conws/widgets/relatedworkspaces/relatedworkspaces.view","conws/widgets/header/header.view","conws/widgets/team/team.view","conws/widgets/myworkspaces/myworkspaces.view","conws/widgets/metadata/metadata.view","conws/widgets/outlook/conwsoutlook.view","conws/widgets/configurationvolume/configurationvolume.view","conws/widgets/metadata/metadata.general.form.fields","json!conws/widgets/relatedworkspaces/relatedworkspaces.manifest.json","json!conws/widgets/header/header.manifest.json","json!conws/widgets/team/team.manifest.json","json!conws/widgets/myworkspaces/myworkspaces.manifest.json","json!conws/widgets/metadata/metadata.manifest.json","json!conws/widgets/configurationvolume/configurationvolume.manifest.json","conws/widgets/outlook/impl/utils/emailservice","conws/widgets/outlook/impl/utils/utility","i18n!conws/widgets/team/impl/nls/team.lang","i18n!conws/utils/previewpane/impl/nls/previewpane.lang","i18n!conws/widgets/outlook/impl/nls/lang","i18n!conws/widgets/configurationvolume/impl/nls/lang","i18n!conws/widgets/configurationvolume/impl/nls/configurationvolume.manifest","i18n!conws/widgets/team/impl/nls/team.manifest","i18n!conws/widgets/metadata/impl/nls/metadata.manifest","i18n!conws/widgets/relatedworkspaces/impl/nls/relatedworkspaces.manifest","i18n!conws/widgets/header/impl/nls/header.manifest","i18n!conws/widgets/myworkspaces/impl/nls/myworkspaces.manifest","conws/utils/usersettings/usersettings.tabs/core.usersettings.tabs"],{}),csui.require(["require","css"],function(e,t){t.styleLoad(e,"conws/bundles/conws-app",!0)});
//# sourceMappingURL=conws-app.js.map