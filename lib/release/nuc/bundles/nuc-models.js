csui.define("nuc/utils/log",["module","require","nuc/lib/underscore","nuc/lib/underscore.string"],function(e,t,n){"use strict";function i(e,t){if(e.setDocumentReady(),h=e.getLogger(),d.window&&(f=new e.PopUpAppender,f.setNewestMessageAtTop(!1),f.setScrollToLatestMessage(!0),f.setLayout(new e.PatternLayout("%d{HH:mm:ss.SSS} %-5p - %m{1}")),h.addAppender(f)),d.page&&(f=new e.InPageAppender(d.placeholder),f.setNewestMessageAtTop(!1),f.setScrollToLatestMessage(!0),f.setShowHideButton(!0),f.setShowCommandLine(!0),f.setLayout(new e.PatternLayout("%d{HH:mm:ss.SSS} %-5p - %m{1}")),h.addAppender(f)),d.consoleRe&&(f=new t,f.setLayout(new e.PatternLayout("%d{HH:mm:ss.SSS} %-5p - %m{1}")),h.addAppender(f)),d.server){f=new e.AjaxAppender(d.server.url),f.setLayout(new e.JsonLayout),f.setTimed(!1!==d.server.timed),f.setTimerInterval(d.server.timerInterval||500),f.setBatchSize(d.server.batchSize||10),f.setWaitForResponse(!1),f.setSendAllOnUnload(!0);var i=n.extend({"content-type":"application/json"},d.server.headers);n.each(n.keys(i),function(e){f.addHeader(e,i[e])}),h.addAppender(f)}h.setLevel(e.Level.DEBUG)}function o(e){if(!(this instanceof o))return new o(e);this._target=e,n.find(d.modules,function(t,n){if(r(n,e))return t.level&&(this._threshold=c(t.level)),void 0!==t.timing&&(this.timing=t.timing),!0},this)}function s(e,t,n){if(v&&this._threshold<=e){var i=a.apply(this,n);if(b)if(h){if(y){for(var o=0,s=y.length;o<s;++o){var r=y[o];h[p[r[0]]](r[1])}y=null}h[p[t]](i)}else y.push([t,i]);if(g)return this.last=t+"  "+i,!0}return!1}function r(e,t){return"**"===e?e=".*":"*"===e?e="[^/]*":(e=e.replace(/^\*(?!\*)/g,"#"),e=e.replace(/([^*])\*$/g,"$1#"),e=e.replace(/\/\*(?!\*)/g,"/#"),e=e.replace(/([^*])\*\//g,"$1#/"),e=e.replace(/\/\*\*/g,"(?:/.*)?"),e=e.replace(/\*\*\//g,"(?:.*/)?"),e=e.replace(/#/g,"[^/]*")),e="^"+e+"$",new RegExp(e).test(t)}function c(e){var t=m[(e||"WARN").toUpperCase()];if(!t)throw new Error('invalid log level: "'+e+'".');return t}function a(e){return void 0!==e?(e="string"==typeof e?n.str.sformat.apply(this,arguments):null!==e?e.toString():"null",d.performanceTimeStamp&&(e=u()+e),d.moduleNameStamp&&this._target&&(e+=" ("+this._target+")")):e="",e}function u(){return"["+(window.performance.now()/1e3%10).toFixed(3)+"] "}function l(e){return this._target&&(e=n.str.sformat("[{0}] {1}",this._target,e)),e}var d=e.config();n.defaults(d,{"console":!0,"consoleRe":!1,"level":"WARN","timing":!1,"page":!1,"performanceTimeStamp":!1,"moduleNameStamp":!1,"server":!1,"window":!1,"modules":{}});var h,f,m={"ERROR":4,"WARN":3,"INFO":2,"DEBUG":1,"ALL":1},p={"ERR":"errpr","WRN":"warn","INF":"info","DBG":"debug"},g="undefined"!=typeof console&&d.console,b=d.window||d.page||d.server||d.consoleRe,v=g||b,y=[];if(b){var x=["nuc/lib/log4javascript"];d.consoleRe&&x.push("nuc/utils/log/console.re.appender"),x.every(function(e){return t.defined(e)})?i(t("nuc/lib/log4javascript"),d.consoleRe&&t("nuc/utils/log/console.re.appender")):t(x,i)}var C={"_threshold":c(d.level),"config":d,"enabled":v,"last":void 0,"can":function(e){return v&&this._threshold<=c(e)},"debug":function(){return s.call(this,m.DEBUG,"DBG",arguments)},"info":function(){return s.call(this,m.INFO,"INF",arguments)},"warn":function(){return s.call(this,m.WARN,"WRN",arguments)},"error":function(){return s.call(this,m.ERROR,"ERR",arguments)},"time":function(e){this.timing&&console.time(l.call(this,e))},"timeEnd":function(e){this.timing&&console.timeEnd(l.call(this,e))},"getObjectName":function(e){return null!=e?Object.getPrototypeOf(e).constructor.name:void 0===e?"undefined":null===e?"null":""},"getStackTrace":function(e){var t;try{throw new Error}catch(e){t=e.stack}if(t){var n=t.split("\n");n&&n.length>0&&(n[0].match(/\.js/)||(n=n.slice(1)),t=n.slice(0===e?0:e||1).join("\n"))}else t="at unknown place (no stack trace available)";return t}};return n.extend(o,C),n.extend(o.prototype,C),o}),csui.define("nuc/utils/url",["nuc/lib/underscore","nuc/lib/jquery"],function(e,t){"use strict";function n(e){this.raw=e}return n.prototype={"raw":void 0,"isValid":function(){return!!this.raw&&this.raw.match(n.re_weburl)},"isAbsolute":function(){return!!this.raw&&this.raw.match(/^.*\/\//)},"getAbsolute":function(){if(this.isAbsolute())return this.raw;var e=location.origin&&location.origin.indexOf("://")>0?location.origin:new n(location.href).getOrigin();return n.combine(e,this.raw)},"getProtocol":function(){var e=this.isAbsolute()&&0!==this.raw.indexOf("//")?this.raw:window.location.href;return e.toLowerCase().substring(0,e.indexOf(":"))},"getHost":function(){var e=this.getAbsolute().match(/^.*\/\/([^:\/]+)/);return e&&e[1]},"getPort":function(){var e=this.getAbsolute().toLowerCase(),t=e.match(/^.*\/\/([^\/]+)/),n=t&&t[1].match(/:([^\/]+)/);return n?parseInt(n[1],10):0===e.indexOf("https")?443:80},"getOrigin":function(){var e=this.getAbsolute().match(/^.*\/\/[^\/]+/);return e&&e[0]},"getPath":function(){var e=this.getAbsolute().match(/^.*\/\/[^\/]+(\/[^?]+)/);return e&&e[1]},"getVirtualDirectory":function(){var e=this.getAbsolute().match(/^.*\/\/[^\/]+\/[^\/]+/);return e&&e[0]},"getCgiScript":function(){var e=this.getAbsolute(),t=e.length-7;if("/"===e.charAt(this.raw.length-1)&&--t,e.lastIndexOf("/api/v1")===t)return e.substr(0,t);var n=e.match(/^.*\/\/[^\/]+\/[^\/]+\/[^\/]+/);return n&&n[0]},"getQuery":function(){var e=this.getAbsolute().match(/\?(.+)/);return e&&e[1]},"getApiBase":function(e){return e||(e="v1"),"number"==typeof e&&(e="v"+e),this.getCgiScript()+"/api/"+e+"/"},"makeAbsoluteUrl":function(e,t){if(!e.match(/^\w+:\/\//)){var i=e.charAt(0);return"/"===i?"/"===e.charAt(1)?this.getProtocol()+":"+e:n.combine(this.getOrigin(),e):"?"===i?this.getCgiScript()+e:(t||(t=this.getCgiScript()),n.combine(t,e))}return e},"toString":function(){return this.raw}},n.version="1.0",n.combine=function(){for(var e="",t=0;t<arguments.length;++t){var n=arguments[t],i=void 0!==n&&null!==n?n.toString():"";"/"==i.charAt(0)?e+=e&&"/"==e.charAt(e.length-1)?i.substring(1):i:(t>0&&(!e||"/"!=e.charAt(e.length-1))&&i.length>0&&(e+="/"),e+=i)}return e},n.makeMultivalueParameter=function(t,n){return n&&n.length?(n=e.map(n,encodeURIComponent),t+"="+n.join("&"+t+"=")):""},n.combineQueryString=function(){var n,i,o={};for(n=0;n<arguments.length;++n)i=arguments[n],e.isObject(i)&&e.extend(o,i);for(o=t.param(o,!0),n=0;n<arguments.length;++n)i=arguments[n],e.isString(i)&&i&&(o&&(o+="&"),o+=i);return o},n.appendQuery=function(e,t){if(t){if(e.indexOf("?")>=0){var n=e[e.length-1];"?"!==n&&"&"!==n&&(e+="&")}else e+="?";e+=t}return e},n.urlParams=function(e){if(e){var n=e.indexOf("#"),i=e.indexOf("?");if(-1!==i)return t.parseParams(e.substring(i,-1===n?e.length:n))}return{}},n.mergeUrlParams=function(i,o,s){var r=n.urlParams(i),c=s.concat(e.keys(r)),a=e.omit(t.parseParams(o),c);return t.param(a)},n.re_weburl=new RegExp("^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?$","i"),n}),csui.define("nuc/utils/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("nuc/utils/impl/nls/root/lang",{"ColumnMemberName2":"{1} {0}","ColumnMemberName3":"{1} {2} {0}","sizeInBytes":"{0} bytes","ErrorUnknown":"Unknown error.","InvalidResponse":"Invalid response received.","ErrorStatusConfirm":"Confirm","ErrorStatusError":"Error","ErrorStatusWarning":"Warning","ErrorStatusHint":"Hint","ErrorStatusInformation":"Information","ErrorHtmlTpl":"<span class='msgIcon <%= statusPlain %>Icon'><%= statusNice %>: <%= msg %></span><br>","ErrorStringTpl":"<%= statusNice %>: <%= msg %>;\n","AuthenticationFailureDialogTitle":"Authentication failure","SessionExpiredDialogTitle":"Session expired","AuthenticationFailureDialogText":"The page will be reloaded and you may need to sign in again.","NetworkError":"Network communication failed.","resourceConflict":"Due to an edit conflict, your changes could not be saved. Another user has changed the same object. Reload the page to reflect the latest changes."}),csui.define("nuc/utils/errormessage",["module","nuc/lib/jquery","nuc/lib/underscore","nuc/lib/backbone","nuc/utils/log","nuc/utils/url","i18n!nuc/utils/impl/nls/lang"],function(e,t,n,i,o,s,r){"use strict";var c={"Confirm":0,"Error":1,"Warning":2,"Hint":3,"Info":4},a=i.Model.extend({"constructor":function(e){i.Model.prototype.constructor.apply(this,arguments),e instanceof Error&&(this.attributes.message=e.message,this.attributes.name=e.name)},"defaults":{"type":c.Error,"name":"","message":r.ErrorUnknown},"getType":function(){return this.get("type")},"getName":function(){return this.get("name")},"getMessage":function(){return this.get("message")}}),u=a.extend({"constructor":function(e){a.Message.prototype.constructor.apply(this,arguments)},"defaults":{"type":c.Error,"message":r.ErrorUnknown}}),l=u.extend({"defaults":{"statusCode":void 0,"statusText":void 0,"errorDetails":void 0},"constructor":function(e){if(a.ErrorMessage.prototype.constructor.apply(this,arguments),e)if(null!=e.status){if(this.statusCode=e.status,this.statusText=e.statusText,e.responseText)try{e.responseJSON=JSON.parse(e.responseText)}catch(e){o.warn("Parsing error response failed: {0}.",e)&&console.warn(o.last)}if(e.responseJSON){var t=e.responseJSON;this.message=t&&t.error,this.message||(this.message=e.responseText),this.errorDetails=t&&t.errorDetail}this.message||(0===this.statusCode?this.message=r.NetworkError:this.message=r.InvalidResponse),e.settings&&e.settings.url&&(this.method=e.settings.type,this.url=e.settings.url)}else"object"==typeof e.error?(this.message=e.error,this.errorDetails=e.errorDetail):e instanceof i.Model?(this.message=e.message||e.get("error"),this.errorDetails=e.errorDetails||e.errorDetail||e.get("errorDetails")||e.get("errorDetail")):e instanceof Error?this.message=e.message:n.extend(this,e)}});return l.prototype.toString=function(){var e=/[.!?:;,]$/,t=/\s+$/,n="";return this.message&&(n=this.message,n.replace(t,""),n.match(e)||(n+=".")),this.errorDetails&&(n&&(n+="\r\n"),n+=this.errorDetails,n.replace(t,""),n.match(e)||(n+=".")),n||(this.statusText&&(n&&(n+="\r\n"),n+=this.statusText),this.statusCode>0&&(n&&(n+="\r\n "),n+="("+this.statusCode+")")),n||(n=r.ErrorUnknown),n},l.version="1.0",a={"verion":"1.0","Type":c,"Message":a,"ErrorMessage":u,"RequestErrorMessage":l}}),csui.define("nuc/utils/messagehelper",["module","nuc/lib/jquery","nuc/lib/underscore","nuc/lib/backbone","nuc/utils/log","nuc/utils/errormessage","i18n!nuc/utils/impl/nls/lang"],function(e,t,n,i,o,s,r){"use strict";o=o(e.id);var c="0.3s",a={"-webkit-transition":"top "+c,"transition":"top "+c},u={"-webkit-transition":"top "+c,"transition":"top "+c},l={"-webkit-transition":"","transition":""},d={"-webkit-transition":"opacity "+c,"transition":"opacity "+c},h=i.Collection.extend({"model":s.Message,"title":"","showMessages":function(e,t){o.warn("This method has been deprecated and will be removed in future. Please, use ModalAlert or GlobalMessage to report errors.")&&console.warn(o.last);var n=this.getErrorMessage(this.getStatus()),i=void 0===t||t;this.trigger("showErrors",this.groupBy("type"),this.toHtml(),n,i),e&&this.reset()},"getErrorMessage":function(e){switch(e){case 0:return r.ErrorStatusConfirm;case 1:return r.ErrorStatusError;case 2:return r.ErrorStatusWarning;case 3:return r.ErrorStatusHint;case 4:return r.ErrorStatusInformation}},"addMessage":function(e,t,n){this.title=n||"",t=t||s.Type.Error;var i=new s.Message({"type":t,"message":e});return this.add([i])},"showErrors":function(e,t){return this.showMessages(e,t)},"addError":function(e){var t=new s.ErrorMessage;return t.message=e.message,this.add([t])},"addErrorMessage":function(e){return this.add([e])},"getStatus":function(){return this.sortBy("type")[0].get("type")},"clear":function(){return this.reset()},"hasMessages":function(){return this.length>0},"getMessages":function(){return this.groupBy("type")},"toHtml":function(){var e=n.template(r.ErrorHtmlTpl),t=[];return n.each(this.groupBy("type"),function(i){n.each(i.reverse(),function(i){t+=e({"statusPlain":n.keys(s.Type)[i.get("type")],"statusNice":this.getErrorMessage(i.get("type")),"msg":i.get("message")})},this)},this),t},"removeField":function(e,t,n){var i=e.find(t);n.forEach(function(e){var n=t+"-"+e,o=i.find(n);o.hasClass("binf-hidden")||o.addClass("binf-hidden")})},"switchField":function(e,t,n,i){var o=e.find(t),s=t+"-"+n,r=o.find(s),c=!1;return r.hasClass("binf-hidden")&&(i.forEach(function(e){var n=t+"-"+e;if(s!=n){var i=o.find(n);i.hasClass("binf-hidden")||i.addClass("binf-hidden")}}),r.removeClass("binf-hidden"),c=!0),{"changed":c,"element":r}},"transitionEnd":n.once(function(){var e,t={"transition":"transitionend","WebkitTransition":"webkitTransitionEnd","MozTransition":"transitionend","OTransition":"oTransitionEnd otransitionend"},n=document.createElement("div");for(e in t)if(void 0!==n.style[e])return t[e]}),"createPanel":function(e,t,n,i){var o=new t(n);if(o.$el.removeClass("binf-panel binf-panel-default"),o.$el.addClass("csui-global-message"),e.classNames&&o.$el.addClass(e.classNames),o.render(),i){i.$el.hasClass("binf-hidden")!=o.$el.hasClass("binf-hidden")&&o.$el.toggleClass("binf-hidden");var s=i.$el.hasClass("csui-collapsed");s!=o.$el.hasClass("csui-collapsed")&&(s?o.doCollapse(!1):o.doExpand(!1))}return o},"activatePanel":function(e,t,n,i){return i||e.$el.hasClass("binf-hidden")?(t&&this.resizePanel(e,t),e.$el.appendTo(n.el),i&&i.destroy()):(e.$el.addClass("binf-hidden"),e.$el.appendTo(n.el),e.doShow(t,n)),e},"showPanel":function(e,t,i){if(e.$el.hasClass("binf-hidden")){var o=this,s=this.getTargetSizes(i.$el),r=n.extend({"csuiBeforeShow":function(){if(t){var n=o.getTargetSizes(t.$el);o.setPanelHeight(e,n)}}},e);this.slidedown(r,e.$el,e.$el,s)}},"slidedown":function(e,t,i,o){var s,r;i=i||t,e.$el===t||e.$el.removeClass("csui-collapsed"),e.$el.removeClass(e.$el===t?"csui-hiding":"csui-collapsing"),e.$el.addClass(e.$el===t?"csui-showing":"csui-expanding"),e.csuiBeforeShow&&e.csuiBeforeShow();var c=t.css("position");if(i.hasClass("binf-hidden")){t.css(l),t.addClass("position-hidden"),t!==i&&(r=t.height(),s=Math.round(Math.min(o.height-o.top,r)),t.css({"bottom":"calc(100% - "+(o.top+s)+"px)"})),i.removeClass("binf-hidden"),r=t.height();var u=this.getTargetSizes(t);"relative"===c?(s=Math.round(Math.min(o.height-u.height,r)),t.css({"top":s+"px"})):(s=Math.round(Math.min(u.top,o.top+r)),t.css({"top":s+"px"})),t.removeClass("position-hidden"),t.addClass("position-show");t.position()}return t.one(this.transitionEnd(),function(){(e.$el===t?"csui-showing":"csui-expanding")&&(t.css(l),e.$el.removeClass(e.$el===t?"csui-showing":"csui-expanding"),e.csuiAfterShow&&e.csuiAfterShow())}),"relative"===c?t.css(n.extend({"top":"0px"},a)):t.css(n.extend({"top":o.top+"px"},a)),e},"expandPanel":function(e,t,n,i){n=n||t,(e.$el.hasClass("csui-collapsed")||n.hasClass("binf-hidden")||e.$el.hasClass("csui-collapsing"))&&(i=!0===i||void 0===i,i?this.slidedown(e,t,n,this.getTargetSizes(t)):(e.$el.removeClass("csui-collapsed"),n.removeClass("binf-hidden")))},"hidePanel":function(e){e.$el.hasClass("binf-hidden")||this.slideup(e,e.$el,e.$el)},"slideup":function(e,t,i){i=i||t;var o=t.css("position");e.$el.removeClass(e.$el===t?"csui-showing":"csui-expanding"),e.$el.addClass(e.$el===t?"csui-hiding":"csui-collapsing"),e.csuiBeforeHide&&e.csuiBeforeHide(),t.one(this.transitionEnd(),function(){e.$el.hasClass(e.$el===t?"csui-hiding":"csui-collapsing")&&(i.addClass("binf-hidden"),t.css(n.extend({"top":"","bottom":""},l)),e.$el.removeClass(e.$el===t?"csui-hiding":"csui-collapsing"),e.$el===t||e.$el.addClass("csui-collapsed"),e.csuiAfterHide&&e.csuiAfterHide())});var s=this.getTargetSizes(t);"relative"===o?t.css({"top":"0px"}):t.css({"top":s.top+"px"});var r=(t.position(),0),c=t.attr("id");if(c&&t.hasClass("csui-minheight")){var a=t.find("."+c+"-heightsource");a.length>0&&(r=a.outerHeight())}return t.css(n.extend({"top":Math.round(parseInt(r)-s.height)+"px"},u)),t},"collapsePanel":function(e,t,n,i){n=n||e.$el,e.$el.hasClass("csui-collapsed")&&n.hasClass("binf-hidden")&&!e.$el.hasClass("csui-expanding")||(i=!0===i||void 0===i,i?this.slideup(e,t,n):(e.$el.addClass("csui-collapsed"),n.addClass("binf-hidden")))},"fadeoutPanel":function(e){var t=e.$el.css("opacity")||"1";e.$el.css({"opacity":t}),e.$el.one(this.transitionEnd(),function(){e.$el.addClass("binf-hidden"),e.$el.css(n.extend({"opacity":""},l)),e.csuiAfterHide&&e.csuiAfterHide()});e.$el.css("opacity");return e.$el.css(n.extend({"opacity":"0.0"},d)),e},"resizePanel":function(e,t){if(t){var n=this.getTargetSizes(t.$el);this.setPanelHeight(e,n)}e.doResize&&e.doResize()},"getTargetSizes":function(e){if(e){var t=e[0].getBoundingClientRect();return n.extend({"width":t.width,"height":t.height},e.position())}return{"left":0,"top":0,"width":333,"height":63}},"setPanelHeight":function(e,t){return e.$el.find(".csui-height-target").height(t.height),e}});return h.prototype.toString=function(){var e=n.template(r.ErrorStringTpl),t=[];n.each(this.groupBy("type"),function(i){n.each(i,function(i){t+=e({"statusPlain":n.keys(s.Type)[i.get("type")],"statusNice":this.getErrorMessage(i.get("type")),"msg":i.get("message")})},this)},this)},h.version="1.0",n.extend(h,i.Events),h}),csui.define("nuc/utils/types/date",["module","nuc/lib/underscore","nuc/lib/moment","nuc/lib/moment-timezone"],function(e,t,n){"use strict";function i(e){for(var t,o,s,r,c=/\w+/g,a=e,u=0;t=c.exec(e);)o=t[0],(s=n.localeData().longDateFormat(o))&&(r=t.index+u,a=a.substring(0,r)+s+a.substring(r+o.length),u+=s.length-o.length);return a!==e?i(a):a}function o(e){return e<10?"0"+e:e}function s(e){return e instanceof n?e:e instanceof Date?n(e):C.formatIsoDateTimeInTimeZone&&!function(e){var t=e.length;if(t>19){if("Z"===e.charAt(t-1))return!0;var n=e.charAt(t-5);if("+"===n||"-"===n)return!0}}(e)?n.tz(e,C.formatIsoDateTimeInTimeZone):n(e)}function r(e){return e&&s(e).toDate()}function c(e,t,i){function s(e,t){return e.year()+"-"+o(e.month()+1)+"-"+o(e.date())+"T"+o(e.hours())+":"+o(e.minutes())+":"+o(e.seconds())+t}t||(t=R);var r=n(e,t,!0);if(!r.isValid()){if(!i)throw new Error('Parsing date value "'+e+'" as "'+t+'" failed.');i()}return C.formatIsoDateTimeInUtc?s(r.utc(),"Z"):C.formatIsoDateTimeInTimeZone?s(r.tz(C.formatIsoDateTimeInTimeZone),""):s(r,"")}function a(e,t,i){t||(t=S);var s=n(e,t,!0);if(!s.isValid()){if(!i)throw new Error('Parsing date value "'+e+'" as "'+t+'" failed.');i()}return s.year()+"-"+o(s.month()+1)+"-"+o(s.date())}function u(e,t){return n(e,t||S,!0).isValid()}function l(e,t){return n(e,t||R,!0).isValid()}function d(e){return C.friendlyDate?g(e):f(e)}function h(e){return C.friendlyDateTime?b(e):p(e)}function f(e){return e?s(e).format(S):""}function m(e){return e?s(e).format(k):""}function p(e){return e?s(e).format(R):""}function g(e){return e?s(e).calendar():""}function b(e){return e?s(e).calendar():""}function v(e){return e?s(e).fromNow():""}function y(e){return e?n.utc(e).toISOString():""}function x(e){return e?n(e).toISOString():""}var C=window.csui.requirejs.s.contexts._.config.config["nuc/utils/base"]||{};C=t.extend({"friendlyDateTime":!0,"friendlyTime":!0,"friendlyDate":!0,"formatIsoDateTimeInUtc":!1,"formatIsoDateTimeInTimeZone":void 0},C,e.config());var _=C.dateFormat||"L",w=C.timeFormat||"LTS",A=C.dateTimeFormat||_+" "+w,S=i(_),k=i(w),R=i(A);return{"exactDateFormat":S,"exactTimeFormat":k,"exactDateTimeFormat":R,"deserializeDate":r,"serializeDate":a,"serializeDateTime":c,"validateDate":u,"validateDateTime":l,"formatDate":d,"formatDateTime":h,"formatExactDate":f,"formatExactTime":m,"formatExactDateTime":p,"formatFriendlyDate":g,"formatFriendlyDateTime":b,"formatFriendlyDateTimeNow":v,"formatISODateTime":x,"formatISODate":y}}),csui.define("nuc/utils/types/number",["module","nuc/lib/underscore","nuc/lib/numeral","i18n!nuc/utils/impl/nls/lang"],function(e,t,n,i){"use strict";function o(e,t){return n(e).format(t)}function s(e){return o(e,"0,0")}function r(e){return u.friendlyFileSize?c(e):a(e)}function c(e){return t.isNumber(e)?e>=1024?n(e).format("0 b"):a(e):""}function a(e){return t.isNumber(e)?(e=s(e),t.str.sformat(i.sizeInBytes,e)):""}var u=window.csui.requirejs.s.contexts._.config.config["nuc/utils/base"]||{};return u=t.extend({"friendlyFileSize":!0},u,e.config()),{"formatInteger":o,"formatIntegerWithCommas":s,"formatFileSize":r,"formatFriendlyFileSize":c,"formatExactFileSize":a,"MAX_SAFE_INTEGER":Number.MAX_SAFE_INTEGER||9007199254740991,"MIN_SAFE_INTEGER":Number.MIN_SAFE_INTEGER||-9007199254740991}}),csui.define("nuc/utils/types/member",["nuc/lib/underscore","nuc/lib/backbone","i18n!nuc/utils/impl/nls/lang"],function(e,t,n){"use strict";function i(i){if(!i)return"";if(e.isNumber(i)||e.isString(i))return i.toString();if(i instanceof t.Model&&(i=i.attributes),i.display_name)return i.display_name;if(i.name_formatted)return i.name_formatted;var o=i.first_name,s=i.last_name,r=i.middle_name;return(o?r?e.str.sformat(n.ColumnMemberName3,s,o,r):s?e.str.sformat(n.ColumnMemberName2,s,o):o:s)||i.name_formatted||i.name||i.id&&i.id.toString()||""}return{"formatMemberName":i}}),csui.define("nuc/utils/types/localizable",["nuc/lib/underscore","i18n"],function(e,t){"use strict";function n(t,n){return void 0==t?t=void 0==n?null:n:e.isObject(t)&&(t=e.reduce(t,function(e,t,n){return n=n.toLowerCase().replace("_","-"),e[n]=t,e},{}),t=t[u]||t[l]||t[d]||t[h]||n),null!=t&&t.toString()||""}function i(e,t,n){n||(n={});var i=n.usage||"search",o={"usage":i,"sensitivity":"search"===i?"base":"variant","numeric":"search"!==i};if(!e||!t)return e?-1:t?1:0;if(e.localeCompare)try{return e.localeCompare(t,u,o)}catch(e){}return e=e.toLowerCase(),t=t.toLowerCase(),e<t?-1:e>t?1:0}function o(e,t){return r(e,t)>=0}function s(e,t){var n,o=e.length,s=Math.min(o,3*t.length);for(n=1;n<=s;++n)if(0===i(e.substring(o-n),t))return!0}function r(e,t){var n,i=e.length-t.length+1;for(n=0;n<=i;++n)if(c(e.substring(n),t))return n;return-1}function c(e,t){var n,o=Math.min(e.length,3*t.length);for(n=1;n<=o;++n)if(0===i(e.substring(0,n),t))return!0}function a(t,n){var i,o=Array.prototype.slice.call(arguments,2);return i=t>4?n.formatForFive:t>1?n.formatForTwo:t>0?n.formatForOne:n.formatForNone||n.formatForFive,o.splice(0,0,t.toString()),o.splice(0,0,i),e.str.sformat.apply(e.str,o)}var u=t.settings.locale,l=u.replace(/[-_]\w+$/,""),d=t.settings.defaultLocale,h=d.replace(/[-_]\w+$/,"");return{"getClosestLocalizedString":n,"localeCompareString":i,"localeContainsString":o,"localeEndsWithString":s,"localeIndexOfString":r,"localeStartsWithString":c,"formatMessage":a}}),csui.define("nuc/utils/base",["nuc/lib/underscore","nuc/lib/jquery","nuc/utils/url","nuc/utils/errormessage","nuc/utils/messagehelper","nuc/utils/types/date","nuc/utils/types/number","nuc/utils/types/member","nuc/utils/types/localizable","i18n"],function(e,t,n,i,o,s,r,c,a,u){"use strict";function l(e,t){var n=te.text(e).html();return t&&(n=n.replace(/\r?\n/g,"\r\n<br>")),n}function d(e){return e&&e.once}function h(n){return n&&(e.isString(n)||e.isElement(n)||n instanceof t)}function f(){return!!("ontouchstart"in window||navigator.maxTouchPoints||navigator.msMaxTouchPoints)}function m(){return!!("ontouchstart"in window)}function p(){if(navigator&&null!=navigator.userAgent){return null!=navigator.userAgent.match(/(iPhone |iPad)/i)}return!0}function g(){return navigator.platform.indexOf("Mac")>-1}function b(){return navigator.userAgent.indexOf("Mac")>-1}function v(){return p()&&window.matchMedia("(orientation: landscape)").matches}function y(){return p()&&window.matchMedia("(orientation: portrait)").matches}function x(){if(navigator&&navigator.userAgent){return/Trident.*11/i.test(navigator.userAgent)}}function C(){if(navigator&&navigator.userAgent){return/Mozilla/.test(navigator.userAgent)}}function _(){if(navigator&&navigator.userAgent){return/Edge/.test(navigator.userAgent)}}function w(){if(navigator&&navigator.userAgent){return/Firefox/.test(navigator.userAgent)}}function A(){return x()||_()}function S(){var e=window.chrome,t=window.navigator,n=t.vendor,i=t.userAgent.indexOf("OPR")>-1,o=t.userAgent.indexOf("Edge")>-1,s=t.userAgent.match("CriOS"),r=!1;return(s||null!=e&&"Google Inc."===n&&!1===i&&!1===o)&&(r=!0),r}function k(){if(navigator&&navigator.userAgent){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}function R(e,t){var n=0;return t>0&&(n=Math.floor(2*e/t)),n}function E(e){var n=e instanceof t?e:t(e);if(!n.is(":visible"))return!1;var i=n.offset(),o={"left":window.pageXOffset,"top":window.pageYOffset},s={"width":K.width(),"height":K.height()};return i.left>=o.left&&i.left-o.left<s.width&&i.top>=o.top&&i.top-o.top<s.height}function F(e){if(void 0===e)return!1;var n=e instanceof t?e[0]:e;if(!n||!n.getBoundingClientRect)return!1;var i=n.getBoundingClientRect();return i.left>=window.pageXOffset&&i.right-window.pageXOffset<K.width()}function O(e){if(void 0===e)return!1;var n=e instanceof t?e[0]:e;if(!n||!n.getBoundingClientRect)return!1;var i=n.getBoundingClientRect();return i.top>=window.pageYOffset&&i.bottom-window.pageYOffset<K.height()}function M(e,n,i,o){if(void 0===e)return!1;var s=e instanceof t?e[0]:e;if(!s||!s.getBoundingClientRect)return!1;for(var r=void 0!==i?i:100,c=void 0!==o?o:100,a=s.getBoundingClientRect(),u=[],l=n||5,d=0;null!=s.parentElement&&d<l;)u.push(s.parentElement.getBoundingClientRect()),s=s.parentElement,d++;return u.every(function(e){var t=Math.min(a.right,e.right)-Math.max(a.left,e.left),n=Math.min(a.bottom,e.bottom)-Math.max(a.top,e.top),i=t/a.width*100,o=n/a.height*100;return i+.01>r&&o+.01>c})}function T(e,n,i,o){if(void 0===e||void 0===n)return!1;var s=e instanceof t?e[0]:e;if(!s||!s.getBoundingClientRect)return!1;var r=n instanceof t?n[0]:n;if(!r||!r.getBoundingClientRect)return!1;var c=void 0!==i?i:100,a=void 0!==o?o:100,u=s.getBoundingClientRect(),l=r.getBoundingClientRect(),d=Math.min(u.right,l.right)-Math.max(u.left,l.left),h=Math.min(u.bottom,l.bottom)-Math.max(u.top,l.top),f=d/u.width*100,m=h/u.height*100;return f+.01>c&&m+.01>a}function q(e){var n=t(e),i=n.closest(".csui-perfect-scrolling").length>0?".csui-perfect-scrolling":".csui-normal-scrolling",o=n.closest(i),s=o.siblings(".csui-tab-contents-header-wrapper");if(s[0]){var r=n.offset().top,c=o[0].getBoundingClientRect().top+s.height();if(!(r>c)){var a=o.scrollTop();o.scrollTop(a-(c-r))}}}function D(e){var t=e.data,n=t.inputElement,i=t.view,o=t.dropdownContainer,s=t.callback;n.parents(".csui-normal-scrolling").css("overflow","auto"),o.length>0&&o[0]!==e.target&&o.is(":visible")&&s&&s(i)}function N(e,t,n,i,o,s){var r,c={"inputElement":e,"view":i,"dropdownContainer":t,"callback":o},a=this.isIE11(),l=this.isTouchBrowser();this.isHybrid();if(l&&!e.closest(".csui-scrollable-writemode").hasClass("csui-dropdown-open")&&e.closest(".csui-scrollable-writemode").addClass("csui-dropdown-open"),e.parents(".csui-scrollablecols").length>0&&e.parents(".cs-form-set-container").length>0){r=e.parents(".csui-scrollablecols").parents(".cs-form-set-container").find(".ps-container.ps-active-x");var d,h,f=u&&u.settings.rtl,m=e.offset().left,p=e.parents(".csui-scrollablecols").siblings(".csui-lockedcols").find(".csui-shadowleft-container"),g=p.offset().left;if(f){h=m+e.outerWidth()-g}else{h=g+p.outerWidth()-m}if(h>0){var b=this;return r.off("scroll",this.setScrollHandler),r.one("set:scrolled",function(){r&&r.on("scroll",c,b.setScrollHandler),b.autoAlignDropDowns(e,t,n,s,a),b.hideDropDowns(e,t,i,o)}),void(f?(d=r.scrollLeftRtl(),r.scrollLeftRtl(d+h)):(d=r.scrollLeft(),r.scrollLeft(d-h),setTimeout(function(){b.isTouchBrowser&&!e.closest(".csui-scrollable-writemode").hasClass(".csui-dropdown-open")&&e.closest(".csui-scrollable-writemode").addClass("csui-dropdown-open")},100)))}}r&&r.off("scroll",this.setScrollHandler).on("scroll",c,this.setScrollHandler),this.autoAlignDropDowns(e,t,n,s,a),this.hideDropDowns(e,t,i,o)}function P(e,n,i,o,s){if(!e.is(":visible"))return!1;n.css({"left":0,"top":0});var r,c,a=!!e.closest(".cs-perspective-panel").length,l=u&&u.settings.rtl,d=e.offset().top,h=a?e.offset().left:e[0].getBoundingClientRect().left,f=e.closest(".csui-perfect-scrolling").length>0?".csui-perfect-scrolling":".csui-normal-scrolling",m=e.closest(f),p=s?[]:m.length>0?m.parents(".binf-modal-content, .csui-sidepanel-container"):e.closest(".binf-modal-content, .csui-sidepanel-container"),g=p.length>0?l?p.outerWidth()+p.offset().left:p.offset().left:l?t(document).width():0,b=p.length>0?p.offset().top:0,v=e.outerHeight(),y=e.outerWidth(),x=t(".cs-perspective-panel"),C=e.closest(".cs-perspective-panel"),_=C.length>0?C:e.closest(".cs-perspective"),w=_.length>0?_.outerHeight():t(document).height(),A=_.length>0?_.offset().top:0,S=_.length>0?_.offset().left:0,R=e[0].getBoundingClientRect();i&&n.css({"width":y}),".csui-normal-scrolling"!=f&&e.parents(".csui-normal-scrolling").css("overflow","hidden");var E=x.length>0?x[0].getBoundingClientRect().top:0;E<0&&(E=x.offset().top);var F=A>0?A:E,O=R.top-F,M=window.innerHeight-(R.top+R.height),T=O>M;o&&(o.css({"max-height":Math.abs(.9*(T?O:M))+"px"}),T=o.outerHeight()>M),T?(r=s?_.length>0?w+A-R.top:document.documentElement.offsetHeight+document.documentElement.scrollTop-d:p.length>0?p.outerHeight()+b-d:_.length>0||k()?w+A-d:a?document.documentElement.offsetHeight-d:window.innerHeight-e[0].getBoundingClientRect().top,l?n.css({"position":"fixed","right":g-(h+y),"top":"auto","bottom":r,"left":"auto"}):n.css({"position":"fixed","left":h-g-S,"top":"auto","bottom":r}),n.hasClass("binf-datetimepicker-widget")&&n.addClass("binf-top").removeClass("binf-bottom")):(c=s?d+v-document.documentElement.scrollTop:p.length>0?d+v-b:_.length>0?d+v-A:R.top+R.height-A,l?n.css({"position":"fixed","right":g-(h+y),"top":c,"bottom":"auto","left":"auto"}):n.css({"position":"fixed","left":h-g-S,"top":c,"bottom":"auto"}),n.hasClass("binf-datetimepicker-widget")&&n.addClass("binf-bottom").removeClass("binf-top"))}function j(n){var i=n.targetEl,o=n.dropdownMenu||i.nextAll(".binf-dropdown-menu"),s=n.hAlignment||"left",r=n.vAlignment||"bottom",c=u&&u.settings.rtl;if(!i.length||!i.is(":visible")||!o.length)return!1;o.css({"maxHeight":"","maxWidth":"","top":"","left":"","right":"","bottom":""}),o.removeClass("binf-dropdown-align-left-top binf-dropdown-align-left-bottom binf-dropdown-align-right-top binf-dropdown-align-right-bottom");var a=o.outerHeight(),l=o.outerWidth();o.addClass("binf-hidden");var d=t(window).width(),h=t(window).height(),f=parseInt(o.css("maxWidth"),10)||224,m=i[0].getBoundingClientRect(),p=m.bottom,g=m.left,b=d-m.right,v=h-m.top,y=window.pageXOffset||document.documentElement.scrollLeft,C=window.pageYOffset||document.documentElement.scrollTop,_=m.top-10,w=h-m.bottom-10,A=m.right-10,S=d-m.left-10;if("bottom"===r&&w<=a?(_>a||_>w)&&(r="top"):"top"===r&&_<=a&&(w>a||w>_)&&(r="bottom"),s=c?"left"===s?"right":"left":s,"left"===s&&S<=l?(A>l||A>S)&&(s="right"):"right"===s&&A<=l&&(S>l||S>A)&&(s="left"),o.addClass("binf-dropdown-align-"+s+"-"+r),!x()){var k=i.closest(".cs-perspective-panel"),R=i.parents(".binf-modal-content"),E=k.length?k:i.closest(".cs-perspective");if(E=E.length?E:R,E.length>0){var F=E.offset(),O=i.offset();p+=C-F.top,g+=y-F.left,b=E.outerWidth()+F.left-O.left-i.outerWidth(),v=E.outerHeight()+F.top-O.top}}var M={"position":"fixed"};"left"===s?(M=e.extend(M,{"left":g}),c&&(M=e.extend(M,{"right":"auto"})),S<f&&(M.maxWidth=S)):M=e.extend(M,{"right":b}),M="bottom"===r?e.extend(M,{"top":p}):e.extend(M,{"bottom":v}),o.css(M),o.removeClass("binf-hidden")}function I(n){
var i=n.dropdownMenu,o=n.targetEl,s=o.children(),r=u&&u.settings.rtl,c=window.innerWidth||document.documentElement.clientWidth,a=o[0].getBoundingClientRect(),l=s[0].getBoundingClientRect(),d=i[0].getBoundingClientRect(),h=o.hasClass("binf-pull-down"),f=o.parents().hasClass("csui-tileview-more-btn"),m=h===r?a.right:a.left,p=r?m:c-m,g=r?c-a.right:a.left;o.removeClass("binf-dropdown-menu-left binf-dropdown-menu-right"),i.css({"left":"","right":"","top":"","bottom":"","position":""}),i.removeAttr("style"),i.removeClass("csui-fixed-submenu csui-perfect-scrolling csui-normal-scrolling csui-no-scroll-x"),(Math.floor(p)<=d.width||o.parent().closest(".binf-dropdown-submenu").hasClass("binf-dropdown-menu-left")&&g>d.width)&&o.addClass("binf-dropdown-menu-left"),o.removeClass("binf-dropup");var b=i.offset(),v=b.top-i.outerHeight()-t(window).scrollTop(),y=t(window).scrollTop()+t(window).height()-(b.top+i.outerHeight());(y<0&&(v>=0||v>y)||o.parent().closest(".binf-dropdown-submenu").hasClass("binf-dropup")&&v>y)&&o.addClass("binf-dropup");var C=o.parent().scrollTop(),_=0;o.parent().css("overflow","visible");var w=i[0].getBoundingClientRect(),A=w.top,S=w.left;if(o.parent().css("overflow",""),!x()){var k=o.parents(".binf-modal-content"),R=o.closest(".cs-perspective-panel"),E=o.closest(".cs-perspective"),F=R.length>0?R:E;if(k.length>0){var O=k.offset();A=A-O.top-C,S-=O.left}else if(F.length>0){var M=F.offset(),T=E[0].getBoundingClientRect();_=f?T.top:M.top,A=A-_-C,S-=M.left}}o.parent().css("overflow","visible"),o.hasClass("binf-dropdown-menu-left")&&(S+=h?0:o.width()-i.width()),h&&(A-=a.bottom-l.bottom);var q=document.body.getBoundingClientRect().top,D=o.offset().top+q,N=o.innerHeight(),P=t(window).outerHeight(),j=0;o.parent().css("overflow",""),i.addClass("csui-fixed-submenu");var I={"position":"fixed","left":S};o.parents().hasClass("csui-nodestable")&&!x()&&(A+=window.scrollY),o.hasClass("binf-dropup")?(j=P-D-N,j=j<0?0:j,x()?e.extend(I,{"bottom":j,"top":"auto","maxHeight":P-j}):e.extend(I,{"bottom":"auto","top":A+o.height()/2,"maxHeight":P-j})):e.extend(I,{"top":A,"bottom":"auto","maxHeight":P-(A+_)}),i.css(I),csui.require(["csui/controls/tile/behaviors/perfect.scrolling.behavior"],function(t){t.usePerfectScrollbar()?(i.addClass("csui-perfect-scrolling"),i.perfectScrollbar({"suppressScrollX":!0,"includePadding":!0})):i.addClass("csui-normal-scrolling csui-no-scroll-x");var n=o.closest(".binf-dropdown-menu");n.off("scroll.csui.submenu").on("scroll.csui.submenu",e.bind(function(e){!i.is(":hidden")&&o.binf_dropdown_submenu("hide"),n.off("scroll.csui.inline.actions")},this))})}function B(e,n,i,o){var s=e.closest(".csui-perfect-scrolling").length>0?".csui-perfect-scrolling":".csui-normal-scrolling",r=e.closest(s),c={"inputElement":e,"view":i,"dropdownContainer":n,"callback":o};r.off("scroll",this.setScrollHandler).on("scroll",c,this.setScrollHandler),t(window).off("scroll",this.setScrollHandler).on("scroll",c,this.setScrollHandler),t(window).off("resize",this.setScrollHandler).on("resize",c,this.setScrollHandler)}function z(e){return JSON.stringify(e)}function H(e,t){return"YYYY-MM-DD"===t||"MM/DD/YYYY"===t?s.serializeDate(e):s.serializeDateTime(e)}function U(e){return t(e).find("a[href], area[href], input, select, textarea, button, iframe, object, embed, *[tabindex], *[contenteditable]").filter(":visible:not([disabled])")}function V(e){var n=t(e);n.attr("tabindex",-1).find("a[href], area[href], input, select, textarea, button, iframe, object, embed, *[tabindex], *[contenteditable]").filter(":not([tabindex=-1])").attr("tabindex",-1),this.isIE11()&&n.find("svg, svg *").attr("focusable","false"),this.isFirefox()&&n.find(".csui-normal-scrolling").attr("tabindex",-1)}function Q(e,n){function i(t){a!==n&&(o.appendChild(m(s.substr(c,t+1-c))),r<o.clientWidth?(h?(d=s.substr(c,t+1-c),c=t+1):(d=s.substr(c,u-c),c=u),l=f("span"),l.appendChild(m(d)),e.appendChild(l),h=!0,a++):h=!1,u=t+1,o.removeChild(o.firstChild))}var o,s,r,c,a,u,l,d,h,f=document.createElement.bind(document),m=document.createTextNode.bind(document);if(e="object"==typeof e&&e.length>0?e[0]:e,o=f("span"),t(o).css({"position":"absolute","whiteSpace":"pre","visibilty":"hidden"}),e.ownerDocument||e.ownerDocument===document){for(c=u=0,a=1,h=!1,r=e.clientWidth,s=(e.textContent||e.innerText).trim().replace(/\n/g," ");null!==e.firstChild;)e.removeChild(e.firstChild);e.appendChild(o),s.replace(/\W|\_/g,function(e,t){i(t)}),i(s.substr(c).length),e.removeChild(o),l=f("span"),t(l).css({"display":"inline-block","overflow":"hidden","whiteSpace":"nowrap","width":"100%"}),a>1&&t(l).css({"textOverflow":"ellipsis"}),l.appendChild(m(s.substr(c))),e.appendChild(l)}}function L(t,n,i){if(t&&n&&n.unSupportedWidgets&&!i){var o=e.chain(n.unSupportedWidgets).values().flatten()._wrapped;if(o&&o.length>0&&e.contains(o,t.type))return}return t}function W(e,t,n){var i,o=function(){clearTimeout(i),t.call(n||e)};i=setTimeout(o,2e3),e.one(ne(),o)}function $(e){return e.is(":visible")?e.offset():{"top":0,"left":0}}function J(t){var n=u&&u.settings&&u.settings[t]?u.settings[t].length:0;return{"enabled":n>1,"languages":n>0?u.settings[t]:[],"defaultLanguage":n?e.findWhere(u.settings[t],{"default":!0}).language_code:""}}function G(){return J("languages")}function Y(){return J("metadata_languages")}function X(){return u&&u.settings&&u.settings.userMetadataLanguage?u.settings.userMetadataLanguage:"en"}function Z(e){var t=e&&(e.ctrlKey||e.metaKey);return t=t&&("a"===e.currentTarget.tagName.toLowerCase()||e.currentTarget.getElementsByTagName("a").length>0)}var K=t(window),ee=new o;ee.on("showErrors",function(e,n,i,o){alert(t(n).text())});var te=t("<p></p>"),ne=e.once(function(){var e,t={"transition":"transitionend","WebkitTransition":"webkitTransitionEnd","MozTransition":"transitionend","OTransition":"oTransitionEnd otransitionend"},n=document.createElement("div");for(e in t)if(void 0!==n.style[e])return t[e]});return{"MessageHelper":ee,"ErrorHandler":ee,"MessageType":i.Type,"Message":i.Message,"RequestErrorMessage":i.RequestErrorMessage,"ErrorStatus":i.Type,"ErrorToShow":i.Message,"ErrorMessage":i.ErrorMessage,"Error":i.RequestErrorMessage,"exactDateFormat":s.exactDateFormat,"exactTimeFormat":s.exactTimeFormat,"exactDateTimeFormat":s.exactDateTimeFormat,"parseDate":s.deserializeDate,"stringifyDate":z,"dateToLocalIsoString":H,"deserializeDate":s.deserializeDate,"serializeDate":s.serializeDate,"serializeDateTime":s.serializeDateTime,"formatDate":s.formatDate,"formatDateTime":s.formatDateTime,"formatExactDate":s.formatExactDate,"formatExactTime":s.formatExactTime,"formatExactDateTime":s.formatExactDateTime,"formatFriendlyDate":s.formatFriendlyDate,"formatFriendlyDateTime":s.formatFriendlyDateTime,"formatFriendlyDateTimeNow":s.formatFriendlyDateTimeNow,"formatISODateTime":s.formatISODateTime,"formatISODate":s.formatISODate,"getReadableFileSizeString":r.formatFileSize,"formatFileSize":r.formatFileSize,"formatFriendlyFileSize":r.formatFriendlyFileSize,"formatExactFileSize":r.formatExactFileSize,"formatInteger":r.formatInteger,"formatIntegerWithCommas":r.formatIntegerWithCommas,"formatMemberName":c.formatMemberName,"getClosestLocalizedString":a.getClosestLocalizedString,"localeCompareString":a.localeCompareString,"localeContainsString":a.localeContainsString,"localeEndsWithString":a.localeEndsWithString,"localeIndexOfString":a.localeIndexOfString,"localeStartsWithString":a.localeStartsWithString,"formatMessage":a.formatMessage,"escapeHtml":l,"isBackbone":d,"isPlaceholder":h,"Url":n,"isTouchBrowser":f,"isHybrid":m,"isAppleMobile":p,"isMacintosh":g,"isIOSBrowser":b,"isIE11":x,"isEdge":_,"isMozilla":C,"isFirefox":w,"isSafari":k,"isLandscape":v,"isPortrait":y,"isMSBrowser":A,"isChrome":S,"px2em":R,"isVisibleInWindowViewport":E,"isVisibleInWindowViewportHorizontally":F,"isVisibleInWindowViewportVertically":O,"isElementVisibleInParents":M,"isElementVisibleInParent":T,"checkAndScrollElemToViewport":q,"setScrollHandler":D,"adjustDropDownField":N,"autoAlignDropDowns":P,"hideDropDowns":B,"findFocusables":U,"clearFocusables":V,"applyEllipsis":Q,"filterUnSupportedWidgets":L,"onTransitionEnd":W,"getOffset":$,"alignDropDownMenu":j,"alignDropDownSubMenus":I,"getLanguageInfo":G,"getMetadataLanguageInfo":Y,"getUserMetadataLanguageInfo":X,"isControlClick":Z}}),csui.define("nuc/models/action",["module","require","nuc/lib/jquery","nuc/lib/underscore","nuc/lib/backbone","nuc/utils/log","nuc/utils/base"],function(e,t,n,i,o,s,r){"use strict";var c;return o.Model.extend({"idAttribute":"signature","constructor":function(e,n){o.Model.prototype.constructor.apply(this,arguments),n&&n.connector&&n.connector.assignTo(this),c||(c=t("nuc/models/actions"));var s=i.isArray(e&&e.children)&&e.children||[];this.children=new c(s)},"url":function(){return r.Url.combine(this.connector.connection.url,"actions",this.get("signature"))},"fetch":function(e){return s.debug("Fetching action with the ID {0}.",this.get("signature"))&&console.log(s.last),o.Model.prototype.fetch.call(this,e)},"parse":function(e){var t=e;if(this.children){var n=i.isArray(t.children)&&t.children||[];this.children.reset(n)}return t}})}),csui.define("nuc/models/actions",["module","nuc/lib/jquery","nuc/lib/underscore","nuc/lib/backbone","nuc/utils/log","nuc/utils/base","nuc/models/action"],function(e,t,n,i,o,s,r){"use strict";var c=i.Collection.extend({"model":r,"constructor":function(e,t){i.Collection.prototype.constructor.apply(this,arguments),this.options=t||{}},"findRecursively":function(e){var t=this.get({"cid":e})||this.find(function(t){return t.get("signature")===e});return t||(t=n.find(this.map(function(t){return t.children.findRecursively(e)}),function(e){return e})),t}});return n.extend(c,{"version":"1.0"}),c}),csui.define("nuc/models/mixins/rules.matching/rules.matching.mixin",["module","nuc/lib/underscore","nuc/lib/backbone","nuc/utils/log"],function(e,t,n,i){"use strict";return i=i(e.id),{"mixin":function(e){return t.extend(e,{"makeRulesMatching":function(e){return this},"rulesToMatch":["equals","contains","startsWith","endsWith","matches","includes","equalsNoCase","containsNoCase","startsWithNoCase","endsWithNoCase","matchesNoCase","includesNoCase","has","decides","or","and","not"],"matchRules":function(e,n,i,o){var s=t.chain(this.rulesToMatch).map(function(t){var o=n[t];return void 0===o?void 0:this["_evaluate-"+t](e,o,i)},this).filter(function(e){return void 0!==e}).value();return!s.length||t[o||"any"](s,function(e){return!0===e})},"_getRulingPropertyValue":function(e,o){if("string"!=typeof o)return null==o&&(o="null"),i.warn("Invalid property name in the action rule specification: {0}",o)&&console.warn(i.last),null;var s=o.split("."),r=e instanceof n.Model?e.attributes:e||{};return t.find(s,function(e){if(null==(r=r[e]))return r=null,!0}),r},"_evaluate-or":function(e,n,i){return t.isArray(n)?t.any(n,function(t){return this.matchRules(e,t,i)},this):this.matchRules(e,n,i,"any")},"_evaluate-and":function(e,n,i){return t.isArray(n)?t.all(n,function(t){return this.matchRules(e,t,i)},this):this.matchRules(e,n,i,"all")},"_evaluate-not":function(e,t,n){return!this.matchRules(e,t,n)},"_evaluate-equals":function(e,t){return this._evaluateEquals(e,t,!1)},"_evaluate-equalsNoCase":function(e,t){return this._evaluateEquals(e,t,!0)},"_evaluateEquals":function(e,n,i){return t.any(n,function(n,o){var s=this._getRulingPropertyValue(e,o);if(t.isArray(n)||(n=[n]),i){var r=this._normalizeCase(s,n);s=r.actual,n=r.values}return t.any(n,function(e){return e==s})},this)},"_evaluate-contains":function(e,t){return this._evaluateContains(e,t,!1)},"_evaluate-containsNoCase":function(e,t){return this._evaluateContains(e,t,!0)},"_evaluateContains":function(e,n,i){return t.any(n,function(n,o){var s=this._getRulingPropertyValue(e,o)||"";if(s&&(s=s.toString())||(s=[]),t.isArray(n)||(n=[n]),i){var r=this._normalizeCase(s,n);s=r.actual,n=r.values}return t.any(n,function(e){return s.indexOf(e)>=0})},this)},"_evaluate-startsWith":function(e,t){return this._evaluateStartsWith(e,t,!1)},"_evaluate-startsWithNoCase":function(e,t){return this._evaluateStartsWith(e,t,!0)},"_evaluateStartsWith":function(e,n,i){return t.any(n,function(n,o){var s=this._getRulingPropertyValue(e,o)||"";if(s&&(s=s.toString())||(s=""),t.isArray(n)||(n=[n]),i){var r=this._normalizeCase(s,n);s=r.actual,n=r.values}return t.any(n,function(e){return 0===s.indexOf(e)})},this)},"_evaluate-endsWith":function(e,t){return this._evaluateEndsWith(e,t,!1)},"_evaluate-endsWithNoCase":function(e,t){return this._evaluateEndsWith(e,t,!0)},"_evaluateEndsWith":function(e,n,i){return t.any(n,function(n,o){var s=this._getRulingPropertyValue(e,o)||"";if(s&&(s=s.toString())||(s=""),t.isArray(n)||(n=[n]),i){var r=this._normalizeCase(s,n);s=r.actual,n=r.values}return t.any(n,function(e){return t.str.endsWith(s,e)})},this)},"_evaluate-matches":function(e,t){return this._evaluateMatches(e,t,!1)},"_evaluate-matchesNoCase":function(e,t){return this._evaluateMatches(e,t,!0)},"_evaluateMatches":function(e,n,i){return t.any(n,function(n,o){var s=this._getRulingPropertyValue(e,o)||"";if(s&&(s=s.toString())||(s=""),t.isArray(n)||(n=[n]),i){var r=this._normalizeCase(s,n);s=r.actual,n=r.values}return t.any(n,function(e){return"string"==typeof e&&(e=new RegExp(e)),e.test(s)})},this)},"_evaluate-includes":function(e,t){return this._evaluateIncludes(e,t,!1)},"_evaluate-includesNoCase":function(e,t){return this._evaluateIncludes(e,t,!0)},"_evaluateIncludes":function(e,n,i){return t.any(n,function(n,o){var s=this._getRulingPropertyValue(e,o)||[];if(t.isArray(s)||(s=t.isObject(s)?Object.keys(s):[s]),t.isArray(n)||(n=[n]),i){var r=this._normalizeCase(s,n);s=r.actual,n=r.values}return t.any(n,function(e){return t.contains(s,e)})},this)},"_evaluate-has":function(e,n){return t.isArray(n)||(n=[n]),t.any(n,function(t){return null!=this._getRulingPropertyValue(e,t)},this)},"_evaluate-decides":function(e,n,i){return t.isArray(n)||(n=[n]),t.any(n,function(t){return t(e,i)})},"_normalizeCase":function(e,n){return"string"==typeof e&&(e=e.toLowerCase()),n=t.map(n,function(e){return"string"==typeof e?e.toLowerCase():e}),{"actual":e,"values":n}}})}}}),csui.define("nuc/models/actionitem",["nuc/lib/underscore","nuc/lib/backbone","nuc/models/mixins/rules.matching/rules.matching.mixin"],function(e,t,n){"use strict";var i=t.Model.extend({"idAttribute":null,"defaults":{"sequence":100,"signature":null},"constructor":function(e,n){t.Model.prototype.constructor.apply(this,arguments),this.makeRulesMatching(n)},"enabled":function(e){var t=this.get("type");return void 0!==t?t==e.get("type"):this.matchRules(e,this.attributes)}});return n.mixin(i.prototype),i}),csui.define("nuc/models/actionitems",["nuc/lib/underscore","nuc/lib/backbone","nuc/models/actionitem"],function(e,t,n){"use strict";return t.Collection.extend({"model":n,"comparator":"sequence","constructor":function(e,n){t.Collection.prototype.constructor.apply(this,arguments)},"findByNode":function(e){return this.find(function(t){return t.enabled(e)})},"getAllSignatures":function(){return e.chain(this.pluck("signature")).unique().value()},"getAllCommandSignatures":function(t){return e.chain(this.getAllSignatures()).map(function(e){var n=t.get(e);if(n){var i=n.getCommandKey&&n.getCommandKey()||n.get("command_key")||[];return"default"===i[0]?["default","open",i[2]]:i}}).flatten().compact().invoke("toLowerCase").unique().value()},"getPromotedCommandsSignatures":function(){return e.chain(this.getAllSignatures()).flatten().compact().invoke("toLowerCase").unique().value()}})}),csui.define("nuc/models/addabletype",["module","nuc/lib/backbone","nuc/utils/log"],function(e,t,n){var i=t.Model.extend({"constructor":function(){t.Model.prototype.constructor.apply(this,arguments)},"parse":function(e){return e}});return i.version="1.0",i.Hidden=-1,i}),csui.define("nuc/models/addabletypes",["module","nuc/lib/backbone","nuc/utils/log","nuc/models/addabletype"],function(e,t,n,i){var o=t.Collection.extend({"model":i,"constructor":function(e,n){t.Collection.prototype.constructor.apply(this,arguments),this.options=n||{}}});return o.version="1.0",o}),csui.define("nuc/models/mixins/connectable/connectable.mixin",["nuc/lib/underscore"],function(e){"use strict";return{"mixin":function(t){var n=t._prepareModel;return e.extend(t,{"makeConnectable":function(e){return e&&e.connector&&e.connector.assignTo(this),this},"_prepareModel":function(e,t){return t||(t={}),t.connector||(t.connector=this.connector),n.call(this,e,t)}})}}}),csui.define("nuc/models/ancestor",["module","nuc/lib/backbone","nuc/models/mixins/connectable/connectable.mixin"],function(e,t,n){var i=t.Model.extend({"constructor":function(e,n){t.Model.prototype.constructor.apply(this,arguments),this.makeConnectable(n)},"idAttribute":null,"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})}});return n.mixin(i.prototype),i}),csui.define("nuc/models/ancestors",["module","nuc/lib/backbone","nuc/utils/log","nuc/models/ancestor"],function(e,t,n,i){var o=t.Collection.extend({"model":i,"constructor":function(e,n){t.Collection.prototype.constructor.apply(this,arguments),this.options=n||{}}});return o.version="1.0",o}),csui.define("nuc/models/mixins/expandable/expandable.mixin",["nuc/lib/underscore","nuc/utils/url"],function(e,t){"use strict";return{"mixin":function(t){return e.extend(t,{"makeExpandable":function(e){var t=e&&e.expand;return"string"==typeof t&&(t=t.split(",")),this.expand=t||[],this},"setExpand":function(t){e.isArray(t)||(t=t.split(",")),e.each(t,function(t){e.contains(this.expand,t)||(this.expand instanceof Object&&this.expand.properties?this.expand.properties.push(t):this.expand.push(t))},this)},"resetExpand":function(t){t?(e.isArray(t)||(t=t.split(",")),e.each(t,function(t){var n=e.indexOf(this.expand,t);n>=0&&this.expand.splice(n,1)},this)):this.expand.splice(0,this.expand.length)},"getExpandableResourcesUrlQuery":function(){return{"expand":this.expand}}})}}}),csui.define("nuc/models/mixins/fetchable/fetchable.mixin",["nuc/lib/underscore","nuc/lib/jquery","nuc/lib/backbone","nuc/utils/base"],function(e,t,n,i){"use strict";return{"mixin":function(o){var s=o.fetch;return e.extend(o,{"makeFetchable":function(e){return this.autoreset=e&&e.autoreset,this.on("reset",this._beforeFetchSucceeded,this).on("add",this._beforeFetchSucceeded,this).on("remove",this._beforeFetchSucceeded,this).on("change",this._beforeFetchSucceeded,this)},"_beforeFetchSucceeded":function(){this._fetchingOriginal&&this._fetchSucceeded()},"_fetchStarted":function(){this.fetched=!1,this.error=null},"_fetchSucceeded":function(){this._fetchingOriginal=this.fetching=!1,this.fetched=!0,this.error=void 0},"_fetchFailed":function(e){this._fetchingOriginal=this.fetching=!1,this.error=new i.Error(e)},"fetch":function(t){var n=this.fetching;if(!n){t=e.defaults(t||{},{"cache":!0,"urlBase":this.urlCacheBase?this.urlCacheBase():void 0}),this._fetchStarted(),t=this._prepareFetch(t);var i=this,o=t.success,r=t.error;t.success=function(){i._fetchSucceeded(),o&&o.apply(this,arguments)},t.error=function(e,t,n){i._fetchFailed(t),r&&r.apply(this,arguments)},this._fetchingOriginal=!0,n=s.call(this,t),this._fetchingOriginal&&(this.fetching=n)}return n},"_prepareFetch":function(e){return e||(e={}),void 0===e.reset&&this.autoreset&&(e.reset=!0),e},"ensureFetched":function(e){return this.fetched?(e&&e.success&&e.success(this),t.Deferred().resolve(this,{},e).promise()):this.fetch(e)},"invalidateFetch":function(){if(!this.fetching)return this.fetched=!1,this.error=null,!0},"markFetched":function(){if(!this.fetching)return this.fetched=!0,this.error=null,!0},"prefetch":function(i,o){var s=t.Deferred();o=e.defaults(o,{"parse":!0}),o=this._prepareFetch(o);var r=o.silent;return this.error=null,this.fetched=!1,this.fetching=s.promise(),r||this.trigger("request",this,i,o),setTimeout(function(){if(this._fetchSucceeded(),this instanceof n.Model){var e=o.parse?this.parse(i,o):i;this.set(e,o)}else{this[o.reset?"reset":"set"](i,o)}o.success&&o.success.call(o.context,this,i,o),r||this.trigger("sync",this,i,o),s.resolve()}.bind(this)),this.fetching}})}}}),csui.define("nuc/models/mixins/autofetchable/autofetchable.mixin",["nuc/lib/underscore"],function(e){"use strict";return{"mixin":function(t){return e.extend(t,{"makeAutoFetchable":function(e){e&&e.autofetchEvent&&(this._autofetchEvent=e.autofetchEvent);var t=e&&e.autofetch;return t&&this.automateFetch(t),this},"automateFetch":function(t){var n=e.result(this,"_autofetchEvent"),i=t?"on":"off";this.autofetch=!!t,this[i](n,e.bind(this._fetchAutomatically,this,t))},"isFetchable":function(){return!!this.get("id")},"_autofetchEvent":"change:id","_fetchAutomatically":function(t){this.isFetchable()&&this.fetch(e.isObject(t)&&t)}})}}}),csui.define("nuc/models/mixins/resource/resource.mixin",["nuc/lib/underscore","nuc/models/mixins/connectable/connectable.mixin","nuc/models/mixins/fetchable/fetchable.mixin","nuc/models/mixins/autofetchable/autofetchable.mixin"],function(e,t,n,i){"use strict";return{"mixin":function(o){return t.mixin(o),n.mixin(o),i.mixin(o),e.extend(o,{"makeResource":function(e){return this.makeConnectable(e).makeFetchable(e).makeAutoFetchable(e)}})}}}),csui.define("nuc/models/mixins/including.additional.resources/including.additional.resources.mixin",["nuc/lib/underscore","nuc/lib/jquery"],function(e,t){return{"mixin":function(t){return e.extend(t,{"makeIncludingAdditionalResources":function(e){return this._additionalResources=[],e&&e.includeResources&&this.includeResources(e.includeResources),this},"includeResources":function(t){e.isArray(t)||(t=t.split(",")),this._additionalResources=e.union(this._additionalResources,t)},"excludeResources":function(t){t?(e.isArray(t)||(t=t.split(",")),this._additionalResources=e.reject(this._additionalResources,t)):this._additionalResources.splice(0,this._additionalResources.length)},"getAdditionalResourcesUrlQuery":function(){return e.reduce(this._additionalResources,function(e,t){return e[t]="true",e},{})}})}}}),csui.define("nuc/models/authenticated.user/server.adaptor.mixin",["nuc/lib/underscore","nuc/utils/url"],function(e,t){"use strict";return{"mixin":function(n){return e.extend(n,{"makeServerAdaptor":function(e){return this},"url":function(){var e=new t(this.connector.connection.url).getApiBase("v1"),n=t.combine(e,"/auth"),i=t.combineQueryString(this.getExpandableResourcesUrlQuery(),this.getAdditionalResourcesUrlQuery());return i?n+"?"+i:n},"parse":function(e){var t=e.data||{};return t.perspective=e.perspective,t}})}}}),csui.define("nuc/models/authenticated.user",["nuc/lib/backbone","nuc/models/mixins/expandable/expandable.mixin","nuc/models/mixins/resource/resource.mixin","nuc/models/mixins/including.additional.resources/including.additional.resources.mixin","nuc/models/authenticated.user/server.adaptor.mixin"],function(e,t,n,i,o){"use strict";var s=e.Model.extend({"constructor":function(t,n){e.Model.prototype.constructor.call(this,t,n),this.makeResource(n).makeIncludingAdditionalResources(n).makeExpandable(n).makeServerAdaptor(n)},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})}});return i.mixin(s.prototype),t.mixin(s.prototype),n.mixin(s.prototype),o.mixin(s.prototype),s}),csui.define("nuc/models/mixins/uploadable/uploadable.mixin",["module","nuc/lib/underscore","nuc/lib/jquery","nuc/lib/backbone","nuc/utils/log"],function(e,t,n,i,o){"use strict";o=o(e.id);var s=t.extend({"useJson":!1,"useMock":!1,"usePatch":!1,"metadataPartName":"body"},e.config()),r={"mixin":function(e){var i=e.sync;return e.prepare||(e.prepare=function(e,t){return e}),e.prepareFormData||(e.prepareFormData=function(e,t){return{"body":JSON.stringify(e)}}),t.extend(e,{"makeUploadable":function(e){return this},"sync":function(e,s,c){function a(){return(c.url||t.result(s,"url")).replace(/\?.*$/,"")}var u=r.useJSON,l=r.mock,d=r.usePatch,h=r.metadataPartName,f=c.data||c.attrs||this.attributes;if(!1!==c.prepare&&(f=this.prepare(f,c)),"create"===e)if(o.debug("Creating {0} ({1}).",o.getObjectName(this),this.cid)&&console.log(o.last),l)t.each(t.keys(c.files||{}),function(e){var n,i=c.files[e];if(t.isArray(i)&&i.length>1)for(n=0;n<i.length;++n){var o=n?e+n:e;f[o]=i[n]}else i&&(f[e]=i)}),t.extend(c,{"data":f,"contentType":"application/json","url":a()});else if(t.isEmpty(c.files))u?t.extend(c,{"data":JSON.stringify(f),"contentType":"application/json","url":a()}):(f=this.prepareFormData(f),t.extend(c,{"data":n.param(f),"contentType":"application/x-www-form-urlencoded","url":a()}));else{var m=new FormData;f=JSON.stringify(f),u?m.append(h,new Blob([f],{"type":"application/json"})):m.append(h,f),t.each(t.keys(c.files||{}),function(e){var n,i=c.files[e];if(t.isArray(i)&&i.length>1)for(n=0;n<i.length;++n){var o=n?e+n:e;m.append(o,i[n])}else i&&m.append(e,i,i.name)}),t.extend(c,{"data":m,"contentType":!1,"url":a()})}else if("update"===e||"patch"===e){o.debug("Updating {0} ({1}).",o.getObjectName(this),this.cid)&&console.log(o.last),d||(e="update");var p=this.state&&this.state.get("metadata_token");null!=p&&(f.metadata_token=p),l?t.extend(c,{"data":f,"contentType":"application/json","url":a()}):u?t.extend(c,{"data":JSON.stringify(f),"contentType":"application/json","url":a()}):(f=this.prepareFormData(f),t.extend(c,{"data":n.param(f),"contentType":"application/x-www-form-urlencoded","url":a()}))}return i.call(this,e,s,c)}})},"useJSON":s.useJson,"mock":s.useMock,"usePatch":s.usePatch,"metadataPartName":s.metadataPartName};return r}),csui.define("nuc/models/member/server.adaptor.mixin",["nuc/lib/underscore","nuc/utils/url"],function(e,t){"use strict";return{"mixin":function(n){return e.extend(n,{"makeServerAdaptor":function(e){return this},"urlRoot":function(){var e=new t(this.connector.connection.url).getApiBase("v1");return t.combine(e,"/members")},"url":function(){var e,n=t.combineQueryString(this.getExpandableResourcesUrlQuery()),i=this.get("id");if(i)e=t.combine(this.urlRoot(),i);else{var o=new t(this.connector.connection.url).getApiBase("v1");e=t.combine(o,"/auth")}return n?e+"?"+n:e},"parse":function(e){return e.user||e.data||e}})}}}),csui.define("nuc/models/member",["nuc/lib/backbone","nuc/models/mixins/expandable/expandable.mixin","nuc/models/mixins/resource/resource.mixin","nuc/models/mixins/uploadable/uploadable.mixin","nuc/models/mixins/including.additional.resources/including.additional.resources.mixin","nuc/models/member/server.adaptor.mixin"],function(e,t,n,i,o,s){"use strict";var r=e.Model.extend({"imageAttribute":"photo_url","constructor":function(t,n){e.Model.prototype.constructor.call(this,t,n),this.makeResource(n).makeIncludingAdditionalResources(n).makeUploadable(n).makeExpandable(n).makeServerAdaptor(n)},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})}});return o.mixin(r.prototype),t.mixin(r.prototype),i.mixin(r.prototype),n.mixin(r.prototype),s.mixin(r.prototype),r}),csui.define("nuc/models/authentication",["nuc/lib/underscore","nuc/lib/backbone","nuc/utils/url","nuc/models/member","nuc/models/mixins/connectable/connectable.mixin","nuc/models/mixins/fetchable/fetchable.mixin","nuc/models/mixins/expandable/expandable.mixin","nuc/models/mixins/including.additional.resources/including.additional.resources.mixin"],function(e,t,n,i,o,s,r,c){"use strict";var a=t.Model.extend({"constructor":function(e,n){t.Model.prototype.constructor.apply(this,arguments),this.makeConnectable(n).makeIncludingAdditionalResources(n).makeFetchable(n).makeExpandable(n),this.user=new i(this.get("user"),n)},"idAttribute":null,"url":function(){var e=n.combine(this.connector.connection.url,"auth"),t=n.combineQueryString(this.getExpandableResourcesUrlQuery(),this.getAdditionalResourcesUrlQuery());return t?e+"?"+t:e},"parse":function(t){var n=t.user||(t.user=t.data);return e.defaults(n,{"perspective":t.perspective}),this.user&&this.user.set(n),t}});return c.mixin(a.prototype),r.mixin(a.prototype),o.mixin(a.prototype),s.mixin(a.prototype),a}),csui.define("nuc/models/clientsidecollection",["nuc/lib/underscore","nuc/lib/backbone","nuc/utils/base"],function(e,t,n){"use strict";function i(){var t={"clone":function(){var e=new this.constructor(this.models,this.options);return this.columns&&e.columns.reset(this.columns.toJSON()),e.actualSkipCount=this.actualSkipCount,e.totalCount=this.totalCount,e.filteredCount=this.filteredCount,e},"_cacheCollection":function(){!0!==this.selfReset&&(this.selfReset=!1,this.cachedCollection=this.clone())},"parse":function(e){return this.actualSkipCount=0,this.totalCount=e.results.length,this.filteredCount=this.totalCount,this._limitResponse(e.results),this.columns&&this.columns.resetColumnsV2(e,this.options),e.results},"_limitResponse":function(e){e&&this.skipCount&&(e.length>this.skipCount?e.splice(0,this.skipCount):this.actualSkipCount=0),e&&this.topCount&&e.length>this.topCount&&e.splice(this.topCount)},"_resetCollection":function(){this.cachedCollection||this._cacheCollection(),this.workingModels=e.clone(this.cachedCollection.models),this.totalCount=this.workingModels.length,this.filteredCount=this.workingModels.length},"_runAllOperations":function(e){this._resetCollection(),this._sortCollection(),this._filterCollection(),this._limitCollection(),this._triggerCollectionResetEvent(e)},"_triggerCollectionResetEvent":function(t){this.models=e.clone(this.workingModels),this.length=this.models.length,t&&(this.selfReset=!0,this.trigger("reset",this))},"setLimit":function(e,t,n){if(this.skipCount!=e||this.topCount!=t)return this.skipCount=e,this.actualSkipCount=e,this.topCount=t,this._runAllOperations(!0),!0},"_limitCollection":function(){this._limitResponse(this.workingModels)},"resetLimit":function(e){if(this.skipCount)return this.skipCount=0,this.topCount=0,this.actualSkipCount=0,this._resetCollection(),this._triggerCollectionResetEvent(!0),!0},"setFilter":function(t){return this.filterObj||(this.filterObj={}),e.isEmpty(t)?this.filterObj={}:e.extend(this.filterObj,t),this._runAllOperations(!0),!0},"clearFilter":function(e){if(this.filterObj)return this.filterObj=void 0,this._resetCollection(),this._triggerCollectionResetEvent(!0),!0},"_filterCollection":function(){for(var t in this.filterObj)if(e.has(this.filterObj,t)){var n=this.filterObj[t];null!=n&&""!==n&&(e.isArray(n)||(n=[n]),this.workingModels=e.filter(this.workingModels,function(i){var o=r(t,i.get(t));return e.any(n,function(e){var n=r(t,e);return"type"===t&&-1==n?i.get("container"):s(o,n)})}))}this.totalCount=this.workingModels.length,this.filteredCount=this.workingModels.length},"setOrder":function(e,t){if(this.orderBy!=e)return this.orderBy=e,this._runAllOperations(),!0},"resetOrder":function(e){if(this.orderBy)return this.orderBy=void 0,this._resetCollection(),this._triggerCollectionResetEvent(),!0},"_sortCollection":function(){if(this.orderBy){var t=e.map(this.orderBy.split(","),function(e){var t=e.trim().split(" ");return{"property":t[0],"descending":"desc"===t[1]}});this.workingModels.sort(function(n,i){var s=0;return e.find(t,function(e){if(n=r(e.property,n.get(e.property)),i=r(e.property,i.get(e.property)),s=o(n,i))return e.descending&&(s*=-1),!0}),s})}}};return t.ClientSideCollection=e.clone(t),t}function o(e,t){if("string"==typeof e&&"string"==typeof t)return n.localeCompareString(e,t,{"usage":"sort"});if(e!=t){if(e>t||void 0===t)return 1;if(e<t||void 0===e)return-1}return 0}function s(e,t){return"string"==typeof e&&"string"==typeof t?n.localeContainsString(e,t.toString()):e==t}function r(e,t){if(null!=t){if("type"===e)return+t;if(e.indexOf("date")>=0)return new Date(t)}return t}return i}),csui.define("nuc/models/column",["module","nuc/lib/underscore","nuc/lib/backbone","nuc/utils/url","nuc/utils/log"],function(e,t,n,i,o){var s=n.Model.extend({"constructor":function(e,t){n.Model.prototype.constructor.apply(this,arguments)},"idAttribute":null,"parse":function(e){switch(e.column_key){case"name":e=t.extend(e,{"default_action":!0,"contextual_menu":!1,"editable":!0,"filter_key":"name"});break
;case"type":e=t.extend(e,{"default_action":!0})}return e}});return s.version="1.0",s}),csui.define("nuc/models/columns",["module","nuc/lib/backbone","nuc/utils/log","nuc/models/column"],function(e,t,n,i){var o=t.Collection.extend({"model":i,"constructor":function(){t.Collection.prototype.constructor.apply(this,arguments)}});return o.version="1.0",o}),csui.define("nuc/models/datadefinition",["module","nuc/lib/backbone","nuc/utils/log"],function(e,t,n){"use strict";var i=t.Model.extend({"constructor":function(){t.Model.prototype.constructor.apply(this,arguments)},"idAttribute":null,"parse":function(e){return e}});return i.version="1.0",i}),csui.define("nuc/models/datadefinitions",["module","nuc/lib/underscore","nuc/lib/backbone","nuc/utils/log","nuc/utils/base","nuc/models/datadefinition"],function(e,t,n,i,o,s){"use strict";var r=n.Collection.extend({"model":s,"constructor":function(e,t){n.Collection.prototype.constructor.apply(this,arguments),this.setOptions(t)},"setOptions":function(e){this.options=e||{},this.options.connector&&this.options.connector.assignTo(this),this.options.node&&this.options.node.connector&&this.options.node.connector.assignTo(this)},"url":function(){var e;if(this.options.url){var t=new o.Url(this.connector.connection.url).getCgiScript(!0);e=o.Url.combine(t,this.options.url)}else e=this.options.node&&this.options.node.urlBase(),this.options.nodeResource&&(e=o.Url.combine(e,this.options.nodeResource));return e},"fetch":function(e){return i.debug("Fetching data-definitions for url '{0}'.",this.url())&&"undefined"!=typeof console&&console.log(i.last),e||(e={}),void 0===e.reset&&(e.reset=!0),n.Collection.prototype.fetch.call(this,e)},"parse":function(e,i){return this.data=e.data||{},this.definitions=e.definitions||{},this.definitions_map=e.definitions_map||{},this.definitions_order=e.definitions_order||{},this.definitions_flat={},t.each(this.definitions,function(e,n){var i=t.extend({"signature":n,"href":this.data[n]},e);this.definitions_flat[n]=i},this),n.Collection.prototype.parse.call(this,this.definitions_flat,i)},"GetDefinitionsOrder":function(){return this.definitions_order},"GetDefinitionMap":function(){return this.definitions_map},"GetDefinition":function(e){return this.definitions[e]},"GetFlatCollection":function(){return this.definitions_flat||{}},"GetFlatDefinition":function(e){return this.definitions_flat[e]}});return t.extend(r,{"version":"1.0"}),r}),csui.define("nuc/models/member/member.server.adaptor.mixin",["nuc/lib/underscore","nuc/utils/url"],function(e,t){"use strict";return{"mixin":function(n){return e.extend(n,{"makeServerAdaptor":function(e){return this},"url":function(){var e=this.get("id"),n=this.connector.getConnectionUrl().getApiBase("v2");return!e&&this.options.id&&(e=this.options.id),n=e?t.combine(n,"members/"+e+"/members"):t.combine(n,"members")},"parse":function(t){if(void 0!==t.data){var n=this.get("id");return e.each(t.data,function(e){e.parentId=n}),t}return t}})}}}),csui.define("nuc/models/member/member.model",["nuc/lib/underscore","nuc/lib/backbone","nuc/utils/url","nuc/models/mixins/resource/resource.mixin","nuc/models/mixins/uploadable/uploadable.mixin","nuc/models/member/member.server.adaptor.mixin"],function(e,t,n,i,o,s){"use strict";var r=t.Model.extend({"constructor":function(e,n){t.Model.prototype.constructor.call(this,e,n),this.options=n,this.groupId=e.groupId,this.makeResource(n)},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})}});return o.mixin(r.prototype),i.mixin(r.prototype),s.mixin(r.prototype),r}),csui.define("nuc/models/browsable/browsable.mixin",["nuc/lib/underscore","nuc/lib/backbone","nuc/utils/url"],function(e,t,n){function i(t,i){if(void 0!==t&&null!==t&&""!==t&&(t=e.isArray(t)?n.makeMultivalueParameter("where_"+i,t):"where_"+i+"="+encodeURIComponent(t.toString()),t.length>0))return t}return{"mixin":function(t){return e.extend(t,{"makeBrowsable":function(t){if(t||(t={}),this.skipCount=t.skip||0,this.topCount=t.top||0,this.filters=t.filter||{},this.orderBy=t.orderBy,e.isString(this.filters))try{this.filters=JSON.parse(this.filters)}catch(e){this.filters={}}return this},"setFilter":function(t,n,o){var s,r,c=t;if(e.isObject(t)&&!e.isArray(t)?o=n:(c={},c[n]=t),"object"!=typeof o&&(o={"fetch":o}),e.isEmpty(c)){if(o.clear)return this.clearFilter(o.fetch)}else{for(s in c)e.has(c,s)&&(t=c[s],i(this.filters[s],s)!==i(t,s)&&(void 0!==t?this.filters[s]=t:delete this.filters[s],r=!0));if(o.clear)for(s in this.filters)e.has(this.filters,s)&&!e.has(c,s)&&void 0!==i(this.filters[s],s)&&(delete this.filters[s],r=!0);if(r)return this.trigger("filter:change"),!1!==o.fetch&&this.fetch(),!0}},"clearFilter":function(t){var n;if(!e.isEmpty(this.filters))for(var o in this.filters)e.has(this.filters,o)&&void 0!==i(this.filters[o],o)&&(delete this.filters[o],n=!0);if(n)return this.trigger("filter:clear"),!1!==t&&this.fetch(),!0},"getFilterAsObject":function(){var t={},n=this.filters;return n&&e.forEach(e.keys(n),function(i){var o=n[i];if(o&&e.isArray(o)){var s=o.map(function(e){if(e&&"string"==typeof e){var t=e&&e.split(":"),n=t[1]&&t[1].split("|");return n=n&&n.map(function(e){return{"id":e}}),{"id":t[0],"values":n}}return e});o=s&&s.length>0?s:void 0}o&&(t[i]=o)}),t},"getFilterAsString":function(){var t="",n=this.filters;return n&&e.forEach(e.keys(n),function(i){var o=n[i];o&&(t&&(t+="||"),o&&e.isArray(o)?o.length>0&&(t+=i+"=["+o+"]"):t+=i+"="+o)}),t},"filterStringToObject":function(t){var n=t.split("||"),i={};return e.each(n,function(e){var t=e.split("="),n=t[1];n&&"["===n.charAt(0)&&(n=n.substring(1,n.length-1).split(",")),i[t[0]]=n}),i},"setOrder":function(e,t){if(this.orderBy!=e)return this.orderBy=e,!1!==t&&this.fetch({"skipSort":!1}),this.trigger("orderBy:change"),!0},"resetOrder":function(e){if(this.orderBy)return this.orderBy=void 0,this.trigger("orderBy:clear"),!1!==e&&this.fetch(),!0},"setSkip":function(e,t){if(this.skipCount!=e)return this.skipCount=e,this.trigger("paging:change"),!1!==t&&this.fetch(),!0},"setTop":function(e,t){if(this.topCount!=e)return this.topCount=e,this.trigger("paging:change"),!1!==t&&this.fetch(),!0},"setLimit":function(e,t,n){if(this.skipCount!=e||this.topCount!=t)return this.skipCount=e,this.topCount=t,this.trigger("paging:change"),!1!==n&&this.fetch(),!0},"resetLimit":function(e){if(this.skipCount)return this.skipCount=0,this.trigger("limits:change"),!1!==e&&this.fetch(),!0}})}}}),csui.define("nuc/models/browsable/v1.request.mixin",["nuc/lib/underscore","nuc/lib/jquery","nuc/utils/url"],function(e,t,n){function i(e,t){var n={};return void 0!==e&&null!==e&&""!==e&&(n.key="where_"+t,n.value=e),n}return{"mixin":function(o){return e.extend(o,{"makeBrowsableV1Request":function(e){return this},"getFilterValue":function(t){return t&&e.map(t,function(t){return t.id+":"+e.reduce(t.values,function(e,t){return e&&(e+="|"),e+t.id.toString()},"")})||[]},"getBrowsableParams":function(){var n={},o=this.topCount||0;if(o&&(n.limit=o,n.page=Math.floor((this.skipCount||0)/o)+1),this.orderBy){var s=this.orderBy.split(",")[0].split(" ");"relevance"===this.orderBy.toLowerCase()?n.sort=this.orderBy:n.sort=(s[1]||"asc")+"_"+s[0]}if(!t.isEmptyObject(this.filters))for(var r in this.filters)if(e.has(this.filters,r)){var c=i(this.filters[r],r),a=[];a=c&&c.value&&c.value instanceof Array&&c.value[0]&&c.value[0]instanceof Object?this.getFilterValue(c.value):c.value,void 0!==c.key&&(n[c.key]=a)}return n},"getBrowsableUrlQuery":function(){return n.combineQueryString(this.getBrowsableParams())}})}}}),csui.define("nuc/models/member/membercollection.server.adaptor",["nuc/lib/underscore","nuc/utils/url"],function(e,t){"use strict";return{"mixin":function(n){return e.extend(n,{"makeServerAdaptor":function(e){return this},"url":function(){var e=this.connector.connection.url,n=this.groupId;void 0!==n&&null!==n||(n=this.parentId,this.topCount=20),this.topCount||(this.topCount=20);var i=t.combineQueryString(this.getBrowsableUrlQuery(),{"expand":"properties{group_id}"});return i=i.replace("where_name","query"),e=this.connector.getConnectionUrl().getApiBase("v2"),e=this.type&&"GroupsOfCurrentUser"===this.type?t.combine(e,"members/memberof?"+i):1===this.type&&n?t.combine(e,"members/"+n+"/members?where_type=1&"+i):1===this.type?t.combine(e,"members?where_type=1&"+i):n?t.combine(e,"members/"+n+"/members?"+i):t.combine(e,"members?"+i)},"parse":function(t,n){if(!e.isEmpty(t.results)){var i=this;return this.totalCount=t.collection&&t.collection.paging?t.collection.paging.total_count:t.results.length,e.each(t.results,function(t){t.parentId=i.parentId,t=e.extend(t,t.data.properties)}),t.results}return this.totalCount=0,null}})}}}),csui.define("nuc/models/member/membercollection",["nuc/lib/underscore","nuc/lib/backbone","nuc/utils/url","nuc/models/mixins/resource/resource.mixin","nuc/models/browsable/browsable.mixin","nuc/models/browsable/v1.request.mixin","nuc/models/member/member.model","nuc/models/member/membercollection.server.adaptor"],function(e,t,n,i,o,s,r,c){"use strict";var a=t.Collection.extend({"model":r,"searchTerm":"","constructor":function(e,n){t.Collection.prototype.constructor.apply(this,arguments),this.makeResource(n),this.makeBrowsable(n),void 0!==n&&void 0!==n.member&&null!==n.member?(this.parentId=n.member.get("id"),this.nodeId=n.member.get("nodeId"),this.categoryId=n.member.get("categoryId"),this.groupId=n.member.get("groupId")):(this.nodeId=n.nodeId,this.categoryId=n.categoryId,this.groupId=n.groupId),this.query=n.query||"",this.type=n.type},"clone":function(){var e=new this.constructor(this.models,{"connector":this.connector,"parentId":this.parentId,"nodeId":this.nodeId,"categoryId":this.categoryId,"groupId":this.groupId,"query":this.query});return e.totalCount=this.totalCount,e},"search":function(e){this.searchTerm=e,this.fetch()}});return i.mixin(a.prototype),o.mixin(a.prototype),s.mixin(a.prototype),c.mixin(a.prototype),a}),csui.define("nuc/models/member/members.server.adaptor",["nuc/lib/underscore","nuc/utils/url"],function(e,t){"use strict";return{"mixin":function(n){return e.extend(n,{"makeServerAdaptor":function(e){return this},"urlRoot":function(){var e=new t(this.connector.connection.url).getApiBase("v2");return t.combine(e,"/members")},"url":function(){var n=t.combineQueryString({"limit":this.limit,"sort":this.orderBy,"query":this.query},this.memberType.length&&{"where_type":this.memberType},this.expandFields.length&&{"expand":"properties{"+this.expandFields+"}"});return t.appendQuery(e.result(this,"urlRoot"),n)},"parse":function(t){return e.isEmpty(t.results)?null:(e.each(t.results,function(t){t=e.extend(t,t.data.properties),delete t.data}),t.results)}})}}}),csui.define("nuc/models/members",["nuc/lib/underscore","nuc/lib/jquery","nuc/lib/backbone","nuc/utils/url","nuc/models/member","nuc/models/mixins/resource/resource.mixin","nuc/models/member/members.server.adaptor"],function(e,t,n,i,o,s,r){"use strict";var c=n.Collection.extend({"constructor":function(e,t){n.Collection.prototype.constructor.apply(this,arguments),this.makeResource(t),t||(t={}),this.limit=t.limit||10,this.query=t.query||"",this.orderBy=t.orderBy,this.expandFields=t.expandFields||[],t.memberFilter&&t.memberFilter.type&&(this.memberType=t.memberFilter.type),this.memberType||(this.memberType=[0,1])},"model":o,"clone":function(){return new this.constructor(this.models,{"connector":this.connector,"limit":this.limit,"query":this.query,"expandFields":e.clone(this.expandFields),"memberFilter":{"type":this.memberType}})}});return s.mixin(c.prototype),r.mixin(c.prototype),c}),csui.define("nuc/models/mixins/v2.fields/v2.fields.mixin",["nuc/lib/underscore"],function(e){"use strict";return{"mixin":function(t){return e.extend(t,{"fields":{},"makeFieldsV2":function(e){return this.fields=e&&e.fields||{},this},"hasFields":function(t){return!!this.fields[t]||!!(e.isEmpty(this.fields)&&this.collection&&this.collection.fields)&&(t?!!this.collection.fields[t]:e.isEmpty(this.collection.fields))},"setFields":function(t,n){e.isObject(t)?e.each(t,function(e,t){this._setOneFieldSet(t,e)},this):this._setOneFieldSet(t,n)},"resetFields":function(t,n){e.isObject(t)?e.each(t,function(e,t){this._resetOneFieldSet(t,e)},this):this._resetOneFieldSet(t,n)},"getResourceFieldsUrlQuery":function(){return e.reduce(this.fields,function(t,n,i){var o=t.fields||(t.fields=[]),s=e.map(n,encodeURIComponent),r=encodeURIComponent(i);if(s.length){var c=r.indexOf(".");c>0?r=r.substring(0,c)+"{"+s.join(",")+"}"+r.substring(c):r+="{"+s.join(",")+"}"}return o.push(r),t},{})},"_setOneFieldSet":function(t,n){var i=this.fields[t]||(this.fields[t]=[]);n&&(e.isArray(n)||(n=n.split(",")),e.each(n,function(t){e.contains(i,t)||i.push(t)},this))},"_resetOneFieldSet":function(t,n){if(n){var i=this.fields[t]||(this.fields[t]=[]);e.isArray(n)||(n=n.split(",")),e.each(n,function(t){var n=e.indexOf(i,t);n>=0&&i.splice(n,1)},this)}else t?delete this.fields[t]:e.chain(this.fields).keys().each(function(e){delete this.fields[e]},this)}})},"mergePropertyParameters":function(t,n){return"string"==typeof n&&(n=n.split(",")),Array.isArray(n)&&(n=n.reduce(function(e,t){var n=e[t];return n&&!n.length||(e[t]=[]),e},{})),t||(t={}),e.each(n,function(n,i){var o=t[i];o?e.each(n,function(t){e.contains(o,t)||o.push(t)}):t[i]=n}),t}}}),csui.define("nuc/models/mixins/v2.expandable/v2.expandable.mixin",["nuc/lib/underscore","nuc/models/mixins/v2.fields/v2.fields.mixin"],function(e,t){"use strict";return{"mixin":function(t){return e.extend(t,{"makeExpandableV2":function(e){return this.expand=e&&e.expand||{},this},"hasExpand":function(t){return!!this.expand[t]||!!(e.isEmpty(this.expand)&&this.collection&&this.collection.expand)&&(t?!!this.collection.expand[t]:e.isEmpty(this.collection.expand))},"setExpand":function(t,n){e.isObject(t)?e.each(t,function(e,t){this._setOneExpand(t,e)},this):this._setOneExpand(t,n)},"resetExpand":function(t,n){e.isObject(t)?e.each(t,function(e,t){this._resetOneExpand(t,e)},this):this._resetOneExpand(t,n)},"getExpandableResourcesUrlQuery":function(){return e.reduce(this.expand,function(t,n,i){var o=t.expand||(t.expand=[]),s=e.map(n,encodeURIComponent),r=encodeURIComponent(i);return s.length&&(r+="{"+s.join(",")+"}"),o.push(r),t},{})},"_setOneExpand":function(t,n){var i=this.expand[t]||(this.expand[t]=[]);n&&(e.isArray(n)||(n=n.split(",")),e.each(n,function(t){e.contains(i,t)||i.push(t)},this))},"_resetOneExpand":function(t,n){if(n){var i=this.expand[t]||(this.expand[t]=[]);e.isArray(n)||(n=n.split(",")),e.each(n,function(t){var n=e.indexOf(i,t);n>=0&&i.splice(n,1)},this)}else t?delete this.expand[t]:e.chain(this.expand).keys().each(function(e){delete this.expand[e]},this)}})},"mergePropertyParameters":t.mergePropertyParameters}}),csui.define("nuc/models/mixins/state.requestor/state.requestor.mixin",["nuc/lib/underscore"],function(e){"use strict";return{"mixin":function(t){return e.extend(t,{"makeStateRequestor":function(e){return this.stateEnabled=e&&e.stateEnabled,this},"enableState":function(){this.stateEnabled=!0},"disableState":function(){this.stateEnabled=!1},"getStateEnablingUrlQuery":function(){return(null!=this.stateEnabled?this.stateEnabled:this.collection&&this.collection.stateEnabled)?{"state":""}:{}}})}}}),csui.define("nuc/models/mixins/state.carrier/state.carrier.mixin",["nuc/lib/underscore","nuc/lib/backbone","nuc/models/mixins/state.requestor/state.requestor.mixin"],function(e,t,n){"use strict";function i(e){var t=e&&e.state;return t&&t.properties||t}return{"mixin":function(o){return n.mixin(o),e.extend(o,{"makeStateCarrier":function(e,n){return this.state=new t.Model(i(n)),this.makeStateRequestor(e)},"setState":function(e){if(this.state){var t=i(e);t&&this.state.set(t)}},"parseState":function(e,t,n){e.state=i(t)}})}}}),csui.define("nuc/models/mixins/v2.commandable/v2.commandable.mixin",["nuc/lib/underscore","nuc/utils/url"],function(e,t){"use strict";return{"mixin":function(t){return e.extend(t,{"makeCommandableV2":function(e){var t=e&&e.commands;return"string"==typeof t&&(t=t.split(",")),this.commands=t||[],this},"setCommands":function(t){e.isArray(t)||(t=t.split(",")),e.each(t,function(t){e.contains(this.commands,t)||this.commands.push(t)},this)},"resetCommands":function(t){t?(e.isArray(t)||(t=t.split(",")),e.each(t,function(t){var n=e.indexOf(this.commands,t);n>=0&&this.commands.splice(n,1)},this)):this.commands.splice(0,this.commands.length)},"getRequestedCommandsUrlQuery":function(){return this.commands.length&&{"actions":this.commands}}})}}}),csui.define("nuc/models/node.actions/server.adaptor.mixin",["nuc/lib/underscore","nuc/utils/url"],function(e,t){"use strict";return{"mixin":function(n){var i=n.fetch;return e.extend(n,{"makeServerAdaptor":function(e){return this},"fetch":function(n){var o={};!!this.parent_id&&(o.reference_id=this.parent_id),this.reference_id&&!o.reference_id&&(o.reference_id=this.reference_id),o.ids=this.nodes,o.actions=this.getRequestedCommandsUrlQuery().actions;var s=n||{};return e.extend(s,{"type":"POST","url":t.combine(this.connector.getConnectionUrl().getApiBase("v2"),"/nodes/actions"),"contentType":"application/x-www-form-urlencoded","data":{"body":JSON.stringify(o)}}),i.call(this,s)},"parse":function(t,n){return e.isArray(t)?t:e.map(t.results,function(t,n){return{"id":n,"actions":e.map(t.data,function(e,t){return e.signature=t,e})}},{})}})}}}),csui.define("nuc/models/node.actions",["nuc/lib/underscore","nuc/lib/backbone","nuc/utils/url","nuc/models/actions","nuc/models/mixins/connectable/connectable.mixin","nuc/models/mixins/fetchable/fetchable.mixin","nuc/models/mixins/v2.commandable/v2.commandable.mixin","nuc/models/node.actions/server.adaptor.mixin"],function(e,t,n,i,o,s,r,c){"use strict";var a=t.Model.extend({"constructor":function(e,n){t.Model.prototype.constructor.apply(this,arguments),this.actions=new i(e&&e.actions)}}),u=t.Collection.extend({"model":a,"constructor":function(e,n){t.Collection.prototype.constructor.apply(this,arguments);var i=n&&n.nodes;"string"==typeof i&&(i=i.split(",")),this.nodes=i||[],!!n.reference_id&&(this.reference_id=n.reference_id),this.makeConnectable(n).makeFetchable(n).makeCommandableV2(n).makeServerAdaptor(n)},"setNodes":function(t){e.isArray(t)||(t=t.split(",")),e.each(t,function(t){e.contains(this.nodes,t)||this.nodes.push(t)},this)},"resetNodes":function(t){t?(e.isArray(t)||(t=t.split(",")),e.each(t,function(t){var n=e.indexOf(this.nodes,t);n>=0&&this.nodes.splice(n,1)},this)):this.nodes=[]},"clone":function(){return new this.constructor(this.models,{"connector":this.connector,"nodes":e.clone(this.nodes),"commands":e.clone(this.includeCommands)})}});return o.mixin(u.prototype),s.mixin(u.prototype),r.mixin(u.prototype),c.mixin(u.prototype),u}),csui.define("nuc/utils/promoted.actionitems",["nuc/lib/underscore","nuc/models/actionitems"],function(e,t,n){"use strict";return new t([{"signature":"properties","sequence":10},{"signature":"unreserve","sequence":10},{"signature":"permissions","sequence":10},{"signature":"reserve","sequence":10},{"signature":"rename","sequence":10},{"signature":"share","sequence":10},{"signature":"edit","sequence":10},{"signature":"copy","sequence":10},{"signature":"move","sequence":10},{"signature":"download","sequence":10},{"signature":"comment","sequence":10},{"signature":"open","sequence":10},{"signature":"delete","sequence":10},{"signature":"browse","sequence":10},{"signature":"addversion","sequence":10},{"signature":"editpermissions","sequence":10},{"signature":"versionscontrol","sequence":10}])}),csui.define("nuc/utils/deepClone/deepClone",["nuc/lib/underscore","nuc/lib/backbone"],function(e,t){function n(t,i){if(!t||"object"!=typeof t||t instanceof HTMLElement||e.isBoolean(t)||e.isNumber(t)||e.isString(t))return t;if(e.isDate(t)||e.isRegExp(t))return new t.constructor(t.valueOf());if(e.isArray(t))return e.map(t,function(t){return e.deepClone(t)});if(t.constructor!==Object){if(!i)throw new Error("Cannot clone an arbitrary function object instance");if(i.cloneCloneableObjects){if(t.deepClone)return t.deepClone();if(t.clone)return t.clone()}if(i.copyArbitraryObjects)return t;if(!i.cloneArbitraryObjects)throw new Error("Cannot clone an arbitrary function object instance")}return e.reduce(t,function(e,t,i){return e[i]=n(t),e},{})}return e.mixin({"deepClone":n}),t.Model.prototype.deepClone=function(e){return new this.constructor(n(this.attributes,e))},t.Collection.prototype.deepClone=function(e){return new this.constructor(this.map(function(t){return n(t.attributes,e)}))},n}),csui.define("nuc/models/mixins/v2.delayed.commandable/v2.delayed.commandable.mixin",["nuc/lib/underscore","nuc/lib/jquery","nuc/lib/backbone","nuc/models/node.actions","nuc/models/mixins/v2.commandable/v2.commandable.mixin","nuc/utils/promoted.actionitems","nuc/utils/deepClone/deepClone"],function(e,t,n,i,o,s){"use strict";return{"mixin":function(r){o.mixin(r);var c=r._prepareModel;return e.extend(r,{"makeDelayedCommandableV2":function(e){e||(e={});var t=e.defaultActionCommands,n=e.promotedActionCommands||s.getPromotedCommandsSignatures(),i=e.nonPromotedActionCommands||[],o=e.nonPromotedActionsOptions||{},r=e.delayedActionsOptions||{},c=e.additionalActionsOptions||{};return"string"==typeof t&&(t=t.split(",")),this.defaultActionCommands=t||[],this.promotedActionCommands=n,this.nonPromotedActionCommands=i||[],this.nonPromotedActionsOptions=o,this.delayedActionsOptions=r,this.additionalActionsOptions=c,this.delayedActions=this.createDelayedActions(),this.additionalActions=this.createAdditionalActions(),this.setEnabledDelayRestCommands(e.delayRestCommands,e.promoteSomeRestCommands),this.delayRestCommandsForModels=e.delayRestCommandsForModels,this.promotedActionItemsFromControler=s,this.makeCommandableV2(e)},"setEnabledDelayRestCommands":function(e,t){e?this._enableDelayRestCommands():this._disableDelayRestCommands(),this.promoteSomeRestCommands=!1!==t},"setEnabledLazyActionCommands":function(e){var n=t.Deferred();return e?(this._enableNonPromotedRestCommands(),this._requestsNonPromotedRestActions().done(function(e){n.resolve(e)}).fail(function(e){n.reject(e)})):this._disableNonPromotedRestCommands(),n.promise()},"getAdditionalActionCommands":function(n,i){var o=t.Deferred();return this._requestAdditionalActions(n,i).done(e.bind(function(e){o.resolve(e)},this)).fail(function(e){o.reject(e)}),o.promise()},"_enableDelayRestCommands":function(){this.delayRestCommands||(this.delayRestCommands=!0,this.on("sync",this._requestRestActions,this))},"_disableDelayRestCommands":function(){this.delayRestCommands&&(this.delayRestCommands=!1,this.off("sync",this._requestRestActions,this))},"_enableNonPromotedRestCommands":function(){this.enableNonPromotedCommands||(this.enableNonPromotedCommands=!0,this.on("sync",this._requestsNonPromotedRestActions,this))},"_disableNonPromotedRestCommands":function(){this.enableNonPromotedCommands=!1,this.off("sync",this._requestsNonPromotedRestActions,this)},"_requestRestActions":function(e,t,i){e!==this||this instanceof n.Collection&&!this.length||i.xhr&&"GET"!==i.xhr.settings.type&&"POST"!==i.xhr.settings.type||(this.promoteSomeRestCommands?this._requestPromotedActions(e,t,i):this._requestDelayedActions(e,t,i))},"_requestDelayedActions":function(){var t=this.defaultActionCommands,i=e.reject(this.commands,function(n){return e.contains(t,n)});if(i.length){var o=this.delayedActions;o.resetCommands(),o.setCommands(i),o.resetNodes(),this instanceof n.Collection?o.setNodes(this.pluck("id")):o.setNodes([this.get("id")]),o.connector||this.connector.assignTo(o),o.parent_id=this.node?this.node.get("id"):this.get("id"),o.fetch({"success":this._updateOriginalActions.bind(this),"reset":!0})}},"_requestPromotedActions":function(t){var i=this.defaultActionCommands,o=this.promotedActionCommands,s=e.reject(this.commands,function(t){return e.contains(i,t)}),r=[],c=[];if(e.each(s,function(t){e.contains(o,t)?r.push(t):c.push(t)}),this.promotedActionCommands=r,this.nonPromotedActionCommands=c,r.length){var a=this.delayedActions;if(a.resetCommands(),a.setCommands(r),a.resetNodes(),this instanceof n.Collection){var u=[];this.each(function(e){e.nonPromotedActionCommands=c,e.promotedActionCommands=r,e.get("csuiDelayedActionsRetrieved")||u.push(e.get("id"))}),a.setNodes(u)}else t.nonPromotedActionCommands=c,t.promotedActionCommands=r,a.setNodes([this.get("id")]);a.parent_id=this.node?this.node.get("id"):this.get("id"),a.nodes.length>0&&(a.connector||this.connector.assignTo(a),a.fetch({"reset":!0,"success":e.bind(this._updateOriginalActions,this)}))}else this instanceof n.Collection?this.each(function(e){e.nonPromotedActionCommands=c,e.promotedActionCommands=r}):(t.nonPromotedActionCommands=c,t.promotedActionCommands=r)},"setNonPromotedActionsOptions":function(t){e.extend(this.nonPromotedActionsOptions,t)},"resetNonPromotedActionsOptions":function(t){t?(e.isArray(t)||(t=t.split(",")),this.nonPromotedActionsOptions=e.omit(this.nonPromotedActionsOptions,t)):this.nonPromotedActionsOptions={}},"_requestsNonPromotedRestActions":function(){var i=t.Deferred(),o=this.createNonPromotedActionsOptions(),s=this.nonPromotedActionCommands.length?this.nonPromotedActionCommands:this.collection.nonPromotedActionCommands;if(o.resetCommands(),o.setCommands(s),o.resetNodes(),this instanceof n.Collection){var r=[];this.each(function(e){e.get("csuiLazyActionsRetrieved")||e.isLocallyCreated||r.push(e.get("id"))}),o.parent_id=this.length&&this.models[0].get("reference_id"),o.setNodes(r)}else o.setNodes([this.get("id")]),o.parent_id=this.get("reference_id");return o.connector||this.connector.assignTo(o),o.commands.length&&o.nodes.length?o.fetch({"reset":!0,"success":e.bind(function(){this._updateOriginalActionsAfterLazyActions(o),i.resolve(this)},this),"error":e.bind(function(e){this.attributes.csuiLazyActionsRetrieved=!1,i.reject(e)},this)}):(this instanceof n.Collection?this.each(function(e){e.set("csuiLazyActionsRetrieved",!0)}):this.set("csuiLazyActionsRetrieved",!0),i.resolve(this)),i.promise()},"_requestAdditionalActions":function(i,o){var s=t.Deferred(),r=this.additionalActions;if(r.resetCommands(),r.setCommands(i),r.resetNodes(),this instanceof n.Collection){var c=[];this.each(function(e){e.get(o)||e.isLocallyCreated||c.push(e.get("id"))}),r.parent_id=this.length&&this.models[0].get("reference_id"),r.setNodes(c)}else r.setNodes([this.get("id")]),r.parent_id=this.get("reference_id");return r.connector||this.connector.assignTo(r),r.commands.length&&r.nodes.length?r.fetch({"reset":!0,"success":e.bind(function(){this._updateOriginalActionsAfterAdditionalActions(o),s.resolve(this)},this),"error":e.bind(function(e){this.attributes[o]=!1,s.reject(e)},this)}):(this instanceof n.Collection?this.each(function(e){e.set(o,!0)}):this.set(o,!0),s.resolve(this)),s.promise()},"_updateOriginalActions":function(){function e(e){var n=t.get(e.get("id"));n&&(e.trigger("before:update:actions",{"target":e,"node":e,"newActions":n.actions}),e.collection&&e.collection.trigger("before:update:actions",{"target":this,"node":e,"newActions":n.actions}),e.actions.add(n.actions.models),e.set("csuiDelayedActionsRetrieved",!0))}var t=this.delayedActions;this instanceof n.Collection?this.each(e,this):e.call(this,this)},"_updateOriginalActionsAfterLazyActions":function(t){var i=function(n){var i=t.get(n.get("id"));e.contains(t.nodes,n.get("id"))&&(n.attributes.csuiLazyActionsRetrieved=!0),i&&(e.each(i.actions.models,function(e){e.attributes.csuiNonPromotedAction=!0}),n.actions.add(i.actions.models))};this instanceof n.Collection?this.each(i):i(this)},"_updateOriginalActionsAfterAdditionalActions":function(t){var i=this.additionalActions,o=function(n){n.attributes[t]=!0;var o=i.get(n.get("id"));o&&(e.each(o.actions.models,function(e){e.attributes.csuiNonPromotedAction=!0}),n.actions.add(o.actions.models))};this instanceof n.Collection?this.each(o):o(this)},"createNonPromotedActionsOptions":function(){return new i(void 0,e.extend({"isNonPromoted":!0,"connector":this.connector},this.nonPromotedActionsOptions))},"createDelayedActions":function(){return new i(void 0,e.extend({"connector":this.connector},this.delayedActionsOptions))},"createAdditionalActions":function(){return new i(void 0,e.extend({"isNonPromoted":!0,"connector":this.connector},this.additionalActionsOptions))},"setDefaultActionCommands":function(t){e.isArray(t)||(t=t.split(",")),e.each(t,function(t){e.contains(this.defaultActionCommands,t)||this.defaultActionCommands.push(t)},this)},"resetDefaultActionCommands":function(t){t?(e.isArray(t)||(t=t.split(",")),e.each(t,function(t){var n=e.indexOf(this.defaultActionCommands,t);n>=0&&this.defaultActionCommands.splice(n,1)},this)):this.defaultActionCommands.splice(0,this.defaultActionCommands.length)},"getRequestedCommandsUrlQuery":function(){var e=this.delayRestCommands?this.defaultActionCommands:this.commands;return e.length&&{"actions":e}},"getAllCommandsUrlQuery":function(){var e=this.commands;return e.length&&{"actions":e}},"_prepareModel":function(e,t){var n,i,o;t||(t={}),n=t.delayRestCommands,i=t.delayRestCommandsForModels,o=t.promoteSomeRestCommands,this.delayedActions&&(void 0===n&&(n=this.delayRestCommands),void 0===i&&(i=this.delayRestCommandsForModels),void 0===o&&(o=this.promoteSomeRestCommands)),t.delayRestCommands=i,t.delayRestCommandsForModels=!1,t.promoteSomeRestCommands=o;var s=c.call(this,e,t);return t.delayRestCommands=n,t.delayRestCommandsForModels=i,s}})}}}),csui.define("nuc/models/mixins/v2.additional.resources/v2.additional.resources.mixin",["nuc/lib/underscore","nuc/lib/jquery"],function(e,t){return{"mixin":function(t){return e.extend(t,{"makeAdditionalResourcesV2Mixin":function(e){return this._additionalResources=[],e&&e.includeResources&&this.includeResources(e.includeResources),this},"includeResources":function(t){t&&!e.isArray(t)&&(t=t.split(",")),this._additionalResources=e.union(this._additionalResources,t)},"excludeResources":function(t){t?(e.isArray(t)||(t=t.split(",")),this._additionalResources=e.reject(this._additionalResources,t)):this._additionalResources.splice(0,this._additionalResources.length)},"getAdditionalResourcesUrlQuery":function(){return e.reduce(this._additionalResources,function(e,t){return e[t]="",e},{})}})}}}),csui.define("nuc/models/node.columns2",["nuc/lib/backbone"],function(e){"use strict";var t=e.Model.extend({"id":"column_key","constructor":function(t,n){e.Model.prototype.constructor.call(this,t,n)}});return e.Collection.extend({"model":t,"constructor":function(t,n){e.Collection.prototype.constructor.call(this,t,n)}})}),csui.define("nuc/models/node/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("nuc/models/node/impl/nls/root/lang",{"sizeColumnTitle":"Size"}),csui.define("nuc/models/utils/v1tov2",[],function(){"use strict";function e(e){function t(e,t){var n=e.properties||(e.properties=[]);t.forEach(function(e){n.indexOf(e)<0&&n.push(e)})}return Array.isArray(e)?e.reduce(function(e,n){return"node"===n?t(e,i):"member"===n?t(e,r):"user"===n?t(e,o):"group"===n?t(e,s):e[n]||(e[n]=[]),e},{}):"node"===e?{"properties":i.slice()}:"member"===e?{"properties":r.slice()}:"user"===e?{"properties":o.slice()}:"group"===e?{"properties":s.slice()}:e}function t(e){return Array.isArray(e)?e.reduce(function(e,t){return"node"!==t&&"user"!==t&&"group"!==t&&"member"!==t||(t="properties"),e.indexOf(t)<0&&e.push(t),e},[]):"node"===e?i.slice():"member"===e?r.slice():"user"===e||"member"===e?o.slice():"group"===e?s.slice():e}function n(e){if(Array.isArray(e))return e.reduce(function(e,t){return i.indexOf(t)>=0?e.push("node"):o.indexOf(t)>=0?e.push("user"):s.indexOf(t)>=0&&e.push("group"),e},[]);if("object"==typeof e){var t=e.properties;return t?t.length?t.reduce(function(e,t){return i.indexOf(t)>=0?t="node":o.indexOf(t)>=0?t="user":s.indexOf(t)>=0&&(t="group"),e.indexOf(t)<0&&e.push(t),e},[]):["node","member"]:[]}return"properties"===e?["node","member"]:e}
var i=["original_id","parent_id","volume_id"],o=["create_user_id","modify_user_id","owner_user_id","reserved_user_id"],s=["owner_group_id"],r=o.concat(s);return{"includeExpandsV1toV2":e,"excludeExpandsV1toV2":t,"expandsV2toV1":n,"nodeExpands":i,"userExpands":o}}),csui.define("nuc/models/mixins/syncable.from.multiple.sources/syncable.from.multiple.sources.mixin",["nuc/lib/underscore","nuc/lib/jquery"],function(e,t){"use strict";return{"mixin":function(n){return e.extend(n,{"makeSyncableFromMultipleSources":function(e){return this},"syncFromMultipleSources":function(e,n,i,o){function s(e){return Array.isArray(e)?e[0]:e}void 0===o&&"object"==typeof i?(o=i,i=s):null==i&&(i=s);var r=this,c=e.filter(function(e){return e.abort}),a=t.Deferred(),u=a.promise();return c.length&&(u.abort=function(e){return e||(e="canceled"),c.forEach(function(t){t.abort(e)}),this}),r.trigger("request",r,{},o),t.when.apply(t,e).done(function(){var e=n.apply(r,arguments),t=o.success;t&&t.call(o.context,e,"success",{}),a.resolve(e,"success",{})}).fail(function(){var e=i.apply(r,arguments),t=o.error;t&&t.call(o.context,e,"error",e.statusText),a.reject.call(a,e,"error",e.statusText)}),u}})}}}),csui.define("nuc/models/node/server.adaptor.mixin",["require","nuc/lib/underscore","nuc/lib/jquery","nuc/utils/url","i18n!nuc/models/node/impl/nls/lang","nuc/models/utils/v1tov2","nuc/models/mixins/syncable.from.multiple.sources/syncable.from.multiple.sources.mixin","nuc/utils/deepClone/deepClone"],function(e,t,n,i,o,s,r){"use strict";function c(e,i){var o=n.Deferred();return csui.require(["nuc/models/node.actions"],function(){h=arguments[0];var n=u(e,i),s=l(e,i);i=t.defaults({"parse":!1},i),e.syncFromMultipleSources([n,s],a,i).then(o.resolve,o.reject)},o.reject),o.promise()}function a(e,t){return e.actions=t,e}function u(e,n){var i=e.clone();i.separateCommands=!1;var o=n.collection||e.collection;if(i.isCollectionV2ParameterSource(o)){var s=i.getResourceScopeFrom(o);i.setResourceScope(s)}return i.resetCommands(),i.resetDefaultActionCommands(),i.invalidateFetch(),i.fetch(t.pick(n,"headers","parse","silent")).then(function(){return i.attributes})}function l(e,t){var n=new h(void 0,{"connector":e.connector,"nodes":[e.get("id")],"commands":t.urlQueryWithActionsOnly.actions,"reference_id":t.urlQueryWithActionsOnly.reference_id});return n.fetch().then(function(){return n.reduce(function(e,t){var n=t.actions.toJSON();return e.concat(n)},[])})}function d(e,n){var i=n.url;i&&t.isString(i)?n.url=i.replace(/\?.*$/,""):n.url=e.urlBase()}var h,f={"mixin":function(e){var a=e.sync;return r.mixin(e),t.extend(e,{"makeServerAdaptor":function(e){return this.fetchExactFields=e&&e.fetchExactFields,this},"isFetchableDirectly":function(){return this.get("id")>0},"urlCacheBase":function(){var e=this.urlBase();return e.indexOf("/volumes")<0&&(e=e.replace("/api/v1/","/api/v2/")),e+"?"},"urlBase":function(){var e=this.get("id"),n=this.connector.connection.url;if(e)if("volume"===e)n=i.combine(n,"volumes",this.get("type"));else{if(t.isNumber(e)&&!(e>0))throw new Error("Unsupported id value");n=i.combine(n,"nodes",e)}else n=i.combine(n,"nodes");return this.options.apiVersion&&n.getApiBase(this.options.apiVersion),n},"url":function(){var e,t=this.urlBase();if(!this.isNew())if("volume"===this.get("id")){var o=s.expandsV2toV1(this.expand);o.length&&(e=n.param({"expand":o},!0))}else e=this.collection?this._getCombinedUrlQuery({"withActions":!0}):this._getNodeUrlQuery({"withActions":!0}),this.hasFields("properties")||this.fetchExactFields||(e=i.combineQueryString(e,"fields=properties"));return i.appendQuery(t,e)},"urlQueryWithoutActions":function(){var e;return e=this.collection?this._getCombinedUrlQuery({"withActions":!1}):this._getNodeUrlQuery({"withActions":!1}),this.hasFields("properties")||this.fetchExactFields||(e=e.concat({"fields":"properties"})),e},"urlQueryWithActionsOnly":function(){var e;if(this.collection){var t=this.getV2ParameterSource();e=this._getUrlQueryActionsFromSource(t)}else e=this.getRequestedCommandsUrlQuery();return e},"_getNodeUrlQuery":function(e){var t=i.combineQueryString(this.getResourceFieldsUrlQuery(),this.getExpandableResourcesUrlQuery(),this.getStateEnablingUrlQuery(),this.getAdditionalResourcesUrlQuery());return e.withActions&&(t=i.combineQueryString(t,this.getRequestedCommandsUrlQuery())),t},"_getCombinedUrlQuery":function(e){var t=this.getV2ParameterSource(),n=this._getUrlQueryWithoutActionsFromSource(t);if(e.withActions){var o=this._getUrlQueryActionsFromSource(t);n=n.concat(o)}return i.combineQueryString.apply(i,n)},"_getUrlQueryWithoutActionsFromSource":function(e){return["getExpandableResourcesUrlQuery","getAdditionalResourcesUrlQuery","getStateEnablingUrlQuery","getResourceFieldsUrlQuery"].map(function(n){var i=this[n]();return t.isEmpty(i)&&(n=e[n])?n.call(e):i},this)},"_getUrlQueryActionsFromSource":function(e){var n=this.delayRestCommands?"getRequestedCommandsUrlQuery":"getAllCommandsUrlQuery",i=this[n]();return t.isEmpty(i)&&(n=e.getAllCommandsUrlQuery||e.getRequestedCommandsUrlQuery)&&(i=n.call(e)),(this.refernce_id||this.attributes.reference_id)&&(i=t.extend({"reference_id":this.refernce_id||this.attributes.reference_id},i)),i},"sync":function(e,t,n){return"read"!==e&&d(this,n),"read"===e&&n.urlQueryWithActionsOnly?c(this,n):a.call(this,e,t,n)},"parse":function(e){var n=e.results||e,i=n.data,o=i&&(i.id||i.properties)&&i,s=o&&o.properties||o||e;if(void 0!==e.type&&(s.type=e.type),void 0!==e.type_name&&(s.type_name=e.type_name),o&&o.versions&&(s.versions=o.versions),t.extend(s,e.type_info),s.versions){var r=s.versions;t.isArray(r)&&(r=r[r.length-1]),r&&t.extend(s,t.pick(r,["file_size","mime_type","version_id","version_number","version_number_major","version_number_minor"]))}t.defaults(s,{"perspective":n&&n.perspective||e.perspective}),this.parseState(s,n),this._parseActions(s,n,e);var c=s.original_id&&s.original_id.id?s.original_id:s.original_id_expand;c&&this._parseActions(c,{},{});var a=s.parent_id&&s.parent_id.id?s.parent_id:s.parent_id_expand;if(a&&(this._parseActions(a,{},{}),a.actions.length||this._makeAccessible(a)),140===s.type&&!s.url){var u=t.findWhere(s.actions,{"signature":"default"});s.url=u&&u.href}s.addable_types=e.addable_types;var l=o&&o.columns;l&&(s.columns=this._parseColumns(l,e));var d=e.definitions||n.metadata&&n.metadata.properties;return d&&(s.definitions=this._parseDefinitions(d,l)),o&&o.properties&&(s.data=t.omit(o,"columns","metadata","properties")),this.collection&&this.collection.node&&298===this.collection.node.get("type")&&(s.reference_id=this.collection.node.get("id")),void 0===this.get("csuiLazyActionsRetrieved")&&this.get("csuiDelayedActionsRetrieved")&&!t.isEmpty(this.changed)&&(s.csuiLazyActionsRetrieved=!0),s},"_parseColumns":function(e,n){var i=n.definitions_order||e&&t.pluck(e,"key");return t.map(i,function(e){return{"key":e}})},"_parseDefinitions":function(e,i){return e.size||!e.container_size&&!e.file_size||(e.size=e.container_size||e.file_size,e.size.key="size",e.size.name=o.sizeColumnTitle),i&&(t.each(i,function(i){var o=i.key,s=e[o];s||(s=e[o]=t.omit(i,"data_type"),s.type=i.data_type);var r=["user","group","member"];-1!==n.inArray(s.persona,r)&&(s.type=14),s.sort=!!i.sort_key}),t.each(i,function(n){var i=n.key;if(i.lastIndexOf("_formatted")>=0){var o=i.substr(0,i.length-10),s=e[o];s||(s=e[o]=t.omit(n,"data_type"),s.type=s.data_type),s.sort=!!n.sort_key}})),t.map(e,function(e,t){return e.key||(e.key=t),e})},"_parseActions":function(e,n,i){var o,s=e.actions||i.actions||i.available_actions;t.isArray(s)?(t.each(s,function(e){e.signature||(e.signature=e.type,e.name=e.type_name,delete e.type,delete e.type_name)}),o=t.reduce(s,function(e,t){return e[t.signature]={},e},{}),e.actions=s):(o=e.commands||i.commands||i.actions||n&&n.actions||{},o.data&&o.order&&o.map&&(o=o.data),e.actions=t.chain(o).keys().map(function(e){var t=o[e];return t.signature=e,t}).value(),delete e.commands,delete e.commands_map,delete e.commands_order)},"_makeAccessible":function(e){e.actions=[{"signature":"open"}]}})}};return f}),csui.define("nuc/models/node/node.model",["module","nuc/lib/underscore","nuc/lib/backbone","nuc/models/actions","nuc/models/addabletypes","nuc/models/mixins/resource/resource.mixin","nuc/models/mixins/uploadable/uploadable.mixin","nuc/models/mixins/v2.fields/v2.fields.mixin","nuc/models/mixins/v2.expandable/v2.expandable.mixin","nuc/models/mixins/state.carrier/state.carrier.mixin","nuc/models/mixins/v2.delayed.commandable/v2.delayed.commandable.mixin","nuc/models/mixins/v2.additional.resources/v2.additional.resources.mixin","nuc/models/node.columns2","nuc/models/node/server.adaptor.mixin","nuc/models/utils/v1tov2","nuc/utils/deepClone/deepClone"],function(e,t,n,i,o,s,r,c,a,u,l,d,h,f,m){"use strict";function p(e,n){if(e.separateCommands&&!e.delayRestCommands&&e.urlQueryWithActionsOnly&&"volume"!==e.get("id")){var i=t.result(e,"urlQueryWithActionsOnly");if(i&&i.actions.length>g.separateCommandsThreshold)return void(n.urlQueryWithActionsOnly=i)}var o=t.result(e,"url");o.indexOf("/volumes")<0&&(o=o.replace("/api/v1/","/api/v2/")),n.url=o}var g=t.extend({"idAttribute":null,"usesIntegerId":!0,"separateCommands":!1,"separateCommandsThreshold":10},e.config()),b=n.Collection.extend({"model":n.Model.extend({"id":"key","constructor":function(e,t){n.Model.prototype.constructor.call(this,e,t)}}),"constructor":function(e,t){n.Collection.prototype.constructor.call(this,e,t)}}),v=n.Model.extend({"idAttribute":g.idAttribute,"constructor":function(e,s){e||(e={}),s||(s={}),n.Model.prototype.constructor.call(this,e,s),this.options=t.pick(s,["connector"]),this.makeResource(s).makeAdditionalResourcesV2Mixin(s).makeFieldsV2(s).makeExpandableV2(s).makeStateCarrier(s,e).makeDelayedCommandableV2(s).makeUploadable(s).makeServerAdaptor(s);var r=s.separateCommands;this.separateCommands=void 0!==r?r:g.separateCommands,this.setState(e),e.actions||this._setCollectionProperty("actions",i,e,s),e.addable_types||this._setCollectionProperty("addable_types",o,e,s),e.definitions||this._setCollectionProperty("definitions",b,e,s),e.columns||this._setCollectionProperty("columns",h,e,s)},"clone":function(){var e=new this.constructor(this.attributes,{"connector":this.connector,"fields":t.deepClone(this.fields),"expand":t.deepClone(this.expand),"stateEnabled":this.stateEnabled,"includeResources":t.clone(this._additionalResources),"commands":t.clone(this.commands),"defaultActionCommands":t.clone(this.defaultActionCommands),"delayRestCommands":this.delayRestCommands,"separateCommands":this.separateCommands});return e.actions.reset(this.actions.toJSON()),e.fetched=this.fetched,e.error=this.error,e.state.set(this.state.toJSON()),e},"isNew":function(){return!this.has("id")},"isCollectionV2ParameterSource":function(e){return e&&e.makeFieldsV2},"getV2ParameterSource":function(){var e=this.collection;if(this.isCollectionV2ParameterSource(e))return e;var t=this.clone();if(e){var n=e._additionalResources;n&&t.includeResources(n);var i=e.defaultActionCommands;i&&t.setDefaultActionCommands(i);var o=e.includeCommands;o&&t.setCommands(o);var s=e.expand;s&&t.setExpand(m.includeExpandsV1toV2(s))}return t},"set":function(e,t,s){var r;return null==e?this:("object"==typeof e?(r=e,s=t):(r={})[e]=t,s||(s={}),this.setState(r),t&&t.skipSetValue?void 0:(r.actions&&this._setCollectionProperty("actions",i,r,s),r.addable_types&&this._setCollectionProperty("addable_types",o,r,s),r.definitions&&this._setCollectionProperty("definitions",b,r,s),r.columns&&this._setCollectionProperty("columns",h,r,s),void 0!==r.original_id&&this._setNodeProperty("original",r,s),void 0!==r.parent_id&&this._setNodeProperty("parent",r,s),void 0!==r.volume_id&&this._setNodeProperty("volume",r,s),n.Model.prototype.set.call(this,r,s)))},"triggerAllChanges":function(){function e(e){e&&e.trigger("reset",e)}function t(e){if(e){var t=e.attributes;Object.keys(t).forEach(function(n){e.trigger("change:"+n,e,t[n])}),e.trigger("change",e)}}e(this.actions),e(this.addableTypes),e(this.definitions),e(this.columns),t(this.original),t(this.parent),t(this.volume),t(this)},"_setCollectionProperty":function(e,n,i,o){var s=t.str.camelize(e),r=i[e],c=this[s];c?c.reset(r,{"silent":o&&o.silent}):this[s]=new n(r,{"connector":this.connector||o&&o.connector})},"_setNodeProperty":function(e,n,i){var o=n[e+"_id_expand"]||n[e+"_id"];o&&!t.isObject(o)&&(o={"id":o}),t.isObject(o)?this[e]?this[e].set(o,{"silent":i&&i.silent}):this[e]=new v(o,{"connector":this.connector||i&&i.connector}):delete this[e]},"getResourceScope":function(){var e=this.getV2ParameterSource();return t.deepClone({"fields":t.isEmpty(this.fields)?e.fields:this.fields,"expand":t.isEmpty(this.expand)?e.expand:this.expand,"includeResources":t.isEmpty(this._additionalResources)?e._additionalResources:this._additionalResources,"commands":t.isEmpty(this.commands)?e.commands:this.commands,"defaultActionCommands":this.defaultActionCommands})},"getResourceScopeFrom":function(e){return t.deepClone({"fields":e.fields,"expand":e.expand,"includeResources":e._additionalResources,"commands":e.commands,"defaultActionCommands":e.defaultActionCommands})},"setResourceScope":function(e){this.excludeResources(),e.includeResources&&this.includeResources(e.includeResources),this.resetFields(),e.fields&&this.setFields(e.fields),this.resetExpand(),e.expand&&this.setExpand(e.expand),this.resetCommands(),e.commands&&this.setCommands(e.commands),this.resetDefaultActionCommands(),e.defaultActionCommands&&this.setDefaultActionCommands(e.defaultActionCommands)},"toString":function(){var e=this.get("id");return"volume"===e?"volume:"+this.get("type"):null!=e?"node:"+e:"node:invalid"}},{"usesIntegerId":g.usesIntegerId});d.mixin(v.prototype),c.mixin(v.prototype),a.mixin(v.prototype),u.mixin(v.prototype),l.mixin(v.prototype),r.mixin(v.prototype),s.mixin(v.prototype),f.mixin(v.prototype),v.prototype.isFetchable=function(){if(v.usesIntegerId){var e=this.get("id");return e>0||"volume"===e}return!!this.get("id")};var y=v.prototype.fetch;return v.prototype.fetch=function(e){if(e||(e={}),!e.url){var t=this.collection,n=e.collection;n&&(this.collection=n),p(this,e),n&&(this.collection=t)}return y.call(this,e)},v}),csui.define("nuc/models/mixins/node.connectable/node.connectable.mixin",["nuc/lib/underscore"],function(e){"use strict";return{"mixin":function(t){var n=t._prepareModel;return e.extend(t,{"makeNodeConnectable":function(e){return e&&e.node&&(this.node=e.node,e.node.connector&&e.node.connector.assignTo(this)),this},"_prepareModel":function(e,t){t||(t={});var i=t.node||this.node;return t.connector=i&&i.connector,n.call(this,e,t)}})}}}),csui.define("nuc/models/mixins/node.autofetchable/node.autofetchable.mixin",["nuc/lib/underscore"],function(e){"use strict";return{"mixin":function(t){return e.extend(t,{"makeNodeAutoFetchable":function(e){e&&e.autofetchEvent&&(this._autofetchEvent=e.autofetchEvent);var t=e&&e.autofetch;return t&&this.automateFetch(t),this},"automateFetch":function(t){var n=e.result(this,"_autofetchEvent"),i=t?"on":"off";this.autofetch=!!t,this.node[i](n,e.bind(this._fetchAutomatically,this,t))},"isFetchable":function(){return this.node.isFetchableDirectly()},"_autofetchEvent":"change:id","_fetchAutomatically":function(t){this.isFetchable()&&this.fetch(e.isObject(t)&&t)}})}}}),csui.define("nuc/models/mixins/node.resource/node.resource.mixin",["nuc/lib/underscore","nuc/models/mixins/node.connectable/node.connectable.mixin","nuc/models/mixins/fetchable/fetchable.mixin","nuc/models/mixins/node.autofetchable/node.autofetchable.mixin"],function(e,t,n,i){return{"mixin":function(o){return t.mixin(o),n.mixin(o),i.mixin(o),e.extend(o,{"makeNodeResource":function(e){return this.makeNodeConnectable(e).makeFetchable(e).makeNodeAutoFetchable(e)}})}}}),csui.define("nuc/models/node.addable.type/server.adaptor.mixin",["nuc/lib/underscore","nuc/utils/url"],function(e,t){"use strict";return{"mixin":function(n){return e.extend(n,{"makeServerAdaptor":function(e){return this},"url":function(){return t.combine(this.node.urlBase(),"addablenodetypes")},"parse":function(t,n){var i=t.data,o=t.definitions;return e.chain(i).keys().map(function(e){var t=i[e],n=o[e];if(t&&n){var s=t&&/[?&]type=([^&]+)(?:&.*)?$/.exec(t);if(s){return{"type":parseInt(s[1],10),"type_name":n.name}}}}).compact().value()}})}}}),csui.define("nuc/models/node/node.addable.type.collection",["nuc/lib/underscore","nuc/lib/backbone","nuc/utils/url","nuc/models/node/node.model","nuc/models/mixins/node.resource/node.resource.mixin","nuc/models/node.addable.type/server.adaptor.mixin"],function(e,t,n,i,o,s){"use strict";var r=t.Model.extend({"defaults":{"type":null,"type_name":null},"idAttribute":"type","constructor":function(){t.Model.prototype.constructor.apply(this,arguments)}}),c=t.Collection.extend({"model":r,"constructor":function e(t,n){e.__super__.constructor.apply(this,arguments),this.makeNodeResource(n).makeServerAdaptor(n)},"clone":function(){return new this.constructor(this.models,{"node":this.node})},"isFetchable":function(){return this.node.isFetchable()}});return o.mixin(c.prototype),s.mixin(c.prototype),c}),csui.define("nuc/models/browsable/v2.response.mixin",["nuc/lib/underscore"],function(e){"use strict";return{"mixin":function(t){return e.extend(t,{"makeBrowsableV2Response":function(e){return this.orderBy=e.orderBy,this},"parseBrowsedState":function(t,n){var i=t.collection||t,o=i.paging,s=i.sorting,r=i.searching;if(o?(this.actualSkipCount=(o.page-1)*(o.limit||0),this.totalCount=o.total_count,this.filteredCount=o.filtered_count||o.total_count):(this.actualSkipCount=0,this.filteredCount=this.totalCount=t.results.length),this.sortingColumnKey=void 0,s&&(this.sorting=s,o.columns)){var c,a=s.sort[0].value,u=a.indexOf("_"),l=a.substring(u+1);e.each(o.columns,function(e){e.sort_key===l&&(c=e)}),c&&(this.sortingColumnKey=c.key)}r&&(this.searching=r)},"parseBrowsedItems":function(e,t){return e.results}})}}}),csui.define("nuc/models/mixins/appcontainer/appcontainer.mixin",["nuc/lib/underscore"],function(e){"use strict";return{"mixin":function(t){return e.extend(t,{"makeAppContainer":function(e){return this},"massageResponse":function(t){return e.map(["original","create_user","owner_user","reserved_user","modify_user","parent"],function(e){var n=e+"_id",i=n+"_expand";t[i]&&(t[i].id=t[n])}),t.reserved=!!t.reserved_user_id,t.parent_id&&!t.parent_id_expand&&(t.parent_id_expand={"id":this.node.get("id"),"type":this.node.get("type"),"name":this.node.get("name"),"openable":this.node.get("openable")}),t.parent_id_expand&&(t.parent_id_expand.container=!0,t.parent_id_expand.mime_type=t.parent_id_expand.mime_type||null),t}})}}}),csui.define("nuc/models/node.children2/server.adaptor.mixin",["nuc/lib/underscore","nuc/utils/url","nuc/models/browsable/v1.request.mixin","nuc/models/browsable/v2.response.mixin","nuc/models/mixins/appcontainer/appcontainer.mixin"],function(e,t,n,i,o){"use strict";return{"mixin":function(s){return i.mixin(s),n.mixin(s),o.mixin(s),e.extend(s,{"makeServerAdaptor":function(e){return this.useSpecialPaging=e.useSpecialPaging,this.makeBrowsableV1Request(e).makeBrowsableV2Response(e).makeAppContainer(e),this},"url":function(){var n,i,o=new t(this.node.connector.connection.url).getApiBase(2);if(this.useSpecialPaging){n=t.combine(o,"app/container",this.node.get("id"),"page");var s={"fields":e.without(this.getResourceFieldsUrlQuery().fields,"properties")};i=t.combineQueryString(this.getBrowsableUrlQuery(),s)}else n=t.combine(o,"nodes",this.node.get("id"),"nodes"),i=t.combineQueryString(this.getBrowsableUrlQuery(),this.getResourceFieldsUrlQuery(),this.getExpandableResourcesUrlQuery(),this.getStateEnablingUrlQuery(),this.getAdditionalResourcesUrlQuery(),this.getRequestedCommandsUrlQuery());return t.appendQuery(n,i)},"parse":function(e,t){if(this.useSpecialPaging){var n=this;e.results=e.results.map(function(e){return n.massageResponse(e)})}return this.parseBrowsedState(e,t),this.parseBrowsedItems(e,t)}})}}}),csui.define("nuc/models/node.children2/node.children2",["module","nuc/lib/underscore","nuc/lib/backbone","nuc/models/node/node.model","nuc/models/mixins/node.resource/node.resource.mixin","nuc/models/browsable/browsable.mixin","nuc/models/mixins/v2.additional.resources/v2.additional.resources.mixin","nuc/models/mixins/v2.fields/v2.fields.mixin","nuc/models/mixins/v2.expandable/v2.expandable.mixin","nuc/models/mixins/state.requestor/state.requestor.mixin","nuc/models/mixins/v2.delayed.commandable/v2.delayed.commandable.mixin","nuc/models/node.children2/server.adaptor.mixin","nuc/models/utils/v1tov2","nuc/utils/deepClone/deepClone"],function(e,t,n,i,o,s,r,c,a,u,l,d,h){"use strict";var f=e.config();t.defaults(f,{"defaultPageSize":30});var m=n.Collection.extend({"model":i,"constructor":function(e,i){i=t.defaults({},i,{"top":f.defaultPageSize},i),n.Collection.prototype.constructor.call(this,e,i),this.makeNodeResource(i).makeBrowsable(i).makeAdditionalResourcesV2Mixin(i).makeFieldsV2(i).makeExpandableV2(i).makeStateRequestor(i).makeDelayedCommandableV2(i).makeServerAdaptor(i)},"clone":function(){var e=new this.constructor(this.models,{"node":this.node,"skip":this.skipCount,"top":this.topCount,"filter":t.deepClone(this.filters),"orderBy":this.orderBy,"fields":t.deepClone(this.fields),"expand":t.deepClone(this.expand),"includeResources":t.clone(this._additionalResources),"commands":t.clone(this.commands),"defaultActionCommands":t.clone(this.defaultActionCommands),"delayRestCommands":this.delayRestCommands,"autofetch":this.autofetch,"autofetchEvent":this._autofetchEvent,"autoreset":this.autoreset,"useSpecialPaging":this.useSpecialPaging});return e.fetched=this.fetched,e.error=this.error,e.actualSkipCount=this.actualSkipCount,e.totalCount=this.totalCount,e.filteredCount=this.filteredCount,e},"isFetchable":function(){return this.node.isFetchable()},"getResourceScope":function(){return t.deepClone({"fields":this.fields,"expand":this.expand,"includeResources":this._additionalResources,"commands":this.commands,"defaultActionCommands":this.defaultActionCommands})},"setResourceScope":function(e){this.excludeResources(),e.includeResources&&this.includeResources(e.includeResources),this.resetFields(),e.fields&&this.setFields(e.fields),this.resetExpand(),e.expand&&this.setExpand(e.expand),this.resetCommands(),e.commands&&this.setCommands(e.commands),this.resetDefaultActionCommands(),e.defaultActionCommands&&this.setDefaultActionCommands(e.defaultActionCommands)}});s.mixin(m.prototype),r.mixin(m.prototype),c.mixin(m.prototype),a.mixin(m.prototype),u.mixin(m.prototype),l.mixin(m.prototype),o.mixin(m.prototype),d.mixin(m.prototype);var p=m.prototype,g=p.makeExpandableV2,b=p.setExpand,v=p.resetExpand;p.makeExpandableV2=function(e){var t=e&&e.expand;return Array.isArray(t)&&(e.expand=h.includeExpandsV1toV2(t)),g.call(this,e)},p.setExpand=function(e,t){return t||(e=h.includeExpandsV1toV2(e)),b.call(this,e,t)},p.resetExpand=function(e,t){return t||(e=h.excludeExpandsV1toV2(e)),v.call(this,e,t)};var y=p.makeCommandableV2;return p.makeCommandableV2=function(e){return y.call(this,e),this.includeCommands=this.commands,this},m}),csui.define("nuc/models/node.ancestors/server.adaptor.mixin",["nuc/lib/underscore","nuc/models/ancestor","nuc/utils/url"],function(e,t,n){"use strict";return{"mixin":function(i){return e.extend(i,{"makeServerAdaptor":function(e){return this},"url":function(){return n.combine(this.node.urlBase(),"ancestors")},"parse":function(n,i){if(n=n.ancestors,this.options.stop){var o,s=this.options.stop.get?this.options.stop.get("id"):this.options.stop.id;n=e.filter(n.reverse(),function(e){var t=!o;return e.id==s&&(o=!0),t}).reverse()}return this.options.limit&&n.length>this.options.limit&&(n.splice(0,n.length-this.options.limit),n.unshift({"type":t.Hidden})),e.each(n,function(e){e.container=!0}),n}})}}}),csui.define("nuc/models/nodeancestors",["module","nuc/lib/underscore","nuc/lib/jquery","nuc/lib/backbone","nuc/utils/url","nuc/utils/log","nuc/models/ancestor","nuc/models/ancestors","nuc/models/mixins/node.resource/node.resource.mixin","nuc/models/node.ancestors/server.adaptor.mixin"],function(e,t,n,i,o,s,r,c,a,u){"use strict";var l=c.extend({"constructor":function(e,t){c.prototype.constructor.apply(this,arguments),this.makeNodeResource(t).makeServerAdaptor(t)},"clone":function(){return new this.constructor(this.attributes,{"connector":this.connector})},"isFetchable":function(){return this.node.isFetchable()}});return a.mixin(l.prototype),u.mixin(l.prototype),l}),csui.define("nuc/models/impl/nls/lang",{"root":!0,"en-us":!1,"en":!1}),csui.define("nuc/models/impl/nls/root/lang",{"name":"Name","type":"Type","version":"Version","state":"State","favorite":"Favorite","toggleDetails":"Toggle Details","parentID":"Parent ID"}),csui.define("nuc/models/nodechildrencolumn",["module","nuc/lib/backbone","nuc/utils/log","i18n!nuc/models/impl/nls/lang"],function(e,t,n,i){"use strict";return t.Model.extend({"constructor":function(e,n){if(e&&!e.title){var o=i[e.column_key];void 0!==o&&(e.title=o)}t.Model.prototype.constructor.call(this,e,n)},"idAttribute":null})}),csui.define("nuc/models/nodechildrencolumns",["module","nuc/lib/underscore","nuc/lib/backbone","nuc/utils/log","nuc/models/nodechildrencolumn"],function(e,t,n,i,o){"use strict";var s=n.Collection.extend({"model":o,"constructor":function(e,t){n.Collection.prototype.constructor.apply(this,arguments),this.fetched=!1},"resetCollection":function(e,n){this.cachedColumns&&t.isEqual(e,this.cachedColumns)||(this.cachedColumns=t.map(e,function(e){return t.clone(e)}),this.reset(e,n),this.fetched=!0)},"getColumnModels":function(e,n){return t.reduce(e,function(e,i){if(i.indexOf("_formatted")>=0){var o=i.replace(/_formatted$/,"");if(n[o])return e}else{var s=n[i];if(s&&!s.definitions_order){var r=n[i+"_formatted"];r&&r.definitions_order&&(s.definitions_order=r.definitions_order)}}var c=n[i];switch(i){case"name":c=t.extend(c,{"default_action":!0,"contextual_menu":!1,"editable":!0,"filter_key":"name"});break;case"type":c=t.extend(c,{"default_action":!0});break;case"modify_date":c=t.extend(c,{"initialSortingDescending":!0})}return e.push(t.extend({"column_key":i},c)),e},[])},"resetColumns":function(e,t){this.resetCollection(this.getV1Columns(e,t),t)},"getV1Columns":function(e,n){var i=e.definitions,o=n&&n.columnsFromDefinitionsOrder?e.definitions_order:t.keys(i);if(e.definitions_order)for(var s=0;s<e.definitions_order.length;s++){var r=e.definitions_order[s],c=i[r];c&&(c.definitions_order=500+s)}return this.getColumnModels(o,i)},"resetColumnsV2":function(e,t){this.resetCollection(this.getV2Columns(e),t)},"getV2Columns":function(e){var n=e.results&&e.results[0]&&e.results[0].metadata&&e.results[0].metadata.properties||{};!n.size&&(n.container_size||n.versions&&n.versions.file_size)&&(n.size=n.container_size||n.versions.file_size,n.size.align="right",n.size.key="size",n.size.name="Size");var i=t.keys(n);return this.getColumnModels(i,n)}});return s.version="1.0",s}),csui.define("nuc/models/nodes",["module","nuc/lib/backbone","nuc/models/node/node.model","nuc/utils/log","nuc/models/mixins/v2.delayed.commandable/v2.delayed.commandable.mixin"],function(e,t,n,i,o){var s=t.Collection.extend({"model":n,"constructor":function(e,n){n||(n={}),t.Collection.prototype.constructor.apply(this,arguments),this.makeDelayedCommandableV2(n)},"automateFetch":function(e){}});return o.mixin(s.prototype),s.version="1.0",s}),csui.define("nuc/models/mixins/commandable/commandable.mixin",["nuc/lib/underscore"],function(e){"use strict";return{"mixin":function(t){return e.extend(t,{"makeCommandable":function(e){var t=e&&e.commands;return"string"==typeof t&&(t=t.split(",")),this.includeCommands=t||[],this},"setCommands":function(t){e.isArray(t)||(t=t.split(",")),e.each(t,function(t){e.contains(this.includeCommands,t)||this.includeCommands.push(t)},this)},"resetCommands":function(t){t?(e.isArray(t)||(t=t.split(",")),e.each(t,function(t){var n=e.indexOf(this.includeCommands,t);n>=0&&this.includeCommands.splice(n,1)},this)):this.includeCommands.splice(0,this.includeCommands.length)},"getRequestedCommandsUrlQuery":function(){return this.includeCommands.length&&{"commands":this.includeCommands}}})}}}),csui.define("nuc/models/mixins/delayed.commandable/delayed.commandable.mixin",["nuc/lib/underscore","nuc/lib/backbone","nuc/models/node.actions","nuc/models/mixins/commandable/commandable.mixin","nuc/utils/deepClone/deepClone"],function(e,t,n,i){"use strict";return{"mixin":function(o){i.mixin(o);var s=o._prepareModel;return e.extend(o,{"makeDelayedCommandable":function(e){e||(e={});var t=e.defaultActionCommands;return"string"==typeof t&&(t=t.split(",")),this.defaultActionCommands=t||[],this.delayedActions=new n(void 0,{"connector":e.connector}),this.delayRestCommands=e.delayRestCommands,this.delayRestCommands&&this.on("sync",this._requestRestActions),this.delayRestCommandsForModels=e.delayRestCommandsForModels,this.makeCommandable(e)},"_requestRestActions":function(n){if(!(n!==this||this instanceof t.Collection&&!this.length)){var i=this.defaultActionCommands,o=e.reject(this.includeCommands,function(t){return e.contains(i,t)});if(o.length){var s=this.delayedActions;s.resetCommands(),s.setCommands(o),s.resetNodes(),this instanceof t.Collection?s.setNodes(this.pluck("id")):s.setNodes([this.get("id")]),s.connector||this.connector.assignTo(s),s.parent_id=this.node?this.node.get("id"):this.get("id"),s.fetch({"reset":!0,"success":e.bind(this._updateOriginalActions,this)})}}},"_updateOriginalActions":function(){function e(e){var t=n.get(e.get("id"));t&&e.actions.add(t.actions.models)}var n=this.delayedActions;this instanceof t.Collection?this.each(e):e(this)},"setDefaultActionCommands":function(t){e.isArray(t)||(t=t.split(",")),e.each(t,function(t){e.contains(this.defaultActionCommands,t)||this.defaultActionCommands.push(t)},this)},"resetDefaultActionCommands":function(t){t?(e.isArray(t)||(t=t.split(",")),e.each(t,function(t){var n=e.indexOf(this.defaultActionCommands,t);n>=0&&this.defaultActionCommands.splice(n,1)},this)):this.defaultActionCommands.splice(0,this.defaultActionCommands.length)},"getRequestedCommandsUrlQuery":function(){var e=this.delayRestCommands?this.defaultActionCommands:this.includeCommands;return e.length&&{"commands":e}},"getAllCommandsUrlQuery":function(){var e=this.includeCommands;return e.length&&{"commands":e}},"_prepareModel":function(e,t){var n,i;t||(t={}),this.delayedActions?(n=t.delayRestCommands,void 0===n&&(n=this.delayRestCommands),void 0===(i=t.delayRestCommandsForModels)&&(i=this.delayRestCommandsForModels)):(n=t.delayRestCommands,i=t.delayRestCommandsForModels),t.delayRestCommands=i,t.delayRestCommandsForModels=!1;var o=s.call(this,e,t);return t.delayRestCommands=n,t.delayRestCommandsForModels=i,o}})}}}),csui.define("nuc/models/browsable/v1.response.mixin",["nuc/lib/underscore"],function(e){return{"mixin":function(t){return e.extend(t,{"makeBrowsableV1Response":function(e){return this},"parseBrowsedState":function(e,t){e.page&&(this.actualSkipCount=(e.page-1)*(e.limit||0));var n=e.total_count?e.total_count:0;this.totalCount=n,this.filteredCount=e.filtered_count||n},"parseBrowsedItems":function(e,t){return e.data}})}}}),csui.define("nuc/models/node.children/server.adaptor.mixin",["nuc/lib/underscore","nuc/utils/url","nuc/models/browsable/v1.request.mixin","nuc/models/browsable/v1.response.mixin"],function(e,t,n,i){"use strict";return{"mixin":function(o){return i.mixin(o),n.mixin(o),e.extend(o,{"makeServerAdaptor":function(e){return this.makeBrowsableV1Request(e).makeBrowsableV1Response(e),this},"url":function(){var e=!!this.includeActions,n=t.combineQueryString({"extra":e,"actions":e},this.getBrowsableUrlQuery(),this.getExpandableResourcesUrlQuery(),this.getRequestedCommandsUrlQuery());return t.combine(this.node.urlBase(),n?"/nodes?"+n:"/nodes")},"urlCacheBase":function(){return t.combine(this.node.urlBase(),"/nodes?")},"parse":function(e,t){return this.parseBrowsedState(e,t),
this.columns&&this.columns.resetColumns(e,this.options),this.parseBrowsedItems(e,t)}})}}}),csui.define("nuc/models/nodechildren",["module","nuc/lib/jquery","nuc/lib/underscore","nuc/lib/backbone","nuc/utils/url","nuc/models/node/node.model","nuc/models/nodes","nuc/models/nodechildrencolumns","nuc/models/mixins/node.resource/node.resource.mixin","nuc/models/mixins/expandable/expandable.mixin","nuc/models/browsable/browsable.mixin","nuc/models/mixins/delayed.commandable/delayed.commandable.mixin","nuc/models/node.children/server.adaptor.mixin","nuc/utils/log","nuc/utils/deepClone/deepClone"],function(e,t,n,i,o,s,r,c,a,u,l,d,h,f){"use strict";var m=e.config();n.defaults(m,{"defaultPageSize":30}),f=f(e.id);var p=r.extend({"constructor":function(e,t){t=n.defaults({},t,{"top":m.defaultPageSize,"columnsFromDefinitionsOrder":!1},t),r.prototype.constructor.call(this,e,t),this.makeNodeResource(t).makeExpandable(t).makeDelayedCommandable(t).makeBrowsable(t).makeServerAdaptor(t),this.options=t,this.includeActions=t.includeActions,this.columns=new c},"clone":function(){return new this.constructor(this.models,{"node":this.node,"skip":this.skipCount,"top":this.topCount,"filter":n.deepClone(this.filters),"orderBy":this.orderBy,"expand":n.clone(this.expand),"includeActions":this.includeActions,"commands":n.clone(this.includeCommands),"defaultActionCommands":n.clone(this.defaultActionCommands),"delayRestCommands":this.delayRestCommands})},"isFetchable":function(){return this.node.isFetchable()}});l.mixin(p.prototype),u.mixin(p.prototype),d.mixin(p.prototype),h.mixin(p.prototype),a.mixin(p.prototype);var g=p.prototype.fetch;return p.prototype.Fetchable={"fetch":function(e){return g.call(this,e)}},p}),csui.define("nuc/models/tool.item.config/tool.item.config.collection",["module","require","nuc/lib/underscore","nuc/lib/jquery","nuc/lib/backbone"],function(e,t,n,i,o){"use strict";var s=e.config().configs||[];return Array.isArray(s)||(s=Object.keys(s).reduce(function(e,t){return e.concat(s[t])},[])),s=s.map(function(e){return{"id":e}}),o.Collection.extend({"constructor":function(e,t){e||(e=s),o.Collection.prototype.constructor.call(this,e,t)},"sync":function(e,t,i){if("read"!==e)throw new Error("Only fetching tool item configurations is supported.");var o=this;return i=n.extend({},this.options,i),this._resolveConfigs(i).then(function(){var e=o.toJSON();i.success&&i.success(e,i),o.trigger("sync",o,e,i)})},"_resolveConfigs":function(e){var n=this.chain().filter(function(e){return e.has("id")&&!(e.has("config")||e.has("error"))}).pluck("id").value(),o=i.Deferred(),s=this;return n.length?t(n,function(){var e=arguments;n.forEach(function(t,n){s.get(t).set("config",e[n])}),o.resolve()},function(t){s.forEach(function(e){e.set("error",t)}),e.ignoreErrors?o.resolve():o.reject(t)}):o.resolve(),o.promise()}})}),csui.define("nuc/models/tool.item.mask/tool.item.mask.collection",["module","require","nuc/lib/underscore","nuc/lib/jquery","nuc/lib/backbone"],function(e,t,n,i,o){"use strict";var s=e.config().masks||[];return Array.isArray(s)||(s=Object.keys(s).reduce(function(e,t){return e.concat(s[t])},[])),s=s.map(function(e){return{"id":e}}),o.Collection.extend({"constructor":function(e,t){e||(e=s),o.Collection.prototype.constructor.call(this,e,t)},"sync":function(e,t,i){if("read"!==e)throw new Error("Only fetching tool item masks is supported.");var o=this;return i=n.extend({},this.options,i),this._resolveMasks(i).then(function(){var e=o.toJSON();i.success&&i.success(e,i),o.trigger("sync",o,e,i)})},"_resolveMasks":function(e){var n=this.chain().filter(function(e){return e.has("id")&&!(e.has("mask")||e.has("error"))}).pluck("id").value(),o=i.Deferred(),s=this;return n.length?t(n,function(){var e=arguments;n.forEach(function(t,n){s.get(t).set("mask",e[n])}),o.resolve()},function(t){s.forEach(function(e){e.set("error",t)}),e.ignoreErrors?o.resolve():o.reject(t)}):o.resolve(),o.promise()}})}),csui.define("nuc/models/browsable/client-side.mixin",["nuc/lib/underscore","nuc/lib/jquery","nuc/lib/backbone","nuc/utils/base","nuc/models/browsable/browsable.mixin"],function(e,t,n,i,o){return{"mixin":function(n){o.mixin(n);var s=n.fetch;return e.extend(n,{"makeClientSideBrowsable":function(e){return this.listenTo(this,"add",this._modelAdded).listenTo(this,"remove",this._modelRemoved).listenTo(this,"reset",this._modelsReset),this.allModels||(this.allModels=[]),this._filling=0,this.makeBrowsable(e)},"setOrderOnRequest":function(e){this.orderOnRequest=e},"getBrowsableUrlQuery":function(){var e={};if(this.orderBy&&this.orderOnRequest){var n=this.orderBy.split(",")[0].split(" ");e.sort=(n[1]||"asc")+"_"+n[0]}return t.param(e)},"fetch":function(n){n=n?e.clone(n):{},e.defaults(n,{"skipSort":this.orderOnRequest});var i,o=this;if(!n.reload&&void 0!==this.lastFilteredAndSortedModels){this.trigger("request",this,{},n);var r=t.Deferred();return setTimeout(function(){i=o._fill(n),o._notify(i,n),r.resolve(i)},0),r.promise()}var c=n.silent,a=n.reset;n.silent=!0,n.reset=!0;var u=n.success,l=n.error;return n.success=function(t,n,s){o.allModels=e.clone(o.models);var r=s.parse;s.parse=!1,o.reset([],s),void 0!==c?s.silent=c:delete s.silent,void 0!==a?s.reset=a:delete s.reset,i=o._fill(s),--o._filling,void 0!==r?s.parse=r:delete s.parse,s.success=u,u&&u.call(s.context,t,n,s)},n.error=function(e,t,n){--o._filling,l&&l.call(n.context,e,t,n)},++this._filling,this.lastFilteredAndSortedModels=void 0,this._lastFilterAndSortCriteria=void 0,s.call(this,n).then(function(){return i})},"populate":function(n,i){i=e.extend({"parse":!0},i);var o=i.silent,s=i.reset;i.silent=!0,i.reset=!0,i.skipSort=this.orderOnRequest,++this._filling,this.lastFilteredAndSortedModels=[],this._lastFilterAndSortCriteria=void 0,this.skipCount=0,this.filters={},this.orderBy=void 0,this.sorting&&!this.sorting.links&&(this.sorting=void 0),this.reset(n,i),this.allModels=e.clone(this.models);var r=i.parse;i.parse=!1,this.reset([],i),this.trigger("request",this,{},i),i.silent=o,0===this.allModels.length?i.reset=!0:i.reset=s;var c=t.Deferred(),a=this;return setTimeout(function(){a.fetched=!0;var e=a._fill(i);--a._filling,i.parse=r,a._notify(e,i),c.resolve(e)}),c.promise()},"setAllModels":function(t){var n={};n.parse=!1;var i=this.topCount;this.reset([],n),this.topCount=i,this.allModels=e.clone(t),this.totalCount=this.allModels.length,this.lastFilteredAndSortedModels=[],this._lastFilterAndSortCriteria=void 0,this.skipCount=0,this.filters={},this.orderBy=void 0,this.sorting&&!this.sorting.links&&(this.sorting=void 0)},"compareObjectsForSort":function(e,t,n){return t=this._parseValue(e,t.get(e)),n=this._parseValue(e,n.get(e)),this._compareValues(e,t,n)},"_fill":function(t){var n,i={"orderBy":this.orderBy,"filters":e.clone(this.filters)};if(this._lastFilterAndSortCriteria&&e.isEqual(this._lastFilterAndSortCriteria,i))n=this.lastFilteredAndSortedModels;else{if(n=e.clone(this.allModels),n=this._filter(n),this.sorting&&!this.sorting.links&&(this.sorting=void 0),!t.skipSort&&(n=this._sort(n),this.orderBy&&void 0===this.sorting)){var o=this.orderBy.split(" ");this.sorting={"sort":[]},this.sorting.sort.push({"key":"sort","value":(o[1]||"asc")+"_"+o[0]})}this.lastFilteredAndSortedModels=n,this._lastFilterAndSortCriteria=i}this.totalCount=this.allModels.length,this.filteredCount=n.length,n=this._limit(n);var s=t.reset;void 0===s&&(s=this.autoreset);var r=s?"reset":"set";return++this._filling,this[r](n,t),--this._filling,n},"_notify":function(e,t){t.success&&t.success.call(t.context,this,e,t),this.trigger("sync",this,e,t)},"_limit":function(e){return this.skipCount?(this.actualSkipCount=Math.min(this.skipCount,e.length),e=e.slice(this.skipCount)):this.actualSkipCount=0,this.topCount&&(e=e.slice(0,this.topCount)),e},"_sort":function(t){var n=this;if(this.orderBy){var i=e.map(this.orderBy.split(","),function(e){var t=e.trim().split(" ");return{"property":t[0],"descending":"desc"===t[1]}});t=t.sort(function(t,o){var s=0;return e.find(i,function(e){if(s=n.compareObjectsForSort(e.property,t,o))return e.descending&&(s*=-1),!0}),s})}return t},"_filter":function(t){var n=this;for(var i in this.filters)if(e.has(this.filters,i)){var o=this.filters[i];null!=o&&""!==o&&(e.isArray(o)||(o=[o]),t=e.filter(t,function(t){var s=n._parseValue(i,t.get(i));return e.any(o,function(e){var o=n._parseValue(i,e);return"type"===i&&-1==o?t.get("container"):n._containsValue(i,s,o)})}))}return t},"_modelAdded":function(e,t,n){this._populate(n)&&(this.allModels.push(e),++this.totalCount,this._lastFilterAndSortCriteria=void 0)},"_modelRemoved":function(t,n,i){if(this._populate(i)){var o=e.findIndex(this.allModels,t);o>=0&&(this.allModels.splice(o,1),--this.totalCount,this._lastFilterAndSortCriteria=void 0)}},"_modelsReset":function(t,n){this._populate(n)&&(this.allModels=e.clone(this.models),this.totalCount=this.allModels.length,this.lastFilteredAndSortedModels=[],this._lastFilterAndSortCriteria=void 0,this.skipCount=this.topCount=0,this.filters={},this.orderBy=void 0,this.sorting&&!this.sorting.links&&(this.sorting=void 0))},"_populate":function(e){return!(this._filling||e&&!1===e.populate)},"_compareValues":function(t,n,o){return"string"==typeof n&&"string"==typeof o?i.localeCompareString(n,o,{"usage":"sort"}):e.isArray(n)||e.isArray(o)?(e.isArray(n)?e.isArray(o)||(o=[o]):n=[n],this._compareArrays(n,o)):this._compareObjects(n,o)},"_compareObjects":function(e,t){if(e!=t){if(e>t||void 0===t)return 1;if(e<t||void 0===e)return-1}return 0},"_compareArrays":function(e,t){for(var n=0,o=Math.min(e.length,t.length),s=0;s<=o;){if(s===e.length&&s===t.length){n=0;break}if(s===e.length){n=-1;break}if(s===t.length){n=1;break}if(0!==(n="string"==typeof e[s]&&"string"==typeof t[s]?i.localeCompareString(e[s],t[s],{"usage":"sort"}):this._compareObjects(e[s],t[s])))break;s++}return n},"_containsValue":function(t,n,o){return"string"==typeof n&&"string"==typeof o?i.localeContainsString(n,o.toString()):e.isArray(n)&&"string"==typeof o?e.some(n,function(e){return"string"==typeof e?i.localeContainsString(e,o.toString()):e==o}):n==o},"_parseValue":function(t,n){if(null!=n){if("type"===t)return+n;if(t.indexOf("date")>=0)return e.isArray(n)?n.map(function(e){return new Date(e)}):new Date(n)}return n}})}}}),csui.define("nuc/models/autofetchable",["module","nuc/lib/underscore","nuc/utils/log"],function(e,t,n){"use strict";function i(e){var n={"makeAutoFetchable":function(e){return e&&e.autofetch&&this.automateFetch(e.autofetch),this},"automateFetch":function(e){this[e?"on":"off"](t.result(this,"_autofetchEvent"),t.bind(this._fetchAutomatically,this,e))},"isFetchable":function(){return!!this.get("id")},"_autofetchEvent":"change:id","_fetchAutomatically":function(e,n,i,o){if(this.isFetchable()){var s=t.extend({},e,o);this.fetch(s)}}};return n.AutoFetchable=t.clone(n),n}return n=n(e.id),i}),csui.define("nuc/models/connectable",["module","nuc/lib/underscore","nuc/utils/log"],function(e,t,n){"use strict";function i(e){var n={"makeConnectable":function(e){return e&&e.connector&&e.connector.assignTo(this),e&&e.connector&&this.original&&e.connector.assignTo(this.original),this},"_prepareModel":function(t,n){return n||(n={}),n.connector=this.connector,e.prototype._prepareModel.call(this,t,n)}};return n.Connectable=t.clone(n),n}return n=n(e.id),i}),csui.define("nuc/models/expandable",["module","nuc/lib/underscore","nuc/utils/log"],function(e,t,n){"use strict";function i(e){var n={"makeExpandable":function(e){var t=e&&e.expand;return"string"==typeof t&&(t=t.split(",")),this.expand=t||[],this},"setExpand":function(e){t.isArray(e)||(e=e.split(",")),t.each(e,function(e){t.contains(this.expand,e)||this.expand.push(e)},this)},"resetExpand":function(e){e?(t.isArray(e)||(e=e.split(",")),t.each(e,function(e){var n=t.indexOf(this.expand,e);n>=0&&this.expand.splice(n,1)},this)):this.expand=[]},"getExpandableResourcesUrlQuery":function(){return{"expand":this.expand}}};return n.Expandable=t.clone(n),n}return n=n(e.id),i}),csui.define("nuc/models/fetchable",["module","nuc/lib/underscore","nuc/lib/jquery","nuc/utils/log"],function(e,t,n,i){"use strict";function o(e){var o={"makeFetchable":function(e){return this.autoreset=e&&e.autoreset,this.on("reset",this._beforeFetchSucceeded,this).on("add",this._beforeFetchSucceeded,this).on("change",this._beforeFetchSucceeded,this)},"_beforeFetchSucceeded":function(){this.fetching&&this._fetchSucceeded()},"_fetchSucceeded":function(){this.fetching=!1,this.fetched=!0},"_fetchFailed":function(){this.fetching=!1},"fetch":function(t){if(this.fetching)i.debug("Fetching is in progress for {0} ({1}).",i.getObjectName(this),this.cid)&&console.log(i.last);else{this.fetched=!1,i.debug("Fetching is starting for {0} ({1}).",i.getObjectName(this),this.cid)&&console.log(i.last),t=this._prepareFetch(t);var n=this,o=t.success,s=t.error;t.success=function(){i.debug("Fetching succeeded for {0} ({1}).",i.getObjectName(n),n.cid)&&console.log(i.last),n._fetchSucceeded(),o&&o.apply(this,arguments)},t.error=function(){i.debug("Fetching failed for {0} ({1}).",i.getObjectName(n),n.cid)&&console.log(i.last),n._fetchFailed(),s&&s.apply(this,arguments)},this.fetching=e.prototype.fetch.call(this,t)}return this.fetching},"_prepareFetch":function(e){return e||(e={}),void 0===e.reset&&this.autoreset&&(e.reset=!0),e},"ensureFetched":function(e){return this.fetched?(i.debug("No need to fetch {0} ({1}).",i.getObjectName(this),this.cid)&&console.log(i.last),e&&e.success&&e.success(this),n.Deferred().resolve(this,{},e).promise()):this.fetch(e)}};return o.Fetchable=t.clone(o),o}return i=i(e.id),o}),csui.define("nuc/models/including.additional.resources",["module","nuc/lib/underscore","nuc/utils/log"],function(e,t,n){"use strict";function i(e){var n={"makeIncludingAdditionalResources":function(e){return this._additionalResources=[],e&&e.includeResources&&this.includeResources(e.includeResources),this},"includeResources":function(e){t.isArray(e)||(e=e.split(",")),this._additionalResources=t.union(this._additionalResources,e)},"excludeResources":function(e){e?(t.isArray(e)||(e=e.split(",")),this._additionalResources=t.reject(this._additionalResources,e)):this._additionalResources=[]},"getAdditionalResourcesUrlQuery":function(){return t.reduce(this._additionalResources,function(e,t){return e[t]="true",e},{})}};return n.IncludingAdditionalResources=t.clone(n),n}return n=n(e.id),i}),csui.define("nuc/models/nodeautofetchable",["module","nuc/lib/underscore","nuc/utils/log"],function(e,t,n){"use strict";function i(e){var n={"makeNodeAutoFetchable":function(e){return e&&e.autofetch&&this.automateFetch(e.autofetch),this},"automateFetch":function(e){this.node[e?"on":"off"](t.result(this,"_autofetchEvent"),t.bind(this._fetchAutomatically,this,e))},"isFetchable":function(){return this.node.isFetchableDirectly()},"_autofetchEvent":"change:id","_fetchAutomatically":function(e){this.isFetchable()&&this.fetch(t.isObject(e)&&e)}};return n.NodeAutoFetchable=t.clone(n),n}return n=n(e.id),i}),csui.define("nuc/models/nodeconnectable",["module","nuc/lib/underscore","nuc/utils/log"],function(e,t,n){"use strict";function i(e){var n={"makeNodeConnectable":function(e){return e&&e.node&&(this.node=e.node,e.node.connector&&e.node.connector.assignTo(this)),this},"_prepareModel":function(t,n){return n.connector=this.node&&this.node.connector,e.prototype._prepareModel.call(this,t,n)}};return n.NodeConnectable=t.clone(n),n}return n=n(e.id),i}),csui.define("nuc/models/noderesource",["module","nuc/lib/underscore","nuc/utils/log","nuc/models/nodeconnectable","nuc/models/fetchable","nuc/models/nodeautofetchable"],function(e,t,n,i,o,s){"use strict";function r(e){var n={"makeNodeResource":function(e){return this.makeNodeConnectable(e).makeFetchable(e).makeNodeAutoFetchable(e)}};return n.NodeResource=t.clone(n),t.extend({},i(e),o(e),s(e),n)}return n=n(e.id),r}),csui.define("nuc/models/resource",["module","nuc/lib/underscore","nuc/utils/log","nuc/models/connectable","nuc/models/fetchable","nuc/models/autofetchable"],function(e,t,n,i,o,s){"use strict";function r(e){var n={"makeResource":function(e){return this.makeConnectable(e).makeFetchable(e).makeAutoFetchable(e)}};return n.Resource=t.clone(n),t.extend({},i(e),o(e),s(e),n)}return n=n(e.id),r}),csui.define("nuc/models/uploadable",["module","nuc/lib/underscore","nuc/lib/jquery","nuc/lib/backbone","nuc/utils/log"],function(e,t,n,i,o){"use strict";function s(e){var s={"makeUploadable":function(e){return this},"sync":function(e,s,r){function c(){return(r.url||t.result(s,"url")).replace(/\?.*$/,"")}var a=r.data||r.attrs||this.attributes;if("create"===e){o.debug("Creating {0} ({1}).",o.getObjectName(this),this.cid)&&console.log(o.last);var u=new FormData;u.append("body",JSON.stringify(a)),t.each(t.keys(r.files||{}),function(e){var n,i=r.files[e];if(t.isArray(i)&&i.length>1)for(n=0;n<i.length;++n){var o=n?e+n:e;u.append(o,i[n])}else i&&u.append(e,i)}),t.extend(r,{"data":u,"contentType":!1,"url":c()})}else"update"!==e&&"patch"!==e||(o.debug("Updating {0} ({1}).",o.getObjectName(this),this.cid)&&console.log(o.last),e="update",a={"body":JSON.stringify(a)},t.extend(r,{"data":n.param(a),"contentType":"application/x-www-form-urlencoded","url":c()}));return i.sync(e,s,r)}};return s.Uploadable=t.clone(s),s}return o=o(e.id),s}),csui.define("nuc/utils/errors/request",[],function(){"use strict";function e(e){Error.prototype.constructor.call(this),this.message=e.error,this.details=e.errorDetail}function t(e){Error.prototype.constructor.call(this);var t=e.responseJSON||{},n=e.settings;this.statusCode=e.status,this.statusText=e.statusText,this.message=t.error||e.responseText,this.details=t.errorDetail,n&&(this.method=n.type,this.url=n.url)}return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e.prototype.name="ResponseError",t.prototype=Object.create(Error.prototype),t.constructor=t,t.prototype.name="ServerError",t}),csui.define("nuc/contexts/context",["module","nuc/lib/underscore","nuc/lib/jquery","nuc/lib/backbone","nuc/lib/marionette","nuc/utils/errors/request","nuc/utils/log"],function(e,t,n,i,o,s,r){"use strict";function c(e,t){return this._getFactory(e,t,!0).property}function a(e,t){return!!this._getFactory(e,t,!1)}r=r(e.id);var u=o.Controller.extend({"constructor":function(e){this.cid=t.uniqueId("context"),o.Controller.prototype.constructor.apply(this,arguments),this._factories={},t.each(this.options.factories,function(e,t){e.internal=!0})},"getModel":c,"getCollection":c,"getObject":c,"hasModel":a,"hasCollection":a,"hasObject":a,"getFactory":function(e,t){return this._getFactory(e,t,!0)},"clear":function(e){return r.info("Clearing {0} started.",this.cid)&&console.log(r.last),this.triggerMethod("before:clear",this),e&&e.all?this._destroyAllFactories():this._destroyNonPermanentFactories(),this.suppressFetch(),r.info("Clearing {0} succeeded.",this.cid)&&console.log(r.last),this.triggerMethod("clear",this),this},"isBusy":function(){return this.fetching},"fetch":function(e){if(e||(e={}),this.fetching)return r.debug("Fetching {0} continues.",this.cid)&&console.log(r.last),this.fetching;this.fetched=!1,this.error=null,r.info("Fetching {0} started.",this.cid)&&console.log(r.last),this.triggerMethod("request",this),this._destroyTemporaryFactories();var i=this,o=t.filter(this._factories,function(e){return i.isFetchable(e)}),c=t.chain(o).map(function(n){var o=e?t.clone(e):{};return i._synchronizeFetches?n.cloneAndFetch(o).then(function(){r.debug("Results of "+n.property.constructor.name+" arrived.")&&console.log(r.last)}):n.fetch(o)}).compact().value();r.can("DEBUG")&&t.each(o,function(e){r.debug("Waiting for fetch results of "+e.property.constructor.name)&&console.log(r.last)});var a=n.Deferred(),u=this.fetching=a.promise();return n.when.apply(n,c).then(function(){i.fetching===u?(i.fetching=null,i.fetched=!0,r.info("Fetching {0} succeeded.",i.cid)&&console.log(r.last),i._synchronizeFetches&&(i.triggerMethod("before:models:reset",i),t.each(o,function(e){e.copyFetchedResultsToOriginalProperty()})),i.triggerMethod("sync",i),a.resolve()):r.debug("Suppressed fetching {0} succeeded.",i.cid)&&console.log(r.last)},function(e){var t=new s(e);i.fetching===u?(i.fetching=null,i.error=t,r.error("Fetching {0} failed: {1}",i.cid,t)&&console.error(r.last),i.triggerMethod("error",t,i),a.reject(t)):r.debug("Suppressed fetching {0} failed: {1}.",i.cid,t.message)&&console.log(r.last)}),u},"isFetchable":function(e){return this._isFetchable(e)},"_isFetchable":function(e){return!e.options.detached&&(e.isFetchable?e.isFetchable():!!e.fetch)},"suppressFetch":function(){if(this.fetching)return r.debug("Suppressing the fetch in progress in {0}.",this.cid)&&console.log(r.last),this.fetching=null,this.fetched=!1,this.error=null,this.triggerMethod("sync",this),!0},"_destroyTemporaryFactories":function(){this._factories=t.pick(this._factories,function(e,t){if(!e.options.temporary)return!0;this._removeFactory(t)},this)},"_destroyNonPermanentFactories":function(){this._factories=t.pick(this._factories,function(e,t){if(e.options&&e.options.permanent)return!0;this._removeFactory(t)},this)},"_destroyAllFactories":function(){t.each(this._factories,function(e,t){this._removeFactory(t)},this),this._factories={}},"_getPropertyName":function(e,n){n||(n={});var i=n.attributes||{};return n.unique&&(i=t.extend({"stamp":t.uniqueId()},i)),t.reduce(i,function(e,t,n){return null==t?e:null!==e?e+"-"+n+"-"+t:n+"-"+t},e.prototype.propertyPrefix)},"_getFactory":function(e,n,o){if("string"==typeof e)return this._factories[e];n||(n={});var s,c,a,l=e.prototype.propertyPrefix,d=this.options.factories||{};n.internal?!(s=n[l])||s.internal||s instanceof i.Model||(c={"attributes":s.attributes,"unique":s.unique}):(s=n[l],void 0!==s||t.isEmpty(n)||(a=t.omit(n,"detached","permanent","temporary","unique"),t.isEmpty(a)||(n[l]=t.defaults(a,d[l]))),t.defaults(n,{"internal":!0},d),c={"attributes":n.attributes,"unique":n.unique},c.attributes||!s||s.internal||s instanceof i.Model||(c={"attributes":s.attributes,"unique":s.unique}));var h=this._getPropertyName(e,c),f=n.options;h=f&&f.factoryUID?h+f.factoryUID:h;var m=this._factories[h];if(!m&&o){n.factoryName=h,m=new e(this,n),this._factories[h]=m,r.debug("Adding factory {0} to {2}.",h,m.context.cid,this.cid)&&console.log(r.last),this.triggerMethod("add:factory",this,h,m);var p=m.property;p instanceof u&&this.listenTo(p,"add:factory",function(e,t,n){this.triggerMethod("add:factory",this,t,n)}).listenTo(p,"remove:factory",function(e,t,n){this.triggerMethod("remove:factory",this,t,n)})}return m},"_removeFactory":function(e){var t=this._factories[e],n=t.property;n instanceof u&&this.stopListening(n,"add:factory").stopListening(n,"remove:factory"),this.triggerMethod("remove:factory",this,e,t),t.destroy()},"onDestroy":function(){this.clear({"all":!0})}});return u}),csui.define("nuc/contexts/synchronized.context",["module","nuc/lib/underscore","nuc/lib/jquery","nuc/lib/backbone","nuc/lib/marionette","nuc/utils/errors/request","nuc/utils/log","nuc/contexts/context"],function(e,t,n,i,o,s,r,c){"use strict";return r=r(e.id),c.extend({"constructor":function(e,n,i){if(this.cid=t.uniqueId("synchronized.context"),c.prototype.constructor.apply(this,arguments),this._synchronizeFetches=!0,!e)throw new Error("Source context must be specified");t.each(n,function(n){var i=t.find(Object.keys(e._factories),function(t){return e._factories[t].property===n},this);if(!i)throw new Error("Source context does not have factory with specified property");var o=e._factories[i];if(!t.isFunction(o.cloneAndFetch))throw new Error("Factories for synchronized context must have clone.and.fetch.mixin applied. Factory "+o.constructor.name+" does not have it");this._factories[i]=o},this),i.triggerEventsOnSourceContext&&(this.listenTo(this,"request",function(){e.trigger("request")}),this.listenTo(this,"sync",function(){e.trigger("sync")}))},"_isFetchable":function(e){return e.isFetchable?e.isFetchable():!!e.fetch}})}),csui.define("nuc/contexts/context.plugin",["nuc/lib/underscore","nuc/lib/backbone"],function(e,t){"use strict";function n(t){this.cid=e.uniqueId("contextPlugin"),this.context=t.context}return e.extend(n.prototype,t.Events,{"isFetchable":function(e){}}),n.extend=t.Model.extend,n}),csui.define("nuc/contexts/fragment/context.fragment",["module","nuc/lib/underscore","nuc/lib/jquery","nuc/lib/marionette","nuc/contexts/context","nuc/utils/errors/request","nuc/utils/log"],function(e,t,n,i,o,s,r){"use strict";function c(e,t,n){r.debug("Collecting factory {0} from {1} to {2}.",t,n.context.cid,this.cid)&&console.log(r.last),this._items.push({"propertyName":t,"factory":n});var i=n.property;i instanceof o&&this._containers.add(i)}function a(e){var n=this;return t.chain(this._items).filter(function(e){var t=e.factory;return!t.options.temporary&&!n._containers.has(t.context)&&t.context.isFetchable(t)}).map(function(n){var i=e?t.clone(e):{};return n.factory.fetch(i)}).compact().value()}return r=r(e.id),i.Controller.extend({"constructor":function(e){this.cid=t.uniqueId("contextFragment"),i.Controller.prototype.constructor.call(this),this.context=e,this._items=[],this._containers=new Set,this.listenTo(e,"add:factory",c)},"fetch":function(e){if(this.fetching)return r.debug("Fetching {0} continues.",this.cid)&&console.log(r.last),this.fetching;this.fetched=!1,this.error=null,r.info("Fetching {0} started.",this.cid)&&console.log(r.last),this.triggerMethod("request",this),this.context.triggerMethod("request",this,this.context);var t=a.call(this,e),i=this;return this.fetching=n.when.apply(n,t).then(function(){i.fetching=null,i.fetched=!0,r.info("Fetching {0} succeeded.",i.cid)&&console.log(r.last),i.triggerMethod("sync",i),i.context.triggerMethod("sync",i.context)},function(e){var t=new s(e);return i.fetching=null,i.error=t,r.error("Fetching {0} failed: {1}",i.cid,t)&&console.error(r.last),i.triggerMethod("error",t,i),i.context.triggerMethod("error",t,i.context),n.Deferred().reject(t)}),this.fetching},"clear":function(){r.info("Clearing {0}.",this.cid)&&console.log(r.last),this.triggerMethod("before:clear",this),this._items=[],this._containers.clear(),this.triggerMethod("clear",this)}})}),csui.define("nuc/contexts/mixins/clone.and.fetch.mixin",["nuc/lib/underscore","nuc/lib/backbone"],function(e,t){"use strict";return{"mixin":function(n){return e.extend(n,{"makeCloneAndFetch":function(e){return this},"cloneAndFetch":function(e){return this.originalProperty=this.property,this.property=this.originalProperty.clone(),void 0!==this.originalProperty.autoreset&&void 0===this.property.autoreset&&(this.property.autoreset=this.originalProperty.autoreset),this.fetch(e)},"copyFetchedResultsToOriginalProperty":function(){if(this.originalProperty instanceof t.Collection){var n=["actualSkipCount","totalCount","filteredCount","skipCount","topCount","orderBy","filters","orderOnRequest","pagination"];e.each(n,function(e){void 0!==this.property[e]&&(this.originalProperty[e]=this.property[e])},this),this.originalProperty.reset(this.property.models)}else{if(!(this.originalProperty instanceof t.Model))throw new Error("Unsupported property");this.originalProperty.set(this.property.attributes)}this.property=this.originalProperty,delete this.originalProperty}})}}}),csui.define("nuc/contexts/page/page.context",["nuc/lib/underscore","nuc/contexts/context","csui-ext!nuc/contexts/page/page.context"],function(e,t,n){"use strict";return t.extend({"constructor":function(){t.prototype.constructor.apply(this,arguments);var i=e.chain(n).flatten(!0).unique().reverse().value();this._plugins=e.map(i,function(e){return new e({"context":this})},this)},"_isFetchable":function(n){return t.prototype._isFetchable.apply(this,arguments)&&e.all(this._plugins,function(e){return!1!==e.isFetchable(n)})}})}),csui.define("nuc/contexts/factories/factory",["nuc/lib/marionette"],function(e){return e.Controller.extend({"constructor":function(e,t){this.context=e,this.options=t||{}},"propertyPrefix":null})}),csui.define("nuc/utils/authenticators/authenticators",["nuc/lib/underscore","nuc/lib/backbone","nuc/models/mixins/rules.matching/rules.matching.mixin","csui-ext!nuc/utils/authenticators/authenticators"],function(e,t,n,i){"use strict";var o=t.Model.extend({"defaults":{"sequence":100,"authenticator":null},"constructor":function(e,n){t.Model.prototype.constructor.apply(this,arguments),this.makeRulesMatching(n)}});n.mixin(o.prototype);var s=t.Collection.extend({"model":o,"comparator":"sequence","constructor":function(e,n){t.Collection.prototype.constructor.call(this,e,n)},"findByConnection":function(e){var t=this.find(function(t){return t.matchRules(e,t.attributes)});return t&&t.get("authenticator")}}),r=new s;return i&&r.add(e.flatten(i,!0)),r}),csui.define("nuc/lib/jquery.ajax-progress",["module","nuc/lib/underscore","nuc/lib/jquery"],function(e,t,n){if("onprogress"in n.ajaxSettings.xhr()){var i=n.ajaxSettings.xhr;return n.ajaxSettings.xhr=function(){var e=i.apply(this,arguments);return this.progress&&(e instanceof window.XMLHttpRequest&&e.addEventListener("progress",this.progress,!1),e.upload&&e.upload.addEventListener("progress",this.progress,!1)),e},n}}),csui.define("nuc/utils/connector",["require","module","nuc/lib/jquery","nuc/lib/underscore","nuc/lib/backbone","nuc/utils/log","nuc/utils/base","nuc/utils/url","i18n","i18n!nuc/utils/impl/nls/lang","nuc/utils/authenticators/authenticators","nuc/models/mixins/uploadable/uploadable.mixin","nuc/lib/jquery.ajax-progress"],function(e,t,n,i,o,s,r,c,a,u,l,d){"use strict";function h(e){if(this.connection=e.connection,this.authenticator=e.authenticator,!this.authenticator){var t=l.findByConnection(this.connection);if(!t)throw new Error("No authenticator found. Load csui-extensions.json to enable built-in authenticators.");this.authenticator=new t}this.authenticator.connection=this.connection,this.authenticator.connectionTimeout=this.connectionTimeout,this.authenticationPending=!1,this.waitingRequests=[],this.restartRequests=[]}function f(e){if(e.connector){if(e.connector===this)return;throw new Error("Impossible to re-assign connector.")}return e.connector=this,m.call(this,e)}function m(e){var t=this,n=e.sync;return e.sync=function(e,o,s){function r(){T=!1;var r={"execute":n,"thisObj":o};t.extendAjaxOptions(s,r);var c=i.clone(s);i.extend(r,{"options":c,"deferred":s.deferred,"executeOptionsArray":[e,o,i.extend(c,{"restartRequest":!0})]});var a=s.deferred,u=n.call(o,e,o,s).progress(a.notify).done(a.resolve).fail(function(e,t,n){T||401===e.status||a.reject(e,t,n)});return g(a.promise(),u)}return b.call(t,r)},this}function p(){return new c(this.connection.url)}function g(e,t){return e.abort=function(){return t.abort&&t.abort(),this},e}function b(e){if(this.authenticator.isAuthenticated())return e();var t={"execute":e,"deferred":n.Deferred()};this.waitingRequests.push(t);var i=this;return S.call(this,function(){w.call(i)},function(e){A.call(i,e),F(e)}),t.deferred.promise()}function v(e,t){e.headers||(e.headers={}),i.extend(e.headers,this.connection.headers),i.extend(e.headers,{"Accept-Language":a.settings.locale}),this.authenticator.setAuthenticationHeaders(e.headers),e.timeout=this.connectionTimeout,e.deferred=n.Deferred();var o,c=this,l=e.beforeSend;e.beforeSend=function(t,n){e.request=t,t.settings=n,c.reportSending&&c.reportSending(t,n),l&&l(t,n),e.progress({"lengthComputable":!1,"beforeSend":!0})};var d=e.progress;e.progress=function(t){c.reportProgress&&c.reportProgress(t,e.request),d&&d(t),e.deferred.notify(t,e.request)};var h=e.success;e.success=function(e,t,n){c.authenticator.updateAuthenticatedSession(n),c._succeeded=!0,c.reportSuccess&&c.reportSuccess(n),h&&h(e,t,n)};var f=e.error;return e.error=function(a,l,d){function h(){if(!c.confirmingReload){c.confirmingReload=!0;var e=new r.RequestErrorMessage(a),t=c._succeeded?u.SessionExpiredDialogTitle:u.AuthenticationFailureDialogTitle;s.warn(e)&&console.warn(s.last),csui.require(["csui/dialogs/modal.alert/modal.alert"],function(e){e.showWarning(u.AuthenticationFailureDialogText,t,{"buttons":e.buttons.Ok
}).always(function(){c.authenticator.unauthenticate({"reason":"failed"})})})}}if(!T)if(401==a.status)if(t||e.restartDeferred){var m=t||{"options":o,"deferred":e.restartDeferred||e.deferred,"execute":n.ajax,"thisObj":void 0,"executeOptionsArray":[i.extend(o,{"restartRequest":!0})]};c.restartRequests.push(m),c.reauthenticatingInitiated||(c.reauthenticatingInitiated=!0,c.authenticator.unauthenticate({"reason":"expired"}),c.authenticator.authenticate(function(){c.reauthenticatingInitiated=!1,_.call(c)},function(e){c.restartRequests=[],h()}))}else h();else!function(){409==a.status&&O(a),c.reportError&&c.reportError(a),f&&f(a,l,d)}()},o=i.clone(e),e}function y(e){return e=JSON.stringify(e),d.useJSON||d.mock?e:{"body":e}}function x(){return d.useJSON||d.mock?"application/json":"application/x-www-form-urlencoded"}function C(e){function t(){e=r.extendAjaxOptions(e);var t=n.Deferred();i.extend(e,{"restartDeferred":t});var o=n.ajax(e).progress(t.notify).done(t.resolve).fail(function(e,n,i){401!==e.status&&(T||t.reject(e,n,i))});return g(t.promise(),o)}var o=e.method||e.type||"GET",s=e.data,r=this;if(s)if("GET"===o){"string"!=typeof s&&(s=n.param(s,!0));var c=e.url||location.href;c+=c.indexOf("?")>=0?"&":"?",c+=s,e.url=c,delete e.data}else{var a=e.contentType;s instanceof FormData?(void 0===a&&(e.contentType=!1),e.processData=!1):("string"!=typeof s&&(e.data=y(s)),void 0===a&&(e.contentType=x()))}return b.call(this,t)}function _(){var e=this,t=this.restartRequests.slice(0);this.restartRequests=[],i.each(t,function(t){e.authenticator.setAuthenticationHeaders(t.options.headers),t.execute.apply(t.thisObj,t.executeOptionsArray).progress(t.deferred.notify).done(t.deferred.resolve).fail(function(e,n,i){T||t.deferred.reject(e,n,i)})})}function w(){var e=this.waitingRequests.slice(0);this.waitingRequests=[],i.each(e,function(e){e.execute().progress(e.deferred.notify).done(e.deferred.resolve).fail(function(t,n,i){T||e.deferred.reject(t,n,i)})})}function A(e){var t=this.waitingRequests.slice(0);this.waitingRequests=[],i.each(t,function(t){t.deferred.reject(e)})}function S(e,t){if(!this.authenticationPending){this.authenticationPending=!0;var n=this;this.authenticator.authenticate(function(){n.authenticationPending=!1,e()},function(e){n.authenticationPending=!1,t(e)})}}function k(e,t){e&&t&&s.debug("Sending request as {0} to {1}.",t.type,t.url)&&console.log(s.last)}function R(e,t){var n=e.lengthComputable?i.str.sformat("{0} from {1} bytes transferred",e.loaded,e.total):e.beforeSend?"connection opened":"no information";s.debug("Progress of {0} from {1}: {2}.",t.settings.type,t.settings.url,n)&&console.log(s.last)}function E(e){e&&e.settings&&s.debug("Receiving response for {0} from {1}.",e.settings.type,e.settings.url)&&console.log(s.last)}function F(e,t){t||(e instanceof Error?(t=e,e=void 0):t=new r.RequestErrorMessage(e)),e&&e.settings&&s.warn("{0} request to {1} failed:",e.settings.type,e.settings.url)&&console.warn(s.last),s.warn(t)&&console.warn(s.last),r.MessageHelper.addMessage(t.toString())}function O(e){if(e.responseText)try{e.responseJSON=JSON.parse(e.responseText)}catch(e){s.warn("Parsing error response failed: {0}.",e)&&console.warn(s.last)}if(e.responseJSON){var t=e.responseJSON;t.error=u.resourceConflict,e.responseText=JSON.stringify(t)}}var M=i.extend({"connectionTimeout":void 0},t.config()),T=!1;return n(window).on("beforeunload."+t.id,function(e){T=!0}),i.extend(h.prototype,o.Events,{"constructor":h,"assignTo":f,"getConnectionUrl":p,"extendAjaxOptions":v,"extendFetchOptions":v,"formatAjaxData":y,"getAjaxContentType":x,"makeAjaxCall":C,"reportSending":k,"reportProgress":R,"reportSuccess":E,"reportError":F,"connectionTimeout":M.connectionTimeout,"authenticate":S}),h}),csui.define("nuc/contexts/factories/connector",["module","nuc/lib/underscore","nuc/contexts/factories/factory","nuc/utils/connector"],function(e,t,n,i){return n.extend({"propertyPrefix":"connector","constructor":function(o,s){n.prototype.constructor.apply(this,arguments);var r=this.options.connector||{};if(!(r instanceof i)){var c=e.config(),a=r.connection||c.connection||{},u=t.defaults({},a,r.connection,c.connection);r=new i(t.defaults({"connection":u},r,c))}this.property=r}})}),csui.define("nuc/utils/errors/response",[],function(){"use strict";function e(e){Error.prototype.constructor.call(this),this.message=e.error,this.details=e.errorDetail}return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e.prototype.name="ServerError",e}),csui.define("nuc/utils/errors",["nuc/lib/underscore","nuc/utils/errors/request","nuc/utils/errors/response"],function(e,t,n){"use strict";return{"getError":function(i){if(!i)throw new Error("No error source");if(i instanceof Error)return i;if(null!=i.status&&null!=i.statusText)return new t(i);if(i.error)return new n(i);if(e.isString(i))return new Error(i);throw new Error("Unrecognized source")}}}),csui.define("nuc/utils/objectstorage",["module","nuc/lib/underscore","nuc/lib/backbone","nuc/utils/log","nuc/lib/jquery"],function(e,t,n,i,o){"use strict";function s(){this.items={}}return t.extend(s.prototype,{"constructor":s,"setItem":function(e,t){this.items[e]=t},"getItem":function(e){return this.items[e]},"removeItem":function(e){delete this.items[e]}}),s}),csui.define("nuc/utils/namedstorage",["module","nuc/lib/underscore","nuc/lib/backbone","nuc/utils/log","nuc/utils/objectstorage"],function(e,t,n,i,o){function s(e,t){this.storage=e,this.name=t;try{this.storage.setItem("testkey","testvalue")}catch(e){this.os=new o}}function r(){var e;return(e=this.os?this.os.getItem(this.name):this.storage&&this.storage.getItem(this.name))&&JSON.parse(e)||{}}function c(e){this.os?this.os.setItem(this.name,JSON.stringify(e)):this.storage&&this.storage.setItem(this.name,JSON.stringify(e))}return t.extend(s.prototype,n.Events,{"constructor":s,"get":function(e,t){return r.call(this)[e]},"set":function(e,t){var n=r.call(this);n[e]=t,c.call(this,n)},"remove":function(e){var t=r.call(this);delete t[e],c.call(this,t)},"destroy":function(){this.storage.removeItem(this.name)}}),s.extend=n.View.extend,s.version="1.0",s}),csui.define("nuc/utils/namedlocalstorage",["module","nuc/utils/log","nuc/utils/namedstorage"],function(e,t,n){void 0===localStorage&&t.warn("Local storage is not available.  Some information will not be able to be persisted; expanded/collapsed state of facet filters, for example.")&&console.warn(t.last);var i=n.extend({"constructor":function(e){n.prototype.constructor.call(this,localStorage,e)}});return i.version="1.0",i}),csui.define("nuc/utils/namedsessionstorage",["module","nuc/utils/log","nuc/utils/namedstorage"],function(e,t,n){void 0===sessionStorage&&t.warn("Session storage is not available.  Some information will not be able to save temporarily; authenticated state, for example.")&&console.warn(t.last);var i=n.extend({"constructor":function(e){n.prototype.constructor.call(this,sessionStorage,e)}});return i.version="1.0",i}),csui.define("nuc/utils/page.leaving.blocker",["module","nuc/lib/jquery"],function(e,t){function n(){i||(i=!0,t(window).on("beforeunload."+e.id,function(e){if(r.isEnabled()){var t=s[0];return e&&(e.originalEvent.returnValue=t),t}}))}var i,o,s=[],r={"isEnabled":function(){return!o&&s.length},"enable":function(e){s.unshift(e),n()},"disable":function(){s.shift()},"forceDisable":function(){o=!0}};return r}),csui.define("nuc/utils/authenticators/authenticator",["nuc/lib/underscore","nuc/lib/backbone"],function(e,t){"use strict";function n(e){this.connection=e&&e.connection||{}}return e.extend(n.prototype,t.Events,{"authenticate":function(e,t,n){if("function"==typeof e&&(n=t,t=e,e=void 0),e||(e={}),this.syncStorage(e.session),this.doAuthenticate(e,t,n))return this;if(this.isAuthenticated())t&&t(this.connection);else{var i=new Error("Missing authentication parameters.");if(!n)throw i;n(i,this.connection)}return this},"setUserId":function(e){this.userId=e},"getUserId":function(){return this.userId},"doAuthenticate":function(e){},"unauthenticate":function(e){return this},"isAuthenticated":function(){return!1},"syncStorage":function(e){return this},"setAuthenticationHeaders":function(e){},"updateAuthenticatedSession":function(e){}}),n.extend=t.View.extend,n}),csui.define("nuc/utils/authenticators/server.adaptors/basic.mixin",["nuc/lib/underscore","nuc/utils/url"],function(e,t){"use strict";return{"mixin":function(n){return e.extend(n,{"makeServerAdaptor":function(e){return this},"prepareRequest":function(e){var n=e&&e.data||this.connection.credentials;return{"url":t.combine(this.connection.url,"auth"),"headers":{"authorization":this.formatAuthorizationHeader(n)}}}})}}}),csui.define("nuc/utils/authenticators/basic.authenticator",["module","nuc/lib/underscore","nuc/lib/jquery","nuc/utils/base","nuc/utils/url","nuc/utils/log","nuc/utils/namedsessionstorage","nuc/utils/authenticators/authenticator","nuc/models/mixins/uploadable/uploadable.mixin","nuc/utils/authenticators/server.adaptors/basic.mixin"],function(e,t,n,i,o,s,r,c,a,u){"use strict";var l=t.extend({"rememberCredentials":!0},e.config()),d=new r(e.id),h=c.extend({"constructor":function(e){c.prototype.constructor.call(this,e),this.credentials=e&&e.credentials,this.makeServerAdaptor(e)},"check":function(e,t,n){s.debug("Checking credentials with {0}.",this.connection.url)&&console.log(s.last);var i=this.prepareRequest(e);return this.makeRequest(i,t,n)},"prepareRequest":function(e){return e},"makeRequest":function(e,o,r){var c=t.extend({},this.connection.headers,e.headers);return n.ajax(t.extend({"timeout":this.connectionTimeout,"context":this,"beforeSend":function(e,t){e.settings=t},"success":function(t,n,i){s.debug("Receiving credentials-checking response from {0}.",this.connection.url)&&console.log(s.last),this.doAuthenticate(e),o&&o(this.connection),this.trigger("loggedIn",{"sender":this,"connection":this.connection})},"error":function(e){var t=new i.RequestErrorMessage(e);s.warn("Check credentials with {0} failed:\r\n{1}",this.connection.url,t)&&console.warn(s.last),r&&r(t,this.connection)}},e,{"headers":c}))},"doAuthenticate":function(e,t,n){var i=e.credentials||this.credentials||this.connection.credentials;i&&(this.connection.credentials=i,l.rememberCredentials&&d.set(this.connection.url,i))},"unauthenticate":function(e){var t=this.isAuthenticated();return this.connection.credentials=void 0,l.rememberCredentials&&d.remove(this.connection.url),t&&this.trigger("loggedOut",{"sender":this,"connection":this.connection,"reason":e&&e.reason}),this},"isAuthenticated":function(){return!!this.connection.credentials},"syncStorage":function(){return!this.connection.credentials&&l.rememberCredentials&&(this.connection.credentials=d.get(this.connection.url)),this},"setAuthenticationHeaders":function(e){e.authorization=this.formatAuthorizationHeader(this.connection.credentials)},"formatAuthorizationHeader":function(e){return"Basic "+btoa(unescape(encodeURIComponent(e.username+":"+e.password)))}});return u.mixin(h.prototype),h}),csui.define("nuc/utils/authenticators/ticket.authenticator",["module","nuc/lib/underscore","nuc/utils/authenticators/authenticator","nuc/utils/namedsessionstorage"],function(e,t,n,i){"use strict";var o=window.csui.requirejs.s.contexts._.config.config["nuc/utils/authenticator"]||{};o=t.extend({"rememberTicket":!0,"ticketHeader":"OTCSTicket","ticketExpirationHeader":"OTCSTicketExpires","dateHeader":"Date"},o,e.config()),o.ticketHeader=o.ticketHeader.toLowerCase(),o.ticketExpirationHeader=o.ticketExpirationHeader.toLowerCase(),o.dateHeader=o.dateHeader.toLowerCase();var s=new i(e.id);return n.extend({"constructor":function(e){n.prototype.constructor.call(this,e)},"unauthenticate":function(e){return this.connection.session=void 0,o.rememberTicket&&s.remove(this.connection.url),this.trigger("loggedOut",{"sender":this,"connection":this.connection,"reason":e&&e.reason}),this},"isAuthenticated":function(){var e=this.connection.session;return!(!e||!e.ticket)},"syncStorage":function(e){return e||(e=this.connection.session),!e&&o.rememberTicket&&(e=s.get(this.connection.url)),e&&(this.connection.session||(this.connection.session={}),t.extend(this.connection.session,e)),this},"setAuthenticationHeaders":function(e){var t=this.connection.session,n=t&&t.ticket;if(n)return e[o.ticketHeader]=n,!0},"updateAuthenticatedSession":function(e,n){e||(e={}),!n&&e.getResponseHeader&&(n=e,e={});var i=e.ticket||n&&n.getResponseHeader(o.ticketHeader);if(i){var r=this.connection.session||(this.connection.session={});t.extend(r,{"ticket":i,"expires":e.expires||n&&n.getResponseHeader(o.ticketExpirationHeader),"serverDate":e.serverDate||n&&n.getResponseHeader(o.dateHeader)}),o.rememberTicket&&s.set(this.connection.url,r)}}})}),csui.define("nuc/utils/authenticators/request.authenticator",["module","nuc/lib/jquery","nuc/lib/underscore","nuc/utils/base","nuc/utils/url","nuc/utils/log","nuc/models/mixins/uploadable/uploadable.mixin","nuc/utils/authenticators/ticket.authenticator","nuc/lib/jquery.parse.param"],function(e,t,n,i,o,s,r,c){"use strict";var a=window.csui.requirejs.s.contexts._.config.config["nuc/utils/requestauthenticator"]||{};return a=n.extend({"connectionTimeout":6e4},a,e.config()),c.extend({"constructor":function(e){c.prototype.constructor.call(this,e)},"prepareRequest":function(e){return e},"parseResponse":function(e,t){return e},"login":function(e,t,i){delete this.connection.session,s.debug("Sending authentication request to {0}.",this.connection.url)&&console.log(s.last),e=n.extend({},{"type":"POST","contentType":"application/json"},e);var o=this.prepareRequest(e);return this.updateRequestBody(o),this.makeRequest(o,t,i)},"makeAjaxCall":function(e){var o=n.extend({},this.connection.headers,e.headers);return t.ajax(n.extend({"url":e.url,"timeout":this.connectionTimeout,"context":this,"beforeSend":function(e,t){e.settings=t},"success":function(t,n,i){s.debug("Receiving request response from {0}.",e.url)&&console.log(s.last),t=this.parseResponse(t,i),e.success&&e.success.call(this,this.connection)},"error":function(t){var n=new i.RequestErrorMessage(t);s.warn("Logging in to {0} failed:\r\n{1}",this.connection.url,n)&&console.warn(s.last),e.error&&e.error.call(this,n,this.connection)}},e,{"headers":o}))},"makeRequest":function(e,t,r){function c(e,n,i){s.debug("Receiving authentication response from {0}.",this.connection.url)&&console.log(s.last),e=this.parseResponse(e,i),this.authenticateSession(e,i)&&(t&&t.call(this,this.connection),this.trigger("loggedIn",{"sender":this,"connection":this.connection}))}function a(e){var t=new i.RequestErrorMessage(e);s.warn("Logging in to {0} failed:\r\n{1}",this.connection.url,t)&&console.warn(s.last),r&&r.call(this,t,this.connection)}var u=n.extend({"url":o.combine(this.connection.url,"auth"),"success":c,"error":a},e);return this.makeAjaxCall(u)},"updateRequestBody":function(e){var n;r.useJSON||r.mock?"application/json"!==e.contentType&&(e.contentType="application/json",n=e.data,"string"==typeof n&&(n=t.parseParam(n)),r.mock?e.data=n:e.data=JSON.stringify(n),e.processData=!1):"application/json"===e.contentType&&(e.contentType="application/x-www-form-urlencoded",n=e.data,"string"==typeof n&&(e.data=JSON.parse(n)),r.mock&&(e.data=n),e.processData=!0)},"authenticateSession":function(e,t){return!e||!e.ticket||(t&&t.settings&&t.settings.data&&s.info("Logging in to {0} as {1} succeeded.",this.connection.url,t.settings.data.username)&&console.log(s.last),this.updateAuthenticatedSession(e,t),!0)},"unauthenticate":function(e){var t=this.isAuthenticated();return c.prototype.unauthenticate.apply(this,arguments),t&&this.trigger("loggedOut",{"sender":this,"connection":this.connection,"reason":e&&e.reason}),this},"connectionTimeout":a.connectionTimeout})}),csui.define("nuc/utils/authenticators/server.adaptors/credentials.mixin",["nuc/lib/underscore","nuc/utils/url"],function(e,t){"use strict";return{"mixin":function(n){return e.extend(n,{"makeServerAdaptor":function(e){return this},"prepareRequest":function(e){var n=e&&e.data||this.connection.credentials;return{"type":"POST","url":t.combine(this.connection.url,"auth"),"data":{"username":n.username,"password":n.password,"domain":""}}}})}}}),csui.define("nuc/utils/authenticators/credentials.authenticator",["require","nuc/utils/authenticators/request.authenticator","nuc/utils/authenticators/server.adaptors/credentials.mixin"],function(e,t,n){"use strict";var i=t.extend({"constructor":function(e){t.prototype.constructor.call(this,e),this.credentials=e&&e.credentials,this.makeServerAdaptor(e)},"doAuthenticate":function(e,t,n){var i=e.credentials||this.credentials||this.connection.credentials,o=this;if(i)return this.connection.credentials=i,this.login({},t,function(e,t){o._reportError(e),o.unauthenticate({"reason":"failed"}),n&&n(e,t)}),!0},"_reportError":function(e){csui.require(["csui/dialogs/modal.alert/modal.alert"],function(t){t.showError(e.toString())})}});return n.mixin(i.prototype),i}),csui.define("nuc/utils/authenticators/server.adaptors/initial.header.mixin",["nuc/lib/underscore","nuc/utils/url"],function(e,t){"use strict";return{"mixin":function(n){return e.extend(n,{"makeServerAdaptor":function(e){return this},"prepareRequest":function(e){var n=e&&e.headers||this.connection.authenticationHeaders;return{"url":t.combine(this.connection.url,"auth"),"headers":n}}})}}}),csui.define("nuc/utils/authenticators/initial.header.authenticator",["require","nuc/utils/log","nuc/utils/authenticators/request.authenticator","nuc/utils/authenticators/server.adaptors/initial.header.mixin"],function(e,t,n,i){"use strict";var o=n.extend({"constructor":function(e){n.prototype.constructor.call(this,e),this.makeServerAdaptor(e)},"doAuthenticate":function(e,t,n){var i=e.headers||this.connection.authenticationHeaders,o=this;if(i)return this.connection.authenticationHeaders=i,this.login({},t,function(e,t){o._reportError(e),o.unauthenticate({"reason":"failed"}),n&&n(e,t)}),!0},"authenticateSession":function(e,n){if(e&&e.data)return t.info("Logging in to {0} as {1} succeeded.",this.connection.url,e.data.name)&&console.log(t.last),this.updateAuthenticatedSession(n),!0},"_reportError":function(e){csui.require(["csui/dialogs/modal.alert/modal.alert"],function(t){t.showError(e.toString())})}});return i.mixin(o.prototype),o}),csui.define("nuc/utils/authenticators/regular.header.authenticator",["module","nuc/lib/underscore","nuc/utils/log","nuc/utils/authenticators/authenticator","nuc/utils/namedsessionstorage"],function(e,t,n,i,o){"use strict";var s=t.extend({"rememberAuthenticationHeaders":!0},e.config()),r=new o(e.id);return i.extend({"constructor":function(e){i.prototype.constructor.call(this,e)},"doAuthenticate":function(e,t,n){var i=e.headers||this.connection.authenticationHeaders;i&&(this.connection.authenticationHeaders=i,s.rememberAuthenticationHeaders&&r.remove(this.connection.url))},"unauthenticate":function(e){return this.connection.authenticationHeaders=void 0,s.rememberAuthenticationHeaders&&r.remove(this.connection.url),this},"isAuthenticated":function(){return!!this.connection.authenticationHeaders},"syncStorage":function(){return!this.connection.authenticationHeaders&&s.rememberAuthenticationHeaders&&(this.connection.authenticationHeaders=r.get(this.connection.url)),this},"setAuthenticationHeaders":function(e){t.extend(e,this.connection.authenticationHeaders)}})}),csui.define("nuc/utils/authenticators/nuc.authenticators",["module","nuc/lib/underscore","nuc/utils/authenticators/ticket.authenticator","nuc/utils/authenticators/basic.authenticator","nuc/utils/authenticators/credentials.authenticator","nuc/utils/authenticators/regular.header.authenticator","nuc/utils/authenticators/initial.header.authenticator"],function(e,t,n,i,o,s,r){"use strict";var c=window.csui.requirejs.s.contexts._.config.config["nuc/utils/interactiveauthenticator"]||{},a=e.config();return c=t.extend({"forceBasicAuthenticator":!1,"preferBasicAuthenticator":!1,"preferRegularHeaderAuthenticator":!1},a),[{"authenticator":i,"sequence":50,"decides":function(e){return c.forceBasicAuthenticator||e.credentials&&c.preferBasicAuthenticator}},{"authenticator":s,"sequence":50,"and":{"has":"authenticationHeaders","decides":function(){return c.preferRegularHeaderAuthentication}}},{"authenticator":o,"has":"credentials"},{"authenticator":r,"has":"authenticationHeaders"},{"sequence":1e3,"authenticator":n}]}),csui.define("nuc/utils/authenticator",["nuc/utils/authenticators/ticket.authenticator"],function(e){"use strict";return e}),csui.define("nuc/utils/basicauthenticator",["nuc/utils/authenticators/credentials.authenticator"],function(e){"use strict";return e}),csui.define("nuc/utils/headerauthenticator",["nuc/utils/authenticators/initial.header.authenticator"],function(e){"use strict";return e}),csui.define("nuc/utils/requestauthenticator",["nuc/utils/authenticators/request.authenticator"],function(e){"use strict";return e}),csui.define("bundles/nuc-models",["nuc/models/action","nuc/models/actions","nuc/models/actionitem","nuc/models/actionitems","nuc/models/addabletype","nuc/models/addabletypes","nuc/models/ancestor","nuc/models/ancestors","nuc/models/authenticated.user","nuc/models/authentication","nuc/models/clientsidecollection","nuc/models/column","nuc/models/columns","nuc/models/datadefinition","nuc/models/datadefinitions","nuc/models/member","nuc/models/member/member.model","nuc/models/member/membercollection","nuc/models/members","nuc/models/node/node.addable.type.collection","nuc/models/node/node.model","nuc/models/node.children2/node.children2","nuc/models/node.columns2","nuc/models/nodeancestors","nuc/models/nodechildrencolumn","nuc/models/nodechildrencolumns","nuc/models/nodechildren","nuc/models/node.actions","nuc/models/nodes","nuc/models/tool.item.config/tool.item.config.collection","nuc/models/tool.item.mask/tool.item.mask.collection","nuc/models/browsable/browsable.mixin","nuc/models/browsable/client-side.mixin","nuc/models/browsable/v1.request.mixin","nuc/models/browsable/v1.response.mixin","nuc/models/browsable/v2.response.mixin","nuc/models/mixins/appcontainer/appcontainer.mixin","nuc/models/mixins/autofetchable/autofetchable.mixin","nuc/models/mixins/commandable/commandable.mixin","nuc/models/mixins/connectable/connectable.mixin","nuc/models/mixins/delayed.commandable/delayed.commandable.mixin","nuc/models/mixins/expandable/expandable.mixin","nuc/models/mixins/fetchable/fetchable.mixin","nuc/models/mixins/including.additional.resources/including.additional.resources.mixin","nuc/models/mixins/node.autofetchable/node.autofetchable.mixin","nuc/models/mixins/node.connectable/node.connectable.mixin","nuc/models/mixins/node.resource/node.resource.mixin","nuc/models/mixins/resource/resource.mixin","nuc/models/mixins/rules.matching/rules.matching.mixin","nuc/models/mixins/state.carrier/state.carrier.mixin","nuc/models/mixins/state.requestor/state.requestor.mixin","nuc/models/mixins/syncable.from.multiple.sources/syncable.from.multiple.sources.mixin","nuc/models/mixins/uploadable/uploadable.mixin","nuc/models/mixins/v2.additional.resources/v2.additional.resources.mixin","nuc/models/mixins/v2.commandable/v2.commandable.mixin","nuc/models/mixins/v2.delayed.commandable/v2.delayed.commandable.mixin","nuc/models/mixins/v2.expandable/v2.expandable.mixin","nuc/models/mixins/v2.fields/v2.fields.mixin","nuc/models/autofetchable","nuc/models/connectable","nuc/models/expandable","nuc/models/fetchable","nuc/models/including.additional.resources","nuc/models/nodeautofetchable","nuc/models/nodeconnectable","nuc/models/noderesource","nuc/models/resource","nuc/models/uploadable","nuc/models/utils/v1tov2","nuc/contexts/context","nuc/contexts/synchronized.context","nuc/contexts/context.plugin","nuc/contexts/fragment/context.fragment","nuc/contexts/mixins/clone.and.fetch.mixin","nuc/contexts/page/page.context","nuc/contexts/factories/connector","nuc/contexts/factories/factory","nuc/utils/base","nuc/utils/connector","nuc/utils/deepClone/deepClone","nuc/utils/errormessage","nuc/utils/errors","nuc/utils/errors/request","nuc/utils/errors/response","nuc/utils/log","nuc/utils/messagehelper","nuc/utils/namedlocalstorage","nuc/utils/namedsessionstorage","nuc/utils/namedstorage","nuc/utils/page.leaving.blocker","nuc/utils/promoted.actionitems","nuc/utils/types/date","nuc/utils/types/localizable","nuc/utils/types/member","nuc/utils/types/number","nuc/utils/url","nuc/utils/authenticators/authenticator","nuc/utils/authenticators/authenticators","nuc/utils/authenticators/basic.authenticator","nuc/utils/authenticators/credentials.authenticator","nuc/utils/authenticators/initial.header.authenticator","nuc/utils/authenticators/nuc.authenticators","nuc/utils/authenticators/regular.header.authenticator","nuc/utils/authenticators/request.authenticator","nuc/utils/authenticators/ticket.authenticator","nuc/utils/authenticator","nuc/utils/basicauthenticator","nuc/utils/headerauthenticator","nuc/utils/requestauthenticator","nuc/models/authenticated.user/server.adaptor.mixin","nuc/models/member/server.adaptor.mixin","nuc/models/member/membercollection.server.adaptor","nuc/models/member/members.server.adaptor","nuc/models/node/server.adaptor.mixin","nuc/models/node.children/server.adaptor.mixin","nuc/models/node.children2/server.adaptor.mixin","nuc/utils/authenticators/server.adaptors/basic.mixin","nuc/utils/authenticators/server.adaptors/credentials.mixin","nuc/utils/authenticators/server.adaptors/initial.header.mixin","nuc/models/member/member.server.adaptor.mixin"],{});
//# sourceMappingURL=nuc-models.js.map