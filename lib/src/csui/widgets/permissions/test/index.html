<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Permissions Widget</title>

  <link rel="stylesheet" href="../../../themes/carbonfiber/theme.css">

  <style>
    body {
      font-family: "OpenText Sans", "Helvetica Neue", "HelveticaNeue", "Helvetica", "Arial",
      "Segoe UI", "Tahoma", sans-serif;
      font-size: 14px;
      font-weight: 300;
      height: 100%;
    }

    .docRef {
      position: absolute;
      top: 20px;
      left: 20px;
      color: #ffffff;
    }

    .test-container {
      position: absolute;
      top: 60px;
      left: 20px;
    }

    .cs-metadata {
      height: 100%;
    }

    .row {
      height: 100%;
    }

    #content {
      height: 100%;
    }

    a:link {
      color: grey;
    }

    a:hover {
      color: grey;
    }

    a:active {
      color: grey;
    }

    a:visited {
      color: grey;
    }
  </style>
  <script src="../../../../nuc/lib/require.js"></script>
  <script src="../../../../nuc/config.js" data-csui-path="../../../../nuc"></script>
  <script src="../../../../smart/config.js" data-csui-path="../../../../smart"></script>
  <script src="../../../test/sdk-demo-config-parameters.js"></script>
  <script>
  
	// Help the test page waiting on all "deps" config sections.
    var csuiCallbacks = [],
        csuiBlocks    = 0;

    window.blockCsui = function () {
      ++csuiBlocks;
    };

    window.unBlockCsui = function () {
      if (--csuiBlocks === 0) {
        while (csuiCallbacks.length) {
          csuiCallbacks.shift()();
          if (csuiBlocks > 0) {
            break;
          }
        }
      }
    };

    window.csuiDemo = function (callback) {
      if (csuiBlocks === 0) {
        callback();
      } else {
        csuiCallbacks.push(callback);
      }
    };

    window.blockCsui();
    require.config({
          paths: {
            csui: "../../../../csui"
          },
          deps: [
            'nuc/lib/require.config!nuc/nuc-extensions.json',
            'nuc/lib/require.config!smart/smart-extensions.json',
            'csui/lib/require.config!csui/csui-extensions.json'
          ],
          callback: window.unBlockCsui
        });


    // Default server connection is generated by the server
    window.csuiDemo(function () {
      require.config({
      config: {
        'csui/utils/contexts/factories/connector': {
          connection:  csui.connection
        }
      }
    });

    require(['csui/lib/jquery', "csui/lib/marionette", 'csui/utils/contexts/page/page.context',
          "csui/utils/contexts/factories/node", "./permissions.mock.data.js",
          "../permissions.view.js", 'csui/lib/jquery.mousehover',
          'csui/models/action', 
          'csui/models/actions'
        ],
        function ($, Marionette, PageContext, NodeModelFactory, PermissionsMock, PermissionsView,
            hover, ActionModel, ActionCollection) {

          PermissionsMock.enable();
          $.mousehover = hover;
          var permissionsView,
              contentRegion = new Marionette.Region({el: "#content"}),
              context       = new PageContext({
                factories: {
                  connector: {
                    connection: {
                      url: '//server/otcs/cs/api/v2',
                      supportPath: '/support',
                      session: {
                        ticket: 'dummy'
                      }
                    }
                  }
                }
              });
          // 11111 for mocked data

          var node = context.getModel(NodeModelFactory, {attributes: {id: 11111}});
          var actionModel = new ActionModel({
            method: "GET",
            name: "permissions",
            signature: "permissions"
          }),
          actionModel1 = new ActionModel({
            method: "GET",
            name: "editpermissions",
            signature: "editpermissions"
          });
          node.actions = new ActionCollection([actionModel, actionModel1]);
          permissionsView = new PermissionsView({
            context: context,
            model: node
          });
          contentRegion.show(permissionsView);
        });
	});
  </script>
</head>

<body class="binf-widgets">
<a class="docRef" href="../doc/permissions.md">Documentation</a>

<div class="binf-container-fluid">
  <div class="binf-row">
    <div class="binf-col-sm-12 binf-col-md-12 binf-col-lg-12 test-container" id="content"></div>
  </div>
</div>
</body>

</html>

<!-- Copyright (c) 2016-2017  OpenText Corp. All Rights Reserved. -->